import{a as Tx}from"./chunk-SPQ2A64L.js";import{a as pb,b as vr,c as Rr,d as Z3}from"./chunk-UWFHNPCD.js";import{A as y1,a as It,b as M,c as fn,d as X0,e as Ue,f as De,g as Tt,h as ab,i as cb,j as lb,k as Ce,l as J3,m as _1,n as vt,o as Re,p as Ut,q as g1,r as mn,s as _n,t as ct,u as st,v as c0,w as ri,x as ir,y as bs,z as Gr}from"./chunk-EF7P6KSQ.js";import{$ as Oi,$a as P3,$b as mu,A as Px,Aa as qr,Ab as h1,B as Rx,Ba as Qm,Bb as f1,C as Ix,Ca as e1,Cb as hn,D as Lx,Da as Qn,Db as m1,E as Dx,Ea as t1,F as kx,Fa as Qx,G as Bx,Ga as at,Gb as nb,H as Fx,Ha as pu,Hb as K3,I as Ux,Ia as r1,Ib as Hd,J as Vx,Ja as wn,Jb as q0,K as Gx,Ka as ei,Kb as jd,L as zx,La as o1,Lb as ti,M as Hx,Ma as n1,Mb as Li,N as C3,Na as i1,Nb as Mn,O as jx,Oa as s1,Ob as Wd,P as Wx,Pa as a1,Pb as du,Q as qx,Qa as c1,Qb as ib,R as Xx,Ra as l1,Rb as sb,S as lu,Sa as u1,Sb as qo,T as jm,Ta as p1,Tb as z,U as Wm,Ua as E3,Ub as hu,V as Ro,Va as S3,W as qm,Wa as w3,Wb as de,X as Xm,Xa as M3,Xb as ub,Y as Ym,Ya as eb,Yb as Y0,Z as $m,Za as N3,Zb as fu,_ as Yx,_a as O3,_b as v1,a as Ax,aa as pn,ab as R3,ac as lo,b as mc,ba as Sn,bb as I3,bc as Xo,c as _c,ca as n0,cb as L3,d as Cx,da as i0,db as D3,e as b3,ea as dn,eb as k3,f as Ex,fa as Pi,fb as B3,g as Sx,ga as Zn,gb as F3,h as au,ha as Ft,hb as U3,i as Hm,ia as j0,ib as V3,j as o0,ja as it,jb as G3,k as gr,ka as vc,kb as z3,l as Mt,la as $x,lb as H3,m as Wr,ma as yc,mb as j3,na as Kx,nb as W3,o as un,oa as lt,ob as s0,p as gc,pa as uu,pb as a0,q as Vd,qa as Jx,qb as d1,r as Gd,ra as Ri,rb as q3,s as zd,sa as Zx,sb as X3,t as wx,ta as Wo,tb as Y3,u as cu,ua as Km,ub as tb,v as Mx,va as Jm,vb as rb,w as Nx,wa as Ii,wb as ob,x as T3,xa as Zm,xb as $3,y as A3,ya as W0,yb as Xr,z as Ox,za as qt,zb as bt}from"./chunk-CQ5QUQVH.js";import{a as ce,b as x3,c as Ni}from"./chunk-KBNISIIW.js";var JC=ce((fme,KC)=>{function Hz(){this.__data__=[],this.size=0}KC.exports=Hz});var O4=ce((mme,ZC)=>{function jz(o,e){return o===e||o!==o&&e!==e}ZC.exports=jz});var Jd=ce((_me,QC)=>{var Wz=O4();function qz(o,e){for(var t=o.length;t--;)if(Wz(o[t][0],e))return t;return-1}QC.exports=qz});var tE=ce((gme,eE)=>{var Xz=Jd(),Yz=Array.prototype,$z=Yz.splice;function Kz(o){var e=this.__data__,t=Xz(e,o);if(t<0)return!1;var r=e.length-1;return t==r?e.pop():$z.call(e,t,1),--this.size,!0}eE.exports=Kz});var oE=ce((vme,rE)=>{var Jz=Jd();function Zz(o){var e=this.__data__,t=Jz(e,o);return t<0?void 0:e[t][1]}rE.exports=Zz});var iE=ce((yme,nE)=>{var Qz=Jd();function eH(o){return Qz(this.__data__,o)>-1}nE.exports=eH});var aE=ce((xme,sE)=>{var tH=Jd();function rH(o,e){var t=this.__data__,r=tH(t,o);return r<0?(++this.size,t.push([o,e])):t[r][1]=e,this}sE.exports=rH});var Zd=ce((bme,cE)=>{var oH=JC(),nH=tE(),iH=oE(),sH=iE(),aH=aE();function Mu(o){var e=-1,t=o==null?0:o.length;for(this.clear();++e<t;){var r=o[e];this.set(r[0],r[1])}}Mu.prototype.clear=oH;Mu.prototype.delete=nH;Mu.prototype.get=iH;Mu.prototype.has=sH;Mu.prototype.set=aH;cE.exports=Mu});var uE=ce((Tme,lE)=>{var cH=Zd();function lH(){this.__data__=new cH,this.size=0}lE.exports=lH});var dE=ce((Ame,pE)=>{function uH(o){var e=this.__data__,t=e.delete(o);return this.size=e.size,t}pE.exports=uH});var fE=ce((Cme,hE)=>{function pH(o){return this.__data__.get(o)}hE.exports=pH});var _E=ce((Eme,mE)=>{function dH(o){return this.__data__.has(o)}mE.exports=dH});var P4=ce((Sme,gE)=>{var hH=typeof global=="object"&&global&&global.Object===Object&&global;gE.exports=hH});var ni=ce((wme,vE)=>{var fH=P4(),mH=typeof self=="object"&&self&&self.Object===Object&&self,_H=fH||mH||Function("return this")();vE.exports=_H});var R1=ce((Mme,yE)=>{var gH=ni(),vH=gH.Symbol;yE.exports=vH});var AE=ce((Nme,TE)=>{var xE=R1(),bE=Object.prototype,yH=bE.hasOwnProperty,xH=bE.toString,Qd=xE?xE.toStringTag:void 0;function bH(o){var e=yH.call(o,Qd),t=o[Qd];try{o[Qd]=void 0;var r=!0}catch{}var n=xH.call(o);return r&&(e?o[Qd]=t:delete o[Qd]),n}TE.exports=bH});var EE=ce((Ome,CE)=>{var TH=Object.prototype,AH=TH.toString;function CH(o){return AH.call(o)}CE.exports=CH});var Nu=ce((Pme,ME)=>{var SE=R1(),EH=AE(),SH=EE(),wH="[object Null]",MH="[object Undefined]",wE=SE?SE.toStringTag:void 0;function NH(o){return o==null?o===void 0?MH:wH:wE&&wE in Object(o)?EH(o):SH(o)}ME.exports=NH});var p0=ce((Rme,NE)=>{function OH(o){var e=typeof o;return o!=null&&(e=="object"||e=="function")}NE.exports=OH});var R4=ce((Ime,OE)=>{var PH=Nu(),RH=p0(),IH="[object AsyncFunction]",LH="[object Function]",DH="[object GeneratorFunction]",kH="[object Proxy]";function BH(o){if(!RH(o))return!1;var e=PH(o);return e==LH||e==DH||e==IH||e==kH}OE.exports=BH});var RE=ce((Lme,PE)=>{var FH=ni(),UH=FH["__core-js_shared__"];PE.exports=UH});var DE=ce((Dme,LE)=>{var I4=RE(),IE=function(){var o=/[^.]+$/.exec(I4&&I4.keys&&I4.keys.IE_PROTO||"");return o?"Symbol(src)_1."+o:""}();function VH(o){return!!IE&&IE in o}LE.exports=VH});var L4=ce((kme,kE)=>{var GH=Function.prototype,zH=GH.toString;function HH(o){if(o!=null){try{return zH.call(o)}catch{}try{return o+""}catch{}}return""}kE.exports=HH});var FE=ce((Bme,BE)=>{var jH=R4(),WH=DE(),qH=p0(),XH=L4(),YH=/[\\^$.*+?()[\]{}|]/g,$H=/^\[object .+?Constructor\]$/,KH=Function.prototype,JH=Object.prototype,ZH=KH.toString,QH=JH.hasOwnProperty,ej=RegExp("^"+ZH.call(QH).replace(YH,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function tj(o){if(!qH(o)||WH(o))return!1;var e=jH(o)?ej:$H;return e.test(XH(o))}BE.exports=tj});var VE=ce((Fme,UE)=>{function rj(o,e){return o==null?void 0:o[e]}UE.exports=rj});var ea=ce((Ume,GE)=>{var oj=FE(),nj=VE();function ij(o,e){var t=nj(o,e);return oj(t)?t:void 0}GE.exports=ij});var I1=ce((Vme,zE)=>{var sj=ea(),aj=ni(),cj=sj(aj,"Map");zE.exports=cj});var eh=ce((Gme,HE)=>{var lj=ea(),uj=lj(Object,"create");HE.exports=uj});var qE=ce((zme,WE)=>{var jE=eh();function pj(){this.__data__=jE?jE(null):{},this.size=0}WE.exports=pj});var YE=ce((Hme,XE)=>{function dj(o){var e=this.has(o)&&delete this.__data__[o];return this.size-=e?1:0,e}XE.exports=dj});var KE=ce((jme,$E)=>{var hj=eh(),fj="__lodash_hash_undefined__",mj=Object.prototype,_j=mj.hasOwnProperty;function gj(o){var e=this.__data__;if(hj){var t=e[o];return t===fj?void 0:t}return _j.call(e,o)?e[o]:void 0}$E.exports=gj});var ZE=ce((Wme,JE)=>{var vj=eh(),yj=Object.prototype,xj=yj.hasOwnProperty;function bj(o){var e=this.__data__;return vj?e[o]!==void 0:xj.call(e,o)}JE.exports=bj});var eS=ce((qme,QE)=>{var Tj=eh(),Aj="__lodash_hash_undefined__";function Cj(o,e){var t=this.__data__;return this.size+=this.has(o)?0:1,t[o]=Tj&&e===void 0?Aj:e,this}QE.exports=Cj});var rS=ce((Xme,tS)=>{var Ej=qE(),Sj=YE(),wj=KE(),Mj=ZE(),Nj=eS();function Ou(o){var e=-1,t=o==null?0:o.length;for(this.clear();++e<t;){var r=o[e];this.set(r[0],r[1])}}Ou.prototype.clear=Ej;Ou.prototype.delete=Sj;Ou.prototype.get=wj;Ou.prototype.has=Mj;Ou.prototype.set=Nj;tS.exports=Ou});var iS=ce((Yme,nS)=>{var oS=rS(),Oj=Zd(),Pj=I1();function Rj(){this.size=0,this.__data__={hash:new oS,map:new(Pj||Oj),string:new oS}}nS.exports=Rj});var aS=ce(($me,sS)=>{function Ij(o){var e=typeof o;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?o!=="__proto__":o===null}sS.exports=Ij});var th=ce((Kme,cS)=>{var Lj=aS();function Dj(o,e){var t=o.__data__;return Lj(e)?t[typeof e=="string"?"string":"hash"]:t.map}cS.exports=Dj});var uS=ce((Jme,lS)=>{var kj=th();function Bj(o){var e=kj(this,o).delete(o);return this.size-=e?1:0,e}lS.exports=Bj});var dS=ce((Zme,pS)=>{var Fj=th();function Uj(o){return Fj(this,o).get(o)}pS.exports=Uj});var fS=ce((Qme,hS)=>{var Vj=th();function Gj(o){return Vj(this,o).has(o)}hS.exports=Gj});var _S=ce((e1e,mS)=>{var zj=th();function Hj(o,e){var t=zj(this,o),r=t.size;return t.set(o,e),this.size+=t.size==r?0:1,this}mS.exports=Hj});var vS=ce((t1e,gS)=>{var jj=iS(),Wj=uS(),qj=dS(),Xj=fS(),Yj=_S();function Pu(o){var e=-1,t=o==null?0:o.length;for(this.clear();++e<t;){var r=o[e];this.set(r[0],r[1])}}Pu.prototype.clear=jj;Pu.prototype.delete=Wj;Pu.prototype.get=qj;Pu.prototype.has=Xj;Pu.prototype.set=Yj;gS.exports=Pu});var xS=ce((r1e,yS)=>{var $j=Zd(),Kj=I1(),Jj=vS(),Zj=200;function Qj(o,e){var t=this.__data__;if(t instanceof $j){var r=t.__data__;if(!Kj||r.length<Zj-1)return r.push([o,e]),this.size=++t.size,this;t=this.__data__=new Jj(r)}return t.set(o,e),this.size=t.size,this}yS.exports=Qj});var TS=ce((o1e,bS)=>{var eW=Zd(),tW=uE(),rW=dE(),oW=fE(),nW=_E(),iW=xS();function Ru(o){var e=this.__data__=new eW(o);this.size=e.size}Ru.prototype.clear=tW;Ru.prototype.delete=rW;Ru.prototype.get=oW;Ru.prototype.has=nW;Ru.prototype.set=iW;bS.exports=Ru});var CS=ce((n1e,AS)=>{function sW(o,e){for(var t=-1,r=o==null?0:o.length;++t<r&&e(o[t],t,o)!==!1;);return o}AS.exports=sW});var SS=ce((i1e,ES)=>{var aW=ea(),cW=function(){try{var o=aW(Object,"defineProperty");return o({},"",{}),o}catch{}}();ES.exports=cW});var D4=ce((s1e,MS)=>{var wS=SS();function lW(o,e,t){e=="__proto__"&&wS?wS(o,e,{configurable:!0,enumerable:!0,value:t,writable:!0}):o[e]=t}MS.exports=lW});var k4=ce((a1e,NS)=>{var uW=D4(),pW=O4(),dW=Object.prototype,hW=dW.hasOwnProperty;function fW(o,e,t){var r=o[e];(!(hW.call(o,e)&&pW(r,t))||t===void 0&&!(e in o))&&uW(o,e,t)}NS.exports=fW});var rh=ce((c1e,OS)=>{var mW=k4(),_W=D4();function gW(o,e,t,r){var n=!t;t||(t={});for(var i=-1,s=e.length;++i<s;){var a=e[i],c=r?r(t[a],o[a],a,t,o):void 0;c===void 0&&(c=o[a]),n?_W(t,a,c):mW(t,a,c)}return t}OS.exports=gW});var RS=ce((l1e,PS)=>{function vW(o,e){for(var t=-1,r=Array(o);++t<o;)r[t]=e(t);return r}PS.exports=vW});var Ac=ce((u1e,IS)=>{function yW(o){return o!=null&&typeof o=="object"}IS.exports=yW});var DS=ce((p1e,LS)=>{var xW=Nu(),bW=Ac(),TW="[object Arguments]";function AW(o){return bW(o)&&xW(o)==TW}LS.exports=AW});var US=ce((d1e,FS)=>{var kS=DS(),CW=Ac(),BS=Object.prototype,EW=BS.hasOwnProperty,SW=BS.propertyIsEnumerable,wW=kS(function(){return arguments}())?kS:function(o){return CW(o)&&EW.call(o,"callee")&&!SW.call(o,"callee")};FS.exports=wW});var L1=ce((h1e,VS)=>{var MW=Array.isArray;VS.exports=MW});var zS=ce((f1e,GS)=>{function NW(){return!1}GS.exports=NW});var B4=ce((oh,Iu)=>{var OW=ni(),PW=zS(),WS=typeof oh=="object"&&oh&&!oh.nodeType&&oh,HS=WS&&typeof Iu=="object"&&Iu&&!Iu.nodeType&&Iu,RW=HS&&HS.exports===WS,jS=RW?OW.Buffer:void 0,IW=jS?jS.isBuffer:void 0,LW=IW||PW;Iu.exports=LW});var XS=ce((m1e,qS)=>{var DW=9007199254740991,kW=/^(?:0|[1-9]\d*)$/;function BW(o,e){var t=typeof o;return e=e??DW,!!e&&(t=="number"||t!="symbol"&&kW.test(o))&&o>-1&&o%1==0&&o<e}qS.exports=BW});var F4=ce((_1e,YS)=>{var FW=9007199254740991;function UW(o){return typeof o=="number"&&o>-1&&o%1==0&&o<=FW}YS.exports=UW});var KS=ce((g1e,$S)=>{var VW=Nu(),GW=F4(),zW=Ac(),HW="[object Arguments]",jW="[object Array]",WW="[object Boolean]",qW="[object Date]",XW="[object Error]",YW="[object Function]",$W="[object Map]",KW="[object Number]",JW="[object Object]",ZW="[object RegExp]",QW="[object Set]",eq="[object String]",tq="[object WeakMap]",rq="[object ArrayBuffer]",oq="[object DataView]",nq="[object Float32Array]",iq="[object Float64Array]",sq="[object Int8Array]",aq="[object Int16Array]",cq="[object Int32Array]",lq="[object Uint8Array]",uq="[object Uint8ClampedArray]",pq="[object Uint16Array]",dq="[object Uint32Array]",dr={};dr[nq]=dr[iq]=dr[sq]=dr[aq]=dr[cq]=dr[lq]=dr[uq]=dr[pq]=dr[dq]=!0;dr[HW]=dr[jW]=dr[rq]=dr[WW]=dr[oq]=dr[qW]=dr[XW]=dr[YW]=dr[$W]=dr[KW]=dr[JW]=dr[ZW]=dr[QW]=dr[eq]=dr[tq]=!1;function hq(o){return zW(o)&&GW(o.length)&&!!dr[VW(o)]}$S.exports=hq});var D1=ce((v1e,JS)=>{function fq(o){return function(e){return o(e)}}JS.exports=fq});var k1=ce((nh,Lu)=>{var mq=P4(),ZS=typeof nh=="object"&&nh&&!nh.nodeType&&nh,ih=ZS&&typeof Lu=="object"&&Lu&&!Lu.nodeType&&Lu,_q=ih&&ih.exports===ZS,U4=_q&&mq.process,gq=function(){try{var o=ih&&ih.require&&ih.require("util").types;return o||U4&&U4.binding&&U4.binding("util")}catch{}}();Lu.exports=gq});var rw=ce((y1e,tw)=>{var vq=KS(),yq=D1(),QS=k1(),ew=QS&&QS.isTypedArray,xq=ew?yq(ew):vq;tw.exports=xq});var V4=ce((x1e,ow)=>{var bq=RS(),Tq=US(),Aq=L1(),Cq=B4(),Eq=XS(),Sq=rw(),wq=Object.prototype,Mq=wq.hasOwnProperty;function Nq(o,e){var t=Aq(o),r=!t&&Tq(o),n=!t&&!r&&Cq(o),i=!t&&!r&&!n&&Sq(o),s=t||r||n||i,a=s?bq(o.length,String):[],c=a.length;for(var l in o)(e||Mq.call(o,l))&&!(s&&(l=="length"||n&&(l=="offset"||l=="parent")||i&&(l=="buffer"||l=="byteLength"||l=="byteOffset")||Eq(l,c)))&&a.push(l);return a}ow.exports=Nq});var B1=ce((b1e,nw)=>{var Oq=Object.prototype;function Pq(o){var e=o&&o.constructor,t=typeof e=="function"&&e.prototype||Oq;return o===t}nw.exports=Pq});var G4=ce((T1e,iw)=>{function Rq(o,e){return function(t){return o(e(t))}}iw.exports=Rq});var aw=ce((A1e,sw)=>{var Iq=G4(),Lq=Iq(Object.keys,Object);sw.exports=Lq});var lw=ce((C1e,cw)=>{var Dq=B1(),kq=aw(),Bq=Object.prototype,Fq=Bq.hasOwnProperty;function Uq(o){if(!Dq(o))return kq(o);var e=[];for(var t in Object(o))Fq.call(o,t)&&t!="constructor"&&e.push(t);return e}cw.exports=Uq});var z4=ce((E1e,uw)=>{var Vq=R4(),Gq=F4();function zq(o){return o!=null&&Gq(o.length)&&!Vq(o)}uw.exports=zq});var F1=ce((S1e,pw)=>{var Hq=V4(),jq=lw(),Wq=z4();function qq(o){return Wq(o)?Hq(o):jq(o)}pw.exports=qq});var hw=ce((w1e,dw)=>{var Xq=rh(),Yq=F1();function $q(o,e){return o&&Xq(e,Yq(e),o)}dw.exports=$q});var mw=ce((M1e,fw)=>{function Kq(o){var e=[];if(o!=null)for(var t in Object(o))e.push(t);return e}fw.exports=Kq});var gw=ce((N1e,_w)=>{var Jq=p0(),Zq=B1(),Qq=mw(),eX=Object.prototype,tX=eX.hasOwnProperty;function rX(o){if(!Jq(o))return Qq(o);var e=Zq(o),t=[];for(var r in o)r=="constructor"&&(e||!tX.call(o,r))||t.push(r);return t}_w.exports=rX});var U1=ce((O1e,vw)=>{var oX=V4(),nX=gw(),iX=z4();function sX(o){return iX(o)?oX(o,!0):nX(o)}vw.exports=sX});var xw=ce((P1e,yw)=>{var aX=rh(),cX=U1();function lX(o,e){return o&&aX(e,cX(e),o)}yw.exports=lX});var Ew=ce((sh,Du)=>{var uX=ni(),Cw=typeof sh=="object"&&sh&&!sh.nodeType&&sh,bw=Cw&&typeof Du=="object"&&Du&&!Du.nodeType&&Du,pX=bw&&bw.exports===Cw,Tw=pX?uX.Buffer:void 0,Aw=Tw?Tw.allocUnsafe:void 0;function dX(o,e){if(e)return o.slice();var t=o.length,r=Aw?Aw(t):new o.constructor(t);return o.copy(r),r}Du.exports=dX});var ww=ce((R1e,Sw)=>{function hX(o,e){var t=-1,r=o.length;for(e||(e=Array(r));++t<r;)e[t]=o[t];return e}Sw.exports=hX});var Nw=ce((I1e,Mw)=>{function fX(o,e){for(var t=-1,r=o==null?0:o.length,n=0,i=[];++t<r;){var s=o[t];e(s,t,o)&&(i[n++]=s)}return i}Mw.exports=fX});var H4=ce((L1e,Ow)=>{function mX(){return[]}Ow.exports=mX});var V1=ce((D1e,Rw)=>{var _X=Nw(),gX=H4(),vX=Object.prototype,yX=vX.propertyIsEnumerable,Pw=Object.getOwnPropertySymbols,xX=Pw?function(o){return o==null?[]:(o=Object(o),_X(Pw(o),function(e){return yX.call(o,e)}))}:gX;Rw.exports=xX});var Lw=ce((k1e,Iw)=>{var bX=rh(),TX=V1();function AX(o,e){return bX(o,TX(o),e)}Iw.exports=AX});var j4=ce((B1e,Dw)=>{function CX(o,e){for(var t=-1,r=e.length,n=o.length;++t<r;)o[n+t]=e[t];return o}Dw.exports=CX});var W4=ce((F1e,kw)=>{var EX=G4(),SX=EX(Object.getPrototypeOf,Object);kw.exports=SX});var q4=ce((U1e,Bw)=>{var wX=j4(),MX=W4(),NX=V1(),OX=H4(),PX=Object.getOwnPropertySymbols,RX=PX?function(o){for(var e=[];o;)wX(e,NX(o)),o=MX(o);return e}:OX;Bw.exports=RX});var Uw=ce((V1e,Fw)=>{var IX=rh(),LX=q4();function DX(o,e){return IX(o,LX(o),e)}Fw.exports=DX});var X4=ce((G1e,Vw)=>{var kX=j4(),BX=L1();function FX(o,e,t){var r=e(o);return BX(o)?r:kX(r,t(o))}Vw.exports=FX});var zw=ce((z1e,Gw)=>{var UX=X4(),VX=V1(),GX=F1();function zX(o){return UX(o,GX,VX)}Gw.exports=zX});var jw=ce((H1e,Hw)=>{var HX=X4(),jX=q4(),WX=U1();function qX(o){return HX(o,WX,jX)}Hw.exports=qX});var qw=ce((j1e,Ww)=>{var XX=ea(),YX=ni(),$X=XX(YX,"DataView");Ww.exports=$X});var Yw=ce((W1e,Xw)=>{var KX=ea(),JX=ni(),ZX=KX(JX,"Promise");Xw.exports=ZX});var Kw=ce((q1e,$w)=>{var QX=ea(),eY=ni(),tY=QX(eY,"Set");$w.exports=tY});var Zw=ce((X1e,Jw)=>{var rY=ea(),oY=ni(),nY=rY(oY,"WeakMap");Jw.exports=nY});var G1=ce((Y1e,iM)=>{var Y4=qw(),$4=I1(),K4=Yw(),J4=Kw(),Z4=Zw(),nM=Nu(),ku=L4(),Qw="[object Map]",iY="[object Object]",eM="[object Promise]",tM="[object Set]",rM="[object WeakMap]",oM="[object DataView]",sY=ku(Y4),aY=ku($4),cY=ku(K4),lY=ku(J4),uY=ku(Z4),Cc=nM;(Y4&&Cc(new Y4(new ArrayBuffer(1)))!=oM||$4&&Cc(new $4)!=Qw||K4&&Cc(K4.resolve())!=eM||J4&&Cc(new J4)!=tM||Z4&&Cc(new Z4)!=rM)&&(Cc=function(o){var e=nM(o),t=e==iY?o.constructor:void 0,r=t?ku(t):"";if(r)switch(r){case sY:return oM;case aY:return Qw;case cY:return eM;case lY:return tM;case uY:return rM}return e});iM.exports=Cc});var aM=ce(($1e,sM)=>{var pY=Object.prototype,dY=pY.hasOwnProperty;function hY(o){var e=o.length,t=new o.constructor(e);return e&&typeof o[0]=="string"&&dY.call(o,"index")&&(t.index=o.index,t.input=o.input),t}sM.exports=hY});var lM=ce((K1e,cM)=>{var fY=ni(),mY=fY.Uint8Array;cM.exports=mY});var z1=ce((J1e,pM)=>{var uM=lM();function _Y(o){var e=new o.constructor(o.byteLength);return new uM(e).set(new uM(o)),e}pM.exports=_Y});var hM=ce((Z1e,dM)=>{var gY=z1();function vY(o,e){var t=e?gY(o.buffer):o.buffer;return new o.constructor(t,o.byteOffset,o.byteLength)}dM.exports=vY});var mM=ce((Q1e,fM)=>{var yY=/\w*$/;function xY(o){var e=new o.constructor(o.source,yY.exec(o));return e.lastIndex=o.lastIndex,e}fM.exports=xY});var xM=ce((e_e,yM)=>{var _M=R1(),gM=_M?_M.prototype:void 0,vM=gM?gM.valueOf:void 0;function bY(o){return vM?Object(vM.call(o)):{}}yM.exports=bY});var TM=ce((t_e,bM)=>{var TY=z1();function AY(o,e){var t=e?TY(o.buffer):o.buffer;return new o.constructor(t,o.byteOffset,o.length)}bM.exports=AY});var CM=ce((r_e,AM)=>{var CY=z1(),EY=hM(),SY=mM(),wY=xM(),MY=TM(),NY="[object Boolean]",OY="[object Date]",PY="[object Map]",RY="[object Number]",IY="[object RegExp]",LY="[object Set]",DY="[object String]",kY="[object Symbol]",BY="[object ArrayBuffer]",FY="[object DataView]",UY="[object Float32Array]",VY="[object Float64Array]",GY="[object Int8Array]",zY="[object Int16Array]",HY="[object Int32Array]",jY="[object Uint8Array]",WY="[object Uint8ClampedArray]",qY="[object Uint16Array]",XY="[object Uint32Array]";function YY(o,e,t){var r=o.constructor;switch(e){case BY:return CY(o);case NY:case OY:return new r(+o);case FY:return EY(o,t);case UY:case VY:case GY:case zY:case HY:case jY:case WY:case qY:case XY:return MY(o,t);case PY:return new r;case RY:case DY:return new r(o);case IY:return SY(o);case LY:return new r;case kY:return wY(o)}}AM.exports=YY});var wM=ce((o_e,SM)=>{var $Y=p0(),EM=Object.create,KY=function(){function o(){}return function(e){if(!$Y(e))return{};if(EM)return EM(e);o.prototype=e;var t=new o;return o.prototype=void 0,t}}();SM.exports=KY});var NM=ce((n_e,MM)=>{var JY=wM(),ZY=W4(),QY=B1();function e$(o){return typeof o.constructor=="function"&&!QY(o)?JY(ZY(o)):{}}MM.exports=e$});var PM=ce((i_e,OM)=>{var t$=G1(),r$=Ac(),o$="[object Map]";function n$(o){return r$(o)&&t$(o)==o$}OM.exports=n$});var DM=ce((s_e,LM)=>{var i$=PM(),s$=D1(),RM=k1(),IM=RM&&RM.isMap,a$=IM?s$(IM):i$;LM.exports=a$});var BM=ce((a_e,kM)=>{var c$=G1(),l$=Ac(),u$="[object Set]";function p$(o){return l$(o)&&c$(o)==u$}kM.exports=p$});var GM=ce((c_e,VM)=>{var d$=BM(),h$=D1(),FM=k1(),UM=FM&&FM.isSet,f$=UM?h$(UM):d$;VM.exports=f$});var Q4=ce((l_e,WM)=>{var m$=TS(),_$=CS(),g$=k4(),v$=hw(),y$=xw(),x$=Ew(),b$=ww(),T$=Lw(),A$=Uw(),C$=zw(),E$=jw(),S$=G1(),w$=aM(),M$=CM(),N$=NM(),O$=L1(),P$=B4(),R$=DM(),I$=p0(),L$=GM(),D$=F1(),k$=U1(),B$=1,F$=2,U$=4,zM="[object Arguments]",V$="[object Array]",G$="[object Boolean]",z$="[object Date]",H$="[object Error]",HM="[object Function]",j$="[object GeneratorFunction]",W$="[object Map]",q$="[object Number]",jM="[object Object]",X$="[object RegExp]",Y$="[object Set]",$$="[object String]",K$="[object Symbol]",J$="[object WeakMap]",Z$="[object ArrayBuffer]",Q$="[object DataView]",eK="[object Float32Array]",tK="[object Float64Array]",rK="[object Int8Array]",oK="[object Int16Array]",nK="[object Int32Array]",iK="[object Uint8Array]",sK="[object Uint8ClampedArray]",aK="[object Uint16Array]",cK="[object Uint32Array]",ar={};ar[zM]=ar[V$]=ar[Z$]=ar[Q$]=ar[G$]=ar[z$]=ar[eK]=ar[tK]=ar[rK]=ar[oK]=ar[nK]=ar[W$]=ar[q$]=ar[jM]=ar[X$]=ar[Y$]=ar[$$]=ar[K$]=ar[iK]=ar[sK]=ar[aK]=ar[cK]=!0;ar[H$]=ar[HM]=ar[J$]=!1;function H1(o,e,t,r,n,i){var s,a=e&B$,c=e&F$,l=e&U$;if(t&&(s=n?t(o,r,n,i):t(o)),s!==void 0)return s;if(!I$(o))return o;var u=O$(o);if(u){if(s=w$(o),!a)return b$(o,s)}else{var p=S$(o),d=p==HM||p==j$;if(P$(o))return x$(o,a);if(p==jM||p==zM||d&&!n){if(s=c||d?{}:N$(o),!a)return c?A$(o,y$(s,o)):T$(o,v$(s,o))}else{if(!ar[p])return n?o:{};s=M$(o,p,a)}}i||(i=new m$);var h=i.get(o);if(h)return h;i.set(o,s),L$(o)?o.forEach(function(v){s.add(H1(v,e,t,v,o,i))}):R$(o)&&o.forEach(function(v,g){s.set(g,H1(v,e,t,g,o,i))});var m=l?c?E$:C$:c?k$:D$,f=u?void 0:m(o);return _$(f||o,function(v,g){f&&(g=v,v=o[g]),g$(s,g,H1(v,e,t,g,o,i))}),s}WM.exports=H1});var XM=ce((u_e,qM)=>{var lK=Q4(),uK=1,pK=4;function dK(o){return lK(o,uK|pK)}qM.exports=dK});var $M=ce((p_e,YM)=>{var hK=Q4(),fK=4;function mK(o){return hK(o,fK)}YM.exports=mK});var TN=ce((gh,o_)=>{(function(o){"use strict";var e="Compound",t="Identifier",r="MemberExpression",n="Literal",i="ThisExpression",s="CallExpression",a="UnaryExpression",c="BinaryExpression",l="LogicalExpression",u="ConditionalExpression",p="ArrayExpression",d=46,h=44,m=39,f=34,v=40,g=41,_=91,T=93,b=63,x=59,A=58,E=function(X,W){var L=new Error(X+" at character "+W);throw L.index=W,L.description=X,L},S=!0,w={"-":S,"!":S,"~":S,"+":S},O={"||":1,"&&":2,"|":3,"^":4,"&":5,"==":6,"!=":6,"===":6,"!==":6,"<":7,">":7,"<=":7,">=":7,"<<":8,">>":8,">>>":8,"+":9,"-":9,"*":10,"/":10,"%":10},C=function(X){var W=0,L;for(var Ne in X)(L=Ne.length)>W&&X.hasOwnProperty(Ne)&&(W=L);return W},N=C(w),R=C(O),D={true:!0,false:!1,null:null},V="this",F=function(X){return O[X]||0},j=function(X,W,L){var Ne=X==="||"||X==="&&"?l:c;return{type:Ne,operator:X,left:W,right:L}},$=function(X){return X>=48&&X<=57},Y=function(X){return X===36||X===95||X>=65&&X<=90||X>=97&&X<=122||X>=128&&!O[String.fromCharCode(X)]},H=function(X){return X===36||X===95||X>=65&&X<=90||X>=97&&X<=122||X>=48&&X<=57||X>=128&&!O[String.fromCharCode(X)]},B=function(X){for(var W=0,L=X.charAt,Ne=X.charCodeAt,ye=function(ee){return L.call(X,ee)},ae=function(ee){return Ne.call(X,ee)},Ae=X.length,Ie=function(){for(var ee=ae(W);ee===32||ee===9||ee===10||ee===13;)ee=ae(++W)},Oe=function(){var ee=xe(),me,Z;if(Ie(),ae(W)===b){if(W++,me=Oe(),me||E("Expected expression",W),Ie(),ae(W)===A)return W++,Z=Oe(),Z||E("Expected expression",W),{type:u,test:ee,consequent:me,alternate:Z};E("Expected :",W)}else return ee},le=function(){Ie();for(var ee,me=X.substr(W,R),Z=me.length;Z>0;){if(O.hasOwnProperty(me)&&(!Y(ae(W))||W+me.length<X.length&&!H(ae(W+me.length))))return W+=Z,me;me=me.substr(0,--Z)}return!1},xe=function(){var ee,me,Z,Se,G,se,ve,Fe,q,Le;if(ve=be(),Z=le(),!Z)return ve;for(se={value:Z,prec:F(Z)},Fe=be(),Fe||E("Expected expression after "+Z,W),G=[ve,se,Fe];(Z=le())&&(Se=F(Z),Se!==0);){for(se={value:Z,prec:Se},Le=Z;G.length>2&&Se<=G[G.length-2].prec;)Fe=G.pop(),Z=G.pop().value,ve=G.pop(),me=j(Z,ve,Fe),G.push(me);me=be(),me||E("Expected expression after "+Le,W),G.push(se,me)}for(q=G.length-1,me=G[q];q>1;)me=j(G[q-1].value,G[q-2],me),q-=2;return me},be=function(){var ee,me,Z;if(Ie(),ee=ae(W),$(ee)||ee===d)return ne();if(ee===m||ee===f)return he();if(ee===_)return et();for(me=X.substr(W,N),Z=me.length;Z>0;){if(w.hasOwnProperty(me)&&(!Y(ae(W))||W+me.length<X.length&&!H(ae(W+me.length))))return W+=Z,{type:a,operator:me,argument:be(),prefix:!0};me=me.substr(0,--Z)}return Y(ee)||ee===v?Pe():!1},ne=function(){for(var ee="",me,Z;$(ae(W));)ee+=ye(W++);if(ae(W)===d)for(ee+=ye(W++);$(ae(W));)ee+=ye(W++);if(me=ye(W),me==="e"||me==="E"){for(ee+=ye(W++),me=ye(W),(me==="+"||me==="-")&&(ee+=ye(W++));$(ae(W));)ee+=ye(W++);$(ae(W-1))||E("Expected exponent ("+ee+ye(W)+")",W)}return Z=ae(W),Y(Z)?E("Variable names cannot start with a number ("+ee+ye(W)+")",W):Z===d&&E("Unexpected period",W),{type:n,value:parseFloat(ee),raw:ee}},he=function(){for(var ee="",me=ye(W++),Z=!1,Se;W<Ae;)if(Se=ye(W++),Se===me){Z=!0;break}else if(Se==="\\")switch(Se=ye(W++),Se){case"n":ee+=`
`;break;case"r":ee+="\r";break;case"t":ee+="	";break;case"b":ee+="\b";break;case"f":ee+="\f";break;case"v":ee+="\v";break;default:ee+=Se}else ee+=Se;return Z||E('Unclosed quote after "'+ee+'"',W),{type:n,value:ee,raw:me+ee+me}},we=function(){var ee=ae(W),me=W,Z;for(Y(ee)?W++:E("Unexpected "+ye(W),W);W<Ae&&(ee=ae(W),H(ee));)W++;return Z=X.slice(me,W),D.hasOwnProperty(Z)?{type:n,value:D[Z],raw:Z}:Z===V?{type:i}:{type:t,name:Z}},Ee=function(ee){for(var me,Z=[],Se,G=!1,se=0;W<Ae;)if(Ie(),me=ae(W),me===ee){G=!0,W++,ee===g&&se&&se>=Z.length&&E("Unexpected token "+String.fromCharCode(ee),W);break}else if(me===h){if(W++,se++,se!==Z.length){if(ee===g)E("Unexpected token ,",W);else if(ee===T)for(var ve=Z.length;ve<se;ve++)Z.push(null)}}else Se=Oe(),(!Se||Se.type===e)&&E("Expected comma",W),Z.push(Se);return G||E("Expected "+String.fromCharCode(ee),W),Z},Pe=function(){var ee,me;for(ee=ae(W),ee===v?me=Xe():me=we(),Ie(),ee=ae(W);ee===d||ee===_||ee===v;)W++,ee===d?(Ie(),me={type:r,computed:!1,object:me,property:we()}):ee===_?(me={type:r,computed:!0,object:me,property:Oe()},Ie(),ee=ae(W),ee!==T&&E("Unclosed [",W),W++):ee===v&&(me={type:s,arguments:Ee(g),callee:me}),Ie(),ee=ae(W);return me},Xe=function(){W++;var ee=Oe();if(Ie(),ae(W)===g)return W++,ee;E("Unclosed (",W)},et=function(){return W++,{type:p,elements:Ee(T)}},k=[],P,fe;W<Ae;)P=ae(W),P===x||P===h?W++:(fe=Oe())?k.push(fe):W<Ae&&E('Unexpected "'+ye(W)+'"',W);return k.length===1?k[0]:{type:e,body:k}};if(B.version="0.3.5",B.toString=function(){return"JavaScript Expression Parser (JSEP) v"+B.version},B.addUnaryOp=function(X){return N=Math.max(X.length,N),w[X]=S,this},B.addBinaryOp=function(X,W){return R=Math.max(X.length,R),O[X]=W,this},B.addLiteral=function(X,W){return D[X]=W,this},B.removeUnaryOp=function(X){return delete w[X],X.length===N&&(N=C(w)),this},B.removeAllUnaryOps=function(){return w={},N=0,this},B.removeBinaryOp=function(X){return delete O[X],X.length===R&&(R=C(O)),this},B.removeAllBinaryOps=function(){return O={},R=0,this},B.removeLiteral=function(X){return delete D[X],this},B.removeAllLiterals=function(){return D={},this},typeof gh>"u"){var te=o.jsep;o.jsep=B,B.noConflict=function(){return o.jsep===B&&(o.jsep=te),B}}else typeof o_<"u"&&o_.exports?gh=o_.exports=B:gh.parse=B})(gh)});var wP=ce((ESe,Kh)=>{function YQ(o){if(Array.isArray(o))return o}Kh.exports=YQ,Kh.exports.__esModule=!0,Kh.exports.default=Kh.exports});var MP=ce((SSe,Jh)=>{function $Q(o,e){var t=o==null?null:typeof Symbol<"u"&&o[Symbol.iterator]||o["@@iterator"];if(t!=null){var r=[],n=!0,i=!1,s,a;try{for(t=t.call(o);!(n=(s=t.next()).done)&&(r.push(s.value),!(e&&r.length===e));n=!0);}catch(c){i=!0,a=c}finally{try{!n&&t.return!=null&&t.return()}finally{if(i)throw a}}return r}}Jh.exports=$Q,Jh.exports.__esModule=!0,Jh.exports.default=Jh.exports});var NP=ce((wSe,Zh)=>{function KQ(o,e){(e==null||e>o.length)&&(e=o.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=o[t];return r}Zh.exports=KQ,Zh.exports.__esModule=!0,Zh.exports.default=Zh.exports});var PP=ce((MSe,Qh)=>{var OP=NP();function JQ(o,e){if(!!o){if(typeof o=="string")return OP(o,e);var t=Object.prototype.toString.call(o).slice(8,-1);if(t==="Object"&&o.constructor&&(t=o.constructor.name),t==="Map"||t==="Set")return Array.from(o);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return OP(o,e)}}Qh.exports=JQ,Qh.exports.__esModule=!0,Qh.exports.default=Qh.exports});var RP=ce((NSe,ef)=>{function ZQ(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}ef.exports=ZQ,ef.exports.__esModule=!0,ef.exports.default=ef.exports});var IP=ce((OSe,tf)=>{var QQ=wP(),eee=MP(),tee=PP(),ree=RP();function oee(o,e){return QQ(o)||eee(o,e)||tee(o,e)||ree()}tf.exports=oee,tf.exports.__esModule=!0,tf.exports.default=tf.exports});var LP=ce((PSe,rf)=>{function nee(o,e){if(!(o instanceof e))throw new TypeError("Cannot call a class as a function")}rf.exports=nee,rf.exports.__esModule=!0,rf.exports.default=rf.exports});var kP=ce((RSe,of)=>{function DP(o,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(o,r.key,r)}}function iee(o,e,t){return e&&DP(o.prototype,e),t&&DP(o,t),Object.defineProperty(o,"prototype",{writable:!1}),o}of.exports=iee,of.exports.__esModule=!0,of.exports.default=of.exports});var A7=ce((K_,BP)=>{(function(o,e){typeof K_=="object"&&typeof BP<"u"?e(K_,IP(),LP(),kP()):typeof define=="function"&&define.amd?define(["exports","@babel/runtime/helpers/slicedToArray","@babel/runtime/helpers/classCallCheck","@babel/runtime/helpers/createClass"],e):(o=typeof globalThis<"u"?globalThis:o||self,e(o.automationEvents={},o._slicedToArray,o._classCallCheck,o._createClass))})(K_,function(o,e,t,r){"use strict";function n($){return $&&typeof $=="object"&&"default"in $?$:{default:$}}var i=n(e),s=n(t),a=n(r),c=function(Y,H,B){return{endTime:H,insertTime:B,type:"exponentialRampToValue",value:Y}},l=function(Y,H,B){return{endTime:H,insertTime:B,type:"linearRampToValue",value:Y}},u=function(Y,H){return{startTime:H,type:"setValue",value:Y}},p=function(Y,H,B){return{duration:B,startTime:H,type:"setValueCurve",values:Y}},d=function(Y,H,B){var te=B.startTime,X=B.target,W=B.timeConstant;return X+(H-X)*Math.exp((te-Y)/W)},h=function(Y){return Y.type==="exponentialRampToValue"},m=function(Y){return Y.type==="linearRampToValue"},f=function(Y){return h(Y)||m(Y)},v=function(Y){return Y.type==="setValue"},g=function(Y){return Y.type==="setValueCurve"},_=function $(Y,H,B,te){var X=Y[H];return X===void 0?te:f(X)||v(X)?X.value:g(X)?X.values[X.values.length-1]:d(B,$(Y,H-1,X.startTime,te),X)},T=function(Y,H,B,te,X){return B===void 0?[te.insertTime,X]:f(B)?[B.endTime,B.value]:v(B)?[B.startTime,B.value]:g(B)?[B.startTime+B.duration,B.values[B.values.length-1]]:[B.startTime,_(Y,H-1,B.startTime,X)]},b=function(Y){return Y.type==="cancelAndHold"},x=function(Y){return Y.type==="cancelScheduledValues"},A=function(Y){return b(Y)||x(Y)?Y.cancelTime:h(Y)||m(Y)?Y.endTime:Y.startTime},E=function(Y,H,B,te){var X=te.endTime,W=te.value;return B===W?W:0<B&&0<W||B<0&&W<0?B*Math.pow(W/B,(Y-H)/(X-H)):0},S=function(Y,H,B,te){var X=te.endTime,W=te.value;return B+(Y-H)/(X-H)*(W-B)},w=function(Y,H){var B=Math.floor(H),te=Math.ceil(H);return B===te?Y[B]:(1-(H-B))*Y[B]+(1-(te-H))*Y[te]},O=function(Y,H){var B=H.duration,te=H.startTime,X=H.values,W=(Y-te)/B*(X.length-1);return w(X,W)},C=function(Y){return Y.type==="setTarget"},N=function($){function Y(H){s.default(this,Y),this._automationEvents=[],this._currenTime=0,this._defaultValue=H}return a.default(Y,[{key:$,value:function(){return this._automationEvents[Symbol.iterator]()}},{key:"add",value:function(B){var te=A(B);if(b(B)||x(B)){var X=this._automationEvents.findIndex(function(xe){return x(B)&&g(xe)?xe.startTime+xe.duration>=te:A(xe)>=te}),W=this._automationEvents[X];if(X!==-1&&(this._automationEvents=this._automationEvents.slice(0,X)),b(B)){var L=this._automationEvents[this._automationEvents.length-1];if(W!==void 0&&f(W)){if(C(L))throw new Error("The internal list is malformed.");var Ne=g(L)?L.startTime+L.duration:A(L),ye=g(L)?L.values[L.values.length-1]:L.value,ae=h(W)?E(te,Ne,ye,W):S(te,Ne,ye,W),Ae=h(W)?c(ae,te,this._currenTime):l(ae,te,this._currenTime);this._automationEvents.push(Ae)}L!==void 0&&C(L)&&this._automationEvents.push(u(this.getValue(te),te)),L!==void 0&&g(L)&&L.startTime+L.duration>te&&(this._automationEvents[this._automationEvents.length-1]=p(new Float32Array([6,7]),L.startTime,te-L.startTime))}}else{var Ie=this._automationEvents.findIndex(function(xe){return A(xe)>te}),Oe=Ie===-1?this._automationEvents[this._automationEvents.length-1]:this._automationEvents[Ie-1];if(Oe!==void 0&&g(Oe)&&A(Oe)+Oe.duration>te)return!1;var le=h(B)?c(B.value,B.endTime,this._currenTime):m(B)?l(B.value,te,this._currenTime):B;if(Ie===-1)this._automationEvents.push(le);else{if(g(B)&&te+B.duration>A(this._automationEvents[Ie]))return!1;this._automationEvents.splice(Ie,0,le)}}return!0}},{key:"flush",value:function(B){var te=this._automationEvents.findIndex(function(L){return A(L)>B});if(te>1){var X=this._automationEvents.slice(te-1),W=X[0];C(W)&&X.unshift(u(_(this._automationEvents,te-2,W.startTime,this._defaultValue),W.startTime)),this._automationEvents=X}}},{key:"getValue",value:function(B){if(this._automationEvents.length===0)return this._defaultValue;var te=this._automationEvents.findIndex(function(be){return A(be)>B}),X=this._automationEvents[te],W=(te===-1?this._automationEvents.length:te)-1,L=this._automationEvents[W];if(L!==void 0&&C(L)&&(X===void 0||!f(X)||X.insertTime>B))return d(B,_(this._automationEvents,W-1,L.startTime,this._defaultValue),L);if(L!==void 0&&v(L)&&(X===void 0||!f(X)))return L.value;if(L!==void 0&&g(L)&&(X===void 0||!f(X)||L.startTime+L.duration>B))return B<L.startTime+L.duration?O(B,L):L.values[L.values.length-1];if(L!==void 0&&f(L)&&(X===void 0||!f(X)))return L.value;if(X!==void 0&&h(X)){var Ne=T(this._automationEvents,W,L,X,this._defaultValue),ye=i.default(Ne,2),ae=ye[0],Ae=ye[1];return E(B,ae,Ae,X)}if(X!==void 0&&m(X)){var Ie=T(this._automationEvents,W,L,X,this._defaultValue),Oe=i.default(Ie,2),le=Oe[0],xe=Oe[1];return S(B,le,xe,X)}return this._defaultValue}}]),Y}(Symbol.iterator),R=function(Y){return{cancelTime:Y,type:"cancelAndHold"}},D=function(Y){return{cancelTime:Y,type:"cancelScheduledValues"}},V=function(Y,H){return{endTime:H,type:"exponentialRampToValue",value:Y}},F=function(Y,H){return{endTime:H,type:"linearRampToValue",value:Y}},j=function(Y,H,B){return{startTime:H,target:Y,timeConstant:B,type:"setTarget"}};o.AutomationEventList=N,o.createCancelAndHoldAutomationEvent=R,o.createCancelScheduledValuesAutomationEvent=D,o.createExponentialRampToValueAutomationEvent=V,o.createLinearRampToValueAutomationEvent=F,o.createSetTargetAutomationEvent=j,o.createSetValueAutomationEvent=u,o.createSetValueCurveAutomationEvent=p,Object.defineProperty(o,"__esModule",{value:!0})})});var sk=ce((d$e,T9)=>{var VD,GD,zD,HD,jD,WD,qD,XD,YD,x9,eg,$D,KD,JD,Up,ZD,QD,ek,tk,rk,ok,nk,ik,b9;(function(o){var e=typeof global=="object"?global:typeof self=="object"?self:typeof this=="object"?this:{};typeof define=="function"&&define.amd?define("tslib",["exports"],function(r){o(t(e,t(r)))}):typeof T9=="object"&&typeof T9.exports=="object"?o(t(e,t(T9.exports))):o(t(e));function t(r,n){return r!==e&&(typeof Object.create=="function"?Object.defineProperty(r,"__esModule",{value:!0}):r.__esModule=!0),function(i,s){return r[i]=n?n(i,s):s}}})(function(o){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])};VD=function(r,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(r,n);function i(){this.constructor=r}r.prototype=n===null?Object.create(n):(i.prototype=n.prototype,new i)},GD=Object.assign||function(r){for(var n,i=1,s=arguments.length;i<s;i++){n=arguments[i];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(r[a]=n[a])}return r},zD=function(r,n){var i={};for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&n.indexOf(s)<0&&(i[s]=r[s]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,s=Object.getOwnPropertySymbols(r);a<s.length;a++)n.indexOf(s[a])<0&&Object.prototype.propertyIsEnumerable.call(r,s[a])&&(i[s[a]]=r[s[a]]);return i},HD=function(r,n,i,s){var a=arguments.length,c=a<3?n:s===null?s=Object.getOwnPropertyDescriptor(n,i):s,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(r,n,i,s);else for(var u=r.length-1;u>=0;u--)(l=r[u])&&(c=(a<3?l(c):a>3?l(n,i,c):l(n,i))||c);return a>3&&c&&Object.defineProperty(n,i,c),c},jD=function(r,n){return function(i,s){n(i,s,r)}},WD=function(r,n){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,n)},qD=function(r,n,i,s){function a(c){return c instanceof i?c:new i(function(l){l(c)})}return new(i||(i=Promise))(function(c,l){function u(h){try{d(s.next(h))}catch(m){l(m)}}function p(h){try{d(s.throw(h))}catch(m){l(m)}}function d(h){h.done?c(h.value):a(h.value).then(u,p)}d((s=s.apply(r,n||[])).next())})},XD=function(r,n){var i={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},s,a,c,l;return l={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function u(d){return function(h){return p([d,h])}}function p(d){if(s)throw new TypeError("Generator is already executing.");for(;i;)try{if(s=1,a&&(c=d[0]&2?a.return:d[0]?a.throw||((c=a.return)&&c.call(a),0):a.next)&&!(c=c.call(a,d[1])).done)return c;switch(a=0,c&&(d=[d[0]&2,c.value]),d[0]){case 0:case 1:c=d;break;case 4:return i.label++,{value:d[1],done:!1};case 5:i.label++,a=d[1],d=[0];continue;case 7:d=i.ops.pop(),i.trys.pop();continue;default:if(c=i.trys,!(c=c.length>0&&c[c.length-1])&&(d[0]===6||d[0]===2)){i=0;continue}if(d[0]===3&&(!c||d[1]>c[0]&&d[1]<c[3])){i.label=d[1];break}if(d[0]===6&&i.label<c[1]){i.label=c[1],c=d;break}if(c&&i.label<c[2]){i.label=c[2],i.ops.push(d);break}c[2]&&i.ops.pop(),i.trys.pop();continue}d=n.call(r,i)}catch(h){d=[6,h],a=0}finally{s=c=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}},YD=function(r,n){for(var i in r)i!=="default"&&!Object.prototype.hasOwnProperty.call(n,i)&&b9(n,r,i)},b9=Object.create?function(r,n,i,s){s===void 0&&(s=i),Object.defineProperty(r,s,{enumerable:!0,get:function(){return n[i]}})}:function(r,n,i,s){s===void 0&&(s=i),r[s]=n[i]},x9=function(r){var n=typeof Symbol=="function"&&Symbol.iterator,i=n&&r[n],s=0;if(i)return i.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&s>=r.length&&(r=void 0),{value:r&&r[s++],done:!r}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")},eg=function(r,n){var i=typeof Symbol=="function"&&r[Symbol.iterator];if(!i)return r;var s=i.call(r),a,c=[],l;try{for(;(n===void 0||n-- >0)&&!(a=s.next()).done;)c.push(a.value)}catch(u){l={error:u}}finally{try{a&&!a.done&&(i=s.return)&&i.call(s)}finally{if(l)throw l.error}}return c},$D=function(){for(var r=[],n=0;n<arguments.length;n++)r=r.concat(eg(arguments[n]));return r},KD=function(){for(var r=0,n=0,i=arguments.length;n<i;n++)r+=arguments[n].length;for(var s=Array(r),a=0,n=0;n<i;n++)for(var c=arguments[n],l=0,u=c.length;l<u;l++,a++)s[a]=c[l];return s},JD=function(r,n,i){if(i||arguments.length===2)for(var s=0,a=n.length,c;s<a;s++)(c||!(s in n))&&(c||(c=Array.prototype.slice.call(n,0,s)),c[s]=n[s]);return r.concat(c||Array.prototype.slice.call(n))},Up=function(r){return this instanceof Up?(this.v=r,this):new Up(r)},ZD=function(r,n,i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=i.apply(r,n||[]),a,c=[];return a={},l("next"),l("throw"),l("return"),a[Symbol.asyncIterator]=function(){return this},a;function l(f){s[f]&&(a[f]=function(v){return new Promise(function(g,_){c.push([f,v,g,_])>1||u(f,v)})})}function u(f,v){try{p(s[f](v))}catch(g){m(c[0][3],g)}}function p(f){f.value instanceof Up?Promise.resolve(f.value.v).then(d,h):m(c[0][2],f)}function d(f){u("next",f)}function h(f){u("throw",f)}function m(f,v){f(v),c.shift(),c.length&&u(c[0][0],c[0][1])}},QD=function(r){var n,i;return n={},s("next"),s("throw",function(a){throw a}),s("return"),n[Symbol.iterator]=function(){return this},n;function s(a,c){n[a]=r[a]?function(l){return(i=!i)?{value:Up(r[a](l)),done:a==="return"}:c?c(l):l}:c}},ek=function(r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r[Symbol.asyncIterator],i;return n?n.call(r):(r=typeof x9=="function"?x9(r):r[Symbol.iterator](),i={},s("next"),s("throw"),s("return"),i[Symbol.asyncIterator]=function(){return this},i);function s(c){i[c]=r[c]&&function(l){return new Promise(function(u,p){l=r[c](l),a(u,p,l.done,l.value)})}}function a(c,l,u,p){Promise.resolve(p).then(function(d){c({value:d,done:u})},l)}},tk=function(r,n){return Object.defineProperty?Object.defineProperty(r,"raw",{value:n}):r.raw=n,r};var t=Object.create?function(r,n){Object.defineProperty(r,"default",{enumerable:!0,value:n})}:function(r,n){r.default=n};rk=function(r){if(r&&r.__esModule)return r;var n={};if(r!=null)for(var i in r)i!=="default"&&Object.prototype.hasOwnProperty.call(r,i)&&b9(n,r,i);return t(n,r),n},ok=function(r){return r&&r.__esModule?r:{default:r}},nk=function(r,n,i,s){if(i==="a"&&!s)throw new TypeError("Private accessor was defined without a getter");if(typeof n=="function"?r!==n||!s:!n.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return i==="m"?s:i==="a"?s.call(r):s?s.value:n.get(r)},ik=function(r,n,i,s,a){if(s==="m")throw new TypeError("Private method is not writable");if(s==="a"&&!a)throw new TypeError("Private accessor was defined without a setter");if(typeof n=="function"?r!==n||!a:!n.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return s==="a"?a.call(r,i):a?a.value=i:n.set(r,i),i},o("__extends",VD),o("__assign",GD),o("__rest",zD),o("__decorate",HD),o("__param",jD),o("__metadata",WD),o("__awaiter",qD),o("__generator",XD),o("__exportStar",YD),o("__createBinding",b9),o("__values",x9),o("__read",eg),o("__spread",$D),o("__spreadArrays",KD),o("__spreadArray",JD),o("__await",Up),o("__asyncGenerator",ZD),o("__asyncDelegator",QD),o("__asyncValues",ek),o("__makeTemplateObject",tk),o("__importStar",rk),o("__importDefault",ok),o("__classPrivateFieldGet",nk),o("__classPrivateFieldSet",ik)})});var OB=ce((Rat,NB)=>{var qre=ni(),Xre=function(){return qre.Date.now()};NB.exports=Xre});var RB=ce((Iat,PB)=>{var Yre=/\s/;function $re(o){for(var e=o.length;e--&&Yre.test(o.charAt(e)););return e}PB.exports=$re});var LB=ce((Lat,IB)=>{var Kre=RB(),Jre=/^\s+/;function Zre(o){return o&&o.slice(0,Kre(o)+1).replace(Jre,"")}IB.exports=Zre});var kB=ce((Dat,DB)=>{var Qre=Nu(),eoe=Ac(),toe="[object Symbol]";function roe(o){return typeof o=="symbol"||eoe(o)&&Qre(o)==toe}DB.exports=roe});var VB=ce((kat,UB)=>{var ooe=LB(),BB=p0(),noe=kB(),FB=0/0,ioe=/^[-+]0x[0-9a-f]+$/i,soe=/^0b[01]+$/i,aoe=/^0o[0-7]+$/i,coe=parseInt;function loe(o){if(typeof o=="number")return o;if(noe(o))return FB;if(BB(o)){var e=typeof o.valueOf=="function"?o.valueOf():o;o=BB(e)?e+"":e}if(typeof o!="string")return o===0?o:+o;o=ooe(o);var t=soe.test(o);return t||aoe.test(o)?coe(o.slice(2),t?2:8):ioe.test(o)?FB:+o}UB.exports=loe});var HB=ce((Bat,zB)=>{var uoe=p0(),Fg=OB(),GB=VB(),poe="Expected a function",doe=Math.max,hoe=Math.min;function foe(o,e,t){var r,n,i,s,a,c,l=0,u=!1,p=!1,d=!0;if(typeof o!="function")throw new TypeError(poe);e=GB(e)||0,uoe(t)&&(u=!!t.leading,p="maxWait"in t,i=p?doe(GB(t.maxWait)||0,e):i,d="trailing"in t?!!t.trailing:d);function h(A){var E=r,S=n;return r=n=void 0,l=A,s=o.apply(S,E),s}function m(A){return l=A,a=setTimeout(g,e),u?h(A):s}function f(A){var E=A-c,S=A-l,w=e-E;return p?hoe(w,i-S):w}function v(A){var E=A-c,S=A-l;return c===void 0||E>=e||E<0||p&&S>=i}function g(){var A=Fg();if(v(A))return _(A);a=setTimeout(g,f(A))}function _(A){return a=void 0,d&&r?h(A):(r=n=void 0,s)}function T(){a!==void 0&&clearTimeout(a),l=0,r=c=n=a=void 0}function b(){return a===void 0?s:_(Fg())}function x(){var A=Fg(),E=v(A);if(r=arguments,n=this,c=A,E){if(a===void 0)return m(c);if(p)return clearTimeout(a),a=setTimeout(g,e),h(c)}return a===void 0&&(a=setTimeout(g,e)),s}return x.cancel=T,x.flush=b,x}zB.exports=foe});var WB=ce((Fat,jB)=>{var moe=HB(),_oe=p0(),goe="Expected a function";function voe(o,e,t){var r=!0,n=!0;if(typeof o!="function")throw new TypeError(goe);return _oe(t)&&(r="leading"in t?!!t.leading:r,n="trailing"in t?!!t.trailing:n),moe(o,e,{leading:r,maxWait:e,trailing:n})}jB.exports=voe});var oF=ce((wpt,rF)=>{rF.exports=`#define LIGHT_WORLD_SIZE 0.005
// #define LIGHT_FRUSTUM_WIDTH 1.0
// #define PCSS_FILTER_SIZE 1.0
#define LIGHT_SIZE_UV (PCSS_FILTER_SIZE * LIGHT_WORLD_SIZE)
#define NEAR_PLANE 9.5

#define NUM_SAMPLES 17
#define NUM_RINGS 11
#define BLOCKER_SEARCH_NUM_SAMPLES NUM_SAMPLES

vec2 poissonDisk[NUM_SAMPLES];

void initPoissonSamples( const in vec2 randomSeed ) {
	float ANGLE_STEP = PI2 * float( NUM_RINGS ) / float( NUM_SAMPLES );
	float INV_NUM_SAMPLES = 1.0 / float( NUM_SAMPLES );

	// jsfiddle that shows sample pattern: https://jsfiddle.net/a16ff1p7/
	float angle = rand( randomSeed ) * PI2;
	float radius = INV_NUM_SAMPLES;
	float radiusStep = radius;

	for( int i = 0; i < NUM_SAMPLES; i ++ ) {
		poissonDisk[i] = vec2( cos( angle ), sin( angle ) ) * pow( radius, 0.75 );
		radius += radiusStep;
		angle += ANGLE_STEP;
	}
}

float penumbraSize( const in float zReceiver, const in float zBlocker ) { // Parallel plane estimation
	return (zReceiver - zBlocker) / zBlocker;
}

float findBlocker( sampler2D shadowMap, const in vec2 uv, const in float zReceiver ) {
	// This uses similar triangles to compute what
	// area of the shadow map we should search
	float searchRadius = LIGHT_SIZE_UV * ( zReceiver - NEAR_PLANE ) / zReceiver;
	float blockerDepthSum = 0.0;
	int numBlockers = 0;

	for( int i = 0; i < BLOCKER_SEARCH_NUM_SAMPLES; i++ ) {
		float shadowMapDepth = unpackRGBAToDepth(texture2D(shadowMap, uv + poissonDisk[i] * searchRadius));
		if ( shadowMapDepth < zReceiver ) {
			blockerDepthSum += shadowMapDepth;
			numBlockers ++;
		}
	}

	if( numBlockers == 0 ) return -1.0;

	return blockerDepthSum / float( numBlockers );
}

float PCF_Filter(sampler2D shadowMap, vec2 uv, float zReceiver, float filterRadius ) {
	float sum = 0.0;
	float depth;
	#pragma unroll_loop_start
	for( int i = 0; i < 17; i ++ ) {
		depth = unpackRGBAToDepth( texture2D( shadowMap, uv + poissonDisk[ i ] * filterRadius ) );
		if( zReceiver <= depth ) sum += 1.0;
	}
	#pragma unroll_loop_end
	#pragma unroll_loop_start
	for( int i = 0; i < 17; i ++ ) {
		depth = unpackRGBAToDepth( texture2D( shadowMap, uv + -poissonDisk[ i ].yx * filterRadius ) );
		if( zReceiver <= depth ) sum += 1.0;
	}
	#pragma unroll_loop_end
	return sum / ( 2.0 * float( 17 ) );
}

float PCSS ( sampler2D shadowMap, vec4 coords ) {
	vec2 uv = coords.xy;
	float zReceiver = coords.z; // Assumed to be eye-space z in this code

	initPoissonSamples( uv );
	// STEP 1: blocker search
	float avgBlockerDepth = findBlocker( shadowMap, uv, zReceiver );

	//There are no occluders so early out (this saves filtering)
	if( avgBlockerDepth == -1.0 ) return 1.0;

	// STEP 2: penumbra size
	float penumbraRatio = penumbraSize( zReceiver, avgBlockerDepth );
	float filterRadius = penumbraRatio * LIGHT_SIZE_UV * NEAR_PLANE / zReceiver;

	// STEP 3: filtering
	//return avgBlockerDepth;
	return PCF_Filter( shadowMap, uv, zReceiver, filterRadius );
}`});var iF=ce((Mpt,nF)=>{nF.exports="return PCSS( shadowMap, shadowCoord );"});var YF=ce((n3t,XF)=>{XF.exports=`varying vec3 vNormal;
varying vec3 vWorldPosition;
varying vec3 vWorldOrigin;

void main(){
	// compute intensity
	vNormal		= normalize( normalMatrix * normal );

	vec4 worldPosition	= modelMatrix * vec4( position, 1.0 );
	vWorldPosition		= worldPosition.xyz;

	vec4 worldOrigin	= modelMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vWorldOrigin		= worldOrigin.xyz;

	// set gl_Position
	gl_Position	= projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`});var KF=ce((i3t,$F)=>{$F.exports=`varying vec3 vNormal;
varying vec3 vWorldPosition;
varying vec3 vWorldOrigin;

uniform vec3 lightColor;

// uniform vec3 spotPosition;

uniform float attenuation;
uniform float anglePower;

void main(){

	//////////////////////////////////////////////////////////
	// distance attenuation   //
	//////////////////////////////////////////////////////////
	float intensity = distance(vWorldPosition, vWorldOrigin) / attenuation;
	intensity = 1.0 - clamp(intensity, 0.0, 1.0);

	//////////////////////////////////////////////////////////
	// intensity on angle   //
	//////////////////////////////////////////////////////////
	vec3 normal = vec3(vNormal.x, vNormal.y, abs(vNormal.z));
	float angleIntensity = pow( dot(normal, vec3(0.0, 0.0, 1.0)), anglePower );
	intensity = intensity * angleIntensity;
	// 'gl_FragColor = vec4( lightColor, intensity );

	//////////////////////////////////////////////////////////
	// final color   //
	//////////////////////////////////////////////////////////

	// set the final color
	gl_FragColor = vec4( lightColor, intensity);
}`});var Q3=new M,aG=new M,cG=new qo,Io=class{constructor(e=new M(1,0,0),t=0){this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,r,n){return this.normal.set(e,t,r),this.constant=n,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,r){let n=Q3.subVectors(r,t).cross(aG.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(n,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){let e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)}intersectLine(e,t){let r=e.delta(Q3),n=this.normal.dot(r);if(n===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;let i=-(e.start.dot(this.normal)+this.constant)/n;return i<0||i>1?null:t.copy(r).multiplyScalar(i).add(e.start)}intersectsLine(e){let t=this.distanceToPoint(e.start),r=this.distanceToPoint(e.end);return t<0&&r>0||r<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){let r=t||cG.getNormalMatrix(e),n=this.coplanarPoint(Q3).applyMatrix4(e),i=this.normal.applyMatrix3(r).normalize();return this.constant=-n.dot(i),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}};Io.prototype.isPlane=!0;var _u=new X0,x1=new M,xc=class{constructor(e=new Io,t=new Io,r=new Io,n=new Io,i=new Io,s=new Io){this.planes=[e,t,r,n,i,s]}set(e,t,r,n,i,s){let a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(r),a[3].copy(n),a[4].copy(i),a[5].copy(s),this}copy(e){let t=this.planes;for(let r=0;r<6;r++)t[r].copy(e.planes[r]);return this}setFromProjectionMatrix(e){let t=this.planes,r=e.elements,n=r[0],i=r[1],s=r[2],a=r[3],c=r[4],l=r[5],u=r[6],p=r[7],d=r[8],h=r[9],m=r[10],f=r[11],v=r[12],g=r[13],_=r[14],T=r[15];return t[0].setComponents(a-n,p-c,f-d,T-v).normalize(),t[1].setComponents(a+n,p+c,f+d,T+v).normalize(),t[2].setComponents(a+i,p+l,f+h,T+g).normalize(),t[3].setComponents(a-i,p-l,f-h,T-g).normalize(),t[4].setComponents(a-s,p-u,f-m,T-_).normalize(),t[5].setComponents(a+s,p+u,f+m,T+_).normalize(),this}intersectsObject(e){let t=e.geometry;return t.boundingSphere===null&&t.computeBoundingSphere(),_u.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(_u)}intersectsSprite(e){return _u.center.set(0,0,0),_u.radius=.7071067811865476,_u.applyMatrix4(e.matrixWorld),this.intersectsSphere(_u)}intersectsSphere(e){let t=this.planes,r=e.center,n=-e.radius;for(let i=0;i<6;i++)if(t[i].distanceToPoint(r)<n)return!1;return!0}intersectsBox(e){let t=this.planes;for(let r=0;r<6;r++){let n=t[r];if(x1.x=n.normal.x>0?e.max.x:e.min.x,x1.y=n.normal.y>0?e.max.y:e.min.y,x1.z=n.normal.z>0?e.max.z:e.min.z,n.distanceToPoint(x1)<0)return!1}return!0}containsPoint(e){let t=this.planes;for(let r=0;r<6;r++)if(t[r].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}};function b1(){let o=null,e=!1,t=null,r=null;function n(i,s){t(i,s),r=o.requestAnimationFrame(n)}return{start:function(){e!==!0&&t!==null&&(r=o.requestAnimationFrame(n),e=!0)},stop:function(){o.cancelAnimationFrame(r),e=!1},setAnimationLoop:function(i){t=i},setContext:function(i){o=i}}}function db(o,e){let t=e.isWebGL2,r=new WeakMap;function n(l,u){let p=l.array,d=l.usage,h=o.createBuffer();o.bindBuffer(u,h),o.bufferData(u,p,d),l.onUploadCallback();let m=o.FLOAT;return p instanceof Float32Array?m=o.FLOAT:p instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):p instanceof Uint16Array?l.isFloat16BufferAttribute?t?m=o.HALF_FLOAT:console.warn("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2."):m=o.UNSIGNED_SHORT:p instanceof Int16Array?m=o.SHORT:p instanceof Uint32Array?m=o.UNSIGNED_INT:p instanceof Int32Array?m=o.INT:p instanceof Int8Array?m=o.BYTE:(p instanceof Uint8Array||p instanceof Uint8ClampedArray)&&(m=o.UNSIGNED_BYTE),{buffer:h,type:m,bytesPerElement:p.BYTES_PER_ELEMENT,version:l.version}}function i(l,u,p){let d=u.array,h=u.updateRange;o.bindBuffer(p,l),h.count===-1?o.bufferSubData(p,0,d):(t?o.bufferSubData(p,h.offset*d.BYTES_PER_ELEMENT,d,h.offset,h.count):o.bufferSubData(p,h.offset*d.BYTES_PER_ELEMENT,d.subarray(h.offset,h.offset+h.count)),h.count=-1)}function s(l){return l.isInterleavedBufferAttribute&&(l=l.data),r.get(l)}function a(l){l.isInterleavedBufferAttribute&&(l=l.data);let u=r.get(l);u&&(o.deleteBuffer(u.buffer),r.delete(l))}function c(l,u){if(l.isGLBufferAttribute){let d=r.get(l);(!d||d.version<l.version)&&r.set(l,{buffer:l.buffer,type:l.type,bytesPerElement:l.elementSize,version:l.version});return}l.isInterleavedBufferAttribute&&(l=l.data);let p=r.get(l);p===void 0?r.set(l,n(l,u)):p.version<l.version&&(i(p.buffer,l,u),p.version=l.version)}return{get:s,remove:a,update:c}}var Nn=class extends Re{constructor(e=1,t=1,r=1,n=1,i=1,s=1){super();this.type="BoxGeometry",this.parameters={width:e,height:t,depth:r,widthSegments:n,heightSegments:i,depthSegments:s};let a=this;n=Math.floor(n),i=Math.floor(i),s=Math.floor(s);let c=[],l=[],u=[],p=[],d=0,h=0;m("z","y","x",-1,-1,r,t,e,s,i,0),m("z","y","x",1,-1,r,t,-e,s,i,1),m("x","z","y",1,1,e,r,t,n,s,2),m("x","z","y",1,-1,e,r,-t,n,s,3),m("x","y","z",1,-1,e,t,r,n,i,4),m("x","y","z",-1,-1,e,t,-r,n,i,5),this.setIndex(c),this.setAttribute("position",new Ce(l,3)),this.setAttribute("normal",new Ce(u,3)),this.setAttribute("uv",new Ce(p,2));function m(f,v,g,_,T,b,x,A,E,S,w){let O=b/E,C=x/S,N=b/2,R=x/2,D=A/2,V=E+1,F=S+1,j=0,$=0,Y=new M;for(let H=0;H<F;H++){let B=H*C-R;for(let te=0;te<V;te++){let X=te*O-N;Y[f]=X*_,Y[v]=B*T,Y[g]=D,l.push(Y.x,Y.y,Y.z),Y[f]=0,Y[v]=0,Y[g]=A>0?1:-1,u.push(Y.x,Y.y,Y.z),p.push(te/E),p.push(1-H/S),j+=1}}for(let H=0;H<S;H++)for(let B=0;B<E;B++){let te=d+B+V*H,X=d+B+V*(H+1),W=d+(B+1)+V*(H+1),L=d+(B+1)+V*H;c.push(te,X,L),c.push(X,W,L),$+=6}a.addGroup(h,$,w),h+=$,d+=j}}static fromJSON(e){return new Nn(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}};var Ts=class extends Re{constructor(e=1,t=1,r=1,n=1){super();this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:r,heightSegments:n};let i=e/2,s=t/2,a=Math.floor(r),c=Math.floor(n),l=a+1,u=c+1,p=e/a,d=t/c,h=[],m=[],f=[],v=[];for(let g=0;g<u;g++){let _=g*d-s;for(let T=0;T<l;T++){let b=T*p-i;m.push(b,-_,0),f.push(0,0,1),v.push(T/a),v.push(1-g/c)}}for(let g=0;g<c;g++)for(let _=0;_<a;_++){let T=_+l*g,b=_+l*(g+1),x=_+1+l*(g+1),A=_+1+l*g;h.push(T,b,A),h.push(b,x,A)}this.setIndex(h),this.setAttribute("position",new Ce(m,3)),this.setAttribute("normal",new Ce(f,3)),this.setAttribute("uv",new Ce(v,2))}static fromJSON(e){return new Ts(e.width,e.height,e.widthSegments,e.heightSegments)}};function l0(o){let e={};for(let t in o){e[t]={};for(let r in o[t]){let n=o[t][r];n&&(n.isColor||n.isMatrix3||n.isMatrix4||n.isVector2||n.isVector3||n.isVector4||n.isTexture||n.isQuaternion)?e[t][r]=n.clone():Array.isArray(n)?e[t][r]=n.slice():e[t][r]=n}}return e}function go(o){let e={};for(let t=0;t<o.length;t++){let r=l0(o[t]);for(let n in r)e[n]=r[n]}return e}var T1={clone:l0,merge:go};var hb=`
void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}
`;var fb=`
void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}
`;var Sr=class extends Ut{constructor(e){super();this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader=hb,this.fragmentShader=fb,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&(e.attributes!==void 0&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=l0(e.uniforms),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){let t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(let n in this.uniforms){let s=this.uniforms[n].value;s&&s.isTexture?t.uniforms[n]={type:"t",value:s.toJSON(e).uuid}:s&&s.isColor?t.uniforms[n]={type:"c",value:s.getHex()}:s&&s.isVector2?t.uniforms[n]={type:"v2",value:s.toArray()}:s&&s.isVector3?t.uniforms[n]={type:"v3",value:s.toArray()}:s&&s.isVector4?t.uniforms[n]={type:"v4",value:s.toArray()}:s&&s.isMatrix3?t.uniforms[n]={type:"m3",value:s.toArray()}:s&&s.isMatrix4?t.uniforms[n]={type:"m4",value:s.toArray()}:t.uniforms[n]={value:s}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;let r={};for(let n in this.extensions)this.extensions[n]===!0&&(r[n]=!0);return Object.keys(r).length>0&&(t.extensions=r),t}};Sr.prototype.isShaderMaterial=!0;var mb=`
#ifdef USE_ALPHAMAP

	diffuseColor.a *= texture2D( alphaMap, vUv ).g;

#endif
`;var _b=`
#ifdef USE_ALPHAMAP

	uniform sampler2D alphaMap;

#endif
`;var gb=`
#ifdef USE_ALPHATEST

	if ( diffuseColor.a < alphaTest ) discard;

#endif
`;var vb=`
#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif
`;var yb=`
#ifdef USE_AOMAP

	// reads channel R, compatible with a combined OcclusionRoughnessMetallic (RGB) texture
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;

	reflectedLight.indirectDiffuse *= ambientOcclusion;

	#if defined( USE_ENVMAP ) && defined( STANDARD )

		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );

		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );

	#endif

#endif
`;var xb=`
#ifdef USE_AOMAP

	uniform sampler2D aoMap;
	uniform float aoMapIntensity;

#endif
`;var bb=`
vec3 transformed = vec3( position );
`;var Tb=`
vec3 objectNormal = vec3( normal );

#ifdef USE_TANGENT

	vec3 objectTangent = vec3( tangent.xyz );

#endif
`;var Ab=`

vec3 BRDF_Lambert( const in vec3 diffuseColor ) {

	return RECIPROCAL_PI * diffuseColor;

} // validated

vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {

	// Original approximation by Christophe Schlick '94
	// float fresnel = pow( 1.0 - dotVH, 5.0 );

	// Optimized variant (presented by Epic at SIGGRAPH '13)
	// https://cdn2.unrealengine.com/Resources/files/2013SiggraphPresentationsNotes-26915738.pdf
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );

	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );

} // validated

// Moving Frostbite to Physically Based Rendering 3.0 - page 12, listing 2
// https://seblagarde.files.wordpress.com/2015/07/course_notes_moving_frostbite_to_pbr_v32.pdf
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {

	float a2 = pow2( alpha );

	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );

	return 0.5 / max( gv + gl, EPSILON );

}

// Microfacet Models for Refraction through Rough Surfaces - equation (33)
// http://graphicrants.blogspot.com/2013/08/specular-brdf-reference.html
// alpha is "roughness squared" in Disney\u2019s reparameterization
float D_GGX( const in float alpha, const in float dotNH ) {

	float a2 = pow2( alpha );

	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0; // avoid alpha = 0 with dotNH = 1

	return RECIPROCAL_PI * a2 / pow2( denom );

}

// GGX Distribution, Schlick Fresnel, GGX_SmithCorrelated Visibility
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {

	float alpha = pow2( roughness ); // UE4's roughness

	vec3 halfDir = normalize( lightDir + viewDir );

	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );

	vec3 F = F_Schlick( f0, f90, dotVH );

	float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );

	float D = D_GGX( alpha, dotNH );

	return F * ( V * D );

}

// Rect Area Light

// Real-Time Polygonal-Light Shading with Linearly Transformed Cosines
// by Eric Heitz, Jonathan Dupuy, Stephen Hill and David Neubelt
// code: https://github.com/selfshadow/ltc_code/

vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {

	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;

	float dotNV = saturate( dot( N, V ) );

	// texture parameterized by sqrt( GGX alpha ) and sqrt( 1 - cos( theta ) )
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );

	uv = uv * LUT_SCALE + LUT_BIAS;

	return uv;

}

float LTC_ClippedSphereFormFactor( const in vec3 f ) {

	// Real-Time Area Lighting: a Journey from Research to Production (p.102)
	// An approximation of the form factor of a horizon-clipped rectangle.

	float l = length( f );

	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );

}

vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {

	float x = dot( v1, v2 );

	float y = abs( x );

	// rational polynomial approximation to theta / sin( theta ) / 2PI
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;

	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;

	return cross( v1, v2 ) * theta_sintheta;

}

vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {

	// bail if point is on back side of plane of light
	// assumes ccw winding order of light vertices
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );

	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );

	// construct orthonormal basis around N
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 ); // negated from paper; possibly due to a different handedness of world coordinate system

	// compute transform
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );

	// transform rect
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );

	// project rect onto sphere
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );

	// calculate vector form factor
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );

	// adjust for horizon clipping
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );

/*
	// alternate method of adjusting for horizon clipping (see referece)
	// refactoring required
	float len = length( vectorFormFactor );
	float z = vectorFormFactor.z / len;

	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;

	// tabulated horizon-clipped sphere, apparently...
	vec2 uv = vec2( z * 0.5 + 0.5, len );
	uv = uv * LUT_SCALE + LUT_BIAS;

	float scale = texture2D( ltc_2, uv ).w;

	float result = len * scale;
*/

	return vec3( result );

}

// End Rect Area Light


float G_BlinnPhong_Implicit( /* const in float dotNL, const in float dotNV */ ) {

	// geometry term is (n dot l)(n dot v) / 4(n dot l)(n dot v)
	return 0.25;

}

float D_BlinnPhong( const in float shininess, const in float dotNH ) {

	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );

}

vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {

	vec3 halfDir = normalize( lightDir + viewDir );

	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );

	vec3 F = F_Schlick( specularColor, 1.0, dotVH );

	float G = G_BlinnPhong_Implicit( /* dotNL, dotNV */ );

	float D = D_BlinnPhong( shininess, dotNH );

	return F * ( G * D );

} // validated

#if defined( USE_SHEEN )

// https://github.com/google/filament/blob/master/shaders/src/brdf.fs
float D_Charlie( float roughness, float dotNH ) {

	float alpha = pow2( roughness );

	// Estevez and Kulla 2017, "Production Friendly Microfacet Sheen BRDF"
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 ); // 2^(-14/2), so sin2h^2 > 0 in fp16

	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );

}

// https://github.com/google/filament/blob/master/shaders/src/brdf.fs
float V_Neubelt( float dotNV, float dotNL ) {

	// Neubelt and Pettineo 2013, "Crafting a Next-gen Material Pipeline for The Order: 1886"
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );

}

vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {

	vec3 halfDir = normalize( lightDir + viewDir );

	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );

	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );

	return sheenColor * ( D * V );

}

#endif
`;var Cb=`
#ifdef USE_BUMPMAP

	uniform sampler2D bumpMap;
	uniform float bumpScale;

	// Bump Mapping Unparametrized Surfaces on the GPU by Morten S. Mikkelsen
	// https://mmikk.github.io/papers3d/mm_sfgrad_bump.pdf

	// Evaluate the derivative of the height w.r.t. screen-space using forward differencing (listing 2)

	vec2 dHdxy_fwd() {

		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );

		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;

		return vec2( dBx, dBy );

	}

	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {

		// Workaround for Adreno 3XX dFd*( vec3 ) bug. See #9988

		vec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );
		vec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );
		vec3 vN = surf_norm;		// normalized

		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );

		float fDet = dot( vSigmaX, R1 ) * faceDirection;

		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );

	}

#endif
`;var Eb=`
#if NUM_CLIPPING_PLANES > 0

	vec4 plane;

	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {

		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;

	}
	#pragma unroll_loop_end

	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES

		bool clipped = true;

		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {

			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;

		}
		#pragma unroll_loop_end

		if ( clipped ) discard;

	#endif

#endif
`;var Sb=`
#if NUM_CLIPPING_PLANES > 0

	varying vec3 vClipPosition;

	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];

#endif
`;var wb=`
#if NUM_CLIPPING_PLANES > 0

	varying vec3 vClipPosition;

#endif
`;var Mb=`
#if NUM_CLIPPING_PLANES > 0

	vClipPosition = - mvPosition.xyz;

#endif
`;var Nb=`
#if defined( USE_COLOR_ALPHA )

	diffuseColor *= vColor;

#elif defined( USE_COLOR )

	diffuseColor.rgb *= vColor;

#endif
`;var Ob=`
#if defined( USE_COLOR_ALPHA )

	varying vec4 vColor;

#elif defined( USE_COLOR )

	varying vec3 vColor;

#endif
`;var Pb=`
#if defined( USE_COLOR_ALPHA )

	varying vec4 vColor;

#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )

	varying vec3 vColor;

#endif
`;var Rb=`
#if defined( USE_COLOR_ALPHA )

	vColor = vec4( 1.0 );

#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )

	vColor = vec3( 1.0 );

#endif

#ifdef USE_COLOR

	vColor *= color;

#endif

#ifdef USE_INSTANCING_COLOR

	vColor.xyz *= instanceColor.xyz;

#endif
`;var Ib=`
#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6

#ifndef saturate
// <tonemapping_pars_fragment> may have defined saturate() already
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )

float pow2( const in float x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }

// expects values in the range of [0,1]x[0,1], returns values in the [0,1] range.
// do not collapse into a single function per: http://byteblacksmith.com/improvements-to-the-canonical-one-liner-glsl-rand-for-opengl-es-2-0/
highp float rand( const in vec2 uv ) {

	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );

	return fract( sin( sn ) * c );

}

#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif

struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};

struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};

struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal;
#endif
};

vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

}

vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {

	// dir can be either a direction vector or a normal vector
	// upper-left 3x3 of matrix is assumed to be orthogonal

	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );

}

mat3 transposeMat3( const in mat3 m ) {

	mat3 tmp;

	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );

	return tmp;

}

// https://en.wikipedia.org/wiki/Relative_luminance
float linearToRelativeLuminance( const in vec3 color ) {

	vec3 weights = vec3( 0.2126, 0.7152, 0.0722 );

	return dot( weights, color.rgb );

}

bool isPerspectiveMatrix( mat4 m ) {

	return m[ 2 ][ 3 ] == - 1.0;

}

vec2 equirectUv( in vec3 dir ) {

	// dir is assumed to be unit length

	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;

	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;

	return vec2( u, v );

}
`;var Lb=`
#ifdef ENVMAP_TYPE_CUBE_UV

	#define cubeUV_maxMipLevel 8.0
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_maxTileSize 256.0
	#define cubeUV_minTileSize 16.0

	// These shader functions convert between the UV coordinates of a single face of
	// a cubemap, the 0-5 integer index of a cube face, and the direction vector for
	// sampling a textureCube (not generally normalized ).

	float getFace( vec3 direction ) {

		vec3 absDirection = abs( direction );

		float face = - 1.0;

		if ( absDirection.x > absDirection.z ) {

			if ( absDirection.x > absDirection.y )

				face = direction.x > 0.0 ? 0.0 : 3.0;

			else

				face = direction.y > 0.0 ? 1.0 : 4.0;

		} else {

			if ( absDirection.z > absDirection.y )

				face = direction.z > 0.0 ? 2.0 : 5.0;

			else

				face = direction.y > 0.0 ? 1.0 : 4.0;

		}

		return face;

	}

	// RH coordinate system; PMREM face-indexing convention
	vec2 getUV( vec3 direction, float face ) {

		vec2 uv;

		if ( face == 0.0 ) {

			uv = vec2( direction.z, direction.y ) / abs( direction.x ); // pos x

		} else if ( face == 1.0 ) {

			uv = vec2( - direction.x, - direction.z ) / abs( direction.y ); // pos y

		} else if ( face == 2.0 ) {

			uv = vec2( - direction.x, direction.y ) / abs( direction.z ); // pos z

		} else if ( face == 3.0 ) {

			uv = vec2( - direction.z, direction.y ) / abs( direction.x ); // neg x

		} else if ( face == 4.0 ) {

			uv = vec2( - direction.x, direction.z ) / abs( direction.y ); // neg y

		} else {

			uv = vec2( direction.x, direction.y ) / abs( direction.z ); // neg z

		}

		return 0.5 * ( uv + 1.0 );

	}

	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {

		float face = getFace( direction );

		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );

		mipInt = max( mipInt, cubeUV_minMipLevel );

		float faceSize = exp2( mipInt );

		float texelSize = 1.0 / ( 3.0 * cubeUV_maxTileSize );

		vec2 uv = getUV( direction, face ) * ( faceSize - 1.0 ) + 0.5;

		if ( face > 2.0 ) {

			uv.y += faceSize;

			face -= 3.0;

		}

		uv.x += face * faceSize;

		if ( mipInt < cubeUV_maxMipLevel ) {

			uv.y += 2.0 * cubeUV_maxTileSize;

		}

		uv.y += filterInt * 2.0 * cubeUV_minTileSize;

		uv.x += 3.0 * max( 0.0, cubeUV_maxTileSize - 2.0 * faceSize );

		uv *= texelSize;

		return texture2D( envMap, uv ).rgb;

	}

	// These defines must match with PMREMGenerator

	#define r0 1.0
	#define v0 0.339
	#define m0 - 2.0
	#define r1 0.8
	#define v1 0.276
	#define m1 - 1.0
	#define r4 0.4
	#define v4 0.046
	#define m4 2.0
	#define r5 0.305
	#define v5 0.016
	#define m5 3.0
	#define r6 0.21
	#define v6 0.0038
	#define m6 4.0

	float roughnessToMip( float roughness ) {

		float mip = 0.0;

		if ( roughness >= r1 ) {

			mip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;

		} else if ( roughness >= r4 ) {

			mip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;

		} else if ( roughness >= r5 ) {

			mip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;

		} else if ( roughness >= r6 ) {

			mip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;

		} else {

			mip = - 2.0 * log2( 1.16 * roughness ); // 1.16 = 1.79^0.25
		}

		return mip;

	}

	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {

		float mip = clamp( roughnessToMip( roughness ), m0, cubeUV_maxMipLevel );

		float mipF = fract( mip );

		float mipInt = floor( mip );

		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );

		if ( mipF == 0.0 ) {

			return vec4( color0, 1.0 );

		} else {

			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );

			return vec4( mix( color0, color1, mipF ), 1.0 );

		}

	}

#endif
`;var Db=`
vec3 transformedNormal = objectNormal;

#ifdef USE_INSTANCING

	// this is in lieu of a per-instance normal-matrix
	// shear transforms in the instance matrix are not supported

	mat3 m = mat3( instanceMatrix );

	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );

	transformedNormal = m * transformedNormal;

#endif

transformedNormal = normalMatrix * transformedNormal;

#ifdef FLIP_SIDED

	transformedNormal = - transformedNormal;

#endif

#ifdef USE_TANGENT

	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;

	#ifdef FLIP_SIDED

		transformedTangent = - transformedTangent;

	#endif

#endif
`;var kb=`
#ifdef USE_DISPLACEMENTMAP

	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;

#endif
`;var Bb=`
#ifdef USE_DISPLACEMENTMAP

	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );

#endif
`;var Fb=`
#ifdef USE_EMISSIVEMAP

	vec4 emissiveColor = texture2D( emissiveMap, vUv );

	totalEmissiveRadiance *= emissiveColor.rgb;

#endif
`;var Ub=`
#ifdef USE_EMISSIVEMAP

	uniform sampler2D emissiveMap;

#endif
`;var Vb=`
gl_FragColor = linearToOutputTexel( gl_FragColor );
`;var Gb=`

vec4 LinearToLinear( in vec4 value ) {
	return value;
}

vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}

`;var zb=`
#ifdef USE_ENVMAP

	#ifdef ENV_WORLDPOS

		vec3 cameraToFrag;

		if ( isOrthographic ) {

			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );

		} else {

			cameraToFrag = normalize( vWorldPosition - cameraPosition );

		}

		// Transforming Normal Vectors with the Inverse Transformation
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );

		#ifdef ENVMAP_MODE_REFLECTION

			vec3 reflectVec = reflect( cameraToFrag, worldNormal );

		#else

			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );

		#endif

	#else

		vec3 reflectVec = vReflect;

	#endif

	#ifdef ENVMAP_TYPE_CUBE

		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );

	#elif defined( ENVMAP_TYPE_CUBE_UV )

		vec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );

	#else

		vec4 envColor = vec4( 0.0 );

	#endif

	#ifdef ENVMAP_BLENDING_MULTIPLY

		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );

	#elif defined( ENVMAP_BLENDING_MIX )

		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );

	#elif defined( ENVMAP_BLENDING_ADD )

		outgoingLight += envColor.xyz * specularStrength * reflectivity;

	#endif

#endif
`;var Hb=`
#ifdef USE_ENVMAP

	uniform float envMapIntensity;
	uniform float flipEnvMap;

	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif
`;var jb=`
#ifdef USE_ENVMAP

	uniform float reflectivity;

	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )

		#define ENV_WORLDPOS

	#endif

	#ifdef ENV_WORLDPOS

		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif

#endif
`;var Wb=`
#ifdef USE_ENVMAP

	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )

		#define ENV_WORLDPOS

	#endif

	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;

	#else

		varying vec3 vReflect;
		uniform float refractionRatio;

	#endif

#endif
`;var qb=`
#ifdef USE_ENVMAP

	#ifdef ENV_WORLDPOS

		vWorldPosition = worldPosition.xyz;

	#else

		vec3 cameraToVertex;

		if ( isOrthographic ) {

			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );

		} else {

			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );

		}

		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );

		#ifdef ENVMAP_MODE_REFLECTION

			vReflect = reflect( cameraToVertex, worldNormal );

		#else

			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );

		#endif

	#endif

#endif
`;var Xb=`
#ifdef USE_FOG

	vFogDepth = - mvPosition.z;

#endif
`;var Yb=`
#ifdef USE_FOG

	varying float vFogDepth;

#endif
`;var $b=`
#ifdef USE_FOG

	#ifdef FOG_EXP2

		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );

	#else

		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );

	#endif

	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );

#endif
`;var Kb=`
#ifdef USE_FOG

	uniform vec3 fogColor;
	varying float vFogDepth;

	#ifdef FOG_EXP2

		uniform float fogDensity;

	#else

		uniform float fogNear;
		uniform float fogFar;

	#endif

#endif
`;var Jb=`

#ifdef USE_GRADIENTMAP

	uniform sampler2D gradientMap;

#endif

vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {

	// dotNL will be from -1.0 to 1.0
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );

	#ifdef USE_GRADIENTMAP

		return vec3( texture2D( gradientMap, coord ).r );

	#else

		return ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );

	#endif

}
`;var Zb=`
#ifdef USE_LIGHTMAP

	vec4 lightMapTexel = texture2D( lightMap, vUv2 );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;

	#ifndef PHYSICALLY_CORRECT_LIGHTS

		lightMapIrradiance *= PI;

	#endif

	reflectedLight.indirectDiffuse += lightMapIrradiance;

#endif
`;var Qb=`
#ifdef USE_LIGHTMAP

	uniform sampler2D lightMap;
	uniform float lightMapIntensity;

#endif
`;var eT=`
vec3 diffuse = vec3( 1.0 );

GeometricContext geometry;
geometry.position = mvPosition.xyz;
geometry.normal = normalize( transformedNormal );
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );

GeometricContext backGeometry;
backGeometry.position = geometry.position;
backGeometry.normal = -geometry.normal;
backGeometry.viewDir = geometry.viewDir;

vLightFront = vec3( 0.0 );
vIndirectFront = vec3( 0.0 );
#ifdef DOUBLE_SIDED
	vLightBack = vec3( 0.0 );
	vIndirectBack = vec3( 0.0 );
#endif

IncidentLight directLight;
float dotNL;
vec3 directLightColor_Diffuse;

vIndirectFront += getAmbientLightIrradiance( ambientLightColor );

vIndirectFront += getLightProbeIrradiance( lightProbe, geometry.normal );

#ifdef DOUBLE_SIDED

	vIndirectBack += getAmbientLightIrradiance( ambientLightColor );

	vIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry.normal );

#endif

#if NUM_POINT_LIGHTS > 0

	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {

		getPointLightInfo( pointLights[ i ], geometry, directLight );

		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = directLight.color;

		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;

		#ifdef DOUBLE_SIDED

			vLightBack += saturate( - dotNL ) * directLightColor_Diffuse;

		#endif

	}
	#pragma unroll_loop_end

#endif

#if NUM_SPOT_LIGHTS > 0

	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {

		getSpotLightInfo( spotLights[ i ], geometry, directLight );

		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = directLight.color;

		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;

		#ifdef DOUBLE_SIDED

			vLightBack += saturate( - dotNL ) * directLightColor_Diffuse;

		#endif
	}
	#pragma unroll_loop_end

#endif

#if NUM_DIR_LIGHTS > 0

	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {

		getDirectionalLightInfo( directionalLights[ i ], geometry, directLight );

		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = directLight.color;

		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;

		#ifdef DOUBLE_SIDED

			vLightBack += saturate( - dotNL ) * directLightColor_Diffuse;

		#endif

	}
	#pragma unroll_loop_end

#endif

#if NUM_HEMI_LIGHTS > 0

	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {

		vIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );

		#ifdef DOUBLE_SIDED

			vIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry.normal );

		#endif

	}
	#pragma unroll_loop_end

#endif
`;var tT=`
uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];

// get the irradiance (radiance convolved with cosine lobe) at the point 'normal' on the unit sphere
// source: https://graphics.stanford.edu/papers/envmap/envmap.pdf
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {

	// normal is assumed to have unit length

	float x = normal.x, y = normal.y, z = normal.z;

	// band 0
	vec3 result = shCoefficients[ 0 ] * 0.886227;

	// band 1
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;

	// band 2
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );

	return result;

}

vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {

	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );

	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );

	return irradiance;

}

vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {

	vec3 irradiance = ambientLightColor;

	return irradiance;

}

float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {

	#if defined ( PHYSICALLY_CORRECT_LIGHTS )

		// based upon Frostbite 3 Moving to Physically-based Rendering
		// page 32, equation 26: E[window1]
		// https://seblagarde.files.wordpress.com/2015/07/course_notes_moving_frostbite_to_pbr_v32.pdf
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );

		if ( cutoffDistance > 0.0 ) {

			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );

		}

		return distanceFalloff;

	#else

		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {

			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );

		}

		return 1.0;

	#endif

}

float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {

	return smoothstep( coneCosine, penumbraCosine, angleCosine );

}

#if NUM_DIR_LIGHTS > 0

	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};

	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];

	void getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {

		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;

	}

#endif


#if NUM_POINT_LIGHTS > 0

	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};

	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];

	// light is an out parameter as having it as a return value caused compiler errors on some devices
	void getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {

		vec3 lVector = pointLight.position - geometry.position;

		light.direction = normalize( lVector );

		float lightDistance = length( lVector );

		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );

	}

#endif


#if NUM_SPOT_LIGHTS > 0

	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};

	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];

	// light is an out parameter as having it as a return value caused compiler errors on some devices
	void getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {

		vec3 lVector = spotLight.position - geometry.position;

		light.direction = normalize( lVector );

		float angleCos = dot( light.direction, spotLight.direction );

		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );

		if ( spotAttenuation > 0.0 ) {

			float lightDistance = length( lVector );

			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );

		} else {

			light.color = vec3( 0.0 );
			light.visible = false;

		}

	}

#endif


#if NUM_RECT_AREA_LIGHTS > 0

	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};

	// Pre-computed values of LinearTransformedCosine approximation of BRDF
	// BRDF approximation Texture is 64x64
	uniform sampler2D ltc_1; // RGBA Float
	uniform sampler2D ltc_2; // RGBA Float

	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];

#endif


#if NUM_HEMI_LIGHTS > 0

	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};

	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];

	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {

		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;

		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );

		return irradiance;

	}

#endif
`;var rT=`
#if defined( USE_ENVMAP )

	#ifdef ENVMAP_MODE_REFRACTION

		uniform float refractionRatio;

	#endif

	vec3 getIBLIrradiance( const in vec3 normal ) {

		#if defined( ENVMAP_TYPE_CUBE_UV )

			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );

			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );

			return PI * envMapColor.rgb * envMapIntensity;

		#else

			return vec3( 0.0 );

		#endif

	}

	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {

		#if defined( ENVMAP_TYPE_CUBE_UV )

			vec3 reflectVec;

			#ifdef ENVMAP_MODE_REFLECTION

				reflectVec = reflect( - viewDir, normal );

				// Mixing the reflection with the normal is more accurate and keeps rough objects from gathering light from behind their tangent plane.
				reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );

			#else

				reflectVec = refract( - viewDir, normal, refractionRatio );

			#endif

			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );

			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );

			return envMapColor.rgb * envMapIntensity;

		#else

			return vec3( 0.0 );

		#endif

	}

#endif
`;var oT=`
ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;
`;var nT=`
varying vec3 vViewPosition;

struct ToonMaterial {

	vec3 diffuseColor;

};

void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {

	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;

	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );

}

void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {

	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );

}

#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon

#define Material_LightProbeLOD( material )	(0)
`;var iT=`
BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;
`;var sT=`
varying vec3 vViewPosition;

struct BlinnPhongMaterial {

	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;

};

void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {

	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;

	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );

	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;

}

void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {

	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );

}

#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong

#define Material_LightProbeLOD( material )	(0)
`;var aT=`
PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );

vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );

material.roughness = max( roughnessFactor, 0.0525 );// 0.0525 corresponds to the base mip of a 256 cubemap.
material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );

#ifdef IOR

	#ifdef SPECULAR

		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;

		#ifdef USE_SPECULARINTENSITYMAP

			specularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;

		#endif

		#ifdef USE_SPECULARCOLORMAP

			specularColorFactor *= texture2D( specularColorMap, vUv ).rgb;

		#endif

		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );

	#else

		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;

	#endif

	material.specularColor = mix( min( pow2( ( ior - 1.0 ) / ( ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );

#else

	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;

#endif

#ifdef USE_CLEARCOAT

	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;

	#ifdef USE_CLEARCOATMAP

		material.clearcoat *= texture2D( clearcoatMap, vUv ).x;

	#endif

	#ifdef USE_CLEARCOAT_ROUGHNESSMAP

		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;

	#endif

	material.clearcoat = saturate( material.clearcoat ); // Burley clearcoat model
	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );

#endif

#ifdef USE_SHEEN

	material.sheenColor = sheenColor;

	#ifdef USE_SHEENCOLORMAP

		material.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;

	#endif

	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );

	#ifdef USE_SHEENROUGHNESSMAP

		material.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;

	#endif

#endif
`;var cT=`
struct PhysicalMaterial {

	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;

	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif

	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif

};

// temporary
vec3 clearcoatSpecular = vec3( 0.0 );
vec3 sheenSpecular = vec3( 0.0 );

// This is a curve-fit approxmation to the "Charlie sheen" BRDF integrated over the hemisphere from 
// Estevez and Kulla 2017, "Production Friendly Microfacet Sheen BRDF". The analysis can be found
// in the Sheen section of https://drive.google.com/file/d/1T0D1VSyR4AllqIJTQAraEIzjlb5h4FKH/view?usp=sharing
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness) {

	float dotNV = saturate( dot( normal, viewDir ) );

	float r2 = roughness * roughness;

	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;

	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;

	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );

	return saturate( DG * RECIPROCAL_PI );

}

// Analytical approximation of the DFG LUT, one half of the
// split-sum approximation used in indirect specular lighting.
// via 'environmentBRDF' from "Physically Based Shading on Mobile"
// https://www.unrealengine.com/blog/physically-based-shading-on-mobile
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {

	float dotNV = saturate( dot( normal, viewDir ) );

	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );

	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );

	vec4 r = roughness * c0 + c1;

	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;

	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;

	return fab;

}

vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {

	vec2 fab = DFGApprox( normal, viewDir, roughness );

	return specularColor * fab.x + specularF90 * fab.y;

}

// Fdez-Ag\xFCera's "Multiple-Scattering Microfacet Model for Real-Time Image Based Lighting"
// Approximates multiscattering in order to preserve energy.
// http://www.jcgt.org/published/0008/01/03/
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {

	vec2 fab = DFGApprox( normal, viewDir, roughness );

	vec3 FssEss = specularColor * fab.x + specularF90 * fab.y;

	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;

	vec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619; // 1/21
	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );

	singleScatter += FssEss;
	multiScatter += Fms * Ems;

}

#if NUM_RECT_AREA_LIGHTS > 0

	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {

		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;

		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight; // counterclockwise; light shines in local neg z direction
		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;

		vec2 uv = LTC_Uv( normal, viewDir, roughness );

		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );

		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);

		// LTC Fresnel Approximation by Stephen Hill
		// http://blog.selfshadow.com/publications/s2016-advances/s2016_ltc_fresnel.pdf
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );

		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );

		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );

	}

#endif

void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {

	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );

	vec3 irradiance = dotNL * directLight.color;

	#ifdef USE_CLEARCOAT

		float dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );

		vec3 ccIrradiance = dotNLcc * directLight.color;

		clearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );

	#endif

	#ifdef USE_SHEEN

		sheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );

	#endif

	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );


	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}

void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {

	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );

}

void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {

	#ifdef USE_CLEARCOAT

		clearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );

	#endif

	#ifdef USE_SHEEN

		sheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );

	#endif

	// Both indirect specular and indirect diffuse light accumulate here

	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;

	computeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );

	vec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );

	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;

	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;

}

#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical

// ref: https://seblagarde.files.wordpress.com/2015/07/course_notes_moving_frostbite_to_pbr_v32.pdf
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {

	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );

}
`;var lT=`
/**
 * This is a template that can be used to light a material, it uses pluggable
 * RenderEquations (RE)for specific lighting scenarios.
 *
 * Instructions for use:
 * - Ensure that both RE_Direct, RE_IndirectDiffuse and RE_IndirectSpecular are defined
 * - If you have defined an RE_IndirectSpecular, you need to also provide a Material_LightProbeLOD. <---- ???
 * - Create a material parameter that is to be passed as the third parameter to your lighting functions.
 *
 * TODO:
 * - Add area light support.
 * - Add sphere light support.
 * - Add diffuse light probe (irradiance cubemap) support.
 */

GeometricContext geometry;

geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );

#ifdef USE_CLEARCOAT

	geometry.clearcoatNormal = clearcoatNormal;

#endif

IncidentLight directLight;

#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )

	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif

	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {

		pointLight = pointLights[ i ];

		getPointLightInfo( pointLight, geometry, directLight );

		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif

		RE_Direct( directLight, geometry, material, reflectedLight );

	}
	#pragma unroll_loop_end

#endif

#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )

	SpotLight spotLight;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif

	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {

		spotLight = spotLights[ i ];

		getSpotLightInfo( spotLight, geometry, directLight );

		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
		#endif

		RE_Direct( directLight, geometry, material, reflectedLight );

	}
	#pragma unroll_loop_end

#endif

#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )

	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif

	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {

		directionalLight = directionalLights[ i ];

		getDirectionalLightInfo( directionalLight, geometry, directLight );

		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif

		RE_Direct( directLight, geometry, material, reflectedLight );

	}
	#pragma unroll_loop_end

#endif

#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )

	RectAreaLight rectAreaLight;

	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {

		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );

	}
	#pragma unroll_loop_end

#endif

#if defined( RE_IndirectDiffuse )

	vec3 iblIrradiance = vec3( 0.0 );

	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );

	irradiance += getLightProbeIrradiance( lightProbe, geometry.normal );

	#if ( NUM_HEMI_LIGHTS > 0 )

		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {

			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );

		}
		#pragma unroll_loop_end

	#endif

#endif

#if defined( RE_IndirectSpecular )

	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );

#endif
`;var uT=`
#if defined( RE_IndirectDiffuse )

	#ifdef USE_LIGHTMAP

		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;

		#ifndef PHYSICALLY_CORRECT_LIGHTS

			lightMapIrradiance *= PI;

		#endif

		irradiance += lightMapIrradiance;

	#endif

	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )

		iblIrradiance += getIBLIrradiance( geometry.normal );

	#endif

#endif

#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )

	radiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );

	#ifdef USE_CLEARCOAT

		clearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );

	#endif

#endif
`;var pT=`
#if defined( RE_IndirectDiffuse )

	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );

#endif

#if defined( RE_IndirectSpecular )

	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );

#endif
`;var dT=`
#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )

	// Doing a strict comparison with == 1.0 can cause noise artifacts
	// on some platforms. See issue #17623.
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;

#endif
`;var hT=`
#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )

	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;

#endif
`;var fT=`
#ifdef USE_LOGDEPTHBUF

	#ifdef USE_LOGDEPTHBUF_EXT

		varying float vFragDepth;
		varying float vIsPerspective;

	#else

		uniform float logDepthBufFC;

	#endif

#endif
`;var mT=`
#ifdef USE_LOGDEPTHBUF

	#ifdef USE_LOGDEPTHBUF_EXT

		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );

	#else

		if ( isPerspectiveMatrix( projectionMatrix ) ) {

			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;

			gl_Position.z *= gl_Position.w;

		}

	#endif

#endif
`;var _T=`
#ifdef USE_MAP

	vec4 sampledDiffuseColor = texture2D( map, vUv );

	#ifdef DECODE_VIDEO_TEXTURE

		// inline sRGB decode (TODO: Remove this code when https://crbug.com/1256340 is solved)

		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );

	#endif

	diffuseColor *= sampledDiffuseColor;

#endif
`;var gT=`
#ifdef USE_MAP

	uniform sampler2D map;

#endif
`;var vT=`
#if defined( USE_MAP ) || defined( USE_ALPHAMAP )

	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;

#endif

#ifdef USE_MAP

	diffuseColor *= texture2D( map, uv );

#endif

#ifdef USE_ALPHAMAP

	diffuseColor.a *= texture2D( alphaMap, uv ).g;

#endif
`;var yT=`
#if defined( USE_MAP ) || defined( USE_ALPHAMAP )

	uniform mat3 uvTransform;

#endif

#ifdef USE_MAP

	uniform sampler2D map;

#endif

#ifdef USE_ALPHAMAP

	uniform sampler2D alphaMap;

#endif
`;var xT=`
float metalnessFactor = metalness;

#ifdef USE_METALNESSMAP

	vec4 texelMetalness = texture2D( metalnessMap, vUv );

	// reads channel B, compatible with a combined OcclusionRoughnessMetallic (RGB) texture
	metalnessFactor *= texelMetalness.b;

#endif
`;var bT=`
#ifdef USE_METALNESSMAP

	uniform sampler2D metalnessMap;

#endif
`;var TT=`
#ifdef USE_MORPHNORMALS

	// morphTargetBaseInfluence is set based on BufferGeometry.morphTargetsRelative value:
	// When morphTargetsRelative is false, this is set to 1 - sum(influences); this results in normal = sum((target - base) * influence)
	// When morphTargetsRelative is true, this is set to 1; as a result, all morph targets are simply added to the base after weighting
	objectNormal *= morphTargetBaseInfluence;

	#ifdef MORPHTARGETS_TEXTURE

		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {

			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1, 2 ) * morphTargetInfluences[ i ];

		}

	#else

		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];

	#endif

#endif
`;var AT=`
#ifdef USE_MORPHTARGETS

	uniform float morphTargetBaseInfluence;

	#ifdef MORPHTARGETS_TEXTURE

		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform vec2 morphTargetsTextureSize;

		vec3 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset, const in int stride ) {

			float texelIndex = float( vertexIndex * stride + offset );
			float y = floor( texelIndex / morphTargetsTextureSize.x );
			float x = texelIndex - y * morphTargetsTextureSize.x;

			vec3 morphUV = vec3( ( x + 0.5 ) / morphTargetsTextureSize.x, y / morphTargetsTextureSize.y, morphTargetIndex );
			return texture( morphTargetsTexture, morphUV ).xyz;

		}

	#else

		#ifndef USE_MORPHNORMALS

			uniform float morphTargetInfluences[ 8 ];

		#else

			uniform float morphTargetInfluences[ 4 ];

		#endif

	#endif

#endif
`;var CT=`
#ifdef USE_MORPHTARGETS

	// morphTargetBaseInfluence is set based on BufferGeometry.morphTargetsRelative value:
	// When morphTargetsRelative is false, this is set to 1 - sum(influences); this results in position = sum((target - base) * influence)
	// When morphTargetsRelative is true, this is set to 1; as a result, all morph targets are simply added to the base after weighting
	transformed *= morphTargetBaseInfluence;

	#ifdef MORPHTARGETS_TEXTURE

		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {

			#ifndef USE_MORPHNORMALS

				if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0, 1 ) * morphTargetInfluences[ i ];

			#else

				if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0, 2 ) * morphTargetInfluences[ i ];

			#endif

		}

	#else

		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];

		#ifndef USE_MORPHNORMALS

			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];

		#endif

	#endif

#endif
`;var ET=`
float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;

#ifdef FLAT_SHADED

	// Workaround for Adreno GPUs not able to do dFdx( vViewPosition )

	vec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );
	vec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );
	vec3 normal = normalize( cross( fdx, fdy ) );

#else

	vec3 normal = normalize( vNormal );

	#ifdef DOUBLE_SIDED

		normal = normal * faceDirection;

	#endif

	#ifdef USE_TANGENT

		vec3 tangent = normalize( vTangent );
		vec3 bitangent = normalize( vBitangent );

		#ifdef DOUBLE_SIDED

			tangent = tangent * faceDirection;
			bitangent = bitangent * faceDirection;

		#endif

		#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )

			mat3 vTBN = mat3( tangent, bitangent, normal );

		#endif

	#endif

#endif

// non perturbed normal for clearcoat among others

vec3 geometryNormal = normal;

`;var ST=`

#ifdef OBJECTSPACE_NORMALMAP

	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0; // overrides both flatShading and attribute normals

	#ifdef FLIP_SIDED

		normal = - normal;

	#endif

	#ifdef DOUBLE_SIDED

		normal = normal * faceDirection;

	#endif

	normal = normalize( normalMatrix * normal );

#elif defined( TANGENTSPACE_NORMALMAP )

	vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;

	#ifdef USE_TANGENT

		normal = normalize( vTBN * mapN );

	#else

		normal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );

	#endif

#elif defined( USE_BUMPMAP )

	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );

#endif
`;var wT=`
#ifndef FLAT_SHADED

	varying vec3 vNormal;

	#ifdef USE_TANGENT

		varying vec3 vTangent;
		varying vec3 vBitangent;

	#endif

#endif
`;var MT=`
#ifndef FLAT_SHADED

	varying vec3 vNormal;

	#ifdef USE_TANGENT

		varying vec3 vTangent;
		varying vec3 vBitangent;

	#endif

#endif
`;var NT=`
#ifndef FLAT_SHADED // normal is computed with derivatives when FLAT_SHADED

	vNormal = normalize( transformedNormal );

	#ifdef USE_TANGENT

		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );

	#endif

#endif
`;var OT=`
#ifdef USE_NORMALMAP

	uniform sampler2D normalMap;
	uniform vec2 normalScale;

#endif

#ifdef OBJECTSPACE_NORMALMAP

	uniform mat3 normalMatrix;

#endif

#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )

	// Normal Mapping Without Precomputed Tangents
	// http://www.thetenthplanet.de/archives/1180

	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {

		// Workaround for Adreno 3XX dFd*( vec3 ) bug. See #9988

		vec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );
		vec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );

		vec3 N = surf_norm; // normalized

		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );

		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;

		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );

		return normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );

	}

#endif
`;var PT=`
#ifdef USE_CLEARCOAT

	vec3 clearcoatNormal = geometryNormal;

#endif
`;var RT=`
#ifdef USE_CLEARCOAT_NORMALMAP

	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;

	#ifdef USE_TANGENT

		clearcoatNormal = normalize( vTBN * clearcoatMapN );

	#else

		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );

	#endif

#endif
`;var IT=`

#ifdef USE_CLEARCOATMAP

	uniform sampler2D clearcoatMap;

#endif

#ifdef USE_CLEARCOAT_ROUGHNESSMAP

	uniform sampler2D clearcoatRoughnessMap;

#endif

#ifdef USE_CLEARCOAT_NORMALMAP

	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;

#endif
`;var LT=`
#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif

// https://github.com/mrdoob/three.js/pull/22425
#ifdef USE_TRANSMISSION
diffuseColor.a *= transmissionAlpha + 0.1;
#endif

gl_FragColor = vec4( outgoingLight, diffuseColor.a );
`;var DT=`
vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}

vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}

const float PackUpscale = 256. / 255.; // fraction -> 0..1 (including 1)
const float UnpackDownscale = 255. / 256.; // 0..1 -> fraction (excluding 1)

const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );

const float ShiftRight8 = 1. / 256.;

vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8; // tidy overflow
	return r * PackUpscale;
}

float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}

vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}

vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}

// NOTE: viewZ/eyeZ is < 0 when in front of the camera per OpenGL conventions

float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}

// NOTE: https://twitter.com/gonnavis/status/1377183786949959682

float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}
`;var kT=`
#ifdef PREMULTIPLIED_ALPHA

	// Get get normal blending with premultipled, use with CustomBlending, OneFactor, OneMinusSrcAlphaFactor, AddEquation.
	gl_FragColor.rgb *= gl_FragColor.a;

#endif
`;var BT=`
vec4 mvPosition = vec4( transformed, 1.0 );

#ifdef USE_INSTANCING

	mvPosition = instanceMatrix * mvPosition;

#endif

mvPosition = modelViewMatrix * mvPosition;

gl_Position = projectionMatrix * mvPosition;
`;var FT=`
#ifdef DITHERING

	gl_FragColor.rgb = dithering( gl_FragColor.rgb );

#endif
`;var UT=`
#ifdef DITHERING

	// based on https://www.shadertoy.com/view/MslGR8
	vec3 dithering( vec3 color ) {
		//Calculate grid position
		float grid_position = rand( gl_FragCoord.xy );

		//Shift the individual colors differently, thus making it even harder to see the dithering pattern
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );

		//modify shift acording to grid position.
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );

		//shift the color by dither_shift
		return color + dither_shift_RGB;
	}

#endif
`;var VT=`
float roughnessFactor = roughness;

#ifdef USE_ROUGHNESSMAP

	vec4 texelRoughness = texture2D( roughnessMap, vUv );

	// reads channel G, compatible with a combined OcclusionRoughnessMetallic (RGB) texture
	roughnessFactor *= texelRoughness.g;

#endif
`;var GT=`
#ifdef USE_ROUGHNESSMAP

	uniform sampler2D roughnessMap;

#endif
`;var A1=`
#ifdef USE_SHADOWMAP

	#if NUM_DIR_LIGHT_SHADOWS > 0

		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];

		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};

		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];

	#endif

	#if NUM_SPOT_LIGHT_SHADOWS > 0

		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];

		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};

		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];

	#endif

	#if NUM_POINT_LIGHT_SHADOWS > 0

		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];

		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};

		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];

	#endif

	/*
	#if NUM_RECT_AREA_LIGHTS > 0

		// TODO (abelnation): create uniforms for area light shadows

	#endif
	*/

	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {

		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );

	}

	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {

		return unpackRGBATo2Half( texture2D( shadow, uv ) );

	}

	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){

		float occlusion = 1.0;

		vec2 distribution = texture2DDistribution( shadow, uv );

		float hard_shadow = step( compare , distribution.x ); // Hard Shadow

		if (hard_shadow != 1.0 ) {

			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance ); // Chebeyshevs inequality
			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 ); // 0.3 reduces light bleed
			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );

		}
		return occlusion;

	}

	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {

		float shadow = 1.0;

		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;

		// if ( something && something ) breaks ATI OpenGL shader compiler
		// if ( all( something, something ) ) using this instead

		bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );
		bool inFrustum = all( inFrustumVec );

		bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );

		bool frustumTest = all( frustumTestVec );

		if ( frustumTest ) {

		#if defined( SHADOWMAP_TYPE_PCF )

			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;

			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;

			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );

		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )

			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;

			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;

			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), 
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), 
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );

		#elif defined( SHADOWMAP_TYPE_VSM )

			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );

		#else // no percentage-closer filtering:

			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );

		#endif

		}

		return shadow;

	}

	// cubeToUV() maps a 3D direction vector suitable for cube texture mapping to a 2D
	// vector suitable for 2D texture mapping. This code uses the following layout for the
	// 2D texture:
	//
	// xzXZ
	//  y Y
	//
	// Y - Positive y direction
	// y - Negative y direction
	// X - Positive x direction
	// x - Negative x direction
	// Z - Positive z direction
	// z - Negative z direction
	//
	// Source and test bed:
	// https://gist.github.com/tschw/da10c43c467ce8afd0c4

	vec2 cubeToUV( vec3 v, float texelSizeY ) {

		// Number of texels to avoid at the edge of each square

		vec3 absV = abs( v );

		// Intersect unit cube

		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;

		// Apply scale to avoid seams

		// two texels less per square (one texel will do for NEAREST)
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );

		// Unwrap

		// space: -1 ... 1 range for each square
		//
		// #X##		dim    := ( 4 , 2 )
		//  # #		center := ( 1 , 1 )

		vec2 planar = v.xy;

		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;

		if ( absV.z >= almostOne ) {

			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;

		} else if ( absV.x >= almostOne ) {

			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;

		} else if ( absV.y >= almostOne ) {

			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;

		}

		// Transform to UV space

		// scale := 0.5 / dim
		// translate := ( center + 0.5 ) / dim
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );

	}

	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {

		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );

		// for point lights, the uniform @vShadowCoord is re-purposed to hold
		// the vector from the light to the world-space position of the fragment.
		vec3 lightToPosition = shadowCoord.xyz;

		// dp = normalized distance from light to fragment position
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear ); // need to clamp?
		dp += shadowBias;

		// bd3D = base direction 3D
		vec3 bd3D = normalize( lightToPosition );

		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )

			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;

			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );

		#else // no percentage-closer filtering

			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );

		#endif

	}

#endif
`;var zT=`
#ifdef USE_SHADOWMAP

	#if NUM_DIR_LIGHT_SHADOWS > 0

		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];

		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};

		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];

	#endif

	#if NUM_SPOT_LIGHT_SHADOWS > 0

		uniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];

		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};

		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];

	#endif

	#if NUM_POINT_LIGHT_SHADOWS > 0

		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];

		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};

		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];

	#endif

	/*
	#if NUM_RECT_AREA_LIGHTS > 0

		// TODO (abelnation): uniforms for area light shadows

	#endif
	*/

#endif
`;var HT=`
#ifdef USE_SHADOWMAP

	#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0

		// Offsetting the position used for querying occlusion along the world normal can be used to reduce shadow acne.
		vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		vec4 shadowWorldPosition;

	#endif

	#if NUM_DIR_LIGHT_SHADOWS > 0

	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {

		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
		vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;

	}
	#pragma unroll_loop_end

	#endif

	#if NUM_SPOT_LIGHT_SHADOWS > 0

	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {

		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );
		vSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;

	}
	#pragma unroll_loop_end

	#endif

	#if NUM_POINT_LIGHT_SHADOWS > 0

	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {

		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
		vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;

	}
	#pragma unroll_loop_end

	#endif

	/*
	#if NUM_RECT_AREA_LIGHTS > 0

		// TODO (abelnation): update vAreaShadowCoord with area light info

	#endif
	*/

#endif
`;var jT=`
float getShadowMask() {

	float shadow = 1.0;

	#ifdef USE_SHADOWMAP

	#if NUM_DIR_LIGHT_SHADOWS > 0

	DirectionalLightShadow directionalLight;

	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {

		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;

	}
	#pragma unroll_loop_end

	#endif

	#if NUM_SPOT_LIGHT_SHADOWS > 0

	SpotLightShadow spotLight;

	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {

		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;

	}
	#pragma unroll_loop_end

	#endif

	#if NUM_POINT_LIGHT_SHADOWS > 0

	PointLightShadow pointLight;

	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {

		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;

	}
	#pragma unroll_loop_end

	#endif

	/*
	#if NUM_RECT_AREA_LIGHTS > 0

		// TODO (abelnation): update shadow for Area light

	#endif
	*/

	#endif

	return shadow;

}
`;var WT=`
#ifdef USE_SKINNING

	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );

#endif
`;var qT=`
#ifdef USE_SKINNING

	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;

	#ifdef BONE_TEXTURE

		uniform highp sampler2D boneTexture;
		uniform int boneTextureSize;

		mat4 getBoneMatrix( const in float i ) {

			float j = i * 4.0;
			float x = mod( j, float( boneTextureSize ) );
			float y = floor( j / float( boneTextureSize ) );

			float dx = 1.0 / float( boneTextureSize );
			float dy = 1.0 / float( boneTextureSize );

			y = dy * ( y + 0.5 );

			vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
			vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
			vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
			vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );

			mat4 bone = mat4( v1, v2, v3, v4 );

			return bone;

		}

	#else

		uniform mat4 boneMatrices[ MAX_BONES ];

		mat4 getBoneMatrix( const in float i ) {

			mat4 bone = boneMatrices[ int(i) ];
			return bone;

		}

	#endif

#endif
`;var XT=`
#ifdef USE_SKINNING

	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );

	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;

	transformed = ( bindMatrixInverse * skinned ).xyz;

#endif
`;var YT=`
#ifdef USE_SKINNING

	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;

	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;

	#ifdef USE_TANGENT

		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;

	#endif

#endif
`;var $T=`
float specularStrength;

#ifdef USE_SPECULARMAP

	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;

#else

	specularStrength = 1.0;

#endif
`;var KT=`
#ifdef USE_SPECULARMAP

	uniform sampler2D specularMap;

#endif
`;var JT=`
#if defined( TONE_MAPPING )

	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );

#endif
`;var ZT=`
#ifndef saturate
// <common> may have defined saturate() already
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif

uniform float toneMappingExposure;

// exposure only
vec3 LinearToneMapping( vec3 color ) {

	return toneMappingExposure * color;

}

// source: https://www.cs.utah.edu/docs/techreports/2002/pdf/UUCS-02-001.pdf
vec3 ReinhardToneMapping( vec3 color ) {

	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );

}

// source: http://filmicworlds.com/blog/filmic-tonemapping-operators/
vec3 OptimizedCineonToneMapping( vec3 color ) {

	// optimized filmic operator by Jim Hejl and Richard Burgess-Dawson
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );

}

// source: https://github.com/selfshadow/ltc_code/blob/master/webgl/shaders/ltc/ltc_blit.fs
vec3 RRTAndODTFit( vec3 v ) {

	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;

}

// this implementation of ACES is modified to accommodate a brighter viewing environment.
// the scale factor of 1/0.6 is subjective. see discussion in #19621.

vec3 ACESFilmicToneMapping( vec3 color ) {

	// sRGB => XYZ => D65_2_D60 => AP1 => RRT_SAT
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ), // transposed from source
		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);

	// ODT_SAT => XYZ => D60_2_D65 => sRGB
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ), // transposed from source
		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);

	color *= toneMappingExposure / 0.6;

	color = ACESInputMat * color;

	// Apply RRT and ODT
	color = RRTAndODTFit( color );

	color = ACESOutputMat * color;

	// Clamp to [0, 1]
	return saturate( color );

}

vec3 CustomToneMapping( vec3 color ) { return color; }
`;var QT=`
#ifdef USE_TRANSMISSION

	float transmissionAlpha = 1.0;
	float transmissionFactor = transmission;
	float thicknessFactor = thickness;

	#ifdef USE_TRANSMISSIONMAP

		transmissionFactor *= texture2D( transmissionMap, vUv ).r;

	#endif

	#ifdef USE_THICKNESSMAP

		thicknessFactor *= texture2D( thicknessMap, vUv ).g;

	#endif

	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );

	vec4 transmission = getIBLVolumeRefraction(
		n, v, roughnessFactor, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, ior, thicknessFactor,
		attenuationColor, attenuationDistance );

	totalDiffuse = mix( totalDiffuse, transmission.rgb, transmissionFactor );
	transmissionAlpha = mix( transmissionAlpha, transmission.a, transmissionFactor );
#endif
`;var eA=`
#ifdef USE_TRANSMISSION

	// Transmission code is based on glTF-Sampler-Viewer
	// https://github.com/KhronosGroup/glTF-Sample-Viewer

	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;

	#ifdef USE_TRANSMISSIONMAP

		uniform sampler2D transmissionMap;

	#endif

	#ifdef USE_THICKNESSMAP

		uniform sampler2D thicknessMap;

	#endif

	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;

	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;

	varying vec3 vWorldPosition;

	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {

		// Direction of refracted light.
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );

		// Compute rotation-independant scaling of the model matrix.
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );

		// The thickness is specified in local space.
		return normalize( refractionVector ) * thickness * modelScale;

	}

	float applyIorToRoughness( const in float roughness, const in float ior ) {

		// Scale roughness with IOR so that an IOR of 1.0 results in no microfacet refraction and
		// an IOR of 1.5 results in the default amount of microfacet refraction.
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );

	}

	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {

		float framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );

		#ifdef TEXTURE_LOD_EXT

			return texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );

		#else

			return texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );

		#endif

	}

	vec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {

		if ( attenuationDistance == 0.0 ) {

			// Attenuation distance is +\u221E (which we indicate by zero), i.e. the transmitted color is not attenuated at all.
			return radiance;

		} else {

			// Compute light attenuation using Beer's law.
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance ); // Beer's law
			return transmittance * radiance;

		}

	}

	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {

		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;

		// Project refracted vector on the framebuffer, while mapping to normalized device coordinates.
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;

		// Sample framebuffer to get pixel the refracted ray hits.
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );

		vec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );

		// Get the specular component.
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );

		return vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );

	}
#endif
`;var tA=`
#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )

	varying vec2 vUv;

#endif
`;var rA=`
#ifdef USE_UV

	#ifdef UVS_VERTEX_ONLY

		vec2 vUv;

	#else

		varying vec2 vUv;

	#endif

	uniform mat3 uvTransform;

#endif
`;var oA=`
#ifdef USE_UV

	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;

#endif
`;var nA=`
#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )

	varying vec2 vUv2;

#endif
`;var iA=`
#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )

	attribute vec2 uv2;
	varying vec2 vUv2;

	uniform mat3 uv2Transform;

#endif
`;var sA=`
#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )

	vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;

#endif
`;var aA=`
#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION )

	vec4 worldPosition = vec4( transformed, 1.0 );

	#ifdef USE_INSTANCING

		worldPosition = instanceMatrix * worldPosition;

	#endif

	worldPosition = modelMatrix * worldPosition;

#endif
`;var cA=`
varying vec2 vUv;
uniform mat3 uvTransform;

void main() {

	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;

	gl_Position = vec4( position.xy, 1.0, 1.0 );

}
`,lA=`
uniform sampler2D t2D;

varying vec2 vUv;

void main() {

	gl_FragColor = texture2D( t2D, vUv );

	#include <tonemapping_fragment>
	#include <encodings_fragment>

}
`;var uA=`
varying vec3 vWorldDirection;

#include <common>

void main() {

	vWorldDirection = transformDirection( position, modelMatrix );

	#include <begin_vertex>
	#include <project_vertex>

	gl_Position.z = gl_Position.w; // set z to camera.far

}
`,pA=`
#include <envmap_common_pars_fragment>
uniform float opacity;

varying vec3 vWorldDirection;

#include <cube_uv_reflection_fragment>

void main() {

	vec3 vReflect = vWorldDirection;
	#include <envmap_fragment>

	gl_FragColor = envColor;
	gl_FragColor.a *= opacity;

	#include <tonemapping_fragment>
	#include <encodings_fragment>

}
`;var dA=`
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

// This is used for computing an equivalent of gl_FragCoord.z that is as high precision as possible.
// Some platforms compute gl_FragCoord at a lower precision which makes the manually computed value better for
// depth-based postprocessing effects. Reproduced on iPad with A10 processor / iPadOS 13.3.1.
varying vec2 vHighPrecisionZW;

void main() {

	#include <uv_vertex>

	#include <skinbase_vertex>

	#ifdef USE_DISPLACEMENTMAP

		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>

	#endif

	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>

	vHighPrecisionZW = gl_Position.zw;

}
`,hA=`
#if DEPTH_PACKING == 3200

	uniform float opacity;

#endif

#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

varying vec2 vHighPrecisionZW;

void main() {

	#include <clipping_planes_fragment>

	vec4 diffuseColor = vec4( 1.0 );

	#if DEPTH_PACKING == 3200

		diffuseColor.a = opacity;

	#endif

	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>

	#include <logdepthbuf_fragment>

	// Higher precision equivalent of gl_FragCoord.z. This assumes depthRange has been left to its default values.
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;

	#if DEPTH_PACKING == 3200

		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );

	#elif DEPTH_PACKING == 3201

		gl_FragColor = packDepthToRGBA( fragCoordZ );

	#endif

}
`;var fA=`
#define DISTANCE

varying vec3 vWorldPosition;

#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {

	#include <uv_vertex>

	#include <skinbase_vertex>

	#ifdef USE_DISPLACEMENTMAP

		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>

	#endif

	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>

	vWorldPosition = worldPosition.xyz;

}
`,mA=`
#define DISTANCE

uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;

#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <clipping_planes_pars_fragment>

void main () {

	#include <clipping_planes_fragment>

	vec4 diffuseColor = vec4( 1.0 );

	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>

	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist ); // clamp to [ 0, 1 ]

	gl_FragColor = packDepthToRGBA( dist );

}
`;var _A=`
varying vec3 vWorldDirection;

#include <common>

void main() {

	vWorldDirection = transformDirection( position, modelMatrix );

	#include <begin_vertex>
	#include <project_vertex>

}
`,gA=`
uniform sampler2D tEquirect;

varying vec3 vWorldDirection;

#include <common>

void main() {

	vec3 direction = normalize( vWorldDirection );

	vec2 sampleUV = equirectUv( direction );

	gl_FragColor = texture2D( tEquirect, sampleUV );

	#include <tonemapping_fragment>
	#include <encodings_fragment>

}
`;var vA=`
uniform float scale;
attribute float lineDistance;

varying float vLineDistance;

#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {

	vLineDistance = scale * lineDistance;

	#include <color_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>

}
`,yA=`
uniform vec3 diffuse;
uniform float opacity;

uniform float dashSize;
uniform float totalSize;

varying float vLineDistance;

#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

void main() {

	#include <clipping_planes_fragment>

	if ( mod( vLineDistance, totalSize ) > dashSize ) {

		discard;

	}

	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );

	#include <logdepthbuf_fragment>
	#include <color_fragment>

	outgoingLight = diffuseColor.rgb; // simple shader

	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>

}
`;var xA=`
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {

	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>

	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )

		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>

	#endif

	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>

	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>

}
`,bA=`
uniform vec3 diffuse;
uniform float opacity;

#ifndef FLAT_SHADED

	varying vec3 vNormal;

#endif

#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

void main() {

	#include <clipping_planes_fragment>

	vec4 diffuseColor = vec4( diffuse, opacity );

	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>

	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );

	// accumulation (baked indirect lighting only)
	#ifdef USE_LIGHTMAP

		vec4 lightMapTexel= texture2D( lightMap, vUv2 );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity;

	#else

		reflectedLight.indirectDiffuse += vec3( 1.0 );

	#endif

	// modulation
	#include <aomap_fragment>

	reflectedLight.indirectDiffuse *= diffuseColor.rgb;

	vec3 outgoingLight = reflectedLight.indirectDiffuse;

	#include <envmap_fragment>

	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>

}
`;var TA=`
#define LAMBERT

varying vec3 vLightFront;
varying vec3 vIndirectFront;

#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif

#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <bsdfs>
#include <lights_pars_begin>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {

	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>

	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>

	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>

	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <lights_lambert_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}
`,AA=`
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;

varying vec3 vLightFront;
varying vec3 vIndirectFront;

#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif


#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <fog_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

void main() {

	#include <clipping_planes_fragment>

	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;

	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <emissivemap_fragment>

	// accumulation

	#ifdef DOUBLE_SIDED

		reflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;

	#else

		reflectedLight.indirectDiffuse += vIndirectFront;

	#endif

	#include <lightmap_fragment>

	reflectedLight.indirectDiffuse *= BRDF_Lambert( diffuseColor.rgb );

	#ifdef DOUBLE_SIDED

		reflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;

	#else

		reflectedLight.directDiffuse = vLightFront;

	#endif

	reflectedLight.directDiffuse *= BRDF_Lambert( diffuseColor.rgb ) * getShadowMask();

	// modulation

	#include <aomap_fragment>

	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;

	#include <envmap_fragment>

	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}
`;var CA=`
#define MATCAP

varying vec3 vViewPosition;

#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>

#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {

	#include <uv_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>

	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>

	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>

	vViewPosition = - mvPosition.xyz;

}
`,EA=`
#define MATCAP

uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;

varying vec3 vViewPosition;

#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

void main() {

	#include <clipping_planes_fragment>

	vec4 diffuseColor = vec4( diffuse, opacity );

	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>

	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5; // 0.495 to remove artifacts caused by undersized matcap disks

	#ifdef USE_MATCAP

		vec4 matcapColor = texture2D( matcap, uv );

	#else

		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 ); // default if matcap is missing

	#endif

	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;

	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>

}
`;var SA=`
#define NORMAL

#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )

	varying vec3 vViewPosition;

#endif

#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {

	#include <uv_vertex>

	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>

	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>

#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )

	vViewPosition = - mvPosition.xyz;

#endif

}
`,wA=`
#define NORMAL

uniform float opacity;

#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )

	varying vec3 vViewPosition;

#endif

#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

void main() {

	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>

	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );

	#ifdef OPAQUE

		gl_FragColor.a = 1.0;

	#endif

}
`;var MA=`
#define PHONG

varying vec3 vViewPosition;

#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {

	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>

	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>

	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>

	vViewPosition = - mvPosition.xyz;

	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>

}
`,NA=`
#define PHONG

uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;

#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

void main() {

	#include <clipping_planes_fragment>

	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;

	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>

	// accumulation
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>

	// modulation
	#include <aomap_fragment>

	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;

	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>

}
`;var OA=`
#define STANDARD

varying vec3 vViewPosition;

#ifdef USE_TRANSMISSION

	varying vec3 vWorldPosition;

#endif

#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {

	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>

	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>

	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>

	vViewPosition = - mvPosition.xyz;

	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>

#ifdef USE_TRANSMISSION

	vWorldPosition = worldPosition.xyz;

#endif
}
`,PA=`
#define STANDARD

#ifdef PHYSICAL
	#define IOR
	#define SPECULAR
#endif

uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;

#ifdef IOR
	uniform float ior;
#endif

#ifdef SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;

	#ifdef USE_SPECULARINTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif

	#ifdef USE_SPECULARCOLORMAP
		uniform sampler2D specularColorMap;
	#endif
#endif

#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif

#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;

	#ifdef USE_SHEENCOLORMAP
		uniform sampler2D sheenColorMap;
	#endif

	#ifdef USE_SHEENROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif

varying vec3 vViewPosition;

#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <bsdfs>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

void main() {

	#include <clipping_planes_fragment>

	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;

	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>

	// accumulation
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>

	// modulation
	#include <aomap_fragment>

	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;

	#include <transmission_fragment>

	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;

	#ifdef USE_SHEEN

		// Sheen energy compensation approximation calculation can be found at the end of
		// https://drive.google.com/file/d/1T0D1VSyR4AllqIJTQAraEIzjlb5h4FKH/view?usp=sharing
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );

		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;

	#endif

	#ifdef USE_CLEARCOAT

		float dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );

		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );

		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;

	#endif

	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>

}
`;var RA=`
#define TOON

varying vec3 vViewPosition;

#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {

	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>

	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>

	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>

	vViewPosition = - mvPosition.xyz;

	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>

}
`,IA=`
#define TOON

uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;

#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

void main() {

	#include <clipping_planes_fragment>

	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;

	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>

	// accumulation
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>

	// modulation
	#include <aomap_fragment>

	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;

	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>

}
`;var LA=`
uniform float size;
uniform float scale;

#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {

	#include <color_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>

	gl_PointSize = size;

	#ifdef USE_SIZEATTENUATION

		bool isPerspective = isPerspectiveMatrix( projectionMatrix );

		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );

	#endif

	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>

}
`,DA=`
uniform vec3 diffuse;
uniform float opacity;

#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

void main() {

	#include <clipping_planes_fragment>

	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );

	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>

	outgoingLight = diffuseColor.rgb;

	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>

}
`;var kA=`
#include <common>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>

void main() {

	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>

	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>

	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>

}
`,BA=`
uniform vec3 color;
uniform float opacity;

#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>

void main() {

	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );

	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>

}
`;var FA=`
uniform float rotation;
uniform vec2 center;

#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {

	#include <uv_vertex>

	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );

	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );

	#ifndef USE_SIZEATTENUATION

		bool isPerspective = isPerspectiveMatrix( projectionMatrix );

		if ( isPerspective ) scale *= - mvPosition.z;

	#endif

	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;

	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;

	mvPosition.xy += rotatedPosition;

	gl_Position = projectionMatrix * mvPosition;

	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>

}
`,UA=`
uniform vec3 diffuse;
uniform float opacity;

#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

void main() {

	#include <clipping_planes_fragment>

	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );

	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>

	outgoingLight = diffuseColor.rgb;

	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>

}
`;var ht={alphamap_fragment:mb,alphamap_pars_fragment:_b,alphatest_fragment:gb,alphatest_pars_fragment:vb,aomap_fragment:yb,aomap_pars_fragment:xb,begin_vertex:bb,beginnormal_vertex:Tb,bsdfs:Ab,bumpmap_pars_fragment:Cb,clipping_planes_fragment:Eb,clipping_planes_pars_fragment:Sb,clipping_planes_pars_vertex:wb,clipping_planes_vertex:Mb,color_fragment:Nb,color_pars_fragment:Ob,color_pars_vertex:Pb,color_vertex:Rb,common:Ib,cube_uv_reflection_fragment:Lb,defaultnormal_vertex:Db,displacementmap_pars_vertex:kb,displacementmap_vertex:Bb,emissivemap_fragment:Fb,emissivemap_pars_fragment:Ub,encodings_fragment:Vb,encodings_pars_fragment:Gb,envmap_fragment:zb,envmap_common_pars_fragment:Hb,envmap_pars_fragment:jb,envmap_pars_vertex:Wb,envmap_physical_pars_fragment:rT,envmap_vertex:qb,fog_vertex:Xb,fog_pars_vertex:Yb,fog_fragment:$b,fog_pars_fragment:Kb,gradientmap_pars_fragment:Jb,lightmap_fragment:Zb,lightmap_pars_fragment:Qb,lights_lambert_vertex:eT,lights_pars_begin:tT,lights_toon_fragment:oT,lights_toon_pars_fragment:nT,lights_phong_fragment:iT,lights_phong_pars_fragment:sT,lights_physical_fragment:aT,lights_physical_pars_fragment:cT,lights_fragment_begin:lT,lights_fragment_maps:uT,lights_fragment_end:pT,logdepthbuf_fragment:dT,logdepthbuf_pars_fragment:hT,logdepthbuf_pars_vertex:fT,logdepthbuf_vertex:mT,map_fragment:_T,map_pars_fragment:gT,map_particle_fragment:vT,map_particle_pars_fragment:yT,metalnessmap_fragment:xT,metalnessmap_pars_fragment:bT,morphnormal_vertex:TT,morphtarget_pars_vertex:AT,morphtarget_vertex:CT,normal_fragment_begin:ET,normal_fragment_maps:ST,normal_pars_fragment:wT,normal_pars_vertex:MT,normal_vertex:NT,normalmap_pars_fragment:OT,clearcoat_normal_fragment_begin:PT,clearcoat_normal_fragment_maps:RT,clearcoat_pars_fragment:IT,output_fragment:LT,packing:DT,premultiplied_alpha_fragment:kT,project_vertex:BT,dithering_fragment:FT,dithering_pars_fragment:UT,roughnessmap_fragment:VT,roughnessmap_pars_fragment:GT,shadowmap_pars_fragment:A1,shadowmap_pars_vertex:zT,shadowmap_vertex:HT,shadowmask_pars_fragment:jT,skinbase_vertex:WT,skinning_pars_vertex:qT,skinning_vertex:XT,skinnormal_vertex:YT,specularmap_fragment:$T,specularmap_pars_fragment:KT,tonemapping_fragment:JT,tonemapping_pars_fragment:ZT,transmission_fragment:QT,transmission_pars_fragment:eA,uv_pars_fragment:tA,uv_pars_vertex:rA,uv_vertex:oA,uv2_pars_fragment:nA,uv2_pars_vertex:iA,uv2_vertex:sA,worldpos_vertex:aA,background_vert:cA,background_frag:lA,cube_vert:uA,cube_frag:pA,depth_vert:dA,depth_frag:hA,distanceRGBA_vert:fA,distanceRGBA_frag:mA,equirect_vert:_A,equirect_frag:gA,linedashed_vert:vA,linedashed_frag:yA,meshbasic_vert:xA,meshbasic_frag:bA,meshlambert_vert:TA,meshlambert_frag:AA,meshmatcap_vert:CA,meshmatcap_frag:EA,meshnormal_vert:SA,meshnormal_frag:wA,meshphong_vert:MA,meshphong_frag:NA,meshphysical_vert:OA,meshphysical_frag:PA,meshtoon_vert:RA,meshtoon_frag:IA,points_vert:LA,points_frag:DA,shadow_vert:kA,shadow_frag:BA,sprite_vert:FA,sprite_frag:UA};var Te={common:{diffuse:{value:new de(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new qo},uv2Transform:{value:new qo},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new z(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new de(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new de(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new qo}},sprite:{diffuse:{value:new de(16777215)},opacity:{value:1},center:{value:new z(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new qo}}};var oi={basic:{uniforms:go([Te.common,Te.specularmap,Te.envmap,Te.aomap,Te.lightmap,Te.fog]),vertexShader:ht.meshbasic_vert,fragmentShader:ht.meshbasic_frag},lambert:{uniforms:go([Te.common,Te.specularmap,Te.envmap,Te.aomap,Te.lightmap,Te.emissivemap,Te.fog,Te.lights,{emissive:{value:new de(0)}}]),vertexShader:ht.meshlambert_vert,fragmentShader:ht.meshlambert_frag},phong:{uniforms:go([Te.common,Te.specularmap,Te.envmap,Te.aomap,Te.lightmap,Te.emissivemap,Te.bumpmap,Te.normalmap,Te.displacementmap,Te.fog,Te.lights,{emissive:{value:new de(0)},specular:{value:new de(1118481)},shininess:{value:30}}]),vertexShader:ht.meshphong_vert,fragmentShader:ht.meshphong_frag},standard:{uniforms:go([Te.common,Te.envmap,Te.aomap,Te.lightmap,Te.emissivemap,Te.bumpmap,Te.normalmap,Te.displacementmap,Te.roughnessmap,Te.metalnessmap,Te.fog,Te.lights,{emissive:{value:new de(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:ht.meshphysical_vert,fragmentShader:ht.meshphysical_frag},toon:{uniforms:go([Te.common,Te.aomap,Te.lightmap,Te.emissivemap,Te.bumpmap,Te.normalmap,Te.displacementmap,Te.gradientmap,Te.fog,Te.lights,{emissive:{value:new de(0)}}]),vertexShader:ht.meshtoon_vert,fragmentShader:ht.meshtoon_frag},matcap:{uniforms:go([Te.common,Te.bumpmap,Te.normalmap,Te.displacementmap,Te.fog,{matcap:{value:null}}]),vertexShader:ht.meshmatcap_vert,fragmentShader:ht.meshmatcap_frag},points:{uniforms:go([Te.points,Te.fog]),vertexShader:ht.points_vert,fragmentShader:ht.points_frag},dashed:{uniforms:go([Te.common,Te.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:ht.linedashed_vert,fragmentShader:ht.linedashed_frag},depth:{uniforms:go([Te.common,Te.displacementmap]),vertexShader:ht.depth_vert,fragmentShader:ht.depth_frag},normal:{uniforms:go([Te.common,Te.bumpmap,Te.normalmap,Te.displacementmap,{opacity:{value:1}}]),vertexShader:ht.meshnormal_vert,fragmentShader:ht.meshnormal_frag},sprite:{uniforms:go([Te.sprite,Te.fog]),vertexShader:ht.sprite_vert,fragmentShader:ht.sprite_frag},background:{uniforms:{uvTransform:{value:new qo},t2D:{value:null}},vertexShader:ht.background_vert,fragmentShader:ht.background_frag},cube:{uniforms:go([Te.envmap,{opacity:{value:1}}]),vertexShader:ht.cube_vert,fragmentShader:ht.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:ht.equirect_vert,fragmentShader:ht.equirect_frag},distanceRGBA:{uniforms:go([Te.common,Te.displacementmap,{referencePosition:{value:new M},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:ht.distanceRGBA_vert,fragmentShader:ht.distanceRGBA_frag},shadow:{uniforms:go([Te.lights,Te.fog,{color:{value:new de(0)},opacity:{value:1}}]),vertexShader:ht.shadow_vert,fragmentShader:ht.shadow_frag}};oi.physical={uniforms:go([oi.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new z(1,1)},clearcoatNormalMap:{value:null},sheen:{value:0},sheenColor:{value:new de(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new z},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new de(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new de(1,1,1)},specularColorMap:{value:null}}]),vertexShader:ht.meshphysical_vert,fragmentShader:ht.meshphysical_frag};function VA(o,e,t,r,n,i){let s=new de(0),a=n===!0?0:1,c,l,u=null,p=0,d=null;function h(f,v){let g=!1,_=v.isScene===!0?v.background:null;_&&_.isTexture&&(_=e.get(_));let T=o.xr,b=T.getSession&&T.getSession();b&&b.environmentBlendMode==="additive"&&(_=null),_===null?m(s,a):_&&_.isColor&&(m(_,1),g=!0),(o.autoClear||g)&&o.clear(o.autoClearColor,o.autoClearDepth,o.autoClearStencil),_&&(_.isCubeTexture||_.mapping===dn)?(l===void 0&&(l=new ct(new Nn(1,1,1),new Sr({name:"BackgroundCubeMaterial",uniforms:l0(oi.cube.uniforms),vertexShader:oi.cube.vertexShader,fragmentShader:oi.cube.fragmentShader,side:Mt,depthTest:!1,depthWrite:!1,fog:!1})),l.geometry.deleteAttribute("normal"),l.geometry.deleteAttribute("uv"),l.onBeforeRender=function(x,A,E){this.matrixWorld.copyPosition(E.matrixWorld)},Object.defineProperty(l.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(l)),l.material.uniforms.envMap.value=_,l.material.uniforms.flipEnvMap.value=_.isCubeTexture&&_.isRenderTargetTexture===!1?-1:1,(u!==_||p!==_.version||d!==o.toneMapping)&&(l.material.needsUpdate=!0,u=_,p=_.version,d=o.toneMapping),f.unshift(l,l.geometry,l.material,0,0,null)):_&&_.isTexture&&(c===void 0&&(c=new ct(new Ts(2,2),new Sr({name:"BackgroundMaterial",uniforms:l0(oi.background.uniforms),vertexShader:oi.background.vertexShader,fragmentShader:oi.background.fragmentShader,side:gr,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),Object.defineProperty(c.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(c)),c.material.uniforms.t2D.value=_,_.matrixAutoUpdate===!0&&_.updateMatrix(),c.material.uniforms.uvTransform.value.copy(_.matrix),(u!==_||p!==_.version||d!==o.toneMapping)&&(c.material.needsUpdate=!0,u=_,p=_.version,d=o.toneMapping),f.unshift(c,c.geometry,c.material,0,0,null))}function m(f,v){t.buffers.color.setClear(f.r,f.g,f.b,v,i)}return{getClearColor:function(){return s},setClearColor:function(f,v=1){s.set(f),a=v,m(s,a)},getClearAlpha:function(){return a},setClearAlpha:function(f){a=f,m(s,a)},render:h}}function GA(o,e,t,r){let n=o.getParameter(o.MAX_VERTEX_ATTRIBS),i=r.isWebGL2?null:e.get("OES_vertex_array_object"),s=r.isWebGL2||i!==null,a={},c=f(null),l=c;function u(R,D,V,F,j){let $=!1;if(s){let Y=m(F,V,D);l!==Y&&(l=Y,d(l.object)),$=v(F,j),$&&g(F,j)}else{let Y=D.wireframe===!0;(l.geometry!==F.id||l.program!==V.id||l.wireframe!==Y)&&(l.geometry=F.id,l.program=V.id,l.wireframe=Y,$=!0)}R.isInstancedMesh===!0&&($=!0),j!==null&&t.update(j,o.ELEMENT_ARRAY_BUFFER),$&&(E(R,D,V,F),j!==null&&o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,t.get(j).buffer))}function p(){return r.isWebGL2?o.createVertexArray():i.createVertexArrayOES()}function d(R){return r.isWebGL2?o.bindVertexArray(R):i.bindVertexArrayOES(R)}function h(R){return r.isWebGL2?o.deleteVertexArray(R):i.deleteVertexArrayOES(R)}function m(R,D,V){let F=V.wireframe===!0,j=a[R.id];j===void 0&&(j={},a[R.id]=j);let $=j[D.id];$===void 0&&($={},j[D.id]=$);let Y=$[F];return Y===void 0&&(Y=f(p()),$[F]=Y),Y}function f(R){let D=[],V=[],F=[];for(let j=0;j<n;j++)D[j]=0,V[j]=0,F[j]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:D,enabledAttributes:V,attributeDivisors:F,object:R,attributes:{},index:null}}function v(R,D){let V=l.attributes,F=R.attributes,j=0;for(let $ in F){let Y=V[$],H=F[$];if(Y===void 0||Y.attribute!==H||Y.data!==H.data)return!0;j++}return l.attributesNum!==j||l.index!==D}function g(R,D){let V={},F=R.attributes,j=0;for(let $ in F){let Y=F[$],H={};H.attribute=Y,Y.data&&(H.data=Y.data),V[$]=H,j++}l.attributes=V,l.attributesNum=j,l.index=D}function _(){let R=l.newAttributes;for(let D=0,V=R.length;D<V;D++)R[D]=0}function T(R){b(R,0)}function b(R,D){let V=l.newAttributes,F=l.enabledAttributes,j=l.attributeDivisors;V[R]=1,F[R]===0&&(o.enableVertexAttribArray(R),F[R]=1),j[R]!==D&&((r.isWebGL2?o:e.get("ANGLE_instanced_arrays"))[r.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](R,D),j[R]=D)}function x(){let R=l.newAttributes,D=l.enabledAttributes;for(let V=0,F=D.length;V<F;V++)D[V]!==R[V]&&(o.disableVertexAttribArray(V),D[V]=0)}function A(R,D,V,F,j,$){r.isWebGL2===!0&&(V===o.INT||V===o.UNSIGNED_INT)?o.vertexAttribIPointer(R,D,V,j,$):o.vertexAttribPointer(R,D,V,F,j,$)}function E(R,D,V,F){if(r.isWebGL2===!1&&(R.isInstancedMesh||F.isInstancedBufferGeometry)&&e.get("ANGLE_instanced_arrays")===null)return;_();let j=F.attributes,$=V.getAttributes(),Y=D.defaultAttributeValues;for(let H in $){let B=$[H];if(B.location>=0){let te=j[H];if(te===void 0&&(H==="instanceMatrix"&&R.instanceMatrix&&(te=R.instanceMatrix),H==="instanceColor"&&R.instanceColor&&(te=R.instanceColor)),te!==void 0){let X=te.normalized,W=te.itemSize,L=t.get(te);if(L===void 0)continue;let Ne=L.buffer,ye=L.type,ae=L.bytesPerElement;if(te.isInterleavedBufferAttribute){let Ae=te.data,Ie=Ae.stride,Oe=te.offset;if(Ae&&Ae.isInstancedInterleavedBuffer){for(let le=0;le<B.locationSize;le++)b(B.location+le,Ae.meshPerAttribute);R.isInstancedMesh!==!0&&F._maxInstanceCount===void 0&&(F._maxInstanceCount=Ae.meshPerAttribute*Ae.count)}else for(let le=0;le<B.locationSize;le++)T(B.location+le);o.bindBuffer(o.ARRAY_BUFFER,Ne);for(let le=0;le<B.locationSize;le++)A(B.location+le,W/B.locationSize,ye,X,Ie*ae,(Oe+W/B.locationSize*le)*ae)}else{if(te.isInstancedBufferAttribute){for(let Ae=0;Ae<B.locationSize;Ae++)b(B.location+Ae,te.meshPerAttribute);R.isInstancedMesh!==!0&&F._maxInstanceCount===void 0&&(F._maxInstanceCount=te.meshPerAttribute*te.count)}else for(let Ae=0;Ae<B.locationSize;Ae++)T(B.location+Ae);o.bindBuffer(o.ARRAY_BUFFER,Ne);for(let Ae=0;Ae<B.locationSize;Ae++)A(B.location+Ae,W/B.locationSize,ye,X,W*ae,W/B.locationSize*Ae*ae)}}else if(Y!==void 0){let X=Y[H];if(X!==void 0)switch(X.length){case 2:o.vertexAttrib2fv(B.location,X);break;case 3:o.vertexAttrib3fv(B.location,X);break;case 4:o.vertexAttrib4fv(B.location,X);break;default:o.vertexAttrib1fv(B.location,X)}}}}x()}function S(){C();for(let R in a){let D=a[R];for(let V in D){let F=D[V];for(let j in F)h(F[j].object),delete F[j];delete D[V]}delete a[R]}}function w(R){if(a[R.id]===void 0)return;let D=a[R.id];for(let V in D){let F=D[V];for(let j in F)h(F[j].object),delete F[j];delete D[V]}delete a[R.id]}function O(R){for(let D in a){let V=a[D];if(V[R.id]===void 0)continue;let F=V[R.id];for(let j in F)h(F[j].object),delete F[j];delete V[R.id]}}function C(){N(),l!==c&&(l=c,d(l.object))}function N(){c.geometry=null,c.program=null,c.wireframe=!1}return{setup:u,reset:C,resetDefaultState:N,dispose:S,releaseStatesOfGeometry:w,releaseStatesOfProgram:O,initAttributes:_,enableAttribute:T,disableUnusedAttributes:x}}function zA(o,e,t,r){let n=r.isWebGL2,i;function s(l){i=l}function a(l,u){o.drawArrays(i,l,u),t.update(u,i,1)}function c(l,u,p){if(p===0)return;let d,h;if(n)d=o,h="drawArraysInstanced";else if(d=e.get("ANGLE_instanced_arrays"),h="drawArraysInstancedANGLE",d===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}d[h](i,l,u,p),t.update(u,i,p)}this.setMode=s,this.render=a,this.renderInstances=c}function HA(o,e,t){let r;function n(){if(r!==void 0)return r;if(e.has("EXT_texture_filter_anisotropic")===!0){let E=e.get("EXT_texture_filter_anisotropic");r=o.getParameter(E.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r}function i(E){if(E==="highp"){if(o.getShaderPrecisionFormat(o.VERTEX_SHADER,o.HIGH_FLOAT).precision>0&&o.getShaderPrecisionFormat(o.FRAGMENT_SHADER,o.HIGH_FLOAT).precision>0)return"highp";E="mediump"}return E==="mediump"&&o.getShaderPrecisionFormat(o.VERTEX_SHADER,o.MEDIUM_FLOAT).precision>0&&o.getShaderPrecisionFormat(o.FRAGMENT_SHADER,o.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let s=typeof WebGL2RenderingContext<"u"&&o instanceof WebGL2RenderingContext||typeof WebGL2ComputeRenderingContext<"u"&&o instanceof WebGL2ComputeRenderingContext,a=t.precision!==void 0?t.precision:"highp",c=i(a);c!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",c,"instead."),a=c);let l=s||e.has("WEBGL_draw_buffers"),u=t.logarithmicDepthBuffer===!0,p=o.getParameter(o.MAX_TEXTURE_IMAGE_UNITS),d=o.getParameter(o.MAX_VERTEX_TEXTURE_IMAGE_UNITS),h=o.getParameter(o.MAX_TEXTURE_SIZE),m=o.getParameter(o.MAX_CUBE_MAP_TEXTURE_SIZE),f=o.getParameter(o.MAX_VERTEX_ATTRIBS),v=o.getParameter(o.MAX_VERTEX_UNIFORM_VECTORS),g=o.getParameter(o.MAX_VARYING_VECTORS),_=o.getParameter(o.MAX_FRAGMENT_UNIFORM_VECTORS),T=d>0,b=s||e.has("OES_texture_float"),x=T&&b,A=s?o.getParameter(o.MAX_SAMPLES):0;return{isWebGL2:s,drawBuffers:l,getMaxAnisotropy:n,getMaxPrecision:i,precision:a,logarithmicDepthBuffer:u,maxTextures:p,maxVertexTextures:d,maxTextureSize:h,maxCubemapSize:m,maxAttributes:f,maxVertexUniforms:v,maxVaryings:g,maxFragmentUniforms:_,vertexTextures:T,floatFragmentTextures:b,floatVertexTextures:x,maxSamples:A}}function jA(o){let e=this,t=null,r=0,n=!1,i=!1,s=new Io,a=new qo,c={value:null,needsUpdate:!1};this.uniform=c,this.numPlanes=0,this.numIntersection=0,this.init=function(p,d,h){let m=p.length!==0||d||r!==0||n;return n=d,t=u(p,h,0),r=p.length,m},this.beginShadows=function(){i=!0,u(null)},this.endShadows=function(){i=!1,l()},this.setState=function(p,d,h){let m=p.clippingPlanes,f=p.clipIntersection,v=p.clipShadows,g=o.get(p);if(!n||m===null||m.length===0||i&&!v)i?u(null):l();else{let _=i?0:r,T=_*4,b=g.clippingState||null;c.value=b,b=u(m,d,T,h);for(let x=0;x!==T;++x)b[x]=t[x];g.clippingState=b,this.numIntersection=f?this.numPlanes:0,this.numPlanes+=_}};function l(){c.value!==t&&(c.value=t,c.needsUpdate=r>0),e.numPlanes=r,e.numIntersection=0}function u(p,d,h,m){let f=p!==null?p.length:0,v=null;if(f!==0){if(v=c.value,m!==!0||v===null){let g=h+f*4,_=d.matrixWorldInverse;a.getNormalMatrix(_),(v===null||v.length<g)&&(v=new Float32Array(g));for(let T=0,b=h;T!==f;++T,b+=4)s.copy(p[T]).applyMatrix4(_,a),s.normal.toArray(v,b),v[b+3]=s.constant}c.value=v,c.needsUpdate=!0}return e.numPlanes=f,e.numIntersection=0,v}}var yr=class extends hu{constructor(e,t,r={}){super();this.width=e,this.height=t,this.depth=1,this.scissor=new De(0,0,e,t),this.scissorTest=!1,this.viewport=new De(0,0,e,t),this.texture=new vr(void 0,r.mapping,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.encoding),this.texture.isRenderTargetTexture=!0,this.texture.image={width:e,height:t,depth:1},this.texture.generateMipmaps=r.generateMipmaps!==void 0?r.generateMipmaps:!1,this.texture.internalFormat=r.internalFormat!==void 0?r.internalFormat:null,this.texture.minFilter=r.minFilter!==void 0?r.minFilter:lt,this.depthBuffer=r.depthBuffer!==void 0?r.depthBuffer:!0,this.stencilBuffer=r.stencilBuffer!==void 0?r.stencilBuffer:!1,this.depthTexture=r.depthTexture!==void 0?r.depthTexture:null}setTexture(e){e.image={width:this.width,height:this.height,depth:this.depth},this.texture=e}setSize(e,t,r=1){(this.width!==e||this.height!==t||this.depth!==r)&&(this.width=e,this.height=t,this.depth=r,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=r,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.image=Object.assign({},e.texture.image),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this}dispose(){this.dispatchEvent({type:"dispose"})}};yr.prototype.isWebGLRenderTarget=!0;var As=class extends vt{constructor(){super();this.type="Camera",this.matrixWorldInverse=new Ue,this.projectionMatrix=new Ue,this.projectionMatrixInverse=new Ue}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);let t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}};As.prototype.isCamera=!0;var sr=class extends As{constructor(e=50,t=1,r=.1,n=2e3){super();this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=r,this.far=n,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){let t=.5*this.getFilmHeight()/e;this.fov=jd*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){let e=Math.tan(q0*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return jd*2*Math.atan(Math.tan(q0*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,r,n,i,s){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=n,this.view.width=i,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=this.near,t=e*Math.tan(q0*.5*this.fov)/this.zoom,r=2*t,n=this.aspect*r,i=-.5*n,s=this.view;if(this.view!==null&&this.view.enabled){let c=s.fullWidth,l=s.fullHeight;i+=s.offsetX*n/c,t-=s.offsetY*r/l,n*=s.width/c,r*=s.height/l}let a=this.filmOffset;a!==0&&(i+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(i,i+n,t,t-r,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){let t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}};sr.prototype.isPerspectiveCamera=!0;var gu=90,vu=1,e4=class extends vt{constructor(e,t,r){super();if(this.type="CubeCamera",r.isWebGLCubeRenderTarget!==!0){console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");return}this.renderTarget=r;let n=new sr(gu,vu,e,t);n.layers=this.layers,n.up.set(0,-1,0),n.lookAt(new M(1,0,0)),this.add(n);let i=new sr(gu,vu,e,t);i.layers=this.layers,i.up.set(0,-1,0),i.lookAt(new M(-1,0,0)),this.add(i);let s=new sr(gu,vu,e,t);s.layers=this.layers,s.up.set(0,0,1),s.lookAt(new M(0,1,0)),this.add(s);let a=new sr(gu,vu,e,t);a.layers=this.layers,a.up.set(0,0,-1),a.lookAt(new M(0,-1,0)),this.add(a);let c=new sr(gu,vu,e,t);c.layers=this.layers,c.up.set(0,-1,0),c.lookAt(new M(0,0,1)),this.add(c);let l=new sr(gu,vu,e,t);l.layers=this.layers,l.up.set(0,-1,0),l.lookAt(new M(0,0,-1)),this.add(l)}update(e,t){this.parent===null&&this.updateMatrixWorld();let r=this.renderTarget,[n,i,s,a,c,l]=this.children,u=e.xr.enabled,p=e.getRenderTarget();e.xr.enabled=!1;let d=r.texture.generateMipmaps;r.texture.generateMipmaps=!1,e.setRenderTarget(r,0),e.render(t,n),e.setRenderTarget(r,1),e.render(t,i),e.setRenderTarget(r,2),e.render(t,s),e.setRenderTarget(r,3),e.render(t,a),e.setRenderTarget(r,4),e.render(t,c),r.texture.generateMipmaps=d,e.setRenderTarget(r,5),e.render(t,l),e.setRenderTarget(p),e.xr.enabled=u,r.texture.needsPMREMUpdate=!0}};var $0=class extends vr{constructor(e,t,r,n,i,s,a,c,l,u){e=e!==void 0?e:[],t=t!==void 0?t:pn;super(e,t,r,n,i,s,a,c,l,u);this.flipY=!1}get images(){return this.image}set images(e){this.image=e}};$0.prototype.isCubeTexture=!0;var C1=class extends yr{constructor(e,t,r){Number.isInteger(t)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),t=r);super(e,e,t);t=t||{},this.texture=new $0(void 0,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=t.generateMipmaps!==void 0?t.generateMipmaps:!1,this.texture.minFilter=t.minFilter!==void 0?t.minFilter:lt}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.format=at,this.texture.encoding=t.encoding,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;let r={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},n=new Nn(5,5,5),i=new Sr({name:"CubemapFromEquirect",uniforms:l0(r.uniforms),vertexShader:r.vertexShader,fragmentShader:r.fragmentShader,side:Mt,blending:un});i.uniforms.tEquirect.value=t;let s=new ct(n,i),a=t.minFilter;return t.minFilter===Ri&&(t.minFilter=lt),new e4(1,10,this).update(e,s),t.minFilter=a,s.geometry.dispose(),s.material.dispose(),this}clear(e,t,r,n){let i=e.getRenderTarget();for(let s=0;s<6;s++)e.setRenderTarget(this,s),e.clear(t,r,n);e.setRenderTarget(i)}};C1.prototype.isWebGLCubeRenderTarget=!0;function WA(o){let e=new WeakMap;function t(s,a){return a===n0?s.mapping=pn:a===i0&&(s.mapping=Sn),s}function r(s){if(s&&s.isTexture&&s.isRenderTargetTexture===!1){let a=s.mapping;if(a===n0||a===i0)if(e.has(s)){let c=e.get(s).texture;return t(c,s.mapping)}else{let c=s.image;if(c&&c.height>0){let l=new C1(c.height/2);return l.fromEquirectangularTexture(o,s),e.set(s,l),s.addEventListener("dispose",n),t(l.texture,s.mapping)}else return null}}return s}function n(s){let a=s.target;a.removeEventListener("dispose",n);let c=e.get(a);c!==void 0&&(e.delete(a),c.dispose())}function i(){e=new WeakMap}return{get:r,dispose:i}}var Cs=class extends As{constructor(e=-1,t=1,r=1,n=-1,i=.1,s=2e3){super();this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=r,this.bottom=n,this.near=i,this.far=s,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,r,n,i,s){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=n,this.view.width=i,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),r=(this.right+this.left)/2,n=(this.top+this.bottom)/2,i=r-e,s=r+e,a=n+t,c=n-t;if(this.view!==null&&this.view.enabled){let l=(this.right-this.left)/this.view.fullWidth/this.zoom,u=(this.top-this.bottom)/this.view.fullHeight/this.zoom;i+=l*this.view.offsetX,s=i+l*this.view.width,a-=u*this.view.offsetY,c=a-u*this.view.height}this.projectionMatrix.makeOrthographic(i,s,a,c,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){let t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}};Cs.prototype.isOrthographicCamera=!0;var K0=class extends Sr{constructor(e){super(e);this.type="RawShaderMaterial"}};K0.prototype.isRawShaderMaterial=!0;var bu=4,J0=8,Es=Math.pow(2,J0),ZA=[.125,.215,.35,.446,.526,.582],QA=J0-bu+1+ZA.length,yu=20,t4=new Cs,{_lodPlanes:qd,_sizeLods:qA,_sigmas:E1}=EG(),XA=new de,r4=null,bc=(1+Math.sqrt(5))/2,xu=1/bc,YA=[new M(1,1,1),new M(-1,1,1),new M(1,1,-1),new M(-1,1,-1),new M(0,bc,xu),new M(0,bc,-xu),new M(xu,0,bc),new M(-xu,0,bc),new M(bc,xu,0),new M(-bc,xu,0)],Tu=class{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._blurMaterial=SG(yu),this._equirectShader=null,this._cubemapShader=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,r=.1,n=100){r4=this._renderer.getRenderTarget();let i=this._allocateTargets();return this._sceneToCubeUV(e,r,n,i),t>0&&this._blur(i,0,0,t),this._applyPMREM(i),this._cleanup(i),i}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapShader===null&&(this._cubemapShader=JA(),this._compileMaterial(this._cubemapShader))}compileEquirectangularShader(){this._equirectShader===null&&(this._equirectShader=KA(),this._compileMaterial(this._equirectShader))}dispose(){this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose(),this._cubemapShader!==null&&this._cubemapShader.dispose(),this._equirectShader!==null&&this._equirectShader.dispose();for(let e=0;e<qd.length;e++)qd[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(r4),e.scissorTest=!1,S1(e,0,0,e.width,e.height)}_fromTexture(e,t){r4=this._renderer.getRenderTarget();let r=t||this._allocateTargets(e);return this._textureToCubeUV(e,r),this._applyPMREM(r),this._cleanup(r),r}_allocateTargets(e){let t={magFilter:lt,minFilter:lt,generateMipmaps:!1,type:qr,format:at,encoding:Xr,depthBuffer:!1},r=$A(t);return r.depthBuffer=!e,this._pingPongRenderTarget===null&&(this._pingPongRenderTarget=$A(t)),r}_compileMaterial(e){let t=new ct(qd[0],e);this._renderer.compile(t,t4)}_sceneToCubeUV(e,t,r,n){let a=new sr(90,1,t,r),c=[1,-1,1,1,1,1],l=[1,1,1,-1,-1,-1],u=this._renderer,p=u.autoClear,d=u.toneMapping;u.getClearColor(XA),u.toneMapping=Ro,u.autoClear=!1;let h=new _n({name:"PMREM.Background",side:Mt,depthWrite:!1,depthTest:!1}),m=new ct(new Nn,h),f=!1,v=e.background;v?v.isColor&&(h.color.copy(v),e.background=null,f=!0):(h.color.copy(XA),f=!0);for(let g=0;g<6;g++){let _=g%3;_===0?(a.up.set(0,c[g],0),a.lookAt(l[g],0,0)):_===1?(a.up.set(0,0,c[g]),a.lookAt(0,l[g],0)):(a.up.set(0,c[g],0),a.lookAt(0,0,l[g])),S1(n,_*Es,g>2?Es:0,Es,Es),u.setRenderTarget(n),f&&u.render(m,a),u.render(e,a)}m.geometry.dispose(),m.material.dispose(),u.toneMapping=d,u.autoClear=p,e.background=v}_textureToCubeUV(e,t){let r=this._renderer,n=e.mapping===pn||e.mapping===Sn;n?(this._cubemapShader===null&&(this._cubemapShader=JA()),this._cubemapShader.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectShader===null&&(this._equirectShader=KA());let i=n?this._cubemapShader:this._equirectShader,s=new ct(qd[0],i),a=i.uniforms;a.envMap.value=e,n||a.texelSize.value.set(1/e.image.width,1/e.image.height),S1(t,0,0,3*Es,2*Es),r.setRenderTarget(t),r.render(s,t4)}_applyPMREM(e){let t=this._renderer,r=t.autoClear;t.autoClear=!1;for(let n=1;n<QA;n++){let i=Math.sqrt(E1[n]*E1[n]-E1[n-1]*E1[n-1]),s=YA[(n-1)%YA.length];this._blur(e,n-1,n,i,s)}t.autoClear=r}_blur(e,t,r,n,i){let s=this._pingPongRenderTarget;this._halfBlur(e,s,t,r,n,"latitudinal",i),this._halfBlur(s,e,r,r,n,"longitudinal",i)}_halfBlur(e,t,r,n,i,s,a){let c=this._renderer,l=this._blurMaterial;s!=="latitudinal"&&s!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");let u=3,p=new ct(qd[n],l),d=l.uniforms,h=qA[r]-1,m=isFinite(i)?Math.PI/(2*h):2*Math.PI/(2*yu-1),f=i/m,v=isFinite(i)?1+Math.floor(u*f):yu;v>yu&&console.warn(`sigmaRadians, ${i}, is too large and will clip, as it requested ${v} samples when the maximum is set to ${yu}`);let g=[],_=0;for(let A=0;A<yu;++A){let E=A/f,S=Math.exp(-E*E/2);g.push(S),A===0?_+=S:A<v&&(_+=2*S)}for(let A=0;A<g.length;A++)g[A]=g[A]/_;d.envMap.value=e.texture,d.samples.value=v,d.weights.value=g,d.latitudinal.value=s==="latitudinal",a&&(d.poleAxis.value=a),d.dTheta.value=m,d.mipInt.value=J0-r;let T=qA[n],b=3*Math.max(0,Es-2*T),x=(n===0?0:2*Es)+2*T*(n>J0-bu?n-J0+bu:0);S1(t,b,x,3*T,2*T),c.setRenderTarget(t),c.render(p,t4)}};function EG(){let o=[],e=[],t=[],r=J0;for(let n=0;n<QA;n++){let i=Math.pow(2,r);e.push(i);let s=1/i;n>J0-bu?s=ZA[n-J0+bu-1]:n===0&&(s=0),t.push(s);let a=1/(i-1),c=-a/2,l=1+a/2,u=[c,c,l,c,l,l,c,c,l,l,c,l],p=6,d=6,h=3,m=2,f=1,v=new Float32Array(h*d*p),g=new Float32Array(m*d*p),_=new Float32Array(f*d*p);for(let b=0;b<p;b++){let x=b%3*2/3-1,A=b>2?0:-1,E=[x,A,0,x+2/3,A,0,x+2/3,A+1,0,x,A,0,x+2/3,A+1,0,x,A+1,0];v.set(E,h*d*b),g.set(u,m*d*b);let S=[b,b,b,b,b,b];_.set(S,f*d*b)}let T=new Re;T.setAttribute("position",new Tt(v,h)),T.setAttribute("uv",new Tt(g,m)),T.setAttribute("faceIndex",new Tt(_,f)),o.push(T),r>bu&&r--}return{_lodPlanes:o,_sizeLods:e,_sigmas:t}}function $A(o){let e=new yr(3*Es,3*Es,o);return e.texture.mapping=dn,e.texture.name="PMREM.cubeUv",e.scissorTest=!0,e}function S1(o,e,t,r,n){o.viewport.set(e,t,r,n),o.scissor.set(e,t,r,n)}function SG(o){let e=new Float32Array(o),t=new M(0,1,0);return new K0({name:"SphericalGaussianBlur",defines:{n:o},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:e},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:t}},vertexShader:o4(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:un,depthTest:!1,depthWrite:!1})}function KA(){let o=new z(1,1);return new K0({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null},texelSize:{value:o}},vertexShader:o4(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform vec2 texelSize;

			#include <common>

			void main() {

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				vec2 f = fract( uv / texelSize - 0.5 );
				uv -= f * texelSize;
				vec3 tl = texture2D ( envMap, uv ).rgb;
				uv.x += texelSize.x;
				vec3 tr = texture2D ( envMap, uv ).rgb;
				uv.y += texelSize.y;
				vec3 br = texture2D ( envMap, uv ).rgb;
				uv.x -= texelSize.x;
				vec3 bl = texture2D ( envMap, uv ).rgb;

				vec3 tm = mix( tl, tr, f.x );
				vec3 bm = mix( bl, br, f.x );
				gl_FragColor.rgb = mix( tm, bm, f.y );

			}
		`,blending:un,depthTest:!1,depthWrite:!1})}function JA(){return new K0({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:o4(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:un,depthTest:!1,depthWrite:!1})}function o4(){return`

		precision mediump float;
		precision mediump int;

		attribute vec3 position;
		attribute vec2 uv;
		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function eC(o){let e=new WeakMap,t=null;function r(a){if(a&&a.isTexture){let c=a.mapping,l=c===n0||c===i0,u=c===pn||c===Sn;if(l||u)if(a.isRenderTargetTexture&&a.needsPMREMUpdate===!0){a.needsPMREMUpdate=!1;let p=e.get(a);return t===null&&(t=new Tu(o)),p=l?t.fromEquirectangular(a,p):t.fromCubemap(a,p),e.set(a,p),p.texture}else{if(e.has(a))return e.get(a).texture;{let p=a.image;if(l&&p&&p.height>0||u&&p&&n(p)){t===null&&(t=new Tu(o));let d=l?t.fromEquirectangular(a):t.fromCubemap(a);return e.set(a,d),a.addEventListener("dispose",i),d.texture}else return null}}}return a}function n(a){let c=0,l=6;for(let u=0;u<l;u++)a[u]!==void 0&&c++;return c===l}function i(a){let c=a.target;c.removeEventListener("dispose",i);let l=e.get(c);l!==void 0&&(e.delete(c),l.dispose())}function s(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return{get:r,dispose:s}}function tC(o){let e={};function t(r){if(e[r]!==void 0)return e[r];let n;switch(r){case"WEBGL_depth_texture":n=o.getExtension("WEBGL_depth_texture")||o.getExtension("MOZ_WEBGL_depth_texture")||o.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":n=o.getExtension("EXT_texture_filter_anisotropic")||o.getExtension("MOZ_EXT_texture_filter_anisotropic")||o.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":n=o.getExtension("WEBGL_compressed_texture_s3tc")||o.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||o.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":n=o.getExtension("WEBGL_compressed_texture_pvrtc")||o.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:n=o.getExtension(r)}return e[r]=n,n}return{has:function(r){return t(r)!==null},init:function(r){r.isWebGL2?t("EXT_color_buffer_float"):(t("WEBGL_depth_texture"),t("OES_texture_float"),t("OES_texture_half_float"),t("OES_texture_half_float_linear"),t("OES_standard_derivatives"),t("OES_element_index_uint"),t("OES_vertex_array_object"),t("ANGLE_instanced_arrays")),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture")},get:function(r){let n=t(r);return n===null&&console.warn("THREE.WebGLRenderer: "+r+" extension not supported."),n}}}function rC(o,e,t,r){let n={},i=new WeakMap;function s(p){let d=p.target;d.index!==null&&e.remove(d.index);for(let m in d.attributes)e.remove(d.attributes[m]);d.removeEventListener("dispose",s),delete n[d.id];let h=i.get(d);h&&(e.remove(h),i.delete(d)),r.releaseStatesOfGeometry(d),d.isInstancedBufferGeometry===!0&&delete d._maxInstanceCount,t.memory.geometries--}function a(p,d){return n[d.id]===!0||(d.addEventListener("dispose",s),n[d.id]=!0,t.memory.geometries++),d}function c(p){let d=p.attributes;for(let m in d)e.update(d[m],o.ARRAY_BUFFER);let h=p.morphAttributes;for(let m in h){let f=h[m];for(let v=0,g=f.length;v<g;v++)e.update(f[v],o.ARRAY_BUFFER)}}function l(p){let d=[],h=p.index,m=p.attributes.position,f=0;if(h!==null){let _=h.array;f=h.version;for(let T=0,b=_.length;T<b;T+=3){let x=_[T+0],A=_[T+1],E=_[T+2];d.push(x,A,A,E,E,x)}}else{let _=m.array;f=m.version;for(let T=0,b=_.length/3-1;T<b;T+=3){let x=T+0,A=T+1,E=T+2;d.push(x,A,A,E,E,x)}}let v=new(ub(d)?lb:ab)(d,1);v.version=f;let g=i.get(p);g&&e.remove(g),i.set(p,v)}function u(p){let d=i.get(p);if(d){let h=p.index;h!==null&&d.version<h.version&&l(p)}else l(p);return i.get(p)}return{get:a,update:c,getWireframeAttribute:u}}function oC(o,e,t,r){let n=r.isWebGL2,i;function s(d){i=d}let a,c;function l(d){a=d.type,c=d.bytesPerElement}function u(d,h){o.drawElements(i,h,a,d*c),t.update(h,i,1)}function p(d,h,m){if(m===0)return;let f,v;if(n)f=o,v="drawElementsInstanced";else if(f=e.get("ANGLE_instanced_arrays"),v="drawElementsInstancedANGLE",f===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}f[v](i,h,a,d*c,m),t.update(h,i,m)}this.setMode=s,this.setIndex=l,this.render=u,this.renderInstances=p}function nC(o){let e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function r(i,s,a){switch(t.calls++,s){case o.TRIANGLES:t.triangles+=a*(i/3);break;case o.LINES:t.lines+=a*(i/2);break;case o.LINE_STRIP:t.lines+=a*(i-1);break;case o.LINE_LOOP:t.lines+=a*i;break;case o.POINTS:t.points+=a*i;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",s);break}}function n(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:e,render:t,programs:null,autoReset:!0,reset:n,update:r}}var Au=class extends vr{constructor(e=null,t=1,r=1,n=1){super(null);this.image={data:e,width:t,height:r,depth:n},this.magFilter=it,this.minFilter=it,this.wrapR=Ft,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}};Au.prototype.isDataTexture2DArray=!0;function wG(o,e){return o[0]-e[0]}function MG(o,e){return Math.abs(e[1])-Math.abs(o[1])}function iC(o,e){let t=1,r=e.isInterleavedBufferAttribute?e.data.array:e.array;r instanceof Int8Array?t=127:r instanceof Int16Array?t=32767:r instanceof Int32Array?t=2147483647:console.error("THREE.WebGLMorphtargets: Unsupported morph attribute data type: ",r),o.divideScalar(t)}function sC(o,e,t){let r={},n=new Float32Array(8),i=new WeakMap,s=new M,a=[];for(let l=0;l<8;l++)a[l]=[l,0];function c(l,u,p,d){let h=l.morphTargetInfluences;if(e.isWebGL2===!0){let m=u.morphAttributes.position.length,f=i.get(u);if(f===void 0||f.count!==m){let N=function(){O.dispose(),i.delete(u),u.removeEventListener("dispose",N)};f!==void 0&&f.texture.dispose();let _=u.morphAttributes.normal!==void 0,T=u.morphAttributes.position,b=u.morphAttributes.normal||[],x=u.attributes.position.count,A=_===!0?2:1,E=x*A,S=1;E>e.maxTextureSize&&(S=Math.ceil(E/e.maxTextureSize),E=e.maxTextureSize);let w=new Float32Array(E*S*4*m),O=new Au(w,E,S,m);O.format=at,O.type=qt,O.needsUpdate=!0;let C=A*4;for(let R=0;R<m;R++){let D=T[R],V=b[R],F=E*S*4*R;for(let j=0;j<D.count;j++){s.fromBufferAttribute(D,j),D.normalized===!0&&iC(s,D);let $=j*C;w[F+$+0]=s.x,w[F+$+1]=s.y,w[F+$+2]=s.z,w[F+$+3]=0,_===!0&&(s.fromBufferAttribute(V,j),V.normalized===!0&&iC(s,V),w[F+$+4]=s.x,w[F+$+5]=s.y,w[F+$+6]=s.z,w[F+$+7]=0)}}f={count:m,texture:O,size:new z(E,S)},i.set(u,f),u.addEventListener("dispose",N)}let v=0;for(let _=0;_<h.length;_++)v+=h[_];let g=u.morphTargetsRelative?1:1-v;d.getUniforms().setValue(o,"morphTargetBaseInfluence",g),d.getUniforms().setValue(o,"morphTargetInfluences",h),d.getUniforms().setValue(o,"morphTargetsTexture",f.texture,t),d.getUniforms().setValue(o,"morphTargetsTextureSize",f.size)}else{let m=h===void 0?0:h.length,f=r[u.id];if(f===void 0||f.length!==m){f=[];for(let b=0;b<m;b++)f[b]=[b,0];r[u.id]=f}for(let b=0;b<m;b++){let x=f[b];x[0]=b,x[1]=h[b]}f.sort(MG);for(let b=0;b<8;b++)b<m&&f[b][1]?(a[b][0]=f[b][0],a[b][1]=f[b][1]):(a[b][0]=Number.MAX_SAFE_INTEGER,a[b][1]=0);a.sort(wG);let v=u.morphAttributes.position,g=u.morphAttributes.normal,_=0;for(let b=0;b<8;b++){let x=a[b],A=x[0],E=x[1];A!==Number.MAX_SAFE_INTEGER&&E?(v&&u.getAttribute("morphTarget"+b)!==v[A]&&u.setAttribute("morphTarget"+b,v[A]),g&&u.getAttribute("morphNormal"+b)!==g[A]&&u.setAttribute("morphNormal"+b,g[A]),n[b]=E,_+=E):(v&&u.hasAttribute("morphTarget"+b)===!0&&u.deleteAttribute("morphTarget"+b),g&&u.hasAttribute("morphNormal"+b)===!0&&u.deleteAttribute("morphNormal"+b),n[b]=0)}let T=u.morphTargetsRelative?1:1-_;d.getUniforms().setValue(o,"morphTargetBaseInfluence",T),d.getUniforms().setValue(o,"morphTargetInfluences",n)}}return{update:c}}var Z0=class extends yr{constructor(e,t,r={}){super(e,t,r);this.samples=4,this.ignoreDepthForMultisampleCopy=r.ignoreDepth!==void 0?r.ignoreDepth:!0,this.useRenderToTexture=r.useRenderToTexture!==void 0?r.useRenderToTexture:!1,this.useRenderbuffer=this.useRenderToTexture===!1}copy(e){return super.copy.call(this,e),this.samples=e.samples,this.useRenderToTexture=e.useRenderToTexture,this.useRenderbuffer=e.useRenderbuffer,this}};Z0.prototype.isWebGLMultisampleRenderTarget=!0;function aC(o,e,t,r){let n=new WeakMap;function i(c){let l=r.render.frame,u=c.geometry,p=e.get(c,u);return n.get(p)!==l&&(e.update(p),n.set(p,l)),c.isInstancedMesh&&(c.hasEventListener("dispose",a)===!1&&c.addEventListener("dispose",a),t.update(c.instanceMatrix,o.ARRAY_BUFFER),c.instanceColor!==null&&t.update(c.instanceColor,o.ARRAY_BUFFER)),p}function s(){n=new WeakMap}function a(c){let l=c.target;l.removeEventListener("dispose",a),t.remove(l.instanceMatrix),l.instanceColor!==null&&t.remove(l.instanceColor)}return{update:i,dispose:s}}var w1=class extends vr{constructor(e=null,t=1,r=1,n=1){super(null);this.image={data:e,width:t,height:r,depth:n},this.magFilter=it,this.minFilter=it,this.wrapR=Ft,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}};w1.prototype.isDataTexture3D=!0;var fC=new vr,mC=new Au,_C=new w1,gC=new $0,cC=[],lC=[],uC=new Float32Array(16),pC=new Float32Array(9),dC=new Float32Array(4);function Cu(o,e,t){let r=o[0];if(r<=0||r>0)return o;let n=e*t,i=cC[n];if(i===void 0&&(i=new Float32Array(n),cC[n]=i),e!==0){r.toArray(i,0);for(let s=1,a=0;s!==e;++s)a+=t,o[s].toArray(i,a)}return i}function Yo(o,e){if(o.length!==e.length)return!1;for(let t=0,r=o.length;t<r;t++)if(o[t]!==e[t])return!1;return!0}function Lo(o,e){for(let t=0,r=e.length;t<r;t++)o[t]=e[t]}function M1(o,e){let t=lC[e];t===void 0&&(t=new Int32Array(e),lC[e]=t);for(let r=0;r!==e;++r)t[r]=o.allocateTextureUnit();return t}function NG(o,e){let t=this.cache;t[0]!==e&&(o.uniform1f(this.addr,e),t[0]=e)}function OG(o,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(o.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Yo(t,e))return;o.uniform2fv(this.addr,e),Lo(t,e)}}function PG(o,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(o.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(o.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(Yo(t,e))return;o.uniform3fv(this.addr,e),Lo(t,e)}}function RG(o,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(o.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Yo(t,e))return;o.uniform4fv(this.addr,e),Lo(t,e)}}function IG(o,e){let t=this.cache,r=e.elements;if(r===void 0){if(Yo(t,e))return;o.uniformMatrix2fv(this.addr,!1,e),Lo(t,e)}else{if(Yo(t,r))return;dC.set(r),o.uniformMatrix2fv(this.addr,!1,dC),Lo(t,r)}}function LG(o,e){let t=this.cache,r=e.elements;if(r===void 0){if(Yo(t,e))return;o.uniformMatrix3fv(this.addr,!1,e),Lo(t,e)}else{if(Yo(t,r))return;pC.set(r),o.uniformMatrix3fv(this.addr,!1,pC),Lo(t,r)}}function DG(o,e){let t=this.cache,r=e.elements;if(r===void 0){if(Yo(t,e))return;o.uniformMatrix4fv(this.addr,!1,e),Lo(t,e)}else{if(Yo(t,r))return;uC.set(r),o.uniformMatrix4fv(this.addr,!1,uC),Lo(t,r)}}function kG(o,e){let t=this.cache;t[0]!==e&&(o.uniform1i(this.addr,e),t[0]=e)}function BG(o,e){let t=this.cache;Yo(t,e)||(o.uniform2iv(this.addr,e),Lo(t,e))}function FG(o,e){let t=this.cache;Yo(t,e)||(o.uniform3iv(this.addr,e),Lo(t,e))}function UG(o,e){let t=this.cache;Yo(t,e)||(o.uniform4iv(this.addr,e),Lo(t,e))}function VG(o,e){let t=this.cache;t[0]!==e&&(o.uniform1ui(this.addr,e),t[0]=e)}function GG(o,e){let t=this.cache;Yo(t,e)||(o.uniform2uiv(this.addr,e),Lo(t,e))}function zG(o,e){let t=this.cache;Yo(t,e)||(o.uniform3uiv(this.addr,e),Lo(t,e))}function HG(o,e){let t=this.cache;Yo(t,e)||(o.uniform4uiv(this.addr,e),Lo(t,e))}function jG(o,e,t){let r=this.cache,n=t.allocateTextureUnit();r[0]!==n&&(o.uniform1i(this.addr,n),r[0]=n),t.safeSetTexture2D(e||fC,n)}function WG(o,e,t){let r=this.cache,n=t.allocateTextureUnit();r[0]!==n&&(o.uniform1i(this.addr,n),r[0]=n),t.setTexture3D(e||_C,n)}function qG(o,e,t){let r=this.cache,n=t.allocateTextureUnit();r[0]!==n&&(o.uniform1i(this.addr,n),r[0]=n),t.safeSetTextureCube(e||gC,n)}function XG(o,e,t){let r=this.cache,n=t.allocateTextureUnit();r[0]!==n&&(o.uniform1i(this.addr,n),r[0]=n),t.setTexture2DArray(e||mC,n)}function YG(o){switch(o){case 5126:return NG;case 35664:return OG;case 35665:return PG;case 35666:return RG;case 35674:return IG;case 35675:return LG;case 35676:return DG;case 5124:case 35670:return kG;case 35667:case 35671:return BG;case 35668:case 35672:return FG;case 35669:case 35673:return UG;case 5125:return VG;case 36294:return GG;case 36295:return zG;case 36296:return HG;case 35678:case 36198:case 36298:case 36306:case 35682:return jG;case 35679:case 36299:case 36307:return WG;case 35680:case 36300:case 36308:case 36293:return qG;case 36289:case 36303:case 36311:case 36292:return XG}}function $G(o,e){o.uniform1fv(this.addr,e)}function KG(o,e){let t=Cu(e,this.size,2);o.uniform2fv(this.addr,t)}function JG(o,e){let t=Cu(e,this.size,3);o.uniform3fv(this.addr,t)}function ZG(o,e){let t=Cu(e,this.size,4);o.uniform4fv(this.addr,t)}function QG(o,e){let t=Cu(e,this.size,4);o.uniformMatrix2fv(this.addr,!1,t)}function ez(o,e){let t=Cu(e,this.size,9);o.uniformMatrix3fv(this.addr,!1,t)}function tz(o,e){let t=Cu(e,this.size,16);o.uniformMatrix4fv(this.addr,!1,t)}function rz(o,e){o.uniform1iv(this.addr,e)}function oz(o,e){o.uniform2iv(this.addr,e)}function nz(o,e){o.uniform3iv(this.addr,e)}function iz(o,e){o.uniform4iv(this.addr,e)}function sz(o,e){o.uniform1uiv(this.addr,e)}function az(o,e){o.uniform2uiv(this.addr,e)}function cz(o,e){o.uniform3uiv(this.addr,e)}function lz(o,e){o.uniform4uiv(this.addr,e)}function uz(o,e,t){let r=e.length,n=M1(t,r);o.uniform1iv(this.addr,n);for(let i=0;i!==r;++i)t.safeSetTexture2D(e[i]||fC,n[i])}function pz(o,e,t){let r=e.length,n=M1(t,r);o.uniform1iv(this.addr,n);for(let i=0;i!==r;++i)t.setTexture3D(e[i]||_C,n[i])}function dz(o,e,t){let r=e.length,n=M1(t,r);o.uniform1iv(this.addr,n);for(let i=0;i!==r;++i)t.safeSetTextureCube(e[i]||gC,n[i])}function hz(o,e,t){let r=e.length,n=M1(t,r);o.uniform1iv(this.addr,n);for(let i=0;i!==r;++i)t.setTexture2DArray(e[i]||mC,n[i])}function fz(o){switch(o){case 5126:return $G;case 35664:return KG;case 35665:return JG;case 35666:return ZG;case 35674:return QG;case 35675:return ez;case 35676:return tz;case 5124:case 35670:return rz;case 35667:case 35671:return oz;case 35668:case 35672:return nz;case 35669:case 35673:return iz;case 5125:return sz;case 36294:return az;case 36295:return cz;case 36296:return lz;case 35678:case 36198:case 36298:case 36306:case 35682:return uz;case 35679:case 36299:case 36307:return pz;case 35680:case 36300:case 36308:case 36293:return dz;case 36289:case 36303:case 36311:case 36292:return hz}}function mz(o,e,t){this.id=o,this.addr=t,this.cache=[],this.setValue=YG(e.type)}function vC(o,e,t){this.id=o,this.addr=t,this.cache=[],this.size=e.size,this.setValue=fz(e.type)}vC.prototype.updateCache=function(o){let e=this.cache;o instanceof Float32Array&&e.length!==o.length&&(this.cache=new Float32Array(o.length)),Lo(e,o)};function yC(o){this.id=o,this.seq=[],this.map={}}yC.prototype.setValue=function(o,e,t){let r=this.seq;for(let n=0,i=r.length;n!==i;++n){let s=r[n];s.setValue(o,e[s.id],t)}};var n4=/(\w+)(\])?(\[|\.)?/g;function hC(o,e){o.seq.push(e),o.map[e.id]=e}function _z(o,e,t){let r=o.name,n=r.length;for(n4.lastIndex=0;;){let i=n4.exec(r),s=n4.lastIndex,a=i[1],c=i[2]==="]",l=i[3];if(c&&(a=a|0),l===void 0||l==="["&&s+2===n){hC(t,l===void 0?new mz(a,o,e):new vC(a,o,e));break}else{let p=t.map[a];p===void 0&&(p=new yC(a),hC(t,p)),t=p}}}function Ss(o,e){this.seq=[],this.map={};let t=o.getProgramParameter(e,o.ACTIVE_UNIFORMS);for(let r=0;r<t;++r){let n=o.getActiveUniform(e,r),i=o.getUniformLocation(e,n.name);_z(n,i,this)}}Ss.prototype.setValue=function(o,e,t,r){let n=this.map[e];n!==void 0&&n.setValue(o,t,r)};Ss.prototype.setOptional=function(o,e,t){let r=e[t];r!==void 0&&this.setValue(o,t,r)};Ss.upload=function(o,e,t,r){for(let n=0,i=e.length;n!==i;++n){let s=e[n],a=t[s.id];a.needsUpdate!==!1&&s.setValue(o,a.value,r)}};Ss.seqWithValue=function(o,e){let t=[];for(let r=0,n=o.length;r!==n;++r){let i=o[r];i.id in e&&t.push(i)}return t};function i4(o,e,t){let r=o.createShader(e);return o.shaderSource(r,t),o.compileShader(r),r}var gz=0;function vz(o){let e=o.split(`
`);for(let t=0;t<e.length;t++)e[t]=t+1+": "+e[t];return e.join(`
`)}function yz(o){switch(o){case Xr:return["Linear","( value )"];case bt:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",o),["Linear","( value )"]}}function xC(o,e,t){let r=o.getShaderParameter(e,o.COMPILE_STATUS),n=o.getShaderInfoLog(e).trim();return r&&n===""?"":t.toUpperCase()+`

`+n+`

`+vz(o.getShaderSource(e))}function xz(o,e){let t=yz(e);return"vec4 "+o+"( vec4 value ) { return LinearTo"+t[0]+t[1]+"; }"}function bz(o,e){let t;switch(e){case qm:t="Linear";break;case Xm:t="Reinhard";break;case Ym:t="OptimizedCineon";break;case $m:t="ACESFilmic";break;case Yx:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+o+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function Tz(o){return[o.extensionDerivatives||o.envMapCubeUV||o.bumpMap||o.tangentSpaceNormalMap||o.clearcoatNormalMap||o.flatShading||o.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(o.extensionFragDepth||o.logarithmicDepthBuffer)&&o.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",o.extensionDrawBuffers&&o.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(o.extensionShaderTextureLOD||o.envMap||o.transmission)&&o.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Xd).join(`
`)}function Az(o){let e=[];for(let t in o){let r=o[t];r!==!1&&e.push("#define "+t+" "+r)}return e.join(`
`)}function Cz(o,e){let t={},r=o.getProgramParameter(e,o.ACTIVE_ATTRIBUTES);for(let n=0;n<r;n++){let i=o.getActiveAttrib(e,n),s=i.name,a=1;i.type===o.FLOAT_MAT2&&(a=2),i.type===o.FLOAT_MAT3&&(a=3),i.type===o.FLOAT_MAT4&&(a=4),t[s]={type:i.type,location:o.getAttribLocation(e,s),locationSize:a}}return t}function Xd(o){return o!==""}function bC(o,e){return o.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function TC(o,e){return o.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}var Ez=/^[ \t]*#include +<([\w\d./]+)>/gm;function s4(o){return o.replace(Ez,Sz)}function Sz(o,e){let t=ht[e];if(t===void 0)throw new Error("Can not resolve #include <"+e+">");return s4(t)}var wz=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,Mz=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function AC(o){return o.replace(Mz,EC).replace(wz,Nz)}function Nz(o,e,t,r){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),EC(o,e,t,r)}function EC(o,e,t,r){let n="";for(let i=parseInt(e);i<parseInt(t);i++)n+=r.replace(/\[\s*i\s*\]/g,"[ "+i+" ]").replace(/UNROLLED_LOOP_INDEX/g,i);return n}function CC(o){let e="precision "+o.precision+` float;
precision `+o.precision+" int;";return o.precision==="highp"?e+=`
#define HIGH_PRECISION`:o.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:o.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function Oz(o){let e="SHADOWMAP_TYPE_BASIC";return o.shadowMapType===au?e="SHADOWMAP_TYPE_PCF":o.shadowMapType===Hm?e="SHADOWMAP_TYPE_PCF_SOFT":o.shadowMapType===o0&&(e="SHADOWMAP_TYPE_VSM"),e}function Pz(o){let e="ENVMAP_TYPE_CUBE";if(o.envMap)switch(o.envMapMode){case pn:case Sn:e="ENVMAP_TYPE_CUBE";break;case dn:case Pi:e="ENVMAP_TYPE_CUBE_UV";break}return e}function Rz(o){let e="ENVMAP_MODE_REFLECTION";if(o.envMap)switch(o.envMapMode){case Sn:case Pi:e="ENVMAP_MODE_REFRACTION";break}return e}function Iz(o){let e="ENVMAP_BLENDING_NONE";if(o.envMap)switch(o.combine){case lu:e="ENVMAP_BLENDING_MULTIPLY";break;case jm:e="ENVMAP_BLENDING_MIX";break;case Wm:e="ENVMAP_BLENDING_ADD";break}return e}function SC(o,e,t,r){let n=o.getContext(),i=t.defines,s=t.vertexShader,a=t.fragmentShader,c=Oz(t),l=Pz(t),u=Rz(t),p=Iz(t),d=t.isWebGL2?"":Tz(t),h=Az(i),m=n.createProgram(),f,v,g=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(f=[h].filter(Xd).join(`
`),f.length>0&&(f+=`
`),v=[d,h].filter(Xd).join(`
`),v.length>0&&(v+=`
`)):(f=[CC(t),"#define SHADER_NAME "+t.shaderName,h,t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define MAX_BONES "+t.maxBones,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+u:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.displacementMap&&t.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",t.specularColorMap?"#define USE_SPECULARCOLORMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEENCOLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.useVertexTexture?"#define BONE_TEXTURE":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphTargets&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",t.morphTargets&&t.isWebGL2?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+c:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(Xd).join(`
`),v=[d,CC(t),"#define SHADER_NAME "+t.shaderName,h,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+l:"",t.envMap?"#define "+u:"",t.envMap?"#define "+p:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",t.specularColorMap?"#define USE_SPECULARCOLORMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEENCOLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+c:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(t.extensionShaderTextureLOD||t.envMap)&&t.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==Ro?"#define TONE_MAPPING":"",t.toneMapping!==Ro?ht.tonemapping_pars_fragment:"",t.toneMapping!==Ro?bz("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.transparent?"":"#define OPAQUE",ht.encodings_pars_fragment,xz("linearToOutputTexel",t.outputEncoding),t.depthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(Xd).join(`
`)),s=s4(s),s=bC(s,t),s=TC(s,t),a=s4(a),a=bC(a,t),a=TC(a,t),s=AC(s),a=AC(a),t.isWebGL2&&t.isRawShaderMaterial!==!0&&(g=`#version 300 es
`,f=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+f,v=["#define varying in",t.glslVersion===K3?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===K3?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+v);let _=g+f+s,T=g+v+a,b=i4(n,n.VERTEX_SHADER,_),x=i4(n,n.FRAGMENT_SHADER,T);if(n.attachShader(m,b),n.attachShader(m,x),t.index0AttributeName!==void 0?n.bindAttribLocation(m,0,t.index0AttributeName):t.morphTargets===!0&&n.bindAttribLocation(m,0,"position"),n.linkProgram(m),o.debug.checkShaderErrors){let S=n.getProgramInfoLog(m).trim(),w=n.getShaderInfoLog(b).trim(),O=n.getShaderInfoLog(x).trim(),C=!0,N=!0;if(n.getProgramParameter(m,n.LINK_STATUS)===!1){C=!1;let R=xC(n,b,"vertex"),D=xC(n,x,"fragment");console.error("THREE.WebGLProgram: Shader Error "+n.getError()+" - VALIDATE_STATUS "+n.getProgramParameter(m,n.VALIDATE_STATUS)+`

Program Info Log: `+S+`
`+R+`
`+D)}else S!==""?console.warn("THREE.WebGLProgram: Program Info Log:",S):(w===""||O==="")&&(N=!1);N&&(this.diagnostics={runnable:C,programLog:S,vertexShader:{log:w,prefix:f},fragmentShader:{log:O,prefix:v}})}n.deleteShader(b),n.deleteShader(x);let A;this.getUniforms=function(){return A===void 0&&(A=new Ss(n,m)),A};let E;return this.getAttributes=function(){return E===void 0&&(E=Cz(n,m)),E},this.destroy=function(){r.releaseStatesOfProgram(this),n.deleteProgram(m),this.program=void 0},this.name=t.shaderName,this.id=gz++,this.cacheKey=e,this.usedTimes=1,this.program=m,this.vertexShader=b,this.fragmentShader=x,this}var Lz=0,a4=class{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){let t=e.vertexShader,r=e.fragmentShader,n=this._getShaderStage(t),i=this._getShaderStage(r),s=this._getShaderCacheForMaterial(e);return s.has(n)===!1&&(s.add(n),n.usedTimes++),s.has(i)===!1&&(s.add(i),i.usedTimes++),this}remove(e){let t=this.materialCache.get(e);for(let r of t)r.usedTimes--,r.usedTimes===0&&this.shaderCache.delete(r);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){let t=this.materialCache;return t.has(e)===!1&&t.set(e,new Set),t.get(e)}_getShaderStage(e){let t=this.shaderCache;if(t.has(e)===!1){let r=new wC;t.set(e,r)}return t.get(e)}},wC=class{constructor(){this.id=Lz++,this.usedTimes=0}};function MC(o,e,t,r,n,i,s){let a=new _1,c=new a4,l=[],u=n.isWebGL2,p=n.logarithmicDepthBuffer,d=n.floatVertexTextures,h=n.maxVertexUniforms,m=n.vertexTextures,f=n.precision,v={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function g(C){let R=C.skeleton.bones;if(d)return 1024;{let V=Math.floor((h-20)/4),F=Math.min(V,R.length);return F<R.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+R.length+" bones. This GPU supports "+F+"."),0):F}}function _(C,N,R,D,V){let F=D.fog,j=C.isMeshStandardMaterial?D.environment:null,$=(C.isMeshStandardMaterial?t:e).get(C.envMap||j),Y=v[C.type],H=V.isSkinnedMesh?g(V):0;C.precision!==null&&(f=n.getMaxPrecision(C.precision),f!==C.precision&&console.warn("THREE.WebGLProgram.getParameters:",C.precision,"not supported, using",f,"instead."));let B,te,X,W;if(Y){let Ae=oi[Y];B=Ae.vertexShader,te=Ae.fragmentShader}else B=C.vertexShader,te=C.fragmentShader,c.update(C),X=c.getVertexShaderID(C),W=c.getFragmentShaderID(C);let L=o.getRenderTarget(),Ne=C.alphaTest>0,ye=C.clearcoat>0;return{isWebGL2:u,shaderID:Y,shaderName:C.type,vertexShader:B,fragmentShader:te,defines:C.defines,customVertexShaderID:X,customFragmentShaderID:W,isRawShaderMaterial:C.isRawShaderMaterial===!0,glslVersion:C.glslVersion,precision:f,instancing:V.isInstancedMesh===!0,instancingColor:V.isInstancedMesh===!0&&V.instanceColor!==null,supportsVertexTextures:m,outputEncoding:L===null?o.outputEncoding:L.isXRRenderTarget===!0?L.texture.encoding:Xr,map:!!C.map,matcap:!!C.matcap,envMap:!!$,envMapMode:$&&$.mapping,envMapCubeUV:!!$&&($.mapping===dn||$.mapping===Pi),lightMap:!!C.lightMap,aoMap:!!C.aoMap,emissiveMap:!!C.emissiveMap,bumpMap:!!C.bumpMap,normalMap:!!C.normalMap,objectSpaceNormalMap:C.normalMapType===m1,tangentSpaceNormalMap:C.normalMapType===hn,decodeVideoTexture:!!C.map&&C.map.isVideoTexture===!0&&C.map.encoding===bt,clearcoat:ye,clearcoatMap:ye&&!!C.clearcoatMap,clearcoatRoughnessMap:ye&&!!C.clearcoatRoughnessMap,clearcoatNormalMap:ye&&!!C.clearcoatNormalMap,displacementMap:!!C.displacementMap,roughnessMap:!!C.roughnessMap,metalnessMap:!!C.metalnessMap,specularMap:!!C.specularMap,specularIntensityMap:!!C.specularIntensityMap,specularColorMap:!!C.specularColorMap,transparent:C.transparent,alphaMap:!!C.alphaMap,alphaTest:Ne,gradientMap:!!C.gradientMap,sheen:C.sheen>0,sheenColorMap:!!C.sheenColorMap,sheenRoughnessMap:!!C.sheenRoughnessMap,transmission:C.transmission>0,transmissionMap:!!C.transmissionMap,thicknessMap:!!C.thicknessMap,combine:C.combine,vertexTangents:!!C.normalMap&&!!V.geometry&&!!V.geometry.attributes.tangent,vertexColors:C.vertexColors,vertexAlphas:C.vertexColors===!0&&!!V.geometry&&!!V.geometry.attributes.color&&V.geometry.attributes.color.itemSize===4,vertexUvs:!!C.map||!!C.bumpMap||!!C.normalMap||!!C.specularMap||!!C.alphaMap||!!C.emissiveMap||!!C.roughnessMap||!!C.metalnessMap||!!C.clearcoatMap||!!C.clearcoatRoughnessMap||!!C.clearcoatNormalMap||!!C.displacementMap||!!C.transmissionMap||!!C.thicknessMap||!!C.specularIntensityMap||!!C.specularColorMap||!!C.sheenColorMap||!!C.sheenRoughnessMap,uvsVertexOnly:!(!!C.map||!!C.bumpMap||!!C.normalMap||!!C.specularMap||!!C.alphaMap||!!C.emissiveMap||!!C.roughnessMap||!!C.metalnessMap||!!C.clearcoatNormalMap||C.transmission>0||!!C.transmissionMap||!!C.thicknessMap||!!C.specularIntensityMap||!!C.specularColorMap||C.sheen>0||!!C.sheenColorMap||!!C.sheenRoughnessMap)&&!!C.displacementMap,fog:!!F,useFog:C.fog,fogExp2:F&&F.isFogExp2,flatShading:!!C.flatShading,sizeAttenuation:C.sizeAttenuation,logarithmicDepthBuffer:p,skinning:V.isSkinnedMesh===!0&&H>0,maxBones:H,useVertexTexture:d,morphTargets:!!V.geometry&&!!V.geometry.morphAttributes.position,morphNormals:!!V.geometry&&!!V.geometry.morphAttributes.normal,morphTargetsCount:!!V.geometry&&!!V.geometry.morphAttributes.position?V.geometry.morphAttributes.position.length:0,numDirLights:N.directional.length,numPointLights:N.point.length,numSpotLights:N.spot.length,numRectAreaLights:N.rectArea.length,numHemiLights:N.hemi.length,numDirLightShadows:N.directionalShadowMap.length,numPointLightShadows:N.pointShadowMap.length,numSpotLightShadows:N.spotShadowMap.length,numClippingPlanes:s.numPlanes,numClipIntersection:s.numIntersection,dithering:C.dithering,shadowMapEnabled:o.shadowMap.enabled&&R.length>0,shadowMapType:o.shadowMap.type,toneMapping:C.toneMapped?o.toneMapping:Ro,physicallyCorrectLights:o.physicallyCorrectLights,premultipliedAlpha:C.premultipliedAlpha,doubleSided:C.side===Wr,flipSided:C.side===Mt,depthPacking:C.depthPacking!==void 0?C.depthPacking:!1,index0AttributeName:C.index0AttributeName,extensionDerivatives:C.extensions&&C.extensions.derivatives,extensionFragDepth:C.extensions&&C.extensions.fragDepth,extensionDrawBuffers:C.extensions&&C.extensions.drawBuffers,extensionShaderTextureLOD:C.extensions&&C.extensions.shaderTextureLOD,rendererExtensionFragDepth:u||r.has("EXT_frag_depth"),rendererExtensionDrawBuffers:u||r.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:u||r.has("EXT_shader_texture_lod"),customProgramCacheKey:C.customProgramCacheKey()}}function T(C){let N=[];if(C.shaderID?N.push(C.shaderID):(N.push(C.customVertexShaderID),N.push(C.customFragmentShaderID)),C.defines!==void 0)for(let R in C.defines)N.push(R),N.push(C.defines[R]);return C.isRawShaderMaterial===!1&&(b(N,C),x(N,C),N.push(o.outputEncoding)),N.push(C.customProgramCacheKey),N.join()}function b(C,N){C.push(N.precision),C.push(N.outputEncoding),C.push(N.envMapMode),C.push(N.combine),C.push(N.vertexUvs),C.push(N.fogExp2),C.push(N.sizeAttenuation),C.push(N.maxBones),C.push(N.morphTargetsCount),C.push(N.numDirLights),C.push(N.numPointLights),C.push(N.numSpotLights),C.push(N.numHemiLights),C.push(N.numRectAreaLights),C.push(N.numDirLightShadows),C.push(N.numPointLightShadows),C.push(N.numSpotLightShadows),C.push(N.shadowMapType),C.push(N.toneMapping),C.push(N.numClippingPlanes),C.push(N.numClipIntersection)}function x(C,N){a.disableAll(),N.isWebGL2&&a.enable(0),N.supportsVertexTextures&&a.enable(1),N.instancing&&a.enable(2),N.instancingColor&&a.enable(3),N.map&&a.enable(4),N.matcap&&a.enable(5),N.envMap&&a.enable(6),N.envMapCubeUV&&a.enable(7),N.lightMap&&a.enable(8),N.aoMap&&a.enable(9),N.emissiveMap&&a.enable(10),N.bumpMap&&a.enable(11),N.normalMap&&a.enable(12),N.objectSpaceNormalMap&&a.enable(13),N.tangentSpaceNormalMap&&a.enable(14),N.clearcoat&&a.enable(15),N.clearcoatMap&&a.enable(16),N.clearcoatRoughnessMap&&a.enable(17),N.clearcoatNormalMap&&a.enable(18),N.displacementMap&&a.enable(19),N.specularMap&&a.enable(20),N.roughnessMap&&a.enable(21),N.metalnessMap&&a.enable(22),N.gradientMap&&a.enable(23),N.alphaMap&&a.enable(24),N.alphaTest&&a.enable(25),N.vertexColors&&a.enable(26),N.vertexAlphas&&a.enable(27),N.vertexUvs&&a.enable(28),N.vertexTangents&&a.enable(29),N.uvsVertexOnly&&a.enable(30),N.fog&&a.enable(31),C.push(a.mask),a.disableAll(),N.useFog&&a.enable(0),N.flatShading&&a.enable(1),N.logarithmicDepthBuffer&&a.enable(2),N.skinning&&a.enable(3),N.useVertexTexture&&a.enable(4),N.morphTargets&&a.enable(5),N.morphNormals&&a.enable(6),N.premultipliedAlpha&&a.enable(7),N.shadowMapEnabled&&a.enable(8),N.physicallyCorrectLights&&a.enable(9),N.doubleSided&&a.enable(10),N.flipSided&&a.enable(11),N.depthPacking&&a.enable(12),N.dithering&&a.enable(13),N.specularIntensityMap&&a.enable(14),N.specularColorMap&&a.enable(15),N.transmission&&a.enable(16),N.transmissionMap&&a.enable(17),N.thicknessMap&&a.enable(18),N.sheen&&a.enable(19),N.sheenColorMap&&a.enable(20),N.sheenRoughnessMap&&a.enable(21),N.decodeVideoTexture&&a.enable(22),N.transparent&&a.enable(23),C.push(a.mask)}function A(C){let N=v[C.type],R;if(N){let D=oi[N];R=T1.clone(D.uniforms)}else R=C.uniforms;return R}function E(C,N){let R;for(let D=0,V=l.length;D<V;D++){let F=l[D];if(F.cacheKey===N){R=F,++R.usedTimes;break}}return R===void 0&&(R=new SC(o,N,C,i),l.push(R)),R}function S(C){if(--C.usedTimes===0){let N=l.indexOf(C);l[N]=l[l.length-1],l.pop(),C.destroy()}}function w(C){c.remove(C)}function O(){c.dispose()}return{getParameters:_,getProgramCacheKey:T,getUniforms:A,acquireProgram:E,releaseProgram:S,releaseShaderCache:w,programs:l,dispose:O}}function NC(){let o=new WeakMap;function e(i){let s=o.get(i);return s===void 0&&(s={},o.set(i,s)),s}function t(i){o.delete(i)}function r(i,s,a){o.get(i)[s]=a}function n(){o=new WeakMap}return{get:e,remove:t,update:r,dispose:n}}function Dz(o,e){return o.groupOrder!==e.groupOrder?o.groupOrder-e.groupOrder:o.renderOrder!==e.renderOrder?o.renderOrder-e.renderOrder:o.material.id!==e.material.id?o.material.id-e.material.id:o.z!==e.z?o.z-e.z:o.id-e.id}function OC(o,e){return o.groupOrder!==e.groupOrder?o.groupOrder-e.groupOrder:o.renderOrder!==e.renderOrder?o.renderOrder-e.renderOrder:o.z!==e.z?e.z-o.z:o.id-e.id}function PC(){let o=[],e=0,t=[],r=[],n=[];function i(){e=0,t.length=0,r.length=0,n.length=0}function s(p,d,h,m,f,v){let g=o[e];return g===void 0?(g={id:p.id,object:p,geometry:d,material:h,groupOrder:m,renderOrder:p.renderOrder,z:f,group:v},o[e]=g):(g.id=p.id,g.object=p,g.geometry=d,g.material=h,g.groupOrder=m,g.renderOrder=p.renderOrder,g.z=f,g.group=v),e++,g}function a(p,d,h,m,f,v){let g=s(p,d,h,m,f,v);h.transmission>0?r.push(g):h.transparent===!0?n.push(g):t.push(g)}function c(p,d,h,m,f,v){let g=s(p,d,h,m,f,v);h.transmission>0?r.unshift(g):h.transparent===!0?n.unshift(g):t.unshift(g)}function l(p,d){t.length>1&&t.sort(p||Dz),r.length>1&&r.sort(d||OC),n.length>1&&n.sort(d||OC)}function u(){for(let p=e,d=o.length;p<d;p++){let h=o[p];if(h.id===null)break;h.id=null,h.object=null,h.geometry=null,h.material=null,h.group=null}}return{opaque:t,transmissive:r,transparent:n,init:i,push:a,unshift:c,finish:u,sort:l}}function RC(){let o=new WeakMap;function e(r,n){let i;return o.has(r)===!1?(i=new PC,o.set(r,[i])):n>=o.get(r).length?(i=new PC,o.get(r).push(i)):i=o.get(r)[n],i}function t(){o=new WeakMap}return{get:e,dispose:t}}function kz(){let o={};return{get:function(e){if(o[e.id]!==void 0)return o[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new M,color:new de};break;case"SpotLight":t={position:new M,direction:new M,color:new de,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new M,color:new de,distance:0,decay:0};break;case"HemisphereLight":t={direction:new M,skyColor:new de,groundColor:new de};break;case"RectAreaLight":t={color:new de,position:new M,halfWidth:new M,halfHeight:new M};break}return o[e.id]=t,t}}}function Bz(){let o={};return{get:function(e){if(o[e.id]!==void 0)return o[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new z};break;case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new z};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new z,shadowCameraNear:1,shadowCameraFar:1e3};break}return o[e.id]=t,t}}}var Fz=0;function Uz(o,e){return(e.castShadow?1:0)-(o.castShadow?1:0)}function IC(o,e){let t=new kz,r=Bz(),n={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]};for(let u=0;u<9;u++)n.probe.push(new M);let i=new M,s=new Ue,a=new Ue;function c(u,p){let d=0,h=0,m=0;for(let w=0;w<9;w++)n.probe[w].set(0,0,0);let f=0,v=0,g=0,_=0,T=0,b=0,x=0,A=0;u.sort(Uz);let E=p!==!0?Math.PI:1;for(let w=0,O=u.length;w<O;w++){let C=u[w],N=C.color,R=C.intensity,D=C.distance,V=C.shadow&&C.shadow.map?C.shadow.map.texture:null;if(C.isAmbientLight)d+=N.r*R*E,h+=N.g*R*E,m+=N.b*R*E;else if(C.isLightProbe)for(let F=0;F<9;F++)n.probe[F].addScaledVector(C.sh.coefficients[F],R);else if(C.isDirectionalLight){let F=t.get(C);if(F.color.copy(C.color).multiplyScalar(C.intensity*E),C.castShadow){let j=C.shadow,$=r.get(C);$.shadowBias=j.bias,$.shadowNormalBias=j.normalBias,$.shadowRadius=j.radius,$.shadowMapSize=j.mapSize,n.directionalShadow[f]=$,n.directionalShadowMap[f]=V,n.directionalShadowMatrix[f]=C.shadow.matrix,b++}n.directional[f]=F,f++}else if(C.isSpotLight){let F=t.get(C);if(F.position.setFromMatrixPosition(C.matrixWorld),F.color.copy(N).multiplyScalar(R*E),F.distance=D,F.coneCos=Math.cos(C.angle),F.penumbraCos=Math.cos(C.angle*(1-C.penumbra)),F.decay=C.decay,C.castShadow){let j=C.shadow,$=r.get(C);$.shadowBias=j.bias,$.shadowNormalBias=j.normalBias,$.shadowRadius=j.radius,$.shadowMapSize=j.mapSize,n.spotShadow[g]=$,n.spotShadowMap[g]=V,n.spotShadowMatrix[g]=C.shadow.matrix,A++}n.spot[g]=F,g++}else if(C.isRectAreaLight){let F=t.get(C);F.color.copy(N).multiplyScalar(R),F.halfWidth.set(C.width*.5,0,0),F.halfHeight.set(0,C.height*.5,0),n.rectArea[_]=F,_++}else if(C.isPointLight){let F=t.get(C);if(F.color.copy(C.color).multiplyScalar(C.intensity*E),F.distance=C.distance,F.decay=C.decay,C.castShadow){let j=C.shadow,$=r.get(C);$.shadowBias=j.bias,$.shadowNormalBias=j.normalBias,$.shadowRadius=j.radius,$.shadowMapSize=j.mapSize,$.shadowCameraNear=j.camera.near,$.shadowCameraFar=j.camera.far,n.pointShadow[v]=$,n.pointShadowMap[v]=V,n.pointShadowMatrix[v]=C.shadow.matrix,x++}n.point[v]=F,v++}else if(C.isHemisphereLight){let F=t.get(C);F.skyColor.copy(C.color).multiplyScalar(R*E),F.groundColor.copy(C.groundColor).multiplyScalar(R*E),n.hemi[T]=F,T++}}_>0&&(e.isWebGL2?(n.rectAreaLTC1=Te.LTC_FLOAT_1,n.rectAreaLTC2=Te.LTC_FLOAT_2):o.has("OES_texture_float_linear")===!0?(n.rectAreaLTC1=Te.LTC_FLOAT_1,n.rectAreaLTC2=Te.LTC_FLOAT_2):o.has("OES_texture_half_float_linear")===!0?(n.rectAreaLTC1=Te.LTC_HALF_1,n.rectAreaLTC2=Te.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),n.ambient[0]=d,n.ambient[1]=h,n.ambient[2]=m;let S=n.hash;(S.directionalLength!==f||S.pointLength!==v||S.spotLength!==g||S.rectAreaLength!==_||S.hemiLength!==T||S.numDirectionalShadows!==b||S.numPointShadows!==x||S.numSpotShadows!==A)&&(n.directional.length=f,n.spot.length=g,n.rectArea.length=_,n.point.length=v,n.hemi.length=T,n.directionalShadow.length=b,n.directionalShadowMap.length=b,n.pointShadow.length=x,n.pointShadowMap.length=x,n.spotShadow.length=A,n.spotShadowMap.length=A,n.directionalShadowMatrix.length=b,n.pointShadowMatrix.length=x,n.spotShadowMatrix.length=A,S.directionalLength=f,S.pointLength=v,S.spotLength=g,S.rectAreaLength=_,S.hemiLength=T,S.numDirectionalShadows=b,S.numPointShadows=x,S.numSpotShadows=A,n.version=Fz++)}function l(u,p){let d=0,h=0,m=0,f=0,v=0,g=p.matrixWorldInverse;for(let _=0,T=u.length;_<T;_++){let b=u[_];if(b.isDirectionalLight){let x=n.directional[d];x.direction.setFromMatrixPosition(b.matrixWorld),i.setFromMatrixPosition(b.target.matrixWorld),x.direction.sub(i),x.direction.transformDirection(g),d++}else if(b.isSpotLight){let x=n.spot[m];x.position.setFromMatrixPosition(b.matrixWorld),x.position.applyMatrix4(g),x.direction.setFromMatrixPosition(b.matrixWorld),i.setFromMatrixPosition(b.target.matrixWorld),x.direction.sub(i),x.direction.transformDirection(g),m++}else if(b.isRectAreaLight){let x=n.rectArea[f];x.position.setFromMatrixPosition(b.matrixWorld),x.position.applyMatrix4(g),a.identity(),s.copy(b.matrixWorld),s.premultiply(g),a.extractRotation(s),x.halfWidth.set(b.width*.5,0,0),x.halfHeight.set(0,b.height*.5,0),x.halfWidth.applyMatrix4(a),x.halfHeight.applyMatrix4(a),f++}else if(b.isPointLight){let x=n.point[h];x.position.setFromMatrixPosition(b.matrixWorld),x.position.applyMatrix4(g),h++}else if(b.isHemisphereLight){let x=n.hemi[v];x.direction.setFromMatrixPosition(b.matrixWorld),x.direction.transformDirection(g),x.direction.normalize(),v++}}}return{setup:c,setupView:l,state:n}}function LC(o,e){let t=new IC(o,e),r=[],n=[];function i(){r.length=0,n.length=0}function s(p){r.push(p)}function a(p){n.push(p)}function c(p){t.setup(r,p)}function l(p){t.setupView(r,p)}return{init:i,state:{lightsArray:r,shadowsArray:n,lights:t},setupLights:c,setupLightsView:l,pushLight:s,pushShadow:a}}function DC(o,e){let t=new WeakMap;function r(i,s=0){let a;return t.has(i)===!1?(a=new LC(o,e),t.set(i,[a])):s>=t.get(i).length?(a=new LC(o,e),t.get(i).push(a)):a=t.get(i)[s],a}function n(){t=new WeakMap}return{get:r,dispose:n}}var Eu=class extends Ut{constructor(e){super();this.type="MeshDepthMaterial",this.depthPacking=h1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}};Eu.prototype.isMeshDepthMaterial=!0;var Su=class extends Ut{constructor(e){super();this.type="MeshDistanceMaterial",this.referencePosition=new M,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(e)}copy(e){return super.copy(e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}};Su.prototype.isMeshDistanceMaterial=!0;var kC=`
void main() {

	gl_Position = vec4( position, 1.0 );

}
`,BC=`
uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;

#include <packing>

void main() {

	const float samples = float( VSM_SAMPLES );

	float mean = 0.0;
	float squared_mean = 0.0;

	// This seems totally useless but it's a crazy work around for a Adreno compiler bug
	// float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy ) / resolution ) );

	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {

		float uvOffset = uvStart + i * uvStride;

		#ifdef HORIZONTAL_PASS

			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;

		#else

			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;

		#endif

	}

	mean = mean / samples;
	squared_mean = squared_mean / samples;

	float std_dev = sqrt( squared_mean - mean * mean );

	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );

}
`;function FC(o,e,t){let r=new xc,n=new z,i=new z,s=new De,a=new Eu({depthPacking:f1}),c=new Su,l={},u=t.maxTextureSize,p={0:Mt,1:gr,2:Wr},d=new Sr({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new z},radius:{value:4}},vertexShader:kC,fragmentShader:BC}),h=d.clone();h.defines.HORIZONTAL_PASS=1;let m=new Re;m.setAttribute("position",new Tt(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));let f=new ct(m,d),v=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=au,this.render=function(b,x,A){if(v.enabled===!1||v.autoUpdate===!1&&v.needsUpdate===!1||b.length===0)return;let E=o.getRenderTarget(),S=o.getActiveCubeFace(),w=o.getActiveMipmapLevel(),O=o.state;O.setBlending(un),O.buffers.color.setClear(1,1,1,1),O.buffers.depth.setTest(!0),O.setScissorTest(!1);for(let C=0,N=b.length;C<N;C++){let R=b[C],D=R.shadow;if(D===void 0){console.warn("THREE.WebGLShadowMap:",R,"has no shadow.");continue}if(D.autoUpdate===!1&&D.needsUpdate===!1)continue;n.copy(D.mapSize);let V=D.getFrameExtents();if(n.multiply(V),i.copy(D.mapSize),(n.x>u||n.y>u)&&(n.x>u&&(i.x=Math.floor(u/V.x),n.x=i.x*V.x,D.mapSize.x=i.x),n.y>u&&(i.y=Math.floor(u/V.y),n.y=i.y*V.y,D.mapSize.y=i.y)),D.map===null&&!D.isPointLightShadow&&this.type===o0){let j={minFilter:lt,magFilter:lt,format:at};D.map=new yr(n.x,n.y,j),D.map.texture.name=R.name+".shadowMap",D.mapPass=new yr(n.x,n.y,j),D.camera.updateProjectionMatrix()}if(D.map===null){let j={minFilter:it,magFilter:it,format:at};D.map=new yr(n.x,n.y,j),D.map.texture.name=R.name+".shadowMap",D.camera.updateProjectionMatrix()}o.setRenderTarget(D.map),o.clear();let F=D.getViewportCount();for(let j=0;j<F;j++){let $=D.getViewport(j);s.set(i.x*$.x,i.y*$.y,i.x*$.z,i.y*$.w),O.viewport(s),D.updateMatrices(R,j),r=D.getFrustum(),T(x,A,D.camera,R,this.type)}!D.isPointLightShadow&&this.type===o0&&g(D,A),D.needsUpdate=!1}v.needsUpdate=!1,o.setRenderTarget(E,S,w)};function g(b,x){let A=e.update(f);d.defines.VSM_SAMPLES!==b.blurSamples&&(d.defines.VSM_SAMPLES=b.blurSamples,h.defines.VSM_SAMPLES=b.blurSamples,d.needsUpdate=!0,h.needsUpdate=!0),d.uniforms.shadow_pass.value=b.map.texture,d.uniforms.resolution.value=b.mapSize,d.uniforms.radius.value=b.radius,o.setRenderTarget(b.mapPass),o.clear(),o.renderBufferDirect(x,null,A,d,f,null),h.uniforms.shadow_pass.value=b.mapPass.texture,h.uniforms.resolution.value=b.mapSize,h.uniforms.radius.value=b.radius,o.setRenderTarget(b.map),o.clear(),o.renderBufferDirect(x,null,A,h,f,null)}function _(b,x,A,E,S,w,O){let C=null,N=E.isPointLight===!0?b.customDistanceMaterial:b.customDepthMaterial;if(N!==void 0?C=N:C=E.isPointLight===!0?c:a,o.localClippingEnabled&&A.clipShadows===!0&&A.clippingPlanes.length!==0||A.displacementMap&&A.displacementScale!==0||A.alphaMap&&A.alphaTest>0){let R=C.uuid,D=A.uuid,V=l[R];V===void 0&&(V={},l[R]=V);let F=V[D];F===void 0&&(F=C.clone(),V[D]=F),C=F}return C.visible=A.visible,C.wireframe=A.wireframe,O===o0?C.side=A.shadowSide!==null?A.shadowSide:A.side:C.side=A.shadowSide!==null?A.shadowSide:p[A.side],C.alphaMap=A.alphaMap,C.alphaTest=A.alphaTest,C.clipShadows=A.clipShadows,C.clippingPlanes=A.clippingPlanes,C.clipIntersection=A.clipIntersection,C.displacementMap=A.displacementMap,C.displacementScale=A.displacementScale,C.displacementBias=A.displacementBias,C.wireframeLinewidth=A.wireframeLinewidth,C.linewidth=A.linewidth,E.isPointLight===!0&&C.isMeshDistanceMaterial===!0&&(C.referencePosition.setFromMatrixPosition(E.matrixWorld),C.nearDistance=S,C.farDistance=w),C}function T(b,x,A,E,S){if(b.visible===!1)return;if(b.layers.test(x.layers)&&(b.isMesh||b.isLine||b.isPoints)&&(b.castShadow||b.receiveShadow&&S===o0)&&(!b.frustumCulled||r.intersectsObject(b))){b.modelViewMatrix.multiplyMatrices(A.matrixWorldInverse,b.matrixWorld);let C=e.update(b),N=b.material;if(Array.isArray(N)){let R=C.groups;for(let D=0,V=R.length;D<V;D++){let F=R[D],j=N[F.materialIndex];if(j&&j.visible){let $=_(b,C,j,E,A.near,A.far,S);o.renderBufferDirect(A,null,C,$,b,F)}}}else if(N.visible){let R=_(b,C,N,E,A.near,A.far,S);o.renderBufferDirect(A,null,C,R,b,null)}}let O=b.children;for(let C=0,N=O.length;C<N;C++)T(O[C],x,A,E,S)}}function UC(o,e,t){let r=t.isWebGL2;function n(){let q=!1,Le=new De,Me=null,Ze=new De(0,0,0,0);return{setMask:function(_e){Me!==_e&&!q&&(o.colorMask(_e,_e,_e,_e),Me=_e)},setLocked:function(_e){q=_e},setClear:function(_e,He,tt,nr,Oo){Oo===!0&&(_e*=nr,He*=nr,tt*=nr),Le.set(_e,He,tt,nr),Ze.equals(Le)===!1&&(o.clearColor(_e,He,tt,nr),Ze.copy(Le))},reset:function(){q=!1,Me=null,Ze.set(-1,0,0,0)}}}function i(){let q=!1,Le=null,Me=null,Ze=null;return{setTest:function(_e){_e?L(o.DEPTH_TEST):Ne(o.DEPTH_TEST)},setMask:function(_e){Le!==_e&&!q&&(o.depthMask(_e),Le=_e)},setFunc:function(_e){if(Me!==_e){if(_e)switch(_e){case Gx:o.depthFunc(o.NEVER);break;case zx:o.depthFunc(o.ALWAYS);break;case Hx:o.depthFunc(o.LESS);break;case C3:o.depthFunc(o.LEQUAL);break;case jx:o.depthFunc(o.EQUAL);break;case Wx:o.depthFunc(o.GEQUAL);break;case qx:o.depthFunc(o.GREATER);break;case Xx:o.depthFunc(o.NOTEQUAL);break;default:o.depthFunc(o.LEQUAL)}else o.depthFunc(o.LEQUAL);Me=_e}},setLocked:function(_e){q=_e},setClear:function(_e){Ze!==_e&&(o.clearDepth(_e),Ze=_e)},reset:function(){q=!1,Le=null,Me=null,Ze=null}}}function s(){let q=!1,Le=null,Me=null,Ze=null,_e=null,He=null,tt=null,nr=null,Oo=null;return{setTest:function(Cr){q||(Cr?L(o.STENCIL_TEST):Ne(o.STENCIL_TEST))},setMask:function(Cr){Le!==Cr&&!q&&(o.stencilMask(Cr),Le=Cr)},setFunc:function(Cr,gs,t0){(Me!==Cr||Ze!==gs||_e!==t0)&&(o.stencilFunc(Cr,gs,t0),Me=Cr,Ze=gs,_e=t0)},setOp:function(Cr,gs,t0){(He!==Cr||tt!==gs||nr!==t0)&&(o.stencilOp(Cr,gs,t0),He=Cr,tt=gs,nr=t0)},setLocked:function(Cr){q=Cr},setClear:function(Cr){Oo!==Cr&&(o.clearStencil(Cr),Oo=Cr)},reset:function(){q=!1,Le=null,Me=null,Ze=null,_e=null,He=null,tt=null,nr=null,Oo=null}}}let a=new n,c=new i,l=new s,u={},p={},d=new WeakMap,h=[],m=null,f=!1,v=null,g=null,_=null,T=null,b=null,x=null,A=null,E=!1,S=null,w=null,O=null,C=null,N=null,R=o.getParameter(o.MAX_COMBINED_TEXTURE_IMAGE_UNITS),D=!1,V=0,F=o.getParameter(o.VERSION);F.indexOf("WebGL")!==-1?(V=parseFloat(/^WebGL (\d)/.exec(F)[1]),D=V>=1):F.indexOf("OpenGL ES")!==-1&&(V=parseFloat(/^OpenGL ES (\d)/.exec(F)[1]),D=V>=2);let j=null,$={},Y=o.getParameter(o.SCISSOR_BOX),H=o.getParameter(o.VIEWPORT),B=new De().fromArray(Y),te=new De().fromArray(H);function X(q,Le,Me){let Ze=new Uint8Array(4),_e=o.createTexture();o.bindTexture(q,_e),o.texParameteri(q,o.TEXTURE_MIN_FILTER,o.NEAREST),o.texParameteri(q,o.TEXTURE_MAG_FILTER,o.NEAREST);for(let He=0;He<Me;He++)o.texImage2D(Le+He,0,o.RGBA,1,1,0,o.RGBA,o.UNSIGNED_BYTE,Ze);return _e}let W={};W[o.TEXTURE_2D]=X(o.TEXTURE_2D,o.TEXTURE_2D,1),W[o.TEXTURE_CUBE_MAP]=X(o.TEXTURE_CUBE_MAP,o.TEXTURE_CUBE_MAP_POSITIVE_X,6),a.setClear(0,0,0,1),c.setClear(1),l.setClear(0),L(o.DEPTH_TEST),c.setFunc(C3),be(!1),ne(b3),L(o.CULL_FACE),le(un);function L(q){u[q]!==!0&&(o.enable(q),u[q]=!0)}function Ne(q){u[q]!==!1&&(o.disable(q),u[q]=!1)}function ye(q,Le){return p[q]!==Le?(o.bindFramebuffer(q,Le),p[q]=Le,r&&(q===o.DRAW_FRAMEBUFFER&&(p[o.FRAMEBUFFER]=Le),q===o.FRAMEBUFFER&&(p[o.DRAW_FRAMEBUFFER]=Le)),!0):!1}function ae(q,Le){let Me=h,Ze=!1;if(q)if(Me=d.get(Le),Me===void 0&&(Me=[],d.set(Le,Me)),q.isWebGLMultipleRenderTargets){let _e=q.texture;if(Me.length!==_e.length||Me[0]!==o.COLOR_ATTACHMENT0){for(let He=0,tt=_e.length;He<tt;He++)Me[He]=o.COLOR_ATTACHMENT0+He;Me.length=_e.length,Ze=!0}}else Me[0]!==o.COLOR_ATTACHMENT0&&(Me[0]=o.COLOR_ATTACHMENT0,Ze=!0);else Me[0]!==o.BACK&&(Me[0]=o.BACK,Ze=!0);Ze&&(t.isWebGL2?o.drawBuffers(Me):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(Me))}function Ae(q){return m!==q?(o.useProgram(q),m=q,!0):!1}let Ie={[cu]:o.FUNC_ADD,[Mx]:o.FUNC_SUBTRACT,[Nx]:o.FUNC_REVERSE_SUBTRACT};if(r)Ie[T3]=o.MIN,Ie[A3]=o.MAX;else{let q=e.get("EXT_blend_minmax");q!==null&&(Ie[T3]=q.MIN_EXT,Ie[A3]=q.MAX_EXT)}let Oe={[Ox]:o.ZERO,[Px]:o.ONE,[Rx]:o.SRC_COLOR,[Lx]:o.SRC_ALPHA,[Vx]:o.SRC_ALPHA_SATURATE,[Fx]:o.DST_COLOR,[kx]:o.DST_ALPHA,[Ix]:o.ONE_MINUS_SRC_COLOR,[Dx]:o.ONE_MINUS_SRC_ALPHA,[Ux]:o.ONE_MINUS_DST_COLOR,[Bx]:o.ONE_MINUS_DST_ALPHA};function le(q,Le,Me,Ze,_e,He,tt,nr){if(q===un){f===!0&&(Ne(o.BLEND),f=!1);return}if(f===!1&&(L(o.BLEND),f=!0),q!==wx){if(q!==v||nr!==E){if((g!==cu||b!==cu)&&(o.blendEquation(o.FUNC_ADD),g=cu,b=cu),nr)switch(q){case gc:o.blendFuncSeparate(o.ONE,o.ONE_MINUS_SRC_ALPHA,o.ONE,o.ONE_MINUS_SRC_ALPHA);break;case Vd:o.blendFunc(o.ONE,o.ONE);break;case Gd:o.blendFuncSeparate(o.ZERO,o.ONE_MINUS_SRC_COLOR,o.ZERO,o.ONE);break;case zd:o.blendFuncSeparate(o.ZERO,o.SRC_COLOR,o.ZERO,o.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",q);break}else switch(q){case gc:o.blendFuncSeparate(o.SRC_ALPHA,o.ONE_MINUS_SRC_ALPHA,o.ONE,o.ONE_MINUS_SRC_ALPHA);break;case Vd:o.blendFunc(o.SRC_ALPHA,o.ONE);break;case Gd:o.blendFuncSeparate(o.ZERO,o.ONE_MINUS_SRC_COLOR,o.ZERO,o.ONE);break;case zd:o.blendFunc(o.ZERO,o.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",q);break}_=null,T=null,x=null,A=null,v=q,E=nr}return}_e=_e||Le,He=He||Me,tt=tt||Ze,(Le!==g||_e!==b)&&(o.blendEquationSeparate(Ie[Le],Ie[_e]),g=Le,b=_e),(Me!==_||Ze!==T||He!==x||tt!==A)&&(o.blendFuncSeparate(Oe[Me],Oe[Ze],Oe[He],Oe[tt]),_=Me,T=Ze,x=He,A=tt),v=q,E=null}function xe(q,Le){q.side===Wr?Ne(o.CULL_FACE):L(o.CULL_FACE);let Me=q.side===Mt;Le&&(Me=!Me),be(Me),q.blending===gc&&q.transparent===!1?le(un):le(q.blending,q.blendEquation,q.blendSrc,q.blendDst,q.blendEquationAlpha,q.blendSrcAlpha,q.blendDstAlpha,q.premultipliedAlpha),c.setFunc(q.depthFunc),c.setTest(q.depthTest),c.setMask(q.depthWrite),a.setMask(q.colorWrite);let Ze=q.stencilWrite;l.setTest(Ze),Ze&&(l.setMask(q.stencilWriteMask),l.setFunc(q.stencilFunc,q.stencilRef,q.stencilFuncMask),l.setOp(q.stencilFail,q.stencilZFail,q.stencilZPass)),we(q.polygonOffset,q.polygonOffsetFactor,q.polygonOffsetUnits),q.alphaToCoverage===!0?L(o.SAMPLE_ALPHA_TO_COVERAGE):Ne(o.SAMPLE_ALPHA_TO_COVERAGE)}function be(q){S!==q&&(q?o.frontFace(o.CW):o.frontFace(o.CCW),S=q)}function ne(q){q!==Cx?(L(o.CULL_FACE),q!==w&&(q===b3?o.cullFace(o.BACK):q===Ex?o.cullFace(o.FRONT):o.cullFace(o.FRONT_AND_BACK))):Ne(o.CULL_FACE),w=q}function he(q){q!==O&&(D&&o.lineWidth(q),O=q)}function we(q,Le,Me){q?(L(o.POLYGON_OFFSET_FILL),(C!==Le||N!==Me)&&(o.polygonOffset(Le,Me),C=Le,N=Me)):Ne(o.POLYGON_OFFSET_FILL)}function Ee(q){q?L(o.SCISSOR_TEST):Ne(o.SCISSOR_TEST)}function Pe(q){q===void 0&&(q=o.TEXTURE0+R-1),j!==q&&(o.activeTexture(q),j=q)}function Xe(q,Le){j===null&&Pe();let Me=$[j];Me===void 0&&(Me={type:void 0,texture:void 0},$[j]=Me),(Me.type!==q||Me.texture!==Le)&&(o.bindTexture(q,Le||W[q]),Me.type=q,Me.texture=Le)}function et(){let q=$[j];q!==void 0&&q.type!==void 0&&(o.bindTexture(q.type,null),q.type=void 0,q.texture=void 0)}function k(){try{o.compressedTexImage2D.apply(o,arguments)}catch(q){console.error("THREE.WebGLState:",q)}}function P(){try{o.texSubImage2D.apply(o,arguments)}catch(q){console.error("THREE.WebGLState:",q)}}function fe(){try{o.texSubImage3D.apply(o,arguments)}catch(q){console.error("THREE.WebGLState:",q)}}function ee(){try{o.compressedTexSubImage2D.apply(o,arguments)}catch(q){console.error("THREE.WebGLState:",q)}}function me(){try{o.texStorage2D.apply(o,arguments)}catch(q){console.error("THREE.WebGLState:",q)}}function Z(){try{o.texStorage3D.apply(o,arguments)}catch(q){console.error("THREE.WebGLState:",q)}}function Se(){try{o.texImage2D.apply(o,arguments)}catch(q){console.error("THREE.WebGLState:",q)}}function G(){try{o.texImage3D.apply(o,arguments)}catch(q){console.error("THREE.WebGLState:",q)}}function se(q){B.equals(q)===!1&&(o.scissor(q.x,q.y,q.z,q.w),B.copy(q))}function ve(q){te.equals(q)===!1&&(o.viewport(q.x,q.y,q.z,q.w),te.copy(q))}function Fe(){o.disable(o.BLEND),o.disable(o.CULL_FACE),o.disable(o.DEPTH_TEST),o.disable(o.POLYGON_OFFSET_FILL),o.disable(o.SCISSOR_TEST),o.disable(o.STENCIL_TEST),o.disable(o.SAMPLE_ALPHA_TO_COVERAGE),o.blendEquation(o.FUNC_ADD),o.blendFunc(o.ONE,o.ZERO),o.blendFuncSeparate(o.ONE,o.ZERO,o.ONE,o.ZERO),o.colorMask(!0,!0,!0,!0),o.clearColor(0,0,0,0),o.depthMask(!0),o.depthFunc(o.LESS),o.clearDepth(1),o.stencilMask(4294967295),o.stencilFunc(o.ALWAYS,0,4294967295),o.stencilOp(o.KEEP,o.KEEP,o.KEEP),o.clearStencil(0),o.cullFace(o.BACK),o.frontFace(o.CCW),o.polygonOffset(0,0),o.activeTexture(o.TEXTURE0),o.bindFramebuffer(o.FRAMEBUFFER,null),r===!0&&(o.bindFramebuffer(o.DRAW_FRAMEBUFFER,null),o.bindFramebuffer(o.READ_FRAMEBUFFER,null)),o.useProgram(null),o.lineWidth(1),o.scissor(0,0,o.canvas.width,o.canvas.height),o.viewport(0,0,o.canvas.width,o.canvas.height),u={},j=null,$={},p={},d=new WeakMap,h=[],m=null,f=!1,v=null,g=null,_=null,T=null,b=null,x=null,A=null,E=!1,S=null,w=null,O=null,C=null,N=null,B.set(0,0,o.canvas.width,o.canvas.height),te.set(0,0,o.canvas.width,o.canvas.height),a.reset(),c.reset(),l.reset()}return{buffers:{color:a,depth:c,stencil:l},enable:L,disable:Ne,bindFramebuffer:ye,drawBuffers:ae,useProgram:Ae,setBlending:le,setMaterial:xe,setFlipSided:be,setCullFace:ne,setLineWidth:he,setPolygonOffset:we,setScissorTest:Ee,activeTexture:Pe,bindTexture:Xe,unbindTexture:et,compressedTexImage2D:k,texImage2D:Se,texImage3D:G,texStorage2D:me,texStorage3D:Z,texSubImage2D:P,texSubImage3D:fe,compressedTexSubImage2D:ee,scissor:se,viewport:ve,reset:Fe}}function VC(o,e,t,r,n,i,s){let a=n.isWebGL2,c=n.maxTextures,l=n.maxCubemapSize,u=n.maxTextureSize,p=n.maxSamples,h=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):void 0,m=new WeakMap,f,v=!1;try{v=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function g(k,P){return v?new OffscreenCanvas(k,P):fu("canvas")}function _(k,P,fe,ee){let me=1;if((k.width>ee||k.height>ee)&&(me=ee/Math.max(k.width,k.height)),me<1||P===!0)if(typeof HTMLImageElement<"u"&&k instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&k instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&k instanceof ImageBitmap){let Z=P?sb:Math.floor,Se=Z(me*k.width),G=Z(me*k.height);f===void 0&&(f=g(Se,G));let se=fe?g(Se,G):f;return se.width=Se,se.height=G,se.getContext("2d").drawImage(k,0,0,Se,G),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+k.width+"x"+k.height+") to ("+Se+"x"+G+")."),se}else return"data"in k&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+k.width+"x"+k.height+")."),k;return k}function T(k){return du(k.width)&&du(k.height)}function b(k){return a?!1:k.wrapS!==Ft||k.wrapT!==Ft||k.minFilter!==it&&k.minFilter!==lt}function x(k,P){return k.generateMipmaps&&P&&k.minFilter!==it&&k.minFilter!==lt}function A(k){o.generateMipmap(k)}function E(k,P,fe,ee,me=!1){if(a===!1)return P;if(k!==null){if(o[k]!==void 0)return o[k];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+k+"'")}let Z=P;return P===o.RED&&(fe===o.FLOAT&&(Z=o.R32F),fe===o.HALF_FLOAT&&(Z=o.R16F),fe===o.UNSIGNED_BYTE&&(Z=o.R8)),P===o.RG&&(fe===o.FLOAT&&(Z=o.RG32F),fe===o.HALF_FLOAT&&(Z=o.RG16F),fe===o.UNSIGNED_BYTE&&(Z=o.RG8)),P===o.RGBA&&(fe===o.FLOAT&&(Z=o.RGBA32F),fe===o.HALF_FLOAT&&(Z=o.RGBA16F),fe===o.UNSIGNED_BYTE&&(Z=ee===bt&&me===!1?o.SRGB8_ALPHA8:o.RGBA8),fe===o.UNSIGNED_SHORT_4_4_4_4&&(Z=o.RGBA4),fe===o.UNSIGNED_SHORT_5_5_5_1&&(Z=o.RGB5_A1)),(Z===o.R16F||Z===o.R32F||Z===o.RG16F||Z===o.RG32F||Z===o.RGBA16F||Z===o.RGBA32F)&&e.get("EXT_color_buffer_float"),Z}function S(k,P,fe){return x(k,fe)===!0||k.isFramebufferTexture&&k.minFilter!==it&&k.minFilter!==lt?Math.log2(Math.max(P.width,P.height))+1:k.mipmaps!==void 0&&k.mipmaps.length>0?k.mipmaps.length:k.isCompressedTexture&&Array.isArray(k.image)?P.mipmaps.length:1}function w(k){return k===it||k===vc||k===yc?o.NEAREST:o.LINEAR}function O(k){let P=k.target;P.removeEventListener("dispose",O),N(P),P.isVideoTexture&&m.delete(P),s.memory.textures--}function C(k){let P=k.target;P.removeEventListener("dispose",C),R(P)}function N(k){let P=r.get(k);P.__webglInit!==void 0&&(o.deleteTexture(P.__webglTexture),r.remove(k))}function R(k){let P=k.texture,fe=r.get(k),ee=r.get(P);if(!!k){if(ee.__webglTexture!==void 0&&(o.deleteTexture(ee.__webglTexture),s.memory.textures--),k.depthTexture&&k.depthTexture.dispose(),k.isWebGLCubeRenderTarget)for(let me=0;me<6;me++)o.deleteFramebuffer(fe.__webglFramebuffer[me]),fe.__webglDepthbuffer&&o.deleteRenderbuffer(fe.__webglDepthbuffer[me]);else o.deleteFramebuffer(fe.__webglFramebuffer),fe.__webglDepthbuffer&&o.deleteRenderbuffer(fe.__webglDepthbuffer),fe.__webglMultisampledFramebuffer&&o.deleteFramebuffer(fe.__webglMultisampledFramebuffer),fe.__webglColorRenderbuffer&&o.deleteRenderbuffer(fe.__webglColorRenderbuffer),fe.__webglDepthRenderbuffer&&o.deleteRenderbuffer(fe.__webglDepthRenderbuffer);if(k.isWebGLMultipleRenderTargets)for(let me=0,Z=P.length;me<Z;me++){let Se=r.get(P[me]);Se.__webglTexture&&(o.deleteTexture(Se.__webglTexture),s.memory.textures--),r.remove(P[me])}r.remove(P),r.remove(k)}}let D=0;function V(){D=0}function F(){let k=D;return k>=c&&console.warn("THREE.WebGLTextures: Trying to use "+k+" texture units while this GPU supports only "+c),D+=1,k}function j(k,P){let fe=r.get(k);if(k.isVideoTexture&&he(k),k.version>0&&fe.__version!==k.version){let ee=k.image;if(ee===void 0)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else if(ee.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{L(fe,k,P);return}}t.activeTexture(o.TEXTURE0+P),t.bindTexture(o.TEXTURE_2D,fe.__webglTexture)}function $(k,P){let fe=r.get(k);if(k.version>0&&fe.__version!==k.version){L(fe,k,P);return}t.activeTexture(o.TEXTURE0+P),t.bindTexture(o.TEXTURE_2D_ARRAY,fe.__webglTexture)}function Y(k,P){let fe=r.get(k);if(k.version>0&&fe.__version!==k.version){L(fe,k,P);return}t.activeTexture(o.TEXTURE0+P),t.bindTexture(o.TEXTURE_3D,fe.__webglTexture)}function H(k,P){let fe=r.get(k);if(k.version>0&&fe.__version!==k.version){Ne(fe,k,P);return}t.activeTexture(o.TEXTURE0+P),t.bindTexture(o.TEXTURE_CUBE_MAP,fe.__webglTexture)}let B={[Zn]:o.REPEAT,[Ft]:o.CLAMP_TO_EDGE,[j0]:o.MIRRORED_REPEAT},te={[it]:o.NEAREST,[vc]:o.NEAREST_MIPMAP_NEAREST,[yc]:o.NEAREST_MIPMAP_LINEAR,[lt]:o.LINEAR,[uu]:o.LINEAR_MIPMAP_NEAREST,[Ri]:o.LINEAR_MIPMAP_LINEAR};function X(k,P,fe){if(fe?(o.texParameteri(k,o.TEXTURE_WRAP_S,B[P.wrapS]),o.texParameteri(k,o.TEXTURE_WRAP_T,B[P.wrapT]),(k===o.TEXTURE_3D||k===o.TEXTURE_2D_ARRAY)&&o.texParameteri(k,o.TEXTURE_WRAP_R,B[P.wrapR]),o.texParameteri(k,o.TEXTURE_MAG_FILTER,te[P.magFilter]),o.texParameteri(k,o.TEXTURE_MIN_FILTER,te[P.minFilter])):(o.texParameteri(k,o.TEXTURE_WRAP_S,o.CLAMP_TO_EDGE),o.texParameteri(k,o.TEXTURE_WRAP_T,o.CLAMP_TO_EDGE),(k===o.TEXTURE_3D||k===o.TEXTURE_2D_ARRAY)&&o.texParameteri(k,o.TEXTURE_WRAP_R,o.CLAMP_TO_EDGE),(P.wrapS!==Ft||P.wrapT!==Ft)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),o.texParameteri(k,o.TEXTURE_MAG_FILTER,w(P.magFilter)),o.texParameteri(k,o.TEXTURE_MIN_FILTER,w(P.minFilter)),P.minFilter!==it&&P.minFilter!==lt&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),e.has("EXT_texture_filter_anisotropic")===!0){let ee=e.get("EXT_texture_filter_anisotropic");if(P.type===qt&&e.has("OES_texture_float_linear")===!1||a===!1&&P.type===qr&&e.has("OES_texture_half_float_linear")===!1)return;(P.anisotropy>1||r.get(P).__currentAnisotropy)&&(o.texParameterf(k,ee.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(P.anisotropy,n.getMaxAnisotropy())),r.get(P).__currentAnisotropy=P.anisotropy)}}function W(k,P){k.__webglInit===void 0&&(k.__webglInit=!0,P.addEventListener("dispose",O),k.__webglTexture=o.createTexture(),s.memory.textures++)}function L(k,P,fe){let ee=o.TEXTURE_2D;P.isDataTexture2DArray&&(ee=o.TEXTURE_2D_ARRAY),P.isDataTexture3D&&(ee=o.TEXTURE_3D),W(k,P),t.activeTexture(o.TEXTURE0+fe),t.bindTexture(ee,k.__webglTexture),o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,P.flipY),o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,P.premultiplyAlpha),o.pixelStorei(o.UNPACK_ALIGNMENT,P.unpackAlignment),o.pixelStorei(o.UNPACK_COLORSPACE_CONVERSION_WEBGL,o.NONE);let me=b(P)&&T(P.image)===!1,Z=_(P.image,me,!1,u);Z=we(P,Z);let Se=T(Z)||a,G=i.convert(P.format,P.encoding),se=i.convert(P.type),ve=E(P.internalFormat,G,se,P.encoding,P.isVideoTexture);X(ee,P,Se);let Fe,q=P.mipmaps,Le=a&&P.isVideoTexture!==!0,Me=k.__version===void 0,Ze=S(P,Z,Se);if(P.isDepthTexture)ve=o.DEPTH_COMPONENT,a?P.type===qt?ve=o.DEPTH_COMPONENT32F:P.type===W0?ve=o.DEPTH_COMPONENT24:P.type===Qn?ve=o.DEPTH24_STENCIL8:ve=o.DEPTH_COMPONENT16:P.type===qt&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),P.format===wn&&ve===o.DEPTH_COMPONENT&&P.type!==Ii&&P.type!==W0&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),P.type=Ii,se=i.convert(P.type)),P.format===ei&&ve===o.DEPTH_COMPONENT&&(ve=o.DEPTH_STENCIL,P.type!==Qn&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),P.type=Qn,se=i.convert(P.type))),Le&&Me?t.texStorage2D(o.TEXTURE_2D,1,ve,Z.width,Z.height):t.texImage2D(o.TEXTURE_2D,0,ve,Z.width,Z.height,0,G,se,null);else if(P.isDataTexture)if(q.length>0&&Se){Le&&Me&&t.texStorage2D(o.TEXTURE_2D,Ze,ve,q[0].width,q[0].height);for(let _e=0,He=q.length;_e<He;_e++)Fe=q[_e],Le?t.texSubImage2D(o.TEXTURE_2D,0,0,0,Fe.width,Fe.height,G,se,Fe.data):t.texImage2D(o.TEXTURE_2D,_e,ve,Fe.width,Fe.height,0,G,se,Fe.data);P.generateMipmaps=!1}else Le?(Me&&t.texStorage2D(o.TEXTURE_2D,Ze,ve,Z.width,Z.height),t.texSubImage2D(o.TEXTURE_2D,0,0,0,Z.width,Z.height,G,se,Z.data)):t.texImage2D(o.TEXTURE_2D,0,ve,Z.width,Z.height,0,G,se,Z.data);else if(P.isCompressedTexture){Le&&Me&&t.texStorage2D(o.TEXTURE_2D,Ze,ve,q[0].width,q[0].height);for(let _e=0,He=q.length;_e<He;_e++)Fe=q[_e],P.format!==at?G!==null?Le?t.compressedTexSubImage2D(o.TEXTURE_2D,_e,0,0,Fe.width,Fe.height,G,Fe.data):t.compressedTexImage2D(o.TEXTURE_2D,_e,ve,Fe.width,Fe.height,0,Fe.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Le?t.texSubImage2D(o.TEXTURE_2D,_e,0,0,Fe.width,Fe.height,G,se,Fe.data):t.texImage2D(o.TEXTURE_2D,_e,ve,Fe.width,Fe.height,0,G,se,Fe.data)}else if(P.isDataTexture2DArray)Le?(Me&&t.texStorage3D(o.TEXTURE_2D_ARRAY,Ze,ve,Z.width,Z.height,Z.depth),t.texSubImage3D(o.TEXTURE_2D_ARRAY,0,0,0,0,Z.width,Z.height,Z.depth,G,se,Z.data)):t.texImage3D(o.TEXTURE_2D_ARRAY,0,ve,Z.width,Z.height,Z.depth,0,G,se,Z.data);else if(P.isDataTexture3D)Le?(Me&&t.texStorage3D(o.TEXTURE_3D,Ze,ve,Z.width,Z.height,Z.depth),t.texSubImage3D(o.TEXTURE_3D,0,0,0,0,Z.width,Z.height,Z.depth,G,se,Z.data)):t.texImage3D(o.TEXTURE_3D,0,ve,Z.width,Z.height,Z.depth,0,G,se,Z.data);else if(P.isFramebufferTexture)Le&&Me?t.texStorage2D(o.TEXTURE_2D,Ze,ve,Z.width,Z.height):t.texImage2D(o.TEXTURE_2D,0,ve,Z.width,Z.height,0,G,se,null);else if(q.length>0&&Se){Le&&Me&&t.texStorage2D(o.TEXTURE_2D,Ze,ve,q[0].width,q[0].height);for(let _e=0,He=q.length;_e<He;_e++)Fe=q[_e],Le?t.texSubImage2D(o.TEXTURE_2D,_e,0,0,G,se,Fe):t.texImage2D(o.TEXTURE_2D,_e,ve,G,se,Fe);P.generateMipmaps=!1}else Le?(Me&&t.texStorage2D(o.TEXTURE_2D,Ze,ve,Z.width,Z.height),t.texSubImage2D(o.TEXTURE_2D,0,0,0,G,se,Z)):t.texImage2D(o.TEXTURE_2D,0,ve,G,se,Z);x(P,Se)&&A(ee),k.__version=P.version,P.onUpdate&&P.onUpdate(P)}function Ne(k,P,fe){if(P.image.length!==6)return;W(k,P),t.activeTexture(o.TEXTURE0+fe),t.bindTexture(o.TEXTURE_CUBE_MAP,k.__webglTexture),o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,P.flipY),o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,P.premultiplyAlpha),o.pixelStorei(o.UNPACK_ALIGNMENT,P.unpackAlignment),o.pixelStorei(o.UNPACK_COLORSPACE_CONVERSION_WEBGL,o.NONE);let ee=P&&(P.isCompressedTexture||P.image[0].isCompressedTexture),me=P.image[0]&&P.image[0].isDataTexture,Z=[];for(let _e=0;_e<6;_e++)!ee&&!me?Z[_e]=_(P.image[_e],!1,!0,l):Z[_e]=me?P.image[_e].image:P.image[_e],Z[_e]=we(P,Z[_e]);let Se=Z[0],G=T(Se)||a,se=i.convert(P.format,P.encoding),ve=i.convert(P.type),Fe=E(P.internalFormat,se,ve,P.encoding),q=a&&P.isVideoTexture!==!0,Le=k.__version===void 0,Me=S(P,Se,G);X(o.TEXTURE_CUBE_MAP,P,G);let Ze;if(ee){q&&Le&&t.texStorage2D(o.TEXTURE_CUBE_MAP,Me,Fe,Se.width,Se.height);for(let _e=0;_e<6;_e++){Ze=Z[_e].mipmaps;for(let He=0;He<Ze.length;He++){let tt=Ze[He];P.format!==at?se!==null?q?t.compressedTexSubImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X+_e,He,0,0,tt.width,tt.height,se,tt.data):t.compressedTexImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X+_e,He,Fe,tt.width,tt.height,0,tt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):q?t.texSubImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X+_e,He,0,0,tt.width,tt.height,se,ve,tt.data):t.texImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X+_e,He,Fe,tt.width,tt.height,0,se,ve,tt.data)}}}else{Ze=P.mipmaps,q&&Le&&(Ze.length>0&&Me++,t.texStorage2D(o.TEXTURE_CUBE_MAP,Me,Fe,Z[0].width,Z[0].height));for(let _e=0;_e<6;_e++)if(me){q?t.texSubImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X+_e,0,0,0,Z[_e].width,Z[_e].height,se,ve,Z[_e].data):t.texImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X+_e,0,Fe,Z[_e].width,Z[_e].height,0,se,ve,Z[_e].data);for(let He=0;He<Ze.length;He++){let nr=Ze[He].image[_e].image;q?t.texSubImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X+_e,He+1,0,0,nr.width,nr.height,se,ve,nr.data):t.texImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X+_e,He+1,Fe,nr.width,nr.height,0,se,ve,nr.data)}}else{q?t.texSubImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X+_e,0,0,0,se,ve,Z[_e]):t.texImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X+_e,0,Fe,se,ve,Z[_e]);for(let He=0;He<Ze.length;He++){let tt=Ze[He];q?t.texSubImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X+_e,He+1,0,0,se,ve,tt.image[_e]):t.texImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X+_e,He+1,Fe,se,ve,tt.image[_e])}}}x(P,G)&&A(o.TEXTURE_CUBE_MAP),k.__version=P.version,P.onUpdate&&P.onUpdate(P)}function ye(k,P,fe,ee,me){let Z=i.convert(fe.format,fe.encoding),Se=i.convert(fe.type),G=E(fe.internalFormat,Z,Se,fe.encoding);r.get(P).__hasExternalTextures||(me===o.TEXTURE_3D||me===o.TEXTURE_2D_ARRAY?t.texImage3D(me,0,G,P.width,P.height,P.depth,0,Z,Se,null):t.texImage2D(me,0,G,P.width,P.height,0,Z,Se,null)),t.bindFramebuffer(o.FRAMEBUFFER,k),P.useRenderToTexture?h.framebufferTexture2DMultisampleEXT(o.FRAMEBUFFER,ee,me,r.get(fe).__webglTexture,0,ne(P)):o.framebufferTexture2D(o.FRAMEBUFFER,ee,me,r.get(fe).__webglTexture,0),t.bindFramebuffer(o.FRAMEBUFFER,null)}function ae(k,P,fe){if(o.bindRenderbuffer(o.RENDERBUFFER,k),P.depthBuffer&&!P.stencilBuffer){let ee=o.DEPTH_COMPONENT16;if(fe||P.useRenderToTexture){let me=P.depthTexture;me&&me.isDepthTexture&&(me.type===qt?ee=o.DEPTH_COMPONENT32F:me.type===W0&&(ee=o.DEPTH_COMPONENT24));let Z=ne(P);P.useRenderToTexture?h.renderbufferStorageMultisampleEXT(o.RENDERBUFFER,Z,ee,P.width,P.height):o.renderbufferStorageMultisample(o.RENDERBUFFER,Z,ee,P.width,P.height)}else o.renderbufferStorage(o.RENDERBUFFER,ee,P.width,P.height);o.framebufferRenderbuffer(o.FRAMEBUFFER,o.DEPTH_ATTACHMENT,o.RENDERBUFFER,k)}else if(P.depthBuffer&&P.stencilBuffer){let ee=ne(P);fe&&P.useRenderbuffer?o.renderbufferStorageMultisample(o.RENDERBUFFER,ee,o.DEPTH24_STENCIL8,P.width,P.height):P.useRenderToTexture?h.renderbufferStorageMultisampleEXT(o.RENDERBUFFER,ee,o.DEPTH24_STENCIL8,P.width,P.height):o.renderbufferStorage(o.RENDERBUFFER,o.DEPTH_STENCIL,P.width,P.height),o.framebufferRenderbuffer(o.FRAMEBUFFER,o.DEPTH_STENCIL_ATTACHMENT,o.RENDERBUFFER,k)}else{let ee=P.isWebGLMultipleRenderTargets===!0?P.texture[0]:P.texture,me=i.convert(ee.format,ee.encoding),Z=i.convert(ee.type),Se=E(ee.internalFormat,me,Z,ee.encoding),G=ne(P);fe&&P.useRenderbuffer?o.renderbufferStorageMultisample(o.RENDERBUFFER,G,Se,P.width,P.height):P.useRenderToTexture?h.renderbufferStorageMultisampleEXT(o.RENDERBUFFER,G,Se,P.width,P.height):o.renderbufferStorage(o.RENDERBUFFER,Se,P.width,P.height)}o.bindRenderbuffer(o.RENDERBUFFER,null)}function Ae(k,P){if(P&&P.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(o.FRAMEBUFFER,k),!(P.depthTexture&&P.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!r.get(P.depthTexture).__webglTexture||P.depthTexture.image.width!==P.width||P.depthTexture.image.height!==P.height)&&(P.depthTexture.image.width=P.width,P.depthTexture.image.height=P.height,P.depthTexture.needsUpdate=!0),j(P.depthTexture,0);let ee=r.get(P.depthTexture).__webglTexture,me=ne(P);if(P.depthTexture.format===wn)P.useRenderToTexture?h.framebufferTexture2DMultisampleEXT(o.FRAMEBUFFER,o.DEPTH_ATTACHMENT,o.TEXTURE_2D,ee,0,me):o.framebufferTexture2D(o.FRAMEBUFFER,o.DEPTH_ATTACHMENT,o.TEXTURE_2D,ee,0);else if(P.depthTexture.format===ei)P.useRenderToTexture?h.framebufferTexture2DMultisampleEXT(o.FRAMEBUFFER,o.DEPTH_STENCIL_ATTACHMENT,o.TEXTURE_2D,ee,0,me):o.framebufferTexture2D(o.FRAMEBUFFER,o.DEPTH_STENCIL_ATTACHMENT,o.TEXTURE_2D,ee,0);else throw new Error("Unknown depthTexture format")}function Ie(k){let P=r.get(k),fe=k.isWebGLCubeRenderTarget===!0;if(k.depthTexture&&!P.__autoAllocateDepthBuffer){if(fe)throw new Error("target.depthTexture not supported in Cube render targets");Ae(P.__webglFramebuffer,k)}else if(fe){P.__webglDepthbuffer=[];for(let ee=0;ee<6;ee++)t.bindFramebuffer(o.FRAMEBUFFER,P.__webglFramebuffer[ee]),P.__webglDepthbuffer[ee]=o.createRenderbuffer(),ae(P.__webglDepthbuffer[ee],k,!1)}else t.bindFramebuffer(o.FRAMEBUFFER,P.__webglFramebuffer),P.__webglDepthbuffer=o.createRenderbuffer(),ae(P.__webglDepthbuffer,k,!1);t.bindFramebuffer(o.FRAMEBUFFER,null)}function Oe(k,P,fe){let ee=r.get(k);P!==void 0&&ye(ee.__webglFramebuffer,k,k.texture,o.COLOR_ATTACHMENT0,o.TEXTURE_2D),fe!==void 0&&Ie(k)}function le(k){let P=k.texture,fe=r.get(k),ee=r.get(P);k.addEventListener("dispose",C),k.isWebGLMultipleRenderTargets!==!0&&(ee.__webglTexture===void 0&&(ee.__webglTexture=o.createTexture()),ee.__version=P.version,s.memory.textures++);let me=k.isWebGLCubeRenderTarget===!0,Z=k.isWebGLMultipleRenderTargets===!0,Se=P.isDataTexture3D||P.isDataTexture2DArray,G=T(k)||a;if(me){fe.__webglFramebuffer=[];for(let se=0;se<6;se++)fe.__webglFramebuffer[se]=o.createFramebuffer()}else if(fe.__webglFramebuffer=o.createFramebuffer(),Z)if(n.drawBuffers){let se=k.texture;for(let ve=0,Fe=se.length;ve<Fe;ve++){let q=r.get(se[ve]);q.__webglTexture===void 0&&(q.__webglTexture=o.createTexture(),s.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");else if(k.useRenderbuffer)if(a){fe.__webglMultisampledFramebuffer=o.createFramebuffer(),fe.__webglColorRenderbuffer=o.createRenderbuffer(),o.bindRenderbuffer(o.RENDERBUFFER,fe.__webglColorRenderbuffer);let se=i.convert(P.format,P.encoding),ve=i.convert(P.type),Fe=E(P.internalFormat,se,ve,P.encoding),q=ne(k);o.renderbufferStorageMultisample(o.RENDERBUFFER,q,Fe,k.width,k.height),t.bindFramebuffer(o.FRAMEBUFFER,fe.__webglMultisampledFramebuffer),o.framebufferRenderbuffer(o.FRAMEBUFFER,o.COLOR_ATTACHMENT0,o.RENDERBUFFER,fe.__webglColorRenderbuffer),o.bindRenderbuffer(o.RENDERBUFFER,null),k.depthBuffer&&(fe.__webglDepthRenderbuffer=o.createRenderbuffer(),ae(fe.__webglDepthRenderbuffer,k,!0)),t.bindFramebuffer(o.FRAMEBUFFER,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(me){t.bindTexture(o.TEXTURE_CUBE_MAP,ee.__webglTexture),X(o.TEXTURE_CUBE_MAP,P,G);for(let se=0;se<6;se++)ye(fe.__webglFramebuffer[se],k,P,o.COLOR_ATTACHMENT0,o.TEXTURE_CUBE_MAP_POSITIVE_X+se);x(P,G)&&A(o.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(Z){let se=k.texture;for(let ve=0,Fe=se.length;ve<Fe;ve++){let q=se[ve],Le=r.get(q);t.bindTexture(o.TEXTURE_2D,Le.__webglTexture),X(o.TEXTURE_2D,q,G),ye(fe.__webglFramebuffer,k,q,o.COLOR_ATTACHMENT0+ve,o.TEXTURE_2D),x(q,G)&&A(o.TEXTURE_2D)}t.unbindTexture()}else{let se=o.TEXTURE_2D;Se&&(a?se=P.isDataTexture3D?o.TEXTURE_3D:o.TEXTURE_2D_ARRAY:console.warn("THREE.DataTexture3D and THREE.DataTexture2DArray only supported with WebGL2.")),t.bindTexture(se,ee.__webglTexture),X(se,P,G),ye(fe.__webglFramebuffer,k,P,o.COLOR_ATTACHMENT0,se),x(P,G)&&A(se),t.unbindTexture()}k.depthBuffer&&Ie(k)}function xe(k){let P=T(k)||a,fe=k.isWebGLMultipleRenderTargets===!0?k.texture:[k.texture];for(let ee=0,me=fe.length;ee<me;ee++){let Z=fe[ee];if(x(Z,P)){let Se=k.isWebGLCubeRenderTarget?o.TEXTURE_CUBE_MAP:o.TEXTURE_2D,G=r.get(Z).__webglTexture;t.bindTexture(Se,G),A(Se),t.unbindTexture()}}}function be(k){if(k.useRenderbuffer)if(a){let P=k.width,fe=k.height,ee=o.COLOR_BUFFER_BIT,me=[o.COLOR_ATTACHMENT0],Z=k.stencilBuffer?o.DEPTH_STENCIL_ATTACHMENT:o.DEPTH_ATTACHMENT;k.depthBuffer&&me.push(Z),k.ignoreDepthForMultisampleCopy||(k.depthBuffer&&(ee|=o.DEPTH_BUFFER_BIT),k.stencilBuffer&&(ee|=o.STENCIL_BUFFER_BIT));let Se=r.get(k);t.bindFramebuffer(o.READ_FRAMEBUFFER,Se.__webglMultisampledFramebuffer),t.bindFramebuffer(o.DRAW_FRAMEBUFFER,Se.__webglFramebuffer),k.ignoreDepthForMultisampleCopy&&(o.invalidateFramebuffer(o.READ_FRAMEBUFFER,[Z]),o.invalidateFramebuffer(o.DRAW_FRAMEBUFFER,[Z])),o.blitFramebuffer(0,0,P,fe,0,0,P,fe,ee,o.NEAREST),o.invalidateFramebuffer(o.READ_FRAMEBUFFER,me),t.bindFramebuffer(o.READ_FRAMEBUFFER,null),t.bindFramebuffer(o.DRAW_FRAMEBUFFER,Se.__webglMultisampledFramebuffer)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")}function ne(k){return a&&(k.useRenderbuffer||k.useRenderToTexture)?Math.min(p,k.samples):0}function he(k){let P=s.render.frame;m.get(k)!==P&&(m.set(k,P),k.update())}function we(k,P){let fe=k.encoding,ee=k.format,me=k.type;return k.isCompressedTexture===!0||k.isVideoTexture===!0||k.format===Hd||fe!==Xr&&(fe===bt?a===!1?e.has("EXT_sRGB")===!0&&ee===at?(k.format=Hd,k.minFilter=lt,k.generateMipmaps=!1):P=pb.sRGBToLinear(P):(ee!==at||me!==Wo)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",fe)),P}let Ee=!1,Pe=!1;function Xe(k,P){k&&k.isWebGLRenderTarget&&(Ee===!1&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),Ee=!0),k=k.texture),j(k,P)}function et(k,P){k&&k.isWebGLCubeRenderTarget&&(Pe===!1&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),Pe=!0),k=k.texture),H(k,P)}this.allocateTextureUnit=F,this.resetTextureUnits=V,this.setTexture2D=j,this.setTexture2DArray=$,this.setTexture3D=Y,this.setTextureCube=H,this.rebindTextures=Oe,this.setupRenderTarget=le,this.updateRenderTargetMipmap=xe,this.updateMultisampleRenderTarget=be,this.setupDepthRenderbuffer=Ie,this.setupFrameBufferTexture=ye,this.safeSetTexture2D=Xe,this.safeSetTextureCube=et}function GC(o,e,t){let r=t.isWebGL2;function n(i,s=null){let a;if(i===Wo)return o.UNSIGNED_BYTE;if(i===Qm)return o.UNSIGNED_SHORT_4_4_4_4;if(i===e1)return o.UNSIGNED_SHORT_5_5_5_1;if(i===Km)return o.BYTE;if(i===Jm)return o.SHORT;if(i===Ii)return o.UNSIGNED_SHORT;if(i===Zm)return o.INT;if(i===W0)return o.UNSIGNED_INT;if(i===qt)return o.FLOAT;if(i===qr)return r?o.HALF_FLOAT:(a=e.get("OES_texture_half_float"),a!==null?a.HALF_FLOAT_OES:null);if(i===t1)return o.ALPHA;if(i===at)return o.RGBA;if(i===pu)return o.LUMINANCE;if(i===r1)return o.LUMINANCE_ALPHA;if(i===wn)return o.DEPTH_COMPONENT;if(i===ei)return o.DEPTH_STENCIL;if(i===o1)return o.RED;if(i===Qx)return console.warn("THREE.WebGLRenderer: THREE.RGBFormat has been removed. Use THREE.RGBAFormat instead. https://github.com/mrdoob/three.js/pull/23228"),o.RGBA;if(i===Hd)return a=e.get("EXT_sRGB"),a!==null?a.SRGB_ALPHA_EXT:null;if(i===n1)return o.RED_INTEGER;if(i===i1)return o.RG;if(i===s1)return o.RG_INTEGER;if(i===a1)return o.RGBA_INTEGER;if(i===c1||i===l1||i===u1||i===p1)if(s===bt)if(a=e.get("WEBGL_compressed_texture_s3tc_srgb"),a!==null){if(i===c1)return a.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(i===l1)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(i===u1)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(i===p1)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(a=e.get("WEBGL_compressed_texture_s3tc"),a!==null){if(i===c1)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(i===l1)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(i===u1)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(i===p1)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(i===E3||i===S3||i===w3||i===M3)if(a=e.get("WEBGL_compressed_texture_pvrtc"),a!==null){if(i===E3)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(i===S3)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(i===w3)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(i===M3)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(i===eb)return a=e.get("WEBGL_compressed_texture_etc1"),a!==null?a.COMPRESSED_RGB_ETC1_WEBGL:null;if(i===N3||i===O3)if(a=e.get("WEBGL_compressed_texture_etc"),a!==null){if(i===N3)return s===bt?a.COMPRESSED_SRGB8_ETC2:a.COMPRESSED_RGB8_ETC2;if(i===O3)return s===bt?a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(i===P3||i===R3||i===I3||i===L3||i===D3||i===k3||i===B3||i===F3||i===U3||i===V3||i===G3||i===z3||i===H3||i===j3)if(a=e.get("WEBGL_compressed_texture_astc"),a!==null){if(i===P3)return s===bt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:a.COMPRESSED_RGBA_ASTC_4x4_KHR;if(i===R3)return s===bt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:a.COMPRESSED_RGBA_ASTC_5x4_KHR;if(i===I3)return s===bt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:a.COMPRESSED_RGBA_ASTC_5x5_KHR;if(i===L3)return s===bt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:a.COMPRESSED_RGBA_ASTC_6x5_KHR;if(i===D3)return s===bt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:a.COMPRESSED_RGBA_ASTC_6x6_KHR;if(i===k3)return s===bt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:a.COMPRESSED_RGBA_ASTC_8x5_KHR;if(i===B3)return s===bt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:a.COMPRESSED_RGBA_ASTC_8x6_KHR;if(i===F3)return s===bt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:a.COMPRESSED_RGBA_ASTC_8x8_KHR;if(i===U3)return s===bt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:a.COMPRESSED_RGBA_ASTC_10x5_KHR;if(i===V3)return s===bt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:a.COMPRESSED_RGBA_ASTC_10x6_KHR;if(i===G3)return s===bt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:a.COMPRESSED_RGBA_ASTC_10x8_KHR;if(i===z3)return s===bt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:a.COMPRESSED_RGBA_ASTC_10x10_KHR;if(i===H3)return s===bt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:a.COMPRESSED_RGBA_ASTC_12x10_KHR;if(i===j3)return s===bt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:a.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(i===W3)if(a=e.get("EXT_texture_compression_bptc"),a!==null){if(i===W3)return s===bt?a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:a.COMPRESSED_RGBA_BPTC_UNORM_EXT}else return null;if(i===Qn)return r?o.UNSIGNED_INT_24_8:(a=e.get("WEBGL_depth_texture"),a!==null?a.UNSIGNED_INT_24_8_WEBGL:null)}return{convert:n}}var N1=class extends sr{constructor(e=[]){super();this.cameras=e}};N1.prototype.isArrayCamera=!0;var Gz={type:"move"},Yd=class{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new st,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new st,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new M,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new M),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new st,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new M,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new M),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,r){let n=null,i=null,s=null,a=this._targetRay,c=this._grip,l=this._hand;if(e&&t.session.visibilityState!=="visible-blurred")if(a!==null&&(n=t.getPose(e.targetRaySpace,r),n!==null&&(a.matrix.fromArray(n.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),n.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(n.linearVelocity)):a.hasLinearVelocity=!1,n.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(n.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(Gz))),l&&e.hand){s=!0;for(let f of e.hand.values()){let v=t.getJointPose(f,r);if(l.joints[f.jointName]===void 0){let _=new st;_.matrixAutoUpdate=!1,_.visible=!1,l.joints[f.jointName]=_,l.add(_)}let g=l.joints[f.jointName];v!==null&&(g.matrix.fromArray(v.transform.matrix),g.matrix.decompose(g.position,g.rotation,g.scale),g.jointRadius=v.radius),g.visible=v!==null}let u=l.joints["index-finger-tip"],p=l.joints["thumb-tip"],d=u.position.distanceTo(p.position),h=.02,m=.005;l.inputState.pinching&&d>h+m?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!l.inputState.pinching&&d<=h-m&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else c!==null&&e.gripSpace&&(i=t.getPose(e.gripSpace,r),i!==null&&(c.matrix.fromArray(i.transform.matrix),c.matrix.decompose(c.position,c.rotation,c.scale),i.linearVelocity?(c.hasLinearVelocity=!0,c.linearVelocity.copy(i.linearVelocity)):c.hasLinearVelocity=!1,i.angularVelocity?(c.hasAngularVelocity=!0,c.angularVelocity.copy(i.angularVelocity)):c.hasAngularVelocity=!1));return a!==null&&(a.visible=n!==null),c!==null&&(c.visible=i!==null),l!==null&&(l.visible=s!==null),this}};var $d=class extends vr{constructor(e,t,r,n,i,s,a,c,l,u){if(u=u!==void 0?u:wn,u!==wn&&u!==ei)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");r===void 0&&u===wn&&(r=Ii),r===void 0&&u===ei&&(r=Qn);super(null,n,i,s,a,c,u,r,l);this.image={width:e,height:t},this.magFilter=a!==void 0?a:it,this.minFilter=c!==void 0?c:it,this.flipY=!1,this.generateMipmaps=!1}};$d.prototype.isDepthTexture=!0;var c4=class extends hu{constructor(e,t){super();let r=this,n=null,i=1,s=null,a="local-floor",c=e.extensions.has("WEBGL_multisampled_render_to_texture"),l=null,u=null,p=null,d=null,h=!1,m=null,f=t.getContextAttributes(),v=null,g=null,_=[],T=new Map,b=new sr;b.layers.enable(1),b.viewport=new De;let x=new sr;x.layers.enable(2),x.viewport=new De;let A=[b,x],E=new N1;E.layers.enable(1),E.layers.enable(2);let S=null,w=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(H){let B=_[H];return B===void 0&&(B=new Yd,_[H]=B),B.getTargetRaySpace()},this.getControllerGrip=function(H){let B=_[H];return B===void 0&&(B=new Yd,_[H]=B),B.getGripSpace()},this.getHand=function(H){let B=_[H];return B===void 0&&(B=new Yd,_[H]=B),B.getHandSpace()};function O(H){let B=T.get(H.inputSource);B&&B.dispatchEvent({type:H.type,data:H.inputSource})}function C(){T.forEach(function(H,B){H.disconnect(B)}),T.clear(),S=null,w=null,e.setRenderTarget(v),d=null,p=null,u=null,n=null,g=null,Y.stop(),r.isPresenting=!1,r.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(H){i=H,r.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(H){a=H,r.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return s},this.getBaseLayer=function(){return p!==null?p:d},this.getBinding=function(){return u},this.getFrame=function(){return m},this.getSession=function(){return n},this.setSession=async function(H){if(n=H,n!==null){if(v=e.getRenderTarget(),n.addEventListener("select",O),n.addEventListener("selectstart",O),n.addEventListener("selectend",O),n.addEventListener("squeeze",O),n.addEventListener("squeezestart",O),n.addEventListener("squeezeend",O),n.addEventListener("end",C),n.addEventListener("inputsourceschange",N),f.xrCompatible!==!0&&await t.makeXRCompatible(),n.renderState.layers===void 0||e.capabilities.isWebGL2===!1){let B={antialias:n.renderState.layers===void 0?f.antialias:!0,alpha:f.alpha,depth:f.depth,stencil:f.stencil,framebufferScaleFactor:i};d=new XRWebGLLayer(n,t,B),n.updateRenderState({baseLayer:d}),g=new yr(d.framebufferWidth,d.framebufferHeight,{format:at,type:Wo,encoding:e.outputEncoding})}else{h=f.antialias;let B=null,te=null,X=null;f.depth&&(X=f.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,B=f.stencil?ei:wn,te=f.stencil?Qn:Ii);let W={colorFormat:e.outputEncoding===bt?t.SRGB8_ALPHA8:t.RGBA8,depthFormat:X,scaleFactor:i};u=new XRWebGLBinding(n,t),p=u.createProjectionLayer(W),n.updateRenderState({layers:[p]}),h?g=new Z0(p.textureWidth,p.textureHeight,{format:at,type:Wo,depthTexture:new $d(p.textureWidth,p.textureHeight,te,void 0,void 0,void 0,void 0,void 0,void 0,B),stencilBuffer:f.stencil,ignoreDepth:p.ignoreDepthValues,useRenderToTexture:c,encoding:e.outputEncoding}):g=new yr(p.textureWidth,p.textureHeight,{format:at,type:Wo,depthTexture:new $d(p.textureWidth,p.textureHeight,te,void 0,void 0,void 0,void 0,void 0,void 0,B),stencilBuffer:f.stencil,ignoreDepth:p.ignoreDepthValues,encoding:e.outputEncoding})}g.isXRRenderTarget=!0,this.setFoveation(1),s=await n.requestReferenceSpace(a),Y.setContext(n),Y.start(),r.isPresenting=!0,r.dispatchEvent({type:"sessionstart"})}};function N(H){let B=n.inputSources;for(let te=0;te<_.length;te++)T.set(B[te],_[te]);for(let te=0;te<H.removed.length;te++){let X=H.removed[te],W=T.get(X);W&&(W.dispatchEvent({type:"disconnected",data:X}),T.delete(X))}for(let te=0;te<H.added.length;te++){let X=H.added[te],W=T.get(X);W&&W.dispatchEvent({type:"connected",data:X})}}let R=new M,D=new M;function V(H,B,te){R.setFromMatrixPosition(B.matrixWorld),D.setFromMatrixPosition(te.matrixWorld);let X=R.distanceTo(D),W=B.projectionMatrix.elements,L=te.projectionMatrix.elements,Ne=W[14]/(W[10]-1),ye=W[14]/(W[10]+1),ae=(W[9]+1)/W[5],Ae=(W[9]-1)/W[5],Ie=(W[8]-1)/W[0],Oe=(L[8]+1)/L[0],le=Ne*Ie,xe=Ne*Oe,be=X/(-Ie+Oe),ne=be*-Ie;B.matrixWorld.decompose(H.position,H.quaternion,H.scale),H.translateX(ne),H.translateZ(be),H.matrixWorld.compose(H.position,H.quaternion,H.scale),H.matrixWorldInverse.copy(H.matrixWorld).invert();let he=Ne+be,we=ye+be,Ee=le-ne,Pe=xe+(X-ne),Xe=ae*ye/we*he,et=Ae*ye/we*he;H.projectionMatrix.makePerspective(Ee,Pe,Xe,et,he,we)}function F(H,B){B===null?H.matrixWorld.copy(H.matrix):H.matrixWorld.multiplyMatrices(B.matrixWorld,H.matrix),H.matrixWorldInverse.copy(H.matrixWorld).invert()}this.updateCamera=function(H){if(n===null)return;E.near=x.near=b.near=H.near,E.far=x.far=b.far=H.far,(S!==E.near||w!==E.far)&&(n.updateRenderState({depthNear:E.near,depthFar:E.far}),S=E.near,w=E.far);let B=H.parent,te=E.cameras;F(E,B);for(let W=0;W<te.length;W++)F(te[W],B);E.matrixWorld.decompose(E.position,E.quaternion,E.scale),H.position.copy(E.position),H.quaternion.copy(E.quaternion),H.scale.copy(E.scale),H.matrix.copy(E.matrix),H.matrixWorld.copy(E.matrixWorld);let X=H.children;for(let W=0,L=X.length;W<L;W++)X[W].updateMatrixWorld(!0);te.length===2?V(E,b,x):E.projectionMatrix.copy(b.projectionMatrix)},this.getCamera=function(){return E},this.getFoveation=function(){if(p!==null)return p.fixedFoveation;if(d!==null)return d.fixedFoveation},this.setFoveation=function(H){p!==null&&(p.fixedFoveation=H),d!==null&&d.fixedFoveation!==void 0&&(d.fixedFoveation=H)};let j=null;function $(H,B){if(l=B.getViewerPose(s),m=B,l!==null){let X=l.views;d!==null&&(e.setRenderTargetFramebuffer(g,d.framebuffer),e.setRenderTarget(g));let W=!1;X.length!==E.cameras.length&&(E.cameras.length=0,W=!0);for(let L=0;L<X.length;L++){let Ne=X[L],ye=null;if(d!==null)ye=d.getViewport(Ne);else{let Ae=u.getViewSubImage(p,Ne);ye=Ae.viewport,L===0&&(e.setRenderTargetTextures(g,Ae.colorTexture,p.ignoreDepthValues?void 0:Ae.depthStencilTexture),e.setRenderTarget(g))}let ae=A[L];ae.matrix.fromArray(Ne.transform.matrix),ae.projectionMatrix.fromArray(Ne.projectionMatrix),ae.viewport.set(ye.x,ye.y,ye.width,ye.height),L===0&&E.matrix.copy(ae.matrix),W===!0&&E.cameras.push(ae)}}let te=n.inputSources;for(let X=0;X<_.length;X++){let W=_[X],L=te[X];W.update(L,B,s)}j&&j(H,B),m=null}let Y=new b1;Y.setAnimationLoop($),this.setAnimationLoop=function(H){j=H},this.dispose=function(){}}};function zC(o){function e(g,_){g.fogColor.value.copy(_.color),_.isFog?(g.fogNear.value=_.near,g.fogFar.value=_.far):_.isFogExp2&&(g.fogDensity.value=_.density)}function t(g,_,T,b,x){_.isMeshBasicMaterial?r(g,_):_.isMeshLambertMaterial?(r(g,_),c(g,_)):_.isMeshToonMaterial?(r(g,_),u(g,_)):_.isMeshPhongMaterial?(r(g,_),l(g,_)):_.isMeshStandardMaterial?(r(g,_),_.isMeshPhysicalMaterial?d(g,_,x):p(g,_)):_.isMeshMatcapMaterial?(r(g,_),h(g,_)):_.isMeshDepthMaterial?(r(g,_),m(g,_)):_.isMeshDistanceMaterial?(r(g,_),f(g,_)):_.isMeshNormalMaterial?(r(g,_),v(g,_)):_.isLineBasicMaterial?(n(g,_),_.isLineDashedMaterial&&i(g,_)):_.isPointsMaterial?s(g,_,T,b):_.isSpriteMaterial?a(g,_):_.isShadowMaterial?(g.color.value.copy(_.color),g.opacity.value=_.opacity):_.isShaderMaterial&&(_.uniformsNeedUpdate=!1)}function r(g,_){g.opacity.value=_.opacity,_.color&&g.diffuse.value.copy(_.color),_.emissive&&g.emissive.value.copy(_.emissive).multiplyScalar(_.emissiveIntensity),_.map&&(g.map.value=_.map),_.alphaMap&&(g.alphaMap.value=_.alphaMap),_.specularMap&&(g.specularMap.value=_.specularMap),_.alphaTest>0&&(g.alphaTest.value=_.alphaTest);let T=o.get(_).envMap;T&&(g.envMap.value=T,g.flipEnvMap.value=T.isCubeTexture&&T.isRenderTargetTexture===!1?-1:1,g.reflectivity.value=_.reflectivity,g.ior.value=_.ior,g.refractionRatio.value=_.refractionRatio),_.lightMap&&(g.lightMap.value=_.lightMap,g.lightMapIntensity.value=_.lightMapIntensity),_.aoMap&&(g.aoMap.value=_.aoMap,g.aoMapIntensity.value=_.aoMapIntensity);let b;_.map?b=_.map:_.specularMap?b=_.specularMap:_.displacementMap?b=_.displacementMap:_.normalMap?b=_.normalMap:_.bumpMap?b=_.bumpMap:_.roughnessMap?b=_.roughnessMap:_.metalnessMap?b=_.metalnessMap:_.alphaMap?b=_.alphaMap:_.emissiveMap?b=_.emissiveMap:_.clearcoatMap?b=_.clearcoatMap:_.clearcoatNormalMap?b=_.clearcoatNormalMap:_.clearcoatRoughnessMap?b=_.clearcoatRoughnessMap:_.specularIntensityMap?b=_.specularIntensityMap:_.specularColorMap?b=_.specularColorMap:_.transmissionMap?b=_.transmissionMap:_.thicknessMap?b=_.thicknessMap:_.sheenColorMap?b=_.sheenColorMap:_.sheenRoughnessMap&&(b=_.sheenRoughnessMap),b!==void 0&&(b.isWebGLRenderTarget&&(b=b.texture),b.matrixAutoUpdate===!0&&b.updateMatrix(),g.uvTransform.value.copy(b.matrix));let x;_.aoMap?x=_.aoMap:_.lightMap&&(x=_.lightMap),x!==void 0&&(x.isWebGLRenderTarget&&(x=x.texture),x.matrixAutoUpdate===!0&&x.updateMatrix(),g.uv2Transform.value.copy(x.matrix))}function n(g,_){g.diffuse.value.copy(_.color),g.opacity.value=_.opacity}function i(g,_){g.dashSize.value=_.dashSize,g.totalSize.value=_.dashSize+_.gapSize,g.scale.value=_.scale}function s(g,_,T,b){g.diffuse.value.copy(_.color),g.opacity.value=_.opacity,g.size.value=_.size*T,g.scale.value=b*.5,_.map&&(g.map.value=_.map),_.alphaMap&&(g.alphaMap.value=_.alphaMap),_.alphaTest>0&&(g.alphaTest.value=_.alphaTest);let x;_.map?x=_.map:_.alphaMap&&(x=_.alphaMap),x!==void 0&&(x.matrixAutoUpdate===!0&&x.updateMatrix(),g.uvTransform.value.copy(x.matrix))}function a(g,_){g.diffuse.value.copy(_.color),g.opacity.value=_.opacity,g.rotation.value=_.rotation,_.map&&(g.map.value=_.map),_.alphaMap&&(g.alphaMap.value=_.alphaMap),_.alphaTest>0&&(g.alphaTest.value=_.alphaTest);let T;_.map?T=_.map:_.alphaMap&&(T=_.alphaMap),T!==void 0&&(T.matrixAutoUpdate===!0&&T.updateMatrix(),g.uvTransform.value.copy(T.matrix))}function c(g,_){_.emissiveMap&&(g.emissiveMap.value=_.emissiveMap)}function l(g,_){g.specular.value.copy(_.specular),g.shininess.value=Math.max(_.shininess,1e-4),_.emissiveMap&&(g.emissiveMap.value=_.emissiveMap),_.bumpMap&&(g.bumpMap.value=_.bumpMap,g.bumpScale.value=_.bumpScale,_.side===Mt&&(g.bumpScale.value*=-1)),_.normalMap&&(g.normalMap.value=_.normalMap,g.normalScale.value.copy(_.normalScale),_.side===Mt&&g.normalScale.value.negate()),_.displacementMap&&(g.displacementMap.value=_.displacementMap,g.displacementScale.value=_.displacementScale,g.displacementBias.value=_.displacementBias)}function u(g,_){_.gradientMap&&(g.gradientMap.value=_.gradientMap),_.emissiveMap&&(g.emissiveMap.value=_.emissiveMap),_.bumpMap&&(g.bumpMap.value=_.bumpMap,g.bumpScale.value=_.bumpScale,_.side===Mt&&(g.bumpScale.value*=-1)),_.normalMap&&(g.normalMap.value=_.normalMap,g.normalScale.value.copy(_.normalScale),_.side===Mt&&g.normalScale.value.negate()),_.displacementMap&&(g.displacementMap.value=_.displacementMap,g.displacementScale.value=_.displacementScale,g.displacementBias.value=_.displacementBias)}function p(g,_){g.roughness.value=_.roughness,g.metalness.value=_.metalness,_.roughnessMap&&(g.roughnessMap.value=_.roughnessMap),_.metalnessMap&&(g.metalnessMap.value=_.metalnessMap),_.emissiveMap&&(g.emissiveMap.value=_.emissiveMap),_.bumpMap&&(g.bumpMap.value=_.bumpMap,g.bumpScale.value=_.bumpScale,_.side===Mt&&(g.bumpScale.value*=-1)),_.normalMap&&(g.normalMap.value=_.normalMap,g.normalScale.value.copy(_.normalScale),_.side===Mt&&g.normalScale.value.negate()),_.displacementMap&&(g.displacementMap.value=_.displacementMap,g.displacementScale.value=_.displacementScale,g.displacementBias.value=_.displacementBias),o.get(_).envMap&&(g.envMapIntensity.value=_.envMapIntensity)}function d(g,_,T){p(g,_),g.ior.value=_.ior,_.sheen>0&&(g.sheenColor.value.copy(_.sheenColor).multiplyScalar(_.sheen),g.sheenRoughness.value=_.sheenRoughness,_.sheenColorMap&&(g.sheenColorMap.value=_.sheenColorMap),_.sheenRoughnessMap&&(g.sheenRoughnessMap.value=_.sheenRoughnessMap)),_.clearcoat>0&&(g.clearcoat.value=_.clearcoat,g.clearcoatRoughness.value=_.clearcoatRoughness,_.clearcoatMap&&(g.clearcoatMap.value=_.clearcoatMap),_.clearcoatRoughnessMap&&(g.clearcoatRoughnessMap.value=_.clearcoatRoughnessMap),_.clearcoatNormalMap&&(g.clearcoatNormalScale.value.copy(_.clearcoatNormalScale),g.clearcoatNormalMap.value=_.clearcoatNormalMap,_.side===Mt&&g.clearcoatNormalScale.value.negate())),_.transmission>0&&(g.transmission.value=_.transmission,g.transmissionSamplerMap.value=T.texture,g.transmissionSamplerSize.value.set(T.width,T.height),_.transmissionMap&&(g.transmissionMap.value=_.transmissionMap),g.thickness.value=_.thickness,_.thicknessMap&&(g.thicknessMap.value=_.thicknessMap),g.attenuationDistance.value=_.attenuationDistance,g.attenuationColor.value.copy(_.attenuationColor)),g.specularIntensity.value=_.specularIntensity,g.specularColor.value.copy(_.specularColor),_.specularIntensityMap&&(g.specularIntensityMap.value=_.specularIntensityMap),_.specularColorMap&&(g.specularColorMap.value=_.specularColorMap)}function h(g,_){_.matcap&&(g.matcap.value=_.matcap),_.bumpMap&&(g.bumpMap.value=_.bumpMap,g.bumpScale.value=_.bumpScale,_.side===Mt&&(g.bumpScale.value*=-1)),_.normalMap&&(g.normalMap.value=_.normalMap,g.normalScale.value.copy(_.normalScale),_.side===Mt&&g.normalScale.value.negate()),_.displacementMap&&(g.displacementMap.value=_.displacementMap,g.displacementScale.value=_.displacementScale,g.displacementBias.value=_.displacementBias)}function m(g,_){_.displacementMap&&(g.displacementMap.value=_.displacementMap,g.displacementScale.value=_.displacementScale,g.displacementBias.value=_.displacementBias)}function f(g,_){_.displacementMap&&(g.displacementMap.value=_.displacementMap,g.displacementScale.value=_.displacementScale,g.displacementBias.value=_.displacementBias),g.referencePosition.value.copy(_.referencePosition),g.nearDistance.value=_.nearDistance,g.farDistance.value=_.farDistance}function v(g,_){_.bumpMap&&(g.bumpMap.value=_.bumpMap,g.bumpScale.value=_.bumpScale,_.side===Mt&&(g.bumpScale.value*=-1)),_.normalMap&&(g.normalMap.value=_.normalMap,g.normalScale.value.copy(_.normalScale),_.side===Mt&&g.normalScale.value.negate()),_.displacementMap&&(g.displacementMap.value=_.displacementMap,g.displacementScale.value=_.displacementScale,g.displacementBias.value=_.displacementBias)}return{refreshFogUniforms:e,refreshMaterialUniforms:t}}function zz(){let o=fu("canvas");return o.style.display="block",o}function l4(o={}){let e=o.canvas!==void 0?o.canvas:zz(),t=o.context!==void 0?o.context:null,r=o.alpha!==void 0?o.alpha:!1,n=o.depth!==void 0?o.depth:!0,i=o.stencil!==void 0?o.stencil:!0,s=o.antialias!==void 0?o.antialias:!1,a=o.premultipliedAlpha!==void 0?o.premultipliedAlpha:!0,c=o.preserveDrawingBuffer!==void 0?o.preserveDrawingBuffer:!1,l=o.powerPreference!==void 0?o.powerPreference:"default",u=o.failIfMajorPerformanceCaveat!==void 0?o.failIfMajorPerformanceCaveat:!1,p=null,d=null,h=[],m=[];this.domElement=e,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=Xr,this.physicallyCorrectLights=!1,this.toneMapping=Ro,this.toneMappingExposure=1;let f=this,v=!1,g=0,_=0,T=null,b=-1,x=null,A=new De,E=new De,S=null,w=e.width,O=e.height,C=1,N=null,R=null,D=new De(0,0,w,O),V=new De(0,0,w,O),F=!1,j=new xc,$=!1,Y=!1,H=null,B=new Ue,te=new M,X={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function W(){return T===null?C:1}let L=t;function Ne(I,re){for(let ue=0;ue<I.length;ue++){let ie=I[ue],ge=e.getContext(ie,re);if(ge!==null)return ge}return null}try{let I={alpha:!0,depth:n,stencil:i,antialias:s,premultipliedAlpha:a,preserveDrawingBuffer:c,powerPreference:l,failIfMajorPerformanceCaveat:u};if("setAttribute"in e&&e.setAttribute("data-engine",`three.js r${Ax}`),e.addEventListener("webglcontextlost",Fe,!1),e.addEventListener("webglcontextrestored",q,!1),L===null){let re=["webgl2","webgl","experimental-webgl"];if(f.isWebGL1Renderer===!0&&re.shift(),L=Ne(re,I),L===null)throw Ne(re)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}L.getShaderPrecisionFormat===void 0&&(L.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(I){throw console.error("THREE.WebGLRenderer: "+I.message),I}let ye,ae,Ae,Ie,Oe,le,xe,be,ne,he,we,Ee,Pe,Xe,et,k,P,fe,ee,me,Z,Se,G;function se(){ye=new tC(L),ae=new HA(L,ye,o),ye.init(ae),Se=new GC(L,ye,ae),Ae=new UC(L,ye,ae),Ie=new nC(L),Oe=new NC,le=new VC(L,ye,Ae,Oe,ae,Se,Ie),xe=new WA(f),be=new eC(f),ne=new db(L,ae),G=new GA(L,ye,ne,ae),he=new rC(L,ne,Ie,G),we=new aC(L,he,ne,Ie),ee=new sC(L,ae,le),k=new jA(Oe),Ee=new MC(f,xe,be,ye,ae,G,k),Pe=new zC(Oe),Xe=new RC,et=new DC(ye,ae),fe=new VA(f,xe,Ae,we,r,a),P=new FC(f,we,ae),me=new zA(L,ye,Ie,ae),Z=new oC(L,ye,Ie,ae),Ie.programs=Ee.programs,f.capabilities=ae,f.extensions=ye,f.properties=Oe,f.renderLists=Xe,f.shadowMap=P,f.state=Ae,f.info=Ie}se();let ve=new c4(f,L);this.xr=ve,this.getContext=function(){return L},this.getContextAttributes=function(){return L.getContextAttributes()},this.forceContextLoss=function(){let I=ye.get("WEBGL_lose_context");I&&I.loseContext()},this.forceContextRestore=function(){let I=ye.get("WEBGL_lose_context");I&&I.restoreContext()},this.getPixelRatio=function(){return C},this.setPixelRatio=function(I){I!==void 0&&(C=I,this.setSize(w,O,!1))},this.getSize=function(I){return I.set(w,O)},this.setSize=function(I,re,ue){if(ve.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}w=I,O=re,e.width=Math.floor(I*C),e.height=Math.floor(re*C),ue!==!1&&(e.style.width=I+"px",e.style.height=re+"px"),this.setViewport(0,0,I,re)},this.getDrawingBufferSize=function(I){return I.set(w*C,O*C).floor()},this.setDrawingBufferSize=function(I,re,ue){w=I,O=re,C=ue,e.width=Math.floor(I*ue),e.height=Math.floor(re*ue),this.setViewport(0,0,I,re)},this.getCurrentViewport=function(I){return I.copy(A)},this.getViewport=function(I){return I.copy(D)},this.setViewport=function(I,re,ue,ie){I.isVector4?D.set(I.x,I.y,I.z,I.w):D.set(I,re,ue,ie),Ae.viewport(A.copy(D).multiplyScalar(C).floor())},this.getScissor=function(I){return I.copy(V)},this.setScissor=function(I,re,ue,ie){I.isVector4?V.set(I.x,I.y,I.z,I.w):V.set(I,re,ue,ie),Ae.scissor(E.copy(V).multiplyScalar(C).floor())},this.getScissorTest=function(){return F},this.setScissorTest=function(I){Ae.setScissorTest(F=I)},this.setOpaqueSort=function(I){N=I},this.setTransparentSort=function(I){R=I},this.getClearColor=function(I){return I.copy(fe.getClearColor())},this.setClearColor=function(){fe.setClearColor.apply(fe,arguments)},this.getClearAlpha=function(){return fe.getClearAlpha()},this.setClearAlpha=function(){fe.setClearAlpha.apply(fe,arguments)},this.clear=function(I,re,ue){let ie=0;(I===void 0||I)&&(ie|=L.COLOR_BUFFER_BIT),(re===void 0||re)&&(ie|=L.DEPTH_BUFFER_BIT),(ue===void 0||ue)&&(ie|=L.STENCIL_BUFFER_BIT),L.clear(ie)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",Fe,!1),e.removeEventListener("webglcontextrestored",q,!1),Xe.dispose(),et.dispose(),Oe.dispose(),xe.dispose(),be.dispose(),we.dispose(),G.dispose(),Ee.dispose(),ve.dispose(),ve.removeEventListener("sessionstart",tt),ve.removeEventListener("sessionend",nr),H&&(H.dispose(),H=null),Oo.stop()};function Fe(I){I.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),v=!0}function q(){console.log("THREE.WebGLRenderer: Context Restored."),v=!1;let I=Ie.autoReset,re=P.enabled,ue=P.autoUpdate,ie=P.needsUpdate,ge=P.type;se(),Ie.autoReset=I,P.enabled=re,P.autoUpdate=ue,P.needsUpdate=ie,P.type=ge}function Le(I){let re=I.target;re.removeEventListener("dispose",Le),Me(re)}function Me(I){Ze(I),Oe.remove(I)}function Ze(I){let re=Oe.get(I).programs;re!==void 0&&(re.forEach(function(ue){Ee.releaseProgram(ue)}),I.isShaderMaterial&&Ee.releaseShaderCache(I))}this.renderBufferDirect=function(I,re,ue,ie,ge,ot){re===null&&(re=X);let nt=ge.isMesh&&ge.matrixWorld.determinant()<0,mt=nG(I,re,ue,ie,ge);Ae.setMaterial(ie,nt);let dt=ue.index,Wt=ue.attributes.position;if(dt===null){if(Wt===void 0||Wt.count===0)return}else if(dt.count===0)return;let wt=1;ie.wireframe===!0&&(dt=he.getWireframeAttribute(ue),wt=2),G.setup(ge,ie,mt,ue,dt);let Rt,Er=me;dt!==null&&(Rt=ne.get(dt),Er=Z,Er.setIndex(Rt));let fc=dt!==null?dt.count:Wt.count,su=ue.drawRange.start*wt,Bt=ue.drawRange.count*wt,vs=ot!==null?ot.start*wt:0,jr=ot!==null?ot.count*wt:1/0,ys=Math.max(su,vs),zm=Math.min(fc,su+Bt,vs+jr)-1,xs=Math.max(0,zm-ys+1);if(xs!==0){if(ge.isMesh)ie.wireframe===!0?(Ae.setLineWidth(ie.wireframeLinewidth*W()),Er.setMode(L.LINES)):Er.setMode(L.TRIANGLES);else if(ge.isLine){let r0=ie.linewidth;r0===void 0&&(r0=1),Ae.setLineWidth(r0*W()),ge.isLineSegments?Er.setMode(L.LINES):ge.isLineLoop?Er.setMode(L.LINE_LOOP):Er.setMode(L.LINE_STRIP)}else ge.isPoints?Er.setMode(L.POINTS):ge.isSprite&&Er.setMode(L.TRIANGLES);if(ge.isInstancedMesh)Er.renderInstances(ys,xs,ge.count);else if(ue.isInstancedBufferGeometry){let r0=Math.min(ue.instanceCount,ue._maxInstanceCount);Er.renderInstances(ys,xs,r0)}else Er.render(ys,xs)}},this.compile=function(I,re){d=et.get(I),d.init(),m.push(d),I.traverseVisible(function(ue){ue.isLight&&ue.layers.test(re.layers)&&(d.pushLight(ue),ue.castShadow&&d.pushShadow(ue))}),d.setupLights(f.physicallyCorrectLights),I.traverse(function(ue){let ie=ue.material;if(ie)if(Array.isArray(ie))for(let ge=0;ge<ie.length;ge++){let ot=ie[ge];y3(ot,I,ue)}else y3(ie,I,ue)}),m.pop(),d=null};let _e=null;function He(I){_e&&_e(I)}function tt(){Oo.stop()}function nr(){Oo.start()}let Oo=new b1;Oo.setAnimationLoop(He),typeof window<"u"&&Oo.setContext(window),this.setAnimationLoop=function(I){_e=I,ve.setAnimationLoop(I),I===null?Oo.stop():Oo.start()},ve.addEventListener("sessionstart",tt),ve.addEventListener("sessionend",nr),this.render=function(I,re){if(re!==void 0&&re.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(v===!0)return;I.autoUpdate===!0&&I.updateMatrixWorld(),re.parent===null&&re.updateMatrixWorld(),ve.enabled===!0&&ve.isPresenting===!0&&(ve.cameraAutoUpdate===!0&&ve.updateCamera(re),re=ve.getCamera()),I.isScene===!0&&I.onBeforeRender(f,I,re,T),d=et.get(I,m.length),d.init(),m.push(d),B.multiplyMatrices(re.projectionMatrix,re.matrixWorldInverse),j.setFromProjectionMatrix(B),Y=this.localClippingEnabled,$=k.init(this.clippingPlanes,Y,re),p=Xe.get(I,h.length),p.init(),h.push(p),Cr(I,re,0,f.sortObjects),p.finish(),f.sortObjects===!0&&p.sort(N,R),$===!0&&k.beginShadows();let ue=d.state.shadowsArray;if(P.render(ue,I,re),$===!0&&k.endShadows(),this.info.autoReset===!0&&this.info.reset(),fe.render(p,I),d.setupLights(f.physicallyCorrectLights),re.isArrayCamera){let ie=re.cameras;for(let ge=0,ot=ie.length;ge<ot;ge++){let nt=ie[ge];gs(p,I,nt,nt.viewport)}}else gs(p,I,re);T!==null&&(le.updateMultisampleRenderTarget(T),le.updateRenderTargetMipmap(T)),I.isScene===!0&&I.onAfterRender(f,I,re),Ae.buffers.depth.setTest(!0),Ae.buffers.depth.setMask(!0),Ae.buffers.color.setMask(!0),Ae.setPolygonOffset(!1),G.resetDefaultState(),b=-1,x=null,m.pop(),m.length>0?d=m[m.length-1]:d=null,h.pop(),h.length>0?p=h[h.length-1]:p=null};function Cr(I,re,ue,ie){if(I.visible===!1)return;if(I.layers.test(re.layers)){if(I.isGroup)ue=I.renderOrder;else if(I.isLOD)I.autoUpdate===!0&&I.update(re);else if(I.isLight)d.pushLight(I),I.castShadow&&d.pushShadow(I);else if(I.isSprite){if(!I.frustumCulled||j.intersectsSprite(I)){ie&&te.setFromMatrixPosition(I.matrixWorld).applyMatrix4(B);let nt=we.update(I),mt=I.material;mt.visible&&p.push(I,nt,mt,ue,te.z,null)}}else if((I.isMesh||I.isLine||I.isPoints)&&(I.isSkinnedMesh&&I.skeleton.frame!==Ie.render.frame&&(I.skeleton.update(),I.skeleton.frame=Ie.render.frame),!I.frustumCulled||j.intersectsObject(I))){ie&&te.setFromMatrixPosition(I.matrixWorld).applyMatrix4(B);let nt=we.update(I),mt=I.material;if(Array.isArray(mt)){let dt=nt.groups;for(let Wt=0,wt=dt.length;Wt<wt;Wt++){let Rt=dt[Wt],Er=mt[Rt.materialIndex];Er&&Er.visible&&p.push(I,nt,Er,ue,te.z,Rt)}}else mt.visible&&p.push(I,nt,mt,ue,te.z,null)}}let ot=I.children;for(let nt=0,mt=ot.length;nt<mt;nt++)Cr(ot[nt],re,ue,ie)}function gs(I,re,ue,ie){let ge=I.opaque,ot=I.transmissive,nt=I.transparent;d.setupLightsView(ue),ot.length>0&&t0(ge,re,ue),ie&&Ae.viewport(A.copy(ie)),ge.length>0&&Gm(ge,re,ue),ot.length>0&&Gm(ot,re,ue),nt.length>0&&Gm(nt,re,ue)}function t0(I,re,ue){if(H===null){let nt=s===!0&&ae.isWebGL2===!0?Z0:yr;H=new nt(1024,1024,{generateMipmaps:!0,type:Se.convert(qr)!==null?qr:Wo,minFilter:Ri,magFilter:it,wrapS:Ft,wrapT:Ft,useRenderToTexture:ye.has("WEBGL_multisampled_render_to_texture")})}let ie=f.getRenderTarget();f.setRenderTarget(H),f.clear();let ge=f.toneMapping;f.toneMapping=Ro,Gm(I,re,ue),f.toneMapping=ge,le.updateMultisampleRenderTarget(H),le.updateRenderTargetMipmap(H),f.setRenderTarget(ie)}function Gm(I,re,ue){let ie=re.isScene===!0?re.overrideMaterial:null;for(let ge=0,ot=I.length;ge<ot;ge++){let nt=I[ge],mt=nt.object,dt=nt.geometry,Wt=ie===null?nt.material:ie,wt=nt.group;mt.layers.test(ue.layers)&&oG(mt,re,ue,dt,Wt,wt)}}function oG(I,re,ue,ie,ge,ot){I.onBeforeRender(f,re,ue,ie,ge,ot),I.modelViewMatrix.multiplyMatrices(ue.matrixWorldInverse,I.matrixWorld),I.normalMatrix.getNormalMatrix(I.modelViewMatrix),ge.onBeforeRender(f,re,ue,ie,I,ot),ge.transparent===!0&&ge.side===Wr?(ge.side=Mt,ge.needsUpdate=!0,f.renderBufferDirect(ue,re,ie,ge,I,ot),ge.side=gr,ge.needsUpdate=!0,f.renderBufferDirect(ue,re,ie,ge,I,ot),ge.side=Wr):f.renderBufferDirect(ue,re,ie,ge,I,ot),I.onAfterRender(f,re,ue,ie,ge,ot)}function y3(I,re,ue){re.isScene!==!0&&(re=X);let ie=Oe.get(I),ge=d.state.lights,ot=d.state.shadowsArray,nt=ge.state.version,mt=Ee.getParameters(I,ge.state,ot,re,ue),dt=Ee.getProgramCacheKey(mt),Wt=ie.programs;ie.environment=I.isMeshStandardMaterial?re.environment:null,ie.fog=re.fog,ie.envMap=(I.isMeshStandardMaterial?be:xe).get(I.envMap||ie.environment),Wt===void 0&&(I.addEventListener("dispose",Le),Wt=new Map,ie.programs=Wt);let wt=Wt.get(dt);if(wt!==void 0){if(ie.currentProgram===wt&&ie.lightsStateVersion===nt)return bx(I,mt),wt}else mt.uniforms=Ee.getUniforms(I),I.onBuild(ue,mt,f),I.onBeforeCompile(mt,f),wt=Ee.acquireProgram(mt,dt),Wt.set(dt,wt),ie.uniforms=mt.uniforms;let Rt=ie.uniforms;(!I.isShaderMaterial&&!I.isRawShaderMaterial||I.clipping===!0)&&(Rt.clippingPlanes=k.uniform),bx(I,mt),ie.needsLights=sG(I),ie.lightsStateVersion=nt,ie.needsLights&&(Rt.ambientLightColor.value=ge.state.ambient,Rt.lightProbe.value=ge.state.probe,Rt.directionalLights.value=ge.state.directional,Rt.directionalLightShadows.value=ge.state.directionalShadow,Rt.spotLights.value=ge.state.spot,Rt.spotLightShadows.value=ge.state.spotShadow,Rt.rectAreaLights.value=ge.state.rectArea,Rt.ltc_1.value=ge.state.rectAreaLTC1,Rt.ltc_2.value=ge.state.rectAreaLTC2,Rt.pointLights.value=ge.state.point,Rt.pointLightShadows.value=ge.state.pointShadow,Rt.hemisphereLights.value=ge.state.hemi,Rt.directionalShadowMap.value=ge.state.directionalShadowMap,Rt.directionalShadowMatrix.value=ge.state.directionalShadowMatrix,Rt.spotShadowMap.value=ge.state.spotShadowMap,Rt.spotShadowMatrix.value=ge.state.spotShadowMatrix,Rt.pointShadowMap.value=ge.state.pointShadowMap,Rt.pointShadowMatrix.value=ge.state.pointShadowMatrix);let Er=wt.getUniforms(),fc=Ss.seqWithValue(Er.seq,Rt);return ie.currentProgram=wt,ie.uniformsList=fc,wt}function bx(I,re){let ue=Oe.get(I);ue.outputEncoding=re.outputEncoding,ue.instancing=re.instancing,ue.skinning=re.skinning,ue.morphTargets=re.morphTargets,ue.morphNormals=re.morphNormals,ue.morphTargetsCount=re.morphTargetsCount,ue.numClippingPlanes=re.numClippingPlanes,ue.numIntersection=re.numClipIntersection,ue.vertexAlphas=re.vertexAlphas,ue.vertexTangents=re.vertexTangents,ue.toneMapping=re.toneMapping}function nG(I,re,ue,ie,ge){re.isScene!==!0&&(re=X),le.resetTextureUnits();let ot=re.fog,nt=ie.isMeshStandardMaterial?re.environment:null,mt=T===null?f.outputEncoding:T.isXRRenderTarget===!0?T.texture.encoding:Xr,dt=(ie.isMeshStandardMaterial?be:xe).get(ie.envMap||nt),Wt=ie.vertexColors===!0&&!!ue.attributes.color&&ue.attributes.color.itemSize===4,wt=!!ie.normalMap&&!!ue.attributes.tangent,Rt=!!ue.morphAttributes.position,Er=!!ue.morphAttributes.normal,fc=ue.morphAttributes.position?ue.morphAttributes.position.length:0,su=ie.toneMapped?f.toneMapping:Ro,Bt=Oe.get(ie),vs=d.state.lights;if($===!0&&(Y===!0||I!==x)){let Mi=I===x&&ie.id===b;k.setState(ie,I,Mi)}let jr=!1;ie.version===Bt.__version?(Bt.needsLights&&Bt.lightsStateVersion!==vs.state.version||Bt.outputEncoding!==mt||ge.isInstancedMesh&&Bt.instancing===!1||!ge.isInstancedMesh&&Bt.instancing===!0||ge.isSkinnedMesh&&Bt.skinning===!1||!ge.isSkinnedMesh&&Bt.skinning===!0||Bt.envMap!==dt||ie.fog&&Bt.fog!==ot||Bt.numClippingPlanes!==void 0&&(Bt.numClippingPlanes!==k.numPlanes||Bt.numIntersection!==k.numIntersection)||Bt.vertexAlphas!==Wt||Bt.vertexTangents!==wt||Bt.morphTargets!==Rt||Bt.morphNormals!==Er||Bt.toneMapping!==su||ae.isWebGL2===!0&&Bt.morphTargetsCount!==fc)&&(jr=!0):(jr=!0,Bt.__version=ie.version);let ys=Bt.currentProgram;jr===!0&&(ys=y3(ie,re,ge));let zm=!1,xs=!1,r0=!1,Po=ys.getUniforms(),Ud=Bt.uniforms;if(Ae.useProgram(ys.program)&&(zm=!0,xs=!0,r0=!0),ie.id!==b&&(b=ie.id,xs=!0),zm||x!==I){if(Po.setValue(L,"projectionMatrix",I.projectionMatrix),ae.logarithmicDepthBuffer&&Po.setValue(L,"logDepthBufFC",2/(Math.log(I.far+1)/Math.LN2)),x!==I&&(x=I,xs=!0,r0=!0),ie.isShaderMaterial||ie.isMeshPhongMaterial||ie.isMeshToonMaterial||ie.isMeshStandardMaterial||ie.envMap){let Mi=Po.map.cameraPosition;Mi!==void 0&&Mi.setValue(L,te.setFromMatrixPosition(I.matrixWorld))}(ie.isMeshPhongMaterial||ie.isMeshToonMaterial||ie.isMeshLambertMaterial||ie.isMeshBasicMaterial||ie.isMeshStandardMaterial||ie.isShaderMaterial)&&Po.setValue(L,"isOrthographic",I.isOrthographicCamera===!0),(ie.isMeshPhongMaterial||ie.isMeshToonMaterial||ie.isMeshLambertMaterial||ie.isMeshBasicMaterial||ie.isMeshStandardMaterial||ie.isShaderMaterial||ie.isShadowMaterial||ge.isSkinnedMesh)&&Po.setValue(L,"viewMatrix",I.matrixWorldInverse)}if(ge.isSkinnedMesh){Po.setOptional(L,ge,"bindMatrix"),Po.setOptional(L,ge,"bindMatrixInverse");let Mi=ge.skeleton;Mi&&(ae.floatVertexTextures?(Mi.boneTexture===null&&Mi.computeBoneTexture(),Po.setValue(L,"boneTexture",Mi.boneTexture,le),Po.setValue(L,"boneTextureSize",Mi.boneTextureSize)):Po.setOptional(L,Mi,"boneMatrices"))}return!!ue&&(ue.morphAttributes.position!==void 0||ue.morphAttributes.normal!==void 0)&&ee.update(ge,ue,ie,ys),(xs||Bt.receiveShadow!==ge.receiveShadow)&&(Bt.receiveShadow=ge.receiveShadow,Po.setValue(L,"receiveShadow",ge.receiveShadow)),xs&&(Po.setValue(L,"toneMappingExposure",f.toneMappingExposure),Bt.needsLights&&iG(Ud,r0),ot&&ie.fog&&Pe.refreshFogUniforms(Ud,ot),Pe.refreshMaterialUniforms(Ud,ie,C,O,H),Ss.upload(L,Bt.uniformsList,Ud,le)),ie.isShaderMaterial&&ie.uniformsNeedUpdate===!0&&(Ss.upload(L,Bt.uniformsList,Ud,le),ie.uniformsNeedUpdate=!1),ie.isSpriteMaterial&&Po.setValue(L,"center",ge.center),Po.setValue(L,"modelViewMatrix",ge.modelViewMatrix),Po.setValue(L,"normalMatrix",ge.normalMatrix),Po.setValue(L,"modelMatrix",ge.matrixWorld),ys}function iG(I,re){I.ambientLightColor.needsUpdate=re,I.lightProbe.needsUpdate=re,I.directionalLights.needsUpdate=re,I.directionalLightShadows.needsUpdate=re,I.pointLights.needsUpdate=re,I.pointLightShadows.needsUpdate=re,I.spotLights.needsUpdate=re,I.spotLightShadows.needsUpdate=re,I.rectAreaLights.needsUpdate=re,I.hemisphereLights.needsUpdate=re}function sG(I){return I.isMeshLambertMaterial||I.isMeshToonMaterial||I.isMeshPhongMaterial||I.isMeshStandardMaterial||I.isShadowMaterial||I.isShaderMaterial&&I.lights===!0}this.getActiveCubeFace=function(){return g},this.getActiveMipmapLevel=function(){return _},this.getRenderTarget=function(){return T},this.setRenderTargetTextures=function(I,re,ue){Oe.get(I.texture).__webglTexture=re,Oe.get(I.depthTexture).__webglTexture=ue;let ie=Oe.get(I);ie.__hasExternalTextures=!0,ie.__hasExternalTextures&&(ie.__autoAllocateDepthBuffer=ue===void 0,ie.__autoAllocateDepthBuffer||I.useRenderToTexture&&(console.warn("render-to-texture extension was disabled because an external texture was provided"),I.useRenderToTexture=!1,I.useRenderbuffer=!0))},this.setRenderTargetFramebuffer=function(I,re){let ue=Oe.get(I);ue.__webglFramebuffer=re,ue.__useDefaultFramebuffer=re===void 0},this.setRenderTarget=function(I,re=0,ue=0){T=I,g=re,_=ue;let ie=!0;if(I){let dt=Oe.get(I);dt.__useDefaultFramebuffer!==void 0?(Ae.bindFramebuffer(L.FRAMEBUFFER,null),ie=!1):dt.__webglFramebuffer===void 0?le.setupRenderTarget(I):dt.__hasExternalTextures&&le.rebindTextures(I,Oe.get(I.texture).__webglTexture,Oe.get(I.depthTexture).__webglTexture)}let ge=null,ot=!1,nt=!1;if(I){let dt=I.texture;(dt.isDataTexture3D||dt.isDataTexture2DArray)&&(nt=!0);let Wt=Oe.get(I).__webglFramebuffer;I.isWebGLCubeRenderTarget?(ge=Wt[re],ot=!0):I.useRenderbuffer?ge=Oe.get(I).__webglMultisampledFramebuffer:ge=Wt,A.copy(I.viewport),E.copy(I.scissor),S=I.scissorTest}else A.copy(D).multiplyScalar(C).floor(),E.copy(V).multiplyScalar(C).floor(),S=F;if(Ae.bindFramebuffer(L.FRAMEBUFFER,ge)&&ae.drawBuffers&&ie&&Ae.drawBuffers(I,ge),Ae.viewport(A),Ae.scissor(E),Ae.setScissorTest(S),ot){let dt=Oe.get(I.texture);L.framebufferTexture2D(L.FRAMEBUFFER,L.COLOR_ATTACHMENT0,L.TEXTURE_CUBE_MAP_POSITIVE_X+re,dt.__webglTexture,ue)}else if(nt){let dt=Oe.get(I.texture),Wt=re||0;L.framebufferTextureLayer(L.FRAMEBUFFER,L.COLOR_ATTACHMENT0,dt.__webglTexture,ue||0,Wt)}b=-1},this.readRenderTargetPixels=function(I,re,ue,ie,ge,ot,nt){if(!(I&&I.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let mt=Oe.get(I).__webglFramebuffer;if(I.isWebGLCubeRenderTarget&&nt!==void 0&&(mt=mt[nt]),mt){Ae.bindFramebuffer(L.FRAMEBUFFER,mt);try{let dt=I.texture,Wt=dt.format,wt=dt.type;if(Wt!==at&&Se.convert(Wt)!==L.getParameter(L.IMPLEMENTATION_COLOR_READ_FORMAT)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}let Rt=wt===qr&&(ye.has("EXT_color_buffer_half_float")||ae.isWebGL2&&ye.has("EXT_color_buffer_float"));if(wt!==Wo&&Se.convert(wt)!==L.getParameter(L.IMPLEMENTATION_COLOR_READ_TYPE)&&!(wt===qt&&(ae.isWebGL2||ye.has("OES_texture_float")||ye.has("WEBGL_color_buffer_float")))&&!Rt){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}L.checkFramebufferStatus(L.FRAMEBUFFER)===L.FRAMEBUFFER_COMPLETE?re>=0&&re<=I.width-ie&&ue>=0&&ue<=I.height-ge&&L.readPixels(re,ue,ie,ge,Se.convert(Wt),Se.convert(wt),ot):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{let dt=T!==null?Oe.get(T).__webglFramebuffer:null;Ae.bindFramebuffer(L.FRAMEBUFFER,dt)}}},this.copyFramebufferToTexture=function(I,re,ue=0){if(re.isFramebufferTexture!==!0){console.error("THREE.WebGLRenderer: copyFramebufferToTexture() can only be used with FramebufferTexture.");return}let ie=Math.pow(2,-ue),ge=Math.floor(re.image.width*ie),ot=Math.floor(re.image.height*ie);le.setTexture2D(re,0),L.copyTexSubImage2D(L.TEXTURE_2D,ue,0,0,I.x,I.y,ge,ot),Ae.unbindTexture()},this.copyTextureToTexture=function(I,re,ue,ie=0){let ge=re.image.width,ot=re.image.height,nt=Se.convert(ue.format),mt=Se.convert(ue.type);le.setTexture2D(ue,0),L.pixelStorei(L.UNPACK_FLIP_Y_WEBGL,ue.flipY),L.pixelStorei(L.UNPACK_PREMULTIPLY_ALPHA_WEBGL,ue.premultiplyAlpha),L.pixelStorei(L.UNPACK_ALIGNMENT,ue.unpackAlignment),re.isDataTexture?L.texSubImage2D(L.TEXTURE_2D,ie,I.x,I.y,ge,ot,nt,mt,re.image.data):re.isCompressedTexture?L.compressedTexSubImage2D(L.TEXTURE_2D,ie,I.x,I.y,re.mipmaps[0].width,re.mipmaps[0].height,nt,re.mipmaps[0].data):L.texSubImage2D(L.TEXTURE_2D,ie,I.x,I.y,nt,mt,re.image),ie===0&&ue.generateMipmaps&&L.generateMipmap(L.TEXTURE_2D),Ae.unbindTexture()},this.copyTextureToTexture3D=function(I,re,ue,ie,ge=0){if(f.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}let ot=I.max.x-I.min.x+1,nt=I.max.y-I.min.y+1,mt=I.max.z-I.min.z+1,dt=Se.convert(ie.format),Wt=Se.convert(ie.type),wt;if(ie.isDataTexture3D)le.setTexture3D(ie,0),wt=L.TEXTURE_3D;else if(ie.isDataTexture2DArray)le.setTexture2DArray(ie,0),wt=L.TEXTURE_2D_ARRAY;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}L.pixelStorei(L.UNPACK_FLIP_Y_WEBGL,ie.flipY),L.pixelStorei(L.UNPACK_PREMULTIPLY_ALPHA_WEBGL,ie.premultiplyAlpha),L.pixelStorei(L.UNPACK_ALIGNMENT,ie.unpackAlignment);let Rt=L.getParameter(L.UNPACK_ROW_LENGTH),Er=L.getParameter(L.UNPACK_IMAGE_HEIGHT),fc=L.getParameter(L.UNPACK_SKIP_PIXELS),su=L.getParameter(L.UNPACK_SKIP_ROWS),Bt=L.getParameter(L.UNPACK_SKIP_IMAGES),vs=ue.isCompressedTexture?ue.mipmaps[0]:ue.image;L.pixelStorei(L.UNPACK_ROW_LENGTH,vs.width),L.pixelStorei(L.UNPACK_IMAGE_HEIGHT,vs.height),L.pixelStorei(L.UNPACK_SKIP_PIXELS,I.min.x),L.pixelStorei(L.UNPACK_SKIP_ROWS,I.min.y),L.pixelStorei(L.UNPACK_SKIP_IMAGES,I.min.z),ue.isDataTexture||ue.isDataTexture3D?L.texSubImage3D(wt,ge,re.x,re.y,re.z,ot,nt,mt,dt,Wt,vs.data):ue.isCompressedTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),L.compressedTexSubImage3D(wt,ge,re.x,re.y,re.z,ot,nt,mt,dt,vs.data)):L.texSubImage3D(wt,ge,re.x,re.y,re.z,ot,nt,mt,dt,Wt,vs),L.pixelStorei(L.UNPACK_ROW_LENGTH,Rt),L.pixelStorei(L.UNPACK_IMAGE_HEIGHT,Er),L.pixelStorei(L.UNPACK_SKIP_PIXELS,fc),L.pixelStorei(L.UNPACK_SKIP_ROWS,su),L.pixelStorei(L.UNPACK_SKIP_IMAGES,Bt),ge===0&&ie.generateMipmaps&&L.generateMipmap(wt),Ae.unbindTexture()},this.initTexture=function(I){le.setTexture2D(I,0),Ae.unbindTexture()},this.resetState=function(){g=0,_=0,T=null,Ae.reset(),G.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}l4.prototype.isWebGLRenderer=!0;var HC={};var u4=class{constructor(){this._next_renderer_id=0,this._renderers=new Map,this._firstRenderer=null,this._printDebug=!1,this._require_webgl2=!1,this._resolves=[]}setPrintDebug(e=!0){this._printDebug=e}printDebug(){return this._printDebug}printDebugMessage(e){!this._printDebug||console.warn("[Poly debug]",e)}setRequireWebGL2(){this._require_webgl2||(this._require_webgl2=!0)}webgl2Available(){return this._webgl2_available===void 0&&(this._webgl2_available=this._set_webgl2_available()),this._webgl2_available}_set_webgl2_available(){let e=document.createElement("canvas");return(window.WebGL2RenderingContext&&e.getContext("webgl2"))!=null}createWebGLRenderer(e){let t=new l4(e);return this.printDebugMessage(["create renderer:",e]),t}getRenderingContext(e){let t=null;return this._require_webgl2&&(t=this._getRenderingContextWebgl(e,!0),t||console.warn("failed to create webgl2 context")),t||(t=this._getRenderingContextWebgl(e,!1)),t}_getRenderingContextWebgl(e,t){let r;this.webgl2Available()?r="webgl2":r=t?"webgl2":"webgl";let n=e.getContext(r,HC);return n?this.printDebugMessage(`create gl context: ${r}.`):(r=t?"experimental-webgl2":"experimental-webgl",this.printDebugMessage(`create gl context: ${r}.`),n=e.getContext(r,HC)),n}registerRenderer(e){if(e._polygonId)throw new Error("render already registered");let t=this._next_renderer_id+=1;e._polygonId=t,this._renderers.set(t,e),this._renderers.size==1&&this._flushCallbacksWithRenderer(e),this._updateCache()}deregisterRenderer(e){let t=e._polygonId;this._renderers.delete(t),e.dispose(),this._updateCache()}deregisterAllRenderers(){let e=[];this._renderers.forEach((t,r)=>{e.push(t)});for(let t of e)this.deregisterRenderer(t)}_updateCache(){this._firstRenderer=null,this._renderers.forEach(e=>{this._firstRenderer=this._firstRenderer||e})}firstRenderer(){return this._firstRenderer}renderers(){return Object.values(this._renderers)}_flushCallbacksWithRenderer(e){let t=[];for(let r of this._resolves)t.push(r);this._resolves=[];for(let r of t)r(e)}async waitForRenderer(){let e=this.firstRenderer();return e||new Promise((t,r)=>{this._resolves.push(t)})}renderTarget(e,t,r){return this.webgl2Available()?new Z0(e,t,r):new yr(e,t,r)}};var p4=class{constructor(){this._root="/three/js/libs",this._KTX2Path="/ktx2",this._DRACOPath="/draco",this._DRACOGLTFPath="/draco/gltf"}root(){return this._root}setRoot(e){this._root=e}KTX2Path(){return this._KTX2Path}DRACOPath(){return this._DRACOPath}DRACOGLTFPath(){return this._DRACOGLTFPath}};var Di=class{constructor(e){this.poly=e,this._node_register=new Map,this._node_register_categories=new Map,this._node_register_options=new Map}static type(e){return this.filterType(e.type())}static filterType(e){return e.toLowerCase()}register(e,t,r){let n=e.context(),i=Di.type(e),s=this._node_register.get(n);if(s||(s=new Map,this._node_register.set(n,s)),s.get(i)){console.error(`node ${n}/${i} already registered`);return}if(s.set(i,e),t){let c=this._node_register_categories.get(n);c||(c=new Map,this._node_register_categories.set(n,c)),c.set(i,t)}if(r){let c=this._node_register_options.get(n);c||(c=new Map,this._node_register_options.set(n,c)),c.set(i,r)}this.poly.pluginsRegister.registerNode(e)}deregister(e,t){var r,n,i;t=Di.filterType(t),(r=this._node_register.get(e))==null||r.delete(t),(n=this._node_register_categories.get(e))==null||n.delete(t),(i=this._node_register_options.get(e))==null||i.delete(t)}isRegistered(e,t){let r=this._node_register.get(e);return r?(t=Di.filterType(t),r.get(t)!=null):!1}nodeOptions(e,t){var r;return t=Di.filterType(t),(r=this._node_register_options.get(e))==null?void 0:r.get(t)}registeredNodesForContextAndParentType(e,t){var r;if(this._node_register.get(e)){let i=[];return(r=this._node_register.get(e))==null||r.forEach((s,a)=>{i.push(s)}),i.filter(s=>{var a;let c=Di.type(s),l=(a=this._node_register_options.get(e))==null?void 0:a.get(c);if(l){let u=l.only,p=l.except,d=`${e}/${t}`;return u?u.includes(d):p?!p.includes(d):!0}else return!0})}else return[]}registeredNodes(e,t){let r={},n=this.registeredNodesForContextAndParentType(e,t);for(let i of n){let s=Di.type(i);r[s]=i}return r}registeredCategory(e,t){var r;return t=Di.filterType(t),(r=this._node_register_categories.get(e))==null?void 0:r.get(t)}map(){return this._node_register}},wu=class{constructor(e){this.poly=e,this._operation_register=new Map}static type(e){return this.filterType(e.type())}static filterType(e){return e.toLowerCase()}register(e){let t=e.context(),r=this._operation_register.get(t);r||(r=new Map,this._operation_register.set(t,r));let n=wu.type(e);if(r.get(n)){let s=`operation ${t}/${n} already registered`;console.error(s);return}r.set(n,e),this.poly.pluginsRegister.registerOperation(e)}registeredOperationsForContextAndParentType(e,t){var r;if(this._operation_register.get(e)){let i=[];return(r=this._operation_register.get(e))==null||r.forEach((s,a)=>{i.push(s)}),i}else return[]}registeredOperation(e,t){let r=this._operation_register.get(e);if(r)return t=wu.filterType(t),r.get(t)}};var d4=class{constructor(){this._methods_names=[],this._methods_by_name=new Map}register(e,t){this._methods_names.push(t),this._methods_by_name.set(t,e)}getMethod(e){return this._methods_by_name.get(e)}availableMethods(){return this._methods_names}};var h4=class extends d4{getMethod(e){return super.getMethod(e)}};var f4=class{constructor(){this._module_by_name=new Map}register(e,t){this._module_by_name.set(e,t)}moduleNames(){let e=[];return this._module_by_name.forEach((t,r)=>{e.push(r)}),e}module(e){return this._module_by_name.get(e)}};var m4=class extends f4{};var Pn=(o=>(o.GL_MESH_BASIC="GL_MESH_BASIC",o.GL_MESH_LAMBERT="GL_MESH_LAMBERT",o.GL_MESH_STANDARD="GL_MESH_STANDARD",o.GL_MESH_PHONG="GL_MESH_PHONG",o.GL_MESH_PHYSICAL="GL_MESH_PHYSICAL",o.GL_MESH_DEPTH="GL_MESH_DEPTH",o.GL_MESH_DISTANCE="GL_MESH_DISTANCE",o.GL_PARTICLES="GL_PARTICLES",o.GL_POINTS="GL_POINTS",o.GL_LINE="GL_LINE",o.GL_TEXTURE="GL_TEXTURE",o.GL_VOLUME="GL_VOLUME",o))(Pn||{}),_4=class{constructor(){this._controllerAssemblerByName=new Map}register(e,t,r){this._controllerAssemblerByName.set(e,{controller:t,assembler:r})}unregister(e){this._controllerAssemblerByName.delete(e)}traverse(e){this._controllerAssemblerByName.forEach(e)}};var g4=class extends _4{assembler(e,t){let r=this._controllerAssemblerByName.get(t);if(r){let n=r.controller,i=r.assembler;return new n(e,i)}return r}unregister(e){let t=this._controllerAssemblerByName.get(e);return super.unregister(e),t}};var v4=class{constructor(e){this.poly=e,this._plugins_by_name=new Map,this._plugin_name_by_node_context_by_type=new Map,this._plugin_name_by_operation_context_by_type=new Map}register(e){this._current_plugin=e,this._plugins_by_name.set(e.name(),e),e.init(this.poly),this._current_plugin=void 0}pluginByName(e){return this._plugins_by_name.get(e)}registerNode(e){if(!this._current_plugin)return;let t=e.context(),r=e.type(),n=this._plugin_name_by_node_context_by_type.get(t);n||(n=new Map,this._plugin_name_by_node_context_by_type.set(t,n)),n.set(r,this._current_plugin.name())}registerOperation(e){if(!this._current_plugin)return;let t=e.context(),r=e.type(),n=this._plugin_name_by_operation_context_by_type.get(t);n||(n=new Map,this._plugin_name_by_operation_context_by_type.set(t,n)),n.set(r,this._current_plugin.name())}toJson(){let e={plugins:{},nodes:{},operations:{}};return this._plugins_by_name.forEach((t,r)=>{e.plugins[r]=t.toJSON()}),this._plugin_name_by_node_context_by_type.forEach((t,r)=>{e.nodes[r]={},t.forEach((n,i)=>{e.nodes[r][i]=n})}),this._plugin_name_by_operation_context_by_type.forEach((t,r)=>{e.operations[r]={},t.forEach((n,i)=>{e.operations[r][i]=n})}),e}};var y4=class{constructor(e){this._camera_types=[]}register(e){let t=e.type();this._camera_types.includes(t)||this._camera_types.push(t)}registeredTypes(){return this._camera_types}};function jC(o){return(window.URL||window.webkitURL).createObjectURL(o)}var x4=class{constructor(){this._blobWrappersByUrl=new Map}recording(){return!Q.playerMode()}blobUrl(e){var t;return(t=this._blobWrappersByUrl.get(e))==null?void 0:t.blobUrl}clear(){this._blobWrappersByUrl.clear()}clearBlobsForNode(e){let t=[],r=e.graphNodeId();this._blobWrappersByUrl.forEach((n,i)=>{n.referringNodeIds.has(r)&&t.push(i)});for(let n of t){let i=this._blobWrappersByUrl.get(n);i&&(i.referringNodeIds.size==1?this._blobWrappersByUrl.delete(n):i.referringNodeIds.delete(r))}}_assignBlobToNode(e,t,r,n={}){n.multiAssetsForNode!=!0&&this.clearBlobsForNode(t);let i=this._blobWrappersByUrl.get(e);i?i.referringNodeIds.add(t.graphNodeId()):this._blobWrappersByUrl.set(e,r)}async fetchBlobGlobal(e){if(!this.recording())return{};try{let t=this._blobWrappersByUrl.get(e);if(t)return{blobWrapper:t};let r=Q.assetUrls.remapedUrl(e)||e,n=await fetch(r);if(n.ok){let i=await n.blob(),s={blob:i,blobUrl:this._createBlobUrl(i),referringNodeIds:new Set};return this._blobWrappersByUrl.set(e,s),{blobWrapper:s}}else return{error:`failed to fetch ${r}`}}catch{return{error:`failed to fetch ${e}`}}}async fetchBlobForNode(e){if(!this.recording())return{};try{let t=e.node.graphNodeId(),r=this._blobWrappersByUrl.get(e.fullUrl);if(r)return r.referringNodeIds.add(t),{blobWrapper:r};let n=Q.assetUrls.remapedUrl(e.fullUrl)||e.fullUrl,i=await fetch(n);if(i.ok){let s=await i.blob(),a=new Set;a.add(t);let c={blob:s,blobUrl:this._createBlobUrl(s),referringNodeIds:a};return this._assignBlobToNode(e.fullUrl,e.node,c,{multiAssetsForNode:e.multiAssetsForNode}),{blobWrapper:c}}else return{error:`failed to fetch ${e.fullUrl}`}}catch{return{error:`failed to fetch ${e.fullUrl}`}}}traverse(e){let t=(r,n)=>{let i=[];this._blobWrappersByUrl.forEach((s,a)=>{s.referringNodeIds.size==0==r&&i.push(a)}),i.sort();for(let s of i){let a=this._blobWrappersByUrl.get(s);a&&n({url:s,blobWrapper:a})}};t(!0,e),t(!1,e)}_createBlobUrl(e){return jC(e)}assetsManifestWithBlobsMap(){let e={},t=new Map,r=[],n=[];this.traverse(i=>{r.push(i.blobWrapper.blob);let s=i.url;n.push(s)});for(let i=0;i<r.length;i++){let s=n[i],a=r[i],c=s.split("?")[0],l=s.split("."),u=l[l.length-1],p=`${i}.${u}`,d=`assets/${p}`;t.set(d,a),e[c]=p}return{manifest:e,blobsMap:t}}};var b4=class{setMap(e){this._map=e}remapedUrl(e){if(!this._map)return;let t=e.split("?"),r=t[0],n=t[1],i=this._map[r];if(i)return n?`${i}?${n}`:i}};var T4=class{setPerformanceManager(e){this._performanceManager=e}performanceManager(){return this._performanceManager||window.performance}};var O1=class{constructor(){this.renderersController=new u4,this.nodesRegister=new Di(this),this.operationsRegister=new wu(this),this.expressionsRegister=new h4,this.modulesRegister=new m4,this.assemblersRegister=new g4,this.pluginsRegister=new v4(this),this.camerasRegister=new y4(this),this.blobs=new x4,this.assetUrls=new b4,this.performance=new T4,this.scenesByUuid={},this._player_mode=!0,this._logger=null}static _instance_(){if(window.__POLYGONJS_POLY_INSTANCE__)return window.__POLYGONJS_POLY_INSTANCE__;{let e=new O1;return window.__POLYGONJS_POLY_INSTANCE__=e,window.__POLYGONJS_POLY_INSTANCE__}}setPlayerMode(e){this._player_mode=e}playerMode(){return this._player_mode}registerNode(e,t,r){this.nodesRegister.register(e,t,r)}registerOperation(e){this.operationsRegister.register(e)}registerCamera(e){this.camerasRegister.register(e)}registerPlugin(e){this.pluginsRegister.register(e)}registeredNodes(e,t){return this.nodesRegister.registeredNodes(e,t)}registeredOperation(e,t){return this.operationsRegister.registeredOperation(e,t)}registeredCameraTypes(){return this.camerasRegister.registeredTypes()}registerModule(e){this.modulesRegister.register(e.moduleName,e.module)}inWorkerThread(){return!1}get libs(){return this._libs_controller=this._libs_controller||new p4}setEnv(e){this._env=e}env(){return this._env}setLogger(e){this._logger=e}log(e,...t){var r;(r=this._logger)==null||r.log(e,...t)}warn(e,...t){var r;(r=this._logger)==null||r.warn(e,...t)}error(e,...t){var r;(r=this._logger)==null||r.error(e,...t)}},Q=O1._instance_();var A4=class{constructor(e){this.node=e,this._dirtyCount=0,this._dirty=!0}dispose(){this._cachedSuccessors=void 0,this._postDirtyHooks=void 0,this._postDirtyHookNames=void 0}isDirty(){return this._dirty===!0}dirtyTimestamp(){return this._dirtyTimestamp}dirtyCount(){return this._dirtyCount}addPostDirtyHook(e,t){this._postDirtyHookNames=this._postDirtyHookNames||[],this._postDirtyHooks=this._postDirtyHooks||[],this._postDirtyHookNames.includes(e)?console.warn(`hook with name ${e} already exists`,this.node):(this._postDirtyHookNames.push(e),this._postDirtyHooks.push(t))}removePostDirtyHook(e){if(this._postDirtyHookNames&&this._postDirtyHooks){let t=this._postDirtyHookNames.indexOf(e);t>=0&&(this._postDirtyHookNames.splice(t,1),this._postDirtyHooks.splice(t,1))}}hasHook(e){return this._postDirtyHookNames?this._postDirtyHookNames.includes(e):!1}removeDirtyState(){this._dirty=!1}setForbiddenTriggerNodes(e){this._forbiddenTriggerNodeIds?this._forbiddenTriggerNodeIds.clear():this._forbiddenTriggerNodeIds=new Set;for(let t of e)this._forbiddenTriggerNodeIds.add(t.graphNodeId()),t.dirtyController.clearSuccessorsCacheWithPredecessors()}isForbiddenTriggerNodeId(e){return this._forbiddenTriggerNodeIds!=null&&this._forbiddenTriggerNodeIds.has(e)}setDirty(e,t){t==null&&(t=!0),!(e&&this.isForbiddenTriggerNodeId(e.graphNodeId()))&&(e==null&&(e=this.node),this._dirty=!0,this._dirtyTimestamp=Q.performance.performanceManager().now(),this._dirtyCount+=1,this.runPostDirtyHooks(e),t===!0&&this.setSuccessorsDirty(e))}runPostDirtyHooks(e){if(!this._postDirtyHooks)return;let t=this.node.scene().cooker;if(t.blocked())t.enqueue(this.node,e);else for(let r of this._postDirtyHooks)r(e)}setSuccessorsDirty(e){this._cachedSuccessors=this._cachedSuccessors||this.node.graphAllSuccessors();for(let r of this._cachedSuccessors)r.dirtyController.setDirty(e,!1)}clearSuccessorsCache(){this._cachedSuccessors=void 0}clearSuccessorsCacheWithPredecessors(){this.clearSuccessorsCache();for(let e of this.node.graphAllPredecessors())e.dirtyController.clearSuccessorsCache()}};var Kt=class{constructor(e,t){this._scene=e,this._name=t,this._dirtyController=new A4(this),this._graphNodeId=e.graph.nextId(),e.graph.addNode(this),this._graph=e.graph}dispose(){this._dirtyController.dispose(),this.graphRemove()}name(){return this._name}setName(e){this._name=e}scene(){return this._scene}graphNodeId(){return this._graphNodeId}get dirtyController(){return this._dirtyController}setDirty(e){e=e||this,this._dirtyController.setDirty(e)}setSuccessorsDirty(e){this._dirtyController.setSuccessorsDirty(e)}removeDirtyState(){this._dirtyController.removeDirtyState()}isDirty(){return this._dirtyController.isDirty()}addPostDirtyHook(e,t){this._dirtyController.addPostDirtyHook(e,t)}removePostDirtyHook(e){this._dirtyController.removePostDirtyHook(e)}graphRemove(){this._graph.removeNode(this)}addGraphInput(e,t=!0){return this._graph.connect(e,this,t)}removeGraphInput(e){this._graph.disconnect(e,this)}graphDisconnectPredecessors(){this._graph.disconnectPredecessors(this)}graphDisconnectSuccessors(){this._graph.disconnectSuccessors(this)}graphPredecessorIds(){return this._graph.predecessorIds(this._graphNodeId)||[]}graphPredecessors(){return this._graph.predecessors(this)}graphSuccessors(){return this._graph.successors(this)}graphAllPredecessors(){return this._graph.allPredecessors(this)}graphAllSuccessors(){return this._graph.allSuccessors(this)}};var Q0=(o=>(o.MAX_FRAME_UPDATED="scene_maxFrameUpdated",o.REALTIME_STATUS_UPDATED="scene_realtime_status_updated",o.FRAME_UPDATED="scene_frame_updated",o.PLAY_STATE_UPDATED="scene_play_state_updated",o))(Q0||{});var Vt=class{static arrayFromValues(e){let t=[];return e.forEach(r=>{t.push(r)}),t}static pushOnArrayAtEntry(e,t,r){e.has(t)?e.get(t).push(r):e.set(t,[r])}static addToSetAtEntry(e,t,r){if(e.has(t))e.get(t).add(r);else{let i=new Set;i.add(r),e.set(t,i)}}static popFromArrayAtEntry(e,t,r){if(e.has(t)){let i=e.get(t),s=i.indexOf(r);s>=0&&i.splice(s,1)}}static removeFromSetAtEntry(e,t,r){if(e.has(t)){let i=e.get(t);i.delete(r),i.size==0&&e.delete(t)}}static unshiftOnArrayAtEntry(e,t,r){e.has(t)?e.get(t).unshift(r):e.set(t,[r])}static concatOnArrayAtEntry(e,t,r){if(e.has(t)){let i=e.get(t);for(let s of r)i.push(s)}else e.set(t,r)}static async forEachSync(e,t){let r=[],n=[];e.forEach((i,s)=>{r.push(i),n.push(s)});for(let i=0;i<r.length;i++){let s=n[i],a=r[i];await t(a,s)}}static groupBy(e,t){let r=new Map;return e.forEach(n=>{let i=t(n);this.pushOnArrayAtEntry(r,i,n)}),r}};var Tc=(o=>(o.LOADED="sceneLoaded",o.PLAY="play",o.PAUSE="pause",o))(Tc||{}),WC=["sceneLoaded","play","pause"],P1=class extends Event{constructor(e){super(e)}get type(){return super.type}},qC={event:new P1("sceneLoaded")},XC={event:new P1("play")},YC={event:new P1("pause")},C4=class{constructor(){this._observersByEventType=new Map}dispatch(e){let t=e.event;if(!t)return;let r=this._observersByEventType.get(t.type);!r||r.forEach(n=>{n.processEvent(e)})}removeObserverFromAllEventTypes(e){this._observersByEventType.forEach((t,r)=>{t.delete(e)})}addObserver(e,t){Vt.addToSetAtEntry(this._observersByEventType,t,e)}};var $C=60,Kd=class{constructor(o){this.scene=o,this._frame=0,this._timeUniform={value:0},this._realtimeState=!0,this._maxFrame=600,this._maxFrameLocked=!1,this._playing=!1,this._delta=0,this._onBeforeTickCallbacks=[],this._onAfterTickCallbacks=[],this._graphNode=new Kt(o,"timeController")}get graphNode(){return this._graphNode}frame(){return this._frame}timeUniform(){return this._timeUniform}time(){return this._timeUniform.value}maxFrame(){return this._maxFrame}maxFrameLocked(){return this._maxFrameLocked}realtimeState(){return this._realtimeState}setMaxFrame(o){this._maxFrame=Math.floor(o),this.scene.dispatchController.dispatch(this._graphNode,Q0.MAX_FRAME_UPDATED)}setMaxFrameLocked(o){this._maxFrameLocked=o,this.scene.dispatchController.dispatch(this._graphNode,Q0.MAX_FRAME_UPDATED)}setRealtimeState(o){this._realtimeState=o,this.scene.dispatchController.dispatch(this._graphNode,Q0.REALTIME_STATUS_UPDATED)}setTime(o,e=!0){if(o==this._timeUniform.value)return;this._timeUniform.value=o,this.scene.cooker.block();let t=this._delta;for(let r of this._onBeforeTickCallbacks)r(t);if(e){let r=Math.floor(this._timeUniform.value*$C),n=this._ensureFrameWithinBounds(r);r!=n?this.setFrame(n,!0):this._frame=r}this.scene.dispatchController.dispatch(this._graphNode,Q0.FRAME_UPDATED),this.graphNode.setSuccessorsDirty(),this.scene.cooker.unblock();for(let r of this._onAfterTickCallbacks)r(t)}setFrame(o,e=!0){o!=this._frame&&(o=this._ensureFrameWithinBounds(o),o!=this._frame&&(this._frame=o,e&&this.setTime(this._frame/$C,!1)))}setFrameToStart(){this.setFrame(Kd.START_FRAME,!0)}incrementTimeIfPlaying(o){this._playing&&(this.scene.root().areChildrenCooking()||this.incrementTime(o))}incrementTime(o){if(this._realtimeState){this._delta=o;let e=this._timeUniform.value+this._delta;this.setTime(e,!1),this.setFrame(this._frame+1,!1)}else this.setFrame(this.frame()+1)}_ensureFrameWithinBounds(o){if(this._playing){if(this._maxFrameLocked&&o>this._maxFrame)return Kd.START_FRAME}else{if(this._maxFrameLocked&&o>this._maxFrame)return this._maxFrame;if(o<Kd.START_FRAME)return Kd.START_FRAME}return o}playing(){return this._playing===!0}pause(){this._playing!=!1&&(this._playing=!1,this.scene.dispatchController.dispatch(this._graphNode,Q0.PLAY_STATE_UPDATED),this.scene.eventsDispatcher.sceneEventsController.dispatch(YC))}play(){this._playing!=!0&&(this._playing=!0,this.scene.dispatchController.dispatch(this._graphNode,Q0.PLAY_STATE_UPDATED),this.scene.eventsDispatcher.sceneEventsController.dispatch(XC))}togglePlayPause(){this.playing()?this.pause():this.play()}registerOnBeforeTick(o,e){this._registerCallback(o,e,this.registeredBeforeTickCallbacks())}unRegisterOnBeforeTick(o){this._unregisterCallback(o,this._onBeforeTickCallbacksMap)}registeredBeforeTickCallbacks(){return this._onBeforeTickCallbacksMap=this._onBeforeTickCallbacksMap||new Map}registerOnAfterTick(o,e){this._registerCallback(o,e,this.registeredAfterTickCallbacks())}unRegisterOnAfterTick(o){this._unregisterCallback(o,this._onAfterTickCallbacksMap)}registeredAfterTickCallbacks(){return this._onAfterTickCallbacksMap=this._onAfterTickCallbacksMap||new Map}_registerCallback(o,e,t){if(t.has(o)){console.warn(`callback ${o} already registered`);return}t.set(o,e),this._updateCallbacks()}_unregisterCallback(o,e){!e||(e.delete(o),this._updateCallbacks())}_updateCallbacks(){var o,e;this._onBeforeTickCallbacks=[],(o=this._onBeforeTickCallbacksMap)==null||o.forEach(t=>{this._onBeforeTickCallbacks.push(t)}),this._onAfterTickCallbacks=[],(e=this._onAfterTickCallbacksMap)==null||e.forEach(t=>{this._onAfterTickCallbacks.push(t)})}},u0=Kd;u0.START_FRAME=0;var E4=class{constructor(e){this.scene=e,this._mainCameraNodePath=null}setMainCameraNodePath(e){this._mainCameraNodePath=e}mainCameraNodePath(){return this._mainCameraNodePath}mainCameraNode(){if(this.mainCameraNodePath){let e=this.mainCameraNodePath();return e?this.scene.node(e):this._findAnyCamera()}else return console.warn("main cameraNode not found"),this._findAnyCamera()}_findAnyCamera(){let e=this.scene.root();return e.nodesByType("perspectiveCamera")[0]||e.nodesByType("orthographicCamera")[0]}};var S4=class{constructor(e){this._scene=e,this._queue=new Map,this._blockLevel=0,this._blockLevel=0}block(){this._blockLevel+=1}unblock(){this._blockLevel-=1,this._blockLevel<0&&(this._blockLevel=0),this._processQueue()}blocked(){return this._blockLevel>0}enqueue(e,t){this._queue.set(e.graphNodeId(),t)}_processQueue(){if(this.blocked())return;let e=[],t=[];this._queue.forEach((r,n)=>{e.push(r),t.push(n)}),this._queue.clear();for(let r=0;r<e.length;r++){let n=e[r],i=t[r];this._processItem(n,i)}}_processItem(e,t){let r=this._scene.graph.nodeFromId(t);r&&r.dirtyController.runPostDirtyHooks(e)}};var w4=class{constructor(){this._cooking_nodes_by_id=new Map,this._resolves=[]}addNode(e){this._cooking_nodes_by_id.set(e.graphNodeId(),e)}removeNode(e){this._cooking_nodes_by_id.delete(e.graphNodeId()),this._cooking_nodes_by_id.size==0&&this.flush()}cookingNodes(){let e=[];return this._cooking_nodes_by_id.forEach((t,r)=>{e.push(t)}),e}flush(){let e;for(;e=this._resolves.pop();)e()}async waitForCooksCompleted(){if(this._cooking_nodes_by_id.size!=0)return new Promise((e,t)=>{this._resolves.push(e)})}};var ki=class{static toArray(e){let t=[];return e.forEach(r=>{t.push(r)}),t}static fromArray(e){let t=new Set;return e.forEach(r=>t.add(r)),t}static union(e,t){let r=new Set;return e.forEach(n=>r.add(n)),t.forEach(n=>r.add(n)),r}static intersection(e,t){let r=new Set;return e.forEach(n=>{t.has(n)&&r.add(n)}),t.forEach(n=>{e.has(n)&&r.add(n)}),r}static difference(e,t){let r=new Set;return e.forEach(n=>{t.has(n)||r.add(n)}),t.forEach(n=>{e.has(n)||r.add(n)}),r}};var M4=class{constructor(){this._next_id=0,this._successors=new Map,this._predecessors=new Map,this._nodes_by_id=new Map,this._nodesCount=0,this._debugging=!1,this._addedNodesDuringDebugging=new Map,this._boundPredecessorIds=this.predecessorIds.bind(this),this._boundSuccessorIds=this.successorIds.bind(this)}startDebugging(){this._debugging=!0}stopDebugging(){this._debugging=!1}printDebug(){this._addedNodesDuringDebugging.forEach((e,t)=>{console.log(t,e,e.graphPredecessors(),e.graphSuccessors())})}setScene(e){this._scene=e}scene(){return this._scene}nextId(){return this._next_id+=1,this._next_id}nodesFromIds(e){let t=[];for(let r of e){let n=this.nodeFromId(r);n&&t.push(n)}return t}nodeFromId(e){return this._nodes_by_id.get(e)}hasNode(e){return this._nodes_by_id.get(e.graphNodeId())!=null}addNode(e){this._nodes_by_id.set(e.graphNodeId(),e),this._nodesCount+=1,this._debugging&&this._addedNodesDuringDebugging.set(e.graphNodeId(),e)}removeNode(e){this._nodes_by_id.delete(e.graphNodeId()),this._successors.delete(e.graphNodeId()),this._predecessors.delete(e.graphNodeId()),this._nodesCount-=1,this._debugging&&this._addedNodesDuringDebugging.delete(e.graphNodeId())}nodesCount(){return this._nodesCount}connect(e,t,r=!0){let n=e.graphNodeId(),i=t.graphNodeId();if(this.hasNode(e)&&this.hasNode(t)){r&&(r=!(this._scene?this._scene.loadingController.isLoading():!0));let s=!1;return r&&(s=this._hasPredecessor(n,i)),s?!1:(this._createConnection(n,i),e.dirtyController.clearSuccessorsCacheWithPredecessors(),!0)}else return console.warn(`attempt to connect non existing node ${n} or ${i}`),!1}disconnect(e,t){this._remove_connection(e.graphNodeId(),t.graphNodeId()),e.dirtyController.clearSuccessorsCacheWithPredecessors()}disconnectPredecessors(e){let t=this.predecessors(e);for(let r of t)this.disconnect(r,e)}disconnectSuccessors(e){let t=this.successors(e);for(let r of t)this.disconnect(e,r)}predecessorIds(e){let t=this._predecessors.get(e);if(t){let r=[];return t.forEach((n,i)=>{r.push(i)}),r}return[]}predecessors(e){let t=this.predecessorIds(e.graphNodeId());return this.nodesFromIds(t)}successorIds(e){let t=this._successors.get(e);if(t){let r=[];return t.forEach((n,i)=>{r.push(i)}),r}return[]}successors(e){let t=this.successorIds(e.graphNodeId())||[];return this.nodesFromIds(t)}allPredecessorIds(e){let t=this._boundPredecessorIds,r=new Set,n=t(e.graphNodeId());for(;n.length>0;){let i=[];for(let s of n){r.add(s);for(let a of t(s))i.push(a)}n=i}return ki.toArray(r)}allSuccessorIds(e){let t=this._boundSuccessorIds,r=new Set,n=t(e.graphNodeId());for(;n.length>0;){let i=[];for(let s of n){let a=this.nodeFromId(s);if(a&&!a.dirtyController.isForbiddenTriggerNodeId(e.graphNodeId())){r.add(s);for(let c of t(s))i.push(c)}}n=i}return ki.toArray(r)}allPredecessors(e){let t=this.allPredecessorIds(e);return this.nodesFromIds(t)}allSuccessors(e){let t=this.allSuccessorIds(e);return this.nodesFromIds(t)}_createConnection(e,t){let r=this._successors.get(e);if(r||(r=new Set,this._successors.set(e,r)),r.has(t))return;r.add(t);let n=this._predecessors.get(t);n||(n=new Set,this._predecessors.set(t,n)),n.add(e)}_remove_connection(e,t){let r=this._successors.get(e);r&&(r.delete(t),r.size==0&&this._successors.delete(e));let n=this._predecessors.get(t);n&&(n.delete(e),n.size==0&&this._predecessors.delete(t))}_hasPredecessor(e,t){let r=this.predecessorIds(e);if(r){if(r.includes(t))return!0;for(let n of r)return this._hasPredecessor(n,t)}return!1}};var N4=class{constructor(e){this._node=e,this._cooks_count=0,this._total_cook_time=0,this._total_inputs_time=0,this._total_params_time=0}update_cook_data(e){this._cooks_count+=1,this._total_cook_time+=e.cookTime,this._total_inputs_time+=e.inputsTime,this._total_params_time+=e.paramsTime}total_time(){return this._total_cook_time+this._total_inputs_time+this._total_params_time}total_cook_time(){return this._total_cook_time}cook_time_per_iteration(){return this._cooks_count>0?this._total_cook_time/this._cooks_count:0}total_inputs_time(){return this._total_inputs_time}inputs_time_per_iteration(){return this._cooks_count>0?this._total_inputs_time/this._cooks_count:0}total_params_time2(){return this._total_params_time}params_time_per_iteration2(){return this._cooks_count>0?this._total_params_time/this._cooks_count:0}cooks_count(){return this._cooks_count}print_object(){return{fullPath:this._node.path(),cooks_count:this.cooks_count(),total_time:this.total_time(),total_cook_time:this.total_cook_time(),cook_time_per_iteration:this.cook_time_per_iteration(),inputs_time_per_iteration:this.inputs_time_per_iteration(),params_time_per_iteration:this.params_time_per_iteration2()}}};var K=class{static isNumber(e){return typeof e=="number"}static isVector(e){return e instanceof z||e instanceof M||e instanceof De}static isColor(e){return e instanceof de}static isQuaternion(e){return e instanceof It}static isString(e){return typeof e=="string"}static isBoolean(e){return e===!0||e===!1}static isNaN(e){return isNaN(e)}static isArray(e){return Array.isArray(e)}static isObject(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}};var Qe=class{static shallowClone(e){return[...e]}static min(e){let t=e[0];for(let r of e)r<t&&(t=r);return t}static max(e){let t=e[0];for(let r of e)r>t&&(t=r);return t}static sum(e){let t=0;for(let r of e)t+=r;return t}static compact(e){let t=[];for(let r of e)r!=null&&t.push(r);return t}static uniq(e){let t=new Set;for(let i of e)t.add(i);let r=new Array(t.size),n=0;return t.forEach(i=>{r[n]=i,n++}),r}static chunk(e,t){let r=[],n=[];r.push(n);for(let i=0;i<e.length;i++)n.length==t&&(n=[],r.push(n)),n.push(e[i]);return r}static union(e,t){let r=[];return ki.union(this.toSet(e),this.toSet(t)).forEach(i=>r.push(i)),r}static intersection(e,t){let r=[];return ki.intersection(this.toSet(e),this.toSet(t)).forEach(i=>r.push(i)),r}static difference(e,t){let r=[];return ki.difference(this.toSet(e),this.toSet(t)).forEach(i=>r.push(i)),r}static toSet(e){let t=new Set;for(let r of e)t.add(r);return t}static isEqual(e,t){if(e.length!=t.length)return!1;let r=e.length;for(let n=0;n<r;n++)if(e[n]!=t[n])return!1;return!0}static sortBy(e,t){if(e.length==0)return[];let r=new Map,n=new Set;for(let c of e){let l=t(c);n.add(l),Vt.pushOnArrayAtEntry(r,l,c)}let i=new Array(n.size),s=0;n.forEach(c=>{i[s]=c,s++}),K.isString(i[0])?i.sort():i.sort((c,l)=>c-l);let a=new Array(e.length);s=0;for(let c of i){let l=r.get(c);if(l)for(let u of l)a[s]=u,s++}return a}static range(e,t,r=1){t==null&&(t=e,e=0);let n=Math.floor((t-e)/r),i=new Array(n);for(let s=0;s<i.length;s++)i[s]=e+s*r;return i}};var KM=Ni(XM()),JM=Ni($M()),wr=class{static isEqual(e,t){if(K.isObject(e)&&K.isObject(t)){let r=Object.keys(e),n=Object.keys(t);return Qe.isEqual(r,n)?JSON.stringify(e)==JSON.stringify(t):!1}return!1}static merge(e,t){return Object.assign(e,t)}static clone(e){return(0,JM.default)(e)}static cloneDeep(e){return(0,KM.default)(e)}};var e5=class{constructor(){this._started=!1,this._start_time=0,this._previous_timestamp=0,this._nodes_cook_data={},this._durations_by_name={},this._durations_count_by_name={}}profile(e,t){let r=Q.performance.performanceManager(),n=r.now();t();let i=r.now()-n;console.log(`${e}: ${i}`)}start(){if(!this._started){this.reset(),this._started=!0;let e=Q.performance.performanceManager();this._start_time=e.now(),this._nodes_cook_data={},this._previous_timestamp=this._start_time}}stop(){this.reset()}reset(){this._started=!1,this._start_time=null,this._durations_by_name={},this._durations_count_by_name={},this._nodes_cook_data={}}started(){return this._started}recordNodeCookData(e,t){let r=e.graphNodeId();this._nodes_cook_data[r]==null&&(this._nodes_cook_data[r]=new N4(e)),this._nodes_cook_data[r].update_cook_data(t)}record(e){this.started()||this.start();let t=performance.now();return this._durations_by_name[e]==null&&(this._durations_by_name[e]=0),this._durations_by_name[e]+=t-this._previous_timestamp,this._durations_count_by_name[e]==null&&(this._durations_count_by_name[e]=0),this._durations_count_by_name[e]+=1,this._previous_timestamp=t}print(){this.print_node_cook_data(),this.print_recordings()}print_node_cook_data(){let e=Object.values(this._nodes_cook_data);e=Qe.sortBy(e,i=>i.total_cook_time());let t=e.map(i=>i.print_object());console.log("--------------- NODES COOK TIME -----------");let r=[],n=Qe.sortBy(t,i=>-i.total_cook_time);for(let i of n)r.push(i);return console.table(r),t}print_recordings(){let e=wr.clone(this._durations_by_name),t=wr.clone(this._durations_count_by_name),r=[],n={};for(let a of Object.keys(e)){let c=e[a];r.push(c),n[c]==null&&(n[c]=[]),n[c].push(a)}r.sort((a,c)=>a-c);let i=Qe.uniq(r);console.log("--------------- PERF RECORDINGS -----------");let s=[];for(let a of i){let c=n[a];for(let l of c){let u=t[l],p=a/u,d={duration:a,name:l,count:u,duration_per_iteration:p};s.push(d)}}return console.table(s),s}};var t5=class{constructor(e){this.scene=e}setListener(e){this._eventsListener?console.warn("scene already has a listener"):(this._eventsListener=e,this._runOnAddListenerCallbacks())}onAddListener(e){this._eventsListener?e():(this._onAddListenerCallbacks=this._onAddListenerCallbacks||[],this._onAddListenerCallbacks.push(e))}_runOnAddListenerCallbacks(){if(this._onAddListenerCallbacks){let e;for(;e=this._onAddListenerCallbacks.pop();)e();this._onAddListenerCallbacks=void 0}}dispatch(e,t,r){var n;(n=this._eventsListener)==null||n.process_events(e,t,r)}emitAllowed(){return this._eventsListener!=null&&this.scene.loadingController.loaded()&&this.scene.loadingController.autoUpdating()}};var r5=class{constructor(){this._params_by_id=new Map}registerParam(e){this._params_by_id.set(e.graphNodeId(),e)}deregisterParam(e){this._params_by_id.delete(e.graphNodeId())}regenerateReferringExpressions(e){e.nameController.graph_node.setSuccessorsDirty(e)}};var o5=class{constructor(e){this.scene=e,this._lifecycleOnAfterCreatedAllowed=!0}onAfterCreatedCallbackAllowed(){return this.scene.loadingController.loaded()&&this._lifecycleOnAfterCreatedAllowed}onAfterCreatedPrevent(e){this._lifecycleOnAfterCreatedAllowed=!1,e(),this._lifecycleOnAfterCreatedAllowed=!0}};var n5=class{constructor(e){this.scene=e,this._loadingState=!1,this._autoUpdating=!0}markAsLoading(){this._setLoadingState(!0)}async markAsLoaded(){this.scene.missingExpressionReferencesController.resolveMissingReferences(),await this._setLoadingState(!1),this._triggerLoadedEvent()}_triggerLoadedEvent(){globalThis.Event&&this.scene.eventsDispatcher.sceneEventsController.dispatch(qC)}async _setLoadingState(e){this._loadingState=e,await this.setAutoUpdate(!this._loadingState)}isLoading(){return this._loadingState}loaded(){return!this._loadingState}autoUpdating(){return this._autoUpdating}async setAutoUpdate(e){if(this._autoUpdating!==e&&(this._autoUpdating=e,this._autoUpdating)){let t=this.scene.root();t&&await t.processQueue()}}};var Rn=class{constructor(e=""){this._path=e,this._node=null}setPath(e){this._path=e}setNode(e){this._node=e}path(){return this._path}node(){return this._node}resolve(e){this._node=ut.findNode(e,this._path)}clone(){let e=new Rn(this._path);return e.setNode(this._node),e}nodeWithContext(e,t){let r=this.node();if(!r){t==null||t.set(`no node found at ${this.path()}`);return}let n=r.context();if(n==e)return r;t==null||t.set(`expected ${e} node, but got a ${n}`)}},Ec=class{constructor(e=""){this._path=e,this._param=null}setPath(e){this._path=e}setParam(e){this._param=e}path(){return this._path}param(){return this._param}resolve(e){this._param=ut.findParam(e,this._path)}clone(){let e=new Ec(this._path);return e.setParam(this._param),e}paramWithType(e,t){let r=this.param();if(!r){t==null||t.set(`no param found at ${this.path()}`);return}if(r.type()==e)return r;t==null||t.set(`expected ${e} node, but got a ${r.type()}`)}},Xt=class{static splitParentChild(o){let e=o.split(Xt.SEPARATOR).filter(n=>n.length>0),t=e.pop();return{parent:e.join(Xt.SEPARATOR),child:t}}static findNode(o,e,t){if(!o)return null;let r=e.split(Xt.SEPARATOR).filter(s=>s.length>0),n=r[0],i=null;if(e[0]===Xt.SEPARATOR){let s=e.substring(1);i=this.findNode(o.root(),s,t)}else{switch(n){case Xt.PARENT:t==null||t.add_path_element(n),i=o.parent();break;case Xt.CURRENT:t==null||t.add_path_element(n),i=o;break;default:i=o.node(n),i&&(t==null||t.add_node(n,i))}if(i!=null&&r.length>1){let s=r.slice(1).join(Xt.SEPARATOR);i=this.findNode(i,s,t)}return i}return i}static findParam(o,e,t){if(!o)return null;let r=e.split(Xt.SEPARATOR);if(r.length===1)return o.params.get(r[0]);{let n=null;if(e[0]===Xt.SEPARATOR&&r.length==2)n=o.root();else{let i=r.slice(0,+(r.length-2)+1||void 0).join(Xt.SEPARATOR);n=this.findNode(o,i,t)}if(n!=null){let i=r[r.length-1],s=n.params.get(i);return t&&s&&t.add_node(i,s),s}else return null}}static relativePath(o,e){let t=this.closestCommonParent(o,e);if(t){let r=this.distanceToParent(o,t),n="";if(r>0){let u=0,p=[];for(;u++<r;)p.push(Xt.PARENT);n=p.join(Xt.SEPARATOR)+Xt.SEPARATOR}let i=t.path().split(Xt.SEPARATOR).filter(u=>u.length>0),s=e.path().split(Xt.SEPARATOR).filter(u=>u.length>0),a=[],c=0;for(let u of s)i[c]||a.push(u),c++;let l=a.join(Xt.SEPARATOR);return this.sanitizePath(`${n}${l}`)}else return e.path()}static sanitizePath(o){return o.replace(/\/\//g,"/")}static closestCommonParent(o,e){let t=this.parents(o).reverse().concat([o]),r=this.parents(e).reverse().concat([e]),n=Math.min(t.length,r.length),i=null;for(let s=0;s<n;s++)t[s].graphNodeId()==r[s].graphNodeId()&&(i=t[s]);return i}static parents(o){let e=[],t=o.parent();for(;t;)e.push(t),t=t.parent();return e}static distanceToParent(o,e){let t=0,r=o,n=e.graphNodeId();for(;r&&r.graphNodeId()!=n;)t+=1,r=r.parent();return r&&r.graphNodeId()==n?t:-1}static makeAbsolutePath(o,e){if(e[0]==Xt.SEPARATOR)return e;let t=e.split(Xt.SEPARATOR),r=t.shift();if(r)switch(r){case"..":{let n=o.parent();return n?n==o.scene().root()?Xt.SEPARATOR+t.join(Xt.SEPARATOR):this.makeAbsolutePath(n,t.join(Xt.SEPARATOR)):null}case".":return this.makeAbsolutePath(o,t.join(Xt.SEPARATOR));default:return[o.path(),e].join(Xt.SEPARATOR)}else return o.path()}},ut=Xt;ut.SEPARATOR="/";ut.DOT=".";ut.CURRENT=Xt.DOT;ut.PARENT="..";ut.CURRENT_WITH_SLASH=`${Xt.CURRENT}/`;ut.PARENT_WITH_SLASH=`${Xt.PARENT}/`;ut.NON_LETTER_PREFIXES=[Xt.SEPARATOR,Xt.DOT];var i5=class{constructor(e,t){this.param=e,this.path=t}absolutePath(){return ut.makeAbsolutePath(this.param.node,this.path)}matchesPath(e){return this.absolutePath()==e}resolveMissingDependencies(){let e=this.param.rawInputSerialized();this.param.set(this.param.defaultValue()),this.param.set(e)}};var s5=class{constructor(e){this.scene=e,this.references=new Map}register(e,t){let r=new i5(e,t);return Vt.addToSetAtEntry(this.references,e.graphNodeId(),r),r}deregisterParam(e){this.references.delete(e.graphNodeId())}resolveMissingReferences(){let e=[];this.references.forEach(t=>{for(let r of t)this._isReferenceResolvable(r)&&e.push(r)});for(let t of e)t.resolveMissingDependencies()}_isReferenceResolvable(e){let t=e.absolutePath();if(t){if(this.scene.node(t))return!0;{let n=ut.splitParentChild(t);if(n.child){let i=this.scene.node(n.parent);if(i&&i.params.get(n.child))return!0}}}}checkForMissingNodeReferences(e){if(!!e.scene().loadingController.loaded()){this._checkForMissingReferencesForNode(e);for(let t of e.params.all)this._checkForMissingReferencesForParam(t)}}checkForMissingParamReferences(e){!e.scene().loadingController.loaded()||this._checkForMissingReferencesForParam(e)}_checkForMissingReferencesForNode(e){let t=e.graphNodeId(),r=Vt.arrayFromValues(this.references);for(let n of r){let i=!1,s=ki.toArray(n);for(let a of s)a.matchesPath(e.path())&&(i=!0,a.resolveMissingDependencies());i&&this.references.delete(t)}}_checkForMissingReferencesForParam(e){let t=e.graphNodeId(),r=Vt.arrayFromValues(this.references);for(let n of r){let i=!1,s=ki.toArray(n);for(let a of s)a.matchesPath(e.path())&&(i=!0,a.resolveMissingDependencies());i&&this.references.delete(t)}}};var Nt=(o=>(o.CREATED="node_created",o.DELETED="node_deleted",o.NAME_UPDATED="node_name_update",o.OVERRIDE_CLONABLE_STATE_UPDATE="node_override_clonable_state_update",o.NAMED_OUTPUTS_UPDATED="node_named_outputs_updated",o.NAMED_INPUTS_UPDATED="node_named_inputs_updated",o.INPUTS_UPDATED="node_inputs_updated",o.PARAMS_UPDATED="node_params_updated",o.UI_DATA_POSITION_UPDATED="node_ui_data_position_updated",o.UI_DATA_COMMENT_UPDATED="node_ui_data_comment_updated",o.ERROR_UPDATED="node_error_updated",o.FLAG_BYPASS_UPDATED="bypass_flag_updated",o.FLAG_DISPLAY_UPDATED="display_flag_updated",o.FLAG_OPTIMIZE_UPDATED="optimize_flag_updated",o.SELECTION_UPDATED="selection_updated",o))(Nt||{});var a5=class{constructor(e,t=0,r=0){this.node=e,this._position=new z,this._width=50,this._color=new de(.75,.75,.75),this._layoutVertical=!0,this._json={x:0,y:0},this._position.x=t,this._position.y=r}dispose(){this._comment=void 0}setComment(e){this._comment=e,this.node.emit(Nt.UI_DATA_COMMENT_UPDATED)}comment(){return this._comment}setColor(e){this._color=e}color(){return this._color}setLayoutHorizontal(){this._layoutVertical=!1}isLayoutVertical(){return this._layoutVertical}copy(e){this._position.copy(e.position()),this._color.copy(e.color())}position(){return this._position}setPosition(e,t=0){if(K.isNumber(e)){let r=e;this._position.set(r,t)}else this._position.copy(e);this.node.emit(Nt.UI_DATA_POSITION_UPDATED)}translate(e,t=!1){this._position.add(e),t&&(this._position.x=Math.round(this._position.x),this._position.y=Math.round(this._position.y)),this.node.emit(Nt.UI_DATA_POSITION_UPDATED)}toJSON(){return this._json.x=this._position.x,this._json.y=this._position.y,this._json.comment=this._comment,this._json}};var Sc=class{constructor(e){this.node=e,this._state=!0,this._hooks=null}onUpdate(e){this._hooks=this._hooks||[],this._hooks.push(e)}_on_update(){}set(e){this._state!=e&&(this._state=e,this._on_update(),this.runHooks())}active(){return this._state}toggle(){this.set(!this._state)}runHooks(){if(this._hooks)for(let e of this._hooks)e()}};var c5=class extends Sc{constructor(){super(...arguments);this._state=!1}_on_update(){this.node.emit(Nt.FLAG_BYPASS_UPDATED),this.node.setDirty()}};var l5=class extends Sc{_on_update(){this.node.emit(Nt.FLAG_DISPLAY_UPDATED)}};var u5=class extends Sc{constructor(){super(...arguments);this._state=!1}_on_update(){this.node.emit(Nt.FLAG_OPTIMIZE_UPDATED)}};var ta=class{constructor(e){this.node=e}hasDisplay(){return!1}hasBypass(){return!1}hasOptimize(){return!1}};function p5(o){return class extends o{constructor(){super(...arguments);this.display=new l5(this.node)}hasDisplay(){return!0}}}function j1(o){return class extends o{constructor(){super(...arguments);this.bypass=new c5(this.node)}hasBypass(){return!0}}}function ZM(o){return class extends o{constructor(){super(...arguments);this.optimize=new u5(this.node)}hasOptimize(){return!0}}}var vo=class extends p5(ta){},ah=class extends j1(ta){},_K=class extends j1(p5(ta)){},d5=class extends ZM(j1(ta)){},h5=class extends ZM(j1(p5(ta))){};var ch=class{constructor(e){this.node=e}};var f5=class extends ch{active(){return this.paramsTimeDependent()||this.inputsTimeDependent()}paramsTimeDependent(){let e=this.node.params.names;for(let t of e){let r=this.node.params.get(t);if(r&&r.states.timeDependent.active())return!0}return!1}inputsTimeDependent(){let e=this.node.io.inputs.inputs();for(let t of e)if(t&&t.states.timeDependent.active())return!0;return!1}forceTimeDependent(){let e=this.node.graphPredecessors().map(r=>r.graphNodeId()),t=this.node.scene().timeController.graphNode;e.includes(t.graphNodeId())||this.node.addGraphInput(t,!1)}unforceTimeDependent(){let e=this.node.scene().timeController.graphNode;this.node.removeGraphInput(e)}};var m5=class extends ch{set(e){this._message!=e&&(e?Q.error(`[${this.node.path()}] error: '${e}'`):Q.warn(`[${this.node.path()}] clear error`),this._message=e,this.onUpdate())}message(){return this._message}clear(){this.set(void 0)}active(){return this._message!=null}onUpdate(){this._message!=null&&this.node._setContainer(null,`from error '${this._message}'`),this.node.emit(Nt.ERROR_UPDATED)}};var _5=class{constructor(e){this.node=e,this.timeDependent=new f5(this.node),this.error=new m5(this.node)}};var g5=class{constructor(e){this.node=e,this._parent=null}parent(){return this._parent}setParent(e){e!=this.node.parentController.parent()&&(this._parent=e,this._parent&&this.node.nameController.requestNameToParent(this.node.name()))}firstAncestorWithContext(e){return this._parent?this._parent.context()==e?this._parent:this._parent.parentController.firstAncestorWithContext(e):null}path(e){let t=ut.SEPARATOR;if(this._parent!=null){if(this._parent==e)return this.node.name();{let r=this._parent.path(e);return r===t?r+this.node.name():r+t+this.node.name()}}else return t}onSetParent(){if(this._on_set_parent_hooks)for(let e of this._on_set_parent_hooks)e()}findNode(e){if(e==null)return null;if(e==ut.CURRENT||e==ut.CURRENT_WITH_SLASH)return this.node;if(e==ut.PARENT||e==ut.PARENT_WITH_SLASH)return this.node.parent();let t=ut.SEPARATOR;if(e===t)return this.node.scene().root();if(e[0]===t)return e=e.substring(1,e.length),this.node.scene().root().node(e);if(e.split){let r=e.split(t);if(r.length===1){let n=r[0];return this.node.childrenController?this.node.childrenController.childByName(n):null}else return ut.findNode(this.node,e)}else return console.error("unexpected path given:",e),null}};var gK=/[, ]/,QM=/\d+$/,vK=/^0+/,yK=/,| /,xK="0",bK=" ",TK=/^-?\d+\.?\d*$/;var Ve=class{static isBoolean(e){return e=="true"||e=="false"}static toBoolean(e){return e=="true"}static isNumber(e){return TK.test(e)}static tailDigits(e){let t=e.match(QM);return t?parseInt(t[0]):0}static increment(e){let t=e.match(QM);if(t){let r=t[0],n="",i=r.match(vK);i&&(n=i[0]);let s=parseInt(r);return s==0&&n.length>0&&n[n.length-1]==xK&&(n=n.slice(0,-1)),`${e.substring(0,e.length-t[0].length)}${n}${s+1}`}else return`${e}1`}static pluralize(e){return e[e.length-1]!=="s"?`${e}s`:e}static camelCase(e){let t=e.replace(/_/g," ").split(" "),r="";for(let n=0;n<t.length;n++){let i=t[n].toLowerCase();n>0&&(i=this.upperFirst(i)),r+=i}return r}static upperFirst(e){return e[0].toUpperCase()+e.substring(1)}static titleize(e){return e.split(/\s|_/g).map(n=>this.upperFirst(n)).join(" ")}static precision(e,t=2){t=Math.max(t,0);let r=`${e}`.split(".");if(t<=0)return r[0];let n=r[1];if(n!==void 0)return n.length>t&&(n=n.substring(0,t)),n=n.padEnd(t,"0"),`${r[0]}.${n}`;{let i=`${e}.`,s=i.length+t;return i.padEnd(s,"0")}}static ensureFloat(e){let t=`${e}`;return t.indexOf(".")>=0?t:`${t}.0`}static ensureInteger(e){let t=`${e}`;return t.indexOf(".")>=0?t.split(".")[0]:t}static matchMask(e,t){if(t==="*"||e==t)return!0;let r=t.split(bK);if(r.length>1){for(let i of r)if(this.matchMask(e,i))return!0;return!1}return t=t.split("*").join(".*"),t=`^${t}$`,new RegExp(t).test(e)}static matchesOneMask(e,t){let r=!1;for(let n of t)Ve.matchMask(e,n)&&(r=!0);return r}static attribNames(e){let t=e.split(gK),r=new Set;for(let s of t)s=s.trim(),s.length>0&&r.add(s);let n=new Array(r.size),i=0;return r.forEach(s=>{n[i]=s,i++}),n}static indices(e){let t=e.split(yK);if(t.length>1){let r=t.flatMap(n=>this.indices(n));return Qe.uniq(r).sort((n,i)=>n-i)}else{let r=t[0];if(r){let n="-";if(r.indexOf(n)>0){let i=r.split(n);return Qe.range(parseInt(i[0]),parseInt(i[1])+1)}else{let i=parseInt(r);return K.isNumber(i)?[i]:[]}}else return[]}}static escapeLineBreaks(e){return e.replace(/(\r\n|\n|\r)/gm,"\\n")}static sanitizeName(e){return e=e.replace(/[^A-Za-z0-9]/g,"_"),e=e.replace(/^[0-9]/,"_"),e}};var v5=class{constructor(e){this._node=e,this._node_ids=[],this._json=[]}node(){return this._node}nodes(){return this._node.scene().graph.nodesFromIds(this._node_ids)}contains(e){return this._node_ids.includes(e.graphNodeId())}equals(e){let t=e.map(r=>r.graphNodeId()).sort();return Qe.isEqual(t,this._node_ids)}clear(){this._node_ids=[],this.send_update_event()}set(e){this._node_ids=[],this.add(e)}add(e){let t=e.map(r=>r.graphNodeId());this._node_ids=Qe.union(this._node_ids,t),this.send_update_event()}remove(e){let t=e.map(r=>r.graphNodeId());this._node_ids=Qe.difference(this._node_ids,t),this.send_update_event()}send_update_event(){this._node.emit(Nt.SELECTION_UPDATED)}toJSON(){return this._json=this._json||[],this._json=this._node_ids.map(e=>e),this._json}};var ke=(o=>(o.ALWAYS="always",o.NEVER="never",o.FROM_NODE="from_node",o))(ke||{});var Be=class{static unreachable(e){throw new Error("Didn't expect to get here")}};var y5=class{constructor(e){this.inputs_controller=e,this._clone_required_states=[],this._overridden=!1}initInputsClonedState(e){K.isArray(e)?this._cloned_states=e:this._cloned_state=e,this._update_clone_required_state()}override_cloned_state_allowed(){if(this._cloned_states){for(let e of this._cloned_states)if(e==ke.FROM_NODE)return!0}return this._cloned_state?this._cloned_state==ke.FROM_NODE:!1}clone_required_state(e){return this._clone_required_states[e]}clone_required_states(){return this._clone_required_states}_get_clone_required_state(e){let t=this._cloned_states;if(t){let r=t[e];if(r!=null)return this.clone_required_from_state(r)}return this._cloned_state?this.clone_required_from_state(this._cloned_state):!0}clone_required_from_state(e){switch(e){case ke.ALWAYS:return!0;case ke.NEVER:return!1;case ke.FROM_NODE:return!this._overridden}return Be.unreachable(e)}override_cloned_state(e){this._overridden=e,this._update_clone_required_state()}overriden(){return this._overridden}_update_clone_required_state(){if(this._cloned_states){let e=[];for(let t=0;t<this._cloned_states.length;t++)e[t]=this._get_clone_required_state(t);this._clone_required_states=e;return}if(this._cloned_state){let e=this.inputs_controller.inputsCount(),t=[];for(let r=0;r<e;r++)t[r]=this._get_clone_required_state(r);this._clone_required_states=t;return}}};var x5=class{constructor(e){this.operationContainer=e}inputsCount(){return this.operationContainer.inputsCount()}initInputsClonedState(e){this._clonedStatesController||(this._clonedStatesController=new y5(this),this._clonedStatesController.initInputsClonedState(e))}cloneRequired(e){var t;let r=(t=this._clonedStatesController)==null?void 0:t.clone_required_state(e);return r!=null?r:!0}override_cloned_state(e){var t;(t=this._clonedStatesController)==null||t.override_cloned_state(e)}};var b5=class{constructor(e,t,r){this.operation=e,this.name=t,this.params={},this._applyDefaultParams(),this._applyInitParams(r),this._initClonedStates()}pathParamResolveRequired(){return this._path_params!=null}resolvePathParams(e){if(!!this._path_params)for(let t of this._path_params)t.resolve(e)}_applyDefaultParams(){let e=this.operation.constructor.DEFAULT_PARAMS,t=Object.keys(e);for(let r of t){let n=e[r],i=this._convertParamData(r,n);i!=null&&(this.params[r]=i)}}_applyInitParams(e){let t=Object.keys(e);for(let r of t){let n=e[r];if(n.simple_data!=null){let i=n.simple_data,s=this.operation.convertExportParamData({paramName:r,paramData:i,params:this.params});s!=null&&(this.params[r]=s)}}}_convertParamData(e,t){if(K.isNumber(t)||K.isBoolean(t)||K.isString(t))return t;if(t instanceof Rn){let r=t.clone();return this._path_params||(this._path_params=[]),this._path_params.push(r),r}if(t instanceof de||t instanceof z||t instanceof M||t instanceof De)return t.clone()}setInput(e,t){this._inputs=this._inputs||[],this._inputs[e]=t}inputsCount(){return this._inputs?this._inputs.length:0}inputsController(){return this._inputsController=this._inputsController||new x5(this)}_initClonedStates(){let e=this.operation.constructor.INPUT_CLONED_STATE;this.inputsController().initInputsClonedState(e)}inputCloneRequired(e){return this._inputsController?this._inputsController.cloneRequired(e):!0}overrideInputCloneState(e){this.inputsController().override_cloned_state(e)}cook(e){return this.operation.cook(e,this.params)}};var T5=class extends b5{constructor(e,t,r){super(e,t,r);this.operation=e,this.name=t,this.init_params=r,this._inputs=[],this._currentInputIndex=0,this._dirty=!0}operationType(){return this.operation.type()}addInput(e){super.setInput(this._currentInputIndex,e),this.incrementInputIndex()}incrementInputIndex(){this._currentInputIndex++}currentInputIndex(){return this._currentInputIndex}setDirty(){if(!this._dirty){this._computeResult=void 0;for(let e=0;e<this._inputs.length;e++)this._inputs[e].setDirty()}}async compute(e,t){if(this._computeResult)return this._computeResult;let r=[],n=t.get(this);n&&n.forEach((s,a)=>{r[a]=e[s]});for(let s=0;s<this._inputs.length;s++){let c=await this._inputs[s].compute(e,t);c&&(this.inputCloneRequired(s)&&(c=c.clone()),r[s]=c)}let i=this.operation.cook(r,this.params);return i?i instanceof Promise?this._computeResult=await i:this._computeResult=i:this._computeResult=void 0,this._dirty=!1,this._computeResult}};var lh=class{constructor(e){this.node=e,this._graph_node=new Kt(e.scene(),"nodeNameController")}dispose(){this._graph_node.dispose(),this._on_set_name_hooks=void 0,this._on_set_fullPath_hooks=void 0}get graph_node(){return this._graph_node}static baseName(e){let t=e.type(),r=t[t.length-1];return K.isNaN(parseInt(r))||(t+="_"),`${t}1`}requestNameToParent(e){let t=this.node.parent();t&&t.childrenAllowed()&&t.childrenController?t.childrenController.setChildName(this.node,e):console.warn("requestNameToParent failed, no parent found")}setName(e){e!=this.node.name()&&this.requestNameToParent(e)}updateNameFromParent(e){var t;if(this.node._setCoreName(e),this._postSetName(),this.runPostSetFullPathHooks(),this.node.childrenAllowed()){let r=(t=this.node.childrenController)==null?void 0:t.children();if(r)for(let n of r)n.nameController.runPostSetFullPathHooks()}this.node.lifecycle.creationCompleted()&&this.node.scene().loadingController.loaded()&&(this.node.scene().missingExpressionReferencesController.checkForMissingNodeReferences(this.node),this.node.scene().expressionsController.regenerateReferringExpressions(this.node)),this.node.scene().referencesController.notifyNameUpdated(this.node),this.node.emit(Nt.NAME_UPDATED)}add_post_set_name_hook(e){this._on_set_name_hooks=this._on_set_name_hooks||[],this._on_set_name_hooks.push(e)}add_post_set_fullPath_hook(e){this._on_set_fullPath_hooks=this._on_set_fullPath_hooks||[],this._on_set_fullPath_hooks.push(e)}_postSetName(){if(this._on_set_name_hooks)for(let e of this._on_set_name_hooks)e()}runPostSetFullPathHooks(){if(this._on_set_fullPath_hooks)for(let e of this._on_set_fullPath_hooks)e()}};var A5=class{constructor(e,t){this.node=e,this._context=t,this._childrenByName=new Map,this._childrenByType=new Map,this._childrenAndGrandchildrenByContext=new Map}get selection(){return this._selection=this._selection||new v5(this.node)}dispose(){let e=this.children();for(let t of e)this.node.removeNode(t);this._selection=void 0}get context(){return this._context}setOutputNodeFindMethod(e){this._output_node_find_method=e}outputNode(){if(this._output_node_find_method)return this._output_node_find_method()}setChildName(e,t){let r;if(t=Ve.sanitizeName(t),(r=this._childrenByName.get(t))!=null)return e.name()===t&&r.graphNodeId()===e.graphNodeId()?void 0:(t=Ve.increment(t),this.setChildName(e,t));{let n=e.name();this._childrenByName.get(n)&&this._childrenByName.delete(n),this._childrenByName.set(t,e),e.nameController.updateNameFromParent(t),this._addToNodesByType(e),this.node.scene().nodesController.addToInstanciatedNode(e)}}_nextAvailableChildName(e){return e=Ve.sanitizeName(e),this._childrenByName.get(e)?this._nextAvailableChildName(Ve.increment(e)):e}node_context_signature(){return`${this.node.context()}/${this.node.type()}`}availableChildrenClasses(){return Q.registeredNodes(this._context,this.node.type())}isValidChildType(e){return this.availableChildrenClasses()[e]!=null}createNode(e,t){if(typeof e=="string"){let r=this._findNodeClass(e);return this._createAndInitNode(r,t)}else return this._createAndInitNode(e,t)}_createAndInitNode(e,t){let r=(t==null?void 0:t.nodeName)||lh.baseName(e),n=this._nextAvailableChildName(r),i=new e(this.node.scene(),n,t);return i.initializeBaseAndNode(),this._addNode(i),i.lifecycle.setCreationCompleted(),i}_findNodeClass(e){let t=this.availableChildrenClasses()[e.toLowerCase()];if(t==null){let r=`child node type '${e}' not found for node '${this.node.path()}'. Available types are: ${Object.keys(this.availableChildrenClasses()).join(", ")}, ${this._context}, ${this.node.type()}`;throw console.error(r),r}return t}createOperationContainer(e,t,r){let n=Q.registeredOperation(this._context,e);if(n==null){let i=`no operation found with context ${this._context}/${e}`;throw console.error(i),i}else{let i=new n(this.node.scene());return new T5(i,t,(r==null?void 0:r.paramsInitValueOverrides)||{})}}_addNode(e){if(e.setParent(this.node),e.params.init(),e.parentController.onSetParent(),e.nameController.runPostSetFullPathHooks(),e.childrenAllowed()&&e.childrenController)for(let t of e.childrenController.children())t.nameController.runPostSetFullPathHooks();return this.node.emit(Nt.CREATED,{child_node_json:e.toJSON()}),this.node.scene().lifecycleController.onAfterCreatedCallbackAllowed()&&e.lifecycle.runOnAfterCreatedCallbacks(),e.lifecycle.runOnAfterAddedCallbacks(),this.node.lifecycle.runOnChildAddCallbacks(e),e.require_webgl2()&&this.node.scene().webgl_controller.set_require_webgl2(),this.node.scene().missingExpressionReferencesController.checkForMissingNodeReferences(e),e}removeNode(e){if(e.parent()!=this.node)return console.warn(`node ${e.name()} not under parent ${this.node.path()}`);{e.lifecycle.runOnBeforeDeleteCallbacks(),this.selection.contains(e)&&this.selection.remove([e]);let t=e.io.connections.firstInputConnection(),r=e.io.connections.inputConnections(),n=e.io.connections.outputConnections();if(r)for(let i of r)i&&i.disconnect({setInput:!0});if(n){for(let i of n)if(i&&(i.disconnect({setInput:!0}),t)){let s=t.node_src,a=i.output_index,c=i.node_dest,l=i.input_index;c.io.inputs.setInput(l,s,a)}}e.setParent(null),this._childrenByName.delete(e.name()),this._removeFromNodesByType(e),this.node.scene().nodesController.removeFromInstanciatedNode(e),e.setSuccessorsDirty(this.node),e.graphDisconnectSuccessors(),this.node.lifecycle.runOnChildRemoveCallbacks(e),e.lifecycle.runOnDeleteCallbacks(),e.dispose(),e.emit(Nt.DELETED,{parent_id:this.node.graphNodeId()})}}_addToNodesByType(e){let t=e.graphNodeId(),r=e.type();Vt.addToSetAtEntry(this._childrenByType,r,t),this._addToChildrenAndGrandchildrenByContext(e)}_removeFromNodesByType(e){let t=e.graphNodeId(),r=e.type();Vt.removeFromSetAtEntry(this._childrenByType,r,t),this._removeFromChildrenAndGrandchildrenByContext(e)}_addToChildrenAndGrandchildrenByContext(e){var t;let r=e.graphNodeId(),n=e.context();Vt.addToSetAtEntry(this._childrenAndGrandchildrenByContext,n,r);let i=this.node.parent();i&&i.childrenAllowed()&&((t=i.childrenController)==null||t._addToChildrenAndGrandchildrenByContext(e))}_removeFromChildrenAndGrandchildrenByContext(e){var t;let r=e.graphNodeId(),n=e.context();Vt.removeFromSetAtEntry(this._childrenAndGrandchildrenByContext,n,r);let i=this.node.parent();i&&i.childrenAllowed()&&((t=i.childrenController)==null||t._removeFromChildrenAndGrandchildrenByContext(e))}nodesByType(e){let t=this._childrenByType.get(e);if(!t)return[];let r=this.node.scene().graph,n=[];for(let i of t){let s=r.nodeFromId(i);s&&n.push(s)}return n}childByName(e){return this._childrenByName.get(e)||null}hasChildrenAndGrandchildrenWithContext(e){return this._childrenAndGrandchildrenByContext.get(e)!=null}children(){let e=[];return this._childrenByName.forEach(t=>{e.push(t)}),e}childrenNames(){let e=[];return this._childrenByName.forEach((t,r)=>{e.push(r)}),e}traverseChildren(e){this._childrenByName.forEach(t=>{var r;e(t),(r=t.childrenController)==null||r.traverseChildren(e)})}};var C5=class{constructor(e){this.node=e,this._creationCompleted=!1}dispose(){this._onChildAddCallbacks=void 0,this._onChildRemoveCallbacks=void 0,this._onAfterCreatedCallbacks=void 0,this._onAfterAddedCallbacks=void 0,this._onBeforeDeletedCallbacks=void 0,this._onAfterDeletedCallbacks=void 0}setCreationCompleted(){this._creationCompleted||(this._creationCompleted=!0)}creationCompleted(){return this.node.scene().loadingController.loaded()&&this._creationCompleted}onChildAdd(e){this._onChildAddCallbacks=this._onChildAddCallbacks||[],this._onChildAddCallbacks.push(e)}runOnChildAddCallbacks(e){this._runCallbacksWithChildNode(this._onChildAddCallbacks,e)}onChildRemove(e){this._onChildRemoveCallbacks=this._onChildRemoveCallbacks||[],this._onChildRemoveCallbacks.push(e)}runOnChildRemoveCallbacks(e){this._runCallbacksWithChildNode(this._onChildRemoveCallbacks,e)}onAfterCreated(e){this._onAfterCreatedCallbacks=this._onAfterCreatedCallbacks||[],this._onAfterCreatedCallbacks.push(e)}runOnAfterCreatedCallbacks(){this._runCallbacks(this._onAfterCreatedCallbacks)}onAfterAdded(e){this._onAfterAddedCallbacks=this._onAfterAddedCallbacks||[],this._onAfterAddedCallbacks.push(e)}runOnAfterAddedCallbacks(){this._runCallbacks(this._onAfterAddedCallbacks)}onBeforeDeleted(e){this._onBeforeDeletedCallbacks=this._onBeforeDeletedCallbacks||[],this._onBeforeDeletedCallbacks.push(e)}runOnBeforeDeleteCallbacks(){this._runCallbacks(this._onBeforeDeletedCallbacks)}onAfterDeleted(e){this._onAfterDeletedCallbacks=this._onAfterDeletedCallbacks||[],this._onAfterDeletedCallbacks.push(e)}runOnDeleteCallbacks(){this._runCallbacks(this._onAfterDeletedCallbacks)}_runCallbacks(e){if(!e)return;let t;for(t of e)t()}_runCallbacksWithChildNode(e,t){if(!e)return;let r;for(r of e)r(t)}};var oe=(o=>(o.ANIM="anim",o.AUDIO="audio",o.COP="cop",o.EVENT="event",o.GL="gl",o.JS="js",o.MANAGER="manager",o.MAT="mat",o.OBJ="obj",o.POST="post",o.ROP="rop",o.SOP="sop",o))(oe||{}),uo=(o=>(o.ANIM="animationsNetwork",o.AUDIO="audioNetwork",o.COP="copNetwork",o.EVENT="eventsNetwork",o.MAT="materialsNetwork",o.POST="postProcessNetwork",o.ROP="renderersNetwork",o.SUBNET="subnet",o))(uo||{}),W1=(o=>(o.INPUT="subnetInput",o.OUTPUT="subnetOutput",o))(W1||{}),E5=(o=>(o.PERSPECTIVE="perspectiveCamera",o.ORTHOGRAPHIC="orthographicCamera",o))(E5||{}),q1=["orthographicCamera","perspectiveCamera"],uh=(o=>(o.ATTRIBUTE="attribute",o))(uh||{}),S5=(o=>(o.DEVICE_ORIENTATION="cameraDeviceOrientationControls",o.MAP="cameraMapControls",o.ORBIT="cameraOrbitControls",o.FIRST_PERSON="firstPersonControls",o.PLAYER="playerControls",o.MOBILE_JOYSTICK="mobileJoystickControls",o))(S5||{}),eN=["cameraDeviceOrientationControls","cameraMapControls","cameraOrbitControls","firstPersonControls","mobileJoystickControls"],wc=(o=>(o.FFT="FFT",o.METER="meter",o.WAVEFORM="waveform",o))(wc||{}),ph=["FFT","meter","waveform"];var hr=class{constructor(e){this._node=e}set_node(e){this._node=e}node(){return this._node}set_content(e){this._content=e,this._post_set_content()}has_content(){return this._content!=null}content(){return this._content}_post_set_content(){}coreContent(){return this._content}coreContentCloned(){return this._content}infos(){return[]}};var w5=class extends hr{set_content(e){super.set_content(e)}setTimelineBuilder(e){return this.set_content(e)}timelineBuilder(){return this.content()}coreContentCloned(){if(this._content)return this._content.clone()}};var M5=class extends hr{setContent(e){super.set_content(e)}setAudioBuilder(e){return this.set_content(e)}audioBuilder(){return this.content()}coreContentCloned(){if(this._content)return this._content.clone()}};var N5=class extends hr{set_content(e){super.set_content(e)}};var tN=new M,rN=new De,oN=new De,AK=new M,nN=new Ue,ra=class extends ct{constructor(e,t){super(e,t);this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Ue,this.bindMatrixInverse=new Ue}copy(e){return super.copy(e),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,this}bind(e,t){this.skeleton=e,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){let e=new De,t=this.geometry.attributes.skinWeight;for(let r=0,n=t.count;r<n;r++){e.x=t.getX(r),e.y=t.getY(r),e.z=t.getZ(r),e.w=t.getW(r);let i=1/e.manhattanLength();i!==1/0?e.multiplyScalar(i):e.set(1,0,0,0),t.setXYZW(r,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode==="attached"?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode==="detached"?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}boneTransform(e,t){let r=this.skeleton,n=this.geometry;rN.fromBufferAttribute(n.attributes.skinIndex,e),oN.fromBufferAttribute(n.attributes.skinWeight,e),tN.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let i=0;i<4;i++){let s=oN.getComponent(i);if(s!==0){let a=rN.getComponent(i);nN.multiplyMatrices(r.bones[a].matrixWorld,r.boneInverses[a]),t.addScaledVector(AK.copy(tN).applyMatrix4(nN),s)}}return t.applyMatrix4(this.bindMatrixInverse)}};ra.prototype.isSkinnedMesh=!0;var ii=class extends vt{constructor(){super();this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){let t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),t}};ii.prototype.isScene=!0;var ws=class extends vt{constructor(){super();this.type="Bone"}};ws.prototype.isBone=!0;var In=class extends Ut{constructor(e){super();this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new de(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new de(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=hn,this.normalScale=new z(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this}};In.prototype.isMeshStandardMaterial=!0;var X1=new M,iN=new M,Bu=class extends vt{constructor(){super();this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);let t=e.levels;for(let r=0,n=t.length;r<n;r++){let i=t[r];this.addLevel(i.object.clone(),i.distance)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,t=0){t=Math.abs(t);let r=this.levels,n;for(n=0;n<r.length&&!(t<r[n].distance);n++);return r.splice(n,0,{distance:t,object:e}),this.add(e),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){let t=this.levels;if(t.length>0){let r,n;for(r=1,n=t.length;r<n&&!(e<t[r].distance);r++);return t[r-1].object}return null}raycast(e,t){if(this.levels.length>0){X1.setFromMatrixPosition(this.matrixWorld);let n=e.ray.origin.distanceTo(X1);this.getObjectForDistance(n).raycast(e,t)}}update(e){let t=this.levels;if(t.length>1){X1.setFromMatrixPosition(e.matrixWorld),iN.setFromMatrixPosition(this.matrixWorld);let r=X1.distanceTo(iN)/e.zoom;t[0].object.visible=!0;let n,i;for(n=1,i=t.length;n<i&&r>=t[n].distance;n++)t[n-1].object.visible=!1,t[n].object.visible=!0;for(this._currentLevel=n-1;n<i;n++)t[n].object.visible=!1}}toJSON(e){let t=super.toJSON(e);this.autoUpdate===!1&&(t.object.autoUpdate=!1),t.object.levels=[];let r=this.levels;for(let n=0,i=r.length;n<i;n++){let s=r[n];t.object.levels.push({object:s.object.uuid,distance:s.distance})}return t}};var jt=(o=>(o.OBJECT3D="Object3D",o.GROUP="Group",o.MESH="Mesh",o.POINTS="Points",o.LINE_SEGMENTS="LineSegments",o.LOD="LOD",o))(jt||{}),sN={Mesh:ct,Group:st,Points:ri,LineSegments:Gr,Object3D:vt,LOD:Bu};function si(o){switch(o){case vt:return"Object3D";case st:return"Group";case ct:return"Mesh";case ri:return"Points";case Gr:return"LineSegments";case Bu:return"LOD";default:return Q.warn("object type not supported",o),"Mesh"}}function aN(o){if(o instanceof ct)return"Mesh";if(o instanceof st)return"Group";if(o instanceof Gr)return"LineSegments";if(o instanceof ri)return"Points";if(o instanceof vt)return"Object3D";Q.warn("ObjectTypeByObject received an unknown object type",o)}var oa=["Mesh","Points","LineSegments"],cN=[{name:"Mesh",value:oa.indexOf("Mesh")},{name:"Points",value:oa.indexOf("Points")},{name:"LineSegments",value:oa.indexOf("LineSegments")}],CK={MeshStandard:new In({color:16777215,side:gr,metalness:.5,roughness:.9}),Mesh:new In({color:16777215,side:gr,metalness:0,roughness:.9}),Points:new c0({color:16777215,size:.1,depthTest:!0}),LineSegments:new ir({color:16777215,linewidth:1})},xr=(o=>(o[o.VERTEX=0]="VERTEX",o[o.OBJECT=1]="OBJECT",o))(xr||{}),Do=[0,1],Fu=[{name:"vertex",value:0},{name:"object",value:1}],Ge=(o=>(o[o.NUMERIC=0]="NUMERIC",o[o.STRING=1]="STRING",o))(Ge||{}),Et=[0,1],na=[{name:"numeric",value:0},{name:"string",value:1}],Ln=(o=>(o[o.FLOAT=1]="FLOAT",o[o.VECTOR2=2]="VECTOR2",o[o.VECTOR3=3]="VECTOR3",o[o.VECTOR4=4]="VECTOR4",o))(Ln||{}),lN=[1,2,3,4],uN=[1,4],Mc={ATTRIB_CLASS:{VERTEX:0,OBJECT:1},OBJECT_TYPES:oa,CONSTRUCTOR_NAMES_BY_CONSTRUCTOR_NAME:{[ii.name]:"Scene",[st.name]:"Group",[vt.name]:"Object3D",[ct.name]:"Mesh",[ri.name]:"Points",[Gr.name]:"LineSegments",[ws.name]:"Bone",[ra.name]:"SkinnedMesh"},CONSTRUCTORS_BY_NAME:{Mesh:ct,Points:ri,LineSegments:Gr},MATERIALS:CK};var mr=(o=>(o.POINT_INDEX="ptnum",o.OBJECT_INDEX="objnum",o.COLOR="color",o.NORMAL="normal",o.POSITION="position",o.PSCALE="pscale",o.UP="up",o.UV="uv",o.SCALE="scale",o.TANGENT="tangent",o))(mr||{}),EK={P:"position",N:"normal",Cd:"color"},Ot=class{static remapName(e){return EK[e]||e}static arrayToIndexedArrays(e){let t={},r=0,n=[],i=[],s=0;for(;s<e.length;){let a=e[s],c=t[a];c!=null?n.push(c):(i.push(a),n.push(r),t[a]=r,r+=1),s++}return{indices:n,values:i}}static default_value(e){switch(e){case 1:return 0;case 2:return new z(0,0);case 3:return new M(0,0,0);default:throw`size ${e} not yet implemented`}}static copy(e,t,r=!0){let n=e==null?void 0:e.array,i=t==null?void 0:t.array;if(n&&i){let s=Math.min(n.length,i.length);for(let a=0;a<s;a++)i[a]=n[a];r&&(t.needsUpdate=!0)}}static attribSizeFromValue(e){if(K.isString(e)||K.isNumber(e))return Ln.FLOAT;if(K.isArray(e))return e.length;switch(e.constructor){case z:return Ln.VECTOR2;case M:return Ln.VECTOR3;case De:return Ln.VECTOR4}return 0}};var dh=class{constructor(e){this._index=e}index(){return this._index}};var Y1={POSITION:"position",NORMAL:"normal"};var SK={x:0,y:1,z:2,w:3,r:0,g:1,b:2},wK=".",d0=class extends dh{constructor(e,t){super(t);this._coreGeometry=e,this._geometry=this._coreGeometry.geometry()}applyMatrix4(e){this.position().applyMatrix4(e)}coreGeometry(){return this._coreGeometry}geometry(){return this._geometry=this._geometry||this._coreGeometry.geometry()}attribSize(e){return e=Ot.remapName(e),this._geometry.getAttribute(e).itemSize}hasAttrib(e){let t=Ot.remapName(e);return this._coreGeometry.hasAttrib(t)}attribValue(e,t){if(e===mr.POINT_INDEX)return this.index();{let r=null,n=null;e[e.length-2]===wK&&(r=e[e.length-1],n=SK[r],e=e.substring(0,e.length-2));let i=Ot.remapName(e),s=this._geometry.getAttribute(i);if(s){let{array:a}=s;if(this._coreGeometry.isAttribIndexed(i))return this.indexedAttribValue(i);{let c=s.itemSize,l=this._index*c;if(n==null)switch(c){case 1:return a[l];case 2:return t=t||new z,t.fromArray(a,l),t;break;case 3:return t=t||new M,t.fromArray(a,l),t;break;case 4:return t=t||new De,t.fromArray(a,l),t;break;default:throw`size not valid (${c})`}else switch(c){case 1:return a[l];default:return a[l+n]}}}else{let a=`attrib ${e} not found. availables are: ${Object.keys(this._geometry.attributes||{}).join(",")}`;throw console.warn(a),a}}}attribValueNumber(e){let t=Ot.remapName(e);return this._geometry.getAttribute(t).array[this._index]}attribValueVector2(e,t){let r=Ot.remapName(e),n=this._geometry.getAttribute(r);return t.fromArray(n.array,this._index*2),t}attribValueVector3(e,t){let r=Ot.remapName(e),n=this._geometry.getAttribute(r);return t.fromArray(n.array,this._index*3),t}attribValueVector4(e,t){let r=Ot.remapName(e),n=this._geometry.getAttribute(r);return t.fromArray(n.array,this._index*4),t}indexedAttribValue(e){let t=this.attribValueIndex(e);return this._coreGeometry.userDataAttrib(e)[t]}stringAttribValue(e){return this.indexedAttribValue(e)}attribValueIndex(e){return this._coreGeometry.isAttribIndexed(e)?this._geometry.getAttribute(e).array[this._index]:-1}isAttribIndexed(e){return this._coreGeometry.isAttribIndexed(e)}position(){return this._position||(this._position=this.getPosition(new M))}getPosition(e){let{array:t}=this._geometry.getAttribute(Y1.POSITION);return e.fromArray(t,this._index*3)}setPosition(e){this.setAttribValueVector3(Y1.POSITION,e)}normal(){return this._normal=this._normal||this.getNormal(new M)}getNormal(e){let{array:t}=this._geometry.getAttribute(Y1.NORMAL);return e.fromArray(t,this._index*3)}setNormal(e){return this.setAttribValueVector3(Y1.NORMAL,e)}setAttribValue(e,t){let r=this._geometry.getAttribute(e),n=r.array,i=r.itemSize;if(K.isArray(t)){for(let s=0;s<i;s++)n[this._index*i+s]=t[s];return}switch(i){case 1:n[this._index]=t;break;case 2:let s=t,a=this._index*2;n[a+0]=s.x,n[a+1]=s.y;break;case 3:let c=t.r!=null,l=this._index*3;if(c){let d=t;n[l+0]=d.r,n[l+1]=d.g,n[l+2]=d.b}else{let d=t;n[l+0]=d.x,n[l+1]=d.y,n[l+2]=d.z}break;case 4:let u=t,p=this._index*4;n[p+0]=u.x,n[p+1]=u.y,n[p+2]=u.z,n[p+3]=u.w;break;default:throw console.warn(`Point.set_attrib_value does not yet allow attrib size ${i}`),`attrib size ${i} not implemented`}}setAttribValueFromNumber(e,t){let n=this._geometry.getAttribute(e).array;n[this._index]=t}setAttribValueFromVector2(e,t){let r=this._geometry.getAttribute(e);t.toArray(r.array,this._index*2)}setAttribValueFromVector3(e,t){let r=this._geometry.getAttribute(e);t.toArray(r.array,this._index*3)}setAttribValueFromVector4(e,t){let r=this._geometry.getAttribute(e);t.toArray(r.array,this._index*4)}setAttribValueVector3(e,t){if(t==null)return;if(e==null)throw"Point.set_attrib_value requires a name";let n=this._geometry.getAttribute(e).array,i=this._index*3;n[i]=t.x,n[i+1]=t.y,n[i+2]=t.z}setAttribIndex(e,t){let r=this._geometry.getAttribute(e).array;return r[this._index]=t}};var $1=function(o){return function(e){return Math.pow(e,o)}},K1=function(o){return function(e){return 1-Math.abs(Math.pow(e-1,o))}},O5=function(o){return function(e){return e<.5?$1(o)(e*2)/2:K1(o)(e*2-1)/2+.5}},J1={ease_i2:$1(2),ease_o2:K1(2),ease_io2:O5(2),ease_i3:$1(3),ease_o3:K1(3),ease_io3:O5(3),ease_i4:$1(4),ease_o4:K1(4),ease_io4:O5(4),ease_i_sin:function(o){return 1+Math.sin(Math.PI/2*o-Math.PI/2)},ease_o_sin:function(o){return Math.sin(Math.PI/2*o)},ease_io_sin:function(o){return(1+Math.sin(Math.PI*o-Math.PI/2))/2},ease_i_elastic:function(o){return o==0?0:(.04-.04/o)*Math.sin(25*o)+1},ease_o_elastic:function(o){return o==1?1:.04*o/--o*Math.sin(25*o)},ease_io_elastic:function(o){return o==.5?0:(o-=.5)<0?(.02+.01/o)*Math.sin(50*o):(.02-.01/o)*Math.sin(50*o)+1}};var pN=Math.PI/180,MK=12.9898,NK=78.233,OK=43758.5453,Mr=class{static clamp(e,t,r){return e<t?t:e>r?r:e}static fit01(e,t,r){return this.fit(e,0,1,t,r)}static fit(e,t,r,n,i){let s=r-t,a=i-n;return(e-t)/s*a+n}static blend(e,t,r){return(1-r)*e+r*t}static degrees_to_radians(e){return e*pN}static radians_to_degrees(e){return e/pN}static deg2rad(e){return this.degrees_to_radians(e)}static rad2deg(e){return this.radians_to_degrees(e)}static rand(e){return K.isNumber(e)?this.randFloat(e):this.randVec2(e)}static round(e,t){let r=e/t;return(e<0?Math.ceil(r):Math.floor(r))*t}static highest_even(e){return 2*Math.ceil(e*.5)}static randFloat(e,t=136574){return this._vec.x=e,this._vec.y=t,this.randVec2(this._vec)}static randVec2(e){let r=(e.x*MK+e.y*NK)%Math.PI;return this.fract(Math.sin(r)*OK)}static geodesic_distance(e,t){var r=6371e3,n=this.deg2rad(e.lat),i=this.deg2rad(t.lat),s=this.deg2rad(t.lat-e.lat),a=this.deg2rad(t.lng-e.lng),c=Math.sin(s/2)*Math.sin(s/2)+Math.cos(n)*Math.cos(i)*Math.sin(a/2)*Math.sin(a/2),l=2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c)),u=r*l;return u}static expand_triangle(e,t){e.getMidpoint(this._triangle_mid),this._triangle_mid_to_corner.copy(e.a).sub(this._triangle_mid),this._triangle_mid_to_corner.normalize().multiplyScalar(t),e.a.add(this._triangle_mid_to_corner),this._triangle_mid_to_corner.copy(e.b).sub(this._triangle_mid),this._triangle_mid_to_corner.normalize().multiplyScalar(t),e.b.add(this._triangle_mid_to_corner),this._triangle_mid_to_corner.copy(e.c).sub(this._triangle_mid),this._triangle_mid_to_corner.normalize().multiplyScalar(t),e.c.add(this._triangle_mid_to_corner)}static nearestPower2(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.log(2)))}static pow2Inverse(e){return Math.log(e)/Math.log(2)}};Mr.Easing=J1;Mr.fract=o=>o-Math.floor(o);Mr._vec={x:0,y:136574};Mr._triangle_mid=new M;Mr._triangle_mid_to_corner=new M;var P5=class{constructor(e,t){this._coreGeometry=e,this._index=t,this._geometry=this._coreGeometry.geometry()}index(){return this._index}points(){return this._points=this._points||this._get_points()}applyMatrix4(e){for(let t of this.points())t.applyMatrix4(e)}_get_points(){var e;let t=((e=this._geometry.index)==null?void 0:e.array)||[],r=this._index*3;return[new d0(this._coreGeometry,t[r+0]),new d0(this._coreGeometry,t[r+1]),new d0(this._coreGeometry,t[r+2])]}positions(){return this._positions=this._positions||this._getPositions()}_getPositions(){let e=this.points();return[e[0].position(),e[1].position(),e[2].position()]}triangle(){return this._triangle=this._triangle||this._get_triangle()}_get_triangle(){let e=this.positions();return new mn(e[0],e[1],e[2])}deltas(){return this._deltas=this._deltas||this._getDeltas()}_getDeltas(){let e=this.positions();return[e[1].clone().sub(e[0]),e[2].clone().sub(e[0])]}area(){return this.triangle().getArea()}center(e){let t=this.positions();return e.x=(t[0].x+t[1].x+t[2].x)/3,e.y=(t[0].y+t[1].y+t[2].y)/3,e.z=(t[0].z+t[1].z+t[2].z)/3,e}randomPosition(e){let t=[Mr.randFloat(e),Mr.randFloat(e*6541)];return t[0]+t[1]>1&&(t[0]=1-t[0],t[1]=1-t[1]),this.positions()[0].clone().add(this.deltas()[0].clone().multiplyScalar(t[0])).add(this.deltas()[1].clone().multiplyScalar(t[1]))}attribValueAtPosition(e,t){let r=new M;this.triangle().getBarycoord(t,r);let n=r.toArray(),s=this._geometry.attributes[e].itemSize,a=this.points().map(p=>p.attribValue(e)),c,l,u=0;switch(s){case 1:{l=0;for(let p of a)l+=p*n[u],u++;c=l;break}default:{for(let p of a){let d=p.multiplyScalar(n[u]);l?l.add(d):l=d,u++}c=l}}return c}static interpolatedValue(e,t,r,n){let i=[t.a,t.b,t.c],a=e.getAttribute("position").array,c=i.map(g=>new M(a[g*3+0],a[g*3+1],a[g*3+2])),l=n.itemSize,u=n.array,p=[];switch(l){case 1:p=i.map(g=>u[g]);break;case 2:p=i.map(g=>new z(u[g*2+0],u[g*2+1]));break;case 3:p=i.map(g=>new M(u[g*3+0],u[g*3+1],u[g*3+2]));break}let d=i.map((g,_)=>r.distanceTo(c[_])),h=Qe.sum([d[0]*d[1],d[0]*d[2],d[1]*d[2]]),m=[d[1]*d[2]/h,d[0]*d[2]/h,d[0]*d[1]/h],f;switch(l){case 1:f=Qe.sum(i.map((g,_)=>m[_]*p[_]));break;default:var v=i.map((g,_)=>p[_].multiplyScalar(m[_]));f=null;for(let g of v)f?f.add(g):f=g}return f}};var Nc=class{from_points(e){e=this._filter_points(e);let t=new Re,r=new At(t),n=e[0];if(n!=null){let i=n.geometry(),s=n.coreGeometry(),a={};for(let u=0;u<e.length;u++)a[e[u].index()]=u;let c=this._indices_from_points(a,i);c&&t.setIndex(c);let{attributes:l}=i;for(let u of Object.keys(l))if(s.userDataAttribs()[u]!=null){let h=Qe.uniq(e.map(v=>v.indexedAttribValue(u))),m={};h.forEach((v,g)=>m[v]=g),r.userDataAttribs()[u]=h;let f=[];for(let v of e){let g=m[v.indexedAttribValue(u)];f.push(g)}t.setAttribute(u,new Ce(f,1))}else{let h=l[u].itemSize,m=new Array(e.length*h);switch(h){case 1:for(let v=0;v<e.length;v++)m[v]=e[v].attribValue(u);break;default:let f;for(let v=0;v<e.length;v++)f=e[v].attribValue(u),f.toArray(m,v*h);break}t.setAttribute(u,new Ce(m,h))}}return t}};var R5=class extends Nc{_filter_points(e){return e}_indices_from_points(e,t){let r=t.index;if(r!=null){let n=r.array,i=[],s,a;for(let c=0;c<n.length;c++)s=n[c],a=e[s],a!=null&&i.push(a);return i}}};var h0=class{constructor(e,t){this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=nb,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=ti()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,r){e*=this.stride,r*=t.stride;for(let n=0,i=this.stride;n<i;n++)this.array[e+n]=t.array[r+n];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=ti()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);let t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),r=new this.constructor(t,this.stride);return r.setUsage(this.usage),r}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=ti()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}};h0.prototype.isInterleavedBuffer=!0;var Ir=new M,Dn=class{constructor(e,t,r,n=!1){this.name="",this.data=e,this.itemSize=t,this.offset=r,this.normalized=n===!0}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,r=this.data.count;t<r;t++)Ir.x=this.getX(t),Ir.y=this.getY(t),Ir.z=this.getZ(t),Ir.applyMatrix4(e),this.setXYZ(t,Ir.x,Ir.y,Ir.z);return this}applyNormalMatrix(e){for(let t=0,r=this.count;t<r;t++)Ir.x=this.getX(t),Ir.y=this.getY(t),Ir.z=this.getZ(t),Ir.applyNormalMatrix(e),this.setXYZ(t,Ir.x,Ir.y,Ir.z);return this}transformDirection(e){for(let t=0,r=this.count;t<r;t++)Ir.x=this.getX(t),Ir.y=this.getY(t),Ir.z=this.getZ(t),Ir.transformDirection(e),this.setXYZ(t,Ir.x,Ir.y,Ir.z);return this}setX(e,t){return this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){return this.data.array[e*this.data.stride+this.offset]}getY(e){return this.data.array[e*this.data.stride+this.offset+1]}getZ(e){return this.data.array[e*this.data.stride+this.offset+2]}getW(e){return this.data.array[e*this.data.stride+this.offset+3]}setXY(e,t,r){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=r,this}setXYZ(e,t,r,n){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=n,this}setXYZW(e,t,r,n,i){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=n,this.data.array[e+3]=i,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");let t=[];for(let r=0;r<this.count;r++){let n=r*this.data.stride+this.offset;for(let i=0;i<this.itemSize;i++)t.push(this.data.array[n+i])}return new Tt(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new Dn(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");let t=[];for(let r=0;r<this.count;r++){let n=r*this.data.stride+this.offset;for(let i=0;i<this.itemSize;i++)t.push(this.data.array[n+i])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}};Dn.prototype.isInterleavedBufferAttribute=!0;function hN(o,e=!1){let t=o[0].index!==null,r=new Set(Object.keys(o[0].attributes)),n=new Set(Object.keys(o[0].morphAttributes)),i={},s={},a=o[0].morphTargetsRelative,c=new Re,l=0;for(let u=0;u<o.length;++u){let p=o[u],d=0;if(t!==(p.index!==null))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(let h in p.attributes){if(!r.has(h))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+'. All geometries must have compatible attributes; make sure "'+h+'" attribute exists among all geometries, or in none of them.'),null;i[h]===void 0&&(i[h]=[]),i[h].push(p.attributes[h]),d++}if(d!==r.size)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+". Make sure all geometries have the same number of attributes."),null;if(a!==p.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(let h in p.morphAttributes){if(!n.has(h))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+".  .morphAttributes must be consistent throughout all geometries."),null;s[h]===void 0&&(s[h]=[]),s[h].push(p.morphAttributes[h])}if(c.userData.mergedUserData=c.userData.mergedUserData||[],c.userData.mergedUserData.push(p.userData),e){let h;if(t)h=p.index.count;else if(p.attributes.position!==void 0)h=p.attributes.position.count;else return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+". The geometry must have either an index or a position attribute"),null;c.addGroup(l,h,u),l+=h}}if(t){let u=0,p=[];for(let d=0;d<o.length;++d){let h=o[d].index;for(let m=0;m<h.count;++m)p.push(h.getX(m)+u);u+=o[d].attributes.position.count}c.setIndex(p)}for(let u in i){let p=dN(i[u]);if(!p)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+u+" attribute."),null;c.setAttribute(u,p)}for(let u in s){let p=s[u][0].length;if(p===0)break;c.morphAttributes=c.morphAttributes||{},c.morphAttributes[u]=[];for(let d=0;d<p;++d){let h=[];for(let f=0;f<s[u].length;++f)h.push(s[u][f][d]);let m=dN(h);if(!m)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+u+" morphAttribute."),null;c.morphAttributes[u].push(m)}}return c}function dN(o){let e,t,r,n=0;for(let a=0;a<o.length;++a){let c=o[a];if(c.isInterleavedBufferAttribute)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. InterleavedBufferAttributes are not supported."),null;if(e===void 0&&(e=c.array.constructor),e!==c.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(t===void 0&&(t=c.itemSize),t!==c.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(r===void 0&&(r=c.normalized),r!==c.normalized)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;n+=c.array.length}let i=new e(n),s=0;for(let a=0;a<o.length;++a)i.set(o[a].array,s),s+=o[a].array.length;return new Tt(i,t,r)}var PK="position",hh=class{static createIndexIfNone(e){if(!e.index){let t=e.getAttribute(PK);if(t){let r=t.array;e.setIndex(Qe.range(r.length/3))}}}};var Z1=class{static merge(e){if(e.length===0)return;for(let a of e)hh.createIndexIfNone(a);let t=e.map(a=>new At(a)),r=t[0].indexedAttributeNames(),n={};for(let a of r){let c={},l=[];for(let p of t){let d=p.points();for(let h of d){l.push(h);let m=h.indexedAttribValue(a);c[m]!=null?c[m]:c[m]=Object.keys(c).length}}let u=Object.keys(c);for(let p of l){let d=p.indexedAttribValue(a),h=c[d];p.setAttribIndex(a,h)}n[a]=u}let i=hN(e),s=new At(i);return Object.keys(n).forEach(a=>{let c=n[a];s.setIndexedAttributeValues(a,c)}),i&&delete i.userData.mergedUserData,i}};var I5=class extends Nc{_filter_points(e){var t;let r=e[0];if(r){let i=(t=r.geometry().getIndex())==null?void 0:t.array;if(i){let s={};for(let d of e)s[d.index()]=d;let a=[],c=i.length,l,u,p;for(let d=0;d<c;d+=3)l=s[i[d+0]],u=s[i[d+1]],p=s[i[d+2]],l&&u&&p&&(a.push(l),a.push(u),a.push(p));return a}}return[]}_indices_from_points(e,t){let r=t.index;if(r!=null){let n=r.array,i=[],s,a,c,l,u,p;for(let d=0;d<n.length;d+=3)s=n[d+0],a=n[d+1],c=n[d+2],l=e[s],u=e[a],p=e[c],l!=null&&u!=null&&p!=null&&(i.push(l),i.push(u),i.push(p));return i}}};var L5=class extends Nc{_filter_points(e){var t;let r=e[0];if(r){let i=(t=r.geometry().getIndex())==null?void 0:t.array;if(i){let s={};for(let p of e)s[p.index()]=p;let a=[],c=i.length,l,u;for(let p=0;p<c;p+=2)l=s[i[p+0]],u=s[i[p+1]],l&&u&&(a.push(l),a.push(u));return a}}return[]}_indices_from_points(e,t){let r=t.index;if(r!=null){let n=r.array,i=[],s,a,c,l;for(let u=0;u<n.length;u+=2)s=n[u],a=n[u+1],c=e[s],l=e[a],c!=null&&l!=null&&(i.push(c),i.push(l));return i}}};var fN="isInstance",mN="indexed_attrib_values",fh=class{constructor(o){this._geometry=o}dispose(){}geometry(){return this._geometry}uuid(){return this._geometry.uuid}boundingBox(){return this._bounding_box=this._bounding_box||this._create_bounding_box()}_create_bounding_box(){if(this._geometry.computeBoundingBox(),this._geometry.boundingBox)return this._geometry.boundingBox}markAsInstance(){this._geometry.userData[fN]=!0}static markedAsInstance(o){return o.userData[fN]===!0}markedAsInstance(){return fh.markedAsInstance(this._geometry)}positionAttribName(){let o="position";return this.markedAsInstance()&&(o="instancePosition"),o}computeVertexNormals(){this._geometry.computeVertexNormals()}userDataAttribs(){return this._geometry.userData[mN]=this._geometry.userData[mN]||{}}indexedAttributeNames(){return Object.keys(this.userDataAttribs()||{})}userDataAttrib(o){return o=Ot.remapName(o),this.userDataAttribs()[o]}isAttribIndexed(o){return o=Ot.remapName(o),this.userDataAttrib(o)!=null}hasAttrib(o){return o===mr.POINT_INDEX?!0:(o=Ot.remapName(o),this._geometry.attributes[o]!=null)}markAttribAsNeedsUpdate(o){o=Ot.remapName(o);let e=this._geometry.attributes[o];e&&(e.needsUpdate=!0)}attribType(o){return this.isAttribIndexed(o)?Ge.STRING:Ge.NUMERIC}static attribNames(o){return Object.keys(o.attributes)}attribNames(){return fh.attribNames(this._geometry)}static attribNamesMatchingMask(o,e){let t=Ve.attribNames(e),r=[];for(let n of this.attribNames(o))for(let i of t)Ve.matchMask(n,i)&&r.push(n);return Qe.uniq(r)}attribSizes(){let o={};for(let e of this.attribNames())o[e]=this._geometry.attributes[e].itemSize;return o}attribSize(o){let e;return o=Ot.remapName(o),(e=this._geometry.attributes[o])!=null?e.itemSize:o===mr.POINT_INDEX?1:0}setIndexedAttributeValues(o,e){this.userDataAttribs()[o]=e}setIndexedAttribute(o,e,t){this.setIndexedAttributeValues(o,e),this._geometry.setAttribute(o,new cb(t,1)),this._geometry.getAttribute(o).needsUpdate=!0}addNumericAttrib(o,e=1,t=0){let r=[],n=!1;if(K.isNumber(t)){for(let i=0;i<this.pointsCount();i++)for(let s=0;s<e;s++)r.push(t);n=!0}else if(e>1)if(K.isArray(t)){for(let i=0;i<this.pointsCount();i++)for(let s=0;s<e;s++)r.push(t[s]);n=!0}else{let i=t;if(e==2&&i.x!=null&&i.y!=null){for(let l=0;l<this.pointsCount();l++)r.push(i.x),r.push(i.y);n=!0}let s=t;if(e==3&&s.x!=null&&s.y!=null&&s.z!=null){for(let l=0;l<this.pointsCount();l++)r.push(s.x),r.push(s.y),r.push(s.z);n=!0}let a=t;if(e==3&&a.r!=null&&a.g!=null&&a.b!=null){for(let l=0;l<this.pointsCount();l++)r.push(a.r),r.push(a.g),r.push(a.b);n=!0}let c=t;if(e==4&&c.x!=null&&c.y!=null&&c.z!=null&&c.w!=null){for(let l=0;l<this.pointsCount();l++)r.push(c.x),r.push(c.y),r.push(c.z),r.push(c.w);n=!0}}if(n)this._geometry.setAttribute(o.trim(),new Ce(r,e));else throw console.warn(t),`CoreGeometry.add_numeric_attrib error: no other default value allowed for now in add_numeric_attrib (default given: ${t})`}initPositionAttribute(o,e){let t=[];e==null&&(e=new M);for(let r=0;r<o;r++)t.push(e.x),t.push(e.y),t.push(e.z);return this._geometry.setAttribute("position",new Ce(t,3))}addAttribute(o,e){switch(e.type()){case Ge.STRING:return console.log("TODO: to implement");case Ge.NUMERIC:return this.addNumericAttrib(o,e.size())}}renameAttrib(o,e){this.isAttribIndexed(o)&&(this.userDataAttribs()[e]=wr.clone(this.userDataAttribs()[o]),delete this.userDataAttribs()[o]);let t=this._geometry.getAttribute(o);return this._geometry.setAttribute(e.trim(),new Ce(t.array,t.itemSize)),this._geometry.deleteAttribute(o)}deleteAttribute(o){return this.isAttribIndexed(o)&&delete this.userDataAttribs()[o],this._geometry.deleteAttribute(o)}clone(){return fh.clone(this._geometry)}static clone(o){let e,t=o.clone();return(e=o.userData)!=null&&(t.userData=wr.cloneDeep(e)),t}pointsCount(){return fh.pointsCount(this._geometry)}static pointsCount(o){let e,t=0,r=new this(o),n="position";if(r.markedAsInstance()&&(n="instancePosition"),(e=o.getAttribute(n))!=null){let i;(i=e.array)!=null&&(t=i.length/3)}return t}points(){return this.pointsFromGeometry()}pointsFromGeometry(){let o=[],e=this._geometry.getAttribute(this.positionAttribName());if(e!=null){let t=e.array.length/3;for(let r=0;r<t;r++){let n=new d0(this,r);o.push(n)}}return o}static geometryFromPoints(o,e){switch(e){case jt.MESH:return this._mesh_builder.from_points(o);case jt.POINTS:return this._points_builder.from_points(o);case jt.LINE_SEGMENTS:return this._lines_segment_builder.from_points(o);case jt.OBJECT3D:return null;case jt.GROUP:return null;case jt.LOD:return null}Be.unreachable(e)}static mergeGeometries(o){return Z1.merge(o)}static merge_geometries(o){return Z1.merge(o)}segments(){var o;let e=((o=this.geometry().index)==null?void 0:o.array)||[];return Qe.chunk(e,2)}faces(){return this.facesFromGeometry()}facesFromGeometry(){var o;let t=(((o=this.geometry().index)==null?void 0:o.array)||[]).length/3;return Qe.range(t).map(r=>new P5(this,r))}},At=fh;At._mesh_builder=new I5;At._points_builder=new R5;At._lines_segment_builder=new L5;var J=(o=>(o.BOOLEAN="boolean",o.BUTTON="button",o.COLOR="color",o.FLOAT="float",o.FOLDER="folder",o.INTEGER="integer",o.PARAM_PATH="param_path",o.NODE_PATH="node_path",o.RAMP="ramp",o.STRING="string",o.VECTOR2="vector2",o.VECTOR3="vector3",o.VECTOR4="vector4",o))(J||{});var mh=class{constructor(e,t,r){if(this._type=e,this._name=t,this._defaultValue=r,t==""||t==null)throw new Error("name must not be an empty string")}static fromParam(e){return new mh(e.type(),e.name(),e.defaultValue())}type(){return this._type}name(){return this._name}defaultValue(){return this._defaultValue}paramOptions(){let e=this._callback.bind(this);switch(this._type){case J.NODE_PATH:return{callback:e,nodeSelection:{context:oe.COP}};default:return{callback:e}}}applyToNode(e){if(!e.params.has(this._name))return;let t=e.params.get(this._name);if(!t)return;let r=this.paramOptions(),n=Object.keys(r);for(let i of n)t.options.setOption(i,r[i]);this.executeCallback(e,t),t.type()==J.NODE_PATH&&setTimeout(async()=>{t.isDirty()&&await t.compute(),t.options.executeCallback()},200)}executeCallback(e,t){this._callback(e,t)}_callback(e,t){}};var Ms=class extends mh{constructor(e,t,r,n){super(e,t,r);this._uniformName=n}toJSON(){return{type:this._type,name:this._name,defaultValue:this._defaultValue,uniformName:this._uniformName}}static fromJSON(e){return new Ms(e.type,e.name,e.defaultValue,e.uniformName)}uniformName(){return this._uniformName}uniform(){return this._uniform=this._uniform||this._createUniform()}_createUniform(){return Ms.uniformByType(this._type)}_callback(e,t){Ms.callback(t,this.uniform())}static callback(e,t){switch(e.type()){case J.RAMP:t.value=e.rampTexture();return;case J.NODE_PATH:Ms.set_uniform_value_from_texture_from_node_path_param(e,t);return;default:t.value=e.value}}static uniformByType(e){switch(e){case J.BOOLEAN:return{value:0};case J.BUTTON:return{value:0};case J.COLOR:return{value:new de(0,0,0)};case J.FLOAT:return{value:0};case J.FOLDER:return{value:0};case J.INTEGER:return{value:0};case J.NODE_PATH:return{value:0};case J.PARAM_PATH:return{value:0};case J.RAMP:return{value:null};case J.STRING:return{value:null};case J.VECTOR2:return{value:new z(0,0)};case J.VECTOR3:return{value:new M(0,0,0)};case J.VECTOR4:return{value:new De(0,0,0,0)}}Be.unreachable(e)}static async set_uniform_value_from_texture_from_node_path_param(e,t){e.isDirty()&&await e.compute();let r=e.value.nodeWithContext(oe.COP);if(r)if(r.isDirty())r.compute().then(n=>{let i=n.texture();t.value=i});else{let i=r.containerController.container().texture();t.value=i}else t.value=null}set_uniform_value_from_ramp(e,t){t.value=e.rampTexture()}};function _N(o,e,t){let r=Uu.getUniforms(o);if(r){let n=r[e];n?n.value=t.value:r[e]=t}else sa.addAdditionalTexture(o,e,t)}var Uu=class{static getUniforms(e){var t;return(t=e.userData)==null?void 0:t.uniforms}static setUniforms(e,t){e.userData.uniforms=t}static removeUniforms(e){let t=this.getUniforms(e);if(t){let r=e.userData;delete r.uniforms}return t}};function Q1(o,e,t){sa.setData(e,t),e.onBeforeCompile=RK(o,e);let r=`${e.uuid}:${performance.now()}`;e.customProgramCacheKey=()=>r}function gN(o,e){let{src:t,dest:r,shareCustomUniforms:n}=e,i=sa.getData(t);if(i){let a=n?i:function(c){let l=ia.toJSON(c);return ia.fromJSON(l)}(i);Q1(o,r,a)}}function RK(o,e){return r=>{let n=sa.getData(e);if(!n)return;let{vertexShader:i,fragmentShader:s,paramConfigs:a,additionalTextureUniforms:c,timeDependent:l,resolutionDependent:u}=n;r.vertexShader=i,r.fragmentShader=s,o.uniformsController.addUniforms(r.uniforms,{paramConfigs:a,additionalTextureUniforms:c,timeDependent:l,resolutionDependent:u});let p=e;p.vertexShader=r.vertexShader,p.fragmentShader=r.fragmentShader,Uu.setUniforms(e,r.uniforms)}}var sa=class{static setData(e,t){e.userData.onBeforeCompileData=t}static addAdditionalTexture(e,t,r){let n=this.getData(e);n?n.additionalTextureUniforms[t]==null&&(n.additionalTextureUniforms[t]=r):console.warn("no data found on material",e)}static getData(e){return e.userData.onBeforeCompileData}static removeData(e){let t=this.getData(e);if(t){let r=e.userData;delete r.onBeforeCompileData}return t}},ia=class{static toJSON(e){return{vertexShader:e.vertexShader,fragmentShader:e.fragmentShader,timeDependent:e.timeDependent,resolutionDependent:e.resolutionDependent,paramConfigs:e.paramConfigs.map(r=>r.toJSON())}}static fromJSON(e){return{...e,additionalTextureUniforms:{},paramConfigs:e.paramConfigs.map(r=>Ms.fromJSON(r))}}};var vN="POLY_render_hook",IK=(o,e,t,r,n,i)=>{},ai=class{static node(e,t){return e.node(t.name)}static clone(e,t,r){let n=t.clone(),i=t.uniforms;return i&&(n.uniforms=T1.clone(i)),gN(e,{src:t,dest:n,shareCustomUniforms:r.shareCustomUniforms}),n}static add_user_data_render_hook(e,t){e.userData[vN]=t}static apply_render_hook(e,t){if(t.userData){let r=t.userData[vN];if(r){e.onBeforeRender=(n,i,s,a,c,l)=>{r(n,i,s,a,c,l,e)};return}}e.onBeforeRender=IK}static applyCustomMaterials(e,t){let r=t;if(r.customMaterials)for(let n of Object.keys(r.customMaterials)){let i=n,s=r.customMaterials[i];s&&(e[i]=s,s.needsUpdate=!0)}}static assignUniforms(e,t,r,n){_N(e,t,r),n&&this.assignUniformForOnBeforeCompile(e,t,r,n)}static assignUniformForOnBeforeCompile(e,t,r,n){n.addAdditionalTextureUniforms(t,r)}};var D5="name",f0="attributes",br=class extends dh{constructor(e,t){super(t);this._object=e,this._object.userData[f0]==null&&(this._object.userData[f0]={})}dispose(){}object(){return this._object}geometry(){return this._object.geometry}coreGeometry(){let e=this.geometry();return e?new At(e):null}points(){var e;return((e=this.coreGeometry())==null?void 0:e.points())||[]}pointsFromGroup(e){if(e){let t=Ve.indices(e);if(t){let r=this.points();return Qe.compact(t.map(n=>r[n]))}else return[]}else return this.points()}static isInGroup(e,t){let r=e.trim();if(r.length==0)return!0;let n=r.split("="),i=n[0];if(i[0]=="@"){let s=i.substring(1),a=n[1],c=this.attribValue(t,s);return a==c}return!1}computeVertexNormals(){var e;(e=this.coreGeometry())==null||e.computeVertexNormals()}static _convert_array_to_vector(e){switch(e.length){case 1:return e[0];case 2:return new z(e[0],e[1]);case 3:return new M(e[0],e[1],e[2]);case 4:return new De(e[0],e[1],e[2],e[3])}}static addAttribute(e,t,r){if(K.isArray(r)&&!this._convert_array_to_vector(r)){let a="attribute_value invalid";throw console.error(a,r),new Error(a)}let n=r,i=e.userData;i[f0]=i[f0]||{},i[f0][t]=n}addAttribute(e,t){br.addAttribute(this._object,e,t)}addNumericAttrib(e,t){this.addAttribute(e,t)}setAttribValue(e,t){this.addAttribute(e,t)}addNumericVertexAttrib(e,t,r){var n;r==null&&(r=Ot.default_value(t)),(n=this.coreGeometry())==null||n.addNumericAttrib(e,t,r)}attributeNames(){return Object.keys(this._object.userData[f0])}attribNames(){return this.attributeNames()}hasAttrib(e){return this.attributeNames().includes(e)}renameAttrib(e,t){let r=this.attribValue(e);r!=null?(this.addAttribute(t,r),this.deleteAttribute(e)):console.warn(`attribute ${e} not found`)}deleteAttribute(e){delete this._object.userData[f0][e]}static attribValue(e,t,r=0,n){if(t===mr.OBJECT_INDEX)return r;if(e.userData&&e.userData[f0]){let i=e.userData[f0][t];if(i==null){if(t==D5)return e.name}else if(K.isArray(i)&&n)return n.fromArray(i),n;return i}if(t==D5)return e.name}static stringAttribValue(e,t,r=0){let n=this.attribValue(e,t,r);if(n!=null)return K.isString(n)?n:`${n}`}attribValue(e,t){return br.attribValue(this._object,e,this._index,t)}stringAttribValue(e){return br.stringAttribValue(this._object,e,this._index)}name(){return this.attribValue(D5)}humanType(){return Mc.CONSTRUCTOR_NAMES_BY_CONSTRUCTOR_NAME[this._object.constructor.name]}attribTypes(){let e={};for(let t of this.attribNames()){let r=this.attribType(t);r!=null&&(e[t]=r)}return e}attribType(e){let t=this.attribValue(e);return K.isString(t)?Ge.STRING:Ge.NUMERIC}attribSizes(){let e={};for(let t of this.attribNames()){let r=this.attribSize(t);r!=null&&(e[t]=r)}return e}attribSize(e){let t=this.attribValue(e);return t==null?null:Ot.attribSizeFromValue(t)}clone(){return br.clone(this._object)}static clone(e){let t=e.clone();var r=new Map,n=new Map;return br.parallelTraverse(e,t,function(i,s){r.set(s,i),n.set(i,s)}),t.traverse(function(i){let s=r.get(i),a=i;if(a.geometry&&s&&s.geometry){let p=s.geometry;a.geometry=At.clone(p);let d=a.geometry;d.userData&&(d.userData=wr.cloneDeep(p.userData))}if(a.material){ai.applyCustomMaterials(i,a.material);let p=a.material;p.color==null&&(p.color=new de(1,1,1))}if(s){s.userData&&(i.userData=wr.cloneDeep(s.userData));let p=s;p.animations&&(i.animations=p.animations.map(h=>h.clone()));let d=i;if(d.isSkinnedMesh){var c=d,l=s,u=l.skeleton.bones;c.skeleton=l.skeleton.clone(),c.bindMatrix.copy(l.bindMatrix);let h=u.map(function(m){return n.get(m)});c.skeleton.bones=h,c.bind(c.skeleton,c.bindMatrix)}}}),t}static parallelTraverse(e,t,r){r(e,t);for(var n=0;n<e.children.length;n++)this.parallelTraverse(e.children[n],t.children[n],r)}};var k5=class extends hr{coreContentCloned(){if(this._content)return this._content.clone()}set_content(e){super.set_content(e)}firstObject(){if(this._content)return this._content.objects()[0]}firstCoreObject(){let e=this.firstObject();if(e)return new br(e,0)}firstGeometry(){let e=this.firstObject();return e?e.geometry:null}objectsCount(){return this._content?this._content.objects().length:0}objectsVisibleCount(){let e=0;if(this._content){let t=this._content.objects();for(let r of t)r.visible&&e++}return e}objectsCountByType(){let e={},t=this._content;if(this._content&&t)for(let r of t.coreObjects()){let n=r.humanType();e[n]==null&&(e[n]=0),e[n]+=1}return e}objectsNamesByType(){let e={},t=this._content;if(this._content&&t)for(let r of t.coreObjects()){let n=r.humanType();e[n]=e[n]||[],e[n].push(r.name())}return e}pointAttributeNames(){let e=[],t=this.firstGeometry();return t&&(e=Object.keys(t.attributes)),e}pointAttributeSizesByName(){let e={},t=this.firstGeometry();return t&&Object.keys(t.attributes).forEach(r=>{let n=t.attributes[r];e[r]=n.itemSize}),e}objectAttributeSizesByName(){let e={},t=this.firstCoreObject();if(t){let r=t.attribNames();for(let n of r){let i=t.attribSize(n);i!=null&&(e[n]=i)}}return e}pointAttributeTypesByName(){let e={},t=this.firstGeometry();if(t){let r=new At(t);Object.keys(t.attributes).forEach(n=>{e[n]=r.attribType(n)})}return e}objectAttributeTypesByName(){let e={},t=this.firstCoreObject();if(t)for(let r of t.attribNames())e[r]=t.attribType(r);return e}objectAttributeNames(){let e=[],t=this.firstObject();return t&&(e=Object.keys(t.userData.attributes||{})),e}pointsCount(){return this._content?this._content.pointsCount():0}totalPointsCount(){return this._content?this._content.totalPointsCount():0}objectsData(){return this._content?this._content.objectsData():[]}boundingBox(e=!1){return this._content.boundingBox(e)}center(){return this._content.center()}size(){return this._content.size()}};var B5=class extends hr{object(){return this._content}};var F5=class extends hr{object(){return this._content}};var U5=class extends hr{set_content(e){super.set_content(e)}};var V5=class extends hr{set_content(e){super.set_content(e)}set_material(e){this._content!=null&&this._content.dispose(),this.set_content(e)}has_material(){return this.has_content()}material(){return this.content()}};var G5=class extends hr{set_content(e){super.set_content(e)}set_object(e){return this.set_content(e)}has_object(){return this.has_content()}object(){return this.content()}};var z5=class extends hr{set_content(e){super.set_content(e)}texture(){return this._content}coreContent(){return this._content}coreContentCloned(){var e;let t=(e=this._content)==null?void 0:e.clone();return t&&(t.needsUpdate=!0),t}object(){return this.texture()}infos(){if(this._content!=null)return[this._content]}resolution(){if(this._content){let e=this._content.image;if(e){if(e instanceof HTMLImageElement||e instanceof Image||e instanceof ImageData||e instanceof HTMLCanvasElement)return[e.width,e.height];if(e.data&&e.width!=null&&e.height!=null)return[e.width,e.height];let t=e;return[t.videoWidth,t.videoHeight]}}return[-1,-1]}};var H5=class extends hr{set_content(e){super.set_content(e)}render_pass(){return this._content}object(e={}){return this.render_pass()}};var j5=class extends hr{set_content(e){super.set_content(e)}renderer(){return this._content}};var yN={[oe.ANIM]:w5,[oe.AUDIO]:M5,[oe.COP]:z5,[oe.EVENT]:N5,[oe.GL]:B5,[oe.JS]:F5,[oe.MANAGER]:U5,[oe.MAT]:V5,[oe.OBJ]:G5,[oe.POST]:H5,[oe.ROP]:j5,[oe.SOP]:k5};var W5=class{constructor(e){this.node=e,this._callbacks=[],this._callbacks_tmp=[];let t=yN[e.context()];this._container=new t(this.node)}container(){return this._container}containerUnlessBypassed(){var e,t;if((t=(e=this.node.flags)==null?void 0:e.bypass)==null?void 0:t.active()){let r=this.node.io.inputs.input(0);if(r)return r.containerController.containerUnlessBypassed()}else return this.container()}async compute(){var e,t;if((t=(e=this.node.flags)==null?void 0:e.bypass)==null?void 0:t.active()){let r=await this.requestInputContainer(0)||this._container;return this.node.cookController.endCook(),r}return this.node.isDirty()?new Promise((r,n)=>{var i,s;if(this._callbacks.push(r),(s=(i=this.node.flags)==null?void 0:i.bypass)==null?void 0:s.active())throw"we should not be here";this.node.cookController.cookMain()}):this._container}async requestInputContainer(e){let t=this.node.io.inputs.input(e);return t?await t.compute():(this.node.states.error.set(`input ${e} required`),this.notifyRequesters(),null)}notifyRequesters(e){this._callbacks_tmp=this._callbacks.slice(),this._callbacks.splice(0,this._callbacks.length),e||(e=this.node.containerController.container());let t;for(;t=this._callbacks_tmp.pop();)t(e);this.node.scene().cookController.removeNode(this.node)}};var Vu=Q.performance.performanceManager(),q5=class{constructor(e){this.cookController=e,this._inputsStart=0,this._inputsTime=0,this._paramsStart=0,this._paramsTime=0,this._cookStart=0,this._cookTime=0,this._cooksCount=0,this._data={inputsTime:0,paramsTime:0,cookTime:0}}cooksCount(){return this._cooksCount}data(){return this._data.inputsTime=this._inputsTime,this._data.paramsTime=this._paramsTime,this._data.cookTime=this._cookTime,this._data}active(){return this.cookController.performanceRecordStarted()}recordInputsStart(){this.active()&&(this._inputsStart=Vu.now())}recordInputsEnd(){this.active()&&(this._inputsTime=Vu.now()-this._inputsStart)}recordParamsStart(){this.active()&&(this._paramsStart=Vu.now())}recordParamsEnd(){this.active()&&(this._paramsTime=Vu.now()-this._paramsStart)}recordCookStart(){this.active()&&(this._cookStart=Vu.now())}recordCookEnd(){this.active()&&(this._cookTime=Vu.now()-this._cookStart,this._cooksCount+=1)}};var X5=class{constructor(e){this.node=e,this._cooking=!1,this._performanceController=new q5(this),this._inputsEvaluationRequired=!0,this._corePerformance=this.node.scene().performance}performanceRecordStarted(){return this._corePerformance.started()}dispose(){this._clearHooks()}disallowInputsEvaluation(){this._inputsEvaluationRequired=!1}isCooking(){return this._cooking===!0}_startCookIfNoErrors(e){if(this.node.states.error.active())this.endCook();else try{this._performanceController.recordCookStart(),this.node.cook(e||[])}catch(t){this.node.states.error.set(`node internal error: '${t}'.`),Q.warn(t),this.endCook()}}async cookMain(){if(this.isCooking())return;this._initCookingState(),this.node.states.error.clear(),this.node.scene().cookController.addNode(this.node);let e=this._inputsEvaluationRequired?await this._evaluateInputs():void 0;this.node.params.paramsEvalRequired()&&await this._evaluateParams(),this._startCookIfNoErrors(e)}async cookMainWithoutInputs(){if(this.node.scene().cookController.addNode(this.node),this.isCooking()){Q.warn("cook_main_without_inputs already cooking",this.node.path());return}this._initCookingState(),this.node.states.error.clear(),this.node.params.paramsEvalRequired()&&await this._evaluateParams(),this._startCookIfNoErrors(void 0)}endCook(e){var t,r;this._finalizeCookPerformance();let n=this.node.dirtyController.dirtyTimestamp();if(n==null||n===this._cookingDirtyTimestamp)this.node.removeDirtyState(),this._terminateCookProcess();else{if((r=(t=this.node.flags)==null?void 0:t.bypass)==null?void 0:r.active())return;Q.log("COOK AGAIN",n,this._cookingDirtyTimestamp,this.node.path()),this._cooking=!1,this.cookMain()}}_initCookingState(){this._cooking=!0,this._cookingDirtyTimestamp=this.node.dirtyController.dirtyTimestamp()}_terminateCookProcess(){this.isCooking()&&(this._cooking=!1,this.node.containerController.notifyRequesters(),this._run_on_cook_complete_hooks())}async _evaluateInputs(){this._performanceController.recordInputsStart();let e=this.node.io.inputs,t=this._inputsEvaluationRequired?e.isAnyInputDirty()?await e.evalRequiredInputs():e.containersWithoutEvaluation():[],r=e.inputs(),n=[],i;for(let s=0;s<r.length;s++)i=t[s],i&&(e.cloneRequired(s)?n[s]=i.coreContentCloned():n[s]=i.coreContent());return this._performanceController.recordInputsEnd(),n}async _evaluateParams(){this._performanceController.recordParamsStart(),await this.node.params.evalAll(),this._performanceController.recordParamsEnd()}cooksCount(){return this._performanceController.cooksCount()}cookTime(){return this._performanceController.data().cookTime}_finalizeCookPerformance(){!this._corePerformance.started()||(this._performanceController.recordCookEnd(),this._corePerformance.recordNodeCookData(this.node,this._performanceController.data()))}registerOnCookEnd(e,t){this._on_cook_complete_hook_names=this._on_cook_complete_hook_names||[],this._on_cook_complete_hooks=this._on_cook_complete_hooks||[],this._on_cook_complete_hook_names.push(e),this._on_cook_complete_hooks.push(t)}_clearHooks(){if(!(!this._on_cook_complete_hook_names||!this._on_cook_complete_hooks))for(let e of this._on_cook_complete_hook_names)this.deregisterOnCookEnd(e)}deregisterOnCookEnd(e){var t;if(!this._on_cook_complete_hook_names||!this._on_cook_complete_hooks)return;let r=(t=this._on_cook_complete_hook_names)==null?void 0:t.indexOf(e);this._on_cook_complete_hook_names.splice(r,1),this._on_cook_complete_hooks.splice(r,1),this._on_cook_complete_hook_names.length==0&&(this._on_cook_complete_hook_names=void 0),this._on_cook_complete_hooks.length==0&&(this._on_cook_complete_hooks=void 0)}_run_on_cook_complete_hooks(){if(this._on_cook_complete_hooks)for(let e of this._on_cook_complete_hooks)e()}onCookEndCallbackNames(){return this._on_cook_complete_hook_names}};var _h=class{constructor(e){this.node=e}dispose(){}toJSON(e=!1){var t,r,n,i,s,a;let c={name:this.node.name(),type:this.node.type(),graph_node_id:this.node.graphNodeId(),is_dirty:this.node.isDirty(),ui_data_json:this.node.uiData.toJSON(),error_message:this.node.states.error.message(),children:this.childrenIds(),maxInputsCount:this.maxInputsCount(),inputs:this.inputIds(),input_connection_output_indices:this.inputConnectionOutputIndices(),named_input_connection_points:this.namedInputConnectionPoints(),named_output_connection_points:this.namedOutputConnectionPoints(),param_ids:this.to_json_params(e),override_cloned_state_allowed:this.node.io.inputs.overrideClonedStateAllowed(),inputs_clone_required_states:this.node.io.inputs.cloneRequiredStates(),flags:{display:(r=(t=this.node.flags)==null?void 0:t.display)==null?void 0:r.active(),bypass:(i=(n=this.node.flags)==null?void 0:n.bypass)==null?void 0:i.active(),optimize:(a=(s=this.node.flags)==null?void 0:s.optimize)==null?void 0:a.active()},selection:void 0};return this.node.childrenAllowed()&&this.node.childrenController&&(c.selection=this.node.childrenController.selection.toJSON()),c}childrenIds(){return this.node.children().map(e=>e.graphNodeId())}maxInputsCount(){return this.node.io.inputs.maxInputsCount()}inputIds(){return this.node.io.inputs.inputs().map(e=>e!=null?e.graphNodeId():void 0)}inputConnectionOutputIndices(){var e;return(e=this.node.io.connections.inputConnections())==null?void 0:e.map(t=>t!=null?t.output_index:void 0)}namedInputConnectionPoints(){return this.node.io.inputs.namedInputConnectionPoints().map(e=>e.toJSON())}namedOutputConnectionPoints(){return this.node.io.outputs.namedOutputConnectionPoints().map(e=>e.toJSON())}to_json_params_from_names(e,t=!1){return e.map(r=>this.node.params.get(r).graphNodeId())}to_json_params(e=!1){return this.to_json_params_from_names(this.node.params.names,e)}};var cr=(o=>(o.VISIBLE_UPDATED="param_visible_updated",o.EDITABLE_UPDATED="param_editable_updated",o.RAW_INPUT_UPDATED="raw_input_updated",o.VALUE_UPDATED="param_value_updated",o.EXPRESSION_UPDATED="param_expression_update",o.ERROR_UPDATED="param_error_updated",o.DELETED="param_deleted",o))(cr||{});var e_="callback",Y5="callbackString",LK="computeOnDirty",DK="cook",kK="fileBrowse",BK="type",FK="expression",UK="forEntities",VK="label",GK="hideLabel",zK="level",HK="menu",jK="menuString",WK="entries",qK="multiline",XK="language",YK="nodeSelection",$K="context",KK="types",xN="dependentOnFoundNode",JK="range",ZK="rangeLocked",QK="step",eJ="spare",tJ="texture",rJ="env",bN="hidden",oJ="field",$5="visibleIf",nJ="conversion",iJ="separatorBefore",sJ="separatorAfter",aJ="joinToPreviousParam",K5="editable",J5=(o=>(o.TYPESCRIPT="typescript",o.JSON="json",o))(J5||{}),Oc=(o=>(o.AUDIO="audio",o.TEXTURE_IMAGE="texture_image",o.TEXTURE_VIDEO="texture_video",o.GEOMETRY="geometry",o.FONT="font",o.SVG="svg",o.JSON="json",o))(Oc||{}),t_=class{constructor(e){this._param=e,this._programatic_visible_state=!0,this._callbackAllowed=!1,this._updateVisibilityAndRemoveDirtyBound=this.updateVisibilityAndRemoveDirty.bind(this),this._ui_data_dependency_set=!1}dispose(){var e;try{this._options[e_]=void 0,this._options[Y5]=void 0}catch{}(e=this._visibility_graph_node)==null||e.dispose()}set(e){K.isString(e)&&console.warn("options input invalid",e,typeof e),this._default_options=e,this._options=wr.cloneDeep(this._default_options),this.post_set_options()}copy(e){this._default_options=wr.cloneDeep(e.default()),this._options=wr.cloneDeep(e.current()),this.post_set_options()}setOption(e,t){if(this._options[e]=t,this._param.components)for(let r of this._param.components)r.options.setOption(e,t)}post_set_options(){this._handleComputeOnDirty()}param(){return this._param}node(){return this._param.node}default(){return this._default_options}current(){return this._options}hasOptionsOverridden(){return!wr.isEqual(this._options,this._default_options)}overriddenOptions(){let e={},t=Object.keys(this._options);for(let r of t)if(!wr.isEqual(this._options[r],this._default_options[r])){let n=wr.cloneDeep(this._options[r]);Object.assign(e,{[r]:n})}return e}overriddenOptionNames(){return Object.keys(this.overriddenOptions())}computeOnDirty(){return this._options[LK]||!1}_handleComputeOnDirty(){this.computeOnDirty()&&(this._computeOnDirty_callback_added||(this.param().addPostDirtyHook("computeOnDirty",this._computeParam.bind(this)),this._computeOnDirty_callback_added=!0))}async _computeParam(){await this.param().compute()}hasCallback(){return this._options[e_]!=null||this._options[Y5]!=null}allowCallback(){this._callbackAllowed=!0}executeCallback(){if(!this._callbackAllowed||!this.node())return;let e=this.getCallback();if(!e||!this.node().scene().loadingController.loaded())return;let t=this.param().parentParam();t?t.options.executeCallback():e(this.node(),this.param())}getCallback(){if(this.hasCallback())return this._options[e_]=this._options[e_]||this.createCallbackFromString()}createCallbackFromString(){let e=this._options[Y5];if(e){let t=new Function("node","scene","window","location",e);return()=>{t(this.node(),this.node().scene(),null,null)}}}colorConversion(){return this._options[nJ]}makesNodeDirtyWhenDirty(){if(this.param().parentParam()!=null)return!1;let e=this._options[DK];return e!=null?e:!0}fileBrowseOption(){return this._options[kK]}fileBrowseAllowed(){return this.fileBrowseOption()!=null}fileBrowseType(){let e=this.fileBrowseOption();return e?e[BK]:null}separatorBefore(){return this._options[iJ]}separatorAfter(){return this._options[sJ]}joinToPreviousParam(){return this._options[aJ]}setEditableState(e){let t=this._options[K5],r=this.param();if(t!=e&&(this._options[K5]=e,r.emit(cr.EDITABLE_UPDATED)),r.components)for(let n of r.components)n.options.setEditableState(e)}editable(){let e=this._options[K5];return e!=null?e:!0}isExpressionForEntities(){let e=this._options[FK];return e&&e[UK]||!1}level(){return this._options[zK]||0}hasMenu(){return this.menuOptions()!=null||this.menuStringOptions()!=null}menuOptions(){return this._options[HK]}menuStringOptions(){return this._options[jK]}menuEntries(){let e=this.menuOptions()||this.menuStringOptions();return e?e[WK]:[]}isMultiline(){return this._options[qK]===!0}language(){return this._options[XK]}isCode(){return this.language()!=null}nodeSelectionOptions(){return this._options[YK]}nodeSelectionContext(){let e=this.nodeSelectionOptions();if(e)return e[$K]}nodeSelectionTypes(){let e=this.nodeSelectionOptions();if(e)return e[KK]}dependentOnFoundNode(){return xN in this._options?this._options[xN]:!0}isSelectingParam(){return this.param().type()==J.PARAM_PATH}range(){return this._options[JK]||[0,1]}step(){return this._options[QK]}rangeLocked(){return this._options[ZK]||[!1,!1]}ensureInRange(e){let t=this.range();return e>=t[0]&&e<=t[1]?e:e<t[0]?this.rangeLocked()[0]===!0?t[0]:e:this.rangeLocked()[1]===!0?t[1]:e}isSpare(){return this._options[eJ]||!1}textureOptions(){return this._options[tJ]}textureAsEnv(){let e=this.textureOptions();return e!=null?e[rJ]===!0:!1}isHidden(){return this._options[bN]===!0||this._programatic_visible_state===!1}isVisible(){return!this.isHidden()}setVisibleState(e){this._options[bN]=!e,this.param().emit(cr.VISIBLE_UPDATED)}label(){return this._options[VK]}isLabelHidden(){let e=this.param().type();return e===J.BUTTON?!0:e===J.BOOLEAN?this.isFieldHidden():e==J.RAMP&&this._options[GK]||!1}isFieldHidden(){return this._options[oJ]===!1}uiDataDependsOnOtherParams(){return $5 in this._options}visibilityPredecessors(){let e=this._options[$5];if(!e)return[];let t=[];K.isArray(e)?t=Qe.uniq(e.map(n=>Object.keys(n)).flat()):t=Object.keys(e);let r=this.param().node;return Qe.compact(t.map(n=>{let i=r.params.get(n);if(i)return i;console.error(`param ${n} not found as visibility condition for ${this.param().name()} in node ${this.param().node.type()}`)}))}setUiDataDependency(){if(this._ui_data_dependency_set)return;this._ui_data_dependency_set=!0;let e=this.visibilityPredecessors();if(e.length>0){this._visibility_graph_node=new Kt(this.param().scene(),"param_visibility");for(let t of e)this._visibility_graph_node.addGraphInput(t);this._visibility_graph_node.addPostDirtyHook("_update_visibility_and_remove_dirty",this._updateVisibilityAndRemoveDirtyBound)}}updateVisibilityAndRemoveDirty(){this.updateVisibility(),this.param().removeDirtyState()}async updateVisibility(){let e=this._options[$5];if(e){let t=this.visibilityPredecessors(),r=t.map(n=>{if(n.isDirty())return n.compute()});if(this._programatic_visible_state=!1,await Promise.all(r),K.isArray(e))for(let n of e)t.filter(s=>s.value==n[s.name()]).length==t.length&&(this._programatic_visible_state=!0);else{let n=t.filter(i=>i.value==e[i.name()]);this._programatic_visible_state=n.length==t.length}this.param().emit(cr.VISIBLE_UPDATED)}}};var r_=class{constructor(e){this.param=e,this._blockedEmit=!1,this._blockedParentEmit=!1,this._countByEventName=new Map}emitAllowed(){return this._blockedEmit===!0||this.param.scene().loadingController.isLoading()?!1:this.param.scene().dispatchController.emitAllowed()}blockEmit(){if(this._blockedEmit=!0,this.param.isMultiple()&&this.param.components)for(let e of this.param.components)e.emitController.blockEmit();return!0}unblockEmit(){if(this._blockedEmit=!1,this.param.isMultiple()&&this.param.components)for(let e of this.param.components)e.emitController.unblockEmit();return!0}blockParentEmit(){return this._blockedParentEmit=!0,!0}unblockParentEmit(){return this._blockedParentEmit=!1,!0}incrementCount(e){let t=(this._countByEventName.get(e)||0)+1;this._countByEventName.set(e,t)}eventsCount(e){return this._countByEventName.get(e)||0}emit(e){if(this.emitAllowed()){this.param.emit(e);let t=this.param.parentParam();t!=null&&this._blockedParentEmit!==!0&&t.emit(e)}}};var Z5=class{constructor(e){this.param=e}toJSON(){let e={name:this.param.name(),type:this.param.type(),raw_input:this.rawInput(),value:this.value(),value_pre_conversion:this.value_pre_conversion(),expression:this.expression(),graph_node_id:this.param.graphNodeId(),error_message:this.error_message(),is_visible:this.is_visible(),editable:this.editable(),components:void 0};return this.param.isMultiple()&&this.param.components&&(e.components=this.param.components.map(t=>t.graphNodeId())),e}rawInput(){return this.param.rawInputSerialized()}value(){return this.param.valueSerialized()}value_pre_conversion(){return this.param.valuePreConversionSerialized()}expression(){var e;return this.param.hasExpression()?(e=this.param.expressionController)==null?void 0:e.expression():void 0}error_message(){return this.param.states.error.message()}is_visible(){return this.param.options.isVisible()}editable(){return this.param.options.editable()}};var Q5=class{constructor(e){this.param=e}active(){let e=this.param.scene().timeController.graphNode.graphNodeId();return this.param.graphPredecessorIds().includes(e)}};var e8=class{constructor(e){this.param=e}set(e){this._message!=e&&(this._message=e,this._message&&Q.warn(this.param.path(),this._message),this.param.emitController.emit(cr.ERROR_UPDATED))}message(){return this._message}clear(){this.set(void 0)}active(){return this._message!=null}};var t8=class{constructor(e){this.param=e,this.timeDependent=new Q5(this.param),this.error=new e8(this.param)}};var Pc=class extends Kt{constructor(e,t,r){super(e.scene(),"MethodDependency");this.param=e,this.path_argument=t,this.decomposed_path=r,this._update_from_name_change_bound=this._update_from_name_change.bind(this);var n;(n=e.expressionController)==null||n.registerMethodDependency(this),this.addPostDirtyHook("_update_from_name_change",this._update_from_name_change_bound)}_update_from_name_change(e){if(e&&this.decomposed_path){let t=e;this.decomposed_path.update_from_name_change(t);let r=this.decomposed_path.to_path(),n=this.jsep_node;n&&(n.value=`${n.value}`.replace(`${this.path_argument}`,r),n.raw=n.raw.replace(`${this.path_argument}`,r)),this.param.expressionController&&this.param.expressionController.updateFromMethodDependencyNameChange()}}reset(){this.graphDisconnectPredecessors()}listen_for_name_changes(){if(this.jsep_node&&this.decomposed_path){for(let e of this.decomposed_path.named_nodes())if(e){let t=e;t.nameController&&this.addGraphInput(t.nameController.graph_node)}}}set_jsep_node(e){this.jsep_node=e}set_resolved_graph_node(e){this.resolved_graph_node=e}set_unresolved_path(e){this.unresolved_path=e}static create(e,t,r,n){let i=K.isNumber(t),s=new Pc(e,t,n);if(r)s.set_resolved_graph_node(r);else if(!i){let a=t;s.set_unresolved_path(a)}return s}};var cJ=[],yo=class extends Kt{constructor(e,t){super(e,"BaseParam");this._options=new t_(this),this._emitController=new r_(this),this._isComputing=!1,this._node=t,this._initializeParam()}get options(){return this._options=this._options||new t_(this)}get emitController(){return this._emitController=this._emitController||new r_(this)}get expressionController(){return this._expression_controller}get serializer(){return this._serializer=this._serializer||new Z5(this)}get states(){return this._states=this._states||new t8(this)}dispose(){var e,t;let r=this.graphPredecessors();for(let i of r)i instanceof Pc&&i.dispose();let n=this.graphSuccessors();for(let i of n)if(i instanceof yo){let s=i.rawInputSerialized();i.set(i.defaultValue()),i.set(s)}else i.setDirty();this.scene().missingExpressionReferencesController.deregisterParam(this),(e=this._expression_controller)==null||e.dispose(),super.dispose(),(t=this._options)==null||t.dispose(),this._node=void 0,this._parent_param=void 0}_initializeParam(){}static type(){return J.FLOAT}type(){return this.constructor.type()}isNumeric(){return!1}setName(e){super.setName(e)}get value(){return this._value}copyValue(e){e.type()==this.type()?this._copyValue(e):console.warn(`cannot copy value from ${e.type()} to ${this.type()}`)}_copyValue(e){throw"abstract method param._copy_value"}valuePreConversionSerialized(){}convert(e){return null}static areRawInputEqual(e,t){return!1}isRawInputEqual(e){return this.constructor.areRawInputEqual(this._raw_input,e)}static areValuesEqual(e,t){return!1}isValueEqual(e){return this.constructor.areValuesEqual(this.value,e)}_cloneRawInput(e){return e}set(e){this._raw_input=this._cloneRawInput(this._prefilterInvalidRawInput(e)),this.emitController.emit(cr.RAW_INPUT_UPDATED),this.processRawInput()}_prefilterInvalidRawInput(e){return e}defaultValue(){return this._default_value}isDefault(){return this._raw_input==this._default_value}rawInput(){return this._raw_input}processRawInput(){}async compute(){if(this.scene().loadingController.isLoading()&&Q.warn(`param attempt to compute ${this.path()} while scene is loading`),this.isDirty()){if(this._isComputing)return new Promise((e,t)=>{this._computeResolves=this._computeResolves||[],this._computeResolves.push(e)});if(this._isComputing=!0,await this.processComputation(),this._isComputing=!1,this._computeResolves){let e=[...this._computeResolves];this._computeResolves=[];for(let t of e)t()}}}async processComputation(){}setInitValue(e){this._default_value=this._cloneRawInput(this._prefilterInvalidRawInput(e))}_setupNodeDependencies(e){var t,r;if(e?(this.options.allowCallback(),this.parentParam()||(this.options.makesNodeDirtyWhenDirty()?(r=e.params.params_node)==null||r.addGraphInput(this,!1):this.dirtyController.addPostDirtyHook("run callback",async()=>{await this.compute(),this.options.executeCallback()}))):this._node&&((t=this._node.params.params_node)==null||t.removeGraphInput(this)),this.components)for(let n of this.components)n._setupNodeDependencies(e)}get node(){return this._node}parent(){return this.node}set_parent_param(e){e.addGraphInput(this,!1),this._parent_param=e}parentParam(){return this._parent_param}has_parent_param(){return this._parent_param!=null}path(){var e;return((e=this.node)==null?void 0:e.path())+"/"+this.name()}pathRelativeTo(e){if(!this._node)return this.name();let t=ut.relativePath(e,this._node);return t.length>0?ut.sanitizePath(`${t}${ut.SEPARATOR}${this.name()}`):this.name()}emit(e){this.emitController.emitAllowed()&&(this.emitController.incrementCount(e),this.scene().dispatchController.dispatch(this,e))}get components(){return this._components}componentNames(){return cJ}isMultiple(){return this.componentNames().length>0}initComponents(){}hasExpression(){return this.expressionController!=null&&this.expressionController.active()}toJSON(){return this.serializer.toJSON()}};var vh=Ni(TN());vh.default.addUnaryOp("@");var lJ=10;vh.default.addBinaryOp("**",lJ);var uJ="Identifier",pJ="Literal",dJ="CallExpression",hJ="`",aa=class{constructor(){}parse_expression(e){try{this.reset(),this.node=(0,vh.default)(e)}catch(t){let r=`could not parse the expression '${e}' (error: ${t})`;this.error_message=r}}parse_expression_for_string_param(e){try{this.reset();let t=aa.string_value_elements(e),r=[];for(let n=0;n<t.length;n++){let i=t[n],s;if(n%2==1)s=(0,vh.default)(i);else{let a=i.replace(/\'/g,"\\'");s={type:pJ,value:`'${a}'`,raw:`'${a}'`}}r.push(s)}this.node={type:dJ,arguments:r,callee:{type:uJ,name:"strConcat"}}}catch(t){let r=`could not parse the expression '${e}' (error: ${t})`;this.error_message=r}}static string_value_elements(e){return e!=null?K.isString(e)?e.split(hJ):[]:[]}reset(){this.node=void 0,this.error_message=void 0}};var r8=class{static if(e){let t=e[0],r=e[1],n=e[2];return`(${t}) ? (${r}) : (${n})`}};var o8="$",yh=class{constructor(e){this.param=e,this._set_error_from_error_bound=this._set_error_from_error.bind(this)}clear_error(){this._error_message=void 0}set_error(e){this._error_message=this._error_message||e}_set_error_from_error(e){K.isString(e)?this._error_message=e:this._error_message=e.message}is_errored(){return this._error_message!=null}error_message(){return this._error_message}reset(){this._error_message=void 0}traverse_node(e){let t=`traverse_${e.type}`;if(this[t])return this[t](e);this.set_error(`expression unknown node type: ${e.type}`)}traverse_BinaryExpression(e){return`${this.traverse_node(e.left)} ${e.operator} ${this.traverse_node(e.right)}`}traverse_LogicalExpression(e){return`${this.traverse_node(e.left)} ${e.operator} ${this.traverse_node(e.right)}`}traverse_MemberExpression(e){return`${this.traverse_node(e.object)}.${this.traverse_node(e.property)}`}traverse_ConditionalExpression(e){return`(${this.traverse_node(e.test)}) ? (${this.traverse_node(e.consequent)}) : (${this.traverse_node(e.alternate)})`}traverse_Compound(e){let t=e.body,r=[];for(let n=0;n<t.length;n++){let i=t[n];i.type=="Identifier"?i.name[0]==o8?r.push("`${"+this.traverse_node(i)+"}`"):r.push(`'${i.name}'`):r.push("`${"+this.traverse_node(i)+"}`")}return r.join(" + ")}traverse_Literal(e){return`${e.raw}`}};var AN="coreGeometry",Bi=class{constructor(){}reset(){this._attributeNames&&this._attributeNames.clear()}assignAttributesLines(){if(this._attributeNames){let e=[];for(let t of this._attributeNames)e.push(Bi.assignAttributeLine(t));return e.join(`;
`)}else return""}assignArraysLines(){if(this._attributeNames){let e=[];if(this._attributeNames.size>0){let t=`const ${AN} = entities[0].coreGeometry();`;e.push(t)}for(let t of this._attributeNames)e.push(Bi.assignItemSizeLine(t)),e.push(Bi.assignArrayLine(t));return e.join(`;
`)}else return""}attributePresenceCheckLine(){if(this._attributeNames){let e=[];for(let t of this._attributeNames){let r=Bi._varAttribute(t);e.push(r)}if(e.length>0)return e.join(" && ")}return"true"}add(e){this._attributeNames=this._attributeNames||new Set,this._attributeNames.add(e)}static assignAttributeLine(e){return`const ${this._varAttribute(e)} = getEntitiesAttribute(entities,'${e}')`}static assignItemSizeLine(e){let t=this._varAttribute(e);return`const ${this._varAttribSize(e)} = ${t}.itemSize`}static assignArrayLine(e){let t=this._varAttribute(e),r=this._varArray(e),n=`${AN}.isAttribIndexed('${e}')`,i=`entities.map(e=>e.indexedAttribValue('${e}'))`,s=`${t}.array`;return`const ${r} = ${n} ? ${i} : ${s}`}static _varAttribute(e){return`attrib_${e}`}static _varAttribSize(e){return`attrib_size_${e}`}static _varArray(e){return`array_${e}`}varAttributeSize(e){return Bi._varAttribSize(e)}varArray(e){return Bi._varArray(e)}};var fJ=["abs","acos","acosh","asin","asinh","atan","atan2","atanh","ceil","cos","cosh","exp","expm1","floor","log","log1p","log2","log10","max","min","pow","round","sign","sin","sinh","sqrt","tan","tanh"],mJ=["cbrt","hypot","log10","trunc"],CN={math_random:"random"},_J=["fit","fit01","fract","deg2rad","rad2deg","rand","clamp"],gJ=Object.keys(J1),vJ=["precision"],yJ=["E","LN2","LN10","LOG10E","LOG2E","PI","SQRT1_2","SQRT2"],Rc={};fJ.forEach(o=>{Rc[o]=`Math.${o}`});mJ.forEach(o=>{Rc[o]=`Math.${o}`});Object.keys(CN).forEach(o=>{let e=CN[o];Rc[o]=`Math.${e}`});_J.forEach(o=>{Rc[o]=`Core.Math.${o}`});gJ.forEach(o=>{Rc[o]=`Core.Math.Easing.${o}`});vJ.forEach(o=>{Rc[o]=`Core.String.${o}`});var xJ={if:r8.if},SN={};yJ.forEach(o=>{SN[o]=`Math.${o}`});var Gu="'",EN=", ",bJ="@",TJ={x:0,y:1,z:2,w:3,r:0,g:1,b:2},AJ={Math:Mr,String:Ve},n8=class extends yh{constructor(e){super(e);this.param=e,this._attribute_requirements_controller=new Bi,this.methods=[],this.method_index=-1,this.methodDependencies=[],this.immutableDependencies=[]}parse_tree(e){if(this.reset(),e.error_message==null){try{if(this._attribute_requirements_controller=new Bi,e.node){let t=this.traverse_node(e.node);t&&!this.is_errored()&&(this.function_main_string=t)}else console.warn("no parsed_tree.node")}catch(t){console.warn(`error in expression for param ${this.param.path()}`),console.warn(t)}if(this.function_main_string)try{let t=this._functionBody();this.function=new Function("CorePoint","Core","param","methods","_set_error_from_error",`
					try {
						${t}
					} catch(e) {
						_set_error_from_error(e)
						return null;
					}`)}catch(t){console.warn(t),this.set_error("cannot generate function")}else this.set_error("cannot generate function body")}else this.set_error("cannot parse expression")}reset(){super.reset(),this.function_main_string=void 0,this.methods=[],this.method_index=-1,this.function=void 0,this.methodDependencies=[],this.immutableDependencies=[]}_functionBody(){return this.param.options.isExpressionForEntities()?`
			const entities = param.expressionController.entities();
			function getEntitiesAttribute(entities, attribName){
				const firstEntity = entities[0];
				if(firstEntity instanceof CorePoint){
					return firstEntity.geometry().attributes[attribName];
				} else {
					return entities.map(e=>e.attribValue(attribName));
				}
			}
			function getCorePointAttribValue(entity, attribName, array, attributeSize, propertyOffset){
				return array[entity.index()*attributeSize+propertyOffset];
			}
			function getCoreObjectAttribValue(entity, attribName, array, attributeSize, propertyOffset){
				return entity.attribValue(attribName)
			}
			if(entities){
				return new Promise( async (resolve, reject)=>{
					let entity;
					const entityCallback = param.expressionController.entityCallback();
					// assign_attributes_lines
					${this._attribute_requirements_controller.assignAttributesLines()}
					// check if attributes are present
					if( ${this._attribute_requirements_controller.attributePresenceCheckLine()} ){
						// assign function
						const getEntityAttribValue = (entities[0] instanceof CorePoint) ? getCorePointAttribValue : getCoreObjectAttribValue;
						// assign_arrays_lines
						${this._attribute_requirements_controller.assignArraysLines()}
						for(let index=0; index < entities.length; index++){
							entity = entities[index];
							result = ${this.function_main_string};
							entityCallback(entity, result);
						}
						resolve()
					} else {
						const error = new Error('attribute not found')
						_set_error_from_error(error)
						reject(error)
					}
				})
			}
			return []`:`
			return new Promise( async (resolve, reject)=>{
				try {
					const value = ${this.function_main_string}
					resolve(value)
				} catch(e) {
					_set_error_from_error(e)
					reject()
				}
			})
			`}evalAllowed(){return this.function!=null}evalFunction(){if(this.function)return this.clear_error(),this.function(d0,AJ,this.param,this.methods,this._set_error_from_error_bound)}traverse_CallExpression(e){let t=e.arguments.map(i=>this.traverse_node(i)),n=e.callee.name;if(n){let i=xJ[n];if(i)return i(t);let s=`${t.join(EN)}`,a=Rc[n];if(a)return`${a}(${s})`;let c=Q.expressionsRegister;if(c.getMethod(n)){let u=e.arguments[0],p=`return ${t[0]}`,d,h;try{d=new Function(p),h=d()}catch{}return this._createMethodAndDependencies(n,h,u),`(await methods[${this.method_index}].processArguments([${s}]))`}else{let u=c.availableMethods().join(", "),p=`method not found (${n}), available methods are: ${u}`;Q.warn(p)}}this.set_error(`unknown method: ${n}`)}traverse_BinaryExpression(e){return`(${this.traverse_node(e.left)} ${e.operator} ${this.traverse_node(e.right)})`}traverse_LogicalExpression(e){return`(${this.traverse_node(e.left)} ${e.operator} ${this.traverse_node(e.right)})`}traverse_MemberExpression(e){return`${this.traverse_node(e.object)}.${this.traverse_node(e.property)}`}traverse_UnaryExpression(e){if(e.operator===bJ){let t=e.argument,r,n;switch(t.type){case"Identifier":{r=t.name;break}case"MemberExpression":{let i=t,s=i.object,a=i.property;r=s.name,n=a.name;break}}if(r){if(r=Ot.remapName(r),r==mr.POINT_INDEX||r==mr.OBJECT_INDEX)return"((entity != null) ? entity.index() : 0)";{let i=this._attribute_requirements_controller.varAttributeSize(r),s=this._attribute_requirements_controller.varArray(r);this._attribute_requirements_controller.add(r);let a=n?TJ[n]:0;return a==null&&(a=0),`getEntityAttribValue(entity, '${r}', ${s}, ${i}, ${a})`}}else return console.warn("attribute not found"),""}else return`${e.operator}${this.traverse_node(e.argument)}`}traverse_Literal(e){return`${e.raw}`}traverse_Identifier(e){if(e.name[0]==o8){let r=e.name.substring(1),n=SN[r];if(n)return n;let i=`traverse_Identifier_${r}`;if(this[i])return this[i]();this.set_error(`identifier unknown: ${e.name}`)}else return e.name}traverse_Identifier_F(){return this.immutableDependencies.push(this.param.scene().timeController.graphNode),"param.scene().timeController.frame()"}traverse_Identifier_T(){return this.immutableDependencies.push(this.param.scene().timeController.graphNode),"param.scene().timeController.time()"}traverse_Identifier_OS(){return`${Gu}${this.param.node.name()}${Gu}`}traverse_Identifier_CH(){return`${Gu}${this.param.name()}${Gu}`}traverse_Identifier_CEX(){return this._method_centroid("x")}traverse_Identifier_CEY(){return this._method_centroid("y")}traverse_Identifier_CEZ(){return this._method_centroid("z")}_method_centroid(e){let r=[0,`${Gu}${e}${Gu}`].join(EN);return this._createMethodAndDependencies("centroid",0),`(await methods[${this.method_index}].processArguments([${r}]))`}_createMethodAndDependencies(e,t,r){let n=Q.expressionsRegister,i=n.getMethod(e);if(!i){let a=n.availableMethods(),c=`method not found (${e}), available methods are: ${a.join(", ")}`;this.set_error(c),Q.warn(c);return}let s=new i(this.param);if(this.method_index+=1,this.methods[this.method_index]=s,s.requireDependency()&&t!=null){let a=s.findDependency(t);a?(r&&a.set_jsep_node(r),this.methodDependencies.push(a)):r&&K.isString(t)&&this.param.scene().missingExpressionReferencesController.register(this.param,t)}}};var CJ=", ",i8=class extends yh{constructor(e){super(e);this.param=e}parse_tree(e){if(e.error_message==null&&e.node)try{return this.traverse_node(e.node)}catch{this.set_error("could not traverse tree")}else this.set_error("cannot parse tree")}traverse_CallExpression(e){let r=`${e.arguments.map(i=>this.traverse_node(i)).join(CJ)}`;return`${e.callee.name}(${r})`}traverse_UnaryExpression(e){return`${e.operator}${this.traverse_node(e.argument)}`}traverse_Identifier(e){return`${e.name}`}};var s8=class{constructor(e){this.param=e,this._cyclicGraphDetected=!1,this.methodDependencies=[]}set_error(e){this.error_message=this.error_message||e}reset(){this.param.graphDisconnectPredecessors(),this.methodDependencies.forEach(e=>{e.reset()}),this.methodDependencies=[]}update(e){this._cyclicGraphDetected=!1,this._connectImmutableDependencies(e),this.methodDependencies=e.methodDependencies,this._handleMethodDependencies(),this._listenForNameChanges()}_connectImmutableDependencies(e){e.immutableDependencies.forEach(t=>{if(this._cyclicGraphDetected==!1&&this.param.addGraphInput(t)==!1){this._cyclicGraphDetected=!0,this.set_error("cannot create expression, infinite graph detected"),this.reset();return}})}_handleMethodDependencies(){this.methodDependencies.forEach(e=>{this._cyclicGraphDetected==!1&&this._handleMethodDependency(e)})}_handleMethodDependency(e){let t=e.resolved_graph_node;if(t&&!this.param.addGraphInput(t)){this._cyclicGraphDetected=!0,this.set_error("cannot create expression, infinite graph detected"),this.reset();return}}_listenForNameChanges(){this.methodDependencies.forEach(e=>{e.listen_for_name_changes()})}};var a8=class{constructor(e){this.param=e,this.parse_completed=!1,this.parse_started=!1,this.parsed_tree=new aa,this._functionGenerator=new n8(this.param),this.dependencies_controller=new s8(this.param)}parseExpression(e){if(this.parse_started)throw new Error(`parse in progress for param ${this.param.path()}`);this.parse_started=!0,this.parse_completed=!1,this.parsed_tree=this.parsed_tree||new aa,this.reset(),this.param.type()==J.STRING?this.parsed_tree.parse_expression_for_string_param(e):this.parsed_tree.parse_expression(e),this._functionGenerator.parse_tree(this.parsed_tree),this._functionGenerator.error_message()==null&&(this.dependencies_controller.update(this._functionGenerator),this.dependencies_controller.error_message?this.param.states.error.set(this.dependencies_controller.error_message):(this.parse_completed=!0,this.parse_started=!1))}async computeFunction(){if(this._computeAllowed())try{return await this._functionGenerator.evalFunction()}catch{}}reset(){this.parse_completed=!1,this.parse_started=!1,this.dependencies_controller.reset(),this._functionGenerator.reset()}is_errored(){return this._functionGenerator.is_errored()}error_message(){return this._functionGenerator.error_message()}_computeAllowed(){return this._functionGenerator.evalAllowed()}updateFromMethodDependencyNameChange(){this.expression_string_generator=this.expression_string_generator||new i8(this.param);let e=this.expression_string_generator.parse_tree(this.parsed_tree);e?this.param.set(e):console.warn("failed to regenerate expression")}};var xh=class{constructor(e){this.param=e}dispose(){this.param.scene().expressionsController.deregisterParam(this.param),this._resetMethodDependencies()}_resetMethodDependencies(){var e,t;(e=this._method_dependencies_by_graph_node_id)==null||e.forEach(r=>{r.dispose()}),(t=this._method_dependencies_by_graph_node_id)==null||t.clear()}registerMethodDependency(e){this._method_dependencies_by_graph_node_id=this._method_dependencies_by_graph_node_id||new Map,this._method_dependencies_by_graph_node_id.set(e.graphNodeId(),e)}active(){return this._expression!=null}expression(){return this._expression}is_errored(){return this._manager?this._manager.is_errored():!1}error_message(){return this._manager?this._manager.error_message():null}requires_entities(){return this.param.options.isExpressionForEntities()}set_expression(e,t=!0){var r;this.param.scene().missingExpressionReferencesController.deregisterParam(this.param),this.param.scene().expressionsController.deregisterParam(this.param),this._expression!=e&&(this._resetMethodDependencies(),this._expression=e,this._expression?(this._manager=this._manager||new a8(this.param),this._manager.parseExpression(this._expression)):(r=this._manager)==null||r.reset(),t&&this.param.setDirty())}updateFromMethodDependencyNameChange(){this._manager&&this.active()&&this._manager.updateFromMethodDependencyNameChange()}computeExpression(){if(this._manager&&this.active())return this._manager.computeFunction()}async computeExpressionForEntities(e,t){var r,n;this._setEntities(e,t),await this.computeExpression(),((r=this._manager)==null?void 0:r.error_message())&&this.param.node.states.error.set(`expression evalution error: ${(n=this._manager)==null?void 0:n.error_message()}`),this._resetEntities()}computeExpressionForPoints(e,t){return this.computeExpressionForEntities(e,t)}computeExpressionForObjects(e,t){return this.computeExpressionForEntities(e,t)}entities(){return this._entities}entityCallback(){return this._entityCallback}_setEntities(e,t){this._entities=e,this._entityCallback=t}_resetEntities(){this._entities=void 0,this._entityCallback=void 0}};var Ic=class extends yo{isNumeric(){return!0}isDefault(){return this._raw_input==this._default_value}_prefilterInvalidRawInput(e){return K.isArray(e)?e[0]:e}processRawInput(){this.states.error.clear();let e=this.convert(this._raw_input);e!=null?(this._expression_controller&&(this._expression_controller.set_expression(void 0,!1),this.emitController.emit(cr.EXPRESSION_UPDATED)),e!=this._value&&(this._update_value(e),this.setSuccessorsDirty(this))):K.isString(this._raw_input)?(this._expression_controller=this._expression_controller||new xh(this),this._raw_input!=this._expression_controller.expression()&&(this._expression_controller.set_expression(this._raw_input),this.emitController.emit(cr.EXPRESSION_UPDATED))):this.states.error.set(`param input is invalid (${this.path()})`)}async processComputation(){var e;if(((e=this.expressionController)==null?void 0:e.active())&&!this.expressionController.requires_entities()){let t=await this.expressionController.computeExpression();if(this.expressionController.is_errored())this.states.error.set(`expression error: "${this.expressionController.expression()}" (${this.expressionController.error_message()})`);else{let r=this.convert(t);r!=null?(this.states.error.active()&&this.states.error.clear(),this._update_value(r)):this.states.error.set(`expression returns an invalid type (${t}) (${this.expressionController.expression()})`)}}}_update_value(e){this._value=e;let t=this.parentParam();t&&t.set_value_from_components(),this.options.executeCallback(),this.emitController.emit(cr.VALUE_UPDATED),this.removeDirtyState()}};var c8=class extends Ic{static type(){return J.BOOLEAN}defaultValueSerialized(){return K.isString(this._default_value)?this._default_value:this.convert(this._default_value)||!1}rawInputSerialized(){return this._raw_input}valueSerialized(){return this.value}_copyValue(e){this.set(e.value)}static areRawInputEqual(e,t){return e==t}static areValuesEqual(e,t){return e==t}convert(e){if(K.isBoolean(e))return e;if(K.isNumber(e))return e>=1;if(K.isString(e)){if(Ve.isBoolean(e))return Ve.toBoolean(e);if(Ve.isNumber(e))return parseFloat(e)>=1}return null}};var l8=class extends yo{static type(){return J.BUTTON}defaultValueSerialized(){return this._default_value}rawInputSerialized(){return this._raw_input}valueSerialized(){return this.value}_copyValue(e){}static areRawInputEqual(e,t){return!0}static areValuesEqual(e,t){return!0}async pressButton(){(this.node.isDirty()||this.node.cookController.isCooking())&&await this.node.compute(),this.options.executeCallback()}};var Lc=class extends Ic{static type(){return J.FLOAT}defaultValueSerialized(){return this._default_value}rawInputSerialized(){return this._raw_input}valueSerialized(){return this.value}_copyValue(e){this.set(e.valueSerialized())}_prefilterInvalidRawInput(e){return K.isArray(e)?e[0]:K.isString(e)&&Ve.isNumber(e)?parseFloat(e):e}static areRawInputEqual(e,t){return e==t}static areValuesEqual(e,t){return e==t}static convert(e){if(K.isNumber(e))return e;if(K.isBoolean(e))return e?1:0;if(Ve.isNumber(e)){let t=parseFloat(e);if(K.isNumber(t))return t}return null}convert(e){let t=Lc.convert(e);return t&&this.options.ensureInRange(t)}};var Fi=class extends yo{constructor(){super(...arguments);this._components_contructor=Lc}get components(){return this._components}isNumeric(){return!0}isDefault(){for(let e of this.components)if(!e.isDefault())return!1;return!0}rawInput(){return this._components.map(e=>e.rawInput())}rawInputSerialized(){return this._components.map(e=>e.rawInputSerialized())}_copyValue(e){for(let t=0;t<this.components.length;t++){let r=this.components[t],n=e.components[t];r.copyValue(n)}}initComponents(){if(this._components!=null)return;let e=0;this._components=new Array(this.componentNames().length);for(let t of this.componentNames()){let r=new this._components_contructor(this.scene(),this.node),n;K.isArray(this._default_value)?n=this._default_value[e]:n=this._default_value[t],r.options.copy(this.options),r.setInitValue(n),r.setName(`${this.name()}${t}`),r.set_parent_param(this),this._components[e]=r,e++}}async processComputation(){await this.compute_components(),this.set_value_from_components()}set_value_from_components(){}hasExpression(){var e;for(let t of this.components)if((e=t.expressionController)==null?void 0:e.active())return!0;return!1}async compute_components(){let e=this.components,t=[];for(let r of e)r.isDirty()&&t.push(r.compute());await Promise.all(t),this.removeDirtyState()}_prefilterInvalidRawInput(e){if(K.isArray(e))return e;{let t=e;return this.componentNames().map(()=>t)}}processRawInput(){let e=this.scene().cooker;e.block();let t=this.components;for(let i of t)i.emitController.blockParentEmit();let r=this._raw_input,n=0;if(K.isArray(r))for(let i=0;i<t.length;i++){let s=r[i];s==null&&(s=n),t[i].set(s),n=s}else for(let i=0;i<t.length;i++){let s=this.componentNames()[i],a=r[s];a==null&&(a=n),t[i].set(a),n=a}e.unblock();for(let i=0;i<t.length;i++)t[i].emitController.unblockParentEmit();this.emitController.emit(cr.VALUE_UPDATED)}};var ko=(o=>(o.NONE="no conversion",o.SRGB_TO_LINEAR="sRGB -> linear",o.LINEAR_TO_SRGB="linear -> sRGB",o))(ko||{});var EJ=["r","g","b"],u8=class extends Fi{constructor(){super(...arguments);this._value=new de,this._value_pre_conversion=new de,this._value_serialized_dirty=!1,this._value_serialized=[0,0,0],this._value_pre_conversion_serialized=[0,0,0],this._copied_value=[0,0,0]}static type(){return J.COLOR}componentNames(){return EJ}defaultValueSerialized(){return K.isArray(this._default_value)?this._default_value:this._default_value.toArray()}valueSerialized(){return this._update_value_serialized_if_required(),this._value_serialized}valuePreConversionSerialized(){return this._update_value_serialized_if_required(),this._value_pre_conversion_serialized}_copyValue(e){e.value.toArray(this._copied_value),this.set(this._copied_value)}_cloneRawInput(e){if(e instanceof de)return e.clone();{let t=[e[0],e[1],e[2]];return t[0]==null&&(t[0]=t[0]||0),t[1]==null&&(t[1]=t[1]||t[0]),t[2]==null&&(t[2]=t[2]||t[1]),t}}static areRawInputEqual(e,t){return e instanceof de?t instanceof de?e.equals(t):e.r==t[0]&&e.g==t[1]&&e.b==t[2]:t instanceof de?e[0]==t.r&&e[1]==t.g&&e[2]==t.b:e[0]==t[0]&&e[1]==t[1]&&e[2]==t[2]}static areValuesEqual(e,t){return e.equals(t)}initComponents(){super.initComponents(),this.r=this.components[0],this.g=this.components[1],this.b=this.components[2],this._value_serialized_dirty=!0}_update_value_serialized_if_required(){!this._value_serialized_dirty||(this._value_serialized[0]=this._value.r,this._value_serialized[1]=this._value.g,this._value_serialized[2]=this._value.b,this._value_pre_conversion_serialized[0]=this._value_pre_conversion.r,this._value_pre_conversion_serialized[1]=this._value_pre_conversion.g,this._value_pre_conversion_serialized[2]=this._value_pre_conversion.b)}valuePreConversion(){return this._value_pre_conversion}set_value_from_components(){this._value_pre_conversion.r=this.r.value,this._value_pre_conversion.g=this.g.value,this._value_pre_conversion.b=this.b.value,this._value.copy(this._value_pre_conversion);let e=this.options.colorConversion();if(e!=null&&e!=ko.NONE){switch(e){case ko.SRGB_TO_LINEAR:{this._value.convertSRGBToLinear();return}case ko.LINEAR_TO_SRGB:{this._value.convertLinearToSRGB();return}}Be.unreachable(e)}this._value_serialized_dirty=!0}};var p8=class extends yo{static type(){return J.FOLDER}defaultValueSerialized(){return this._default_value}rawInputSerialized(){return this._raw_input}valueSerialized(){return this.value}_copyValue(e){}static areRawInputEqual(e,t){return!0}static areValuesEqual(e,t){return!0}};var bh=class extends Ic{static type(){return J.INTEGER}defaultValueSerialized(){return this._default_value}rawInputSerialized(){return this._raw_input}valueSerialized(){return this.value}_copyValue(e){this.set(e.valueSerialized())}_prefilterInvalidRawInput(e){return K.isArray(e)?e[0]:K.isString(e)&&Ve.isNumber(e)?parseInt(e):e}static areRawInputEqual(e,t){return e==t}static areValuesEqual(e,t){return e==t}static convert(e){if(K.isNumber(e))return Math.round(e);if(K.isBoolean(e))return e?1:0;if(Ve.isNumber(e)){let t=parseInt(e);if(K.isNumber(t))return t}return null}convert(e){let t=bh.convert(e);return t&&this.options.ensureInRange(t)}};var Dc=class{constructor(){this._index=-1,this._path_elements=[],this._named_nodes=[],this._graph_node_ids=[],this._node_element_by_graph_node_id=new Map}reset(){this._index=-1,this._path_elements=[],this._named_nodes=[],this._graph_node_ids=[],this._node_element_by_graph_node_id.clear()}add_node(e,t){this._index+=1,e==t.name()&&(this._named_nodes[this._index]=t),this._graph_node_ids[this._index]=t.graphNodeId(),this._node_element_by_graph_node_id.set(t.graphNodeId(),e)}add_path_element(e){this._index+=1,this._path_elements[this._index]=e}named_graph_nodes(){return this._named_nodes}named_nodes(){let e=[];for(let t of this._named_nodes)if(t){let r=t;r.nameController&&e.push(r)}return e}update_from_name_change(e){this._named_nodes.map(r=>r==null?void 0:r.graphNodeId()).includes(e.graphNodeId())&&this._node_element_by_graph_node_id.set(e.graphNodeId(),e.name())}to_path(){let e=new Array(this._index);for(let n=0;n<=this._index;n++){let i=this._named_nodes[n];if(i){let s=this._node_element_by_graph_node_id.get(i.graphNodeId());s&&(e[n]=s)}else{let s=this._path_elements[n];s&&(e[n]=s)}}let t=e.join(ut.SEPARATOR),r=t[0];return r&&(ut.NON_LETTER_PREFIXES.includes(r)||(t=`${ut.SEPARATOR}${t}`)),t}};var Th=class extends yo{constructor(){super(...arguments);this.decomposed_path=new Dc}_handleReferences(e,t){this.scene().referencesController.setNamedNodesFromParam(this),e?this.scene().referencesController.setReferenceFromParam(this,e):this.scene().missingExpressionReferencesController.register(this,t)}};var d8=class extends Th{static type(){return J.PARAM_PATH}_initializeParam(){this._value=new Ec}defaultValueSerialized(){return this._default_value}rawInputSerialized(){return`${this._raw_input}`}valueSerialized(){return`${this.value}`}_copyValue(e){this.set(e.valueSerialized())}static areRawInputEqual(e,t){return e==t}static areValuesEqual(e,t){return e==t}isDefault(){return this._raw_input==this._default_value}setParam(e){this.set(e.path())}processRawInput(){this._value.path()!=this._raw_input&&(this._value.setPath(this._raw_input),this.findTarget(),this.setDirty(),this.emitController.emit(cr.VALUE_UPDATED))}async processComputation(){this.findTarget()}findTarget(){if(!this.node)return;let e=this._raw_input,t=null,r=e!=null&&e!=="";this.scene().referencesController.resetReferenceFromParam(this),this.decomposed_path.reset(),r&&(t=ut.findParam(this.node,e,this.decomposed_path));let n=this._value.param(),i=t;if(i&&i.graphNodeId()==this.graphNodeId()){this.states.error.set("param cannot refer to itself");return}if(this._handleReferences(t,e),(n==null?void 0:n.graphNodeId())!==(i==null?void 0:i.graphNodeId())){let s=this.options.dependentOnFoundNode(),a=this._value.param();a&&s&&this.removeGraphInput(a),t?this._assign_found_node(t):this._value.setParam(null),this.options.executeCallback()}this.removeDirtyState()}_assign_found_node(e){let t=this.options.dependentOnFoundNode();this._value.setParam(e),t&&this.addGraphInput(e)}notifyPathRebuildRequired(e){this.decomposed_path.update_from_name_change(e);let t=this.decomposed_path.to_path();this.set(t)}notifyTargetParamOwnerParamsUpdated(e){this.setDirty()}};var Ah=class extends Th{static type(){return J.NODE_PATH}_initializeParam(){this._value=new Rn}defaultValueSerialized(){return this._default_value}rawInputSerialized(){return`${this._raw_input}`}valueSerialized(){return`${this.value}`}_copyValue(e){this.set(e.valueSerialized())}static areRawInputEqual(e,t){return e==t}static areValuesEqual(e,t){return e==t}isDefault(){return this._raw_input==this._default_value}setNode(e,t){if((t==null?void 0:t.relative)==!0){let r=ut.relativePath(this.node,e);this.set(r)}else this.set(e.path())}processRawInput(){this._value.path()!=this._raw_input&&(this._value.setPath(this._raw_input),this._findTarget(),this.setDirty(),this.emitController.emit(cr.VALUE_UPDATED))}async processComputation(){this._findTarget()}_findTarget(){if(!this.node)return;let e=this._raw_input,t=null,r=e!=null&&e!=="";this.scene().referencesController.resetReferenceFromParam(this),this.decomposed_path.reset(),r&&(t=ut.findNode(this.node,e,this.decomposed_path));let n=this._value.node(),i=t;if(i&&i.graphNodeId()==this.node.graphNodeId()){this.states.error.set("param cannot refer to its own node");return}if(this._handleReferences(t,e),(n==null?void 0:n.graphNodeId())!==(i==null?void 0:i.graphNodeId())){let s=this.options.dependentOnFoundNode(),a=this._value.node();a&&s&&this.removeGraphInput(a),t?this._assignFoundNode(t):this._value.setNode(null),this.options.executeCallback()}r&&!t&&this.scene().loadingController.loaded()&&r&&this.states.error.set(`no node found at path '${e}'`),this.removeDirtyState()}_assignFoundNode(e){let t=this.options.dependentOnFoundNode();this._isNodeExpectedContext(e)?this._isNodeExpectedType(e)?(this.states.error.clear(),this._value.setNode(e),t&&this.addGraphInput(e)):this.states.error.set(`node type is ${e.type()} but the params expects one of ${(this._expectedNodeTypes()||[]).join(", ")}`):this.states.error.set(`node context is ${e.context()} but the params expects a ${this._expectedContext()}`)}_expectedContext(){return this.options.nodeSelectionContext()}_isNodeExpectedContext(e){var t,r;let n=this._expectedContext();if(n==null)return!0;let i=(r=(t=e.parent())==null?void 0:t.childrenController)==null?void 0:r.context;return n==i}_expectedNodeTypes(){return this.options.nodeSelectionTypes()}_isNodeExpectedType(e){let t=this._expectedNodeTypes();return t==null?!0:t==null?void 0:t.includes(e.type())}notifyPathRebuildRequired(e){this.decomposed_path.update_from_name_change(e);let t=this.decomposed_path.to_path();this.set(t)}notifyTargetParamOwnerParamsUpdated(e){this.setDirty()}};var $o=class{constructor(e,t,r,n){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=n!==void 0?n:new t.constructor(r),this.sampleValues=t,this.valueSize=r,this.settings=null,this.DefaultSettings_={}}evaluate(e){let t=this.parameterPositions,r=this._cachedIndex,n=t[r],i=t[r-1];r:{e:{let s;t:{o:if(!(e<n)){for(let a=r+2;;){if(n===void 0){if(e<i)break o;return r=t.length,this._cachedIndex=r,this.afterEnd_(r-1,e,i)}if(r===a)break;if(i=n,n=t[++r],e<n)break e}s=t.length;break t}if(!(e>=i)){let a=t[1];e<a&&(r=2,i=a);for(let c=r-2;;){if(i===void 0)return this._cachedIndex=0,this.beforeStart_(0,e,n);if(r===c)break;if(n=i,i=t[--r-1],e>=i)break e}s=r,r=0;break t}break r}for(;r<s;){let a=r+s>>>1;e<t[a]?s=a:r=a+1}if(n=t[r],i=t[r-1],i===void 0)return this._cachedIndex=0,this.beforeStart_(0,e,n);if(n===void 0)return r=t.length,this._cachedIndex=r,this.afterEnd_(r-1,i,e)}this._cachedIndex=r,this.intervalChanged_(r,i,n)}return this.interpolate_(r,i,e,n)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){let t=this.resultBuffer,r=this.sampleValues,n=this.valueSize,i=e*n;for(let s=0;s!==n;++s)t[s]=r[i+s];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}};$o.prototype.beforeStart_=$o.prototype.copySampleValue_;$o.prototype.afterEnd_=$o.prototype.copySampleValue_;var Ch=class extends $o{constructor(e,t,r,n){super(e,t,r,n);this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:q3,endingEnd:q3}}intervalChanged_(e,t,r){let n=this.parameterPositions,i=e-2,s=e+1,a=n[i],c=n[s];if(a===void 0)switch(this.getSettings_().endingStart){case X3:i=e,a=2*t-r;break;case Y3:i=n.length-2,a=t+n[i]-n[i+1];break;default:i=e,a=r}if(c===void 0)switch(this.getSettings_().endingEnd){case X3:s=e,c=2*r-t;break;case Y3:s=1,c=r+n[1]-n[0];break;default:s=e-1,c=t}let l=(r-t)*.5,u=this.valueSize;this._weightPrev=l/(t-a),this._weightNext=l/(c-r),this._offsetPrev=i*u,this._offsetNext=s*u}interpolate_(e,t,r,n){let i=this.resultBuffer,s=this.sampleValues,a=this.valueSize,c=e*a,l=c-a,u=this._offsetPrev,p=this._offsetNext,d=this._weightPrev,h=this._weightNext,m=(r-t)/(n-t),f=m*m,v=f*m,g=-d*v+2*d*f-d*m,_=(1+d)*v+(-1.5-2*d)*f+(-.5+d)*m+1,T=(-1-h)*v+(1.5+h)*f+.5*m,b=h*v-h*f;for(let x=0;x!==a;++x)i[x]=g*s[u+x]+_*s[l+x]+T*s[c+x]+b*s[p+x];return i}};var Ns=class{constructor(e=0,t=0){this._position=e,this._value=t}toJSON(){return{position:this._position,value:this._value}}position(){return this._position}value(){return this._value}copy(e){this._position=e.position(),this._value=e.value()}clone(){let e=new Ns;return e.copy(this),e}isEqual(e){return this._position==e.position()&&this._value==e.value()}isEqualJSON(e){return this._position==e.position&&this._value==e.value}fromJSON(e){this._position=e.position,this._value=e.value}static areEqualJSON(e,t){return e.position==t.position&&e.value==t.value}static fromJSON(e){return new Ns(e.position,e.value)}},h8=(o=>(o.CUBIC="cubic",o))(h8||{});var Yr=class{constructor(e="cubic",t=[]){this._interpolation=e,this._points=t,this._uuid=ti()}uuid(){return this._uuid}interpolation(){return this._interpolation}points(){return this._points}static createInterpolantFromValues(e,t){let n=new Float32Array(1);return new Ch(e,t,1,n)}createInterpolant(){return Yr.createInterpolant(this)}static createInterpolant(e){let t=e.points(),r=Qe.sortBy(t,a=>a.position()),n=new Float32Array(r.length),i=new Float32Array(r.length),s=0;for(let a of r)n[s]=a.position(),i[s]=a.value(),s++;return this.createInterpolantFromValues(n,i)}static fromJSON(e){let t=[];for(let n of e.points)t.push(Ns.fromJSON(n));let r=e.interpolation;return(r==null||r=="")&&(r="cubic"),new Yr(r,t)}toJSON(){return{interpolation:this._interpolation,points:this._points.map(e=>e.toJSON())}}clone(){let e=new Yr;return e.copy(this),e}copy(e){this._interpolation=e.interpolation();let t=e.points().length,r=this._points.length;if(r>t){let i=r-t,s=r-i;this._points.splice(s,i)}let n=0;for(let i of e.points()){let s=this._points[n];s?s.copy(i):this._points.push(i.clone()),n+=1}}isEqual(e){if(this._interpolation!=e.interpolation())return!1;let t=e.points();if(this._points.length!=t.length)return!1;let r=0;for(let n of this._points){let i=t[r];if(!n.isEqual(i))return!1;r+=1}return!0}isEqualJSON(e){if(this._interpolation!=e.interpolation||this._points.length!=e.points.length)return!1;let t=0;for(let r of this._points){let n=e.points[t];if(!r.isEqualJSON(n))return!1;t+=1}return!0}static are_json_equal(e,t){if(e.interpolation!=t.interpolation||e.points.length!=t.points.length)return!1;let r=0;for(let n of e.points){let i=t.points[r];if(!Ns.areEqualJSON(n,i))return!1;r+=1}return!0}fromJSON(e){this._interpolation=e.interpolation;let t=e.points.length,r=this._points.length;if(r>t){let i=r-t,s=r-i;this._points.splice(s,i)}let n=0;for(let i of e.points){let s=this._points[n];s?s.fromJSON(i):this._points.push(Ns.fromJSON(i)),n+=1}}};var wN=4,f8=1024,NN=1,MN=f8*NN,SJ=1,ON=class extends yo{constructor(){super(...arguments);this._textureData=new Float32Array(wN*MN),this._rampTexture=new Rr(this._textureData,f8,NN,at,qt)}static type(){return J.RAMP}defaultValueSerialized(){return this._default_value instanceof Yr?this._default_value.toJSON():this._default_value}_cloneRawInput(o){return o instanceof Yr?o.clone():Yr.fromJSON(o).toJSON()}rawInputSerialized(){return this._raw_input instanceof Yr?this._raw_input.toJSON():Yr.fromJSON(this._raw_input).toJSON()}valueSerialized(){return this.value.toJSON()}_copyValue(o){this.set(o.valueSerialized())}static areRawInputEqual(o,e){return o instanceof Yr?e instanceof Yr?o.isEqual(e):o.isEqualJSON(e):e instanceof Yr?e.isEqualJSON(o):Yr.are_json_equal(o,e)}static areValuesEqual(o,e){return o.isEqual(e)}isDefault(){return this._default_value instanceof Yr?this.value.isEqual(this._default_value):this.value.isEqualJSON(this._default_value)}processRawInput(){this._raw_input instanceof Yr?this._value?this._value.copy(this._raw_input):this._value=this._raw_input:this._value?this._value.fromJSON(this._raw_input):this._value=Yr.fromJSON(this._raw_input),this._resetRampInterpolant(),this._updateRampTexture(),this.options.executeCallback(),this.emitController.emit(cr.VALUE_UPDATED),this.setSuccessorsDirty(this)}hasExpression(){return!1}_resetRampInterpolant(){this._rampInterpolant=void 0}rampTexture(){return this._rampTexture}_updateRampTexture(){this._updateRampTextureData(),this.rampTexture().needsUpdate=!0}_updateRampTextureData(){let o=0,e=0,t=0;for(var r=0;r<MN;r++)o=r*wN,e=r/f8,t=this.valueAtPosition(e),this._textureData[o+0]=t*SJ,this._textureData[o+1]=0,this._textureData[o+2]=0}interpolant(){return this._rampInterpolant=this._rampInterpolant||this._createInterpolant()}_createInterpolant(){return this.value.createInterpolant()}valueAtPosition(o){return this.interpolant().evaluate(o)[0]}},Os=ON;Os.DEFAULT_VALUE=new Yr(h8.CUBIC,[new Ns(0,0),new Ns(1,1)]);Os.DEFAULT_VALUE_JSON=ON.DEFAULT_VALUE.toJSON();var Eh=class extends yo{static type(){return J.STRING}defaultValueSerialized(){return this._default_value}_cloneRawInput(e){return`${e}`}rawInputSerialized(){return`${this._raw_input}`}valueSerialized(){return`${this.value}`}_copyValue(e){this.set(e.value)}static areRawInputEqual(e,t){return e==t}static areValuesEqual(e,t){return e==t}isDefault(){return this._raw_input==this._default_value}convert(e){return K.isString(e)?e:`${e}`}rawInput(){return this._raw_input}processRawInput(){this.states.error.clear(),this._value_elements(this._raw_input).length>=3?(this._expression_controller=this._expression_controller||new xh(this),this._raw_input!=this._expression_controller.expression()&&(this._expression_controller.set_expression(this._raw_input),this.setDirty(),this.emitController.emit(cr.EXPRESSION_UPDATED))):this._raw_input!=this._value&&(this._value=this._raw_input,this.removeDirtyState(),this.setSuccessorsDirty(this),this.emitController.emit(cr.VALUE_UPDATED),this.options.executeCallback(),this._expression_controller&&(this._expression_controller.set_expression(void 0,!1),this.emitController.emit(cr.EXPRESSION_UPDATED)))}async processComputation(){var e;if(((e=this.expressionController)==null?void 0:e.active())&&!this.expressionController.requires_entities()){let t=await this.expressionController.computeExpression();if(this.expressionController.is_errored())this.states.error.set(`expression error: ${this.expressionController.error_message()}`);else{let r=this.convert(t);r!=null?(this._value=r,this.emitController.emit(cr.VALUE_UPDATED),this.options.executeCallback()):this.states.error.set(`expression returns an invalid type (${t})`),this.removeDirtyState()}}}_value_elements(e){return aa.string_value_elements(e)}};var wJ=["x","y"],m8=class extends Fi{constructor(){super(...arguments);this._value=new z,this._copied_value=[0,0]}static type(){return J.VECTOR2}componentNames(){return wJ}defaultValueSerialized(){return K.isArray(this._default_value)?this._default_value:this._default_value.toArray()}valueSerialized(){return this.value.toArray()}_copyValue(e){e.value.toArray(this._copied_value),this.set(this._copied_value)}_cloneRawInput(e){if(e instanceof z)return e.clone();{let t=[e[0],e[1]];return t[0]==null&&(t[0]=t[0]||0),t[1]==null&&(t[1]=t[1]||t[0]),t}}static areRawInputEqual(e,t){return e instanceof z?t instanceof z?e.equals(t):e.x==t[0]&&e.y==t[1]:t instanceof z?e[0]==t.x&&e[1]==t.y:e[0]==t[0]&&e[1]==t[1]}static areValuesEqual(e,t){return e.equals(t)}initComponents(){super.initComponents(),this.x=this.components[0],this.y=this.components[1]}set_value_from_components(){this._value.x=this.x.value,this._value.y=this.y.value}};var MJ=["x","y","z"],_8=class extends Fi{constructor(){super(...arguments);this._value=new M,this._copied_value=[0,0,0]}static type(){return J.VECTOR3}componentNames(){return MJ}defaultValueSerialized(){return K.isArray(this._default_value)?this._default_value:this._default_value.toArray()}valueSerialized(){return this.value.toArray()}_copyValue(e){e.value.toArray(this._copied_value),this.set(this._copied_value)}_cloneRawInput(e){if(e instanceof M)return e.clone();{let t=[e[0],e[1],e[2]];return t[0]==null&&(t[0]=t[0]||0),t[1]==null&&(t[1]=t[1]||t[0]),t[2]==null&&(t[2]=t[2]||t[1]),t}}static areRawInputEqual(e,t){return e instanceof M?t instanceof M?e.equals(t):e.x==t[0]&&e.y==t[1]&&e.z==t[2]:t instanceof M?e[0]==t.x&&e[1]==t.y&&e[2]==t.z:e[0]==t[0]&&e[1]==t[1]&&e[2]==t[2]}static areValuesEqual(e,t){return e.equals(t)}initComponents(){super.initComponents(),this.x=this.components[0],this.y=this.components[1],this.z=this.components[2]}set_value_from_components(){this._value.x=this.x.value,this._value.y=this.y.value,this._value.z=this.z.value}};var NJ=["x","y","z","w"],g8=class extends Fi{constructor(){super(...arguments);this._value=new De,this._copied_value=[0,0,0,0]}static type(){return J.VECTOR4}componentNames(){return NJ}defaultValueSerialized(){return K.isArray(this._default_value)?this._default_value:this._default_value.toArray()}valueSerialized(){return this.value.toArray()}_copyValue(e){e.value.toArray(this._copied_value),this.set(this._copied_value)}_cloneRawInput(e){if(e instanceof De)return e.clone();{let t=[e[0],e[1],e[2],e[3]];return t[0]==null&&(t[0]=t[0]||0),t[1]==null&&(t[1]=t[1]||t[0]),t[2]==null&&(t[2]=t[2]||t[1]),t[3]==null&&(t[3]=t[3]||t[2]),t}}static areRawInputEqual(e,t){return e instanceof De?t instanceof De?e.equals(t):e.x==t[0]&&e.y==t[1]&&e.z==t[2]&&e.w==t[3]:t instanceof De?e[0]==t.x&&e[1]==t.y&&e[2]==t.z&&e[3]==t.w:e[0]==t[0]&&e[1]==t[1]&&e[2]==t[2]&&e[3]==t[3]}static areValuesEqual(e,t){return e.equals(t)}initComponents(){super.initComponents(),this.x=this.components[0],this.y=this.components[1],this.z=this.components[2],this.w=this.components[3]}set_value_from_components(){this._value.x=this.x.value,this._value.y=this.y.value,this._value.z=this.z.value,this._value.w=this.w.value}};var PN={[J.BOOLEAN]:c8,[J.BUTTON]:l8,[J.COLOR]:u8,[J.FLOAT]:Lc,[J.FOLDER]:p8,[J.INTEGER]:bh,[J.PARAM_PATH]:d8,[J.NODE_PATH]:Ah,[J.RAMP]:Os,[J.STRING]:Eh,[J.VECTOR2]:m8,[J.VECTOR3]:_8,[J.VECTOR4]:g8};var OJ="params",v8=class{constructor(e){this.node=e,this._param_create_mode=!1,this._params_created=!1,this._params_by_name={},this._params_list=[],this._param_names=[],this._non_spare_params=[],this._spare_params=[],this._non_spare_param_names=[],this._spare_param_names=[],this._params_added_since_last_params_eval=!1,this._promises=[]}dispose(){this._params_node&&this._params_node.dispose();for(let e of this.all)e.dispose();this._post_create_params_hook_names=void 0,this._post_create_params_hooks=void 0,this._on_scene_load_hooks=void 0,this._on_scene_load_hook_names=void 0}initDependencyNode(){this._params_node||(this._params_node=new Kt(this.node.scene(),OJ),this.node.addGraphInput(this._params_node,!1))}init(){this.initDependencyNode(),this._param_create_mode=!0,this._initFromParamsConfig(),this.node.createParams(),this._postCreateParams()}_postCreateParams(){this._updateCaches(),this._initParamAccessors(),this._param_create_mode=!1,this._params_created=!0,this._runPostCreateParamsHooks()}postCreateSpareParams(){this._updateCaches(),this._initParamAccessors(),this.node.scene().referencesController.notifyParamsUpdated(this.node),this.node.emit(Nt.PARAMS_UPDATED)}updateParams(e){let t=!1,r=!1,n=[];if(e.namesToDelete)for(let i of e.namesToDelete)this.has(i)&&(this._deleteParam(i),r=!0);if(e.toAdd)for(let i of e.toAdd){let s=this.addParam(i.type,i.name,i.initValue,i.options);s&&(i.rawInput!=null&&s.set(i.rawInput),t=!0,n.push(s))}(r||t)&&this.postCreateSpareParams();for(let i of n)this.node.scene().missingExpressionReferencesController.checkForMissingParamReferences(i)}_initFromParamsConfig(){var e;let t=this.node.paramsConfig,r=!1;if(t)for(let n of Object.keys(t)){let i=t[n],s,a=(e=this.node.createOptions)==null?void 0:e.paramsInitValueOverrides;a&&(s=a[n],r=!0),this.addParam(i.type,n,i.init_value,i.options,s)}r&&this.node.setDirty(),this.node.createOptions&&(this.node.createOptions.paramsInitValueOverrides=void 0)}_initParamAccessors(){let e=Object.getOwnPropertyNames(this.node.pv);this._removeUnneededAccessors(e),e=Object.getOwnPropertyNames(this.node.pv);for(let t of this.all){let r=t.options.isSpare();(!e.includes(t.name())||r)&&(Object.defineProperty(this.node.pv,t.name(),{get:()=>t.value,configurable:r}),Object.defineProperty(this.node.p,t.name(),{get:()=>t,configurable:r}))}}_removeUnneededAccessors(e){let t=this._param_names,r=[];for(let n of e)t.includes(n)||r.push(n);for(let n of r)Object.defineProperty(this.node.pv,n,{get:()=>{},configurable:!0}),Object.defineProperty(this.node.p,n,{get:()=>{},configurable:!0})}get params_node(){return this._params_node}get all(){return this._params_list}get non_spare(){return this._non_spare_params}get spare(){return this._spare_params}get names(){return this._param_names}get non_spare_names(){return this._non_spare_param_names}get spare_names(){return this._spare_param_names}set_with_type(e,t,r){let n=this.paramWithType(e,r);n?n.set(t):Q.warn(`param ${e} not found with type ${r}`)}set_float(e,t){this.set_with_type(e,t,J.FLOAT)}set_vector3(e,t){this.set_with_type(e,t,J.VECTOR3)}has_param(e){return this._params_by_name[e]!=null}has(e){return this.has_param(e)}get(e){return this.param(e)}paramWithType(e,t){let r=this.param(e);if(r&&r.type()==t)return r}getFloat(e){return this.paramWithType(e,J.FLOAT)}value(e){var t;return(t=this.param(e))==null?void 0:t.value}valueWithType(e,t){var r;return(r=this.paramWithType(e,t))==null?void 0:r.value}boolean(e){return this.valueWithType(e,J.BOOLEAN)}float(e){return this.valueWithType(e,J.FLOAT)}integer(e){return this.valueWithType(e,J.INTEGER)}string(e){return this.valueWithType(e,J.STRING)}vector2(e){return this.valueWithType(e,J.VECTOR2)}vector3(e){return this.valueWithType(e,J.VECTOR3)}color(e){return this.valueWithType(e,J.COLOR)}param(e){let t=this._params_by_name[e];return t!=null?t:(Q.warn(`tried to access param '${e}' in node ${this.node.path()}, but existing params are: ${this.names} on node ${this.node.path()}`),null)}_deleteParam(e){let t=this._params_by_name[e];if(t){if(this._params_node&&this._params_node.removeGraphInput(this._params_by_name[e]),t._setupNodeDependencies(null),delete this._params_by_name[e],t.isMultiple()&&t.components)for(let r of t.components){let n=r.name();delete this._params_by_name[n]}t.dispose()}else throw new Error(`param '${e}' does not exist on node ${this.node.path()}`)}addParam(e,t,r,n={},i){let s=n.spare||!1;this._param_create_mode===!1&&!s&&Q.warn(`node ${this.node.path()} (${this.node.type()}) param '${t}' cannot be created outside of createParams`),this.node.scene()==null&&Q.warn(`node ${this.node.path()} (${this.node.type()}) has no scene assigned`);let a=PN[e];if(a!=null){let c=this._params_by_name[t];c&&(s?c.type()!=e&&this._deleteParam(c.name()):Q.warn(`a param named ${t} already exists`,this.node));let l=new a(this.node.scene(),this.node);if(l.options.set(n),l.setName(t),l.setInitValue(r),l.initComponents(),i==null)l.set(r);else if(l.options.isExpressionForEntities()&&l.set(r),i.raw_input!=null)l.set(i.raw_input);else if(i.simple_data!=null)l.set(i.simple_data);else if(i.complex_data!=null){let u=i.complex_data.raw_input;u?l.set(u):l.set(r);let p=i.complex_data.overriden_options;if(p!=null){let d=Object.keys(p);for(let h of d)l.options.setOption(h,p[h])}}if(l._setupNodeDependencies(this.node),this._params_by_name[l.name()]=l,l.isMultiple()&&l.components)for(let u of l.components)this._params_by_name[u.name()]=u;return this._params_added_since_last_params_eval=!0,l}}_updateCaches(){this._params_list=Object.values(this._params_by_name),this._param_names=Object.keys(this._params_by_name),this._non_spare_params=Object.values(this._params_by_name).filter(e=>!e.options.isSpare()),this._spare_params=Object.values(this._params_by_name).filter(e=>e.options.isSpare()),this._non_spare_param_names=Object.values(this._params_by_name).filter(e=>!e.options.isSpare()).map(e=>e.name()),this._spare_param_names=Object.values(this._params_by_name).filter(e=>e.options.isSpare()).map(e=>e.name())}async _evalParam(e){e.isDirty()&&(await e.compute(),e.states.error.active()&&this.node.states.error.set(`param '${e.name()}' error: ${e.states.error.message()}`))}async evalParams(e){let t=0;for(let n of e)n.isDirty()&&(t+=1);this._promises.length=t;let r=0;for(let n of e)n.isDirty()&&(this._promises[r]=this._evalParam(n),r+=1);await Promise.all(this._promises),this.node.states.error.active()&&this.node._setContainer(null)}paramsEvalRequired(){return this._params_node!=null&&(this._params_node.isDirty()||this._params_added_since_last_params_eval)}async evalAll(){var e;this.paramsEvalRequired()&&(await this.evalParams(this._params_list),(e=this._params_node)==null||e.removeDirtyState(),this._params_added_since_last_params_eval=!1)}onParamsCreated(e,t){if(this._params_created)t();else{if(this._post_create_params_hook_names&&this._post_create_params_hook_names.includes(e)){Q.error(`hook name ${e} already exists`);return}this._post_create_params_hook_names=this._post_create_params_hook_names||[],this._post_create_params_hook_names.push(e),this._post_create_params_hooks=this._post_create_params_hooks||[],this._post_create_params_hooks.push(t)}}addOnSceneLoadHook(e,t){this._on_scene_load_hook_names=this._on_scene_load_hook_names||[],this._on_scene_load_hooks=this._on_scene_load_hooks||[],this._on_scene_load_hook_names.includes(e)?Q.warn(`hook with name ${e} already exists`,this.node):(this._on_scene_load_hook_names.push(e),this._on_scene_load_hooks.push(t))}_runPostCreateParamsHooks(){if(this._post_create_params_hooks)for(let e of this._post_create_params_hooks)e()}runOnSceneLoadHooks(){if(this._on_scene_load_hooks)for(let e of this._on_scene_load_hooks)e()}};var y8=class{constructor(){}};var RN=class{constructor(o,e,t=0,r=0){if(this._node_src=o,this._node_dest=e,this._output_index=t,this._input_index=r,this._output_index==null)throw"bad output index";if(this._input_index==null)throw"bad input index";this._id=RN._next_id++,this._node_src.io.connections&&this._node_dest.io.connections&&(this._node_src.io.connections.addOutputConnection(this),this._node_dest.io.connections.addInputConnection(this))}get id(){return this._id}get node_src(){return this._node_src}get node_dest(){return this._node_dest}get output_index(){return this._output_index}get input_index(){return this._input_index}src_connection_point(){let o=this._node_src,e=this._output_index;return o.io.outputs.namedOutputConnectionPoints()[e]}dest_connection_point(){let o=this._node_dest,e=this._input_index;return o.io.inputs.namedInputConnectionPoints()[e]}disconnect(o={}){this._node_src.io.connections&&this._node_dest.io.connections&&(this._node_src.io.connections.removeOutputConnection(this),this._node_dest.io.connections.removeInputConnection(this)),o.setInput===!0&&this._node_dest.io.inputs.setInput(this._input_index,null)}},x8=RN;x8._next_id=0;var b8=class{constructor(e){this.inputs_controller=e,this._cloneRequiredStates=[],this._overridden=!1,this.node=e.node}initInputsClonedState(e){K.isArray(e)?this._clonedStates=e:this._clonedState=e,this._updateCloneRequiredState()}overrideClonedStateAllowed(){if(this._clonedStates){for(let e of this._clonedStates)if(e==ke.FROM_NODE)return!0}return this._clonedState?this._clonedState==ke.FROM_NODE:!1}cloneRequiredState(e){return this._cloneRequiredStates[e]}cloneRequiredStates(){return this._cloneRequiredStates}_getCloneRequiredState(e){let t=this._clonedStates;if(t){let r=t[e];if(r!=null)return this._cloneRequiredFromState(r)}return this._clonedState?this._cloneRequiredFromState(this._clonedState):!0}_cloneRequiredFromState(e){switch(e){case ke.ALWAYS:return!0;case ke.NEVER:return!1;case ke.FROM_NODE:return!this._overridden}return Be.unreachable(e)}overrideClonedState(e){this._overridden=e,this._updateCloneRequiredState(),this.node.emit(Nt.OVERRIDE_CLONABLE_STATE_UPDATE),this.node.setDirty()}overriden(){return this._overridden}_updateCloneRequiredState(){if(this._clonedStates){let e=[];for(let t=0;t<this._clonedStates.length;t++)e[t]=this._getCloneRequiredState(t);this._cloneRequiredStates=e}else if(this._clonedState){let e=this.inputs_controller.maxInputsCount(),t=[];for(let r=0;r<e;r++)t[r]=this._getCloneRequiredState(r);this._cloneRequiredStates=t}}};var T8=0,A8=class{constructor(e){this.node=e,this._graphNodeInputs=[],this._inputs=[],this._has_named_inputs=!1,this._minInputsCount=0,this._maxInputsCount=T8,this._maxInputsCountOnInput=T8,this._depends_on_inputs=!0}dispose(){this._graphNode&&this._graphNode.dispose();for(let e of this._graphNodeInputs)e&&e.dispose();this._on_update_hooks=void 0,this._on_update_hook_names=void 0}set_depends_on_inputs(e){this._depends_on_inputs=e}setMinCount(e){this._minInputsCount=e}minCount(){return this._minInputsCount}setMaxCount(e){this._maxInputsCount==T8&&(this._maxInputsCountOnInput=e),this._maxInputsCount=e,this._initGraphNodeInputs()}namedInputConnectionPointsByName(e){if(this._named_input_connection_points){for(let t of this._named_input_connection_points)if(t&&t.name()==e)return t}}setNamedInputConnectionPoints(e){this._has_named_inputs=!0;let t=this.node.io.connections.inputConnections();if(t)for(let r of t)r&&r.input_index>=e.length&&r.disconnect({setInput:!0});this._named_input_connection_points=e,this.setMinCount(0),this.setMaxCount(e.length),this._initGraphNodeInputs(),this.node.emit(Nt.NAMED_INPUTS_UPDATED)}hasNamedInputs(){return this._has_named_inputs}namedInputConnectionPoints(){return this._named_input_connection_points||[]}_initGraphNodeInputs(){for(let e=0;e<this._maxInputsCount;e++)this._graphNodeInputs[e]=this._graphNodeInputs[e]||this._createGraphNodeInput(e)}_createGraphNodeInput(e){let t=new Kt(this.node.scene(),`input_${e}`);return this._graphNode||(this._graphNode=new Kt(this.node.scene(),"inputs"),this.node.addGraphInput(this._graphNode,!1)),this._graphNode.addGraphInput(t,!1),t}maxInputsCount(){return this._maxInputsCount||0}maxInputsCountOverriden(){return this._maxInputsCount!=this._maxInputsCountOnInput}inputGraphNode(e){return this._graphNodeInputs[e]}setCount(e,t){t==null&&(t=e),this.setMinCount(e),this.setMaxCount(t),this._initConnectionControllerInputs()}_initConnectionControllerInputs(){this.node.io.connections.initInputs()}isAnyInputDirty(){var e;return((e=this._graphNode)==null?void 0:e.isDirty())||!1}containersWithoutEvaluation(){let e=[];for(let t=0;t<this._inputs.length;t++){let r=this._inputs[t],n;r&&(n=r.containerController.containerUnlessBypassed()),e.push(n)}return e}_existingInputIndices(){let e=[];if(this._maxInputsCount>0)for(let t=0;t<this._inputs.length;t++)this._inputs[t]&&e.push(t);return e}async evalRequiredInputs(){var e;let t=[];if(this._maxInputsCount>0){let r=this._existingInputIndices();if(r.length<this._minInputsCount)this.node.states.error.set("inputs are missing");else if(r.length>0){let n=[],i;for(let s=0;s<this._inputs.length;s++)i=this._inputs[s],i&&n.push(this.evalRequiredInput(s));t=await Promise.all(n),(e=this._graphNode)==null||e.removeDirtyState()}}return t}async evalRequiredInput(e){let t,r=this.input(e);if(r&&(t=await r.compute(),this._graphNodeInputs[e].removeDirtyState()),!(t&&t.coreContent())){let n=this.input(e);if(n){let i=n.states.error.message();i&&this.node.states.error.set(`input ${e} is invalid (error: ${i})`)}}return t}getNamedInputIndex(e){var t;if(this._named_input_connection_points){for(let r=0;r<this._named_input_connection_points.length;r++)if(((t=this._named_input_connection_points[r])==null?void 0:t.name())==e)return r}return-1}getInputIndex(e){if(K.isString(e)){if(this.hasNamedInputs())return this.getNamedInputIndex(e);throw new Error(`node ${this.node.path()} has no named inputs`)}else return e}setInput(e,t,r=0){let n=this.getInputIndex(e)||0;if(n<0){let u=`invalid input (${e}) for node ${this.node.path()}`;throw console.warn(u),new Error(u)}let i=0;if(t&&t.io.outputs.hasNamedOutputs()&&(i=t.io.outputs.getOutputIndex(r),i==null||i<0)){let p=t.io.outputs.namedOutputConnectionPoints().map(d=>d.name());console.warn(`node ${t.path()} does not have an output named ${r}. inputs are: ${p.join(", ")}`);return}let s=this._graphNodeInputs[n];if(s==null){let u=`graph_input_node not found at index ${n}`;throw console.warn(u),new Error(u)}if(t&&this.node.parent()!=t.parent())return;let a=this._inputs[n],c=null,l;this.node.io.connections&&(l=this.node.io.connections.inputConnection(n)),l&&(c=l.output_index),(t!==a||i!=c)&&(a!=null&&this._depends_on_inputs&&s.removeGraphInput(a),t!=null?s.addGraphInput(t)?(this._depends_on_inputs||s.removeGraphInput(t),l&&l.disconnect({setInput:!1}),this._inputs[n]=t,new x8(t,this.node,i,n)):console.warn(`cannot connect ${t.path()} to ${this.node.path()}`):(this._inputs[n]=null,l&&l.disconnect({setInput:!1})),this._run_on_set_input_hooks(),s.setSuccessorsDirty(),this.node.emit(Nt.INPUTS_UPDATED))}remove_input(e){let t=this.inputs(),r;for(let n=0;n<t.length;n++)r=t[n],r!=null&&e!=null&&r.graphNodeId()===e.graphNodeId()&&this.setInput(n,null)}input(e){return this._inputs[e]}named_input(e){if(this.hasNamedInputs()){let t=this.getInputIndex(e);return this._inputs[t]}else return null}named_input_connection_point(e){if(this.hasNamedInputs()&&this._named_input_connection_points){let t=this.getInputIndex(e);return this._named_input_connection_points[t]}}has_named_input(e){return this.getNamedInputIndex(e)>=0}hasInput(e){return this._inputs[e]!=null}inputs(){return this._inputs}initInputsClonedState(e){this._clonedStatesController||(this._clonedStatesController=new b8(this),this._clonedStatesController.initInputsClonedState(e))}overrideClonedStateAllowed(){var e;return((e=this._clonedStatesController)==null?void 0:e.overrideClonedStateAllowed())||!1}overrideClonedState(e){var t;(t=this._clonedStatesController)==null||t.overrideClonedState(e)}clonedStateOverriden(){var e;return((e=this._clonedStatesController)==null?void 0:e.overriden())||!1}cloneRequired(e){var t;let r=(t=this._clonedStatesController)==null?void 0:t.cloneRequiredState(e);return r!=null?r:!0}cloneRequiredStates(){var e;let t=(e=this._clonedStatesController)==null?void 0:e.cloneRequiredStates();return t!=null?t:!0}add_on_set_input_hook(e,t){this._on_update_hooks=this._on_update_hooks||[],this._on_update_hook_names=this._on_update_hook_names||[],this._on_update_hook_names.includes(e)?console.warn(`hook with name ${e} already exists`,this.node):(this._on_update_hooks.push(t),this._on_update_hook_names.push(e))}_run_on_set_input_hooks(){if(this._on_update_hooks)for(let e of this._on_update_hooks)e()}};var C8=class{constructor(e){this.node=e,this._has_outputs=!1,this._has_named_outputs=!1}dispose(){this._named_output_connection_points&&this._named_output_connection_points.splice(0,this._named_output_connection_points.length)}setHasOneOutput(){this._has_outputs=!0}setHasNoOutput(){this._has_outputs=!1}hasOutputs(){return this._has_outputs}hasNamedOutputs(){return this._has_named_outputs}hasNamedOutput(e){return this.getNamedOutputIndex(e)>=0}namedOutputConnectionPoints(){return this._named_output_connection_points||[]}namedOutputConnection(e){if(this._named_output_connection_points)return this._named_output_connection_points[e]}getNamedOutputIndex(e){var t;if(this._named_output_connection_points){for(let r=0;r<this._named_output_connection_points.length;r++)if(((t=this._named_output_connection_points[r])==null?void 0:t.name())==e)return r}return-1}getOutputIndex(e){return e!=null?K.isString(e)?this.hasNamedOutputs()?this.getNamedOutputIndex(e):(console.warn(`node ${this.node.path()} has no named outputs`),-1):e:-1}namedOutputConnectionPointsByName(e){if(this._named_output_connection_points){for(let t of this._named_output_connection_points)if((t==null?void 0:t.name())==e)return t}}setNamedOutputConnectionPoints(e,t=!0){this._has_named_outputs=!0;let r=this.node.io.connections.outputConnections();if(r)for(let n of r)n&&n.output_index>=e.length&&n.disconnect({setInput:!0});this._named_output_connection_points=e,t&&this.node.scene()&&this.node.setDirty(this.node),this.node.emit(Nt.NAMED_OUTPUTS_UPDATED)}used_output_names(){var e;let t=this.node.io.connections;if(t){let n=t.outputConnections().map(a=>a?a.output_index:null);n=Qe.uniq(n);let i=[];n.forEach(a=>{K.isNumber(a)&&i.push(a)});let s=[];for(let a of i){let c=(e=this.namedOutputConnectionPoints()[a])==null?void 0:e.name();c&&s.push(c)}return s}else return[]}};var E8=class{constructor(e){this._node=e,this._outputConnections=new Map}initInputs(){let e=this._node.io.inputs.maxInputsCount();for(this._inputConnections=this._inputConnections||new Array(e);this._inputConnections.length<e;)this._inputConnections.push(void 0)}dispose(){this._inputConnections&&this._inputConnections.splice(0,this._inputConnections.length),this._outputConnections&&this._outputConnections.clear()}addInputConnection(e){this._inputConnections?this._inputConnections[e.input_index]=e:console.warn("input connections array not initialized")}removeInputConnection(e){if(this._inputConnections)if(e.input_index<this._inputConnections.length){this._inputConnections[e.input_index]=void 0;let t=!0;for(let r=e.input_index;r<this._inputConnections.length;r++)this._inputConnections[r]&&(t=!1);t&&(this._inputConnections=this._inputConnections.slice(0,e.input_index))}else console.warn(`attempt to remove an input connection at index ${e.input_index}`);else console.warn("input connections array not initialized")}inputConnection(e){if(this._inputConnections)return this._inputConnections[e]}firstInputConnection(){return this._inputConnections?Qe.compact(this._inputConnections)[0]:null}inputConnections(){return this._inputConnections}existingInputConnections(){let e=this._inputConnections;if(e)for(;e.length>1&&e[e.length-1]===void 0;)e.pop();return e}addOutputConnection(e){let t=e.output_index,r=e.id,n=this._outputConnections.get(t);n||(n=new Map,this._outputConnections.set(t,n)),n.set(r,e)}removeOutputConnection(e){let t=e.output_index,r=e.id,n=this._outputConnections.get(t);n&&n.delete(r)}outputConnections(){let e=[];return this._outputConnections.forEach((t,r)=>{t.forEach((n,i)=>{n&&e.push(n)})}),e}};var S8=class{constructor(e){this._node=e}set_in(e){this._in=e}set_out(e){this._out=e}clear(){this._in=void 0,this._out=void 0}in(){return this._in}out(){return this._out}};var kc=class{constructor(e,t,r){this._name=e,this._type=t,this._init_value=r}get init_value(){return this._init_value}name(){return this._name}type(){return this._type}are_types_matched(e,t){return!0}toJSON(){return this._json=this._json||this._create_json()}_create_json(){return{name:this._name,type:this._type}}};var xo=(o=>(o.BOOL="bool",o.INT="int",o.FLOAT="float",o.VEC2="vec2",o.VEC3="vec3",o.VEC4="vec4",o.SAMPLER_2D="sampler2D",o.SSS_MODEL="SSSModel",o))(xo||{});var PJ={bool:J.BOOLEAN,int:J.INTEGER,float:J.FLOAT,vec2:J.VECTOR2,vec3:J.VECTOR3,vec4:J.VECTOR4,sampler2D:J.RAMP,SSSModel:J.STRING},IN={[J.BOOLEAN]:"bool",[J.COLOR]:"vec3",[J.INTEGER]:"int",[J.FLOAT]:"float",[J.FOLDER]:void 0,[J.VECTOR2]:"vec2",[J.VECTOR3]:"vec3",[J.VECTOR4]:"vec4",[J.BUTTON]:void 0,[J.PARAM_PATH]:void 0,[J.NODE_PATH]:void 0,[J.RAMP]:void 0,[J.STRING]:void 0},RJ={bool:!1,int:0,float:0,vec2:[0,0],vec3:[0,0,0],vec4:[0,0,0,0],sampler2D:Os.DEFAULT_VALUE_JSON,SSSModel:"SSSModel()"},Sh={bool:1,int:1,float:1,vec2:2,vec3:3,vec4:4,sampler2D:1,SSSModel:1},w8=class extends kc{constructor(e,t,r){super(e,t);this._name=e,this._type=t,this._init_value=r,this._init_value=this._init_value||RJ[this._type]}type(){return this._type}are_types_matched(e,t){return e==t}get param_type(){return PJ[this._type]}get init_value(){return this._init_value}toJSON(){return this._json=this._json||this._create_json()}_create_json(){return{name:this._name,type:this._type}}};var M8=(o=>(o.BOOL="bool",o.INT="int",o.FLOAT="float",o.VEC2="vec2",o.VEC3="vec3",o.VEC4="vec4",o))(M8||{});var IJ={bool:J.BOOLEAN,int:J.INTEGER,float:J.FLOAT,vec2:J.VECTOR2,vec3:J.VECTOR3,vec4:J.VECTOR4},LN={[J.BOOLEAN]:"bool",[J.COLOR]:"vec3",[J.INTEGER]:"int",[J.FLOAT]:"float",[J.FOLDER]:void 0,[J.VECTOR2]:"vec2",[J.VECTOR3]:"vec3",[J.VECTOR4]:"vec4",[J.BUTTON]:void 0,[J.PARAM_PATH]:void 0,[J.NODE_PATH]:void 0,[J.RAMP]:void 0,[J.STRING]:void 0},LJ={bool:!1,int:0,float:0,vec2:[0,0],vec3:[0,0,0],vec4:[0,0,0,0]};var N8=class extends kc{constructor(e,t){super(e,t);this._type=t,this._init_value=LJ[this._type]}type(){return this._type}are_types_matched(e,t){return e==t}get param_type(){return IJ[this._type]}get init_value(){return this._init_value}toJSON(){return this._json=this._json||this._create_json()}_create_json(){return{name:this._name,type:this._type}}};var We=(o=>(o.BASE="base",o.DRAG="drag",o.KEYBOARD="keyboard",o.MOUSE="mouse",o.POINTER="pointer",o))(We||{}),qe=class extends kc{constructor(e,t,r){super(e,t);this._name=e,this._type=t,this._event_listener=r}type(){return this._type}get param_type(){return J.FLOAT}are_types_matched(e,t){return t=="base"?!0:e==t}get event_listener(){return this._event_listener}toJSON(){return this._json=this._json||this._create_json()}_create_json(){return{name:this._name,type:this._type}}};var DN={[oe.ANIM]:void 0,[oe.AUDIO]:void 0,[oe.COP]:void 0,[oe.EVENT]:We.BASE,[oe.GL]:xo.FLOAT,[oe.JS]:M8.FLOAT,[oe.MANAGER]:void 0,[oe.MAT]:void 0,[oe.OBJ]:void 0,[oe.POST]:void 0,[oe.ROP]:void 0,[oe.SOP]:void 0};function n_(o,e,t){switch(o){case oe.EVENT:return new qe(e,t);case oe.GL:return new w8(e,t);case oe.JS:return new N8(e,t);default:return}}function kN(o){switch(o){case oe.EVENT:return;case oe.GL:return IN;case oe.JS:return LN;default:return}}var O8=class{constructor(e,t){this.node=e,this._context=t,this._raw_input_serialized_by_param_name=new Map,this._default_value_serialized_by_param_name=new Map,this._initialized=!1}initializeNode(){if(this._initialized){console.warn("already initialized",this.node);return}this._initialized=!0,this.node.params.onParamsCreated("create_inputs_from_params",this.create_inputs_from_params.bind(this))}initialized(){return this._initialized}create_inputs_from_params(){let e=kN(this._context);if(!e)return;let t=[];for(let r of this.node.params.names){let n=!0;if(this._inputless_param_names&&this._inputless_param_names.length>0&&this._inputless_param_names.includes(r)&&(n=!1),n&&this.node.params.has(r)){let i=this.node.params.get(r);if(i&&!i.parentParam()){let s=e[i.type()];if(s){let a=n_(this._context,i.name(),s);a&&t.push(a)}}}}this.node.io.inputs.setNamedInputConnectionPoints(t)}set_inputless_param_names(e){return this._inputless_param_names=e}createSpareParameters(){if(this.node.scene().loadingController.isLoading())return;let e=this.node.params.spare_names,t={};for(let n of e)if(this.node.params.has(n)){let i=this.node.params.get(n);i&&(this._raw_input_serialized_by_param_name.set(n,i.rawInputSerialized()),this._default_value_serialized_by_param_name.set(n,i.defaultValueSerialized()),t.namesToDelete=t.namesToDelete||[],t.namesToDelete.push(n))}let r=0;for(let n of this.node.io.inputs.namedInputConnectionPoints()){if(n){let i=this.node.io.inputs.input(r)!=null,s=n.name(),a=n.param_type,c=n.init_value,l=this._default_value_serialized_by_param_name.get(s),u=this.node.paramDefaultValue(s);if(u!=null?c=u:l!=null?c=l:c=n.init_value,K.isArray(n.init_value))if(K.isNumber(c)){let p=new Array(n.init_value.length);p.fill(c),c=p}else K.isArray(c)&&c.length==n.init_value.length&&l!=null&&(c=n.init_value);c!=null&&(t.toAdd=t.toAdd||[],t.toAdd.push({name:s,type:a,initValue:wr.clone(c),rawInput:wr.clone(c),options:{spare:!0,editable:!i}}))}r++}this.node.params.updateParams(t);for(let n of this.node.params.spare)if(!n.parentParam()){let i=this._raw_input_serialized_by_param_name.get(n.name());i&&n.set(i)}}};function i_(o,e){if(o.length!=e.length)return!1;for(let t=0;t<o.length;t++)if(o[t]!=e[t])return!1;return!0}var P8=class{constructor(e,t){this.node=e,this._context=t,this._create_spare_params_from_inputs=!0,this._functions_overridden=!1,this._input_name_function=r=>`in${r}`,this._output_name_function=r=>r==0?"val":`val${r}`,this._expected_input_types_function=()=>{let r=this.first_input_connection_type()||this.default_connection_type();return[r,r]},this._expected_output_types_function=()=>[this._expected_input_types_function()[0]],this._update_signature_if_required_bound=this.update_signature_if_required.bind(this),this._initialized=!1,this._spare_params_controller=new O8(this.node,this._context)}default_connection_type(){return DN[this._context]}create_connection_point(e,t){return n_(this._context,e,t)}functions_overridden(){return this._functions_overridden}initialized(){return this._initialized}set_create_spare_params_from_inputs(e){this._create_spare_params_from_inputs=e}set_input_name_function(e){this._initialize_if_required(),this._input_name_function=e}set_output_name_function(e){this._initialize_if_required(),this._output_name_function=e}set_expected_input_types_function(e){this._initialize_if_required(),this._functions_overridden=!0,this._expected_input_types_function=e}set_expected_output_types_function(e){this._initialize_if_required(),this._functions_overridden=!0,this._expected_output_types_function=e}input_name(e){return this._wrapped_input_name_function(e)}output_name(e){return this._wrapped_output_name_function(e)}initializeNode(){if(this._initialized){console.warn("already initialized",this.node);return}this._initialized=!0,this.node.io.inputs.add_on_set_input_hook("_update_signature_if_required",this._update_signature_if_required_bound),this.node.params.addOnSceneLoadHook("_update_signature_if_required",this._update_signature_if_required_bound),this.node.params.onParamsCreated("_update_signature_if_required_bound",this._update_signature_if_required_bound),this.node.addPostDirtyHook("_update_signature_if_required",this._update_signature_if_required_bound),this._spare_params_controller.initialized()||this._spare_params_controller.initializeNode()}_initialize_if_required(){this._initialized||this.initializeNode()}get spare_params(){return this._spare_params_controller}update_signature_if_required(e){(!this.node.lifecycle.creationCompleted()||!this._inputsOutputsMatchExpectations())&&(this.update_connection_types(),this.node.removeDirtyState(),this.node.scene().loadingController.isLoading()||this.make_successors_update_signatures())}make_successors_update_signatures(){let e=this.node.graphAllSuccessors();if(this.node.childrenAllowed()){let t=this.node.nodesByType(W1.INPUT),r=this.node.nodesByType(W1.OUTPUT);for(let n of t)e.push(n);for(let n of r)e.push(n)}for(let t of e){let r=t;r.io&&r.io.has_connection_points_controller&&r.io.connection_points.initialized()&&r.io.connection_points.update_signature_if_required(this.node)}}update_connection_types(){let t=this._wrapped_expected_input_types_function(),r=this._wrapped_expected_output_types_function(),n=[];for(let s=0;s<t.length;s++){let a=t[s],c=this.create_connection_point(this._wrapped_input_name_function(s),a);n.push(c)}let i=[];for(let s=0;s<r.length;s++){let a=r[s],c=this.create_connection_point(this._wrapped_output_name_function(s),a);i.push(c)}this.node.io.inputs.setNamedInputConnectionPoints(n),this.node.io.outputs.setNamedOutputConnectionPoints(i,!1),this._create_spare_params_from_inputs&&this._spare_params_controller.createSpareParameters()}_inputsOutputsMatchExpectations(){let e=this.node.io.inputs.namedInputConnectionPoints(),t=this.node.io.outputs.namedOutputConnectionPoints(),r=i_(e.map(a=>a==null?void 0:a.type()),this._wrapped_expected_input_types_function()),n=i_(t.map(a=>a==null?void 0:a.type()),this._wrapped_expected_output_types_function()),i=i_(e.map(a=>a==null?void 0:a.name()),e.map((a,c)=>this._wrapped_input_name_function(c))),s=i_(t.map(a=>a==null?void 0:a.name()),t.map((a,c)=>this._wrapped_output_name_function(c)));return r&&n&&i&&s}_wrapped_expected_input_types_function(){if(this.node.scene().loadingController.isLoading()){let e=this.node.io.saved_connection_points_data.in();if(e)return e.map(t=>t.type)}return this._expected_input_types_function()}_wrapped_expected_output_types_function(){if(this.node.scene().loadingController.isLoading()){let e=this.node.io.saved_connection_points_data.out();if(e)return e.map(t=>t.type)}return this._expected_output_types_function()}_wrapped_input_name_function(e){if(this.node.scene().loadingController.isLoading()){let t=this.node.io.saved_connection_points_data.in();if(t)return t[e].name}return this._input_name_function(e)}_wrapped_output_name_function(e){if(this.node.scene().loadingController.isLoading()){let t=this.node.io.saved_connection_points_data.out();if(t)return t[e].name}return this._output_name_function(e)}first_input_connection_type(){return this.input_connection_type(0)}input_connection_type(e){let t=this.node.io.connections.inputConnections();if(t){let r=t[e];if(r)return r.src_connection_point().type()}}};var R8=class{constructor(e){this.node=e,this._connections=new E8(this.node)}dispose(){this.inputs.dispose(),this.outputs.dispose(),this.connections.dispose()}get connections(){return this._connections}get inputs(){return this._inputs=this._inputs||new A8(this.node)}hasInputs(){return this._inputs!=null}get outputs(){return this._outputs=this._outputs||new C8(this.node)}has_outputs(){return this._outputs!=null}get connection_points(){return this._connection_points=this._connection_points||new P8(this.node,this.node.context())}get has_connection_points_controller(){return this._connection_points!=null}get saved_connection_points_data(){return this._saved_connection_points_data=this._saved_connection_points_data||new S8(this.node)}clear_saved_connection_points_data(){this._saved_connection_points_data&&(this._saved_connection_points_data.clear(),this._saved_connection_points_data=void 0)}};var I8=class{constructor(){}};var fr=class extends Kt{constructor(e,t="BaseNode",r){super(e,t);this.createOptions=r,this.containerController=new W5(this),this.pv=new y8,this.p=new I8,this._initialized=!1}copy_param_values(e){let t=this.params.non_spare;for(let r of t){let n=e.params.get(r.name());n&&r.copyValue(n)}}get parentController(){return this._parent_controller=this._parent_controller||new g5(this)}static displayedInputNames(){return[]}childrenControllerContext(){return this._childrenControllerContext}_create_childrenController(){if(this._childrenControllerContext)return new A5(this,this._childrenControllerContext)}get childrenController(){return this._childrenController=this._childrenController||this._create_childrenController()}childrenAllowed(){return this._childrenControllerContext!=null}get uiData(){return this._uiData=this._uiData||new a5(this)}get states(){return this._states=this._states||new _5(this)}get lifecycle(){return this._lifecycle=this._lifecycle||new C5(this)}get serializer(){return this._serializer=this._serializer||new _h(this)}get cookController(){return this._cookController=this._cookController||new X5(this)}get io(){return this._io=this._io||new R8(this)}get nameController(){return this._nameController=this._nameController||new lh(this)}setName(e){this.nameController.setName(e)}_setCoreName(e){this._name=e}get params(){return this._paramsController=this._paramsController||new v8(this)}initializeBaseAndNode(){var e;this._initialized?console.warn("node already initialized"):(this._initialized=!0,(e=this.displayNodeController)==null||e.initializeNode(),this.initializeBaseNode(),this.initializeNode(),this.polyNodeController&&this.polyNodeController.initializeNode())}initializeBaseNode(){}initializeNode(){}static type(){throw"type to be overriden"}type(){return this.constructor.type()}static context(){throw console.error("node has no node_context",this),"context requires override"}context(){return this.constructor.context()}static require_webgl2(){return!1}require_webgl2(){return this.constructor.require_webgl2()}setParent(e){this.parentController.setParent(e)}parent(){return this.parentController.parent()}firstAncestorWithContext(e){return this.parentController.firstAncestorWithContext(e)}root(){return this._scene.root()}path(e){return this.parentController.path(e)}createParams(){}addParam(e,t,r,n){var i;return(i=this._paramsController)==null?void 0:i.addParam(e,t,r,n)}paramDefaultValue(e){return null}cook(e){return null}onCookEnd(e,t){this.cookController.registerOnCookEnd(e,t)}async compute(){var e,t;return this.isDirty()||((t=(e=this.flags)==null?void 0:e.bypass)==null?void 0:t.active())?await this.containerController.compute():this.containerController.container()}_setContainer(e,t=null){this.containerController.container().set_content(e),e!=null&&(e.name||(e.name=this.path()),e.node||(e.node=this)),this.cookController.endCook(t)}createNode(e,t){var r;return(r=this.childrenController)==null?void 0:r.createNode(e,t)}createOperationContainer(e,t,r){var n;return(n=this.childrenController)==null?void 0:n.createOperationContainer(e,t,r)}removeNode(e){var t;(t=this.childrenController)==null||t.removeNode(e)}dispose(){super.dispose(),this.setParent(null),this._nameController&&(this._nameController.dispose(),this._nameController=void 0),this._io&&(this._io.dispose(),this._io=void 0),this._lifecycle&&(this._lifecycle.dispose(),this._lifecycle=void 0),this.displayNodeController&&this.displayNodeController.dispose(),this._childrenController&&(this._childrenController.dispose(),this._childrenController=void 0),this._paramsController&&(this._paramsController.dispose(),this._paramsController=void 0),this._cookController&&(this._cookController.dispose(),this._cookController=void 0),this._serializer&&(this._serializer.dispose(),this._serializer=void 0),this._uiData&&(this._uiData.dispose(),this._uiData=void 0)}children(){var e;return((e=this.childrenController)==null?void 0:e.children())||[]}node(e){var t;return((t=this.parentController)==null?void 0:t.findNode(e))||null}nodeSibling(e){var t;let r=this.parent();if(r){let n=(t=r.childrenController)==null?void 0:t.childByName(e);if(n)return n}return null}nodesByType(e){var t;return((t=this.childrenController)==null?void 0:t.nodesByType(e))||[]}setInput(e,t,r=0){this.io.inputs.setInput(e,t,r)}emit(e,t=null){this.scene().dispatchController.dispatch(this,e,t)}toJSON(e=!1){return this.serializer.toJSON(e)}async requiredModules(){}usedAssembler(){}integrationData(){}};var L8=class extends fr{static context(){return oe.MANAGER}};var gn=class{constructor(e,t,r){this.type=e,this.init_value=t,this.options=r}},y=class{static BUTTON(e,t){return new gn(J.BUTTON,e,t)}static BOOLEAN(e,t){return new gn(J.BOOLEAN,e,t)}static COLOR(e,t){return e instanceof de&&(e=e.toArray()),new gn(J.COLOR,e,t)}static FLOAT(e,t){return new gn(J.FLOAT,e,t)}static FOLDER(e=null,t){return new gn(J.FOLDER,e,t)}static INTEGER(e,t){return new gn(J.INTEGER,e,t)}static RAMP(e=Os.DEFAULT_VALUE,t){return new gn(J.RAMP,e,t)}static STRING(e="",t){return new gn(J.STRING,e,t)}static VECTOR2(e,t){return e instanceof z&&(e=e.toArray()),new gn(J.VECTOR2,e,t)}static VECTOR3(e,t){return e instanceof M&&(e=e.toArray()),new gn(J.VECTOR3,e,t)}static VECTOR4(e,t){return e instanceof De&&(e=e.toArray()),new gn(J.VECTOR4,e,t)}static NODE_PATH(e,t){return new gn(J.NODE_PATH,e,t)}static PARAM_PATH(e,t){return new gn(J.PARAM_PATH,e,t)}},U=class{};var BN="/",D8=class{constructor(e){this.scene=e}findObjectByMask(e){return this.findObjectByMaskInObject(e,this.scene.threejsScene())}findObjectByMaskInObject(e,t,r=""){for(let n of t.children){let i=this._removeTrailingOrHeadingSlash(n.name);r=this._removeTrailingOrHeadingSlash(r);let s=`${r}/${i}`;if(Ve.matchMask(s,e))return n;let a=this.findObjectByMaskInObject(e,n,s);if(a)return a}}objectsByMask(e){let t=[];return this.traverseObjectsWithMask(e,r=>{t.push(r)}),t}objectsByMaskInObject(e,t,r=[],n=""){return this.traverseObjectsWithMask(e,i=>{r.push(i)}),r}traverseObjectsWithMask(e,t,r=!1){this.traverseObjectsWithMaskInObject(e,this.scene.threejsScene(),t,r)}traverseObjectsWithMaskInObject(e,t,r,n,i=""){for(let s of t.children){let a=this._removeTrailingOrHeadingSlash(s.name);i=this._removeTrailingOrHeadingSlash(i);let c=`${i}/${a}`,l=Ve.matchMask(c,e);n&&(l=!l),l&&r(s),this.traverseObjectsWithMaskInObject(e,s,r,n,c)}}_removeTrailingOrHeadingSlash(e){return e[0]=="/"&&(e=e.substring(1)),e[e.length-1]=="/"&&(e=e.substring(0,e.length-1)),e}};var FN={computeOnDirty:!1,callback:o=>{s_.update(o)}};function UN(o){return class extends o{constructor(){super(...arguments);this.displayAudioIcon=y.BOOLEAN(0,{...FN,separatorBefore:!0}),this.audioIconColor=y.COLOR([0,0,0],{...FN,visibleIf:{displayAudioIcon:1}})}}}var s_=class{constructor(e){this.node=e,this._callbacksByName=new Map}async toggleSound(){this.audioListeners().forEach(e=>{e.toggleSound()}),this.update(),this._runOnToggleSoundCallbacks()}soundOn(){let e=this.audioListeners()[0];return e&&e.pv.soundOn||!1}update(){this._updateViewers()}audioListeners(){return this.node.nodesByType("audioListener")}_updateViewers(){this.node.scene().viewersRegister.traverseViewers(e=>{e.audioController().update()})}static update(e){e.audioController.update()}onToggleSound(e,t){if(this._callbacksByName.get(e)){console.warn(`callback already registered ith name '${e}'`);return}this._callbacksByName.set(e,t)}_runOnToggleSoundCallbacks(){let e=this.soundOn();this._callbacksByName.forEach(t=>{t(e)})}};var DJ={computeOnDirty:!1,callback:o=>{zu.update(o)}};function a_(o){return class extends o{constructor(){super(...arguments);this.autoUpdate=y.BOOLEAN(1,{...DJ,separatorBefore:!0})}}}var zu=class{constructor(e){this.node=e}async update(){let e=this.node.object,t=this.node.pv;t.autoUpdate!=e.autoUpdate&&(e.autoUpdate=t.autoUpdate)}static async update(e){e.sceneAutoUpdateController.update()}};var Hu=["none","color","texture"],k8={callback:o=>{ju.update(o)}};function c_(o){return class extends o{constructor(){super(...arguments);this.backgroundMode=y.INTEGER(Hu.indexOf("color"),{menu:{entries:Hu.map((t,r)=>({name:t,value:r}))},...k8,separatorBefore:!0}),this.bgColor=y.COLOR([.09,.09,.09],{visibleIf:{backgroundMode:Hu.indexOf("color")},...k8,conversion:ko.SRGB_TO_LINEAR}),this.bgTexture=y.NODE_PATH("",{visibleIf:{backgroundMode:Hu.indexOf("texture")},nodeSelection:{context:oe.COP},dependentOnFoundNode:!1,...k8})}}}var ju=class{constructor(e){this.node=e}setMode(e){this.node.p.backgroundMode.set(Hu.indexOf(e))}backgroundMode(){return Hu[this.node.pv.backgroundMode]}async update(){let e=this.backgroundMode();switch(e){case"none":return this._setBackgroundNone();case"color":return await this._setBackgroundColor();case"texture":return await this._setBackgroundTexture()}Be.unreachable(e)}_setBackgroundNone(){let e=this.node.object;e.background=null}async _setBackgroundColor(){let e=this.node.object,t=this.node.pv;await this.node.p.bgColor.compute(),e.background&&e.background instanceof de?e.background.copy(t.bgColor):e.background=t.bgColor}async _setBackgroundTexture(){let e=this.node.object,r=this.node.pv.bgTexture.nodeWithContext(oe.COP);if(r){let n=await r.compute();e.background=n.texture()}else this.node.states.error.set("bgTexture node not found")}static update(e){e.sceneBackgroundController.update()}};var VN={computeOnDirty:!1,callback:o=>{Wu.update(o)}};function l_(o){return class extends o{constructor(){super(...arguments);this.useEnvironment=y.BOOLEAN(0,{...VN,separatorBefore:!0}),this.environment=y.NODE_PATH("",{visibleIf:{useEnvironment:1},nodeSelection:{context:oe.COP},dependentOnFoundNode:!1,...VN})}}}var Wu=class{constructor(e){this.node=e}async update(){let e=this.node.object,t=this.node.pv;if(t.useEnvironment){let r=t.environment.nodeWithContext(oe.COP);r?r.compute().then(n=>{e.environment=n.texture()}):this.node.states.error.set("bgTexture node not found")}else e.environment=null}static async update(e){e.sceneEnvController.update()}};var ca=class{constructor(e,t=1,r=1e3){this.name="",this.color=new de(e),this.near=t,this.far=r}clone(){return new ca(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}};ca.prototype.isFog=!0;var la=class{constructor(e,t=25e-5){this.name="",this.color=new de(e),this.density=t}clone(){return new la(this.color,this.density)}toJSON(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}};la.prototype.isFogExp2=!0;var qu={computeOnDirty:!1,callback:o=>{Yu.update(o)}};var Xu=["linear","exponential"];function wh(o){return class extends o{constructor(){super(...arguments);this.useFog=y.BOOLEAN(0,{...qu,separatorBefore:!0}),this.fogType=y.INTEGER(Xu.indexOf("exponential"),{visibleIf:{useFog:1},menu:{entries:Xu.map((t,r)=>({name:t,value:r}))},...qu}),this.fogColor=y.COLOR([1,1,1],{visibleIf:{useFog:1},...qu}),this.fogNear=y.FLOAT(1,{range:[0,100],rangeLocked:[!0,!1],visibleIf:{useFog:1,fogType:Xu.indexOf("linear")},...qu}),this.fogFar=y.FLOAT(100,{range:[0,100],rangeLocked:[!0,!1],visibleIf:{useFog:1,fogType:Xu.indexOf("linear")},...qu}),this.fogDensity=y.FLOAT(25e-5,{visibleIf:{useFog:1,fogType:Xu.indexOf("exponential")},...qu})}}}var kJ=class extends wh(U){},Yu=class{constructor(e){this.node=e}async update(){let e=this.node.object,t=this.node.pv;if(t.useFog)if(t.fogType==Xu.indexOf("linear")){let r=this.fog2(t);e.fog=r,r.color=t.fogColor,r.near=t.fogNear,r.far=t.fogFar}else{let r=this.fogExp2(t);e.fog=this.fogExp2(t),r.color=t.fogColor,r.density=t.fogDensity}else e.fog&&(e.fog=null)}fog2(e){return this._fog=this._fog||new ca(16777215,e.fogNear,e.fogFar)}fogExp2(e){return this._fogExp2=this._fogExp2||new la(16777215,e.fogDensity)}static async update(e){e.sceneFogController.update()}};function GN(o){return class extends o{constructor(){super(...arguments);this.nodesMask=y.STRING("*/file* */image* */envMap*",{cook:!1,separatorBefore:!0}),this.printNodes=y.BUTTON(null,{cook:!1,callback:t=>{u_.PARAM_CALLBACK_printResolve(t)}})}}}var u_=class{constructor(e){this.node=e}static async PARAM_CALLBACK_printResolve(e){let t=await e.loadProgress.resolvedNodes();console.log(t);let r=t.map(n=>n.path()).sort();console.log(r)}async resolvedNodes(){let e=this.node.p.nodesMask;e.isDirty()&&await e.compute();let t=e.value;return this.node.scene().nodesController.nodesFromMask(t||"")}};var zN={computeOnDirty:!1,callback:o=>{$u.update(o)}};function p_(o){return class extends o{constructor(){super(...arguments);this.useOverrideMaterial=y.BOOLEAN(0,{...zN,separatorBefore:!0}),this.overrideMaterial=y.NODE_PATH("",{visibleIf:{useOverrideMaterial:1},nodeSelection:{context:oe.MAT},dependentOnFoundNode:!1,...zN})}}}var $u=class{constructor(e){this.node=e}async update(){let e=this.node.object,t=this.node.pv;if(t.useOverrideMaterial){let r=t.overrideMaterial.nodeWithContext(oe.MAT);if(r){let n=await r.compute();e.overrideMaterial=n.material()}else e.overrideMaterial=null,this.node.states.error.set("overrideMaterial node not found")}else e.overrideMaterial=null}static async update(e){e.sceneMaterialOverrideController.update()}};var HN="RootNode",jN=class extends GN(UN(p_(l_(wh(c_(a_(U))))))){},BJ=new jN,B8=class extends L8{constructor(){super(...arguments);this.paramsConfig=BJ,this._object=this._createScene(),this._queued_nodes_by_id=new Map,this.audioController=new s_(this),this.sceneAutoUpdateController=new zu(this),this.sceneBackgroundController=new ju(this),this.sceneEnvController=new Wu(this),this.sceneFogController=new Yu(this),this.loadProgress=new u_(this),this.sceneMaterialOverrideController=new $u(this),this._childrenControllerContext=oe.OBJ}static type(){return"root"}cook(){this.cookController.endCook()}initializeNode(){this._object.matrixAutoUpdate=!1,this.lifecycle.onChildAdd(this._on_child_add.bind(this)),this.lifecycle.onChildRemove(this._on_child_remove.bind(this))}_createScene(){let e=new ii;return e.name=BN,e.matrixAutoUpdate=!1,e}get object(){return this._object}createNode(e,t){return super.createNode(e,t)}children(){return super.children()}nodesByType(e){return super.nodesByType(e)}_updateScene(){this.sceneAutoUpdateController.update(),this.sceneBackgroundController.update(),this.sceneEnvController.update(),this.sceneFogController.update(),this.sceneMaterialOverrideController.update()}_addToQueue(e){let t=e.graphNodeId();return this._queued_nodes_by_id.has(t)||this._queued_nodes_by_id.set(t,e),e}async processQueue(){this._updateScene();let e=new Map,t=[];this._queued_nodes_by_id.forEach((r,n)=>{let i=`_____${r.renderOrder}__${r.path()}`;t.push(i),e.set(i,r)}),this._queued_nodes_by_id.clear();for(let r of t){let n=e.get(r);n&&(e.delete(r),this._addToScene(n))}}_update_object(e){return this.scene().loadingController.autoUpdating()?(e.isDisplayed()&&!e.cookController.isCooking()&&e.compute(),this._addToScene(e)):this._addToQueue(e)}getParentForNode(e){if(e.attachableToHierarchy()){let t=e.io.inputs.input(0);return t?t.childrenGroup():this._object}else return null}_addToScene(e){var t;if(e.attachableToHierarchy()){let r=this.getParentForNode(e);r&&(e.usedInScene()?((t=e.childrenDisplayController)==null||t.request_display_node_container(),e.addObjectToParent(r)):e.removeObjectFromParent())}}_removeFromScene(e){e.removeObjectFromParent()}areChildrenCooking(){let e=this.children();for(let t of e)if(t.cookController.isCooking()||t.isDisplayNodeCooking())return!0;return!1}addToParentTransform(e){this._update_object(e)}removeFromParentTransform(e){this._update_object(e)}_on_child_add(e){e&&this._update_object(e)}_on_child_remove(e){e&&this._removeFromScene(e)}};var F8=class{constructor(e){this.scene=e,this._node_context_signatures={},this._instanciated_nodes_by_context_and_type={}}init(){this._root=new B8(this.scene,HN),this._root.initializeBaseAndNode(),this._root.params.init()}root(){return this._root}_traverseNode(e,t){let r=e.children();if(!(!r||r.length==0))for(let n of r)t(n),n.childrenController&&this._traverseNode(n,t)}clear(){var e;let t=this.root().children();for(let r of t)(e=this.root().childrenController)==null||e.removeNode(r)}node(e){return e==="/"?this.root():this.root().node(e)}allNodes(){let e=[this.root()],t=[this.root()],r=0;for(;t.length>0&&r<10;){let n=t.map(i=>i.childrenAllowed()?i.children():[]).flat();e=e.concat(n),t=n,r+=1}return e.flat()}nodesFromMask(e){let t=this.allNodes(),r=[];for(let n of t){let i=n.path();Ve.matchMask(i,e)&&r.push(n)}return r}reset_node_context_signatures(){this._node_context_signatures={}}register_node_context_signature(e){e.childrenAllowed()&&e.childrenController&&(this._node_context_signatures[e.childrenController.node_context_signature()]=!0)}node_context_signatures(){return Object.keys(this._node_context_signatures).sort().map(e=>e.toLowerCase())}addToInstanciatedNode(e){let t=e.context(),r=e.type();this._instanciated_nodes_by_context_and_type[t]=this._instanciated_nodes_by_context_and_type[t]||{},this._instanciated_nodes_by_context_and_type[t][r]=this._instanciated_nodes_by_context_and_type[t][r]||{},this._instanciated_nodes_by_context_and_type[t][r][e.graphNodeId()]=e}removeFromInstanciatedNode(e){let t=e.context(),r=e.type();delete this._instanciated_nodes_by_context_and_type[t][r][e.graphNodeId()]}nodesByType(e){let t=[];return this._traverseNode(this.scene.root(),r=>{r.type()==e&&t.push(r)}),t}nodesByContextAndType(e,t){let r=[],n=this._instanciated_nodes_by_context_and_type[e];if(n){let i=n[t];if(i)for(let s of Object.keys(i))r.push(i[s])}return r}};var U8=class{constructor(e){this.scene=e}toJSON(e=!1){let t={},r={};for(let n of this.scene.nodesController.allNodes()){let i=new _h(n);t[n.graphNodeId()]=i.toJSON(e);let s=n.params.all;for(let a of s)r[a.graphNodeId()]=a.toJSON()}return{nodes_by_graph_node_id:t,params_by_graph_node_id:r}}};var kn=class{constructor(e){this.dispatcher=e,this._nodesByGraphNodeId=new Map,this._requireCanvasEventListeners=!1,this._activeEventDatas=[],this._activeEventDataTypes=new Set}registerNode(e){this._nodesByGraphNodeId.set(e.graphNodeId(),e),this.updateViewerEventListeners()}unregisterNode(e){this._nodesByGraphNodeId.delete(e.graphNodeId()),this.updateViewerEventListeners()}processEvent(e){var t;if(this._activeEventDatas.length==0)return;let r=(t=e.event)==null?void 0:t.type;r&&!this._activeEventDataTypes.has(r)||this._nodesByGraphNodeId.forEach(n=>{n.processEvent(e)})}updateViewerEventListeners(){this._updateActiveEventTypes(),this._requireCanvasEventListeners&&this.dispatcher.scene.viewersRegister.traverseViewers(e=>{e.eventsController().updateEvents(this)})}activeEventDatas(){return this._activeEventDatas}_updateActiveEventTypes(){let e=new Map;this._activeEventDataTypes.clear(),this._nodesByGraphNodeId.forEach(t=>{if(t.parent()){let r=t.activeEventDatas();for(let n of r)e.set(n,!0)}}),this._activeEventDatas=[],e.forEach((t,r)=>{this._activeEventDatas.push(r),this._activeEventDataTypes.add(r.type)})}};var d_=["auxclick","click","contextmenu","dblclick","mousedown","mouseenter","mouseleave","mousemove","mouseover","mouseout","mouseup","pointerlockchange","pointerlockerror","select","wheel"],V8=class extends kn{constructor(){super(...arguments);this._requireCanvasEventListeners=!0}type(){return"mouse"}acceptedEventTypes(){return new Set(d_.map(e=>`${e}`))}};var Lr=class extends fr{constructor(){super(...arguments);this._cook_without_inputs_bound=this._cook_without_inputs.bind(this)}static context(){return oe.EVENT}initializeBaseNode(){this.uiData.setLayoutHorizontal(),this.addPostDirtyHook("cook_without_inputs_on_dirty",this._cook_without_inputs_bound),this.io.inputs.set_depends_on_inputs(!1),this.io.connections.initInputs(),this.io.connection_points.spare_params.initializeNode()}_cook_without_inputs(){this.cookController.cookMainWithoutInputs()}cook(){this.cookController.endCook()}processEventViaConnectionPoint(e,t){t.event_listener?t.event_listener(e):this.processEvent(e)}processEvent(e){}async dispatchEventToOutput(e,t){this.run_on_dispatch_hook(e,t);let r=this.io.outputs.getOutputIndex(e);if(r>=0){let i=this.io.connections.outputConnections().filter(a=>a.output_index==r),s;for(let a of i){s=a.node_dest;let c=s.io.inputs.namedInputConnectionPoints()[a.input_index];s.processEventViaConnectionPoint(t,c)}}else console.warn(`requested output '${e}' does not exist on node '${this.path()}'`)}onDispatch(e,t){this._on_dispatch_hooks_by_output_name=this._on_dispatch_hooks_by_output_name||new Map,Vt.pushOnArrayAtEntry(this._on_dispatch_hooks_by_output_name,e,t)}run_on_dispatch_hook(e,t){if(this._on_dispatch_hooks_by_output_name){let r=this._on_dispatch_hooks_by_output_name.get(e);if(r)for(let n of r)n(t)}}};var Ku=["keydown","keypress","keyup"],G8=class extends kn{constructor(){super(...arguments);this._requireCanvasEventListeners=!0}type(){return"keyboard"}acceptedEventTypes(){return new Set(Ku.map(e=>`${e}`))}};var Ui=(o=>(o.CANVAS="canvas",o.DOCUMENT="document",o))(Ui||{}),$r=["canvas","document"];function FJ(o,e){return o=="canvas"?e:document}var z8=class{constructor(e){this.viewer=e,this._bound_listener_map_by_event_controller_type=new Map}updateEvents(e){let t=this.canvas();if(!t){console.warn("no canvas found");return}let r=e.type(),n=this._bound_listener_map_by_event_controller_type.get(r);n||(n=new Map,this._bound_listener_map_by_event_controller_type.set(r,n)),n.forEach((s,a)=>{for(let c of $r)this._eventOwner({emitter:c,type:a},t).removeEventListener(a,s.listener)}),n.clear();let i=s=>{this.processEvent(s,e,t)};for(let s of e.activeEventDatas()){let a=this._eventOwner(s,t);a.addEventListener(s.type,i),a!=document&&Ku.includes(s.type)&&a.setAttribute("tabindex","0"),n.set(s.type,{listener:i,data:s})}}_eventOwner(e,t){return e.type=="resize"?window:FJ(e.emitter,t)}cameraNode(){return this.viewer.camerasController().cameraNode()}canvas(){return this.viewer.canvas()}init(){if(!this.canvas()){console.warn("no canvas found for eventsController");return}this.viewer.scene().eventsDispatcher.traverseControllers(e=>{this.updateEvents(e)})}registeredEventTypes(){let e=[];return this._bound_listener_map_by_event_controller_type.forEach(t=>{t.forEach((r,n)=>{e.push(n)})}),e}dispose(){let e=this.canvas();this._bound_listener_map_by_event_controller_type.forEach(t=>{e&&t.forEach((r,n)=>{this._eventOwner(r.data,e).removeEventListener(n,r.listener)})})}processEvent(e,t,r){let n={viewer:this.viewer,event:e,cameraNode:this.cameraNode()};t.processEvent(n)}};var Je={visibleIf:{active:1},callback:o=>{WN.PARAM_CALLBACK_updateRegister(o)}},vn=class extends Lr{constructor(){super(...arguments);this._activeEventDatas=[]}initializeBaseNode(){super.initializeBaseNode();let e=()=>{this.scene().eventsDispatcher.registerEventNode(this)},t=()=>{this.scene().eventsDispatcher.unregisterEventNode(this)};this.lifecycle.onAfterAdded(e),this.lifecycle.onBeforeDeleted(t),this.params.onParamsCreated("update_register",()=>{this._updateRegister()})}processEvent(e){!this.pv.active||!e.event||this.dispatchEventToOutput(e.event.type,e)}static PARAM_CALLBACK_updateRegister(e){e._updateRegister()}_updateRegister(){this._updateActiveEventDatas(),this.scene().eventsDispatcher.updateViewerEventListeners(this)}_updateActiveEventDatas(){this._activeEventDatas=[],this.pv.active&&this.acceptedEventTypes().forEach(t=>{let r=this.params.get(t);r&&r.value&&this._activeEventDatas.push({type:t,emitter:$r[this.pv.element]})})}activeEventDatas(){return this._activeEventDatas}};var WN=class extends vn{acceptedEventTypes(){return new Set}};var qN=class extends U{constructor(){super(...arguments);this.active=y.BOOLEAN(!0,{callback:e=>{h_.PARAM_CALLBACK_updateRegister(e)},separatorAfter:!0}),this.element=y.INTEGER($r.indexOf(Ui.CANVAS),{menu:{entries:$r.map((e,t)=>({name:e,value:t}))},separatorAfter:!0}),this.auxclick=y.BOOLEAN(0,Je),this.click=y.BOOLEAN(0,Je),this.contextmenu=y.BOOLEAN(0,Je),this.dblclick=y.BOOLEAN(0,Je),this.mousedown=y.BOOLEAN(1,Je),this.mouseenter=y.BOOLEAN(0,Je),this.mouseleave=y.BOOLEAN(0,Je),this.mousemove=y.BOOLEAN(1,Je),this.mouseover=y.BOOLEAN(0,Je),this.mouseout=y.BOOLEAN(0,Je),this.mouseup=y.BOOLEAN(1,Je),this.pointerlockchange=y.BOOLEAN(0,Je),this.pointerlockerror=y.BOOLEAN(0,Je),this.select=y.BOOLEAN(0,Je),this.wheel=y.BOOLEAN(0,Je),this.ctrlKey=y.BOOLEAN(0,{...Je,separatorBefore:!0}),this.altKey=y.BOOLEAN(0,Je),this.shiftKey=y.BOOLEAN(0,Je),this.metaKey=y.BOOLEAN(0,Je)}},UJ=new qN,h_=class extends vn{constructor(){super(...arguments);this.paramsConfig=UJ}static type(){return"mouse"}acceptedEventTypes(){return new Set(d_.map(e=>`${e}`))}initializeNode(){this.io.outputs.setNamedOutputConnectionPoints(d_.map(e=>new qe(e,We.MOUSE)))}processEvent(e){if(!this.pv.active||!e.event)return;let t=e.event;t.ctrlKey==this.pv.ctrlKey&&t.shiftKey==this.pv.shiftKey&&t.altKey==this.pv.altKey&&t.metaKey==this.pv.metaKey&&this.dispatchEventToOutput(e.event.type,e)}};var f_=["pointerdown","pointermove","pointerup"],H8=class extends kn{constructor(){super(...arguments);this._requireCanvasEventListeners=!0}type(){return"pointer"}acceptedEventTypes(){return new Set(f_.map(e=>`${e}`))}};var XN=class extends U{constructor(){super(...arguments);this.active=y.BOOLEAN(!0,{callback:e=>{Ju.PARAM_CALLBACK_updateRegister(e)},separatorAfter:!0}),this.element=y.INTEGER($r.indexOf(Ui.CANVAS),{menu:{entries:$r.map((e,t)=>({name:e,value:t}))},separatorAfter:!0}),this.pointerdown=y.BOOLEAN(1,Je),this.pointermove=y.BOOLEAN(0,Je),this.pointerup=y.BOOLEAN(0,Je),this.ctrlKey=y.BOOLEAN(0,{...Je,separatorBefore:!0}),this.altKey=y.BOOLEAN(0,Je),this.shiftKey=y.BOOLEAN(0,Je),this.metaKey=y.BOOLEAN(0,Je)}},VJ=new XN,Ju=class extends vn{constructor(){super(...arguments);this.paramsConfig=VJ}static type(){return"pointer"}acceptedEventTypes(){return new Set(f_.map(e=>`${e}`))}initializeNode(){this.io.outputs.setNamedOutputConnectionPoints(f_.map(e=>new qe(e,We.POINTER)))}processEvent(e){if(!this.pv.active||!e.event)return;let t=e.event;t.ctrlKey==this.pv.ctrlKey&&t.shiftKey==this.pv.shiftKey&&t.altKey==this.pv.altKey&&t.metaKey==this.pv.metaKey&&this.dispatchEventToOutput(e.event.type,e)}};var YN=class extends U{constructor(){super(...arguments);this.active=y.BOOLEAN(!0,{callback:(e,t)=>{m_.PARAM_CALLBACK_updateRegister(e)},separatorAfter:!0}),this.element=y.INTEGER($r.indexOf(Ui.CANVAS),{menu:{entries:$r.map((e,t)=>({name:e,value:t}))},separatorAfter:!0,...Je}),this.keydown=y.BOOLEAN(1,Je),this.keypress=y.BOOLEAN(0,Je),this.keyup=y.BOOLEAN(0,Je),this.keyCodes=y.STRING("Digit1 KeyE ArrowDown",Je),this.ctrlKey=y.BOOLEAN(0,Je),this.altKey=y.BOOLEAN(0,Je),this.shiftKey=y.BOOLEAN(0,Je),this.metaKey=y.BOOLEAN(0,Je)}},GJ=new YN,m_=class extends vn{constructor(){super(...arguments);this.paramsConfig=GJ}static type(){return"keyboard"}acceptedEventTypes(){return new Set(Ku.map(e=>`${e}`))}initializeNode(){this.io.outputs.setNamedOutputConnectionPoints(Ku.map(e=>new qe(e,We.KEYBOARD)))}setElement(e){this.p.element.set($r.indexOf(e))}processEvent(e){if(!this.pv.active||!e.event)return;let t=e.event;t.ctrlKey==this.pv.ctrlKey&&t.shiftKey==this.pv.shiftKey&&t.altKey==this.pv.altKey&&t.metaKey==this.pv.metaKey&&(!Ve.matchMask(t.code,this.pv.keyCodes)||this.dispatchEventToOutput(e.event.type,e))}};var __=["resize"],j8=class extends kn{constructor(){super(...arguments);this._requireCanvasEventListeners=!0}type(){return"window"}acceptedEventTypes(){return new Set(__.map(e=>`${e}`))}};var $N=class extends U{constructor(){super(...arguments);this.active=y.BOOLEAN(!0,{callback:e=>{g_.PARAM_CALLBACK_updateRegister(e)},separatorAfter:!0}),this.element=y.INTEGER(0,{hidden:!0}),this.resize=y.BOOLEAN(1,Je)}},zJ=new $N,g_=class extends vn{constructor(){super(...arguments);this.paramsConfig=zJ}static type(){return"window"}acceptedEventTypes(){return new Set(__.map(e=>`${e}`))}initializeNode(){this.io.outputs.setNamedOutputConnectionPoints(__.map(e=>new qe(e,We.POINTER)))}processEvent(e){!this.pv.active||!e.event||this.dispatchEventToOutput(e.event.type,e)}};var v_=["dragover"],W8=class extends kn{constructor(){super(...arguments);this._requireCanvasEventListeners=!0}type(){return"drag"}acceptedEventTypes(){return new Set(v_.map(e=>`${e}`))}};var y_=["touchstart","touchmove","touchend"],q8=class extends kn{constructor(){super(...arguments);this._requireCanvasEventListeners=!0}type(){return"touch"}acceptedEventTypes(){return new Set(y_.map(e=>`${e}`))}};var KN=class extends U{constructor(){super(...arguments);this.active=y.BOOLEAN(!0,{callback:e=>{x_.PARAM_CALLBACK_updateRegister(e)},separatorAfter:!0}),this.element=y.INTEGER($r.indexOf(Ui.CANVAS),{menu:{entries:$r.map((e,t)=>({name:e,value:t}))},separatorAfter:!0}),this.dragover=y.BOOLEAN(1,Je),this.ctrlKey=y.BOOLEAN(0,{...Je,separatorBefore:!0}),this.altKey=y.BOOLEAN(0,Je),this.shiftKey=y.BOOLEAN(0,Je),this.metaKey=y.BOOLEAN(0,Je)}},HJ=new KN,x_=class extends vn{constructor(){super(...arguments);this.paramsConfig=HJ}static type(){return"drag"}acceptedEventTypes(){return new Set(v_.map(e=>`${e}`))}initializeNode(){this.io.outputs.setNamedOutputConnectionPoints(v_.map(e=>new qe(e,We.DRAG)))}processEvent(e){if(!this.pv.active||!e.event)return;let t=e.event;t.ctrlKey==this.pv.ctrlKey&&t.shiftKey==this.pv.shiftKey&&t.altKey==this.pv.altKey&&t.metaKey==this.pv.metaKey&&this.dispatchEventToOutput(e.event.type,e)}};var JN=class extends U{constructor(){super(...arguments);this.active=y.BOOLEAN(!0,{callback:e=>{b_.PARAM_CALLBACK_updateRegister(e)},separatorAfter:!0}),this.element=y.INTEGER($r.indexOf(Ui.CANVAS),{menu:{entries:$r.map((e,t)=>({name:e,value:t}))},separatorAfter:!0}),this.touchstart=y.BOOLEAN(1,Je),this.touchmove=y.BOOLEAN(0,Je),this.touchend=y.BOOLEAN(0,Je)}},jJ=new JN,b_=class extends vn{constructor(){super(...arguments);this.paramsConfig=jJ}static type(){return"touch"}acceptedEventTypes(){return new Set(y_.map(e=>`${e}`))}initializeNode(){this.io.outputs.setNamedOutputConnectionPoints(y_.map(e=>new qe(e,We.DRAG)))}processEvent(e){!this.pv.active||!e.event||this.dispatchEventToOutput(e.event.type,e)}};var X8=class{constructor(e){this.scene=e,this.sceneEventsController=new C4,this._controllers=[]}registerEventNode(e){let t=this._findOrCreateControllerForNode(e);t&&t.registerNode(e)}unregisterEventNode(e){let t=this._findOrCreateControllerForNode(e);t&&t.unregisterNode(e)}updateViewerEventListeners(e){let t=this._findOrCreateControllerForNode(e);t&&t.updateViewerEventListeners()}traverseControllers(e){for(let t of this._controllers)e(t)}_findOrCreateControllerForNode(e){switch(e.type()){case m_.type():return this.keyboardEventsController;case h_.type():return this.mouseEventsController;case x_.type():return this.dragEventsController;case Ju.type():return this.pointerEventsController;case b_.type():return this.touchEventsController;case g_.type():return this.windowEventsController}}get keyboardEventsController(){return this._keyboardEventsController=this._keyboardEventsController||this._createController(G8)}get mouseEventsController(){return this._mouseEventsController=this._mouseEventsController||this._createController(V8)}get dragEventsController(){return this._dragEventsController=this._dragEventsController||this._createController(W8)}get pointerEventsController(){return this._pointerEventsController=this._pointerEventsController||this._createController(H8)}get windowEventsController(){return this._windowEventsController=this._windowEventsController||this._createController(j8)}get touchEventsController(){return this._touchEventsController=this._touchEventsController||this._createController(q8)}_createController(e){let t=new e(this);return this._controllers.includes(t)||this._controllers.push(t),t}};var Y8=class{constructor(e){this.scene=e,this._referenced_nodes_by_src_param_id=new Map,this._referencing_params_by_referenced_node_id=new Map,this._referencing_params_by_all_named_node_ids=new Map}setReferenceFromParam(e,t){this._referenced_nodes_by_src_param_id.set(e.graphNodeId(),t),Vt.pushOnArrayAtEntry(this._referencing_params_by_referenced_node_id,t.graphNodeId(),e)}setNamedNodesFromParam(e){let t=e.decomposed_path.named_nodes();for(let r of t)Vt.pushOnArrayAtEntry(this._referencing_params_by_all_named_node_ids,r.graphNodeId(),e)}resetReferenceFromParam(e){let t=this._referenced_nodes_by_src_param_id.get(e.graphNodeId());if(t){Vt.popFromArrayAtEntry(this._referencing_params_by_referenced_node_id,t.graphNodeId(),e);let r=e.decomposed_path.named_nodes();for(let n of r)Vt.popFromArrayAtEntry(this._referencing_params_by_all_named_node_ids,n.graphNodeId(),e);this._referenced_nodes_by_src_param_id.delete(e.graphNodeId())}}referencing_params(e){return this._referencing_params_by_referenced_node_id.get(e.graphNodeId())}referencing_nodes(e){let t=this._referencing_params_by_referenced_node_id.get(e.graphNodeId());if(t){let r=new Map;for(let i of t){let s=i.node;r.set(s.graphNodeId(),s)}let n=[];return r.forEach(i=>{n.push(i)}),n}}nodes_referenced_by(e){let t=new Set([J.NODE_PATH]),r=[];for(let a of e.params.all)t.has(a.type())&&r.push(a);let n=new Map,i=[];for(let a of r)this._check_param(a,n,i);for(let a of i)n.set(a.node.graphNodeId(),a.node);let s=[];return n.forEach(a=>{s.push(a)}),s}_check_param(e,t,r){if(e instanceof Ah){let n=e.value.node();n&&t.set(n.graphNodeId(),n);return}}notifyNameUpdated(e){let t=this._referencing_params_by_all_named_node_ids.get(e.graphNodeId());if(t){let r=Qe.shallowClone(t);for(let n of r)n.notifyPathRebuildRequired(e)}}notifyParamsUpdated(e){let t=this._referencing_params_by_all_named_node_ids.get(e.graphNodeId());if(t){let r=Qe.shallowClone(t);for(let n of r)n.options.isSelectingParam()&&n.notifyTargetParamOwnerParamsUpdated(e)}}};var ZN={resolution:{value:new z(1e3,1e3)}},$8=class{constructor(e){this.scene=e}addUniforms(e,t){let{paramConfigs:r,additionalTextureUniforms:n,timeDependent:i,resolutionDependent:s}=t;for(let c of r)e[c.uniformName()]=c.uniform();let a=Object.keys(n);for(let c of a){let l=n[c];e[c]=l}i?this.addTimeUniform(e):this.removeTimeUniform(e),s?this.addResolutionUniforms(e):this.removeResolutionUniform(e)}addTimeUniform(e){e.time=this.scene.timeController.timeUniform()}removeTimeUniform(e){delete e.time}timeUniformValue(){return this.scene.timeController.timeUniform().value}addResolutionUniforms(e){e.resolution=ZN.resolution}removeResolutionUniform(e){delete e.resolution}updateResolution(e){ZN.resolution.value.copy(e)}};var K8=class{constructor(e){this.scene=e,this._viewersById=new Map,this._viewersByCamera=new Map}registerViewer(e){this._viewersById.set(e.id(),e),this._viewersByCamera.set(e.cameraNode(),e),this._updateCache()}unregisterViewer(e){this._viewersById.delete(e.id()),this._viewersByCamera.delete(e.cameraNode()),this._updateCache()}traverseViewers(e){this._viewersById.forEach(e)}viewerWithCamera(e){let t=this._viewersByCamera.get(e);return t||e.createViewer()}firstViewer(){return this._firstViewer}_updateCache(){this._firstViewer=void 0,this._viewersById.forEach(e=>{this._firstViewer=this._firstViewer||e})}};var J8=class{constructor(){this._require_webgl2=!1}require_webgl2(){return this._require_webgl2}set_require_webgl2(){this._require_webgl2||(this._require_webgl2=!0,Q.renderersController.setRequireWebGL2())}};var Z8=class{constructor(e){this._scene=e,this._onWindowResizeBound=this._onWindowResize.bind(this)}graphNode(){return this._coreGraphNode=this._coreGraphNode||this._createGraphNode()}_createGraphNode(){let e=new Kt(this._scene,"SceneWindowController");return window.addEventListener("resize",this._onWindowResizeBound),e}_onWindowResize(){this.graphNode().setSuccessorsDirty()}dispose(){window.removeEventListener("resize",this._onWindowResizeBound)}};var Q8=class{constructor(){this._params_by_id=new Map,this._assets_root=null}register_param(e){this._params_by_id.set(e.graphNodeId(),e)}deregister_param(e){this._params_by_id.delete(e.graphNodeId())}traverse_params(e){this._params_by_id.forEach((t,r)=>{e(t)})}root(){return this._assets_root}setRoot(e){e==""&&(e=null),this._assets_root=e}};var e6=class{constructor(){this._cameras_controller=new E4(this),this._cooker=new S4(this),this.cookController=new w4,this._graph=new M4,this._missing_expression_references_controller=new s5(this),this._expressions_controller=new r5,this._nodes_controller=new F8(this),this._objects_controller=new D8(this),this._references_controller=new Y8(this),this._time_controller=new u0(this),this._read_only=!1,this._graph.setScene(this),this.nodesController.init()}threejsScene(){return this.root().object}setUuid(e){return this._uuid=e}get uuid(){return this._uuid}setName(e){return e=Ve.sanitizeName(e),this._name=e}name(){return this._name}get camerasController(){return this._cameras_controller}mainCameraNode(){return this.camerasController.mainCameraNode()}get cooker(){return this._cooker}get assets(){return this._assets_controller=this._assets_controller||new Q8}async waitForCooksCompleted(){return await this.cookController.waitForCooksCompleted()}get dispatchController(){return this._dispatch_controller=this._dispatch_controller||new t5(this)}get eventsDispatcher(){return this._events_dispatcher=this._events_dispatcher||new X8(this)}get graph(){return this._graph}get lifecycleController(){return this._lifecycle_controller=this._lifecycle_controller||new o5(this)}get loadingController(){return this._loading_controller=this._loading_controller||new n5(this)}get missingExpressionReferencesController(){return this._missing_expression_references_controller}get expressionsController(){return this._expressions_controller}get nodesController(){return this._nodes_controller}createNode(e,t){return this.root().createNode(e,t)}nodesByType(e){return this.nodesController.nodesByType(e)}get objectsController(){return this._objects_controller}findObjectByMask(e){return this._objects_controller.findObjectByMask(e)}objectsByMask(e){return this._objects_controller.objectsByMask(e)}get referencesController(){return this._references_controller}get performance(){return this._performance=this._performance||new e5}get viewersRegister(){return this._viewers_register=this._viewers_register||new K8(this)}get timeController(){return this._time_controller}setFrame(e){this.timeController.setFrame(e)}setFrameToStart(){this.timeController.setFrameToStart()}frame(){return this.timeController.frame()}time(){return this.timeController.time()}maxFrame(){return this.timeController.maxFrame()}play(){this.timeController.play()}pause(){this.timeController.pause()}get serializer(){return this._serializer=this._serializer||new U8(this)}toJSON(){return this.serializer.toJSON()}markAsReadOnly(e){this._read_only||(this._read_only_requester=e,this._read_only=!0)}readOnly(){return this._read_only}readOnlyRequester(){return this._read_only_requester}get uniformsController(){return this._uniformsController=this._uniformsController||new $8(this)}get webgl_controller(){return this._webgl_controller=this._webgl_controller||new J8}get windowController(){return this._windowController=this._windowController||new Z8(this)}dispose(){var e;(e=this._windowController)==null||e.dispose()}async batchUpdates(e){this._cooker.block(),await e(),this._cooker.unblock()}node(e){return this.nodesController.node(e)}root(){return this.nodesController.root()}registerOnBeforeTick(e,t){this.timeController.registerOnBeforeTick(e,t)}unRegisterOnBeforeTick(e){this.timeController.unRegisterOnBeforeTick(e)}registeredBeforeTickCallbacks(){return this.timeController.registeredBeforeTickCallbacks()}registerOnAfterTick(e,t){this.timeController.registerOnAfterTick(e,t)}unRegisterOnAfterTick(e){this.timeController.unRegisterOnAfterTick(e)}registeredAfterTickCallbacks(){return this.timeController.registeredAfterTickCallbacks()}};var Bn=class{constructor(e){this._param=e}process_data(e){let t=e.raw_input;t!==void 0&&this._param.set(t),this.add_main(e)}add_main(e){}static spare_params_data(e){return this.params_data(!0,e)}static non_spare_params_data_value(e){return this.params_data_value(!1,e)}static params_data(e,t){let r;if(t){r={};let n=Object.keys(t),i;for(let s of n)i=t[s],i&&(r[s]=t)}return r}static params_data_value(e,t){let r;if(t){r={};let n=Object.keys(t),i;for(let s of n)if(i=t[s],i!=null){let a=i.options,c=i.overriden_options;if(a||c){let l=i;a&&a.spare==e?l.raw_input!=null&&(r[s]={complex_data:l}):c&&(r[s]={complex_data:l})}else{let l=i;(c||l!=null)&&(r[s]={simple_data:l})}}}return r}};var QN="operationsComposer",Mh=class{constructor(e,t,r){this._scene=e,this.states=t,this._node=r}static type(){throw"type to be overriden"}type(){return this.constructor.type()}static context(){throw console.error("operation has no node_context",this),"context requires override"}context(){return this.constructor.context()}scene(){return this._scene}cook(e,t){}convertExportParamData(e){let{params:t,paramName:r,paramData:n}=e,i=t[r];if(K.isBoolean(n))return n;if(K.isNumber(n))return K.isBoolean(i)?n>=1:n;if(K.isString(n))return i&&(i instanceof Rn||i instanceof Ec)?i.setPath(n):n;K.isArray(n)&&t[r].fromArray(n)}};Mh.DEFAULT_PARAMS={};Mh.INPUT_CLONED_STATE=[];var Ps=class{constructor(e){this._node=e,this._nodes=[],this._optimized_root_node_names=new Set,this._operation_containers_by_name=new Map,this._node_inputs=[]}nodes(){return this._nodes}process_data(e,t){var r,n,i;if(!t||!(this._node.childrenAllowed()&&this._node.childrenController))return;let{optimized_names:s}=Ps.child_names_by_optimized_state(t);this._nodes=[],this._optimized_root_node_names=new Set;for(let a of s)Ps.is_optimized_root_node(t,a)&&this._optimized_root_node_names.add(a);for(let a of this._optimized_root_node_names){let c=t[a],l={nodeName:a},u=this._node.createNode(QN,l);if(u){this._nodes.push(u),((r=c.flags)==null?void 0:r.display)&&((i=(n=u.flags)==null?void 0:n.display)==null||i.set(!0));let p=this._createOperationContainer(e,u,c,u.name());u.setOutputOperationContainer(p)}}for(let a of this._nodes){let c=a.outputOperationContainer();if(c){this._node_inputs=[],this._add_optimized_node_inputs(e,a,t,a.name(),c),a.io.inputs.setCount(this._node_inputs.length);for(let l=0;l<this._node_inputs.length;l++)a.setInput(l,this._node_inputs[l])}}}_add_optimized_node_inputs(e,t,r,n,i){var s;let a=r[n],c=a.inputs;if(!!c){for(let l of c)if(K.isString(l)){let u=r[l];if(u)if(Ps.is_node_optimized(u)&&!this._optimized_root_node_names.has(l)){let p=this._operation_containers_by_name.get(l);p||(p=this._createOperationContainer(e,t,u,l),p&&this._add_optimized_node_inputs(e,t,r,l,p)),i.addInput(p)}else{let p=(s=t.parent())==null?void 0:s.node(l);if(p){this._node_inputs.push(p);let d=this._node_inputs.length-1;t.addInputConfig(i,{operation_input_index:i.currentInputIndex(),node_input_index:d}),i.incrementInputIndex()}}}a.cloned_state_overriden==!0&&i.overrideInputCloneState(a.cloned_state_overriden)}}static child_names_by_optimized_state(e){let t=Object.keys(e),r=[],n=[];for(let i of t){let s=e[i];Q.playerMode()&&this.is_node_optimized(s)?r.push(i):n.push(i)}return{optimized_names:r,non_optimized_names:n}}static is_optimized_root_node_generic(e){return e.outputs_count==0||e.non_optimized_count>0}static is_optimized_root_node(e,t){let r=this.node_outputs(e,t),n=0;return r.forEach(i=>{let s=e[i];this.is_node_optimized(s)||n++}),this.is_optimized_root_node_generic({outputs_count:r.size,non_optimized_count:n})}static is_optimized_root_node_from_node(e){var t,r,n,i;if(!((r=(t=e.flags)==null?void 0:t.optimize)==null?void 0:r.active()))return!1;let s=e.io.connections.outputConnections().map(c=>c.node_dest),a=0;for(let c of s)((i=(n=c.flags)==null?void 0:n.optimize)==null?void 0:i.active())||a++;return this.is_optimized_root_node_generic({outputs_count:s.length,non_optimized_count:a})}static node_outputs(e,t){let r=Object.keys(e),n=new Set;for(let i of r)if(i!=t){let a=e[i].inputs;if(a)for(let c of a)K.isString(c)&&c==t&&n.add(i)}return n}_createOperationContainer(e,t,r,n){let i=Bn.non_spare_params_data_value(r.params),s=Ps.operation_type(r),a={paramsInitValueOverrides:i},c=this._node.createOperationContainer(s,n,a);return c&&(this._operation_containers_by_name.set(n,c),c.pathParamResolveRequired()&&(t.addOperationContainerWithPathParamResolveRequired(c),e.add_operations_composer_node_with_path_param_resolve_required(t))),c}static operation_type(e){return Ps.is_node_bypassed(e)?"null":e.type}static is_node_optimized(e){let t=e.flags;return!!(t&&t.optimize)}static is_node_bypassed(e){let t=e.flags;return!!(t&&t.bypass)}};var t6=class{static migrateNodeType(e,t){return e.childrenControllerContext()==oe.GL&&t=="substract"?"subtract":t}};var r6=class{constructor(e){this._node=e}process_data(e,t){var r;if(!t||!(this._node.childrenAllowed()&&this._node.childrenController))return;let{optimized_names:n,non_optimized_names:i}=Ps.child_names_by_optimized_state(t),s=[];for(let c of i){let l=t[c],u=t6.migrateNodeType(this._node,l.type.toLowerCase()),d={paramsInitValueOverrides:Bn.non_spare_params_data_value(l.params),nodeName:c};try{let h=this._node.createNode(u,d);h&&s.push(h)}catch(h){console.error(`error importing node: cannot create with type ${u}`,h);let m=Ve.camelCase(u);try{let f=this._node.createNode(m,d);f&&s.push(f)}catch{let v=`${u}Network`;try{let g=this._node.createNode(v,d);g&&s.push(g)}catch(g){let _=`failed to create node with type '${u}', '${m}' or '${v}'`;e.report.addWarning(_),Q.warn(_,g)}}}}if(n.length>0){let c=new Ps(this._node);if(c.process_data(e,t),this._node.childrenController.context==oe.SOP){let l=Object.keys(t),u;for(let p of l)((r=t[p].flags)==null?void 0:r.display)&&(u=p);if(u){let p=s.map(h=>h.name()),d=c.nodes();for(let h of d)p.push(h.name());if(!p.includes(u)){let f=`node '${`${this._node.path()}/${u}`}' with display flag has been optimized and does not exist in player mode`;console.error(f)}}}}let a=new Map;for(let c of s)if(t[c.name()]){let u=ua.dispatch_node(c);a.set(c.name(),u),u.process_data(e,t[c.name()])}else Q.warn(`possible import error for node ${c.name()}`),Q.log("available names are",Object.keys(t).sort(),t);for(let c of s){let l=a.get(c.name());l&&l.process_inputs_data(t[c.name()])}}};var WJ=["overriden_options","type"],Nh=class{constructor(e){this._node=e}process_data(e,t){if(this.set_connection_points(t.connection_points),this._node.childrenAllowed()&&this.create_nodes(e,t.nodes),this.set_selection(t.selection),this._node.io.inputs.overrideClonedStateAllowed()){let r=t.cloned_state_overriden;r&&this._node.io.inputs.overrideClonedState(r)}this.set_flags(t),this.set_params(t),t.persisted_config&&this.set_persisted_config(t.persisted_config),this.from_data_custom(t)}process_inputs_data(e){let t=e.maxInputsCount;if(t!=null){let r=this._node.io.inputs.minCount();this._node.io.inputs.setCount(r,t)}this.setInputs(e.inputs)}process_ui_data(e,t){if(!t||Q.playerMode())return;let r=this._node.uiData,n=t.pos;if(n){let s=new z().fromArray(n);r.setPosition(s)}let i=t.comment;i&&r.setComment(i),this._node.childrenAllowed()&&this.process_nodes_ui_data(e,t.nodes)}create_nodes(e,t){if(!t)return;new r6(this._node).process_data(e,t)}set_selection(e){if(this._node.childrenAllowed()&&this._node.childrenController&&e&&e.length>0){let t=[];e.forEach(r=>{let n=this._node.node(r);n&&t.push(n)}),this._node.childrenController.selection.set(t)}}set_flags(e){var t,r,n,i,s,a;let c=e.flags;if(c){let l=c.bypass;l!=null&&((r=(t=this._node.flags)==null?void 0:t.bypass)==null||r.set(l));let u=c.display;u!=null&&((i=(n=this._node.flags)==null?void 0:n.display)==null||i.set(u));let p=c.optimize;p!=null&&((a=(s=this._node.flags)==null?void 0:s.optimize)==null||a.set(p))}}set_connection_points(e){!e||(e.in&&this._node.io.saved_connection_points_data.set_in(e.in),e.out&&this._node.io.saved_connection_points_data.set_out(e.out),this._node.io.has_connection_points_controller&&this._node.io.connection_points.update_signature_if_required())}setInputs(e){if(!e)return;let t;for(let r=0;r<e.length;r++)if(t=e[r],t&&this._node.parent())if(K.isString(t)){let n=t,i=this._node.nodeSibling(n);this._node.setInput(r,i)}else{let n=this._node.nodeSibling(t.node),i=t.index;this._node.setInput(i,n,t.output)}}process_nodes_ui_data(e,t){if(!t||Q.playerMode())return;let r=Object.keys(t);for(let n of r){let i=this._node.node(n);if(i){let s=t[n];ua.dispatch_node(i).process_ui_data(e,s)}}}set_params(e){let t=e.params;if(!t)return;let r=Object.keys(t),n={};for(let a of r){let c=t[a];if(c!=null){let l=c.options,u=c.type;u=="operator_path"&&(u=J.NODE_PATH);let p=this._node.params.has_param(a),d=!1,h;p&&(h=this._node.params.get(a),(h&&h.type()==u||u==null)&&(d=!0)),d?this._is_param_data_complex(c)?this._process_param_data_complex(a,c):this._process_param_data_simple(a,c):(n.namesToDelete=n.namesToDelete||[],n.namesToDelete.push(a),n.toAdd=n.toAdd||[],n.toAdd.push({name:a,type:u,initValue:c.default_value,rawInput:c.raw_input,options:l}))}}let i=n.namesToDelete&&n.namesToDelete.length>0,s=n.toAdd&&n.toAdd.length>0;if(i||s){this._node.params.updateParams(n);for(let a of this._node.params.spare){let c=t[a.name()];!a.parentParam()&&c&&(this._is_param_data_complex(c)?this._process_param_data_complex(a.name(),c):this._process_param_data_simple(a.name(),c))}}this._node.params.runOnSceneLoadHooks()}_process_param_data_simple(e,t){var r;(r=this._node.params.get(e))==null||r.set(t)}_process_param_data_complex(e,t){let r=this._node.params.get(e);r&&ua.dispatch_param(r).process_data(t)}_is_param_data_complex(e){if(K.isString(e)||K.isNumber(e)||K.isArray(e)||K.isBoolean(e))return!1;if(K.isObject(e)){let t=Object.keys(e);for(let r of WJ)if(t.includes(r))return!0}return!1}set_persisted_config(e){this._node.persisted_config&&this._node.persisted_config.load(e)}from_data_custom(e){}};var o6=class extends Bn{add_main(e){}};var qJ=/\\n+/g,n6=class extends Bn{add_main(e){let t=e.raw_input;t!==void 0&&(t=t.replace(qJ,`
`),this._param.set(t))}};var i6=class extends Bn{add_main(e){let t=e.raw_input;t&&this._param.set(t)}};var s6=class extends Nh{create_nodes(e,t){let n=this._node.polyNodeController;n&&n.createChildNodesFromDefinition()}};var ua=class{static dispatch_node(e){return e.polyNodeController?new s6(e):new Nh(e)}static dispatch_param(e){return e instanceof Fi?new o6(e):e instanceof Eh?new n6(e):e instanceof Os?new i6(e):new Bn(e)}};var a6=class{constructor(e){this._warnings=[]}warnings(){return this._warnings}reset(){this._warnings=[]}addWarning(e){this._warnings.push(e)}};var Oh=class{constructor(e){this._data=e,this.report=new a6(this)}static async loadData(e){return await new Oh(e).scene()}async scene(){let e=new e6;e.loadingController.markAsLoading();let t=this._data.properties;if(t){let n=t.maxFrame||600;e.timeController.setMaxFrame(n);let i=t.maxFrameLocked;i&&e.timeController.setMaxFrameLocked(i);let s=t.realtimeState;s!=null&&e.timeController.setRealtimeState(s),e.setFrame(t.frame||u0.START_FRAME),t.mainCameraNodePath&&e.camerasController.setMainCameraNodePath(t.mainCameraNodePath)}e.cooker.block(),this._base_operations_composer_nodes_with_resolve_required=void 0;let r=ua.dispatch_node(e.root());return this._data.root&&r.process_data(this,this._data.root),this._data.ui&&r.process_ui_data(this,this._data.ui),this._resolve_operation_containers_with_path_param_resolve(),await e.loadingController.markAsLoaded(),e.cooker.unblock(),e}add_operations_composer_node_with_path_param_resolve_required(e){this._base_operations_composer_nodes_with_resolve_required||(this._base_operations_composer_nodes_with_resolve_required=[]),this._base_operations_composer_nodes_with_resolve_required.push(e)}_resolve_operation_containers_with_path_param_resolve(){if(!!this._base_operations_composer_nodes_with_resolve_required)for(let e of this._base_operations_composer_nodes_with_resolve_required)e.resolveOperationContainersPathParams()}};var Ph=class{constructor(e){this.options=e,this._onLoadCompleteCalled=!1}static async loadSceneData(e){let t=new Ph(e),r=await t.loadScene(),n=t._viewer;return{scene:r,viewer:n}}async _onLoadComplete(){this._onLoadCompleteCalled!=!0&&(this._onLoadCompleteCalled=!0,this._viewer&&this._viewer.markAsReady(),this._scene&&(await this._scene.cookController.waitForCooksCompleted(),this._scene.setFrame(u0.START_FRAME),this.options.autoPlay!=!1&&this._scene.play(),document.dispatchEvent(new Event("POLYSceneReady")),document.dispatchEvent(new Event(`POLYSceneReady-${this._scene.name()}`))))}_onNodesCookProgress(e){let t=n=>{this.options.onProgress&&this.options.onProgress(r.start+r.mult*n)},r=Tx.nodes;t(e),e>=1&&this._onLoadComplete()}async _watchNodesProgress(e){let t=await e.root().loadProgress.resolvedNodes(),r=t.length;r==0&&this._onNodesCookProgress(1);let n="ScenePlayerImporter",i=new Set;for(let s of t){let a=s.graphNodeId();s.compute(),s.cookController.registerOnCookEnd(n,()=>{if(!i.has(a)){i.add(a);let c=i.size/r;this._onNodesCookProgress(c),s.cookController.deregisterOnCookEnd(n)}})}}async loadScene(){let e=new Oh(this.options.sceneData);this._scene=await e.scene(),this._scene.setName(this.options.sceneName);let t=this.options.configureScene;t&&t(this._scene);let r=this._scene.mainCameraNode();return r?this._viewer=r.createViewer({element:this.options.domElement,viewerProperties:{autoRender:!1}}):console.warn("no main camera found, viewer is not mounted"),this._watchNodesProgress(this._scene),this._scene}};function eO(o){window.scene=o}var rt=class{constructor(e){this.param=e,this._requireDependency=!1}requireDependency(){return this._requireDependency}node(){return this._node=this._node||this.param.node}static requiredArguments(){return console.warn("Expression.Method._Base.required_arguments virtual method call. Please override"),[]}static optionalArguments(){return[]}static minAllowedArgumentsCount(){return this.requiredArguments().length}static maxAllowedArgumentsCount(){return this.minAllowedArgumentsCount()+this.optionalArguments().length}static allowedArgumentsCount(e){return e>=this.minAllowedArgumentsCount()&&e<=this.maxAllowedArgumentsCount()}processArguments(e){throw"Expression.Method._Base.process_arguments virtual method call. Please override"}async getReferencedNodeContainer(e){let t=this.getReferencedNode(e);if(t){let r;if(t.isDirty()?r=await t.compute():r=t.containerController.container(),r&&r.coreContent())return r;throw`referenced node invalid: ${t.path()}`}else throw`invalid input (${e})`}getReferencedParam(e,t){let r=this.node();return r?ut.findParam(r,e,t):null}findReferencedGraphNode(e,t){if(K.isNumber(e)){let n=e,i=this.node();if(i)return i.io.inputs.inputGraphNode(n)}else{let n=e;return this.getReferencedNode(n,t)}return null}getReferencedNode(e,t){let r=null,n=this.node();if(K.isString(e)){if(n){let i=e;r=ut.findNode(n,i,t)}}else if(n){let i=e;r=n.io.inputs.input(i)}return r||null}findDependency(e){return null}createDependencyFromIndexOrPath(e){let t=new Dc,r=this.findReferencedGraphNode(e,t);return r?this.createDependency(r,e,t):(Q.warn("node not found for path",e),null)}createDependency(e,t,r){return Pc.create(this.param,t,e,r)}};var c6=class extends rt{constructor(){super(...arguments);this._requireDependency=!0}static requiredArguments(){return[["string","arguments list"],["number","index"]]}processArguments(e){return new Promise((t,r)=>{if(e.length==2){let n=e[0],i=e[1],s=n.split(" ")[i];t(s)}else t(0)})}};var l6=class extends rt{constructor(){super(...arguments);this._requireDependency=!0}static requiredArguments(){return[["string","arguments list"]]}processArguments(e){return new Promise((t,r)=>{if(e.length==1){let i=e[0].split(" ").length;t(i)}else t(0)})}};var XJ=["min","max","size","center"],YJ=["x","y","z"],u6=class extends rt{constructor(){super(...arguments);this._requireDependency=!0}static requiredArguments(){return[["string","path to node"],["string","vector name, min, max, size or center"],["string","component_name, x,y or z"]]}findDependency(e){return this.createDependencyFromIndexOrPath(e)}processArguments(e){let t=0;return new Promise(async(r,n)=>{if(e.length>=1){let i=e[0],s=e[1],a=e[2],c=null;try{c=await this.getReferencedNodeContainer(i)}catch(l){n(l)}c&&(t=this._get_value_from_container(c,s,a),r(t))}else r(0)})}_get_value_from_container(e,t,r){let n=e.boundingBox();if(!t)return n;if(XJ.indexOf(t)>=0){let i=new M;switch(t){case"size":n.getSize(i);break;case"center":n.getCenter(i);break;default:i=n[t]}return r?YJ.indexOf(r)>=0?i[r]:-1:i}else return-1}};var p6=class extends rt{constructor(){super(...arguments);this._requireDependency=!0}static requiredArguments(){return[["string","path to node"],["string","component_name, x,y or z"]]}findDependency(e){return this.createDependencyFromIndexOrPath(e)}processArguments(e){return new Promise(async(t,r)=>{if(e.length>=1){let n=e[0],i=e[1],s=null;try{s=await this.getReferencedNodeContainer(n)}catch(a){r(a)}if(s){let a=s.boundingBox(),c=a.min.clone().add(a.max).multiplyScalar(.5);if(i){let l=c[i];l!=null?t(l):t(0)}else t(c)}}else t(0)})}};var d6=class extends rt{constructor(){super(...arguments);this._requireDependency=!0}static requiredArguments(){return[["string","path to param"]]}findDependency(e){let t=new Dc,r=this.getReferencedParam(e,t);return r?(this._referencedParam=r,this.createDependency(r,e,t)):null}async processArguments(e){return new Promise(async(t,r)=>{let n=0;if(e.length==1){let i=e[0],s=this._referencedParam||this.getReferencedParam(i);if(s){s.isDirty()&&await s.compute();let a=s.value;a!=null&&(n=a,t(n))}else r(0)}})}};var Fn=class{constructor(){this._objects=[],this._objects_with_geo=[],this.touch()}dispose(){if(this._objects=[],this._objects_with_geo=[],this._core_objects){for(let e of this._core_objects)e.dispose();this._core_objects=void 0}if(this._core_geometries){for(let e of this._core_geometries)e.dispose();this._core_geometries=void 0}}timestamp(){return this._timestamp}touch(){let e=Q.performance.performanceManager();this._timestamp=e.now(),this.reset()}reset(){this._bounding_box=void 0,this._core_geometries=void 0,this._core_objects=void 0}clone(){let e=new Fn;if(this._objects){let t=[];for(let r of this._objects)t.push(br.clone(r));e.setObjects(t)}return e}setObjects(e){this._objects=e,this._objects_with_geo=e.filter(t=>t.geometry!=null),this.touch()}objects(){return this._objects}objectsWithGeo(){return this._objects_with_geo}coreObjects(){return this._core_objects=this._core_objects||this._create_core_objects()}_create_core_objects(){return this._objects?this._objects.map((e,t)=>new br(e,t)):[]}objectsData(){return this._objects?this._objects.map(e=>this._objectData(e)):[]}_objectData(e){let t=0;return e.geometry&&(t=At.pointsCount(e.geometry)),{type:si(e.constructor),name:e.name,children_count:e.children.length,points_count:t}}geometries(){let e=[];for(let t of this.coreObjects()){let r=t.object().geometry;r&&e.push(r)}return e}coreGeometries(){return this._core_geometries=this._core_geometries||this._createCoreGeometries()}_createCoreGeometries(){let e=[];for(let t of this.geometries())e.push(new At(t));return e}static geometryFromObject(e){return e.isMesh||e.isLine||e.isPoints?e.geometry:null}faces(){let e=[];for(let t of this.objectsWithGeo())if(t.geometry){let n=new At(t.geometry).faces();for(let i of n)i.applyMatrix4(t.matrix),e.push(i)}return e}points(){return this.coreGeometries().map(e=>e.points()).flat()}pointsCount(){return Qe.sum(this.coreGeometries().map(e=>e.pointsCount()))}totalPointsCount(){if(this._objects){let e=0;for(let t of this._objects)t.traverse(r=>{let n=r.geometry;n&&(e+=At.pointsCount(n))});return e}else return 0}pointsFromGroup(e){if(e){let t=Ve.indices(e),r=this.points();return Qe.compact(t.map(n=>r[n]))}else return this.points()}static _fromObjects(e){let t=new Fn;return t.setObjects(e),t}objectsFromGroup(e){return this.coreObjectsFromGroup(e).map(t=>t.object())}coreObjectsFromGroup(e){if(e=e.trim(),e!==""){let t=parseInt(e);return K.isNaN(t)?this.coreObjects().filter(r=>Ve.matchMask(e,r.name())):Qe.compact([this.coreObjects()[t]])}else return this.coreObjects()}boundingBox(e=!1){return e?this._bounding_box=this._computeBoundingBox():this._bounding_box=this._bounding_box||this._computeBoundingBox()}center(){let e=new M;return this.boundingBox().getCenter(e),e}size(){let e=new M;return this.boundingBox().getSize(e),e}_computeBoundingBox(){let e;if(this._objects)for(let t of this._objects){let r=t.geometry;r&&(r.computeBoundingBox(),e?e.expandByObject(t):r.boundingBox&&(e=r.boundingBox.clone()))}return e=e||new fn(new M(-1,-1,-1),new M(1,1,1)),e}computeVertexNormals(){for(let e of this.coreObjects())e.computeVertexNormals()}hasAttrib(e){let t;return(t=this.coreGeometries()[0])!=null?t.hasAttrib(e):!1}attribType(e){let t=this.coreGeometries()[0];return t!=null?t.attribType(e):null}objectAttribType(e){let t=this.coreObjects()[0];return t!=null?t.attribType(e):null}renameAttrib(e,t,r){switch(r){case Mc.ATTRIB_CLASS.VERTEX:if(this.hasAttrib(e)&&this._objects)for(let n of this._objects)n.traverse(i=>{let s=Fn.geometryFromObject(i);s&&new At(s).renameAttrib(e,t)});break;case Mc.ATTRIB_CLASS.OBJECT:if(this.hasAttrib(e)&&this._objects)for(let n of this._objects)n.traverse(i=>{new br(i,0).renameAttrib(e,t)});break}}attribNames(){let e;return(e=this.coreGeometries()[0])!=null?e.attribNames():[]}objectAttribNames(){let e;return(e=this.coreObjects()[0])!=null?e.attribNames():[]}attribNamesMatchingMask(e){let t=Ve.attribNames(e),r=[];for(let n of this.attribNames())for(let i of t)if(Ve.matchMask(n,i))r.push(n);else{let s=Ot.remapName(i);n==s&&r.push(n)}return Qe.uniq(r)}attribSizes(){let e;return(e=this.coreGeometries()[0])!=null?e.attribSizes():{}}objectAttribSizes(){let e;return(e=this.coreObjects()[0])!=null?e.attribSizes():{}}attribSize(e){let t;return(t=this.coreGeometries()[0])!=null?t.attribSize(e):0}addNumericVertexAttrib(e,t,r){r==null&&(r=Ot.default_value(t));for(let n of this.coreGeometries())n.addNumericAttrib(e,t,r)}static clone(e){let t=new st;return e.children.forEach(r=>{let n=br.clone(r);t.add(n)}),t}};var Ke=class extends Mh{static context(){return oe.SOP}cook(e,t){}createCoreGroupFromObjects(e){let t=new Fn;return t.setObjects(e),t}createCoreGroupFromGeometry(e,t=jt.MESH){let r=Ke.createObject(e,t);return this.createCoreGroupFromObjects([r])}createObject(e,t,r){return Ke.createObject(e,t,r)}static createObject(e,t,r){this.createIndexIfNone(e);let n=sN[t];r=r||Mc.MATERIALS[t].clone();let i=new n(e,r);return i.castShadow=!0,i.receiveShadow=!0,i.frustumCulled=!1,i.matrixAutoUpdate=!1,i}createIndexIfNone(e){Ke.createIndexIfNone(e)}static createIndexIfNone(e){hh.createIndexIfNone(e)}};var T_="input geometry",$J=[T_,T_,T_,T_],Ye=class extends fr{constructor(){super(...arguments);this.flags=new h5(this)}static context(){return oe.SOP}static displayedInputNames(){return $J}initializeBaseNode(){this.flags.display.set(!1),this.flags.display.onUpdate(()=>{if(this.flags.display.active()){let e=this.parent();e&&e.displayNodeController&&e.displayNodeController.setDisplayNode(this)}}),this.io.outputs.setHasOneOutput()}setCoreGroup(e){this._setContainer(e,"from set_core_group")}setObject(e){this._setContainerObjects([e],"from set_object")}setObjects(e){this._setContainerObjects(e,"from set_objects")}setGeometry(e,t=jt.MESH){let r=this.createObject(e,t);this._setContainerObjects([r],"from set_geometry")}setGeometries(e,t=jt.MESH){let r=[],n;for(let i of e)n=this.createObject(i,t),r.push(n);this._setContainerObjects(r,"from set_geometries")}_setContainerObjects(e,t){let r=this.containerController.container().coreContent()||new Fn;r.setObjects(e),r.touch(),this._setContainer(r)}static createObject(e,t,r){return Ke.createObject(e,t,r)}createObject(e,t,r){return Ye.createObject(e,t,r)}static createIndexIfNone(e){Ke.createIndexIfNone(e)}_createIndexIfNone(e){Ye.createIndexIfNone(e)}};var Zu=class extends Re{constructor(){super();this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}clone(){return new this.constructor().copy(this)}toJSON(){let e=super.toJSON(this);return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}};Zu.prototype.isInstancedBufferGeometry=!0;var Kr=class extends Tt{constructor(e,t,r,n=1){typeof r=="number"&&(n=r,r=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument."));super(e,t,r);this.meshPerAttribute=n}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){let e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}};Kr.prototype.isInstancedBufferAttribute=!0;var A_={SCALE:new M(1,1,1),PSCALE:1,EYE:new M(0,0,0),UP:new M(0,1,0)},KJ="scale",JJ="pscale",ZJ="normal",QJ="up",eZ=new M(1,1,1),tZ=new z(0,0),tO="uv",rO="color";var rZ={P:"instancePosition",N:"instanceOrientation",up:"instanceOrientation",Cd:"instanceColor",[mr.COLOR]:"instanceColor",[mr.NORMAL]:"instanceOrientation",[mr.POSITION]:"instancePosition",[mr.PSCALE]:"instanceScale",[mr.SCALE]:"instanceScale"},oO=class{constructor(o){this._coreGroup=o,this._is_pscale_present=!1,this._is_scale_present=!1,this._is_normal_present=!1,this._is_up_present=!1,this._do_rotate_matrices=!1,this._matrixT=new Ue,this._matrixR=new Ue,this._matrixS=new Ue,this._pointScale=new M,this._pointNormal=new M,this._pointUp=new M,o&&this.setCoreGroup(o)}static remapName(o){return rZ[o]||o}setCoreGroup(o){this._coreGroup=o,this._is_pscale_present=this._coreGroup.hasAttrib(mr.PSCALE),this._is_scale_present=this._coreGroup.hasAttrib(mr.SCALE),this._is_normal_present=this._coreGroup.hasAttrib(mr.NORMAL),this._is_up_present=this._coreGroup.hasAttrib(mr.UP),this._do_rotate_matrices=this._is_normal_present}matrixFromPoint(o,e){e.identity();let t=o.position();this._is_scale_present?o.attribValue(KJ,this._pointScale):this._pointScale.copy(A_.SCALE);let r=this._is_pscale_present?o.attribValue(JJ):A_.PSCALE;this._pointScale.multiplyScalar(r);let n=this._matrixS;n.makeScale(this._pointScale.x,this._pointScale.y,this._pointScale.z);let i=this._matrixT;if(i.makeTranslation(t.x,t.y,t.z),e.multiply(i),this._do_rotate_matrices){let s=this._matrixR,a=A_.EYE;o.attribValue(ZJ,this._pointNormal),this._pointNormal.multiplyScalar(-1),this._is_up_present?o.attribValue(QJ,this._pointUp):this._pointUp.copy(A_.UP),this._pointUp.normalize(),s.lookAt(a,this._pointNormal,this._pointUp),e.multiply(s)}e.multiply(n)}static updateTransformInstanceAttributes(o,e,t){let r=o.length,n=new Float32Array(r*3),i=new Float32Array(r*3),s=new Float32Array(r*4),a=new oO(e),c=0;for(let l of o){a.matrixFromPoint(l,this._tmpMatrix);let u=c*3,p=c*4;this._tmpMatrix.decompose(this._position,this._quaternion,this._scale),this._position.toArray(n,u),this._quaternion.toArray(s,p),this._scale.toArray(i,u),c++}t.setAttribute("instancePosition",new Kr(n,3)),t.setAttribute("instanceScale",new Kr(i,3)),t.setAttribute("instanceOrientation",new Kr(s,4))}static updateColorInstanceAttribute(o,e,t){let r=o.length,n=new Float32Array(r*3),i=e.hasAttrib(rO),s=0;for(let a of o)(i?a.attribValue(rO,this._point_color):eZ).toArray(n,s*3),s++;t.setAttribute("instanceColor",new Kr(n,3))}static createInstanceBufferGeometry(o,e,t){let r=e.points(),n=new Zu;n.copy(o),n.instanceCount=1/0;let i=r.length,s=e.hasAttrib(tO);if(s){let l=new Float32Array(i*2),u=0;for(let p of r){let d=u*2;(s?p.attribValue(tO,this._point_uv):tZ).toArray(l,d),u++}n.setAttribute("instanceUv",new Kr(l,2))}return this.updateTransformInstanceAttributes(r,e,n),this.updateColorInstanceAttribute(r,e,n),e.attribNamesMatchingMask(t).forEach(l=>{let u=e.attribSize(l),p=new Float32Array(i*u);r.forEach((d,h)=>{let m=d.attribValue(l);K.isNumber(m)?p[h]=m:m.toArray(p,h*u)}),n.setAttribute(l,new Kr(p,u))}),new At(n).markAsInstance(),n}},Vi=oO;Vi.transformAttributeNames=["instancePosition","instanceOrientation","instanceScale"];Vi._point_color=new M;Vi._point_uv=new z;Vi._position=new M(0,0,0);Vi._quaternion=new It;Vi._scale=new M(1,1,1);Vi._tmpMatrix=new Ue;var h6=class extends Kt{constructor(e){super(e,"CopyStamp");this._globalIndex=0}reset(){this.setGlobalIndex(0)}setGlobalIndex(e){let t=this._globalIndex;this._globalIndex=e,t!=this._globalIndex&&(this.setDirty(),this.removeDirtyState())}value(e){return this._globalIndex}};var f6=class extends h6{reset(){super.reset(),this.setPoint(void 0)}setPoint(e){let t=this._point;this._point=e,t!=this._point&&(this.setDirty(),this.removeDirtyState())}value(e){return this._point?e?this._point.attribValue(e):this._point.index():this._globalIndex}};var m0=(o=>(o.OBJECTS="objects",o.GEOMETRIES="geometries",o))(m0||{}),_0=["geometries","objects"],Bc=(o=>(o.XYZ="XYZ",o.XZY="XZY",o.YXZ="YXZ",o.YZX="YZX",o.ZYX="ZYX",o.ZXY="ZXY",o))(Bc||{}),Rs=["XYZ","XZY","YXZ","YZX","ZXY","ZYX"];var Yt=class{constructor(){this._translation_matrix=new Ue,this._translation_matrix_q=new It,this._translation_matrix_s=new M(1,1,1),this._matrix=new Ue().identity(),this._matrix_q=new It,this._matrix_euler=new J3,this._matrix_s=new M,this._m=new Ue,this._q=new It,this._rotateDirOrigin=new M,this._rotateDirDest=new M}static setParamsFromMatrix(e,t,r={}){let n=r.scale;n==null&&(n=!0),e.decompose(this.set_params_from_matrix_position,this.set_params_from_matrix_quaternion,this.set_params_from_matrix_scale),this.set_params_from_matrix_euler.setFromQuaternion(this.set_params_from_matrix_quaternion),this.set_params_from_matrix_euler.toVector3(this.set_params_from_matrix_rotation),this.set_params_from_matrix_rotation.divideScalar(Math.PI/180),this.set_params_from_matrix_position.toArray(this.set_params_from_matrix_t),this.set_params_from_matrix_rotation.toArray(this.set_params_from_matrix_r),this.set_params_from_matrix_scale.toArray(this.set_params_from_matrix_s),t.scene().batchUpdates(()=>{t.params.set_vector3("t",this.set_params_from_matrix_t),t.params.set_vector3("r",this.set_params_from_matrix_r),t.params.set_vector3("s",this.set_params_from_matrix_s),n&&t.params.set_float("scale",1)})}static setParamsFromObject(e,t){e.position.toArray(this.set_params_from_object_position_array),e.rotation.toArray(this.set_params_from_object_rotation_array),this.set_params_from_object_rotation_deg.fromArray(this.set_params_from_object_rotation_array),this.set_params_from_object_rotation_deg.multiplyScalar(180/Math.PI),this.set_params_from_object_rotation_deg.toArray(this.set_params_from_object_rotation_array),t.scene().batchUpdates(()=>{t.params.set_vector3("t",this.set_params_from_object_position_array),t.params.set_vector3("r",this.set_params_from_object_rotation_array)})}translationMatrix(e){return this._translation_matrix.compose(e,this._translation_matrix_q,this._translation_matrix_s),this._translation_matrix}matrix(e,t,r,n,i){return this._matrix_euler.set(Mn(t.x),Mn(t.y),Mn(t.z),i),this._matrix_q.setFromEuler(this._matrix_euler),this._matrix_s.copy(r).multiplyScalar(n),this._matrix.compose(e,this._matrix_q,this._matrix_s),this._matrix}rotateGeometry(e,t,r){this._rotateDirDest.copy(r).normalize(),this._rotateDirOrigin.copy(t).normalize(),this._q.setFromUnitVectors(this._rotateDirOrigin,this._rotateDirDest),this._m.makeRotationFromQuaternion(this._q),e.applyMatrix4(this._m)}rotateObject(e,t,r){this._rotateDirDest.copy(r).normalize(),this._rotateDirOrigin.copy(t).normalize(),this._q.setFromUnitVectors(this._rotateDirOrigin,this._rotateDirDest),this._m.makeRotationFromQuaternion(this._q),e.matrix.multiply(this._m),e.matrix.decompose(e.position,e.quaternion,e.scale)}static decomposeMatrix(e){e.matrix.decompose(e.position,e.quaternion,e.scale)}};Yt.set_params_from_matrix_position=new M;Yt.set_params_from_matrix_quaternion=new It;Yt.set_params_from_matrix_scale=new M;Yt.set_params_from_matrix_euler=new J3;Yt.set_params_from_matrix_rotation=new M;Yt.set_params_from_matrix_t=[0,0,0];Yt.set_params_from_matrix_r=[0,0,0];Yt.set_params_from_matrix_s=[0,0,0];Yt.set_params_from_object_position_array=[0,0,0];Yt.set_params_from_object_rotation_deg=new M;Yt.set_params_from_object_rotation_array=[0,0,0];var oZ=[0,1],nZ=[{name:"object",value:0},{name:"geometry",value:1}],nO=class extends U{constructor(){super(...arguments);this.count=y.INTEGER(1,{range:[1,20],rangeLocked:[!0,!1]}),this.t=y.VECTOR3([0,0,0]),this.r=y.VECTOR3([0,0,0]),this.s=y.VECTOR3([1,1,1]),this.scale=y.FLOAT(1),this.transformOnly=y.BOOLEAN(0),this.transformMode=y.INTEGER(0,{menu:{entries:nZ}}),this.copyAttributes=y.BOOLEAN(0),this.attributesToCopy=y.STRING("",{visibleIf:{copyAttributes:!0}}),this.useCopyExpr=y.BOOLEAN(1)}},iZ=new nO,Rh=class extends Ye{constructor(){super(...arguments);this.paramsConfig=iZ,this._attribNamesToCopy=[],this._objects=[],this._instancer=new Vi,this._instanceMatrix=new Ue,this._coreTransform=new Yt,this._transformAccumulatedMatrix=new Ue,this._transformMatrix=new Ue}static type(){return"copy"}static displayedInputNames(){return["geometry to be copied","points to copy to"]}initializeNode(){this.io.inputs.setCount(1,2),this.io.inputs.initInputsClonedState([ke.FROM_NODE,ke.NEVER])}async cook(e){this.pv.useCopyExpr||this.stampNode().reset();let t=e[0];if(!this.io.inputs.hasInput(1)){await this.cookWithoutTemplate(t);return}let r=e[1];if(!r){this.states.error.set("second input invalid");return}await this.cookWithTemplate(t,r)}async cookWithTemplate(e,t){this._objects=[];let r=t.points();this._instancer.setCoreGroup(t),this._attribNamesToCopy=Ve.attribNames(this.pv.attributesToCopy).map(n=>Ot.remapName(n)),this._attribNamesToCopy=this._attribNamesToCopy.filter(n=>t.hasAttrib(n)),await this._copyMovedObjectsOnTemplatePoints(e,r),this.setObjects(this._objects)}async _copyMovedObjectsOnTemplatePoints(e,t){this._initAccumulatedTransform();for(let r=0;r<t.length;r++)await this._copyMovedObjectOnTemplatePoint(e,t,r),this._accumulateTransform()}async _copyMovedObjectOnTemplatePoint(e,t,r){this._instancer.matrixFromPoint(t[r],this._instanceMatrix);let n=t[r];this.pv.useCopyExpr&&this.stampNode().setPoint(n);let i=await this._getMovedObjectsForTemplatePoint(e,r);for(let s of i)this.pv.copyAttributes&&this._copyAttributes_from_template(s,n),this.pv.transformOnly?s.applyMatrix4(this._instanceMatrix):this._applyMatrixToObjectOrGeometry(s,this._instanceMatrix),this._applyAccumulatedTransform(s),this._objects.push(s)}async _getMovedObjectsForTemplatePoint(e,t){let r=await this._stampInstanceGroupIfRequired(e);if(r){let n=()=>{let s=r.objects()[t];return s?[s.clone()]:[]};return this.pv.transformOnly?n():r.clone().objects()}else return[]}async _stampInstanceGroupIfRequired(e){let t=await this.containerController.requestInputContainer(0);if(t){let r=t.coreContent();return r||void 0}else{this.states.error.set(`input failed for index ${this.stampValue()}`);return}}async _copyMovedObjectsForEachInstance(e){this._initAccumulatedTransform();for(let t=0;t<this.pv.count;t++)await this._copyMovedObjectsForInstance(e,t),this._accumulateTransform()}async _copyMovedObjectsForInstance(e,t){this.pv.useCopyExpr&&this.stampNode().setGlobalIndex(t);let r=await this._stampInstanceGroupIfRequired(e);r&&r.objects().forEach(n=>{let i=br.clone(n);this._applyAccumulatedTransform(i),this._objects.push(i)})}async cookWithoutTemplate(e){this._objects=[],await this._copyMovedObjectsForEachInstance(e),this.setObjects(this._objects)}_copyAttributes_from_template(e,t){this._attribNamesToCopy.forEach((r,n)=>{let i=t.attribValue(r);new br(e,n).addAttribute(r,i)})}stampValue(e){return this.stampNode().value(e)}stampNode(){return this._stampNode=this._stampNode||this._createStampNode()}_createStampNode(){let e=new f6(this.scene());return this.dirtyController.setForbiddenTriggerNodes([e]),e}dispose(){super.dispose(),this._stampNode&&this._stampNode.dispose()}_initAccumulatedTransform(){let e=this.pv;this._transformMatrix=this._coreTransform.matrix(e.t,e.r,e.s,e.scale,Bc.XYZ),this._transformAccumulatedMatrix.identity()}_accumulateTransform(){this._transformAccumulatedMatrix.multiply(this._transformMatrix)}_applyAccumulatedTransform(e){this._applyMatrixToObjectOrGeometry(e,this._transformAccumulatedMatrix)}_applyMatrixToObjectOrGeometry(e,t){let r=oZ[this.pv.transformMode];switch(r){case 0:{this._applyMatrixToObject(e,t);return}case 1:{let n=e.geometry;n&&n.applyMatrix4(t);return}}Be.unreachable(r)}_applyMatrixToObject(e,t){e.matrix.multiply(t),e.matrix.decompose(e.position,e.quaternion,e.scale)}};var m6=class extends rt{constructor(){super(...arguments);this._requireDependency=!0}static requiredArguments(){return[["string","path to copy"],["integer","default value"]]}static optionalArguments(){return[["string","attribute name (optional)"]]}findDependency(e){let t=this.findReferencedGraphNode(e);if(t&&t.type()=="copy"){let r=t.stampNode();return this.createDependency(r,e)}return null}processArguments(e){return new Promise((t,r)=>{if(e.length>=1){let n=e[0],i=e[1]||0,s=e[2],a=this.node(),c=a?ut.findNode(a,n):null,l;c&&c.type()==Rh.type()&&(l=c.stampValue(s)),l==null&&(l=i),t(l)}else t(0)})}};var _6=class extends rt{constructor(){super(...arguments);this._requireDependency=!0,this._resolution=new z}static requiredArguments(){return[["string","path to node"],["string","component_name: x or y"]]}findDependency(e){return this.createDependencyFromIndexOrPath(e)}async processArguments(e){if(e.length==1||e.length==2){let t=e[0],r=e[1],n=await this.getReferencedNodeContainer(t);if(n){let i=n.resolution();if(r){if([0,"0","x"].includes(r))return i[0];if([1,"1","y"].includes(r))return i[1]}else return this._resolution.set(i[0],i[1]),this._resolution}}return-1}};var Un=class{static isChrome(){return navigator&&navigator.userAgent!=null&&navigator.userAgent.indexOf("Chrome")!=-1}static isMobile(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}static isiOS(){return/(iPad|iPhone|iPod)/g.test(navigator.userAgent)}static isAndroid(){return/(Android)/g.test(navigator.userAgent)}static isTouchDevice(){var e=document.createElement("div");return e.setAttribute("ongesturestart","return;"),typeof e.ongesturestart=="function"}};var g6=class extends rt{constructor(){super(...arguments);this._requireDependency=!0}static requiredArguments(){return[]}async processArguments(e){return new Promise(async(t,r)=>{t(Un.isMobile())})}};var v6=class extends rt{constructor(){super(...arguments);this._requireDependency=!0}static requiredArguments(){return[]}async processArguments(e){return new Promise(async(t,r)=>{t(Un.isTouchDevice())})}};var y6=class extends rt{static requiredArguments(){return[["string","javascript expression"]]}async processArguments(e){let t=0;if(e.length==1){let r=e[0];if(this._function=this._function||this._create_function(r),this._function)try{t=this._function(this.param.scene(),this.param.node,this.param)}catch(n){console.warn("expression error"),console.warn(n)}}return t}_create_function(e){return new Function("scene","node","param",`return ${e}`)}};var iO=3,x6=class extends rt{constructor(){super(...arguments);this._requireDependency=!0}static requiredArguments(){return[["string","path to node"],["string","attribute name"],["index","object index"]]}findDependency(e){return this.createDependencyFromIndexOrPath(e)}processArguments(e){return new Promise(async(t,r)=>{if(e.length==iO){let n=e[0],i=e[1],s=e[2],a=null;try{a=await this.getReferencedNodeContainer(n)}catch(c){r(c)}if(a){let c=this._get_value_from_container(a,i,s);t(c)}}else console.warn(`${e.length} given when expected ${iO}`),t(0)})}_get_value_from_container(e,t,r){let n=e.coreContent();if(n){let i=n.coreObjects()[r];return i?i.attribValue(t):0}else return null}};var b6=class extends rt{constructor(){super(...arguments);this._requireDependency=!0}static requiredArguments(){return[["string","path to node"]]}findDependency(e){return this.createDependencyFromIndexOrPath(e)}processArguments(e){return new Promise(async(t,r)=>{if(e.length==1){let n=e[0],i;try{i=await this.getReferencedNodeContainer(n)}catch(s){r(s);return}if(i){let s=i.objectsCount();t(s)}}else t(0)})}};var T6=class extends rt{constructor(){super(...arguments);this._requireDependency=!0}static requiredArguments(){return[["string","path to node"]]}findDependency(e){let t=this.findReferencedGraphNode(e);if(t){let r=t;if(r.nameController){let n=r.nameController.graph_node;return this.createDependency(n,e)}}return null}processArguments(e){return new Promise((t,r)=>{if(e.length==1){let n=e[0],i=this.getReferencedNode(n);if(i){let s=i.name(),a=Ve.tailDigits(s);t(a)}else t(0)}else t(0)})}};var A6=class extends rt{constructor(){super(...arguments);this._requireDependency=!0}static requiredArguments(){return[["string","path to node"]]}findDependency(e){let t=this.findReferencedGraphNode(e);if(t){let r=t;if(r.nameController){let n=r.nameController.graph_node;return this.createDependency(n,e)}}return null}processArguments(e){return new Promise((t,r)=>{if(e.length==1){let n=e[0],i=this.getReferencedNode(n);if(i){let s=i.name();t(s)}else t(0)}else t(0)})}};var C6=class extends rt{static requiredArguments(){return[["string","number"]]}processArguments(e){return new Promise(t=>{let r=e[0]||2,s=`${e[1]||0}`.padStart(r,"0");t(s)})}};var sO=3,E6=class extends rt{constructor(){super(...arguments);this._requireDependency=!0}static requiredArguments(){return[["string","path to node"],["string","attribute name"],["index","point index"]]}findDependency(e){return this.createDependencyFromIndexOrPath(e)}processArguments(e){return new Promise(async(t,r)=>{if(e.length==sO){let n=e[0],i=e[1],s=e[2],a=null;try{a=await this.getReferencedNodeContainer(n)}catch(c){r(c)}if(a){let c=this._get_value_from_container(a,i,s);t(c)}}else console.warn(`${e.length} given when expected ${sO}`),t(0)})}_get_value_from_container(e,t,r){let n=e.coreContent();if(n){let i=n.points()[r];return i?i.attribValue(t):0}else return null}};var S6=class extends rt{constructor(){super(...arguments);this._requireDependency=!0}static requiredArguments(){return[["string","path to node"]]}findDependency(e){return this.createDependencyFromIndexOrPath(e)}processArguments(e){return new Promise(async(t,r)=>{if(e.length==1){let n=e[0],i;try{i=await this.getReferencedNodeContainer(n)}catch(s){r(s);return}if(i){let s=i.pointsCount();t(s)}}else t(0)})}};var w6=class extends rt{static requiredArguments(){return[["string","string to count characters of"]]}async processArguments(e){let t=0;return e.length==1&&(t=e[0].length),t}};var M6=class extends rt{static requiredArguments(){return[]}async processArguments(e){let t="";for(let r of e)r==null&&(r=""),t+=`${r}`;return t}};var N6=class extends rt{static requiredArguments(){return[["string","string to get index from"],["string","char to find index of"]]}async processArguments(e){let t=-1;if(e.length==2){let r=e[0],n=e[1];t=r.indexOf(n)}return t}};function sZ(o){return o==null?"":K.isString(o)?o:`${o}`}function aO(o,e){return o==null?e:K.isNumber(o)?o:parseInt(o)}var O6=class extends rt{static requiredArguments(){return[["string","string to get range from"],["integer","range start"],["integer","range size"]]}async processArguments(e){let t="",r=sZ(e[0]),n=aO(e[1],0),i=aO(e[2],1);return r&&(t=r.substring(n,n+i)),t}};var P6=class extends rt{constructor(){super(...arguments);this._requireDependency=!0,this._windowSize=new z}static requiredArguments(){return[[]]}findDependency(e){return this.param.addGraphInput(this.param.scene().windowController.graphNode()),null}processArguments(e){return new Promise(t=>{this._windowSize.set(window.innerWidth,window.innerHeight),t(this._windowSize)})}};var R6=class{static run(e){e.expressionsRegister.register(c6,"arg"),e.expressionsRegister.register(l6,"argc"),e.expressionsRegister.register(u6,"bbox"),e.expressionsRegister.register(p6,"centroid"),e.expressionsRegister.register(d6,"ch"),e.expressionsRegister.register(m6,"copy"),e.expressionsRegister.register(_6,"copRes"),e.expressionsRegister.register(g6,"isDeviceMobile"),e.expressionsRegister.register(v6,"isDeviceTouch"),e.expressionsRegister.register(y6,"js"),e.expressionsRegister.register(x6,"object"),e.expressionsRegister.register(b6,"objectsCount"),e.expressionsRegister.register(T6,"opdigits"),e.expressionsRegister.register(A6,"opname"),e.expressionsRegister.register(C6,"padzero"),e.expressionsRegister.register(E6,"point"),e.expressionsRegister.register(S6,"pointsCount"),e.expressionsRegister.register(w6,"strCharsCount"),e.expressionsRegister.register(M6,"strConcat"),e.expressionsRegister.register(N6,"strIndex"),e.expressionsRegister.register(O6,"strSub"),e.expressionsRegister.register(P6,"windowSize")}};var C_="input animation clip",aZ=[C_,C_,C_,C_],bo=class extends fr{constructor(){super(...arguments);this.flags=new ah(this)}static context(){return oe.ANIM}static displayedInputNames(){return aZ}initializeBaseNode(){this.io.outputs.setHasOneOutput()}setTimelineBuilder(e){this._setContainer(e)}};var Qu=(o=>(o.NONE="none",o.POWER1="power1",o.POWER2="power2",o.POWER3="power3",o.POWER4="power4",o.BACK="back",o.ELASTIC="elastic",o.BOUNCE="bounce",o.SLOW="slow",o.STEPS="steps",o.CIRC="circ",o.EXPO="expo",o.SINE="sine",o))(Qu||{}),E_=["none","power1","power2","power3","power4","back","elastic","bounce","slow","steps","circ","expo","sine"],I6=(o=>(o.IN="in",o.OUT="out",o.IN_OUT="inOut",o))(I6||{}),S_=["in","out","inOut"];var w_=class{constructor(){this._propertiesMap=new Map}static instance(){return this._instance=this._instance||new w_}registerProp(e,t){this._propertiesMap.set(this._convert(e),t)}deRegisterProp(e){this._propertiesMap.delete(this._convert(e))}registeredTimelineForProperty(e){return this._propertiesMap.get(this._convert(e))}registeredPropertiesCount(){let e=0;return this._propertiesMap.forEach(()=>{e++}),e}_convert(e){if(e.object){let t=e;return`${t.object.uuid}:${t.propertyName}`}else return e}},Ih=w_.instance();var cO=class{constructor(e){this.param=e,this.proxyValue=e.value}update(e){if(e){let t=e.evaluate(this.proxyValue)[0];this.param.set(t)}else this.param.set(this.proxyValue)}},lO=class{constructor(e){this.param=e,this.proxyValue=e.value}update(){this.param.set(this.proxyValue)}},uO=class{constructor(e){this.param=e,this.proxyValue=new z,this._array=[0,0],this.proxyValue.copy(e.value)}update(){this.proxyValue.toArray(this._array),this.param.set(this._array)}},pO=class{constructor(e){this.param=e,this.proxyValue=new M,this._array=[0,0,0],this.proxyValue.copy(e.value)}update(){this.proxyValue.toArray(this._array),this.param.set(this._array)}},dO=class{constructor(e){this.param=e,this.proxyValue=new De,this._array=[0,0,0,0],this.proxyValue.copy(e.value)}update(){this.proxyValue.toArray(this._array),this.param.set(this._array)}},hO=class{constructor(e){this.param=e,this.proxyValue=new de,this._array=[0,0,0],this.proxyValue.copy(e.valuePreConversion())}update(){this.proxyValue.toArray(this._array),this.param.set(this._array)}},L6=class{constructor(e){this._map=new Map;let t=e.params.all;for(let r of t){let n=this._createParamProxy(r);n&&this._map.set(r,n)}}_createParamProxy(e){switch(e.type()){case J.INTEGER:return new lO(e);case J.FLOAT:return new cO(e);case J.VECTOR2:return new uO(e);case J.VECTOR3:return new pO(e);case J.COLOR:return new hO(e);case J.VECTOR4:return new dO(e)}}getParamProxy(e){return this._map.get(e)}};var M_=class{constructor(){this._map=new Map}static instance(){return this._instance=this._instance||new M_}nodeProxy(e){let t=this._map.get(e);if(t)return t;let r=new L6(e);return this._map.set(e,r),r}paramProxy(e){return this.nodeProxy(e.node).getParamProxy(e)}},ep=M_.instance();var fO=".",Dh=class{constructor(){this._debug=!1}setName(e){this._propertyName=e}setTargetValue(e){this._targetValue=e}name(){return this._propertyName}targetValue(){return this._targetValue}setDebug(e){this._debug=e}_printDebug(e){!this._debug||console.log(e)}clone(){let e=new Dh;if(this._propertyName&&e.setName(this._propertyName),this._targetValue!=null){let t=K.isNumber(this._targetValue)?this._targetValue:this._targetValue.clone();e.setTargetValue(t)}return e}addToTimeline(e){let{target:t}=e,r=t.objects(),n=t.node();this._printDebug(["addToTimeline",t,r,n]),r&&this._populateWithObjects(r,e),n&&this._populateWithNode(n,e)}_populateWithObjects(e,t){let{timelineBuilder:r}=t;if(this._printDebug(["_populateWithObjects",e]),!this._propertyName){Q.warn("no property name given");return}if(this._targetValue==null){Q.warn("no target value given");return}let n=r.operation(),i=r.updateCallback();for(let s of e){let a=this._sceneGraphProps(s,this._propertyName);if(a){let c={object:s,propertyName:this._propertyName},{targetProperty:l,toTarget:u,propertyNames:p}=a,d=this._commonVars(r);if(i&&i.updateMatrix()){let h=s.matrixAutoUpdate;d.onUpdate=()=>{s.matrixAutoUpdate=!0},d.onComplete=()=>{s.matrixAutoUpdate=h,s.matrixAutoUpdate||s.updateMatrix()}}if(l instanceof It&&this._targetValue instanceof It){let h={value:0},m=l,f=new It().copy(l),v=this._targetValue;d.onUpdate=()=>{m.slerpQuaternions(f,v,h.value)},u=h,d.value=1}if(K.isNumber(this._targetValue)){if(K.isNumber(l))for(let h of p)d[h]=this.withOp(l,this._targetValue,n)}else if(K.isVector(l)&&K.isVector(this._targetValue))for(let h of p)d[h]=this.withOp(l[h],this._targetValue[h],n);else if(K.isColor(l)&&K.isColor(this._targetValue))for(let h of p)d[h]=this.withOp(l[h],this._targetValue[h],n);u&&this._startTimeline({...t,vars:d,target:u,registerableProp:c})}}}_sceneGraphProps(e,t){let r=t.split(fO);if(r.length>1){let n=r.shift(),i=e[n];if(i){let s=r.join(fO);return this._sceneGraphProps(i,s)}else console.warn(`property ${n} not found on object`,e)}else{let n=e[t],i=null,s=[];return K.isNumber(n)?(i=e,s.push(t)):(i=n,this._targetValue instanceof z&&s.push("x","y"),this._targetValue instanceof M&&s.push("x","y","z"),this._targetValue instanceof De&&s.push("x","y","z","w"),this._targetValue instanceof de&&s.push("r","g","b"),this._targetValue instanceof It),{targetProperty:n,toTarget:i,propertyNames:s}}}_populateWithNode(e,t){this._printDebug(["_populateWithNode",e]);let r=e.p[this._propertyName];if(this._printDebug(["targetParam",r]),!r){Q.warn(`${this._propertyName} not found on node ${e.path()}`);return}r&&this._populateVarsForParam(r,t)}_populateVarsForParam(e,t){switch(this._printDebug(["_populateVarsForParam",e]),e.type()){case J.INTEGER:return this._populateVarsForParamInteger(e,t);case J.FLOAT:return this._populateVarsForParamFloat(e,t);case J.VECTOR2:return this._populateVarsForParamVector2(e,t);case J.VECTOR3:return this._populateVarsForParamVector3(e,t);case J.COLOR:return this._populateVarsForParamColor(e,t);case J.VECTOR4:return this._populateVarsForParamVector4(e,t)}Q.warn(`param type cannot be animated (yet): '${e.type()}' '${e.path()}'`)}_populateVarsForSingleNumericParam(e,t){if(!K.isNumber(this._targetValue)){Q.warn(`TimelineBuilderProperty error: cannot animate float/integer param '${e.path()}' with targetValue`,this._targetValue);return}let r=ep.paramProxy(e);if(!r)return;let n=t.timelineBuilder.keyframes(),i=n?n.createInterpolant():void 0,s=this._commonVars(t.timelineBuilder);s.onUpdate=()=>{r.update(i)};let a=this._targetValue;n&&(a=1);let c=t.timelineBuilder.operation();s.proxyValue=this.withOp(e.value,a,c),this._startTimeline({...t,vars:s,target:r,registerableProp:e})}_populateVarsForParamInteger(e,t){this._populateVarsForSingleNumericParam(e,t)}_populateVarsForParamFloat(e,t){this._populateVarsForSingleNumericParam(e,t)}_populateVarsForParamVector2(e,t){if(!(this._targetValue instanceof z)){Q.warn(`TimelineBuilderProperty error: cannot animate vector2 param '${e.path()}' with targetValue`,this._targetValue);return}let r=ep.paramProxy(e);if(!r)return;let n=this._commonVars(t.timelineBuilder);n.onUpdate=()=>{r.update()};let i=t.timelineBuilder.operation();n.x=this.withOp(e.value.x,this._targetValue.x,i),n.y=this.withOp(e.value.y,this._targetValue.y,i),this._startTimeline({...t,vars:n,target:r.proxyValue,registerableProp:e})}_populateVarsForParamVector3(e,t){if(!(this._targetValue instanceof M)){Q.warn(`TimelineBuilderProperty error: cannot animate vector3 param '${e.path()}' with targetValue`,this._targetValue);return}let r=ep.paramProxy(e);if(!r)return;let n=this._commonVars(t.timelineBuilder);n.onUpdate=()=>{r.update()};let i=t.timelineBuilder.operation();n.x=this.withOp(e.value.x,this._targetValue.x,i),n.y=this.withOp(e.value.y,this._targetValue.y,i),n.z=this.withOp(e.value.z,this._targetValue.z,i),this._startTimeline({...t,vars:n,target:r.proxyValue,registerableProp:e})}_populateVarsForParamVector4(e,t){if(!(this._targetValue instanceof De)){Q.warn(`TimelineBuilderProperty error: cannot animate vector4 param '${e.path()}' with targetValue`,this._targetValue);return}let r=ep.paramProxy(e);if(!r)return;let n=this._commonVars(t.timelineBuilder);n.onUpdate=()=>{r.update()};let i=t.timelineBuilder.operation();n.x=this.withOp(e.value.x,this._targetValue.x,i),n.y=this.withOp(e.value.y,this._targetValue.y,i),n.z=this.withOp(e.value.z,this._targetValue.z,i),n.w=this.withOp(e.value.w,this._targetValue.w,i),this._startTimeline({...t,vars:n,target:r.proxyValue,registerableProp:e})}_populateVarsForParamColor(e,t){if(!(this._targetValue instanceof de||this._targetValue instanceof M)){Q.warn(`TimelineBuilderProperty error: cannot animate color param '${e.path()}' with targetValue`,this._targetValue);return}let r=ep.paramProxy(e);if(!r)return;let n=this._commonVars(t.timelineBuilder);n.onUpdate=()=>{r.update()};let i=t.timelineBuilder.operation(),s=this._targetValue instanceof de?this._targetValue.r:this._targetValue.x,a=this._targetValue instanceof de?this._targetValue.g:this._targetValue.y,c=this._targetValue instanceof de?this._targetValue.b:this._targetValue.z;n.r=this.withOp(e.value.r,s,i),n.g=this.withOp(e.value.g,a,i),n.b=this.withOp(e.value.b,c,i),this._startTimeline({...t,vars:n,target:r.proxyValue,registerableProp:e})}withOp(e,t,r){switch(r){case Lh.SET:return t;case Lh.ADD:return e+t;case Lh.SUBTRACT:return e-t}Be.unreachable(r)}_commonVars(e){let r={duration:e.duration()},n=e.easing()||Qu.NONE;n&&(r.ease=n);let i=e.delay();i!=null&&(r.delay=i);let s=e.repeatParams();return s&&(r.repeat=s.count,r.repeatDelay=s.delay,r.yoyo=s.yoyo),r}_startTimeline(e){let{timelineBuilder:t,timeline:r,vars:n,target:i,registerableProp:s,registerproperties:a}=e,c=t.position(),l=c?c.toParameter():void 0,u=Ih.registeredTimelineForProperty(s),p=r.to(i,n,l),d=()=>{if(u)if(u.stoppable)u.timeline.kill(),Ih.deRegisterProp(s);else{p.kill();return}a&&Ih.registerProp(s,{timeline:p,stoppable:t.stoppable()})},h=()=>{Ih.deRegisterProp(s)};if(n.onStart){let m=n.onStart;n.onStart=()=>{d(),m()}}else n.onStart=d;if(n.onComplete){let m=n.onComplete;n.onComplete=()=>{h(),m()}}else n.onComplete=h}};function g0(o){if(o===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return o}function TO(o,e){o.prototype=Object.create(e.prototype),o.prototype.constructor=o,o.__proto__=e}var Ko={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},op={duration:.5,overwrite:!1,delay:0},$6,Ds=1e8,rr=1/Ds,G6=Math.PI*2,cZ=G6/4,lZ=0,AO=Math.sqrt,uZ=Math.cos,pZ=Math.sin,ho=function(e){return typeof e=="string"},po=function(e){return typeof e=="function"},y0=function(e){return typeof e=="number"},k_=function(e){return typeof e>"u"},x0=function(e){return typeof e=="object"},xn=function(e){return e!==!1},CO=function(){return typeof window<"u"},mO=function(e){return po(e)||ho(e)},EO=typeof ArrayBuffer=="function"&&ArrayBuffer.isView||function(){},Gn=Array.isArray,z6=/(?:-?\.?\d|\.)+/gi,K6=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,Uc=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,D6=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,J6=/[+-]=-?[.\d]+/,SO=/[^,'"\[\]\s]+/gi,dZ=/[\d.+\-=]+(?:e[-+]\d*)*/i,Tr,Is,H6,Z6,zn={},O_={},wO,MO=function(e){return(O_=ip(e,zn))&&di},B_=function(e,t){return console.warn("Invalid property",e,"set to",t,"Missing plugin? gsap.registerPlugin()")},P_=function(e,t){return!t&&console.warn(e)},NO=function(e,t){return e&&(zn[e]=t)&&O_&&(O_[e]=t)||zn},np=function(){return 0},Q6={},da=[],j6={},OO,yn={},k6={},_O=30,N_=[],e7="",t7=function(e){var t=e[0],r,n;if(x0(t)||po(t)||(e=[e]),!(r=(t._gsap||{}).harness)){for(n=N_.length;n--&&!N_[n].targetTest(t););r=N_[n]}for(n=e.length;n--;)e[n]&&(e[n]._gsap||(e[n]._gsap=new n7(e[n],r)))||e.splice(n,1);return e},ha=function(e){return e._gsap||t7(li(e))[0]._gsap},r7=function(e,t,r){return(r=e[t])&&po(r)?e[t]():k_(r)&&e.getAttribute&&e.getAttribute(t)||r},bn=function(e,t){return(e=e.split(",")).forEach(t)||e},Dr=function(e){return Math.round(e*1e5)/1e5||0},Bo=function(e){return Math.round(e*1e7)/1e7||0},hZ=function(e,t){for(var r=t.length,n=0;e.indexOf(t[n])<0&&++n<r;);return n<r},R_=function(){var e=da.length,t=da.slice(0),r,n;for(j6={},da.length=0,r=0;r<e;r++)n=t[r],n&&n._lazy&&(n.render(n._lazy[0],n._lazy[1],!0)._lazy=0)},PO=function(e,t,r,n){da.length&&R_(),e.render(t,r,n),da.length&&R_()},RO=function(e){var t=parseFloat(e);return(t||t===0)&&(e+"").match(SO).length<2?t:ho(e)?e.trim():e},IO=function(e){return e},pi=function(e,t){for(var r in t)r in e||(e[r]=t[r]);return e},fZ=function(e,t){for(var r in t)r in e||r==="duration"||r==="ease"||(e[r]=t[r])},ip=function(e,t){for(var r in t)e[r]=t[r];return e},gO=function o(e,t){for(var r in t)r!=="__proto__"&&r!=="constructor"&&r!=="prototype"&&(e[r]=x0(t[r])?o(e[r]||(e[r]={}),t[r]):t[r]);return e},W6=function(e,t){var r={},n;for(n in e)n in t||(r[n]=e[n]);return r},Fh=function(e){var t=e.parent||Tr,r=e.keyframes?fZ:pi;if(xn(e.inherit))for(;t;)r(e,t.vars.defaults),t=t.parent||t._dp;return e},mZ=function(e,t){for(var r=e.length,n=r===t.length;n&&r--&&e[r]===t[r];);return r<0},_Z=function(e,t,r,n,i){r===void 0&&(r="_first"),n===void 0&&(n="_last");var s=e[n],a;if(i)for(a=t[i];s&&s[i]>a;)s=s._prev;return s?(t._next=s._next,s._next=t):(t._next=e[r],e[r]=t),t._next?t._next._prev=t:e[n]=t,t._prev=s,t.parent=t._dp=e,t},F_=function(e,t,r,n){r===void 0&&(r="_first"),n===void 0&&(n="_last");var i=t._prev,s=t._next;i?i._next=s:e[r]===t&&(e[r]=s),s?s._prev=i:e[n]===t&&(e[n]=i),t._next=t._prev=t.parent=null},fa=function(e,t){e.parent&&(!t||e.parent.autoRemoveChildren)&&e.parent.remove(e),e._act=0},Fc=function(e,t){if(e&&(!t||t._end>e._dur||t._start<0))for(var r=e;r;)r._dirty=1,r=r.parent;return e},gZ=function(e){for(var t=e.parent;t&&t.parent;)t._dirty=1,t.totalDuration(),t=t.parent;return e},vZ=function o(e){return!e||e._ts&&o(e.parent)},vO=function(e){return e._repeat?sp(e._tTime,e=e.duration()+e._rDelay)*e:0},sp=function(e,t){var r=Math.floor(e/=t);return e&&r===e?r-1:r},I_=function(e,t){return(e-t._start)*t._ts+(t._ts>=0?0:t._dirty?t.totalDuration():t._tDur)},U_=function(e){return e._end=Bo(e._start+(e._tDur/Math.abs(e._ts||e._rts||rr)||0))},LO=function(e,t){var r=e._dp;return r&&r.smoothChildTiming&&e._ts&&(e._start=Bo(r._time-(e._ts>0?t/e._ts:((e._dirty?e.totalDuration():e._tDur)-t)/-e._ts)),U_(e),r._dirty||Fc(r,e)),e},DO=function(e,t){var r;if((t._time||t._initted&&!t._dur)&&(r=I_(e.rawTime(),t),(!t._dur||zh(0,t.totalDuration(),r)-t._tTime>rr)&&t.render(r,!0)),Fc(e,t)._dp&&e._initted&&e._time>=e._dur&&e._ts){if(e._dur<e.duration())for(r=e;r._dp;)r.rawTime()>=0&&r.totalTime(r._tTime),r=r._dp;e._zTime=-rr}},Ls=function(e,t,r,n){return t.parent&&fa(t),t._start=Bo((y0(r)?r:r||e!==Tr?ci(e,r,t):e._time)+t._delay),t._end=Bo(t._start+(t.totalDuration()/Math.abs(t.timeScale())||0)),_Z(e,t,"_first","_last",e._sort?"_start":0),q6(t)||(e._recent=t),n||DO(e,t),e},kO=function(e,t){return(zn.ScrollTrigger||B_("scrollTrigger",t))&&zn.ScrollTrigger.create(t,e)},BO=function(e,t,r,n){if(GZ(e,t),!e._initted)return 1;if(!r&&e._pt&&(e._dur&&e.vars.lazy!==!1||!e._dur&&e.vars.lazy)&&OO!==Vn.frame)return da.push(e),e._lazy=[t,n],1},yZ=function o(e){var t=e.parent;return t&&t._ts&&t._initted&&!t._lock&&(t.rawTime()<0||o(t))},q6=function(e){var t=e.data;return t==="isFromStart"||t==="isStart"},xZ=function(e,t,r,n){var i=e.ratio,s=t<0||!t&&(!e._start&&yZ(e)&&!(!e._initted&&q6(e))||(e._ts<0||e._dp._ts<0)&&!q6(e))?0:1,a=e._rDelay,c=0,l,u,p;if(a&&e._repeat&&(c=zh(0,e._tDur,t),u=sp(c,a),p=sp(e._tTime,a),e._yoyo&&u&1&&(s=1-s),u!==p&&(i=1-s,e.vars.repeatRefresh&&e._initted&&e.invalidate())),s!==i||n||e._zTime===rr||!t&&e._zTime){if(!e._initted&&BO(e,t,n,r))return;for(p=e._zTime,e._zTime=t||(r?rr:0),r||(r=t&&!p),e.ratio=s,e._from&&(s=1-s),e._time=0,e._tTime=c,l=e._pt;l;)l.r(s,l.d),l=l._next;e._startAt&&t<0&&e._startAt.render(t,!0,!0),e._onUpdate&&!r&&ui(e,"onUpdate"),c&&e._repeat&&!r&&e.parent&&ui(e,"onRepeat"),(t>=e._tDur||t<0)&&e.ratio===s&&(s&&fa(e,1),r||(ui(e,s?"onComplete":"onReverseComplete",!0),e._prom&&e._prom()))}else e._zTime||(e._zTime=t)},bZ=function(e,t,r){var n;if(r>t)for(n=e._first;n&&n._start<=r;){if(!n._dur&&n.data==="isPause"&&n._start>t)return n;n=n._next}else for(n=e._last;n&&n._start>=r;){if(!n._dur&&n.data==="isPause"&&n._start<t)return n;n=n._prev}},ap=function(e,t,r,n){var i=e._repeat,s=Bo(t)||0,a=e._tTime/e._tDur;return a&&!n&&(e._time*=s/e._dur),e._dur=s,e._tDur=i?i<0?1e10:Bo(s*(i+1)+e._rDelay*i):s,a&&!n?LO(e,e._tTime=e._tDur*a):e.parent&&U_(e),r||Fc(e.parent,e),e},yO=function(e){return e instanceof Fo?Fc(e):ap(e,e._dur)},TZ={_start:0,endTime:np,totalDuration:np},ci=function o(e,t,r){var n=e.labels,i=e._recent||TZ,s=e.duration()>=Ds?i.endTime(!1):e._dur,a,c,l;return ho(t)&&(isNaN(t)||t in n)?(c=t.charAt(0),l=t.substr(-1)==="%",a=t.indexOf("="),c==="<"||c===">"?(a>=0&&(t=t.replace(/=/,"")),(c==="<"?i._start:i.endTime(i._repeat>=0))+(parseFloat(t.substr(1))||0)*(l?(a<0?i:r).totalDuration()/100:1)):a<0?(t in n||(n[t]=s),n[t]):(c=parseFloat(t.charAt(a-1)+t.substr(a+1)),l&&r&&(c=c/100*(Gn(r)?r[0]:r).totalDuration()),a>1?o(e,t.substr(0,a-1),r)+c:s+c)):t==null?s:+t},Uh=function(e,t,r){var n=y0(t[1]),i=(n?2:1)+(e<2?0:1),s=t[i],a,c;if(n&&(s.duration=t[1]),s.parent=r,e){for(a=s,c=r;c&&!("immediateRender"in a);)a=c.vars.defaults||{},c=xn(c.vars.inherit)&&c.parent;s.immediateRender=xn(a.immediateRender),e<2?s.runBackwards=1:s.startAt=t[i-1]}return new Jr(t[0],s,t[i+1])},ma=function(e,t){return e||e===0?t(e):t},zh=function(e,t,r){return r<e?e:r>t?t:r},Tn=function(e){if(typeof e!="string")return"";var t=dZ.exec(e);return t?e.substr(t.index+t[0].length):""},AZ=function(e,t,r){return ma(r,function(n){return zh(e,t,n)})},X6=[].slice,FO=function(e,t){return e&&x0(e)&&"length"in e&&(!t&&!e.length||e.length-1 in e&&x0(e[0]))&&!e.nodeType&&e!==Is},CZ=function(e,t,r){return r===void 0&&(r=[]),e.forEach(function(n){var i;return ho(n)&&!t||FO(n,1)?(i=r).push.apply(i,li(n)):r.push(n)})||r},li=function(e,t,r){return ho(e)&&!r&&(H6||!cp())?X6.call((t||Z6).querySelectorAll(e),0):Gn(e)?CZ(e,r):FO(e)?X6.call(e,0):e?[e]:[]},EZ=function(e){return e=li(e)[0]||P_("Invalid scope")||{},function(t){var r=e.current||e.nativeElement||e;return li(t,r.querySelectorAll?r:r===e?P_("Invalid scope")||Z6.createElement("div"):e)}},UO=function(e){return e.sort(function(){return .5-Math.random()})},VO=function(e){if(po(e))return e;var t=x0(e)?e:{each:e},r=rp(t.ease),n=t.from||0,i=parseFloat(t.base)||0,s={},a=n>0&&n<1,c=isNaN(n)||a,l=t.axis,u=n,p=n;return ho(n)?u=p={center:.5,edges:.5,end:1}[n]||0:!a&&c&&(u=n[0],p=n[1]),function(d,h,m){var f=(m||t).length,v=s[f],g,_,T,b,x,A,E,S,w;if(!v){if(w=t.grid==="auto"?0:(t.grid||[1,Ds])[1],!w){for(E=-Ds;E<(E=m[w++].getBoundingClientRect().left)&&w<f;);w--}for(v=s[f]=[],g=c?Math.min(w,f)*u-.5:n%w,_=c?f*p/w-.5:n/w|0,E=0,S=Ds,A=0;A<f;A++)T=A%w-g,b=_-(A/w|0),v[A]=x=l?Math.abs(l==="y"?b:T):AO(T*T+b*b),x>E&&(E=x),x<S&&(S=x);n==="random"&&UO(v),v.max=E-S,v.min=S,v.v=f=(parseFloat(t.amount)||parseFloat(t.each)*(w>f?f-1:l?l==="y"?f/w:w:Math.max(w,f/w))||0)*(n==="edges"?-1:1),v.b=f<0?i-f:i,v.u=Tn(t.amount||t.each)||0,r=r&&f<0?XO(r):r}return f=(v[d]-v.min)/v.max||0,Bo(v.b+(r?r(f):f)*v.v)+v.u}},Y6=function(e){var t=Math.pow(10,((e+"").split(".")[1]||"").length);return function(r){var n=Math.round(parseFloat(r)/e)*e*t;return(n-n%1)/t+(y0(r)?0:Tn(r))}},GO=function(e,t){var r=Gn(e),n,i;return!r&&x0(e)&&(n=r=e.radius||Ds,e.values?(e=li(e.values),(i=!y0(e[0]))&&(n*=n)):e=Y6(e.increment)),ma(t,r?po(e)?function(s){return i=e(s),Math.abs(i-s)<=n?i:s}:function(s){for(var a=parseFloat(i?s.x:s),c=parseFloat(i?s.y:0),l=Ds,u=0,p=e.length,d,h;p--;)i?(d=e[p].x-a,h=e[p].y-c,d=d*d+h*h):d=Math.abs(e[p]-a),d<l&&(l=d,u=p);return u=!n||l<=n?e[u]:s,i||u===s||y0(s)?u:u+Tn(s)}:Y6(e))},zO=function(e,t,r,n){return ma(Gn(e)?!t:r===!0?!!(r=0):!n,function(){return Gn(e)?e[~~(Math.random()*e.length)]:(r=r||1e-5)&&(n=r<1?Math.pow(10,(r+"").length-2):1)&&Math.floor(Math.round((e-r/2+Math.random()*(t-e+r*.99))/r)*r*n)/n})},SZ=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(n){return t.reduce(function(i,s){return s(i)},n)}},wZ=function(e,t){return function(r){return e(parseFloat(r))+(t||Tn(r))}},MZ=function(e,t,r){return jO(e,t,0,1,r)},HO=function(e,t,r){return ma(r,function(n){return e[~~t(n)]})},NZ=function o(e,t,r){var n=t-e;return Gn(e)?HO(e,o(0,e.length),t):ma(r,function(i){return(n+(i-e)%n)%n+e})},OZ=function o(e,t,r){var n=t-e,i=n*2;return Gn(e)?HO(e,o(0,e.length-1),t):ma(r,function(s){return s=(i+(s-e)%i)%i||0,e+(s>n?i-s:s)})},lp=function(e){for(var t=0,r="",n,i,s,a;~(n=e.indexOf("random(",t));)s=e.indexOf(")",n),a=e.charAt(n+7)==="[",i=e.substr(n+7,s-n-7).match(a?SO:z6),r+=e.substr(t,n-t)+zO(a?i:+i[0],a?0:+i[1],+i[2]||1e-5),t=s+1;return r+e.substr(t,e.length-t)},jO=function(e,t,r,n,i){var s=t-e,a=n-r;return ma(i,function(c){return r+((c-e)/s*a||0)})},PZ=function o(e,t,r,n){var i=isNaN(e+t)?0:function(h){return(1-h)*e+h*t};if(!i){var s=ho(e),a={},c,l,u,p,d;if(r===!0&&(n=1)&&(r=null),s)e={p:e},t={p:t};else if(Gn(e)&&!Gn(t)){for(u=[],p=e.length,d=p-2,l=1;l<p;l++)u.push(o(e[l-1],e[l]));p--,i=function(m){m*=p;var f=Math.min(d,~~m);return u[f](m-f)},r=t}else n||(e=ip(Gn(e)?[]:{},e));if(!u){for(c in t)i7.call(a,e,c,"get",t[c]);i=function(m){return l7(m,a)||(s?e.p:e)}}}return ma(r,i)},xO=function(e,t,r){var n=e.labels,i=Ds,s,a,c;for(s in n)a=n[s]-t,a<0==!!r&&a&&i>(a=Math.abs(a))&&(c=s,i=a);return c},ui=function(e,t,r){var n=e.vars,i=n[t],s,a;if(!!i)return s=n[t+"Params"],a=n.callbackScope||e,r&&da.length&&R_(),s?i.apply(a,s):i.call(a)},kh=function(e){return fa(e),e.scrollTrigger&&e.scrollTrigger.kill(!1),e.progress()<1&&ui(e,"onInterrupt"),e},tp,RZ=function(e){e=!e.name&&e.default||e;var t=e.name,r=po(e),n=t&&!r&&e.init?function(){this._props=[]}:e,i={init:np,render:l7,add:i7,kill:YZ,modifier:XZ,rawVars:0},s={targetTest:0,get:0,getSetter:V_,aliases:{},register:0};if(cp(),e!==n){if(yn[t])return;pi(n,pi(W6(e,i),s)),ip(n.prototype,ip(i,W6(e,s))),yn[n.prop=t]=n,e.targetTest&&(N_.push(n),Q6[t]=1),t=(t==="css"?"CSS":t.charAt(0).toUpperCase()+t.substr(1))+"Plugin"}NO(t,n),e.register&&e.register(di,n,Jo)},tr=255,Bh={aqua:[0,tr,tr],lime:[0,tr,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,tr],navy:[0,0,128],white:[tr,tr,tr],olive:[128,128,0],yellow:[tr,tr,0],orange:[tr,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[tr,0,0],pink:[tr,192,203],cyan:[0,tr,tr],transparent:[tr,tr,tr,0]},B6=function(e,t,r){return e=e<0?e+1:e>1?e-1:e,(e*6<1?t+(r-t)*e*6:e<.5?r:e*3<2?t+(r-t)*(2/3-e)*6:t)*tr+.5|0},WO=function(e,t,r){var n=e?y0(e)?[e>>16,e>>8&tr,e&tr]:0:Bh.black,i,s,a,c,l,u,p,d,h,m;if(!n){if(e.substr(-1)===","&&(e=e.substr(0,e.length-1)),Bh[e])n=Bh[e];else if(e.charAt(0)==="#"){if(e.length<6&&(i=e.charAt(1),s=e.charAt(2),a=e.charAt(3),e="#"+i+i+s+s+a+a+(e.length===5?e.charAt(4)+e.charAt(4):"")),e.length===9)return n=parseInt(e.substr(1,6),16),[n>>16,n>>8&tr,n&tr,parseInt(e.substr(7),16)/255];e=parseInt(e.substr(1),16),n=[e>>16,e>>8&tr,e&tr]}else if(e.substr(0,3)==="hsl"){if(n=m=e.match(z6),!t)c=+n[0]%360/360,l=+n[1]/100,u=+n[2]/100,s=u<=.5?u*(l+1):u+l-u*l,i=u*2-s,n.length>3&&(n[3]*=1),n[0]=B6(c+1/3,i,s),n[1]=B6(c,i,s),n[2]=B6(c-1/3,i,s);else if(~e.indexOf("="))return n=e.match(K6),r&&n.length<4&&(n[3]=1),n}else n=e.match(z6)||Bh.transparent;n=n.map(Number)}return t&&!m&&(i=n[0]/tr,s=n[1]/tr,a=n[2]/tr,p=Math.max(i,s,a),d=Math.min(i,s,a),u=(p+d)/2,p===d?c=l=0:(h=p-d,l=u>.5?h/(2-p-d):h/(p+d),c=p===i?(s-a)/h+(s<a?6:0):p===s?(a-i)/h+2:(i-s)/h+4,c*=60),n[0]=~~(c+.5),n[1]=~~(l*100+.5),n[2]=~~(u*100+.5)),r&&n.length<4&&(n[3]=1),n},qO=function(e){var t=[],r=[],n=-1;return e.split(v0).forEach(function(i){var s=i.match(Uc)||[];t.push.apply(t,s),r.push(n+=s.length+1)}),t.c=r,t},bO=function(e,t,r){var n="",i=(e+n).match(v0),s=t?"hsla(":"rgba(",a=0,c,l,u,p;if(!i)return e;if(i=i.map(function(d){return(d=WO(d,t,1))&&s+(t?d[0]+","+d[1]+"%,"+d[2]+"%,"+d[3]:d.join(","))+")"}),r&&(u=qO(e),c=r.c,c.join(n)!==u.c.join(n)))for(l=e.replace(v0,"1").split(Uc),p=l.length-1;a<p;a++)n+=l[a]+(~c.indexOf(a)?i.shift()||s+"0,0,0,0)":(u.length?u:i.length?i:r).shift());if(!l)for(l=e.split(v0),p=l.length-1;a<p;a++)n+=l[a]+i[a];return n+l[p]},v0=function(){var o="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b",e;for(e in Bh)o+="|"+e+"\\b";return new RegExp(o+")","gi")}(),IZ=/hsl[a]?\(/,o7=function(e){var t=e.join(" "),r;if(v0.lastIndex=0,v0.test(t))return r=IZ.test(t),e[1]=bO(e[1],r),e[0]=bO(e[0],r,qO(e[1])),!0},L_,Vn=function(){var o=Date.now,e=500,t=33,r=o(),n=r,i=1e3/240,s=i,a=[],c,l,u,p,d,h,m=function f(v){var g=o()-n,_=v===!0,T,b,x,A;if(g>e&&(r+=g-t),n+=g,x=n-r,T=x-s,(T>0||_)&&(A=++p.frame,d=x-p.time*1e3,p.time=x=x/1e3,s+=T+(T>=i?4:i-T),b=1),_||(c=l(f)),b)for(h=0;h<a.length;h++)a[h](x,d,A,v)};return p={time:0,frame:0,tick:function(){m(!0)},deltaRatio:function(v){return d/(1e3/(v||60))},wake:function(){wO&&(!H6&&CO()&&(Is=H6=window,Z6=Is.document||{},zn.gsap=di,(Is.gsapVersions||(Is.gsapVersions=[])).push(di.version),MO(O_||Is.GreenSockGlobals||!Is.gsap&&Is||{}),u=Is.requestAnimationFrame),c&&p.sleep(),l=u||function(v){return setTimeout(v,s-p.time*1e3+1|0)},L_=1,m(2))},sleep:function(){(u?Is.cancelAnimationFrame:clearTimeout)(c),L_=0,l=np},lagSmoothing:function(v,g){e=v||1/rr,t=Math.min(g,e,0)},fps:function(v){i=1e3/(v||240),s=p.time*1e3+i},add:function(v){a.indexOf(v)<0&&a.push(v),cp()},remove:function(v){var g;~(g=a.indexOf(v))&&a.splice(g,1)&&h>=g&&h--},_listeners:a},p}(),cp=function(){return!L_&&Vn.wake()},St={},LZ=/^[\d.\-M][\d.\-,\s]/,DZ=/["']/g,kZ=function(e){for(var t={},r=e.substr(1,e.length-3).split(":"),n=r[0],i=1,s=r.length,a,c,l;i<s;i++)c=r[i],a=i!==s-1?c.lastIndexOf(","):c.length,l=c.substr(0,a),t[n]=isNaN(l)?l.replace(DZ,"").trim():+l,n=c.substr(a+1).trim();return t},BZ=function(e){var t=e.indexOf("(")+1,r=e.indexOf(")"),n=e.indexOf("(",t);return e.substring(t,~n&&n<r?e.indexOf(")",r+1):r)},FZ=function(e){var t=(e+"").split("("),r=St[t[0]];return r&&t.length>1&&r.config?r.config.apply(null,~e.indexOf("{")?[kZ(t[1])]:BZ(e).split(",").map(RO)):St._CE&&LZ.test(e)?St._CE("",e):r},XO=function(e){return function(t){return 1-e(1-t)}},YO=function o(e,t){for(var r=e._first,n;r;)r instanceof Fo?o(r,t):r.vars.yoyoEase&&(!r._yoyo||!r._repeat)&&r._yoyo!==t&&(r.timeline?o(r.timeline,t):(n=r._ease,r._ease=r._yEase,r._yEase=n,r._yoyo=t)),r=r._next},rp=function(e,t){return e&&(po(e)?e:St[e]||FZ(e))||t},Vc=function(e,t,r,n){r===void 0&&(r=function(c){return 1-t(1-c)}),n===void 0&&(n=function(c){return c<.5?t(c*2)/2:1-t((1-c)*2)/2});var i={easeIn:t,easeOut:r,easeInOut:n},s;return bn(e,function(a){St[a]=zn[a]=i,St[s=a.toLowerCase()]=r;for(var c in i)St[s+(c==="easeIn"?".in":c==="easeOut"?".out":".inOut")]=St[a+"."+c]=i[c]}),i},$O=function(e){return function(t){return t<.5?(1-e(1-t*2))/2:.5+e((t-.5)*2)/2}},F6=function o(e,t,r){var n=t>=1?t:1,i=(r||(e?.3:.45))/(t<1?t:1),s=i/G6*(Math.asin(1/n)||0),a=function(u){return u===1?1:n*Math.pow(2,-10*u)*pZ((u-s)*i)+1},c=e==="out"?a:e==="in"?function(l){return 1-a(1-l)}:$O(a);return i=G6/i,c.config=function(l,u){return o(e,l,u)},c},U6=function o(e,t){t===void 0&&(t=1.70158);var r=function(s){return s?--s*s*((t+1)*s+t)+1:0},n=e==="out"?r:e==="in"?function(i){return 1-r(1-i)}:$O(r);return n.config=function(i){return o(e,i)},n};bn("Linear,Quad,Cubic,Quart,Quint,Strong",function(o,e){var t=e<5?e+1:e;Vc(o+",Power"+(t-1),e?function(r){return Math.pow(r,t)}:function(r){return r},function(r){return 1-Math.pow(1-r,t)},function(r){return r<.5?Math.pow(r*2,t)/2:1-Math.pow((1-r)*2,t)/2})});St.Linear.easeNone=St.none=St.Linear.easeIn;Vc("Elastic",F6("in"),F6("out"),F6());(function(o,e){var t=1/e,r=2*t,n=2.5*t,i=function(a){return a<t?o*a*a:a<r?o*Math.pow(a-1.5/e,2)+.75:a<n?o*(a-=2.25/e)*a+.9375:o*Math.pow(a-2.625/e,2)+.984375};Vc("Bounce",function(s){return 1-i(1-s)},i)})(7.5625,2.75);Vc("Expo",function(o){return o?Math.pow(2,10*(o-1)):0});Vc("Circ",function(o){return-(AO(1-o*o)-1)});Vc("Sine",function(o){return o===1?1:-uZ(o*cZ)+1});Vc("Back",U6("in"),U6("out"),U6());St.SteppedEase=St.steps=zn.SteppedEase={config:function(e,t){e===void 0&&(e=1);var r=1/e,n=e+(t?0:1),i=t?1:0,s=1-rr;return function(a){return((n*zh(0,s,a)|0)+i)*r}}};op.ease=St["quad.out"];bn("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",function(o){return e7+=o+","+o+"Params,"});var n7=function(e,t){this.id=lZ++,e._gsap=this,this.target=e,this.harness=t,this.get=t?t.get:r7,this.set=t?t.getSetter:V_},Gh=function(){function o(t){this.vars=t,this._delay=+t.delay||0,(this._repeat=t.repeat===1/0?-2:t.repeat||0)&&(this._rDelay=t.repeatDelay||0,this._yoyo=!!t.yoyo||!!t.yoyoEase),this._ts=1,ap(this,+t.duration,1,1),this.data=t.data,L_||Vn.wake()}var e=o.prototype;return e.delay=function(r){return r||r===0?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+r-this._delay),this._delay=r,this):this._delay},e.duration=function(r){return arguments.length?this.totalDuration(this._repeat>0?r+(r+this._rDelay)*this._repeat:r):this.totalDuration()&&this._dur},e.totalDuration=function(r){return arguments.length?(this._dirty=0,ap(this,this._repeat<0?r:(r-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},e.totalTime=function(r,n){if(cp(),!arguments.length)return this._tTime;var i=this._dp;if(i&&i.smoothChildTiming&&this._ts){for(LO(this,r),!i._dp||i.parent||DO(i,this);i&&i.parent;)i.parent._time!==i._start+(i._ts>=0?i._tTime/i._ts:(i.totalDuration()-i._tTime)/-i._ts)&&i.totalTime(i._tTime,!0),i=i.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&r<this._tDur||this._ts<0&&r>0||!this._tDur&&!r)&&Ls(this._dp,this,this._start-this._delay)}return(this._tTime!==r||!this._dur&&!n||this._initted&&Math.abs(this._zTime)===rr||!r&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=r),PO(this,r,n)),this},e.time=function(r,n){return arguments.length?this.totalTime(Math.min(this.totalDuration(),r+vO(this))%(this._dur+this._rDelay)||(r?this._dur:0),n):this._time},e.totalProgress=function(r,n){return arguments.length?this.totalTime(this.totalDuration()*r,n):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.ratio},e.progress=function(r,n){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&!(this.iteration()&1)?1-r:r)+vO(this),n):this.duration()?Math.min(1,this._time/this._dur):this.ratio},e.iteration=function(r,n){var i=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(r-1)*i,n):this._repeat?sp(this._tTime,i)+1:1},e.timeScale=function(r){if(!arguments.length)return this._rts===-rr?0:this._rts;if(this._rts===r)return this;var n=this.parent&&this._ts?I_(this.parent._time,this):this._tTime;return this._rts=+r||0,this._ts=this._ps||r===-rr?0:this._rts,gZ(this.totalTime(zh(-this._delay,this._tDur,n),!0)),U_(this),this},e.paused=function(r){return arguments.length?(this._ps!==r&&(this._ps=r,r?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(cp(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,this.progress()===1&&Math.abs(this._zTime)!==rr&&(this._tTime-=rr)))),this):this._ps},e.startTime=function(r){if(arguments.length){this._start=r;var n=this.parent||this._dp;return n&&(n._sort||!this.parent)&&Ls(n,this,r-this._delay),this}return this._start},e.endTime=function(r){return this._start+(xn(r)?this.totalDuration():this.duration())/Math.abs(this._ts||1)},e.rawTime=function(r){var n=this.parent||this._dp;return n?r&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?I_(n.rawTime(r),this):this._tTime:this._tTime},e.globalTime=function(r){for(var n=this,i=arguments.length?r:n.rawTime();n;)i=n._start+i/(n._ts||1),n=n._dp;return i},e.repeat=function(r){return arguments.length?(this._repeat=r===1/0?-2:r,yO(this)):this._repeat===-2?1/0:this._repeat},e.repeatDelay=function(r){if(arguments.length){var n=this._time;return this._rDelay=r,yO(this),n?this.time(n):this}return this._rDelay},e.yoyo=function(r){return arguments.length?(this._yoyo=r,this):this._yoyo},e.seek=function(r,n){return this.totalTime(ci(this,r),xn(n))},e.restart=function(r,n){return this.play().totalTime(r?-this._delay:0,xn(n))},e.play=function(r,n){return r!=null&&this.seek(r,n),this.reversed(!1).paused(!1)},e.reverse=function(r,n){return r!=null&&this.seek(r||this.totalDuration(),n),this.reversed(!0).paused(!1)},e.pause=function(r,n){return r!=null&&this.seek(r,n),this.paused(!0)},e.resume=function(){return this.paused(!1)},e.reversed=function(r){return arguments.length?(!!r!==this.reversed()&&this.timeScale(-this._rts||(r?-rr:0)),this):this._rts<0},e.invalidate=function(){return this._initted=this._act=0,this._zTime=-rr,this},e.isActive=function(){var r=this.parent||this._dp,n=this._start,i;return!!(!r||this._ts&&this._initted&&r.isActive()&&(i=r.rawTime(!0))>=n&&i<this.endTime(!0)-rr)},e.eventCallback=function(r,n,i){var s=this.vars;return arguments.length>1?(n?(s[r]=n,i&&(s[r+"Params"]=i),r==="onUpdate"&&(this._onUpdate=n)):delete s[r],this):s[r]},e.then=function(r){var n=this;return new Promise(function(i){var s=po(r)?r:IO,a=function(){var l=n.then;n.then=null,po(s)&&(s=s(n))&&(s.then||s===n)&&(n.then=l),i(s),n.then=l};n._initted&&n.totalProgress()===1&&n._ts>=0||!n._tTime&&n._ts<0?a():n._prom=a})},e.kill=function(){kh(this)},o}();pi(Gh.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-rr,_prom:0,_ps:!1,_rts:1});var Fo=function(o){TO(e,o);function e(r,n){var i;return r===void 0&&(r={}),i=o.call(this,r)||this,i.labels={},i.smoothChildTiming=!!r.smoothChildTiming,i.autoRemoveChildren=!!r.autoRemoveChildren,i._sort=xn(r.sortChildren),Tr&&Ls(r.parent||Tr,g0(i),n),r.reversed&&i.reverse(),r.paused&&i.paused(!0),r.scrollTrigger&&kO(g0(i),r.scrollTrigger),i}var t=e.prototype;return t.to=function(n,i,s){return Uh(0,arguments,this),this},t.from=function(n,i,s){return Uh(1,arguments,this),this},t.fromTo=function(n,i,s,a){return Uh(2,arguments,this),this},t.set=function(n,i,s){return i.duration=0,i.parent=this,Fh(i).repeatDelay||(i.repeat=0),i.immediateRender=!!i.immediateRender,new Jr(n,i,ci(this,s),1),this},t.call=function(n,i,s){return Ls(this,Jr.delayedCall(0,n,i),s)},t.staggerTo=function(n,i,s,a,c,l,u){return s.duration=i,s.stagger=s.stagger||a,s.onComplete=l,s.onCompleteParams=u,s.parent=this,new Jr(n,s,ci(this,c)),this},t.staggerFrom=function(n,i,s,a,c,l,u){return s.runBackwards=1,Fh(s).immediateRender=xn(s.immediateRender),this.staggerTo(n,i,s,a,c,l,u)},t.staggerFromTo=function(n,i,s,a,c,l,u,p){return a.startAt=s,Fh(a).immediateRender=xn(a.immediateRender),this.staggerTo(n,i,a,c,l,u,p)},t.render=function(n,i,s){var a=this._time,c=this._dirty?this.totalDuration():this._tDur,l=this._dur,u=n<=0?0:Bo(n),p=this._zTime<0!=n<0&&(this._initted||!l),d,h,m,f,v,g,_,T,b,x,A,E;if(this!==Tr&&u>c&&n>=0&&(u=c),u!==this._tTime||s||p){if(a!==this._time&&l&&(u+=this._time-a,n+=this._time-a),d=u,b=this._start,T=this._ts,g=!T,p&&(l||(a=this._zTime),(n||!i)&&(this._zTime=n)),this._repeat){if(A=this._yoyo,v=l+this._rDelay,this._repeat<-1&&n<0)return this.totalTime(v*100+n,i,s);if(d=Bo(u%v),u===c?(f=this._repeat,d=l):(f=~~(u/v),f&&f===u/v&&(d=l,f--),d>l&&(d=l)),x=sp(this._tTime,v),!a&&this._tTime&&x!==f&&(x=f),A&&f&1&&(d=l-d,E=1),f!==x&&!this._lock){var S=A&&x&1,w=S===(A&&f&1);if(f<x&&(S=!S),a=S?0:l,this._lock=1,this.render(a||(E?0:Bo(f*v)),i,!l)._lock=0,this._tTime=u,!i&&this.parent&&ui(this,"onRepeat"),this.vars.repeatRefresh&&!E&&(this.invalidate()._lock=1),a&&a!==this._time||g!==!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(l=this._dur,c=this._tDur,w&&(this._lock=2,a=S?l:-1e-4,this.render(a,!0),this.vars.repeatRefresh&&!E&&this.invalidate()),this._lock=0,!this._ts&&!g)return this;YO(this,E)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(_=bZ(this,Bo(a),Bo(d)),_&&(u-=d-(d=_._start))),this._tTime=u,this._time=d,this._act=!T,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=n,a=0),!a&&d&&!i&&(ui(this,"onStart"),this._tTime!==u))return this;if(d>=a&&n>=0)for(h=this._first;h;){if(m=h._next,(h._act||d>=h._start)&&h._ts&&_!==h){if(h.parent!==this)return this.render(n,i,s);if(h.render(h._ts>0?(d-h._start)*h._ts:(h._dirty?h.totalDuration():h._tDur)+(d-h._start)*h._ts,i,s),d!==this._time||!this._ts&&!g){_=0,m&&(u+=this._zTime=-rr);break}}h=m}else{h=this._last;for(var O=n<0?n:d;h;){if(m=h._prev,(h._act||O<=h._end)&&h._ts&&_!==h){if(h.parent!==this)return this.render(n,i,s);if(h.render(h._ts>0?(O-h._start)*h._ts:(h._dirty?h.totalDuration():h._tDur)+(O-h._start)*h._ts,i,s),d!==this._time||!this._ts&&!g){_=0,m&&(u+=this._zTime=O?-rr:rr);break}}h=m}}if(_&&!i&&(this.pause(),_.render(d>=a?0:-rr)._zTime=d>=a?1:-1,this._ts))return this._start=b,U_(this),this.render(n,i,s);this._onUpdate&&!i&&ui(this,"onUpdate",!0),(u===c&&c>=this.totalDuration()||!u&&a)&&(b===this._start||Math.abs(T)!==Math.abs(this._ts))&&(this._lock||((n||!l)&&(u===c&&this._ts>0||!u&&this._ts<0)&&fa(this,1),!i&&!(n<0&&!a)&&(u||a||!c)&&(ui(this,u===c&&n>=0?"onComplete":"onReverseComplete",!0),this._prom&&!(u<c&&this.timeScale()>0)&&this._prom())))}return this},t.add=function(n,i){var s=this;if(y0(i)||(i=ci(this,i,n)),!(n instanceof Gh)){if(Gn(n))return n.forEach(function(a){return s.add(a,i)}),this;if(ho(n))return this.addLabel(n,i);if(po(n))n=Jr.delayedCall(0,n);else return this}return this!==n?Ls(this,n,i):this},t.getChildren=function(n,i,s,a){n===void 0&&(n=!0),i===void 0&&(i=!0),s===void 0&&(s=!0),a===void 0&&(a=-Ds);for(var c=[],l=this._first;l;)l._start>=a&&(l instanceof Jr?i&&c.push(l):(s&&c.push(l),n&&c.push.apply(c,l.getChildren(!0,i,s)))),l=l._next;return c},t.getById=function(n){for(var i=this.getChildren(1,1,1),s=i.length;s--;)if(i[s].vars.id===n)return i[s]},t.remove=function(n){return ho(n)?this.removeLabel(n):po(n)?this.killTweensOf(n):(F_(this,n),n===this._recent&&(this._recent=this._last),Fc(this))},t.totalTime=function(n,i){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=Bo(Vn.time-(this._ts>0?n/this._ts:(this.totalDuration()-n)/-this._ts))),o.prototype.totalTime.call(this,n,i),this._forcing=0,this):this._tTime},t.addLabel=function(n,i){return this.labels[n]=ci(this,i),this},t.removeLabel=function(n){return delete this.labels[n],this},t.addPause=function(n,i,s){var a=Jr.delayedCall(0,i||np,s);return a.data="isPause",this._hasPause=1,Ls(this,a,ci(this,n))},t.removePause=function(n){var i=this._first;for(n=ci(this,n);i;)i._start===n&&i.data==="isPause"&&fa(i),i=i._next},t.killTweensOf=function(n,i,s){for(var a=this.getTweensOf(n,s),c=a.length;c--;)pa!==a[c]&&a[c].kill(n,i);return this},t.getTweensOf=function(n,i){for(var s=[],a=li(n),c=this._first,l=y0(i),u;c;)c instanceof Jr?hZ(c._targets,a)&&(l?(!pa||c._initted&&c._ts)&&c.globalTime(0)<=i&&c.globalTime(c.totalDuration())>i:!i||c.isActive())&&s.push(c):(u=c.getTweensOf(a,i)).length&&s.push.apply(s,u),c=c._next;return s},t.tweenTo=function(n,i){i=i||{};var s=this,a=ci(s,n),c=i,l=c.startAt,u=c.onStart,p=c.onStartParams,d=c.immediateRender,h,m=Jr.to(s,pi({ease:i.ease||"none",lazy:!1,immediateRender:!1,time:a,overwrite:"auto",duration:i.duration||Math.abs((a-(l&&"time"in l?l.time:s._time))/s.timeScale())||rr,onStart:function(){if(s.pause(),!h){var v=i.duration||Math.abs((a-(l&&"time"in l?l.time:s._time))/s.timeScale());m._dur!==v&&ap(m,v,0,1).render(m._time,!0,!0),h=1}u&&u.apply(m,p||[])}},i));return d?m.render(0):m},t.tweenFromTo=function(n,i,s){return this.tweenTo(i,pi({startAt:{time:ci(this,n)}},s))},t.recent=function(){return this._recent},t.nextLabel=function(n){return n===void 0&&(n=this._time),xO(this,ci(this,n))},t.previousLabel=function(n){return n===void 0&&(n=this._time),xO(this,ci(this,n),1)},t.currentLabel=function(n){return arguments.length?this.seek(n,!0):this.previousLabel(this._time+rr)},t.shiftChildren=function(n,i,s){s===void 0&&(s=0);for(var a=this._first,c=this.labels,l;a;)a._start>=s&&(a._start+=n,a._end+=n),a=a._next;if(i)for(l in c)c[l]>=s&&(c[l]+=n);return Fc(this)},t.invalidate=function(){var n=this._first;for(this._lock=0;n;)n.invalidate(),n=n._next;return o.prototype.invalidate.call(this)},t.clear=function(n){n===void 0&&(n=!0);for(var i=this._first,s;i;)s=i._next,this.remove(i),i=s;return this._dp&&(this._time=this._tTime=this._pTime=0),n&&(this.labels={}),Fc(this)},t.totalDuration=function(n){var i=0,s=this,a=s._last,c=Ds,l,u,p;if(arguments.length)return s.timeScale((s._repeat<0?s.duration():s.totalDuration())/(s.reversed()?-n:n));if(s._dirty){for(p=s.parent;a;)l=a._prev,a._dirty&&a.totalDuration(),u=a._start,u>c&&s._sort&&a._ts&&!s._lock?(s._lock=1,Ls(s,a,u-a._delay,1)._lock=0):c=u,u<0&&a._ts&&(i-=u,(!p&&!s._dp||p&&p.smoothChildTiming)&&(s._start+=u/s._ts,s._time-=u,s._tTime-=u),s.shiftChildren(-u,!1,-1/0),c=0),a._end>i&&a._ts&&(i=a._end),a=l;ap(s,s===Tr&&s._time>i?s._time:i,1,1),s._dirty=0}return s._tDur},e.updateRoot=function(n){if(Tr._ts&&(PO(Tr,I_(n,Tr)),OO=Vn.frame),Vn.frame>=_O){_O+=Ko.autoSleep||120;var i=Tr._first;if((!i||!i._ts)&&Ko.autoSleep&&Vn._listeners.length<2){for(;i&&!i._ts;)i=i._next;i||Vn.sleep()}}},e}(Gh);pi(Fo.prototype,{_lock:0,_hasPause:0,_forcing:0});var UZ=function(e,t,r,n,i,s,a){var c=new Jo(this._pt,e,t,0,1,c7,null,i),l=0,u=0,p,d,h,m,f,v,g,_;for(c.b=r,c.e=n,r+="",n+="",(g=~n.indexOf("random("))&&(n=lp(n)),s&&(_=[r,n],s(_,e,t),r=_[0],n=_[1]),d=r.match(D6)||[];p=D6.exec(n);)m=p[0],f=n.substring(l,p.index),h?h=(h+1)%5:f.substr(-5)==="rgba("&&(h=1),m!==d[u++]&&(v=parseFloat(d[u-1])||0,c._pt={_next:c._pt,p:f||u===1?f:",",s:v,c:m.charAt(1)==="="?parseFloat(m.substr(2))*(m.charAt(0)==="-"?-1:1):parseFloat(m)-v,m:h&&h<4?Math.round:0},l=D6.lastIndex);return c.c=l<n.length?n.substring(l,n.length):"",c.fp=a,(J6.test(n)||g)&&(c.e=0),this._pt=c,c},i7=function(e,t,r,n,i,s,a,c,l){po(n)&&(n=n(i||0,e,s));var u=e[t],p=r!=="get"?r:po(u)?l?e[t.indexOf("set")||!po(e["get"+t.substr(3)])?t:"get"+t.substr(3)](l):e[t]():u,d=po(u)?l?jZ:JO:a7,h;if(ho(n)&&(~n.indexOf("random(")&&(n=lp(n)),n.charAt(1)==="="&&(h=parseFloat(p)+parseFloat(n.substr(2))*(n.charAt(0)==="-"?-1:1)+(Tn(p)||0),(h||h===0)&&(n=h))),p!==n)return!isNaN(p*n)&&n!==""?(h=new Jo(this._pt,e,t,+p||0,n-(p||0),typeof u=="boolean"?qZ:ZO,0,d),l&&(h.fp=l),a&&h.modifier(a,this,e),this._pt=h):(!u&&!(t in e)&&B_(t,n),UZ.call(this,e,t,p,n,d,c||Ko.stringFilter,l))},VZ=function(e,t,r,n,i){if(po(e)&&(e=Vh(e,i,t,r,n)),!x0(e)||e.style&&e.nodeType||Gn(e)||EO(e))return ho(e)?Vh(e,i,t,r,n):e;var s={},a;for(a in e)s[a]=Vh(e[a],i,t,r,n);return s},s7=function(e,t,r,n,i,s){var a,c,l,u;if(yn[e]&&(a=new yn[e]).init(i,a.rawVars?t[e]:VZ(t[e],n,i,s,r),r,n,s)!==!1&&(r._pt=c=new Jo(r._pt,i,e,0,1,a.render,a,0,a.priority),r!==tp))for(l=r._ptLookup[r._targets.indexOf(i)],u=a._props.length;u--;)l[a._props[u]]=c;return a},pa,GZ=function o(e,t){var r=e.vars,n=r.ease,i=r.startAt,s=r.immediateRender,a=r.lazy,c=r.onUpdate,l=r.onUpdateParams,u=r.callbackScope,p=r.runBackwards,d=r.yoyoEase,h=r.keyframes,m=r.autoRevert,f=e._dur,v=e._startAt,g=e._targets,_=e.parent,T=_&&_.data==="nested"?_.parent._targets:g,b=e._overwrite==="auto"&&!$6,x=e.timeline,A,E,S,w,O,C,N,R,D,V,F,j,$;if(x&&(!h||!n)&&(n="none"),e._ease=rp(n,op.ease),e._yEase=d?XO(rp(d===!0?n:d,op.ease)):0,d&&e._yoyo&&!e._repeat&&(d=e._yEase,e._yEase=e._ease,e._ease=d),e._from=!x&&!!r.runBackwards,!x){if(R=g[0]?ha(g[0]).harness:0,j=R&&r[R.prop],A=W6(r,Q6),v&&v.render(-1,!0).kill(),i)if(fa(e._startAt=Jr.set(g,pi({data:"isStart",overwrite:!1,parent:_,immediateRender:!0,lazy:xn(a),startAt:null,delay:0,onUpdate:c,onUpdateParams:l,callbackScope:u,stagger:0},i))),t<0&&!s&&!m&&e._startAt.render(-1,!0),s){if(t>0&&!m&&(e._startAt=0),f&&t<=0){t&&(e._zTime=t);return}}else m===!1&&(e._startAt=0);else if(p&&f){if(v)!m&&(e._startAt=0);else if(t&&(s=!1),S=pi({overwrite:!1,data:"isFromStart",lazy:s&&xn(a),immediateRender:s,stagger:0,parent:_},A),j&&(S[R.prop]=j),fa(e._startAt=Jr.set(g,S)),t<0&&e._startAt.render(-1,!0),!s)o(e._startAt,rr);else if(!t)return}for(e._pt=0,a=f&&xn(a)||a&&!f,E=0;E<g.length;E++){if(O=g[E],N=O._gsap||t7(g)[E]._gsap,e._ptLookup[E]=V={},j6[N.id]&&da.length&&R_(),F=T===g?E:T.indexOf(O),R&&(D=new R).init(O,j||A,e,F,T)!==!1&&(e._pt=w=new Jo(e._pt,O,D.name,0,1,D.render,D,0,D.priority),D._props.forEach(function(Y){V[Y]=w}),D.priority&&(C=1)),!R||j)for(S in A)yn[S]&&(D=s7(S,A,e,F,O,T))?D.priority&&(C=1):V[S]=w=i7.call(e,O,S,"get",A[S],F,T,0,r.stringFilter);e._op&&e._op[E]&&e.kill(O,e._op[E]),b&&e._pt&&(pa=e,Tr.killTweensOf(O,V,e.globalTime(t)),$=!e.parent,pa=0),e._pt&&a&&(j6[N.id]=1)}C&&u7(e),e._onInit&&e._onInit(e)}e._onUpdate=c,e._initted=(!e._op||e._pt)&&!$},zZ=function(e,t){var r=e[0]?ha(e[0]).harness:0,n=r&&r.aliases,i,s,a,c;if(!n)return t;i=ip({},t);for(s in n)if(s in i)for(c=n[s].split(","),a=c.length;a--;)i[c[a]]=i[s];return i},Vh=function(e,t,r,n,i){return po(e)?e.call(t,r,n,i):ho(e)&&~e.indexOf("random(")?lp(e):e},KO=e7+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase",HZ=(KO+",id,stagger,delay,duration,paused,scrollTrigger").split(","),Jr=function(o){TO(e,o);function e(r,n,i,s){var a;typeof n=="number"&&(i.duration=n,n=i,i=null),a=o.call(this,s?n:Fh(n))||this;var c=a.vars,l=c.duration,u=c.delay,p=c.immediateRender,d=c.stagger,h=c.overwrite,m=c.keyframes,f=c.defaults,v=c.scrollTrigger,g=c.yoyoEase,_=n.parent||Tr,T=(Gn(r)||EO(r)?y0(r[0]):"length"in n)?[r]:li(r),b,x,A,E,S,w,O,C;if(a._targets=T.length?t7(T):P_("GSAP target "+r+" not found. https://greensock.com",!Ko.nullTargetWarn)||[],a._ptLookup=[],a._overwrite=h,m||d||mO(l)||mO(u)){if(n=a.vars,b=a.timeline=new Fo({data:"nested",defaults:f||{}}),b.kill(),b.parent=b._dp=g0(a),b._start=0,m)Fh(pi(b.vars.defaults,{ease:"none"})),d?T.forEach(function(N,R){return m.forEach(function(D,V){return b.to(N,D,V?">":R*d)})}):m.forEach(function(N){return b.to(T,N,">")});else{if(E=T.length,O=d?VO(d):np,x0(d))for(S in d)~KO.indexOf(S)&&(C||(C={}),C[S]=d[S]);for(x=0;x<E;x++){A={};for(S in n)HZ.indexOf(S)<0&&(A[S]=n[S]);A.stagger=0,g&&(A.yoyoEase=g),C&&ip(A,C),w=T[x],A.duration=+Vh(l,g0(a),x,w,T),A.delay=(+Vh(u,g0(a),x,w,T)||0)-a._delay,!d&&E===1&&A.delay&&(a._delay=u=A.delay,a._start+=u,A.delay=0),b.to(w,A,O(x,w,T))}b.duration()?l=u=0:a.timeline=0}l||a.duration(l=b.duration())}else a.timeline=0;return h===!0&&!$6&&(pa=g0(a),Tr.killTweensOf(T),pa=0),Ls(_,g0(a),i),n.reversed&&a.reverse(),n.paused&&a.paused(!0),(p||!l&&!m&&a._start===Bo(_._time)&&xn(p)&&vZ(g0(a))&&_.data!=="nested")&&(a._tTime=-rr,a.render(Math.max(0,-u))),v&&kO(g0(a),v),a}var t=e.prototype;return t.render=function(n,i,s){var a=this._time,c=this._tDur,l=this._dur,u=n>c-rr&&n>=0?c:n<rr?0:n,p,d,h,m,f,v,g,_,T;if(!l)xZ(this,n,i,s);else if(u!==this._tTime||!n||s||!this._initted&&this._tTime||this._startAt&&this._zTime<0!=n<0){if(p=u,_=this.timeline,this._repeat){if(m=l+this._rDelay,this._repeat<-1&&n<0)return this.totalTime(m*100+n,i,s);if(p=Bo(u%m),u===c?(h=this._repeat,p=l):(h=~~(u/m),h&&h===u/m&&(p=l,h--),p>l&&(p=l)),v=this._yoyo&&h&1,v&&(T=this._yEase,p=l-p),f=sp(this._tTime,m),p===a&&!s&&this._initted)return this;h!==f&&(_&&this._yEase&&YO(_,v),this.vars.repeatRefresh&&!v&&!this._lock&&(this._lock=s=1,this.render(Bo(m*h),!0).invalidate()._lock=0))}if(!this._initted){if(BO(this,n<0?n:p,s,i))return this._tTime=0,this;if(l!==this._dur)return this.render(n,i,s)}if(this._tTime=u,this._time=p,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=g=(T||this._ease)(p/l),this._from&&(this.ratio=g=1-g),p&&!a&&!i&&(ui(this,"onStart"),this._tTime!==u))return this;for(d=this._pt;d;)d.r(g,d.d),d=d._next;_&&_.render(n<0?n:!p&&v?-rr:_._dur*g,i,s)||this._startAt&&(this._zTime=n),this._onUpdate&&!i&&(n<0&&this._startAt&&this._startAt.render(n,!0,s),ui(this,"onUpdate")),this._repeat&&h!==f&&this.vars.onRepeat&&!i&&this.parent&&ui(this,"onRepeat"),(u===this._tDur||!u)&&this._tTime===u&&(n<0&&this._startAt&&!this._onUpdate&&this._startAt.render(n,!0,!0),(n||!l)&&(u===this._tDur&&this._ts>0||!u&&this._ts<0)&&fa(this,1),!i&&!(n<0&&!a)&&(u||a)&&(ui(this,u===c?"onComplete":"onReverseComplete",!0),this._prom&&!(u<c&&this.timeScale()>0)&&this._prom()))}return this},t.targets=function(){return this._targets},t.invalidate=function(){return this._pt=this._op=this._startAt=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(),o.prototype.invalidate.call(this)},t.kill=function(n,i){if(i===void 0&&(i="all"),!n&&(!i||i==="all"))return this._lazy=this._pt=0,this.parent?kh(this):this;if(this.timeline){var s=this.timeline.totalDuration();return this.timeline.killTweensOf(n,i,pa&&pa.vars.overwrite!==!0)._first||kh(this),this.parent&&s!==this.timeline.totalDuration()&&ap(this,this._dur*this.timeline._tDur/s,0,1),this}var a=this._targets,c=n?li(n):a,l=this._ptLookup,u=this._pt,p,d,h,m,f,v,g;if((!i||i==="all")&&mZ(a,c))return i==="all"&&(this._pt=0),kh(this);for(p=this._op=this._op||[],i!=="all"&&(ho(i)&&(f={},bn(i,function(_){return f[_]=1}),i=f),i=zZ(a,i)),g=a.length;g--;)if(~c.indexOf(a[g])){d=l[g],i==="all"?(p[g]=i,m=d,h={}):(h=p[g]=p[g]||{},m=i);for(f in m)v=d&&d[f],v&&((!("kill"in v.d)||v.d.kill(f)===!0)&&F_(this,v,"_pt"),delete d[f]),h!=="all"&&(h[f]=1)}return this._initted&&!this._pt&&u&&kh(this),this},e.to=function(n,i){return new e(n,i,arguments[2])},e.from=function(n,i){return Uh(1,arguments)},e.delayedCall=function(n,i,s,a){return new e(i,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:n,onComplete:i,onReverseComplete:i,onCompleteParams:s,onReverseCompleteParams:s,callbackScope:a})},e.fromTo=function(n,i,s){return Uh(2,arguments)},e.set=function(n,i){return i.duration=0,i.repeatDelay||(i.repeat=0),new e(n,i)},e.killTweensOf=function(n,i,s){return Tr.killTweensOf(n,i,s)},e}(Gh);pi(Jr.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0});bn("staggerTo,staggerFrom,staggerFromTo",function(o){Jr[o]=function(){var e=new Fo,t=X6.call(arguments,0);return t.splice(o==="staggerFromTo"?5:4,0,0),e[o].apply(e,t)}});var a7=function(e,t,r){return e[t]=r},JO=function(e,t,r){return e[t](r)},jZ=function(e,t,r,n){return e[t](n.fp,r)},WZ=function(e,t,r){return e.setAttribute(t,r)},V_=function(e,t){return po(e[t])?JO:k_(e[t])&&e.setAttribute?WZ:a7},ZO=function(e,t){return t.set(t.t,t.p,Math.round((t.s+t.c*e)*1e6)/1e6,t)},qZ=function(e,t){return t.set(t.t,t.p,!!(t.s+t.c*e),t)},c7=function(e,t){var r=t._pt,n="";if(!e&&t.b)n=t.b;else if(e===1&&t.e)n=t.e;else{for(;r;)n=r.p+(r.m?r.m(r.s+r.c*e):Math.round((r.s+r.c*e)*1e4)/1e4)+n,r=r._next;n+=t.c}t.set(t.t,t.p,n,t)},l7=function(e,t){for(var r=t._pt;r;)r.r(e,r.d),r=r._next},XZ=function(e,t,r,n){for(var i=this._pt,s;i;)s=i._next,i.p===n&&i.modifier(e,t,r),i=s},YZ=function(e){for(var t=this._pt,r,n;t;)n=t._next,t.p===e&&!t.op||t.op===e?F_(this,t,"_pt"):t.dep||(r=1),t=n;return!r},$Z=function(e,t,r,n){n.mSet(e,t,n.m.call(n.tween,r,n.mt),n)},u7=function(e){for(var t=e._pt,r,n,i,s;t;){for(r=t._next,n=i;n&&n.pr>t.pr;)n=n._next;(t._prev=n?n._prev:s)?t._prev._next=t:i=t,(t._next=n)?n._prev=t:s=t,t=r}e._pt=i},Jo=function(){function o(t,r,n,i,s,a,c,l,u){this.t=r,this.s=i,this.c=s,this.p=n,this.r=a||ZO,this.d=c||this,this.set=l||a7,this.pr=u||0,this._next=t,t&&(t._prev=this)}var e=o.prototype;return e.modifier=function(r,n,i){this.mSet=this.mSet||this.set,this.set=$Z,this.m=r,this.mt=i,this.tween=n},o}();bn(e7+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",function(o){return Q6[o]=1});zn.TweenMax=zn.TweenLite=Jr;zn.TimelineLite=zn.TimelineMax=Fo;Tr=new Fo({sortChildren:!1,defaults:op,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0});Ko.stringFilter=o7;var D_={registerPlugin:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];t.forEach(function(n){return RZ(n)})},timeline:function(e){return new Fo(e)},getTweensOf:function(e,t){return Tr.getTweensOf(e,t)},getProperty:function(e,t,r,n){ho(e)&&(e=li(e)[0]);var i=ha(e||{}).get,s=r?IO:RO;return r==="native"&&(r=""),e&&(t?s((yn[t]&&yn[t].get||i)(e,t,r,n)):function(a,c,l){return s((yn[a]&&yn[a].get||i)(e,a,c,l))})},quickSetter:function(e,t,r){if(e=li(e),e.length>1){var n=e.map(function(u){return di.quickSetter(u,t,r)}),i=n.length;return function(u){for(var p=i;p--;)n[p](u)}}e=e[0]||{};var s=yn[t],a=ha(e),c=a.harness&&(a.harness.aliases||{})[t]||t,l=s?function(u){var p=new s;tp._pt=0,p.init(e,r?u+r:u,tp,0,[e]),p.render(1,p),tp._pt&&l7(1,tp)}:a.set(e,c);return s?l:function(u){return l(e,c,r?u+r:u,a,1)}},isTweening:function(e){return Tr.getTweensOf(e,!0).length>0},defaults:function(e){return e&&e.ease&&(e.ease=rp(e.ease,op.ease)),gO(op,e||{})},config:function(e){return gO(Ko,e||{})},registerEffect:function(e){var t=e.name,r=e.effect,n=e.plugins,i=e.defaults,s=e.extendTimeline;(n||"").split(",").forEach(function(a){return a&&!yn[a]&&!zn[a]&&P_(t+" effect requires "+a+" plugin.")}),k6[t]=function(a,c,l){return r(li(a),pi(c||{},i),l)},s&&(Fo.prototype[t]=function(a,c,l){return this.add(k6[t](a,x0(c)?c:(l=c)&&{},this),l)})},registerEase:function(e,t){St[e]=rp(t)},parseEase:function(e,t){return arguments.length?rp(e,t):St},getById:function(e){return Tr.getById(e)},exportRoot:function(e,t){e===void 0&&(e={});var r=new Fo(e),n,i;for(r.smoothChildTiming=xn(e.smoothChildTiming),Tr.remove(r),r._dp=0,r._time=r._tTime=Tr._time,n=Tr._first;n;)i=n._next,(t||!(!n._dur&&n instanceof Jr&&n.vars.onComplete===n._targets[0]))&&Ls(r,n,n._start-n._delay),n=i;return Ls(Tr,r,0),r},utils:{wrap:NZ,wrapYoyo:OZ,distribute:VO,random:zO,snap:GO,normalize:MZ,getUnit:Tn,clamp:AZ,splitColor:WO,toArray:li,selector:EZ,mapRange:jO,pipe:SZ,unitize:wZ,interpolate:PZ,shuffle:UO},install:MO,effects:k6,ticker:Vn,updateRoot:Fo.updateRoot,plugins:yn,globalTimeline:Tr,core:{PropTween:Jo,globals:NO,Tween:Jr,Timeline:Fo,Animation:Gh,getCache:ha,_removeLinkedListItem:F_,suppressOverwrites:function(e){return $6=e}}};bn("to,from,fromTo,delayedCall,set,killTweensOf",function(o){return D_[o]=Jr[o]});Vn.add(Fo.updateRoot);tp=D_.to({},{duration:0});var KZ=function(e,t){for(var r=e._pt;r&&r.p!==t&&r.op!==t&&r.fp!==t;)r=r._next;return r},JZ=function(e,t){var r=e._targets,n,i,s;for(n in t)for(i=r.length;i--;)s=e._ptLookup[i][n],s&&(s=s.d)&&(s._pt&&(s=KZ(s,n)),s&&s.modifier&&s.modifier(t[n],e,r[i],n))},V6=function(e,t){return{name:e,rawVars:1,init:function(n,i,s){s._onInit=function(a){var c,l;if(ho(i)&&(c={},bn(i,function(u){return c[u]=1}),i=c),t){c={};for(l in i)c[l]=t(i[l]);i=c}JZ(a,i)}}}},di=D_.registerPlugin({name:"attr",init:function(e,t,r,n,i){var s,a;for(s in t)a=this.add(e,"setAttribute",(e.getAttribute(s)||0)+"",t[s],n,i,0,0,s),a&&(a.op=s),this._props.push(s)}},{name:"endArray",init:function(e,t){for(var r=t.length;r--;)this.add(e,r,e[r]||0,t[r])}},V6("roundProps",Y6),V6("modifiers"),V6("snap",GO))||D_;Jr.version=Fo.version=di.version="3.8.0";wO=1;CO()&&cp();var ZZ=St.Power0,QZ=St.Power1,eQ=St.Power2,tQ=St.Power3,rQ=St.Power4,oQ=St.Linear,nQ=St.Quad,iQ=St.Cubic,sQ=St.Quart,aQ=St.Quint,cQ=St.Strong,lQ=St.Elastic,uQ=St.Back,pQ=St.SteppedEase,dQ=St.Bounce,hQ=St.Sine,fQ=St.Expo,mQ=St.Circ;var QO,_a,dp,_7,jc,_Q,eP,gQ=function(){return typeof window<"u"},ya={},Hc=180/Math.PI,hp=Math.PI/180,up=Math.atan2,tP=1e8,cP=/([A-Z])/g,vQ=/(?:left|right|width|margin|padding|x)/i,yQ=/[\s,\(]\S/,ga={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},lP=function(e,t){return t.set(t.t,t.p,Math.round((t.s+t.c*e)*1e4)/1e4+t.u,t)},xQ=function(e,t){return t.set(t.t,t.p,e===1?t.e:Math.round((t.s+t.c*e)*1e4)/1e4+t.u,t)},bQ=function(e,t){return t.set(t.t,t.p,e?Math.round((t.s+t.c*e)*1e4)/1e4+t.u:t.b,t)},TQ=function(e,t){var r=t.s+t.c*e;t.set(t.t,t.p,~~(r+(r<0?-.5:.5))+t.u,t)},uP=function(e,t){return t.set(t.t,t.p,e?t.e:t.b,t)},pP=function(e,t){return t.set(t.t,t.p,e!==1?t.b:t.e,t)},AQ=function(e,t,r){return e.style[t]=r},CQ=function(e,t,r){return e.style.setProperty(t,r)},EQ=function(e,t,r){return e._gsap[t]=r},SQ=function(e,t,r){return e._gsap.scaleX=e._gsap.scaleY=r},wQ=function(e,t,r,n,i){var s=e._gsap;s.scaleX=s.scaleY=r,s.renderTransform(i,s)},MQ=function(e,t,r,n,i){var s=e._gsap;s[t]=r,s.renderTransform(i,s)},To="transform",xa=To+"Origin",dP,h7=function(e,t){var r=_a.createElementNS?_a.createElementNS((t||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),e):_a.createElement(e);return r.style?r:_a.createElement(e)},b0=function o(e,t,r){var n=getComputedStyle(e);return n[t]||n.getPropertyValue(t.replace(cP,"-$1").toLowerCase())||n.getPropertyValue(t)||!r&&o(e,fp(t)||t,1)||""},rP="O,Moz,ms,Ms,Webkit".split(","),fp=function(e,t,r){var n=t||jc,i=n.style,s=5;if(e in i&&!r)return e;for(e=e.charAt(0).toUpperCase()+e.substr(1);s--&&!(rP[s]+e in i););return s<0?null:(s===3?"ms":s>=0?rP[s]:"")+e},f7=function(){gQ()&&window.document&&(QO=window,_a=QO.document,dp=_a.documentElement,jc=h7("div")||{style:{}},_Q=h7("div"),To=fp(To),xa=To+"Origin",jc.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",dP=!!fp("perspective"),_7=1)},p7=function o(e){var t=h7("svg",this.ownerSVGElement&&this.ownerSVGElement.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),r=this.parentNode,n=this.nextSibling,i=this.style.cssText,s;if(dp.appendChild(t),t.appendChild(this),this.style.display="block",e)try{s=this.getBBox(),this._gsapBBox=this.getBBox,this.getBBox=o}catch{}else this._gsapBBox&&(s=this._gsapBBox());return r&&(n?r.insertBefore(this,n):r.appendChild(this)),dp.removeChild(t),this.style.cssText=i,s},oP=function(e,t){for(var r=t.length;r--;)if(e.hasAttribute(t[r]))return e.getAttribute(t[r])},hP=function(e){var t;try{t=e.getBBox()}catch{t=p7.call(e,!0)}return t&&(t.width||t.height)||e.getBBox===p7||(t=p7.call(e,!0)),t&&!t.width&&!t.x&&!t.y?{x:+oP(e,["x","cx","x1"])||0,y:+oP(e,["y","cy","y1"])||0,width:0,height:0}:t},fP=function(e){return!!(e.getCTM&&(!e.parentNode||e.ownerSVGElement)&&hP(e))},jh=function(e,t){if(t){var r=e.style;t in ya&&t!==xa&&(t=To),r.removeProperty?((t.substr(0,2)==="ms"||t.substr(0,6)==="webkit")&&(t="-"+t),r.removeProperty(t.replace(cP,"-$1").toLowerCase())):r.removeAttribute(t)}},va=function(e,t,r,n,i,s){var a=new Jo(e._pt,t,r,0,1,s?pP:uP);return e._pt=a,a.b=n,a.e=i,e._props.push(r),a},nP={deg:1,rad:1,turn:1},ba=function o(e,t,r,n){var i=parseFloat(r)||0,s=(r+"").trim().substr((i+"").length)||"px",a=jc.style,c=vQ.test(t),l=e.tagName.toLowerCase()==="svg",u=(l?"client":"offset")+(c?"Width":"Height"),p=100,d=n==="px",h=n==="%",m,f,v,g;return n===s||!i||nP[n]||nP[s]?i:(s!=="px"&&!d&&(i=o(e,t,r,"px")),g=e.getCTM&&fP(e),(h||s==="%")&&(ya[t]||~t.indexOf("adius"))?(m=g?e.getBBox()[c?"width":"height"]:e[u],Dr(h?i/m*p:i/100*m)):(a[c?"width":"height"]=p+(d?s:n),f=~t.indexOf("adius")||n==="em"&&e.appendChild&&!l?e:e.parentNode,g&&(f=(e.ownerSVGElement||{}).parentNode),(!f||f===_a||!f.appendChild)&&(f=_a.body),v=f._gsap,v&&h&&v.width&&c&&v.time===Vn.time?Dr(i/v.width*p):((h||s==="%")&&(a.position=b0(e,"position")),f===e&&(a.position="static"),f.appendChild(jc),m=jc[u],f.removeChild(jc),a.position="absolute",c&&h&&(v=ha(f),v.time=Vn.time,v.width=f[u]),Dr(d?m*i/p:m&&i?p/m*i:0))))},pp=function(e,t,r,n){var i;return _7||f7(),t in ga&&t!=="transform"&&(t=ga[t],~t.indexOf(",")&&(t=t.split(",")[0])),ya[t]&&t!=="transform"?(i=qh(e,n),i=t!=="transformOrigin"?i[t]:i.svg?i.origin:z_(b0(e,xa))+" "+i.zOrigin+"px"):(i=e.style[t],(!i||i==="auto"||n||~(i+"").indexOf("calc("))&&(i=G_[t]&&G_[t](e,t,r)||b0(e,t)||r7(e,t)||(t==="opacity"?1:0))),r&&!~(i+"").trim().indexOf(" ")?ba(e,t,i,r)+r:i},NQ=function(e,t,r,n){if(!r||r==="none"){var i=fp(t,e,1),s=i&&b0(e,i,1);s&&s!==r?(t=i,r=s):t==="borderColor"&&(r=b0(e,"borderTopColor"))}var a=new Jo(this._pt,e.style,t,0,1,c7),c=0,l=0,u,p,d,h,m,f,v,g,_,T,b,x,A;if(a.b=r,a.e=n,r+="",n+="",n==="auto"&&(e.style[t]=n,n=b0(e,t)||n,e.style[t]=r),u=[r,n],o7(u),r=u[0],n=u[1],d=r.match(Uc)||[],A=n.match(Uc)||[],A.length){for(;p=Uc.exec(n);)v=p[0],_=n.substring(c,p.index),m?m=(m+1)%5:(_.substr(-5)==="rgba("||_.substr(-5)==="hsla(")&&(m=1),v!==(f=d[l++]||"")&&(h=parseFloat(f)||0,b=f.substr((h+"").length),x=v.charAt(1)==="="?+(v.charAt(0)+"1"):0,x&&(v=v.substr(2)),g=parseFloat(v),T=v.substr((g+"").length),c=Uc.lastIndex-T.length,T||(T=T||Ko.units[t]||b,c===n.length&&(n+=T,a.e+=T)),b!==T&&(h=ba(e,t,f,T)||0),a._pt={_next:a._pt,p:_||l===1?_:",",s:h,c:x?x*g:g-h,m:m&&m<4||t==="zIndex"?Math.round:0});a.c=c<n.length?n.substring(c,n.length):""}else a.r=t==="display"&&n==="none"?pP:uP;return J6.test(n)&&(a.e=0),this._pt=a,a},iP={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},OQ=function(e){var t=e.split(" "),r=t[0],n=t[1]||"50%";return(r==="top"||r==="bottom"||n==="left"||n==="right")&&(e=r,r=n,n=e),t[0]=iP[r]||r,t[1]=iP[n]||n,t.join(" ")},PQ=function(e,t){if(t.tween&&t.tween._time===t.tween._dur){var r=t.t,n=r.style,i=t.u,s=r._gsap,a,c,l;if(i==="all"||i===!0)n.cssText="",c=1;else for(i=i.split(","),l=i.length;--l>-1;)a=i[l],ya[a]&&(c=1,a=a==="transformOrigin"?xa:To),jh(r,a);c&&(jh(r,To),s&&(s.svg&&r.removeAttribute("transform"),qh(r,1),s.uncache=1))}},G_={clearProps:function(e,t,r,n,i){if(i.data!=="isFromStart"){var s=e._pt=new Jo(e._pt,t,r,0,0,PQ);return s.u=n,s.pr=-10,s.tween=i,e._props.push(r),1}}},Wh=[1,0,0,1,0,0],mP={},_P=function(e){return e==="matrix(1, 0, 0, 1, 0, 0)"||e==="none"||!e},sP=function(e){var t=b0(e,To);return _P(t)?Wh:t.substr(7).match(K6).map(Dr)},g7=function(e,t){var r=e._gsap||ha(e),n=e.style,i=sP(e),s,a,c,l;return r.svg&&e.getAttribute("transform")?(c=e.transform.baseVal.consolidate().matrix,i=[c.a,c.b,c.c,c.d,c.e,c.f],i.join(",")==="1,0,0,1,0,0"?Wh:i):(i===Wh&&!e.offsetParent&&e!==dp&&!r.svg&&(c=n.display,n.display="block",s=e.parentNode,(!s||!e.offsetParent)&&(l=1,a=e.nextSibling,dp.appendChild(e)),i=sP(e),c?n.display=c:jh(e,"display"),l&&(a?s.insertBefore(e,a):s?s.appendChild(e):dp.removeChild(e))),t&&i.length>6?[i[0],i[1],i[4],i[5],i[12],i[13]]:i)},m7=function(e,t,r,n,i,s){var a=e._gsap,c=i||g7(e,!0),l=a.xOrigin||0,u=a.yOrigin||0,p=a.xOffset||0,d=a.yOffset||0,h=c[0],m=c[1],f=c[2],v=c[3],g=c[4],_=c[5],T=t.split(" "),b=parseFloat(T[0])||0,x=parseFloat(T[1])||0,A,E,S,w;r?c!==Wh&&(E=h*v-m*f)&&(S=b*(v/E)+x*(-f/E)+(f*_-v*g)/E,w=b*(-m/E)+x*(h/E)-(h*_-m*g)/E,b=S,x=w):(A=hP(e),b=A.x+(~T[0].indexOf("%")?b/100*A.width:b),x=A.y+(~(T[1]||T[0]).indexOf("%")?x/100*A.height:x)),n||n!==!1&&a.smooth?(g=b-l,_=x-u,a.xOffset=p+(g*h+_*f)-g,a.yOffset=d+(g*m+_*v)-_):a.xOffset=a.yOffset=0,a.xOrigin=b,a.yOrigin=x,a.smooth=!!n,a.origin=t,a.originIsAbsolute=!!r,e.style[xa]="0px 0px",s&&(va(s,a,"xOrigin",l,b),va(s,a,"yOrigin",u,x),va(s,a,"xOffset",p,a.xOffset),va(s,a,"yOffset",d,a.yOffset)),e.setAttribute("data-svg-origin",b+" "+x)},qh=function(e,t){var r=e._gsap||new n7(e);if("x"in r&&!t&&!r.uncache)return r;var n=e.style,i=r.scaleX<0,s="px",a="deg",c=b0(e,xa)||"0",l,u,p,d,h,m,f,v,g,_,T,b,x,A,E,S,w,O,C,N,R,D,V,F,j,$,Y,H,B,te,X,W;return l=u=p=m=f=v=g=_=T=0,d=h=1,r.svg=!!(e.getCTM&&fP(e)),A=g7(e,r.svg),r.svg&&(F=(!r.uncache||c==="0px 0px")&&!t&&e.getAttribute("data-svg-origin"),m7(e,F||c,!!F||r.originIsAbsolute,r.smooth!==!1,A)),b=r.xOrigin||0,x=r.yOrigin||0,A!==Wh&&(O=A[0],C=A[1],N=A[2],R=A[3],l=D=A[4],u=V=A[5],A.length===6?(d=Math.sqrt(O*O+C*C),h=Math.sqrt(R*R+N*N),m=O||C?up(C,O)*Hc:0,g=N||R?up(N,R)*Hc+m:0,g&&(h*=Math.abs(Math.cos(g*hp))),r.svg&&(l-=b-(b*O+x*N),u-=x-(b*C+x*R))):(W=A[6],te=A[7],Y=A[8],H=A[9],B=A[10],X=A[11],l=A[12],u=A[13],p=A[14],E=up(W,B),f=E*Hc,E&&(S=Math.cos(-E),w=Math.sin(-E),F=D*S+Y*w,j=V*S+H*w,$=W*S+B*w,Y=D*-w+Y*S,H=V*-w+H*S,B=W*-w+B*S,X=te*-w+X*S,D=F,V=j,W=$),E=up(-N,B),v=E*Hc,E&&(S=Math.cos(-E),w=Math.sin(-E),F=O*S-Y*w,j=C*S-H*w,$=N*S-B*w,X=R*w+X*S,O=F,C=j,N=$),E=up(C,O),m=E*Hc,E&&(S=Math.cos(E),w=Math.sin(E),F=O*S+C*w,j=D*S+V*w,C=C*S-O*w,V=V*S-D*w,O=F,D=j),f&&Math.abs(f)+Math.abs(m)>359.9&&(f=m=0,v=180-v),d=Dr(Math.sqrt(O*O+C*C+N*N)),h=Dr(Math.sqrt(V*V+W*W)),E=up(D,V),g=Math.abs(E)>2e-4?E*Hc:0,T=X?1/(X<0?-X:X):0),r.svg&&(F=e.getAttribute("transform"),r.forceCSS=e.setAttribute("transform","")||!_P(b0(e,To)),F&&e.setAttribute("transform",F))),Math.abs(g)>90&&Math.abs(g)<270&&(i?(d*=-1,g+=m<=0?180:-180,m+=m<=0?180:-180):(h*=-1,g+=g<=0?180:-180)),r.x=l-((r.xPercent=l&&(r.xPercent||(Math.round(e.offsetWidth/2)===Math.round(-l)?-50:0)))?e.offsetWidth*r.xPercent/100:0)+s,r.y=u-((r.yPercent=u&&(r.yPercent||(Math.round(e.offsetHeight/2)===Math.round(-u)?-50:0)))?e.offsetHeight*r.yPercent/100:0)+s,r.z=p+s,r.scaleX=Dr(d),r.scaleY=Dr(h),r.rotation=Dr(m)+a,r.rotationX=Dr(f)+a,r.rotationY=Dr(v)+a,r.skewX=g+a,r.skewY=_+a,r.transformPerspective=T+s,(r.zOrigin=parseFloat(c.split(" ")[2])||0)&&(n[xa]=z_(c)),r.xOffset=r.yOffset=0,r.force3D=Ko.force3D,r.renderTransform=r.svg?IQ:dP?gP:RQ,r.uncache=0,r},z_=function(e){return(e=e.split(" "))[0]+" "+e[1]},d7=function(e,t,r){var n=Tn(t);return Dr(parseFloat(t)+parseFloat(ba(e,"x",r+"px",n)))+n},RQ=function(e,t){t.z="0px",t.rotationY=t.rotationX="0deg",t.force3D=0,gP(e,t)},Gc="0deg",Hh="0px",zc=") ",gP=function(e,t){var r=t||this,n=r.xPercent,i=r.yPercent,s=r.x,a=r.y,c=r.z,l=r.rotation,u=r.rotationY,p=r.rotationX,d=r.skewX,h=r.skewY,m=r.scaleX,f=r.scaleY,v=r.transformPerspective,g=r.force3D,_=r.target,T=r.zOrigin,b="",x=g==="auto"&&e&&e!==1||g===!0;if(T&&(p!==Gc||u!==Gc)){var A=parseFloat(u)*hp,E=Math.sin(A),S=Math.cos(A),w;A=parseFloat(p)*hp,w=Math.cos(A),s=d7(_,s,E*w*-T),a=d7(_,a,-Math.sin(A)*-T),c=d7(_,c,S*w*-T+T)}v!==Hh&&(b+="perspective("+v+zc),(n||i)&&(b+="translate("+n+"%, "+i+"%) "),(x||s!==Hh||a!==Hh||c!==Hh)&&(b+=c!==Hh||x?"translate3d("+s+", "+a+", "+c+") ":"translate("+s+", "+a+zc),l!==Gc&&(b+="rotate("+l+zc),u!==Gc&&(b+="rotateY("+u+zc),p!==Gc&&(b+="rotateX("+p+zc),(d!==Gc||h!==Gc)&&(b+="skew("+d+", "+h+zc),(m!==1||f!==1)&&(b+="scale("+m+", "+f+zc),_.style[To]=b||"translate(0, 0)"},IQ=function(e,t){var r=t||this,n=r.xPercent,i=r.yPercent,s=r.x,a=r.y,c=r.rotation,l=r.skewX,u=r.skewY,p=r.scaleX,d=r.scaleY,h=r.target,m=r.xOrigin,f=r.yOrigin,v=r.xOffset,g=r.yOffset,_=r.forceCSS,T=parseFloat(s),b=parseFloat(a),x,A,E,S,w;c=parseFloat(c),l=parseFloat(l),u=parseFloat(u),u&&(u=parseFloat(u),l+=u,c+=u),c||l?(c*=hp,l*=hp,x=Math.cos(c)*p,A=Math.sin(c)*p,E=Math.sin(c-l)*-d,S=Math.cos(c-l)*d,l&&(u*=hp,w=Math.tan(l-u),w=Math.sqrt(1+w*w),E*=w,S*=w,u&&(w=Math.tan(u),w=Math.sqrt(1+w*w),x*=w,A*=w)),x=Dr(x),A=Dr(A),E=Dr(E),S=Dr(S)):(x=p,S=d,A=E=0),(T&&!~(s+"").indexOf("px")||b&&!~(a+"").indexOf("px"))&&(T=ba(h,"x",s,"px"),b=ba(h,"y",a,"px")),(m||f||v||g)&&(T=Dr(T+m-(m*x+f*E)+v),b=Dr(b+f-(m*A+f*S)+g)),(n||i)&&(w=h.getBBox(),T=Dr(T+n/100*w.width),b=Dr(b+i/100*w.height)),w="matrix("+x+","+A+","+E+","+S+","+T+","+b+")",h.setAttribute("transform",w),_&&(h.style[To]=w)},LQ=function(e,t,r,n,i,s){var a=360,c=ho(i),l=parseFloat(i)*(c&&~i.indexOf("rad")?Hc:1),u=s?l*s:l-n,p=n+u+"deg",d,h;return c&&(d=i.split("_")[1],d==="short"&&(u%=a,u!==u%(a/2)&&(u+=u<0?a:-a)),d==="cw"&&u<0?u=(u+a*tP)%a-~~(u/a)*a:d==="ccw"&&u>0&&(u=(u-a*tP)%a-~~(u/a)*a)),e._pt=h=new Jo(e._pt,t,r,n,u,xQ),h.e=p,h.u="deg",e._props.push(r),h},aP=function(e,t){for(var r in t)e[r]=t[r];return e},DQ=function(e,t,r){var n=aP({},r._gsap),i="perspective,force3D,transformOrigin,svgOrigin",s=r.style,a,c,l,u,p,d,h,m;n.svg?(l=r.getAttribute("transform"),r.setAttribute("transform",""),s[To]=t,a=qh(r,1),jh(r,To),r.setAttribute("transform",l)):(l=getComputedStyle(r)[To],s[To]=t,a=qh(r,1),s[To]=l);for(c in ya)l=n[c],u=a[c],l!==u&&i.indexOf(c)<0&&(h=Tn(l),m=Tn(u),p=h!==m?ba(r,c,l,m):parseFloat(l),d=parseFloat(u),e._pt=new Jo(e._pt,a,c,p,d-p,lP),e._pt.u=m||0,e._props.push(c));aP(a,n)};bn("padding,margin,Width,Radius",function(o,e){var t="Top",r="Right",n="Bottom",i="Left",s=(e<3?[t,r,n,i]:[t+i,t+r,n+r,n+i]).map(function(a){return e<2?o+a:"border"+a+o});G_[e>1?"border"+o:o]=function(a,c,l,u,p){var d,h;if(arguments.length<4)return d=s.map(function(m){return pp(a,m,l)}),h=d.join(" "),h.split(d[0]).length===5?d[0]:h;d=(u+"").split(" "),h={},s.forEach(function(m,f){return h[m]=d[f]=d[f]||d[(f-1)/2|0]}),a.init(c,h,p)}});var v7={name:"css",register:f7,targetTest:function(e){return e.style&&e.nodeType},init:function(e,t,r,n,i){var s=this._props,a=e.style,c=r.vars.startAt,l,u,p,d,h,m,f,v,g,_,T,b,x,A,E;_7||f7();for(f in t)if(f!=="autoRound"&&(u=t[f],!(yn[f]&&s7(f,t,r,n,e,i)))){if(h=typeof u,m=G_[f],h==="function"&&(u=u.call(r,n,e,i),h=typeof u),h==="string"&&~u.indexOf("random(")&&(u=lp(u)),m)m(this,e,f,u,r)&&(E=1);else if(f.substr(0,2)==="--")l=(getComputedStyle(e).getPropertyValue(f)+"").trim(),u+="",v0.lastIndex=0,v0.test(l)||(v=Tn(l),g=Tn(u)),g?v!==g&&(l=ba(e,f,l,g)+g):v&&(u+=v),this.add(a,"setProperty",l,u,n,i,0,0,f),s.push(f);else if(h!=="undefined"){if(c&&f in c?(l=typeof c[f]=="function"?c[f].call(r,n,e,i):c[f],f in Ko.units&&!Tn(l)&&(l+=Ko.units[f]),ho(l)&&~l.indexOf("random(")&&(l=lp(l)),(l+"").charAt(1)==="="&&(l=pp(e,f))):l=pp(e,f),d=parseFloat(l),_=h==="string"&&u.charAt(1)==="="?+(u.charAt(0)+"1"):0,_&&(u=u.substr(2)),p=parseFloat(u),f in ga&&(f==="autoAlpha"&&(d===1&&pp(e,"visibility")==="hidden"&&p&&(d=0),va(this,a,"visibility",d?"inherit":"hidden",p?"inherit":"hidden",!p)),f!=="scale"&&f!=="transform"&&(f=ga[f],~f.indexOf(",")&&(f=f.split(",")[0]))),T=f in ya,T){if(b||(x=e._gsap,x.renderTransform&&!t.parseTransform||qh(e,t.parseTransform),A=t.smoothOrigin!==!1&&x.smooth,b=this._pt=new Jo(this._pt,a,To,0,1,x.renderTransform,x,0,-1),b.dep=1),f==="scale")this._pt=new Jo(this._pt,x,"scaleY",x.scaleY,(_?_*p:p-x.scaleY)||0),s.push("scaleY",f),f+="X";else if(f==="transformOrigin"){u=OQ(u),x.svg?m7(e,u,0,A,0,this):(g=parseFloat(u.split(" ")[2])||0,g!==x.zOrigin&&va(this,x,"zOrigin",x.zOrigin,g),va(this,a,f,z_(l),z_(u)));continue}else if(f==="svgOrigin"){m7(e,u,1,A,0,this);continue}else if(f in mP){LQ(this,x,f,d,u,_);continue}else if(f==="smoothOrigin"){va(this,x,"smooth",x.smooth,u);continue}else if(f==="force3D"){x[f]=u;continue}else if(f==="transform"){DQ(this,u,e);continue}}else f in a||(f=fp(f)||f);if(T||(p||p===0)&&(d||d===0)&&!yQ.test(u)&&f in a)v=(l+"").substr((d+"").length),p||(p=0),g=Tn(u)||(f in Ko.units?Ko.units[f]:v),v!==g&&(d=ba(e,f,l,g)),this._pt=new Jo(this._pt,T?x:a,f,d,_?_*p:p-d,!T&&(g==="px"||f==="zIndex")&&t.autoRound!==!1?TQ:lP),this._pt.u=g||0,v!==g&&g!=="%"&&(this._pt.b=l,this._pt.r=bQ);else if(f in a)NQ.call(this,e,f,l,u);else if(f in e)this.add(e,f,l||e[f],u,n,i);else{B_(f,u);continue}s.push(f)}}E&&u7(this)},get:pp,aliases:ga,getSetter:function(e,t,r){var n=ga[t];return n&&n.indexOf(",")<0&&(t=n),t in ya&&t!==xa&&(e._gsap.x||pp(e,"x"))?r&&eP===r?t==="scale"?SQ:EQ:(eP=r||{})&&(t==="scale"?wQ:MQ):e.style&&!k_(e.style[t])?AQ:~t.indexOf("-")?CQ:V_(e,t)},core:{_removeProperty:jh,_getMatrix:g7}};di.utils.checkPrefix=fp;(function(o,e,t,r){var n=bn(o+","+e+","+t,function(i){ya[i]=1});bn(e,function(i){Ko.units[i]="deg",mP[i]=1}),ga[n[13]]=o+","+e,bn(r,function(i){var s=i.split(":");ga[s[1]]=n[s[0]]})})("x,y,z,scale,scaleX,scaleY,xPercent,yPercent","rotation,rotationX,rotationY,skewX,skewY","transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective","0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY");bn("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",function(o){Ko.units[o]="px"});di.registerPlugin(v7);var Gi=di.registerPlugin(v7)||di,yEe=Gi.core.Tween;var Lh=(o=>(o.SET="set",o.ADD="add",o.SUBTRACT="subtract",o))(Lh||{});var zr=class{constructor(){this._timelineBuilders=[],this._duration=1,this._operation="set",this._delay=0,this._stoppable=!0,this._debug=!1}setDebug(e){this._debug=e}_printDebug(e){!this._debug||console.log(e)}addTimelineBuilder(e){this._timelineBuilders.push(e),e.setParent(this)}timelineBuilders(){return this._timelineBuilders}setParent(e){this._parent=e}parent(){return this._parent}setTarget(e){this._target=e;for(let t of this._timelineBuilders)t.setTarget(e)}target(){return this._target}setDuration(e){if(e>=0){this._duration=e;for(let t of this._timelineBuilders)t.setDuration(e)}}duration(){return this._duration}setKeyframes(e){this._keyframes=e}keyframes(){return this._keyframes}setEasing(e){this._easing=e;for(let t of this._timelineBuilders)t.setEasing(e)}easing(){return this._easing}setOperation(e){this._operation=e;for(let t of this._timelineBuilders)t.setOperation(e)}operation(){return this._operation}setRepeatParams(e){this._repeatParams=e;for(let t of this._timelineBuilders)t.setRepeatParams(e)}repeatParams(){return this._repeatParams}setDelay(e){this._delay=e;for(let t of this._timelineBuilders)t.setDelay(e)}delay(){return this._delay}setPosition(e){this._position=e}position(){return this._position}setStoppable(e){this._stoppable=e}stoppable(){return this._stoppable}setUpdateCallback(e){this._updateCallback=e}updateCallback(){return this._updateCallback}clone(){let e=new zr;if(e.setDuration(this._duration),e.setOperation(this._operation),e.setDelay(this._delay),this._target&&e.setTarget(this._target.clone()),this._easing&&e.setEasing(this._easing),this._keyframes&&e.setKeyframes(this._keyframes),this._delay&&e.setDelay(this._delay),this._updateCallback&&e.setUpdateCallback(this._updateCallback.clone()),this._repeatParams&&e.setRepeatParams({count:this._repeatParams.count,delay:this._repeatParams.delay,yoyo:this._repeatParams.yoyo}),this._property){let t=this._property.name();t&&e.setPropertyName(t);let r=this._property.targetValue();r!=null&&e.setPropertyValue(r)}this._position&&e.setPosition(this._position.clone()),e.setStoppable(this._stoppable);for(let t of this._timelineBuilders){let r=t.clone();e.addTimelineBuilder(r)}return e}setPropertyName(e){this.property().setName(e)}property(){return this._property=this._property||new Dh}propertyName(){return this.property().name()}setPropertyValue(e){this.property().setTargetValue(e)}propertyValue(){var e;return(e=this._property)==null?void 0:e.targetValue()}populate(e,t){var r;this._printDebug(["populate",this,e,this._timelineBuilders]);for(let n of this._timelineBuilders){let i=Gi.timeline();n.setDebug(this._debug),n.populate(i,t);let s=((r=n.position())==null?void 0:r.toParameter())||void 0;e.add(i,s)}this._property&&this._target&&(this._property.setDebug(this._debug),this._property.addToTimeline({timelineBuilder:this,timeline:e,target:this._target,...t}))}};var vP=class extends U{constructor(){super(...arguments);this.duration=y.FLOAT(1,{range:[0,10],rangeLocked:[!0,!1]})}},kQ=new vP,y7=class extends bo{constructor(){super(...arguments);this.paramsConfig=kQ}static type(){return"duration"}initializeNode(){this.io.inputs.setCount(0,1)}cook(e){let t=e[0]||new zr;t.setDuration(this.pv.duration),this.setTimelineBuilder(t)}};var yP=class extends U{constructor(){super(...arguments);this.name=y.INTEGER(E_.indexOf(Qu.POWER4),{menu:{entries:E_.map((e,t)=>({name:e,value:t}))}}),this.inOut=y.INTEGER(S_.indexOf(I6.OUT),{menu:{entries:S_.map((e,t)=>({name:e,value:t}))}})}},BQ=new yP,Xh=class extends bo{constructor(){super(...arguments);this.paramsConfig=BQ}static type(){return"easing"}initializeNode(){this.io.inputs.setCount(0,1)}static easingFullName(e){let t=E_[e.pv.name];if(t==Qu.NONE)return t;let r=S_[e.pv.inOut];return`${t}.${r}`}cook(e){let t=e[0]||new zr,r=Xh.easingFullName(this);t.setEasing(r),this.setTimelineBuilder(t)}};var H_=(o=>(o.RELATIVE="relative",o.ABSOLUTE="absolute",o))(H_||{});var j_=(o=>(o.START="start",o.END="end",o))(j_||{});var mp=class{constructor(){this._mode="relative",this._relativeTo="end",this._offset=0}clone(){let e=new mp;return e.setMode(this._mode),e.setRelativeTo(this._relativeTo),e.setOffset(this._offset),e}setMode(e){this._mode=e}mode(){return this._mode}setRelativeTo(e){this._relativeTo=e}relativeTo(){return this._relativeTo}setOffset(e){this._offset=e}offset(){return this._offset}toParameter(){switch(this._mode){case"relative":return this._relative_position_param();case"absolute":return this._absolutePositionParam()}Be.unreachable(this._mode)}_relative_position_param(){switch(this._relativeTo){case"end":return this._offsetString();case"start":return`<${this._offset}`}Be.unreachable(this._relativeTo)}_absolutePositionParam(){return this._offset}_offsetString(){return this._offset>0?`+=${this._offset}`:`-=${Math.abs(this._offset)}`}};var xP=["play all together","play one at a time"],FQ=4,bP=class extends U{constructor(){super(...arguments);this.mode=y.INTEGER(0,{menu:{entries:xP.map((e,t)=>({name:e,value:t}))}}),this.offset=y.FLOAT(0,{range:[-1,1]}),this.overridePositions=y.BOOLEAN(0),this.inputsCount=y.INTEGER(FQ,{range:[1,32],rangeLocked:[!0,!1],callback:e=>{W_.PARAM_CALLBACK_setInputsCount(e)}})}},UQ=new bP,W_=class extends bo{constructor(){super(...arguments);this.paramsConfig=UQ}static type(){return"merge"}initializeNode(){this.io.inputs.setCount(0,4),this.scene().dispatchController.onAddListener(()=>{this.params.addOnSceneLoadHook("update inputs",()=>{this._callbackUpdateInputsCount()})})}cook(e){let t=new zr,r=0;for(let n of e)n&&(r>0&&this._updateTimelineBuilder(n),t.addTimelineBuilder(n),r++);this.setTimelineBuilder(t)}_updateTimelineBuilder(e){let t=xP[this.pv.mode];switch(t){case"play all together":return this._setPlayAllTogether(e);case"play one at a time":return this._setPlayOneAtATime(e)}Be.unreachable(t)}_setPlayAllTogether(e){let t=e.position();(!t||this.pv.overridePositions)&&(t=new mp,t.setMode(H_.RELATIVE),t.setRelativeTo(j_.START),t.setOffset(this.pv.offset),e.setPosition(t))}_setPlayOneAtATime(e){let t=e.position();(!t||this.pv.overridePositions)&&(t=new mp,t.setMode(H_.RELATIVE),t.setRelativeTo(j_.END),t.setOffset(this.pv.offset),e.setPosition(t))}_callbackUpdateInputsCount(){this.io.inputs.setCount(1,this.pv.inputsCount),this.emit(Nt.INPUTS_UPDATED)}static PARAM_CALLBACK_setInputsCount(e){e._callbackUpdateInputsCount()}};var TP=class extends U{constructor(){super(...arguments);this.play=y.BUTTON(null,{callback:e=>{Yh.PARAM_CALLBACK_play(e)},hidden:!0}),this.pause=y.BUTTON(null,{callback:e=>{Yh.PARAM_CALLBACK_pause(e)},hidden:!0}),this.stoppable=y.BOOLEAN(1),this.debug=y.BOOLEAN(0)}},VQ=new TP,Yh=class extends bo{constructor(){super(...arguments);this.paramsConfig=VQ}static type(){return"null"}initializeNode(){this.io.inputs.setCount(0,1)}cook(e){let t=e[0]||new zr;t.setDebug(this.pv.debug),t.setStoppable(this.pv.stoppable),this.setTimelineBuilder(t)}async timelineBuilder(){let e=await this.compute();if(!e)return;let t=e.coreContent();if(!!t)return t}async play(){return new Promise(async e=>{this.pv.debug&&Q.log(`play from '${this.path()}'`);let t=!1;function r(){t||(t=!0,e())}let n=await this.timelineBuilder();!n||(this._timeline=Gi.timeline({onComplete:r}),n.populate(this._timeline,{registerproperties:!0}))})}async pause(){this._timeline&&this._timeline.pause()}static PARAM_CALLBACK_play(e){e.play()}static PARAM_CALLBACK_pause(e){e.pause()}};var GQ=["from","to"],AP=class extends U{constructor(){super(...arguments);this.play=y.BUTTON(null,{callback:e=>{Wc.PARAM_CALLBACK_play(e)},hidden:!0}),this.pause=y.BUTTON(null,{callback:e=>{Wc.PARAM_CALLBACK_pause(e)},hidden:!0}),this.reset=y.BUTTON(null,{callback:e=>{Wc.PARAM_CALLBACK_reset(e)},hidden:!0}),this.stoppable=y.BOOLEAN(1),this.debug=y.BOOLEAN(0),this.seek=y.FLOAT(0,{range:[0,1],rangeLocked:[!0,!0],cook:!1,callback:e=>{Wc.PARAM_CALLBACK_seek(e)}})}},zQ=new AP,Wc=class extends bo{constructor(){super(...arguments);this.paramsConfig=zQ}static type(){return"play"}static displayedInputNames(){return GQ}initializeNode(){this.io.inputs.setCount(2)}cook(e){let t=e[0]||new zr;this.setTimelineBuilder(t)}async timelineBuilder(e){let t=this.io.inputs.input(e);if(!t)return;let r=await t.compute();if(!r)return;let n=r.coreContentCloned();if(!!n)return n.setDebug(this.pv.debug),n.setStoppable(this.pv.stoppable),n}async _playFromInput(e){return new Promise(async t=>{let r=!1;function n(){r||(r=!0,t())}let i=await this.timelineBuilder(e);!i||(this._timeline=Gi.timeline({onComplete:n}),i.populate(this._timeline,{registerproperties:!0}))})}async play(){return this.pv.debug&&Q.log(`play from '${this.path()}'`),await this._playFromInput(1)}async reset(){return this.pv.debug&&Q.log(`reset from '${this.path()}'`),await this._playFromInput(0)}async pause(){this._timeline&&this._timeline.pause()}async seek(){let e=await this.timelineBuilder(0),t=await this.timelineBuilder(1);if(!(e&&t))return;let r=Gi.timeline({paused:!0});e.populate(r,{registerproperties:!1}),r.seek(r.duration()),r.kill();let n=Gi.timeline({paused:!0});t.populate(n,{registerproperties:!1}),n.seek(this.pv.seek*n.duration(),!1),n.kill()}static PARAM_CALLBACK_play(e){e.play()}static PARAM_CALLBACK_pause(e){e.pause()}static PARAM_CALLBACK_reset(e){e.reset()}static PARAM_CALLBACK_seek(e){e.seek()}};var CP=class extends U{constructor(){super(...arguments);this.name=y.STRING("position")}},HQ=new CP,x7=class extends bo{constructor(){super(...arguments);this.paramsConfig=HQ}static type(){return"propertyName"}initializeNode(){this.io.inputs.setCount(0,1)}cook(e){let t=e[0]||new zr;t.setPropertyName(this.pv.name),this.setTimelineBuilder(t)}};var _p=["custom","from scene graph","from node"],Ta=_p.indexOf("custom"),q_=_p.indexOf("from scene graph"),b7=_p.indexOf("from node"),EP=class extends U{constructor(){super(...arguments);this.mode=y.INTEGER(Ta,{menu:{entries:_p.map((e,t)=>({name:e,value:t}))}}),this.nodePath=y.NODE_PATH("",{visibleIf:{mode:b7}}),this.objectMask=y.STRING("*geo1",{visibleIf:{mode:q_}}),this.printResolve=y.BUTTON(null,{visibleIf:{mode:q_},callback:e=>{X_.PARAM_CALLBACK_printResolve(e)}}),this.overridePropertyName=y.BOOLEAN(0,{visibleIf:[{mode:q_},{mode:b7}]}),this.propertyName=y.STRING("",{visibleIf:[{overridePropertyName:!0,mode:q_},{overridePropertyName:!0,mode:b7}]}),this.size=y.INTEGER(3,{range:[1,4],rangeLocked:[!0,!0],visibleIf:{mode:Ta},separatorAfter:!0}),this.value1=y.FLOAT(0,{visibleIf:{mode:Ta,size:1}}),this.value2=y.VECTOR2([0,0],{visibleIf:{mode:Ta,size:2}}),this.value3=y.VECTOR3([0,0,0],{visibleIf:{mode:Ta,size:3,asColor:!1}}),this.color=y.COLOR([0,0,0],{visibleIf:{mode:Ta,size:3,asColor:!0}}),this.value4=y.VECTOR4([0,0,0,0],{visibleIf:{mode:Ta,size:4}}),this.asColor=y.BOOLEAN(0,{visibleIf:{mode:Ta,size:3}})}},jQ=new EP,X_=class extends bo{constructor(){super(...arguments);this.paramsConfig=jQ}static type(){return"propertyValue"}initializeNode(){this.io.inputs.setCount(0,1)}async cook(e){let t=e[0]||new zr;await this._prepareTimelineBuilder(t),this.setTimelineBuilder(t)}setMode(e){this.p.mode.set(_p.indexOf(e))}async _prepareTimelineBuilder(e){let t=_p[this.pv.mode];switch(t){case"custom":return this._prepareTimebuilderCustom(e);case"from scene graph":return this._prepareTimebuilderFromSceneGraph(e);case"from node":return await this._prepareTimebuilderFromNode(e)}Be.unreachable(t)}_prepareTimebuilderCustom(e){switch(this.pv.size){case 1:return e.setPropertyValue(this.pv.value1);case 2:return e.setPropertyValue(this.pv.value2);case 3:return this.pv.asColor?e.setPropertyValue(this.pv.color):e.setPropertyValue(this.pv.value3);case 4:return e.setPropertyValue(this.pv.value4)}}_prepareTimebuilderFromSceneGraph(e){let t=this.pv.overridePropertyName?this.pv.propertyName:e.propertyName();if(!t)return;let r=this._foundObjectFromSceneGraph();if(r){let n=r[t];n&&(K.isNumber(n)||K.isVector(n)||n instanceof It)&&e.setPropertyValue(n)}}async _prepareTimebuilderFromNode(e){let t=this.pv.overridePropertyName?this.pv.propertyName:e.propertyName();if(!t)return;let r=this.pv.nodePath.node();if(!r)return;let n=r.params.get(t);if(!n)return;n.isDirty()&&await n.compute();let i=n.value;i&&(K.isNumber(i)||K.isVector(i))&&e.setPropertyValue(i)}static PARAM_CALLBACK_printResolve(e){e.printResolve()}_foundObjectFromSceneGraph(){return this.scene().findObjectByMask(this.pv.objectMask)}printResolve(){let e=this._foundObjectFromSceneGraph();console.log(e)}};var gp=class{constructor(e,t){this._scene=e,this._options=t}clone(){return new gp(this._scene,this._options)}objects(){let e=this._options.objectMask;if(!!e)return this._scene.objectsByMask(e)}node(){if(!this._options.node)return;let e=this._options.node;return e.relativeTo.node(e.path)}};var $h=class{constructor(){this._update_matrix=!1}clone(){let e=new $h;return e.setUpdateMatrix(this._update_matrix),e}setUpdateMatrix(e){this._update_matrix=e}updateMatrix(){return this._update_matrix}};var qc=["scene graph","node"],T7=qc.indexOf("scene graph"),WQ=qc.indexOf("node"),SP=class extends U{constructor(){super(...arguments);this.type=y.INTEGER(T7,{menu:{entries:qc.map((e,t)=>({name:e,value:t}))}}),this.nodePath=y.NODE_PATH("",{visibleIf:{type:WQ}}),this.objectMask=y.STRING("/geo*",{visibleIf:{type:T7}}),this.updateMatrix=y.BOOLEAN(1,{visibleIf:{type:T7}}),this.printResolve=y.BUTTON(null,{callback:(e,t)=>{Y_.PARAM_CALLBACK_print_resolve(e)}})}},qQ=new SP,Y_=class extends bo{constructor(){super(...arguments);this.paramsConfig=qQ}static type(){return"target"}initializeNode(){this.io.inputs.setCount(0,1)}cook(e){let t=e[0]||new zr,r=this._create_target(t);t.setTarget(r),this._set_update_callback(t),this.setTimelineBuilder(t)}setTargetType(e){this.p.type.set(qc.indexOf(e))}_create_target(e){let t=qc[this.pv.type];switch(t){case"node":return new gp(this.scene(),{node:{path:this.pv.nodePath.path(),relativeTo:this}});case"scene graph":return new gp(this.scene(),{objectMask:this.pv.objectMask})}Be.unreachable(t)}_set_update_callback(e){let t=qc[this.pv.type],r=e.updateCallback();switch(t){case"node":return;case"scene graph":{this.pv.updateMatrix&&(r=r||new $h,r.setUpdateMatrix(this.pv.updateMatrix),e.setUpdateCallback(r));return}}Be.unreachable(t)}static PARAM_CALLBACK_print_resolve(e){e.print_resolve()}print_resolve(){let e=qc[this.pv.type],t=new zr,r=this._create_target(t);switch(e){case"node":return console.log(r.node());case"scene graph":return console.log(r.objects())}}};var $_="input audio properties",XQ=[$_,$_,$_,$_],Zr=class extends fr{constructor(){super(...arguments);this.flags=new ah(this)}static context(){return oe.AUDIO}static displayedInputNames(){return XQ}initializeBaseNode(){this.io.outputs.setHasOneOutput()}setAudioBuilder(e){this._setContainer(e)}};var Hn=class{setAudioNode(e){this._audioNode=e}audioNode(){return this._audioNode}setSource(e){this._source=e,this._audioNode||this.setAudioNode(e)}source(){return this._source}setInstrument(e){this._instrument=e,this._audioNode||this.setAudioNode(e)}instrument(){return this._instrument}setOscillatorParams(e){this._oscillatorParams=e}oscillatorParams(){return this._oscillatorParams}setEnvelopeParams(e){this._envelopeParams=e}envelopeParams(){return this._envelopeParams}clone(){let e=new Hn;return e.setAudioNode(this._audioNode),e.setSource(this._source),e.setInstrument(this._instrument),e.setEnvelopeParams(this._envelopeParams),e}};var An=Ni(A7());var FP=()=>new DOMException("","AbortError");var UP=o=>(e,t,[r,n,i],s)=>{o(e[n],[t,r,i],a=>a[0]===t&&a[1]===r,s)};var VP=o=>(e,t,r)=>{let n=[];for(let i=0;i<r.numberOfInputs;i+=1)n.push(new Set);o.set(e,{activeInputs:n,outputs:new Set,passiveInputs:new WeakMap,renderer:t})};var GP=o=>(e,t)=>{o.set(e,{activeInputs:new Set,passiveInputs:new WeakMap,renderer:t})};var ks=new WeakSet,J_=new WeakMap,vp=new WeakMap,Z_=new WeakMap,nf=new WeakMap,yp=new WeakMap,Q_=new WeakMap,sf=new WeakMap,af=new WeakMap,cf=new WeakMap;var zP={construct(){return zP}},HP=o=>{try{let e=new Proxy(o,zP);new e}catch{return!1}return!0};var jP=/^import(?:(?:[\s]+[\w]+|(?:[\s]+[\w]+[\s]*,)?[\s]*\{[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?(?:[\s]*,[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?)*[\s]*}|(?:[\s]+[\w]+[\s]*,)?[\s]*\*[\s]+as[\s]+[\w]+)[\s]+from)?(?:[\s]*)("([^"\\]|\\.)+"|'([^'\\]|\\.)+')(?:[\s]*);?/,C7=(o,e)=>{let t=[],r=o.replace(/^[\s]+/,""),n=r.match(jP);for(;n!==null;){let i=n[1].slice(1,-1),s=n[0].replace(/([\s]+)?;?$/,"").replace(i,new URL(i,e).toString());t.push(s),r=r.slice(n[0].length).replace(/^[\s]+/,""),n=r.match(jP)}return[t.join(";"),r]};var WP=o=>{if(o!==void 0&&!Array.isArray(o))throw new TypeError("The parameterDescriptors property of given value for processorCtor is not an array.")},qP=o=>{if(!HP(o))throw new TypeError("The given value for processorCtor should be a constructor.");if(o.prototype===null||typeof o.prototype!="object")throw new TypeError("The given value for processorCtor should have a prototype.")},XP=(o,e,t,r,n,i,s,a,c,l,u,p,d)=>{let h=0;return(m,f,v={credentials:"omit"})=>{let g=u.get(m);if(g!==void 0&&g.has(f))return Promise.resolve();let _=l.get(m);if(_!==void 0){let x=_.get(f);if(x!==void 0)return x}let T=i(m),b=T.audioWorklet===void 0?n(f).then(([x,A])=>{let[E,S]=C7(x,A),w=`${E};((a,b)=>{(a[b]=a[b]||[]).push((AudioWorkletProcessor,global,registerProcessor,sampleRate,self,window)=>{${S}
})})(window,'_AWGS')`;return t(w)}).then(()=>{let x=d._AWGS.pop();if(x===void 0)throw new SyntaxError;r(T.currentTime,T.sampleRate,()=>x(class{},void 0,(A,E)=>{if(A.trim()==="")throw e();let S=af.get(T);if(S!==void 0){if(S.has(A))throw e();qP(E),WP(E.parameterDescriptors),S.set(A,E)}else qP(E),WP(E.parameterDescriptors),af.set(T,new Map([[A,E]]))},T.sampleRate,void 0,void 0))}):Promise.all([n(f),Promise.resolve(o(p,p))]).then(([[x,A],E])=>{let S=h+1;h=S;let[w,O]=C7(x,A),D=`${w};((AudioWorkletProcessor,registerProcessor)=>{${O}
})(${E?"AudioWorkletProcessor":"class extends AudioWorkletProcessor {__b=new WeakSet();constructor(){super();(p=>p.postMessage=(q=>(m,t)=>q.call(p,m,t?t.filter(u=>!this.__b.has(u)):t))(p.postMessage))(this.port)}}"},(n,p)=>registerProcessor(n,class extends p{${E?"":"__c = (a) => a.forEach(e=>this.__b.add(e.buffer));"}process(i,o,p){${E?"":"i.forEach(this.__c);o.forEach(this.__c);this.__c(Object.values(p));"}return super.process(i.map(j=>j.some(k=>k.length===0)?[]:j),o,p)}}));registerProcessor('__sac${S}',class extends AudioWorkletProcessor{process(){return !1}})`,V=new Blob([D],{type:"application/javascript; charset=utf-8"}),F=URL.createObjectURL(V);return T.audioWorklet.addModule(F,v).then(()=>{if(a(T))return T;let j=s(T);return j.audioWorklet.addModule(F,v).then(()=>j)}).then(j=>{if(c===null)throw new SyntaxError;try{new c(j,`__sac${S}`)}catch{throw new SyntaxError}}).finally(()=>URL.revokeObjectURL(F))});return _===void 0?l.set(m,new Map([[f,b]])):_.set(f,b),b.then(()=>{let x=u.get(m);x===void 0?u.set(m,new Set([f])):x.add(f)}).finally(()=>{let x=l.get(m);x!==void 0&&x.delete(f)}),b}};var Hr=(o,e)=>{let t=o.get(e);if(t===void 0)throw new Error("A value with the given key could not be found.");return t};var Aa=(o,e)=>{let t=Array.from(o).filter(e);if(t.length>1)throw Error("More than one element was found.");if(t.length===0)throw Error("No element was found.");let[r]=t;return o.delete(r),r};var e9=(o,e,t,r)=>{let n=Hr(o,e),i=Aa(n,s=>s[0]===t&&s[1]===r);return n.size===0&&o.delete(e),i};var Bs=o=>Hr(Q_,o);var zi=o=>{if(ks.has(o))throw new Error("The AudioNode is already stored.");ks.add(o),Bs(o).forEach(e=>e(!0))};var t9=o=>"port"in o;var Fs=o=>{if(!ks.has(o))throw new Error("The AudioNode is not stored.");ks.delete(o),Bs(o).forEach(e=>e(!1))};var lf=(o,e)=>{!t9(o)&&e.every(t=>t.size===0)&&Fs(o)};var YP=(o,e,t,r,n,i,s,a,c,l,u,p,d)=>{let h=new WeakMap;return(m,f,v,g,_)=>{let{activeInputs:T,passiveInputs:b}=i(f),{outputs:x}=i(m),A=a(m),E=S=>{let w=c(f),O=c(m);if(S){let C=e9(b,m,v,g);o(T,m,C,!1),!_&&!p(m)&&t(O,w,v,g),d(f)&&zi(f)}else{let C=r(T,m,v,g);e(b,g,C,!1),!_&&!p(m)&&n(O,w,v,g);let N=s(f);if(N===0)u(f)&&lf(f,T);else{let R=h.get(f);R!==void 0&&clearTimeout(R),h.set(f,setTimeout(()=>{u(f)&&lf(f,T)},N*1e3))}}};return l(x,[f,v,g],S=>S[0]===f&&S[1]===v&&S[2]===g,!0)?(A.add(E),u(m)?o(T,m,[v,g,E],!0):e(b,g,[m,v,E],!0),!0):!1}};var $P=o=>(e,t,[r,n,i],s)=>{let a=e.get(r);a===void 0?e.set(r,new Set([[n,t,i]])):o(a,[n,t,i],c=>c[0]===n&&c[1]===t,s)};var KP=o=>(e,t)=>{let r=o(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});t.connect(r).connect(e.destination);let n=()=>{t.removeEventListener("ended",n),t.disconnect(r),r.disconnect()};t.addEventListener("ended",n)};var JP=o=>(e,t)=>{o(e).add(t)};var see={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",fftSize:2048,maxDecibels:-30,minDecibels:-100,smoothingTimeConstant:.8},ZP=(o,e,t,r,n,i)=>class extends o{constructor(a,c){let l=n(a),u={...see,...c},p=r(l,u),d=i(l)?e():null;super(a,!1,p,d);this._nativeAnalyserNode=p}get fftSize(){return this._nativeAnalyserNode.fftSize}set fftSize(a){this._nativeAnalyserNode.fftSize=a}get frequencyBinCount(){return this._nativeAnalyserNode.frequencyBinCount}get maxDecibels(){return this._nativeAnalyserNode.maxDecibels}set maxDecibels(a){let c=this._nativeAnalyserNode.maxDecibels;if(this._nativeAnalyserNode.maxDecibels=a,!(a>this._nativeAnalyserNode.minDecibels))throw this._nativeAnalyserNode.maxDecibels=c,t()}get minDecibels(){return this._nativeAnalyserNode.minDecibels}set minDecibels(a){let c=this._nativeAnalyserNode.minDecibels;if(this._nativeAnalyserNode.minDecibels=a,!(this._nativeAnalyserNode.maxDecibels>a))throw this._nativeAnalyserNode.minDecibels=c,t()}get smoothingTimeConstant(){return this._nativeAnalyserNode.smoothingTimeConstant}set smoothingTimeConstant(a){this._nativeAnalyserNode.smoothingTimeConstant=a}getByteFrequencyData(a){this._nativeAnalyserNode.getByteFrequencyData(a)}getByteTimeDomainData(a){this._nativeAnalyserNode.getByteTimeDomainData(a)}getFloatFrequencyData(a){this._nativeAnalyserNode.getFloatFrequencyData(a)}getFloatTimeDomainData(a){this._nativeAnalyserNode.getFloatTimeDomainData(a)}};var Lt=(o,e)=>o.context===e;var QP=(o,e,t)=>()=>{let r=new WeakMap,n=async(i,s)=>{let a=e(i);if(!Lt(a,s)){let l={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,fftSize:a.fftSize,maxDecibels:a.maxDecibels,minDecibels:a.minDecibels,smoothingTimeConstant:a.smoothingTimeConstant};a=o(s,l)}return r.set(s,a),await t(i,s,a),a};return{render(i,s){let a=r.get(s);return a!==void 0?Promise.resolve(a):n(i,s)}}};var xp=o=>{try{o.copyToChannel(new Float32Array(1),0,-1)}catch{return!1}return!0};var hi=()=>new DOMException("","IndexSizeError");var bp=o=>{o.getChannelData=(e=>t=>{try{return e.call(o,t)}catch(r){throw r.code===12?hi():r}})(o.getChannelData)};var aee={numberOfChannels:1},eR=(o,e,t,r,n,i,s,a)=>{let c=null;return class tR{constructor(u){if(n===null)throw new Error("Missing the native OfflineAudioContext constructor.");let{length:p,numberOfChannels:d,sampleRate:h}={...aee,...u};c===null&&(c=new n(1,1,44100));let m=r!==null&&e(i,i)?new r({length:p,numberOfChannels:d,sampleRate:h}):c.createBuffer(d,p,h);if(m.numberOfChannels===0)throw t();return typeof m.copyFromChannel!="function"?(s(m),bp(m)):e(xp,()=>xp(m))||a(m),o.add(m),m}static[Symbol.hasInstance](u){return u!==null&&typeof u=="object"&&Object.getPrototypeOf(u)===tR.prototype||o.has(u)}}};var kr=-34028234663852886e22,Nr=-kr;var Zo=o=>ks.has(o);var cee={buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1},rR=(o,e,t,r,n,i,s,a)=>class extends o{constructor(l,u){let p=i(l),d={...cee,...u},h=n(p,d),m=s(p),f=m?e():null;super(l,!1,h,f);this._audioBufferSourceNodeRenderer=f,this._isBufferNullified=!1,this._isBufferSet=d.buffer!==null,this._nativeAudioBufferSourceNode=h,this._onended=null,this._playbackRate=t(this,m,h.playbackRate,Nr,kr)}get buffer(){return this._isBufferNullified?null:this._nativeAudioBufferSourceNode.buffer}set buffer(l){if(this._nativeAudioBufferSourceNode.buffer=l,l!==null){if(this._isBufferSet)throw r();this._isBufferSet=!0}}get loop(){return this._nativeAudioBufferSourceNode.loop}set loop(l){this._nativeAudioBufferSourceNode.loop=l}get loopEnd(){return this._nativeAudioBufferSourceNode.loopEnd}set loopEnd(l){this._nativeAudioBufferSourceNode.loopEnd=l}get loopStart(){return this._nativeAudioBufferSourceNode.loopStart}set loopStart(l){this._nativeAudioBufferSourceNode.loopStart=l}get onended(){return this._onended}set onended(l){let u=typeof l=="function"?a(this,l):null;this._nativeAudioBufferSourceNode.onended=u;let p=this._nativeAudioBufferSourceNode.onended;this._onended=p!==null&&p===u?l:p}get playbackRate(){return this._playbackRate}start(l=0,u=0,p){if(this._nativeAudioBufferSourceNode.start(l,u,p),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.start=p===void 0?[l,u]:[l,u,p]),this.context.state!=="closed"){zi(this);let d=()=>{this._nativeAudioBufferSourceNode.removeEventListener("ended",d),Zo(this)&&Fs(this)};this._nativeAudioBufferSourceNode.addEventListener("ended",d)}}stop(l=0){this._nativeAudioBufferSourceNode.stop(l),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.stop=l)}};var oR=(o,e,t,r,n)=>()=>{let i=new WeakMap,s=null,a=null,c=async(l,u)=>{let p=t(l),d=Lt(p,u);if(!d){let h={buffer:p.buffer,channelCount:p.channelCount,channelCountMode:p.channelCountMode,channelInterpretation:p.channelInterpretation,loop:p.loop,loopEnd:p.loopEnd,loopStart:p.loopStart,playbackRate:p.playbackRate.value};p=e(u,h),s!==null&&p.start(...s),a!==null&&p.stop(a)}return i.set(u,p),d?await o(u,l.playbackRate,p.playbackRate):await r(u,l.playbackRate,p.playbackRate),await n(l,u,p),p};return{set start(l){s=l},set stop(l){a=l},render(l,u){let p=i.get(u);return p!==void 0?Promise.resolve(p):c(l,u)}}};var nR=o=>"playbackRate"in o;var iR=o=>"frequency"in o&&"gain"in o;var sR=o=>"offset"in o;var aR=o=>!("frequency"in o)&&"gain"in o;var cR=o=>"detune"in o&&"frequency"in o;var lR=o=>"pan"in o;var Qr=o=>Hr(J_,o);var Ca=o=>Hr(Z_,o);var r9=(o,e)=>{let{activeInputs:t}=Qr(o);t.forEach(n=>n.forEach(([i])=>{e.includes(o)||r9(i,[...e,o])}));let r=nR(o)?[o.playbackRate]:t9(o)?Array.from(o.parameters.values()):iR(o)?[o.Q,o.detune,o.frequency,o.gain]:sR(o)?[o.offset]:aR(o)?[o.gain]:cR(o)?[o.detune,o.frequency]:lR(o)?[o.pan]:[];for(let n of r){let i=Ca(n);i!==void 0&&i.activeInputs.forEach(([s])=>r9(s,e))}Zo(o)&&Fs(o)};var Ea=o=>{r9(o.destination,[])};var o9=o=>o===void 0||typeof o=="number"||typeof o=="string"&&(o==="balanced"||o==="interactive"||o==="playback");var uR=(o,e,t,r,n,i,s,a,c)=>class extends o{constructor(u={}){if(c===null)throw new Error("Missing the native AudioContext constructor.");let p;try{p=new c(u)}catch(m){throw m.code===12&&m.message==="sampleRate is not in range"?t():m}if(p===null)throw r();if(!o9(u.latencyHint))throw new TypeError(`The provided value '${u.latencyHint}' is not a valid enum value of type AudioContextLatencyCategory.`);if(u.sampleRate!==void 0&&p.sampleRate!==u.sampleRate)throw t();super(p,2);let{latencyHint:d}=u,{sampleRate:h}=p;if(this._baseLatency=typeof p.baseLatency=="number"?p.baseLatency:d==="balanced"?512/h:d==="interactive"||d===void 0?256/h:d==="playback"?1024/h:Math.max(2,Math.min(128,Math.round(d*h/128)))*128/h,this._nativeAudioContext=p,c.name==="webkitAudioContext"?(this._nativeGainNode=p.createGain(),this._nativeOscillatorNode=p.createOscillator(),this._nativeGainNode.gain.value=1e-37,this._nativeOscillatorNode.connect(this._nativeGainNode).connect(p.destination),this._nativeOscillatorNode.start()):(this._nativeGainNode=null,this._nativeOscillatorNode=null),this._state=null,p.state==="running"){this._state="suspended";let m=()=>{this._state==="suspended"&&(this._state=null),p.removeEventListener("statechange",m)};p.addEventListener("statechange",m)}}get baseLatency(){return this._baseLatency}get state(){return this._state!==null?this._state:this._nativeAudioContext.state}close(){return this.state==="closed"?this._nativeAudioContext.close().then(()=>{throw e()}):(this._state==="suspended"&&(this._state=null),this._nativeAudioContext.close().then(()=>{this._nativeGainNode!==null&&this._nativeOscillatorNode!==null&&(this._nativeOscillatorNode.stop(),this._nativeGainNode.disconnect(),this._nativeOscillatorNode.disconnect()),Ea(this)}))}createMediaElementSource(u){return new n(this,{mediaElement:u})}createMediaStreamDestination(){return new i(this)}createMediaStreamSource(u){return new s(this,{mediaStream:u})}createMediaStreamTrackSource(u){return new a(this,{mediaStreamTrack:u})}resume(){return this._state==="suspended"?new Promise((u,p)=>{let d=()=>{this._nativeAudioContext.removeEventListener("statechange",d),this._nativeAudioContext.state==="running"?u():this.resume().then(u,p)};this._nativeAudioContext.addEventListener("statechange",d)}):this._nativeAudioContext.resume().catch(u=>{throw u===void 0||u.code===15?e():u})}suspend(){return this._nativeAudioContext.suspend().catch(u=>{throw u===void 0?e():u})}};var pR=(o,e,t,r,n,i,s,a)=>class extends o{constructor(l,u){let p=i(l),d=s(p),h=n(p,u,d),m=d?e(a):null;super(l,!1,h,m);this._isNodeOfNativeOfflineAudioContext=d,this._nativeAudioDestinationNode=h}get channelCount(){return this._nativeAudioDestinationNode.channelCount}set channelCount(l){if(this._isNodeOfNativeOfflineAudioContext)throw r();if(l>this._nativeAudioDestinationNode.maxChannelCount)throw t();this._nativeAudioDestinationNode.channelCount=l}get channelCountMode(){return this._nativeAudioDestinationNode.channelCountMode}set channelCountMode(l){if(this._isNodeOfNativeOfflineAudioContext)throw r();this._nativeAudioDestinationNode.channelCountMode=l}get maxChannelCount(){return this._nativeAudioDestinationNode.maxChannelCount}};var dR=o=>{let e=new WeakMap,t=async(r,n)=>{let i=n.destination;return e.set(n,i),await o(r,n,i),i};return{render(r,n){let i=e.get(n);return i!==void 0?Promise.resolve(i):t(r,n)}}};var hR=(o,e,t,r,n,i,s,a)=>(c,l)=>{let u=l.listener,p=()=>{let x=new Float32Array(1),A=e(l,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:9}),E=s(l),S=!1,w=[0,0,-1,0,1,0],O=[0,0,0],C=()=>{if(S)return;S=!0;let V=r(l,256,9,0);V.onaudioprocess=({inputBuffer:F})=>{let j=[i(F,x,0),i(F,x,1),i(F,x,2),i(F,x,3),i(F,x,4),i(F,x,5)];j.some((Y,H)=>Y!==w[H])&&(u.setOrientation(...j),w=j);let $=[i(F,x,6),i(F,x,7),i(F,x,8)];$.some((Y,H)=>Y!==O[H])&&(u.setPosition(...$),O=$)},A.connect(V)},N=V=>F=>{F!==w[V]&&(w[V]=F,u.setOrientation(...w))},R=V=>F=>{F!==O[V]&&(O[V]=F,u.setPosition(...O))},D=(V,F,j)=>{let $=t(l,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:F});$.connect(A,0,V),$.start(),Object.defineProperty($.offset,"defaultValue",{get(){return F}});let Y=o({context:c},E,$.offset,Nr,kr);return a(Y,"value",H=>()=>H.call(Y),H=>B=>{try{H.call(Y,B)}catch(te){if(te.code!==9)throw te}C(),E&&j(B)}),Y.cancelAndHoldAtTime=(H=>E?()=>{throw n()}:(...B)=>{let te=H.apply(Y,B);return C(),te})(Y.cancelAndHoldAtTime),Y.cancelScheduledValues=(H=>E?()=>{throw n()}:(...B)=>{let te=H.apply(Y,B);return C(),te})(Y.cancelScheduledValues),Y.exponentialRampToValueAtTime=(H=>E?()=>{throw n()}:(...B)=>{let te=H.apply(Y,B);return C(),te})(Y.exponentialRampToValueAtTime),Y.linearRampToValueAtTime=(H=>E?()=>{throw n()}:(...B)=>{let te=H.apply(Y,B);return C(),te})(Y.linearRampToValueAtTime),Y.setTargetAtTime=(H=>E?()=>{throw n()}:(...B)=>{let te=H.apply(Y,B);return C(),te})(Y.setTargetAtTime),Y.setValueAtTime=(H=>E?()=>{throw n()}:(...B)=>{let te=H.apply(Y,B);return C(),te})(Y.setValueAtTime),Y.setValueCurveAtTime=(H=>E?()=>{throw n()}:(...B)=>{let te=H.apply(Y,B);return C(),te})(Y.setValueCurveAtTime),Y};return{forwardX:D(0,0,N(0)),forwardY:D(1,0,N(1)),forwardZ:D(2,-1,N(2)),positionX:D(6,0,R(0)),positionY:D(7,0,R(1)),positionZ:D(8,0,R(2)),upX:D(3,0,N(3)),upY:D(4,1,N(4)),upZ:D(5,0,N(5))}},{forwardX:d,forwardY:h,forwardZ:m,positionX:f,positionY:v,positionZ:g,upX:_,upY:T,upZ:b}=u.forwardX===void 0?p():u;return{get forwardX(){return d},get forwardY(){return h},get forwardZ(){return m},get positionX(){return f},get positionY(){return v},get positionZ(){return g},get upX(){return _},get upY(){return T},get upZ(){return b}}};var Xc=o=>"context"in o;var Sa=o=>Xc(o[0]);var Hi=(o,e,t,r)=>{for(let n of o)if(t(n)){if(r)return!1;throw Error("The set contains at least one similar element.")}return o.add(e),!0};var E7=(o,e,[t,r],n)=>{Hi(o,[e,t,r],i=>i[0]===e&&i[1]===t,n)};var S7=(o,[e,t,r],n)=>{let i=o.get(e);i===void 0?o.set(e,new Set([[t,r]])):Hi(i,[t,r],s=>s[0]===t,n)};var fi=o=>"inputs"in o;var Tp=(o,e,t,r)=>{if(fi(e)){let n=e.inputs[r];return o.connect(n,t,0),[n,t,0]}return o.connect(e,t,r),[e,t,r]};var w7=(o,e,t)=>{for(let r of o)if(r[0]===e&&r[1]===t)return o.delete(r),r;return null};var fR=(o,e,t)=>Aa(o,r=>r[0]===e&&r[1]===t);var M7=(o,e)=>{if(!Bs(o).delete(e))throw new Error("Missing the expected event listener.")};var N7=(o,e,t)=>{let r=Hr(o,e),n=Aa(r,i=>i[0]===t);return r.size===0&&o.delete(e),n};var Ap=(o,e,t,r)=>{fi(e)?o.disconnect(e.inputs[r],t,0):o.disconnect(e,t,r)};var Jt=o=>Hr(vp,o);var Yc=o=>Hr(nf,o);var T0=o=>sf.has(o);var Cp=o=>!ks.has(o);var O7=(o,e)=>new Promise(t=>{if(e!==null)t(!0);else{let r=o.createScriptProcessor(256,1,1),n=o.createGain(),i=o.createBuffer(1,2,44100),s=i.getChannelData(0);s[0]=1,s[1]=1;let a=o.createBufferSource();a.buffer=i,a.loop=!0,a.connect(r).connect(o.destination),a.connect(n),a.disconnect(n),r.onaudioprocess=c=>{let l=c.inputBuffer.getChannelData(0);Array.prototype.some.call(l,u=>u===1)?t(!0):t(!1),a.stop(),r.onaudioprocess=null,a.disconnect(r),r.disconnect(o.destination)},a.start()}});var n9=(o,e)=>{let t=new Map;for(let r of o)for(let n of r){let i=t.get(n);t.set(n,i===void 0?1:i+1)}t.forEach((r,n)=>e(n,r))};var $c=o=>"context"in o;var mR=o=>{let e=new Map;o.connect=(t=>(r,n=0,i=0)=>{let s=$c(r)?t(r,n,i):t(r,n),a=e.get(r);return a===void 0?e.set(r,[{input:i,output:n}]):a.every(c=>c.input!==i||c.output!==n)&&a.push({input:i,output:n}),s})(o.connect.bind(o)),o.disconnect=(t=>(r,n,i)=>{if(t.apply(o),r===void 0)e.clear();else if(typeof r=="number")for(let[s,a]of e){let c=a.filter(l=>l.output!==r);c.length===0?e.delete(s):e.set(s,c)}else if(e.has(r))if(n===void 0)e.delete(r);else{let s=e.get(r);if(s!==void 0){let a=s.filter(c=>c.output!==n&&(c.input!==i||i===void 0));a.length===0?e.delete(r):e.set(r,a)}}for(let[s,a]of e)a.forEach(c=>{$c(s)?o.connect(s,c.output,c.input):o.connect(s,c.output)})})(o.disconnect)};var lee=(o,e,t,r)=>{let{activeInputs:n,passiveInputs:i}=Ca(e),{outputs:s}=Qr(o),a=Bs(o),c=l=>{let u=Jt(o),p=Yc(e);if(l){let d=N7(i,o,t);E7(n,o,d,!1),!r&&!T0(o)&&u.connect(p,t)}else{let d=fR(n,o,t);S7(i,d,!1),!r&&!T0(o)&&u.disconnect(p,t)}};return Hi(s,[e,t],l=>l[0]===e&&l[1]===t,!0)?(a.add(c),Zo(o)?E7(n,o,[t,c],!0):S7(i,[o,t,c],!0),!0):!1},uee=(o,e,t,r)=>{let{activeInputs:n,passiveInputs:i}=Qr(e),s=w7(n[r],o,t);return s===null?[e9(i,o,t,r)[2],!1]:[s[2],!0]},pee=(o,e,t)=>{let{activeInputs:r,passiveInputs:n}=Ca(e),i=w7(r,o,t);return i===null?[N7(n,o,t)[1],!1]:[i[2],!0]},P7=(o,e,t,r,n)=>{let[i,s]=uee(o,t,r,n);if(i!==null&&(M7(o,i),s&&!e&&!T0(o)&&Ap(Jt(o),Jt(t),r,n)),Zo(t)){let{activeInputs:a}=Qr(t);lf(t,a)}},R7=(o,e,t,r)=>{let[n,i]=pee(o,t,r);n!==null&&(M7(o,n),i&&!e&&!T0(o)&&Jt(o).disconnect(Yc(t),r))},dee=(o,e)=>{let t=Qr(o),r=[];for(let n of t.outputs)Sa(n)?P7(o,e,...n):R7(o,e,...n),r.push(n[0]);return t.outputs.clear(),r},hee=(o,e,t)=>{let r=Qr(o),n=[];for(let i of r.outputs)i[1]===t&&(Sa(i)?P7(o,e,...i):R7(o,e,...i),n.push(i[0]),r.outputs.delete(i));return n},fee=(o,e,t,r,n)=>{let i=Qr(o);return Array.from(i.outputs).filter(s=>s[0]===t&&(r===void 0||s[1]===r)&&(n===void 0||s[2]===n)).map(s=>(Sa(s)?P7(o,e,...s):R7(o,e,...s),i.outputs.delete(s),s[0]))},_R=(o,e,t,r,n,i,s,a,c,l,u,p,d,h,m,f)=>class extends l{constructor(g,_,T,b){super(T);this._context=g,this._nativeAudioNode=T;let x=u(g);p(x)&&t(O7,()=>O7(x,f))!==!0&&mR(T),vp.set(this,T),Q_.set(this,new Set),g.state!=="closed"&&_&&zi(this),o(this,b,T)}get channelCount(){return this._nativeAudioNode.channelCount}set channelCount(g){this._nativeAudioNode.channelCount=g}get channelCountMode(){return this._nativeAudioNode.channelCountMode}set channelCountMode(g){this._nativeAudioNode.channelCountMode=g}get channelInterpretation(){return this._nativeAudioNode.channelInterpretation}set channelInterpretation(g){this._nativeAudioNode.channelInterpretation=g}get context(){return this._context}get numberOfInputs(){return this._nativeAudioNode.numberOfInputs}get numberOfOutputs(){return this._nativeAudioNode.numberOfOutputs}connect(g,_=0,T=0){if(_<0||_>=this._nativeAudioNode.numberOfOutputs)throw n();let b=u(this._context),x=m(b);if(d(g)||h(g))throw i();if(Xc(g)){let S=Jt(g);try{let O=Tp(this._nativeAudioNode,S,_,T),C=Cp(this);(x||C)&&this._nativeAudioNode.disconnect(...O),this.context.state!=="closed"&&!C&&Cp(g)&&zi(g)}catch(O){throw O.code===12?i():O}if(e(this,g,_,T,x)){let O=c([this],g);n9(O,r(x))}return g}let A=Yc(g);if(A.name==="playbackRate"&&A.maxValue===1024)throw s();try{this._nativeAudioNode.connect(A,_),(x||Cp(this))&&this._nativeAudioNode.disconnect(A,_)}catch(S){throw S.code===12?i():S}if(lee(this,g,_,x)){let S=c([this],g);n9(S,r(x))}}disconnect(g,_,T){let b,x=u(this._context),A=m(x);if(g===void 0)b=dee(this,A);else if(typeof g=="number"){if(g<0||g>=this.numberOfOutputs)throw n();b=hee(this,A,g)}else{if(_!==void 0&&(_<0||_>=this.numberOfOutputs)||Xc(g)&&T!==void 0&&(T<0||T>=g.numberOfInputs))throw n();if(b=fee(this,A,g,_,T),b.length===0)throw i()}for(let E of b){let S=c([this],E);n9(S,a)}}};var gR=Ni(A7()),vR=(o,e,t,r,n,i,s,a,c,l,u,p,d)=>(h,m,f,v=null,g=null)=>{let _=new gR.AutomationEventList(f.defaultValue),T=m?r(_):null,b={get defaultValue(){return f.defaultValue},get maxValue(){return v===null?f.maxValue:v},get minValue(){return g===null?f.minValue:g},get value(){return f.value},set value(x){f.value=x,b.setValueAtTime(x,h.context.currentTime)},cancelAndHoldAtTime(x){if(typeof f.cancelAndHoldAtTime=="function")T===null&&_.flush(h.context.currentTime),_.add(n(x)),f.cancelAndHoldAtTime(x);else{let A=Array.from(_).pop();T===null&&_.flush(h.context.currentTime),_.add(n(x));let E=Array.from(_).pop();f.cancelScheduledValues(x),A!==E&&E!==void 0&&(E.type==="exponentialRampToValue"?f.exponentialRampToValueAtTime(E.value,E.endTime):E.type==="linearRampToValue"?f.linearRampToValueAtTime(E.value,E.endTime):E.type==="setValue"?f.setValueAtTime(E.value,E.startTime):E.type==="setValueCurve"&&f.setValueCurveAtTime(E.values,E.startTime,E.duration))}return b},cancelScheduledValues(x){return T===null&&_.flush(h.context.currentTime),_.add(i(x)),f.cancelScheduledValues(x),b},exponentialRampToValueAtTime(x,A){if(x===0)throw new RangeError;if(!Number.isFinite(A)||A<0)throw new RangeError;return T===null&&_.flush(h.context.currentTime),_.add(s(x,A)),f.exponentialRampToValueAtTime(x,A),b},linearRampToValueAtTime(x,A){return T===null&&_.flush(h.context.currentTime),_.add(a(x,A)),f.linearRampToValueAtTime(x,A),b},setTargetAtTime(x,A,E){return T===null&&_.flush(h.context.currentTime),_.add(c(x,A,E)),f.setTargetAtTime(x,A,E),b},setValueAtTime(x,A){return T===null&&_.flush(h.context.currentTime),_.add(l(x,A)),f.setValueAtTime(x,A),b},setValueCurveAtTime(x,A,E){let S=x instanceof Float32Array?x:new Float32Array(x);if(p!==null&&p.name==="webkitAudioContext"){let w=A+E,O=h.context.sampleRate,C=Math.ceil(A*O),N=Math.floor(w*O),R=N-C,D=new Float32Array(R);for(let F=0;F<R;F+=1){let j=(S.length-1)/E*((C+F)/O-A),$=Math.floor(j),Y=Math.ceil(j);D[F]=$===Y?S[$]:(1-(j-$))*S[$]+(1-(Y-j))*S[Y]}T===null&&_.flush(h.context.currentTime),_.add(u(D,A,E)),f.setValueCurveAtTime(D,A,E);let V=N/O;V<w&&d(b,D[D.length-1],V),d(b,S[S.length-1],w)}else T===null&&_.flush(h.context.currentTime),_.add(u(S,A,E)),f.setValueCurveAtTime(S,A,E);return b}};return t.set(b,f),e.set(b,h),o(b,T),b};var yR=o=>({replay(e){for(let t of o)if(t.type==="exponentialRampToValue"){let{endTime:r,value:n}=t;e.exponentialRampToValueAtTime(n,r)}else if(t.type==="linearRampToValue"){let{endTime:r,value:n}=t;e.linearRampToValueAtTime(n,r)}else if(t.type==="setTarget"){let{startTime:r,target:n,timeConstant:i}=t;e.setTargetAtTime(n,r,i)}else if(t.type==="setValue"){let{startTime:r,value:n}=t;e.setValueAtTime(n,r)}else if(t.type==="setValueCurve"){let{duration:r,startTime:n,values:i}=t;e.setValueCurveAtTime(i,n,r)}else throw new Error("Can't apply an unknown automation.")}});var uf=class{constructor(e){this._map=new Map(e)}get size(){return this._map.size}entries(){return this._map.entries()}forEach(e,t=null){return this._map.forEach((r,n)=>e.call(t,r,n,this))}get(e){return this._map.get(e)}has(e){return this._map.has(e)}keys(){return this._map.keys()}values(){return this._map.values()}};var mee={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:1,numberOfOutputs:1,parameterData:{},processorOptions:{}},xR=(o,e,t,r,n,i,s,a,c,l,u,p,d,h)=>class extends e{constructor(f,v,g){var _;let T=a(f),b=c(T),x=u({...mee,...g});d(x);let A=af.get(T),E=A==null?void 0:A.get(v),S=b||T.state!=="closed"?T:(_=s(T))!==null&&_!==void 0?_:T,w=n(S,b?null:f.baseLatency,l,v,E,x),O=b?r(v,x,E):null;super(f,!0,w,O);let C=[];w.parameters.forEach((R,D)=>{let V=t(this,b,R);C.push([D,V])}),this._nativeAudioWorkletNode=w,this._onprocessorerror=null,this._parameters=new uf(C),b&&o(T,this);let{activeInputs:N}=i(this);p(w,N)}get onprocessorerror(){return this._onprocessorerror}set onprocessorerror(f){let v=typeof f=="function"?h(this,f):null;this._nativeAudioWorkletNode.onprocessorerror=v;let g=this._nativeAudioWorkletNode.onprocessorerror;this._onprocessorerror=g!==null&&g===v?f:g}get parameters(){return this._parameters===null?this._nativeAudioWorkletNode.parameters:this._parameters}get port(){return this._nativeAudioWorkletNode.port}};function Ep(o,e,t,r,n){if(typeof o.copyFromChannel=="function")e[t].byteLength===0&&(e[t]=new Float32Array(128)),o.copyFromChannel(e[t],r,n);else{let i=o.getChannelData(r);if(e[t].byteLength===0)e[t]=i.slice(n,n+128);else{let s=new Float32Array(i.buffer,n*Float32Array.BYTES_PER_ELEMENT,128);e[t].set(s)}}}var i9=(o,e,t,r,n)=>{typeof o.copyToChannel=="function"?e[t].byteLength!==0&&o.copyToChannel(e[t],r,n):e[t].byteLength!==0&&o.getChannelData(r).set(e[t],n)};var Sp=(o,e)=>{let t=[];for(let r=0;r<o;r+=1){let n=[],i=typeof e=="number"?e:e[r];for(let s=0;s<i;s+=1)n.push(new Float32Array(128));t.push(n)}return t};var bR=(o,e)=>{let t=Hr(cf,o),r=Jt(e);return Hr(t,r)};var _ee=async(o,e,t,r,n,i,s)=>{let a=e===null?Math.ceil(o.context.length/128)*128:e.length,c=r.channelCount*r.numberOfInputs,l=n.reduce((v,g)=>v+g,0),u=l===0?null:t.createBuffer(l,a,t.sampleRate);if(i===void 0)throw new Error("Missing the processor constructor.");let p=Qr(o),d=await bR(t,o),h=Sp(r.numberOfInputs,r.channelCount),m=Sp(r.numberOfOutputs,n),f=Array.from(o.parameters.keys()).reduce((v,g)=>({...v,[g]:new Float32Array(128)}),{});for(let v=0;v<a;v+=128){if(r.numberOfInputs>0&&e!==null)for(let g=0;g<r.numberOfInputs;g+=1)for(let _=0;_<r.channelCount;_+=1)Ep(e,h[g],_,_,v);i.parameterDescriptors!==void 0&&e!==null&&i.parameterDescriptors.forEach(({name:g},_)=>{Ep(e,f,g,c+_,v)});for(let g=0;g<r.numberOfInputs;g+=1)for(let _=0;_<n[g];_+=1)m[g][_].byteLength===0&&(m[g][_]=new Float32Array(128));try{let g=h.map((T,b)=>p.activeInputs[b].size===0?[]:T),_=s(v/t.sampleRate,t.sampleRate,()=>d.process(g,m,f));if(u!==null)for(let T=0,b=0;T<r.numberOfOutputs;T+=1){for(let x=0;x<n[T];x+=1)i9(u,m[T],x,b+x,v);b+=n[T]}if(!_)break}catch(g){o.dispatchEvent(new ErrorEvent("processorerror",{colno:g.colno,filename:g.filename,lineno:g.lineno,message:g.message}));break}}return u},TR=(o,e,t,r,n,i,s,a,c,l,u,p,d,h,m,f)=>(v,g,_)=>{let T=new WeakMap,b=null,x=async(A,E)=>{let S=u(A),w=null,O=Lt(S,E),C=Array.isArray(g.outputChannelCount)?g.outputChannelCount:Array.from(g.outputChannelCount);if(p===null){let N=C.reduce((F,j)=>F+j,0),R=n(E,{channelCount:Math.max(1,N),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,N)}),D=[];for(let F=0;F<A.numberOfOutputs;F+=1)D.push(r(E,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:C[F]}));let V=s(E,{channelCount:g.channelCount,channelCountMode:g.channelCountMode,channelInterpretation:g.channelInterpretation,gain:1});V.connect=e.bind(null,D),V.disconnect=c.bind(null,D),w=[R,D,V]}else O||(S=new p(E,v));if(T.set(E,w===null?S:w[2]),w!==null){if(b===null){if(_===void 0)throw new Error("Missing the processor constructor.");if(d===null)throw new Error("Missing the native OfflineAudioContext constructor.");let j=A.channelCount*A.numberOfInputs,$=_.parameterDescriptors===void 0?0:_.parameterDescriptors.length,Y=j+$;b=_ee(A,Y===0?null:await(async()=>{let B=new d(Y,Math.ceil(A.context.length/128)*128,E.sampleRate),te=[],X=[];for(let Ne=0;Ne<g.numberOfInputs;Ne+=1)te.push(s(B,{channelCount:g.channelCount,channelCountMode:g.channelCountMode,channelInterpretation:g.channelInterpretation,gain:1})),X.push(n(B,{channelCount:g.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:g.channelCount}));let W=await Promise.all(Array.from(A.parameters.values()).map(async Ne=>{let ye=i(B,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:Ne.value});return await h(B,Ne,ye.offset),ye})),L=r(B,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,j+$)});for(let Ne=0;Ne<g.numberOfInputs;Ne+=1){te[Ne].connect(X[Ne]);for(let ye=0;ye<g.channelCount;ye+=1)X[Ne].connect(L,ye,Ne*g.channelCount+ye)}for(let[Ne,ye]of W.entries())ye.connect(L,0,j+Ne),ye.start(0);return L.connect(B.destination),await Promise.all(te.map(Ne=>m(A,B,Ne))),f(B)})(),E,g,C,_,l)}let N=await b,R=t(E,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),[D,V,F]=w;N!==null&&(R.buffer=N,R.start(0)),R.connect(D);for(let j=0,$=0;j<A.numberOfOutputs;j+=1){let Y=V[j];for(let H=0;H<C[j];H+=1)D.connect(Y,$+H,H);$+=C[j]}return F}if(O)for(let[N,R]of A.parameters.entries())await o(E,R,S.parameters.get(N));else for(let[N,R]of A.parameters.entries())await h(E,R,S.parameters.get(N));return await m(A,E,S),S};return{render(A,E){a(E,A);let S=T.get(E);return S!==void 0?Promise.resolve(S):x(A,E)}}};var AR=(o,e,t,r,n,i,s,a,c,l,u,p,d,h,m,f,v,g,_,T)=>class extends m{constructor(x,A){super(x,A);this._nativeContext=x,this._audioWorklet=o===void 0?void 0:{addModule:(E,S)=>o(this,E,S)}}get audioWorklet(){return this._audioWorklet}createAnalyser(){return new e(this)}createBiquadFilter(){return new n(this)}createBuffer(x,A,E){return new t({length:A,numberOfChannels:x,sampleRate:E})}createBufferSource(){return new r(this)}createChannelMerger(x=6){return new i(this,{numberOfInputs:x})}createChannelSplitter(x=6){return new s(this,{numberOfOutputs:x})}createConstantSource(){return new a(this)}createConvolver(){return new c(this)}createDelay(x=1){return new u(this,{maxDelayTime:x})}createDynamicsCompressor(){return new p(this)}createGain(){return new d(this)}createIIRFilter(x,A){return new h(this,{feedback:A,feedforward:x})}createOscillator(){return new f(this)}createPanner(){return new v(this)}createPeriodicWave(x,A,E={disableNormalization:!1}){return new g(this,{...E,imag:A,real:x})}createStereoPanner(){return new _(this)}createWaveShaper(){return new T(this)}decodeAudioData(x,A,E){return l(this._nativeContext,x).then(S=>(typeof A=="function"&&A(S),S),S=>{throw typeof E=="function"&&E(S),S})}};var gee={Q:1,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:350,gain:0,type:"lowpass"},CR=(o,e,t,r,n,i,s,a)=>class extends o{constructor(l,u){let p=i(l),d={...gee,...u},h=n(p,d),m=s(p),f=m?t():null;super(l,!1,h,f);this._Q=e(this,m,h.Q,Nr,kr),this._detune=e(this,m,h.detune,1200*Math.log2(Nr),-1200*Math.log2(Nr)),this._frequency=e(this,m,h.frequency,l.sampleRate/2,0),this._gain=e(this,m,h.gain,40*Math.log10(Nr),kr),this._nativeBiquadFilterNode=h,a(this,1)}get detune(){return this._detune}get frequency(){return this._frequency}get gain(){return this._gain}get Q(){return this._Q}get type(){return this._nativeBiquadFilterNode.type}set type(l){this._nativeBiquadFilterNode.type=l}getFrequencyResponse(l,u,p){try{this._nativeBiquadFilterNode.getFrequencyResponse(l,u,p)}catch(d){throw d.code===11?r():d}if(l.length!==u.length||u.length!==p.length)throw r()}};var ER=(o,e,t,r,n)=>()=>{let i=new WeakMap,s=async(a,c)=>{let l=t(a),u=Lt(l,c);if(!u){let p={Q:l.Q.value,channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,detune:l.detune.value,frequency:l.frequency.value,gain:l.gain.value,type:l.type};l=e(c,p)}return i.set(c,l),u?(await o(c,a.Q,l.Q),await o(c,a.detune,l.detune),await o(c,a.frequency,l.frequency),await o(c,a.gain,l.gain)):(await r(c,a.Q,l.Q),await r(c,a.detune,l.detune),await r(c,a.frequency,l.frequency),await r(c,a.gain,l.gain)),await n(a,c,l),l};return{render(a,c){let l=i.get(c);return l!==void 0?Promise.resolve(l):s(a,c)}}};var SR=(o,e)=>(t,r)=>{let n=e.get(t);if(n!==void 0)return n;let i=o.get(t);if(i!==void 0)return i;try{let s=r();return s instanceof Promise?(o.set(t,s),s.catch(()=>!1).then(a=>(o.delete(t),e.set(t,a),a))):(e.set(t,s),s)}catch{return e.set(t,!1),!1}};var vee={channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6},wR=(o,e,t,r,n)=>class extends o{constructor(s,a){let c=r(s),l={...vee,...a},u=t(c,l),p=n(c)?e():null;super(s,!1,u,p)}};var MR=(o,e,t)=>()=>{let r=new WeakMap,n=async(i,s)=>{let a=e(i);if(!Lt(a,s)){let l={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,numberOfInputs:a.numberOfInputs};a=o(s,l)}return r.set(s,a),await t(i,s,a),a};return{render(i,s){let a=r.get(s);return a!==void 0?Promise.resolve(a):n(i,s)}}};var yee={channelCount:6,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:6},NR=(o,e,t,r,n,i)=>class extends o{constructor(a,c){let l=r(a),u=i({...yee,...c}),p=t(l,u),d=n(l)?e():null;super(a,!1,p,d)}};var OR=(o,e,t)=>()=>{let r=new WeakMap,n=async(i,s)=>{let a=e(i);if(!Lt(a,s)){let l={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,numberOfOutputs:a.numberOfOutputs};a=o(s,l)}return r.set(s,a),await t(i,s,a),a};return{render(i,s){let a=r.get(s);return a!==void 0?Promise.resolve(a):n(i,s)}}};var PR=o=>(e,t,r)=>o(t,e,r);var RR=o=>(e,t,r=0,n=0)=>{let i=e[r];if(i===void 0)throw o();return $c(t)?i.connect(t,0,n):i.connect(t,0)};var IR=o=>(e,t)=>{let r=o(e,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),n=e.createBuffer(1,2,44100);return r.buffer=n,r.loop=!0,r.connect(t),r.start(),()=>{r.stop(),r.disconnect(t)}};var xee={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",offset:1},LR=(o,e,t,r,n,i,s)=>class extends o{constructor(c,l){let u=n(c),p={...xee,...l},d=r(u,p),h=i(u),m=h?t():null;super(c,!1,d,m);this._constantSourceNodeRenderer=m,this._nativeConstantSourceNode=d,this._offset=e(this,h,d.offset,Nr,kr),this._onended=null}get offset(){return this._offset}get onended(){return this._onended}set onended(c){let l=typeof c=="function"?s(this,c):null;this._nativeConstantSourceNode.onended=l;let u=this._nativeConstantSourceNode.onended;this._onended=u!==null&&u===l?c:u}start(c=0){if(this._nativeConstantSourceNode.start(c),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.start=c),this.context.state!=="closed"){zi(this);let l=()=>{this._nativeConstantSourceNode.removeEventListener("ended",l),Zo(this)&&Fs(this)};this._nativeConstantSourceNode.addEventListener("ended",l)}}stop(c=0){this._nativeConstantSourceNode.stop(c),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.stop=c)}};var DR=(o,e,t,r,n)=>()=>{let i=new WeakMap,s=null,a=null,c=async(l,u)=>{let p=t(l),d=Lt(p,u);if(!d){let h={channelCount:p.channelCount,channelCountMode:p.channelCountMode,channelInterpretation:p.channelInterpretation,offset:p.offset.value};p=e(u,h),s!==null&&p.start(s),a!==null&&p.stop(a)}return i.set(u,p),d?await o(u,l.offset,p.offset):await r(u,l.offset,p.offset),await n(l,u,p),p};return{set start(l){s=l},set stop(l){a=l},render(l,u){let p=i.get(u);return p!==void 0?Promise.resolve(p):c(l,u)}}};var kR=o=>e=>(o[0]=e,o[0]);var bee={buffer:null,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",disableNormalization:!1},BR=(o,e,t,r,n,i)=>class extends o{constructor(a,c){let l=r(a),u={...bee,...c},p=t(l,u),h=n(l)?e():null;super(a,!1,p,h);this._isBufferNullified=!1,this._nativeConvolverNode=p,u.buffer!==null&&i(this,u.buffer.duration)}get buffer(){return this._isBufferNullified?null:this._nativeConvolverNode.buffer}set buffer(a){if(this._nativeConvolverNode.buffer=a,a===null&&this._nativeConvolverNode.buffer!==null){let c=this._nativeConvolverNode.context;this._nativeConvolverNode.buffer=c.createBuffer(1,1,44100),this._isBufferNullified=!0,i(this,0)}else this._isBufferNullified=!1,i(this,this._nativeConvolverNode.buffer===null?0:this._nativeConvolverNode.buffer.duration)}get normalize(){return this._nativeConvolverNode.normalize}set normalize(a){this._nativeConvolverNode.normalize=a}};var FR=(o,e,t)=>()=>{let r=new WeakMap,n=async(i,s)=>{let a=e(i);if(!Lt(a,s)){let l={buffer:a.buffer,channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,disableNormalization:!a.normalize};a=o(s,l)}return r.set(s,a),fi(a)?await t(i,s,a.inputs[0]):await t(i,s,a),a};return{render(i,s){let a=r.get(s);return a!==void 0?Promise.resolve(a):n(i,s)}}};var UR=(o,e)=>(t,r,n)=>{if(e===null)throw new Error("Missing the native OfflineAudioContext constructor.");try{return new e(t,r,n)}catch(i){throw i.name==="SyntaxError"?o():i}};var VR=()=>new DOMException("","DataCloneError");var I7=o=>{let{port1:e,port2:t}=new MessageChannel;return new Promise(r=>{let n=()=>{t.onmessage=null,e.close(),t.close(),r()};t.onmessage=()=>n();try{e.postMessage(o,[o])}finally{n()}})};var GR=(o,e,t,r,n,i,s,a,c,l,u)=>(p,d)=>{let h=s(p)?p:i(p);if(n.has(d)){let m=t();return Promise.reject(m)}try{n.add(d)}catch{}return e(c,()=>c(h))?h.decodeAudioData(d).then(m=>(I7(d).catch(()=>{}),e(a,()=>a(m))||u(m),o.add(m),m)):new Promise((m,f)=>{let v=async()=>{try{await I7(d)}catch{}},g=_=>{f(_),v()};try{h.decodeAudioData(d,_=>{typeof _.copyFromChannel!="function"&&(l(_),bp(_)),o.add(_),v().then(()=>m(_))},_=>{g(_===null?r():_)})}catch(_){g(_)}})};var zR=(o,e,t,r,n,i,s,a)=>(c,l)=>{let u=e.get(c);if(u===void 0)throw new Error("Missing the expected cycle count.");let p=i(c.context),d=a(p);if(u===l){if(e.delete(c),!d&&s(c)){let h=r(c),{outputs:m}=t(c);for(let f of m)if(Sa(f)){let v=r(f[0]);o(h,v,f[1],f[2])}else{let v=n(f[0]);h.connect(v,f[1])}}}else e.set(c,u-l)};var Tee={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",delayTime:0,maxDelayTime:1},HR=(o,e,t,r,n,i,s)=>class extends o{constructor(c,l){let u=n(c),p={...Tee,...l},d=r(u,p),h=i(u),m=h?t(p.maxDelayTime):null;super(c,!1,d,m);this._delayTime=e(this,h,d.delayTime),s(this,p.maxDelayTime)}get delayTime(){return this._delayTime}};var jR=(o,e,t,r,n)=>i=>{let s=new WeakMap,a=async(c,l)=>{let u=t(c),p=Lt(u,l);if(!p){let d={channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,delayTime:u.delayTime.value,maxDelayTime:i};u=e(l,d)}return s.set(l,u),p?await o(l,c.delayTime,u.delayTime):await r(l,c.delayTime,u.delayTime),await n(c,l,u),u};return{render(c,l){let u=s.get(l);return u!==void 0?Promise.resolve(u):a(c,l)}}};var WR=o=>(e,t,r,n)=>o(e[n],i=>i[0]===t&&i[1]===r);var qR=o=>(e,t)=>{o(e).delete(t)};var XR=o=>"delayTime"in o;var YR=(o,e,t)=>function r(n,i){let s=Xc(i)?i:t(o,i);if(XR(s))return[];if(n[0]===s)return[n];if(n.includes(s))return[];let{outputs:a}=e(s);return Array.from(a).map(c=>r([...n,s],c[0])).reduce((c,l)=>c.concat(l),[])};var s9=(o,e,t)=>{let r=e[t];if(r===void 0)throw o();return r},$R=o=>(e,t=void 0,r=void 0,n=0)=>t===void 0?e.forEach(i=>i.disconnect()):typeof t=="number"?s9(o,e,t).disconnect():$c(t)?r===void 0?e.forEach(i=>i.disconnect(t)):n===void 0?s9(o,e,r).disconnect(t,0):s9(o,e,r).disconnect(t,0,n):r===void 0?e.forEach(i=>i.disconnect(t)):s9(o,e,r).disconnect(t,0);var Aee={attack:.003,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",knee:30,ratio:12,release:.25,threshold:-24},KR=(o,e,t,r,n,i,s,a)=>class extends o{constructor(l,u){let p=i(l),d={...Aee,...u},h=r(p,d),m=s(p),f=m?t():null;super(l,!1,h,f);this._attack=e(this,m,h.attack),this._knee=e(this,m,h.knee),this._nativeDynamicsCompressorNode=h,this._ratio=e(this,m,h.ratio),this._release=e(this,m,h.release),this._threshold=e(this,m,h.threshold),a(this,.006)}get attack(){return this._attack}get channelCount(){return this._nativeDynamicsCompressorNode.channelCount}set channelCount(l){let u=this._nativeDynamicsCompressorNode.channelCount;if(this._nativeDynamicsCompressorNode.channelCount=l,l>2)throw this._nativeDynamicsCompressorNode.channelCount=u,n()}get channelCountMode(){return this._nativeDynamicsCompressorNode.channelCountMode}set channelCountMode(l){let u=this._nativeDynamicsCompressorNode.channelCountMode;if(this._nativeDynamicsCompressorNode.channelCountMode=l,l==="max")throw this._nativeDynamicsCompressorNode.channelCountMode=u,n()}get knee(){return this._knee}get ratio(){return this._ratio}get reduction(){return typeof this._nativeDynamicsCompressorNode.reduction.value=="number"?this._nativeDynamicsCompressorNode.reduction.value:this._nativeDynamicsCompressorNode.reduction}get release(){return this._release}get threshold(){return this._threshold}};var JR=(o,e,t,r,n)=>()=>{let i=new WeakMap,s=async(a,c)=>{let l=t(a),u=Lt(l,c);if(!u){let p={attack:l.attack.value,channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,knee:l.knee.value,ratio:l.ratio.value,release:l.release.value,threshold:l.threshold.value};l=e(c,p)}return i.set(c,l),u?(await o(c,a.attack,l.attack),await o(c,a.knee,l.knee),await o(c,a.ratio,l.ratio),await o(c,a.release,l.release),await o(c,a.threshold,l.threshold)):(await r(c,a.attack,l.attack),await r(c,a.knee,l.knee),await r(c,a.ratio,l.ratio),await r(c,a.release,l.release),await r(c,a.threshold,l.threshold)),await n(a,c,l),l};return{render(a,c){let l=i.get(c);return l!==void 0?Promise.resolve(l):s(a,c)}}};var ZR=()=>new DOMException("","EncodingError");var QR=o=>e=>new Promise((t,r)=>{if(o===null){r(new SyntaxError);return}let n=o.document.head;if(n===null)r(new SyntaxError);else{let i=o.document.createElement("script"),s=new Blob([e],{type:"application/javascript"}),a=URL.createObjectURL(s),c=o.onerror,l=()=>{o.onerror=c,URL.revokeObjectURL(a)};o.onerror=(u,p,d,h,m)=>{if(p===a||p===o.location.href&&d===1&&h===1)return l(),r(m),!1;if(c!==null)return c(u,p,d,h,m)},i.onerror=()=>{l(),r(new SyntaxError)},i.onload=()=>{l(),t()},i.src=a,i.type="module",n.appendChild(i)}});var eI=o=>class{constructor(t){this._nativeEventTarget=t,this._listeners=new WeakMap}addEventListener(t,r,n){if(r!==null){let i=this._listeners.get(r);i===void 0&&(i=o(this,r),typeof r=="function"&&this._listeners.set(r,i)),this._nativeEventTarget.addEventListener(t,i,n)}}dispatchEvent(t){return this._nativeEventTarget.dispatchEvent(t)}removeEventListener(t,r,n){let i=r===null?void 0:this._listeners.get(r);this._nativeEventTarget.removeEventListener(t,i===void 0?null:i,n)}};var tI=o=>(e,t,r)=>{Object.defineProperties(o,{currentFrame:{configurable:!0,get(){return Math.round(e*t)}},currentTime:{configurable:!0,get(){return e}}});try{return r()}finally{o!==null&&(delete o.currentFrame,delete o.currentTime)}};var rI=o=>async e=>{try{let t=await fetch(e);if(t.ok)return[await t.text(),t.url]}catch{}throw o()};var Cee={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",gain:1},oI=(o,e,t,r,n,i)=>class extends o{constructor(a,c){let l=n(a),u={...Cee,...c},p=r(l,u),d=i(l),h=d?t():null;super(a,!1,p,h);this._gain=e(this,d,p.gain,Nr,kr)}get gain(){return this._gain}};var nI=(o,e,t,r,n)=>()=>{let i=new WeakMap,s=async(a,c)=>{let l=t(a),u=Lt(l,c);if(!u){let p={channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,gain:l.gain.value};l=e(c,p)}return i.set(c,l),u?await o(c,a.gain,l.gain):await r(c,a.gain,l.gain),await n(a,c,l),l};return{render(a,c){let l=i.get(c);return l!==void 0?Promise.resolve(l):s(a,c)}}};var iI=(o,e)=>t=>e(o,t);var sI=o=>e=>{let t=o(e);if(t.renderer===null)throw new Error("Missing the renderer of the given AudioNode in the audio graph.");return t.renderer};var aI=o=>e=>{var t;return(t=o.get(e))!==null&&t!==void 0?t:0};var cI=o=>e=>{let t=o(e);if(t.renderer===null)throw new Error("Missing the renderer of the given AudioParam in the audio graph.");return t.renderer};var lI=o=>e=>o.get(e);var _r=()=>new DOMException("","InvalidStateError");var uI=o=>e=>{let t=o.get(e);if(t===void 0)throw _r();return t};var pI=(o,e)=>t=>{let r=o.get(t);if(r!==void 0)return r;if(e===null)throw new Error("Missing the native OfflineAudioContext constructor.");return r=new e(1,1,44100),o.set(t,r),r};var dI=o=>e=>{let t=o.get(e);if(t===void 0)throw new Error("The context has no set of AudioWorkletNodes.");return t};var wp=()=>new DOMException("","InvalidAccessError");var hI=o=>{o.getFrequencyResponse=(e=>(t,r,n)=>{if(t.length!==r.length||r.length!==n.length)throw wp();return e.call(o,t,r,n)})(o.getFrequencyResponse)};var Eee={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers"},fI=(o,e,t,r,n,i)=>class extends o{constructor(a,c){let l=r(a),u=n(l),p={...Eee,...c},d=e(l,u?null:a.baseLatency,p),h=u?t(p.feedback,p.feedforward):null;super(a,!1,d,h);hI(d),this._nativeIIRFilterNode=d,i(this,1)}getFrequencyResponse(a,c,l){return this._nativeIIRFilterNode.getFrequencyResponse(a,c,l)}};var a9=(o,e,t,r,n,i,s,a,c,l,u)=>{let p=l.length,d=a;for(let h=0;h<p;h+=1){let m=t[0]*l[h];for(let f=1;f<n;f+=1){let v=d-f&c-1;m+=t[f]*i[v],m-=o[f]*s[v]}for(let f=n;f<r;f+=1)m+=t[f]*i[d-f&c-1];for(let f=n;f<e;f+=1)m-=o[f]*s[d-f&c-1];i[d]=l[h],s[d]=m,d=d+1&c-1,u[h]=m}return d};var See=(o,e,t,r)=>{let n=t instanceof Float64Array?t:new Float64Array(t),i=r instanceof Float64Array?r:new Float64Array(r),s=n.length,a=i.length,c=Math.min(s,a);if(n[0]!==1){for(let m=0;m<s;m+=1)i[m]/=n[0];for(let m=1;m<a;m+=1)n[m]/=n[0]}let l=32,u=new Float32Array(l),p=new Float32Array(l),d=e.createBuffer(o.numberOfChannels,o.length,o.sampleRate),h=o.numberOfChannels;for(let m=0;m<h;m+=1){let f=o.getChannelData(m),v=d.getChannelData(m);u.fill(0),p.fill(0),a9(n,s,i,a,c,u,p,0,l,f,v)}return d},mI=(o,e,t,r,n)=>(i,s)=>{let a=new WeakMap,c=null,l=async(u,p)=>{let d=null,h=e(u),m=Lt(h,p);if(p.createIIRFilter===void 0?d=o(p,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}):m||(h=p.createIIRFilter(s,i)),a.set(p,d===null?h:d),d!==null){if(c===null){if(t===null)throw new Error("Missing the native OfflineAudioContext constructor.");let v=new t(u.context.destination.channelCount,u.context.length,p.sampleRate);c=(async()=>{await r(u,v,v.destination);let g=await n(v);return See(g,p,i,s)})()}let f=await c;return d.buffer=f,d.start(0),d}return await r(u,p,h),h};return{render(u,p){let d=a.get(p);return d!==void 0?Promise.resolve(d):l(u,p)}}};var _I=(o,e,t,r,n,i)=>s=>(a,c)=>{let l=o.get(a);if(l===void 0){if(!s&&i(a)){let u=r(a),{outputs:p}=t(a);for(let d of p)if(Sa(d)){let h=r(d[0]);e(u,h,d[1],d[2])}else{let h=n(d[0]);u.disconnect(h,d[1])}}o.set(a,c)}else o.set(a,l+c)};var gI=(o,e)=>t=>{let r=o.get(t);return e(r)||e(t)};var vI=(o,e)=>t=>o.has(t)||e(t);var yI=(o,e)=>t=>o.has(t)||e(t);var xI=(o,e)=>t=>{let r=o.get(t);return e(r)||e(t)};var bI=o=>e=>o!==null&&e instanceof o;var TI=o=>e=>o!==null&&typeof o.AudioNode=="function"&&e instanceof o.AudioNode;var AI=o=>e=>o!==null&&typeof o.AudioParam=="function"&&e instanceof o.AudioParam;var CI=(o,e)=>t=>o(t)||e(t);var EI=o=>e=>o!==null&&e instanceof o;var SI=o=>o!==null&&o.isSecureContext;var wI=(o,e,t,r)=>class extends o{constructor(i,s){let a=t(i),c=e(a,s);if(r(a))throw TypeError();super(i,!0,c,null);this._nativeMediaElementAudioSourceNode=c}get mediaElement(){return this._nativeMediaElementAudioSourceNode.mediaElement}};var wee={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers"},MI=(o,e,t,r)=>class extends o{constructor(i,s){let a=t(i);if(r(a))throw new TypeError;let c={...wee,...s},l=e(a,c);super(i,!1,l,null);this._nativeMediaStreamAudioDestinationNode=l}get stream(){return this._nativeMediaStreamAudioDestinationNode.stream}};var NI=(o,e,t,r)=>class extends o{constructor(i,s){let a=t(i),c=e(a,s);if(r(a))throw new TypeError;super(i,!0,c,null);this._nativeMediaStreamAudioSourceNode=c}get mediaStream(){return this._nativeMediaStreamAudioSourceNode.mediaStream}};var OI=(o,e,t)=>class extends o{constructor(n,i){let s=t(n),a=e(s,i);super(n,!0,a,null)}};var PI=(o,e,t,r,n)=>class extends r{constructor(s={}){if(n===null)throw new Error("Missing the native AudioContext constructor.");let a;try{a=new n(s)}catch(u){throw u.code===12&&u.message==="sampleRate is not in range"?e():u}if(a===null)throw t();if(!o9(s.latencyHint))throw new TypeError(`The provided value '${s.latencyHint}' is not a valid enum value of type AudioContextLatencyCategory.`);if(s.sampleRate!==void 0&&a.sampleRate!==s.sampleRate)throw e();super(a,2);let{latencyHint:c}=s,{sampleRate:l}=a;if(this._baseLatency=typeof a.baseLatency=="number"?a.baseLatency:c==="balanced"?512/l:c==="interactive"||c===void 0?256/l:c==="playback"?1024/l:Math.max(2,Math.min(128,Math.round(c*l/128)))*128/l,this._nativeAudioContext=a,n.name==="webkitAudioContext"?(this._nativeGainNode=a.createGain(),this._nativeOscillatorNode=a.createOscillator(),this._nativeGainNode.gain.value=1e-37,this._nativeOscillatorNode.connect(this._nativeGainNode).connect(a.destination),this._nativeOscillatorNode.start()):(this._nativeGainNode=null,this._nativeOscillatorNode=null),this._state=null,a.state==="running"){this._state="suspended";let u=()=>{this._state==="suspended"&&(this._state=null),a.removeEventListener("statechange",u)};a.addEventListener("statechange",u)}}get baseLatency(){return this._baseLatency}get state(){return this._state!==null?this._state:this._nativeAudioContext.state}close(){return this.state==="closed"?this._nativeAudioContext.close().then(()=>{throw o()}):(this._state==="suspended"&&(this._state=null),this._nativeAudioContext.close().then(()=>{this._nativeGainNode!==null&&this._nativeOscillatorNode!==null&&(this._nativeOscillatorNode.stop(),this._nativeGainNode.disconnect(),this._nativeOscillatorNode.disconnect()),Ea(this)}))}resume(){return this._state==="suspended"?new Promise((s,a)=>{let c=()=>{this._nativeAudioContext.removeEventListener("statechange",c),this._nativeAudioContext.state==="running"?s():this.resume().then(s,a)};this._nativeAudioContext.addEventListener("statechange",c)}):this._nativeAudioContext.resume().catch(s=>{throw s===void 0||s.code===15?o():s})}suspend(){return this._nativeAudioContext.suspend().catch(s=>{throw s===void 0?o():s})}};var RI=(o,e,t,r,n,i)=>class extends t{constructor(a,c){super(a);this._nativeContext=a,yp.set(this,a),r(a)&&n.set(a,new Set),this._destination=new o(this,c),this._listener=e(this,a),this._onstatechange=null}get currentTime(){return this._nativeContext.currentTime}get destination(){return this._destination}get listener(){return this._listener}get onstatechange(){return this._onstatechange}set onstatechange(a){let c=typeof a=="function"?i(this,a):null;this._nativeContext.onstatechange=c;let l=this._nativeContext.onstatechange;this._onstatechange=l!==null&&l===c?a:l}get sampleRate(){return this._nativeContext.sampleRate}get state(){return this._nativeContext.state}};var ji=o=>{let e=new Uint32Array([1179011410,40,1163280727,544501094,16,131073,44100,176400,1048580,1635017060,4,0]);try{let t=o.decodeAudioData(e.buffer,()=>{});return t===void 0?!1:(t.catch(()=>{}),!0)}catch{}return!1};var Mee={numberOfChannels:1},II=(o,e,t,r,n)=>class extends r{constructor(s){let{length:a,numberOfChannels:c,sampleRate:l}={...Mee,...s},u=t(c,a,l);o(ji,()=>ji(u))||u.addEventListener("statechange",(()=>{let p=0,d=h=>{this._state==="running"&&(p>0?(u.removeEventListener("statechange",d),h.stopImmediatePropagation(),this._waitForThePromiseToSettle(h)):p+=1)};return d})());super(u,c);this._length=a,this._nativeOfflineAudioContext=u,this._state=null}get length(){return this._nativeOfflineAudioContext.length===void 0?this._length:this._nativeOfflineAudioContext.length}get state(){return this._state===null?this._nativeOfflineAudioContext.state:this._state}startRendering(){return this._state==="running"?Promise.reject(e()):(this._state="running",n(this.destination,this._nativeOfflineAudioContext).finally(()=>{this._state=null,Ea(this)}))}_waitForThePromiseToSettle(s){this._state===null?this._nativeOfflineAudioContext.dispatchEvent(s):setTimeout(()=>this._waitForThePromiseToSettle(s))}};var LI=(o,e)=>(t,r,n)=>{let i=new Set;return t.connect=(s=>(a,c=0,l=0)=>{let u=i.size===0;if(e(a))return s.call(t,a,c,l),o(i,[a,c,l],p=>p[0]===a&&p[1]===c&&p[2]===l,!0),u&&r(),a;s.call(t,a,c),o(i,[a,c],p=>p[0]===a&&p[1]===c,!0),u&&r()})(t.connect),t.disconnect=(s=>(a,c,l)=>{let u=i.size>0;if(a===void 0)s.apply(t),i.clear();else if(typeof a=="number"){s.call(t,a);for(let d of i)d[1]===a&&i.delete(d)}else{e(a)?s.call(t,a,c,l):s.call(t,a,c);for(let d of i)d[0]===a&&(c===void 0||d[1]===c)&&(l===void 0||d[2]===l)&&i.delete(d)}let p=i.size===0;u&&p&&n()})(t.disconnect),t};var Dt=(o,e,t)=>{let r=e[t];r!==void 0&&r!==o[t]&&(o[t]=r)};var yt=(o,e)=>{Dt(o,e,"channelCount"),Dt(o,e,"channelCountMode"),Dt(o,e,"channelInterpretation")};var L7=o=>typeof o.getFloatTimeDomainData=="function";var DI=o=>{o.getFloatTimeDomainData=e=>{let t=new Uint8Array(e.length);o.getByteTimeDomainData(t);let r=Math.max(t.length,o.fftSize);for(let n=0;n<r;n+=1)e[n]=(t[n]-128)*.0078125;return e}};var kI=(o,e)=>(t,r)=>{let n=t.createAnalyser();if(yt(n,r),!(r.maxDecibels>r.minDecibels))throw e();return Dt(n,r,"fftSize"),Dt(n,r,"maxDecibels"),Dt(n,r,"minDecibels"),Dt(n,r,"smoothingTimeConstant"),o(L7,()=>L7(n))||DI(n),n};var BI=o=>o===null?null:o.hasOwnProperty("AudioBuffer")?o.AudioBuffer:null;var Gt=(o,e,t)=>{let r=e[t];r!==void 0&&r!==o[t].value&&(o[t].value=r)};var FI=o=>{o.start=(e=>{let t=!1;return(r=0,n=0,i)=>{if(t)throw _r();e.call(o,r,n,i),t=!0}})(o.start)};var Mp=o=>{o.start=(e=>(t=0,r=0,n)=>{if(typeof n=="number"&&n<0||r<0||t<0)throw new RangeError("The parameters can't be negative.");e.call(o,t,r,n)})(o.start)};var Np=o=>{o.stop=(e=>(t=0)=>{if(t<0)throw new RangeError("The parameter can't be negative.");e.call(o,t)})(o.stop)};var UI=(o,e,t,r,n,i,s,a,c,l,u)=>(p,d)=>{let h=p.createBufferSource();return yt(h,d),Gt(h,d,"playbackRate"),Dt(h,d,"buffer"),Dt(h,d,"loop"),Dt(h,d,"loopEnd"),Dt(h,d,"loopStart"),e(t,()=>t(p))||FI(h),e(r,()=>r(p))||c(h),e(n,()=>n(p))||l(h,p),e(i,()=>i(p))||Mp(h),e(s,()=>s(p))||u(h,p),e(a,()=>a(p))||Np(h),o(p,h),h};var VI=o=>o===null?null:o.hasOwnProperty("AudioContext")?o.AudioContext:o.hasOwnProperty("webkitAudioContext")?o.webkitAudioContext:null;var GI=(o,e)=>(t,r,n)=>{let i=t.destination;if(i.channelCount!==r)try{i.channelCount=r}catch{}n&&i.channelCountMode!=="explicit"&&(i.channelCountMode="explicit"),i.maxChannelCount===0&&Object.defineProperty(i,"maxChannelCount",{value:r});let s=o(t,{channelCount:r,channelCountMode:i.channelCountMode,channelInterpretation:i.channelInterpretation,gain:1});return e(s,"channelCount",a=>()=>a.call(s),a=>c=>{a.call(s,c);try{i.channelCount=c}catch(l){if(c>i.maxChannelCount)throw l}}),e(s,"channelCountMode",a=>()=>a.call(s),a=>c=>{a.call(s,c),i.channelCountMode=c}),e(s,"channelInterpretation",a=>()=>a.call(s),a=>c=>{a.call(s,c),i.channelInterpretation=c}),Object.defineProperty(s,"maxChannelCount",{get:()=>i.maxChannelCount}),s.connect(i),s};var zI=o=>o===null?null:o.hasOwnProperty("AudioWorkletNode")?o.AudioWorkletNode:null;var HI=o=>{let{port1:e}=new MessageChannel;try{e.postMessage(o)}finally{e.close()}};var jI=(o,e,t,r,n)=>(i,s,a,c,l,u)=>{if(a!==null)try{let p=new a(i,c,u),d=new Map,h=null;if(Object.defineProperties(p,{channelCount:{get:()=>u.channelCount,set:()=>{throw o()}},channelCountMode:{get:()=>"explicit",set:()=>{throw o()}},onprocessorerror:{get:()=>h,set:m=>{typeof h=="function"&&p.removeEventListener("processorerror",h),h=typeof m=="function"?m:null,typeof h=="function"&&p.addEventListener("processorerror",h)}}}),p.addEventListener=(m=>(...f)=>{if(f[0]==="processorerror"){let v=typeof f[1]=="function"?f[1]:typeof f[1]=="object"&&f[1]!==null&&typeof f[1].handleEvent=="function"?f[1].handleEvent:null;if(v!==null){let g=d.get(f[1]);g!==void 0?f[1]=g:(f[1]=_=>{_.type==="error"?(Object.defineProperties(_,{type:{value:"processorerror"}}),v(_)):v(new ErrorEvent(f[0],{..._}))},d.set(v,f[1]))}}return m.call(p,"error",f[1],f[2]),m.call(p,...f)})(p.addEventListener),p.removeEventListener=(m=>(...f)=>{if(f[0]==="processorerror"){let v=d.get(f[1]);v!==void 0&&(d.delete(f[1]),f[1]=v)}return m.call(p,"error",f[1],f[2]),m.call(p,f[0],f[1],f[2])})(p.removeEventListener),u.numberOfOutputs!==0){let m=t(i,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return p.connect(m).connect(i.destination),n(p,()=>m.disconnect(),()=>m.connect(i.destination))}return p}catch(p){throw p.code===11?r():p}if(l===void 0)throw r();return HI(u),e(i,s,l,u)};var c9=(o,e)=>o===null?512:Math.max(512,Math.min(16384,Math.pow(2,Math.round(Math.log2(o*e)))));var WI=o=>new Promise((e,t)=>{let{port1:r,port2:n}=new MessageChannel;r.onmessage=({data:i})=>{r.close(),n.close(),e(i)},r.onmessageerror=({data:i})=>{r.close(),n.close(),t(i)},n.postMessage(o)});var qI=async(o,e)=>{let t=await WI(e);return new o(t)};var XI=(o,e,t,r)=>{let n=cf.get(o);n===void 0&&(n=new WeakMap,cf.set(o,n));let i=qI(t,r);return n.set(e,i),i};var YI=(o,e,t,r,n,i,s,a,c,l,u,p,d)=>(h,m,f,v)=>{if(v.numberOfInputs===0&&v.numberOfOutputs===0)throw c();let g=Array.isArray(v.outputChannelCount)?v.outputChannelCount:Array.from(v.outputChannelCount);if(g.some(ne=>ne<1))throw c();if(g.length!==v.numberOfOutputs)throw e();if(v.channelCountMode!=="explicit")throw c();let _=v.channelCount*v.numberOfInputs,T=g.reduce((ne,he)=>ne+he,0),b=f.parameterDescriptors===void 0?0:f.parameterDescriptors.length;if(_+b>6||T>6)throw c();let x=new MessageChannel,A=[],E=[];for(let ne=0;ne<v.numberOfInputs;ne+=1)A.push(s(h,{channelCount:v.channelCount,channelCountMode:v.channelCountMode,channelInterpretation:v.channelInterpretation,gain:1})),E.push(n(h,{channelCount:v.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:v.channelCount}));let S=[];if(f.parameterDescriptors!==void 0)for(let{defaultValue:ne,maxValue:he,minValue:we,name:Ee}of f.parameterDescriptors){let Pe=i(h,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:v.parameterData[Ee]!==void 0?v.parameterData[Ee]:ne===void 0?0:ne});Object.defineProperties(Pe.offset,{defaultValue:{get:()=>ne===void 0?0:ne},maxValue:{get:()=>he===void 0?Nr:he},minValue:{get:()=>we===void 0?kr:we}}),S.push(Pe)}let w=r(h,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,_+b)}),O=c9(m,h.sampleRate),C=a(h,O,_+b,Math.max(1,T)),N=n(h,{channelCount:Math.max(1,T),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,T)}),R=[];for(let ne=0;ne<v.numberOfOutputs;ne+=1)R.push(r(h,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:g[ne]}));for(let ne=0;ne<v.numberOfInputs;ne+=1){A[ne].connect(E[ne]);for(let he=0;he<v.channelCount;he+=1)E[ne].connect(w,he,ne*v.channelCount+he)}let D=new uf(f.parameterDescriptors===void 0?[]:f.parameterDescriptors.map(({name:ne},he)=>{let we=S[he];return we.connect(w,0,_+he),we.start(0),[ne,we.offset]}));w.connect(C);let V=v.channelInterpretation,F=null,j=v.numberOfOutputs===0?[C]:R,$={get bufferSize(){return O},get channelCount(){return v.channelCount},set channelCount(ne){throw t()},get channelCountMode(){return v.channelCountMode},set channelCountMode(ne){throw t()},get channelInterpretation(){return V},set channelInterpretation(ne){for(let he of A)he.channelInterpretation=ne;V=ne},get context(){return C.context},get inputs(){return A},get numberOfInputs(){return v.numberOfInputs},get numberOfOutputs(){return v.numberOfOutputs},get onprocessorerror(){return F},set onprocessorerror(ne){typeof F=="function"&&$.removeEventListener("processorerror",F),F=typeof ne=="function"?ne:null,typeof F=="function"&&$.addEventListener("processorerror",F)},get parameters(){return D},get port(){return x.port2},addEventListener(...ne){return C.addEventListener(ne[0],ne[1],ne[2])},connect:o.bind(null,j),disconnect:l.bind(null,j),dispatchEvent(...ne){return C.dispatchEvent(ne[0])},removeEventListener(...ne){return C.removeEventListener(ne[0],ne[1],ne[2])}},Y=new Map;x.port1.addEventListener=(ne=>(...he)=>{if(he[0]==="message"){let we=typeof he[1]=="function"?he[1]:typeof he[1]=="object"&&he[1]!==null&&typeof he[1].handleEvent=="function"?he[1].handleEvent:null;if(we!==null){let Ee=Y.get(he[1]);Ee!==void 0?he[1]=Ee:(he[1]=Pe=>{u(h.currentTime,h.sampleRate,()=>we(Pe))},Y.set(we,he[1]))}}return ne.call(x.port1,he[0],he[1],he[2])})(x.port1.addEventListener),x.port1.removeEventListener=(ne=>(...he)=>{if(he[0]==="message"){let we=Y.get(he[1]);we!==void 0&&(Y.delete(he[1]),he[1]=we)}return ne.call(x.port1,he[0],he[1],he[2])})(x.port1.removeEventListener);let H=null;Object.defineProperty(x.port1,"onmessage",{get:()=>H,set:ne=>{typeof H=="function"&&x.port1.removeEventListener("message",H),H=typeof ne=="function"?ne:null,typeof H=="function"&&(x.port1.addEventListener("message",H),x.port1.start())}}),f.prototype.port=x.port1;let B=null;XI(h,$,f,v).then(ne=>B=ne);let X=Sp(v.numberOfInputs,v.channelCount),W=Sp(v.numberOfOutputs,g),L=f.parameterDescriptors===void 0?[]:f.parameterDescriptors.reduce((ne,{name:he})=>({...ne,[he]:new Float32Array(128)}),{}),Ne=!0,ye=()=>{v.numberOfOutputs>0&&C.disconnect(N);for(let ne=0,he=0;ne<v.numberOfOutputs;ne+=1){let we=R[ne];for(let Ee=0;Ee<g[ne];Ee+=1)N.disconnect(we,he+Ee,Ee);he+=g[ne]}},ae=new Map;C.onaudioprocess=({inputBuffer:ne,outputBuffer:he})=>{if(B!==null){let we=p($);for(let Ee=0;Ee<O;Ee+=128){for(let Pe=0;Pe<v.numberOfInputs;Pe+=1)for(let Xe=0;Xe<v.channelCount;Xe+=1)Ep(ne,X[Pe],Xe,Xe,Ee);f.parameterDescriptors!==void 0&&f.parameterDescriptors.forEach(({name:Pe},Xe)=>{Ep(ne,L,Pe,_+Xe,Ee)});for(let Pe=0;Pe<v.numberOfInputs;Pe+=1)for(let Xe=0;Xe<g[Pe];Xe+=1)W[Pe][Xe].byteLength===0&&(W[Pe][Xe]=new Float32Array(128));try{let Pe=X.map((et,k)=>{if(we[k].size>0)return ae.set(k,O/128),et;let fe=ae.get(k);return fe===void 0?[]:(et.every(ee=>ee.every(me=>me===0))&&(fe===1?ae.delete(k):ae.set(k,fe-1)),et)});Ne=u(h.currentTime+Ee/h.sampleRate,h.sampleRate,()=>B.process(Pe,W,L));for(let et=0,k=0;et<v.numberOfOutputs;et+=1){for(let P=0;P<g[et];P+=1)i9(he,W[et],P,k+P,Ee);k+=g[et]}}catch(Pe){Ne=!1,$.dispatchEvent(new ErrorEvent("processorerror",{colno:Pe.colno,filename:Pe.filename,lineno:Pe.lineno,message:Pe.message}))}if(!Ne){for(let Pe=0;Pe<v.numberOfInputs;Pe+=1){A[Pe].disconnect(E[Pe]);for(let Xe=0;Xe<v.channelCount;Xe+=1)E[Ee].disconnect(w,Xe,Pe*v.channelCount+Xe)}if(f.parameterDescriptors!==void 0){let Pe=f.parameterDescriptors.length;for(let Xe=0;Xe<Pe;Xe+=1){let et=S[Xe];et.disconnect(w,0,_+Xe),et.stop()}}w.disconnect(C),C.onaudioprocess=null,Ae?ye():le();break}}}};let Ae=!1,Ie=s(h,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0}),Oe=()=>C.connect(Ie).connect(h.destination),le=()=>{C.disconnect(Ie),Ie.disconnect()},xe=()=>{if(Ne){le(),v.numberOfOutputs>0&&C.connect(N);for(let ne=0,he=0;ne<v.numberOfOutputs;ne+=1){let we=R[ne];for(let Ee=0;Ee<g[ne];Ee+=1)N.connect(we,he+Ee,Ee);he+=g[ne]}}Ae=!0},be=()=>{Ne&&(Oe(),ye()),Ae=!1};return Oe(),d($,xe,be)};var D7=(o,e)=>{let t=o.createBiquadFilter();return yt(t,e),Gt(t,e,"Q"),Gt(t,e,"detune"),Gt(t,e,"frequency"),Gt(t,e,"gain"),Dt(t,e,"type"),t};var $I=(o,e)=>(t,r)=>{let n=t.createChannelMerger(r.numberOfInputs);return o!==null&&o.name==="webkitAudioContext"&&e(t,n),yt(n,r),n};var KI=o=>{let e=o.numberOfOutputs;Object.defineProperty(o,"channelCount",{get:()=>e,set:t=>{if(t!==e)throw _r()}}),Object.defineProperty(o,"channelCountMode",{get:()=>"explicit",set:t=>{if(t!=="explicit")throw _r()}}),Object.defineProperty(o,"channelInterpretation",{get:()=>"discrete",set:t=>{if(t!=="discrete")throw _r()}})};var Op=(o,e)=>{let t=o.createChannelSplitter(e.numberOfOutputs);return yt(t,e),KI(t),t};var JI=(o,e,t,r,n)=>(i,s)=>{if(i.createConstantSource===void 0)return t(i,s);let a=i.createConstantSource();return yt(a,s),Gt(a,s,"offset"),e(r,()=>r(i))||Mp(a),e(n,()=>n(i))||Np(a),o(i,a),a};var mi=(o,e)=>(o.connect=e.connect.bind(e),o.disconnect=e.disconnect.bind(e),o);var ZI=(o,e,t,r)=>(n,{offset:i,...s})=>{let a=n.createBuffer(1,2,44100),c=e(n,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),l=t(n,{...s,gain:i}),u=a.getChannelData(0);u[0]=1,u[1]=1,c.buffer=a,c.loop=!0;let p={get bufferSize(){},get channelCount(){return l.channelCount},set channelCount(m){l.channelCount=m},get channelCountMode(){return l.channelCountMode},set channelCountMode(m){l.channelCountMode=m},get channelInterpretation(){return l.channelInterpretation},set channelInterpretation(m){l.channelInterpretation=m},get context(){return l.context},get inputs(){return[]},get numberOfInputs(){return c.numberOfInputs},get numberOfOutputs(){return l.numberOfOutputs},get offset(){return l.gain},get onended(){return c.onended},set onended(m){c.onended=m},addEventListener(...m){return c.addEventListener(m[0],m[1],m[2])},dispatchEvent(...m){return c.dispatchEvent(m[0])},removeEventListener(...m){return c.removeEventListener(m[0],m[1],m[2])},start(m=0){c.start.call(c,m)},stop(m=0){c.stop.call(c,m)}},d=()=>c.connect(l),h=()=>c.disconnect(l);return o(n,c),r(mi(p,l),d,h)};var QI=(o,e)=>(t,r)=>{let n=t.createConvolver();if(yt(n,r),r.disableNormalization===n.normalize&&(n.normalize=!r.disableNormalization),Dt(n,r,"buffer"),r.channelCount>2||(e(n,"channelCount",i=>()=>i.call(n),i=>s=>{if(s>2)throw o();return i.call(n,s)}),r.channelCountMode==="max"))throw o();return e(n,"channelCountMode",i=>()=>i.call(n),i=>s=>{if(s==="max")throw o();return i.call(n,s)}),n};var k7=(o,e)=>{let t=o.createDelay(e.maxDelayTime);return yt(t,e),Gt(t,e,"delayTime"),t};var eL=o=>(e,t)=>{let r=e.createDynamicsCompressor();if(yt(r,t),t.channelCount>2||t.channelCountMode==="max")throw o();return Gt(r,t,"attack"),Gt(r,t,"knee"),Gt(r,t,"ratio"),Gt(r,t,"release"),Gt(r,t,"threshold"),r};var Qo=(o,e)=>{let t=o.createGain();return yt(t,e),Gt(t,e,"gain"),t};var tL=o=>(e,t,r)=>{if(e.createIIRFilter===void 0)return o(e,t,r);let n=e.createIIRFilter(r.feedforward,r.feedback);return yt(n,r),n};function Nee(o,e){let t=e[0]*e[0]+e[1]*e[1];return[(o[0]*e[0]+o[1]*e[1])/t,(o[1]*e[0]-o[0]*e[1])/t]}function Oee(o,e){return[o[0]*e[0]-o[1]*e[1],o[0]*e[1]+o[1]*e[0]]}function rL(o,e){let t=[0,0];for(let r=o.length-1;r>=0;r-=1)t=Oee(t,e),t[0]+=o[r];return t}var oL=(o,e,t,r)=>(n,i,{channelCount:s,channelCountMode:a,channelInterpretation:c,feedback:l,feedforward:u})=>{let p=c9(i,n.sampleRate),d=l instanceof Float64Array?l:new Float64Array(l),h=u instanceof Float64Array?u:new Float64Array(u),m=d.length,f=h.length,v=Math.min(m,f);if(m===0||m>20)throw r();if(d[0]===0)throw e();if(f===0||f>20)throw r();if(h[0]===0)throw e();if(d[0]!==1){for(let S=0;S<f;S+=1)h[S]/=d[0];for(let S=1;S<m;S+=1)d[S]/=d[0]}let g=t(n,p,s,s);g.channelCount=s,g.channelCountMode=a,g.channelInterpretation=c;let _=32,T=[],b=[],x=[];for(let S=0;S<s;S+=1){T.push(0);let w=new Float32Array(_),O=new Float32Array(_);w.fill(0),O.fill(0),b.push(w),x.push(O)}g.onaudioprocess=S=>{let w=S.inputBuffer,O=S.outputBuffer,C=w.numberOfChannels;for(let N=0;N<C;N+=1){let R=w.getChannelData(N),D=O.getChannelData(N);T[N]=a9(d,m,h,f,v,b[N],x[N],T[N],_,R,D)}};let A=n.sampleRate/2;return mi({get bufferSize(){return p},get channelCount(){return g.channelCount},set channelCount(S){g.channelCount=S},get channelCountMode(){return g.channelCountMode},set channelCountMode(S){g.channelCountMode=S},get channelInterpretation(){return g.channelInterpretation},set channelInterpretation(S){g.channelInterpretation=S},get context(){return g.context},get inputs(){return[g]},get numberOfInputs(){return g.numberOfInputs},get numberOfOutputs(){return g.numberOfOutputs},addEventListener(...S){return g.addEventListener(S[0],S[1],S[2])},dispatchEvent(...S){return g.dispatchEvent(S[0])},getFrequencyResponse(S,w,O){if(S.length!==w.length||w.length!==O.length)throw o();let C=S.length;for(let N=0;N<C;N+=1){let R=-Math.PI*(S[N]/A),D=[Math.cos(R),Math.sin(R)],V=rL(h,D),F=rL(d,D),j=Nee(V,F);w[N]=Math.sqrt(j[0]*j[0]+j[1]*j[1]),O[N]=Math.atan2(j[1],j[0])}},removeEventListener(...S){return g.removeEventListener(S[0],S[1],S[2])}},g)};var nL=(o,e)=>o.createMediaElementSource(e.mediaElement);var iL=(o,e)=>{let t=o.createMediaStreamDestination();return yt(t,e),t.numberOfOutputs===1&&Object.defineProperty(t,"numberOfOutputs",{get:()=>0}),t};var sL=(o,{mediaStream:e})=>{let t=e.getAudioTracks();t.sort((i,s)=>i.id<s.id?-1:i.id>s.id?1:0);let r=t.slice(0,1),n=o.createMediaStreamSource(new MediaStream(r));return Object.defineProperty(n,"mediaStream",{value:e}),n};var aL=(o,e)=>(t,{mediaStreamTrack:r})=>{if(typeof t.createMediaStreamTrackSource=="function")return t.createMediaStreamTrackSource(r);let n=new MediaStream([r]),i=t.createMediaStreamSource(n);if(r.kind!=="audio")throw o();if(e(t))throw new TypeError;return i};var cL=o=>o===null?null:o.hasOwnProperty("OfflineAudioContext")?o.OfflineAudioContext:o.hasOwnProperty("webkitOfflineAudioContext")?o.webkitOfflineAudioContext:null;var lL=(o,e,t,r,n,i)=>(s,a)=>{let c=s.createOscillator();return yt(c,a),Gt(c,a,"detune"),Gt(c,a,"frequency"),a.periodicWave!==void 0?c.setPeriodicWave(a.periodicWave):Dt(c,a,"type"),e(t,()=>t(s))||Mp(c),e(r,()=>r(s))||i(c,s),e(n,()=>n(s))||Np(c),o(s,c),c};var uL=o=>(e,t)=>{let r=e.createPanner();return r.orientationX===void 0?o(e,t):(yt(r,t),Gt(r,t,"orientationX"),Gt(r,t,"orientationY"),Gt(r,t,"orientationZ"),Gt(r,t,"positionX"),Gt(r,t,"positionY"),Gt(r,t,"positionZ"),Dt(r,t,"coneInnerAngle"),Dt(r,t,"coneOuterAngle"),Dt(r,t,"coneOuterGain"),Dt(r,t,"distanceModel"),Dt(r,t,"maxDistance"),Dt(r,t,"panningModel"),Dt(r,t,"refDistance"),Dt(r,t,"rolloffFactor"),r)};var pL=(o,e,t,r,n,i,s,a,c,l)=>(u,{coneInnerAngle:p,coneOuterAngle:d,coneOuterGain:h,distanceModel:m,maxDistance:f,orientationX:v,orientationY:g,orientationZ:_,panningModel:T,positionX:b,positionY:x,positionZ:A,refDistance:E,rolloffFactor:S,...w})=>{let O=u.createPanner();if(w.channelCount>2||w.channelCountMode==="max")throw s();yt(O,w);let C={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},N=t(u,{...C,channelInterpretation:"speakers",numberOfInputs:6}),R=r(u,{...w,gain:1}),D=r(u,{...C,gain:1}),V=r(u,{...C,gain:0}),F=r(u,{...C,gain:0}),j=r(u,{...C,gain:0}),$=r(u,{...C,gain:0}),Y=r(u,{...C,gain:0}),H=n(u,256,6,1),B=i(u,{...C,curve:new Float32Array([1,1]),oversample:"none"}),te=[v,g,_],X=[b,x,A],W=new Float32Array(1);H.onaudioprocess=({inputBuffer:ae})=>{let Ae=[c(ae,W,0),c(ae,W,1),c(ae,W,2)];Ae.some((Oe,le)=>Oe!==te[le])&&(O.setOrientation(...Ae),te=Ae);let Ie=[c(ae,W,3),c(ae,W,4),c(ae,W,5)];Ie.some((Oe,le)=>Oe!==X[le])&&(O.setPosition(...Ie),X=Ie)},Object.defineProperty(V.gain,"defaultValue",{get:()=>0}),Object.defineProperty(F.gain,"defaultValue",{get:()=>0}),Object.defineProperty(j.gain,"defaultValue",{get:()=>0}),Object.defineProperty($.gain,"defaultValue",{get:()=>0}),Object.defineProperty(Y.gain,"defaultValue",{get:()=>0});let L={get bufferSize(){},get channelCount(){return O.channelCount},set channelCount(ae){if(ae>2)throw s();R.channelCount=ae,O.channelCount=ae},get channelCountMode(){return O.channelCountMode},set channelCountMode(ae){if(ae==="max")throw s();R.channelCountMode=ae,O.channelCountMode=ae},get channelInterpretation(){return O.channelInterpretation},set channelInterpretation(ae){R.channelInterpretation=ae,O.channelInterpretation=ae},get coneInnerAngle(){return O.coneInnerAngle},set coneInnerAngle(ae){O.coneInnerAngle=ae},get coneOuterAngle(){return O.coneOuterAngle},set coneOuterAngle(ae){O.coneOuterAngle=ae},get coneOuterGain(){return O.coneOuterGain},set coneOuterGain(ae){if(ae<0||ae>1)throw e();O.coneOuterGain=ae},get context(){return O.context},get distanceModel(){return O.distanceModel},set distanceModel(ae){O.distanceModel=ae},get inputs(){return[R]},get maxDistance(){return O.maxDistance},set maxDistance(ae){if(ae<0)throw new RangeError;O.maxDistance=ae},get numberOfInputs(){return O.numberOfInputs},get numberOfOutputs(){return O.numberOfOutputs},get orientationX(){return D.gain},get orientationY(){return V.gain},get orientationZ(){return F.gain},get panningModel(){return O.panningModel},set panningModel(ae){O.panningModel=ae},get positionX(){return j.gain},get positionY(){return $.gain},get positionZ(){return Y.gain},get refDistance(){return O.refDistance},set refDistance(ae){if(ae<0)throw new RangeError;O.refDistance=ae},get rolloffFactor(){return O.rolloffFactor},set rolloffFactor(ae){if(ae<0)throw new RangeError;O.rolloffFactor=ae},addEventListener(...ae){return R.addEventListener(ae[0],ae[1],ae[2])},dispatchEvent(...ae){return R.dispatchEvent(ae[0])},removeEventListener(...ae){return R.removeEventListener(ae[0],ae[1],ae[2])}};p!==L.coneInnerAngle&&(L.coneInnerAngle=p),d!==L.coneOuterAngle&&(L.coneOuterAngle=d),h!==L.coneOuterGain&&(L.coneOuterGain=h),m!==L.distanceModel&&(L.distanceModel=m),f!==L.maxDistance&&(L.maxDistance=f),v!==L.orientationX.value&&(L.orientationX.value=v),g!==L.orientationY.value&&(L.orientationY.value=g),_!==L.orientationZ.value&&(L.orientationZ.value=_),T!==L.panningModel&&(L.panningModel=T),b!==L.positionX.value&&(L.positionX.value=b),x!==L.positionY.value&&(L.positionY.value=x),A!==L.positionZ.value&&(L.positionZ.value=A),E!==L.refDistance&&(L.refDistance=E),S!==L.rolloffFactor&&(L.rolloffFactor=S),(te[0]!==1||te[1]!==0||te[2]!==0)&&O.setOrientation(...te),(X[0]!==0||X[1]!==0||X[2]!==0)&&O.setPosition(...X);let Ne=()=>{R.connect(O),o(R,B,0,0),B.connect(D).connect(N,0,0),B.connect(V).connect(N,0,1),B.connect(F).connect(N,0,2),B.connect(j).connect(N,0,3),B.connect($).connect(N,0,4),B.connect(Y).connect(N,0,5),N.connect(H).connect(u.destination)},ye=()=>{R.disconnect(O),a(R,B,0,0),B.disconnect(D),D.disconnect(N),B.disconnect(V),V.disconnect(N),B.disconnect(F),F.disconnect(N),B.disconnect(j),j.disconnect(N),B.disconnect($),$.disconnect(N),B.disconnect(Y),Y.disconnect(N),N.disconnect(H),H.disconnect(u.destination)};return l(mi(L,O),Ne,ye)};var dL=o=>(e,{disableNormalization:t,imag:r,real:n})=>{let i=r instanceof Float32Array?r:new Float32Array(r),s=n instanceof Float32Array?n:new Float32Array(n),a=e.createPeriodicWave(s,i,{disableNormalization:t});if(Array.from(r).length<2)throw o();return a};var Pp=(o,e,t,r)=>o.createScriptProcessor(e,t,r);var hL=(o,e)=>(t,r)=>{let n=r.channelCountMode;if(n==="clamped-max")throw e();if(t.createStereoPanner===void 0)return o(t,r);let i=t.createStereoPanner();return yt(i,r),Gt(i,r,"pan"),Object.defineProperty(i,"channelCountMode",{get:()=>n,set:s=>{if(s!==n)throw e()}}),i};var fL=(o,e,t,r,n,i)=>{let a=new Float32Array([1,1]),c=Math.PI/2,l={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},u={...l,oversample:"none"},p=(m,f,v,g)=>{let _=new Float32Array(16385),T=new Float32Array(16385);for(let w=0;w<16385;w+=1){let O=w/16384*c;_[w]=Math.cos(O),T[w]=Math.sin(O)}let b=t(m,{...l,gain:0}),x=r(m,{...u,curve:_}),A=r(m,{...u,curve:a}),E=t(m,{...l,gain:0}),S=r(m,{...u,curve:T});return{connectGraph(){f.connect(b),f.connect(A.inputs===void 0?A:A.inputs[0]),f.connect(E),A.connect(v),v.connect(x.inputs===void 0?x:x.inputs[0]),v.connect(S.inputs===void 0?S:S.inputs[0]),x.connect(b.gain),S.connect(E.gain),b.connect(g,0,0),E.connect(g,0,1)},disconnectGraph(){f.disconnect(b),f.disconnect(A.inputs===void 0?A:A.inputs[0]),f.disconnect(E),A.disconnect(v),v.disconnect(x.inputs===void 0?x:x.inputs[0]),v.disconnect(S.inputs===void 0?S:S.inputs[0]),x.disconnect(b.gain),S.disconnect(E.gain),b.disconnect(g,0,0),E.disconnect(g,0,1)}}},d=(m,f,v,g)=>{let _=new Float32Array(16385),T=new Float32Array(16385),b=new Float32Array(16385),x=new Float32Array(16385),A=Math.floor(16385/2);for(let j=0;j<16385;j+=1)if(j>A){let $=(j-A)/(16384-A)*c;_[j]=Math.cos($),T[j]=Math.sin($),b[j]=0,x[j]=1}else{let $=j/(16384-A)*c;_[j]=1,T[j]=0,b[j]=Math.cos($),x[j]=Math.sin($)}let E=e(m,{channelCount:2,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:2}),S=t(m,{...l,gain:0}),w=r(m,{...u,curve:_}),O=t(m,{...l,gain:0}),C=r(m,{...u,curve:T}),N=r(m,{...u,curve:a}),R=t(m,{...l,gain:0}),D=r(m,{...u,curve:b}),V=t(m,{...l,gain:0}),F=r(m,{...u,curve:x});return{connectGraph(){f.connect(E),f.connect(N.inputs===void 0?N:N.inputs[0]),E.connect(S,0),E.connect(O,0),E.connect(R,1),E.connect(V,1),N.connect(v),v.connect(w.inputs===void 0?w:w.inputs[0]),v.connect(C.inputs===void 0?C:C.inputs[0]),v.connect(D.inputs===void 0?D:D.inputs[0]),v.connect(F.inputs===void 0?F:F.inputs[0]),w.connect(S.gain),C.connect(O.gain),D.connect(R.gain),F.connect(V.gain),S.connect(g,0,0),R.connect(g,0,0),O.connect(g,0,1),V.connect(g,0,1)},disconnectGraph(){f.disconnect(E),f.disconnect(N.inputs===void 0?N:N.inputs[0]),E.disconnect(S,0),E.disconnect(O,0),E.disconnect(R,1),E.disconnect(V,1),N.disconnect(v),v.disconnect(w.inputs===void 0?w:w.inputs[0]),v.disconnect(C.inputs===void 0?C:C.inputs[0]),v.disconnect(D.inputs===void 0?D:D.inputs[0]),v.disconnect(F.inputs===void 0?F:F.inputs[0]),w.disconnect(S.gain),C.disconnect(O.gain),D.disconnect(R.gain),F.disconnect(V.gain),S.disconnect(g,0,0),R.disconnect(g,0,0),O.disconnect(g,0,1),V.disconnect(g,0,1)}}},h=(m,f,v,g,_)=>{if(f===1)return p(m,v,g,_);if(f===2)return d(m,v,g,_);throw n()};return(m,{channelCount:f,channelCountMode:v,pan:g,..._})=>{if(v==="max")throw n();let T=o(m,{..._,channelCount:1,channelCountMode:v,numberOfInputs:2}),b=t(m,{..._,channelCount:f,channelCountMode:v,gain:1}),x=t(m,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:g}),{connectGraph:A,disconnectGraph:E}=h(m,f,b,x,T);Object.defineProperty(x.gain,"defaultValue",{get:()=>0}),Object.defineProperty(x.gain,"maxValue",{get:()=>1}),Object.defineProperty(x.gain,"minValue",{get:()=>-1});let S={get bufferSize(){},get channelCount(){return b.channelCount},set channelCount(N){b.channelCount!==N&&(w&&E(),{connectGraph:A,disconnectGraph:E}=h(m,N,b,x,T),w&&A()),b.channelCount=N},get channelCountMode(){return b.channelCountMode},set channelCountMode(N){if(N==="clamped-max"||N==="max")throw n();b.channelCountMode=N},get channelInterpretation(){return b.channelInterpretation},set channelInterpretation(N){b.channelInterpretation=N},get context(){return b.context},get inputs(){return[b]},get numberOfInputs(){return b.numberOfInputs},get numberOfOutputs(){return b.numberOfOutputs},get pan(){return x.gain},addEventListener(...N){return b.addEventListener(N[0],N[1],N[2])},dispatchEvent(...N){return b.dispatchEvent(N[0])},removeEventListener(...N){return b.removeEventListener(N[0],N[1],N[2])}},w=!1,O=()=>{A(),w=!0},C=()=>{E(),w=!1};return i(mi(S,T),O,C)}};var mL=(o,e,t,r,n,i,s)=>(a,c)=>{let l=a.createWaveShaper();if(i!==null&&i.name==="webkitAudioContext"&&a.createGain().gain.automationRate===void 0)return t(a,c);yt(l,c);let u=c.curve===null||c.curve instanceof Float32Array?c.curve:new Float32Array(c.curve);if(u!==null&&u.length<2)throw e();Dt(l,{curve:u},"curve"),Dt(l,c,"oversample");let p=null,d=!1;return s(l,"curve",f=>()=>f.call(l),f=>v=>(f.call(l,v),d&&(r(v)&&p===null?p=o(a,l):!r(v)&&p!==null&&(p(),p=null)),v)),n(l,()=>{d=!0,r(l.curve)&&(p=o(a,l))},()=>{d=!1,p!==null&&(p(),p=null)})};var _L=(o,e,t,r,n)=>(i,{curve:s,oversample:a,...c})=>{let l=i.createWaveShaper(),u=i.createWaveShaper();yt(l,c),yt(u,c);let p=t(i,{...c,gain:1}),d=t(i,{...c,gain:-1}),h=t(i,{...c,gain:1}),m=t(i,{...c,gain:-1}),f=null,v=!1,g=null,_={get bufferSize(){},get channelCount(){return l.channelCount},set channelCount(x){p.channelCount=x,d.channelCount=x,l.channelCount=x,h.channelCount=x,u.channelCount=x,m.channelCount=x},get channelCountMode(){return l.channelCountMode},set channelCountMode(x){p.channelCountMode=x,d.channelCountMode=x,l.channelCountMode=x,h.channelCountMode=x,u.channelCountMode=x,m.channelCountMode=x},get channelInterpretation(){return l.channelInterpretation},set channelInterpretation(x){p.channelInterpretation=x,d.channelInterpretation=x,l.channelInterpretation=x,h.channelInterpretation=x,u.channelInterpretation=x,m.channelInterpretation=x},get context(){return l.context},get curve(){return g},set curve(x){if(x!==null&&x.length<2)throw e();if(x===null)l.curve=x,u.curve=x;else{let A=x.length,E=new Float32Array(A+2-A%2),S=new Float32Array(A+2-A%2);E[0]=x[0],S[0]=-x[A-1];let w=Math.ceil((A+1)/2),O=(A+1)/2-1;for(let C=1;C<w;C+=1){let N=C/w*O,R=Math.floor(N),D=Math.ceil(N);E[C]=R===D?x[R]:(1-(N-R))*x[R]+(1-(D-N))*x[D],S[C]=R===D?-x[A-1-R]:-((1-(N-R))*x[A-1-R])-(1-(D-N))*x[A-1-D]}E[w]=A%2===1?x[w-1]:(x[w-2]+x[w-1])/2,l.curve=E,u.curve=S}g=x,v&&(r(g)&&f===null?f=o(i,p):f!==null&&(f(),f=null))},get inputs(){return[p]},get numberOfInputs(){return l.numberOfInputs},get numberOfOutputs(){return l.numberOfOutputs},get oversample(){return l.oversample},set oversample(x){l.oversample=x,u.oversample=x},addEventListener(...x){return p.addEventListener(x[0],x[1],x[2])},dispatchEvent(...x){return p.dispatchEvent(x[0])},removeEventListener(...x){return p.removeEventListener(x[0],x[1],x[2])}};s!==null&&(_.curve=s instanceof Float32Array?s:new Float32Array(s)),a!==_.oversample&&(_.oversample=a);let T=()=>{p.connect(l).connect(h),p.connect(d).connect(u).connect(m).connect(h),v=!0,r(g)&&(f=o(i,p))},b=()=>{p.disconnect(l),l.disconnect(h),p.disconnect(d),d.disconnect(u),u.disconnect(m),m.disconnect(h),v=!1,f!==null&&(f(),f=null)};return n(mi(_,h),T,b)};var Ao=()=>new DOMException("","NotSupportedError");var Pee={numberOfChannels:1},gL=(o,e,t,r,n)=>class extends o{constructor(s,a,c){let l;if(typeof s=="number"&&a!==void 0&&c!==void 0)l={length:a,numberOfChannels:s,sampleRate:c};else if(typeof s=="object")l=s;else throw new Error("The given parameters are not valid.");let{length:u,numberOfChannels:p,sampleRate:d}={...Pee,...l},h=r(p,u,d);e(ji,()=>ji(h))||h.addEventListener("statechange",(()=>{let m=0,f=v=>{this._state==="running"&&(m>0?(h.removeEventListener("statechange",f),v.stopImmediatePropagation(),this._waitForThePromiseToSettle(v)):m+=1)};return f})());super(h,p);this._length=u,this._nativeOfflineAudioContext=h,this._state=null}get length(){return this._nativeOfflineAudioContext.length===void 0?this._length:this._nativeOfflineAudioContext.length}get state(){return this._state===null?this._nativeOfflineAudioContext.state:this._state}startRendering(){return this._state==="running"?Promise.reject(t()):(this._state="running",n(this.destination,this._nativeOfflineAudioContext).finally(()=>{this._state=null,Ea(this)}))}_waitForThePromiseToSettle(s){this._state===null?this._nativeOfflineAudioContext.dispatchEvent(s):setTimeout(()=>this._waitForThePromiseToSettle(s))}};var Ree={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:440,periodicWave:void 0,type:"sine"},vL=(o,e,t,r,n,i,s)=>class extends o{constructor(c,l){let u=n(c),p={...Ree,...l},d=t(u,p),h=i(u),m=h?r():null,f=c.sampleRate/2;super(c,!1,d,m);this._detune=e(this,h,d.detune,153600,-153600),this._frequency=e(this,h,d.frequency,f,-f),this._nativeOscillatorNode=d,this._onended=null,this._oscillatorNodeRenderer=m,this._oscillatorNodeRenderer!==null&&p.periodicWave!==void 0&&(this._oscillatorNodeRenderer.periodicWave=p.periodicWave)}get detune(){return this._detune}get frequency(){return this._frequency}get onended(){return this._onended}set onended(c){let l=typeof c=="function"?s(this,c):null;this._nativeOscillatorNode.onended=l;let u=this._nativeOscillatorNode.onended;this._onended=u!==null&&u===l?c:u}get type(){return this._nativeOscillatorNode.type}set type(c){this._nativeOscillatorNode.type=c,this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=null)}setPeriodicWave(c){this._nativeOscillatorNode.setPeriodicWave(c),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=c)}start(c=0){if(this._nativeOscillatorNode.start(c),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.start=c),this.context.state!=="closed"){zi(this);let l=()=>{this._nativeOscillatorNode.removeEventListener("ended",l),Zo(this)&&Fs(this)};this._nativeOscillatorNode.addEventListener("ended",l)}}stop(c=0){this._nativeOscillatorNode.stop(c),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.stop=c)}};var yL=(o,e,t,r,n)=>()=>{let i=new WeakMap,s=null,a=null,c=null,l=async(u,p)=>{let d=t(u),h=Lt(d,p);if(!h){let m={channelCount:d.channelCount,channelCountMode:d.channelCountMode,channelInterpretation:d.channelInterpretation,detune:d.detune.value,frequency:d.frequency.value,periodicWave:s===null?void 0:s,type:d.type};d=e(p,m),a!==null&&d.start(a),c!==null&&d.stop(c)}return i.set(p,d),h?(await o(p,u.detune,d.detune),await o(p,u.frequency,d.frequency)):(await r(p,u.detune,d.detune),await r(p,u.frequency,d.frequency)),await n(u,p,d),d};return{set periodicWave(u){s=u},set start(u){a=u},set stop(u){c=u},render(u,p){let d=i.get(p);return d!==void 0?Promise.resolve(d):l(u,p)}}};var Iee={channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:1,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1},xL=(o,e,t,r,n,i,s)=>class extends o{constructor(c,l){let u=n(c),p={...Iee,...l},d=t(u,p),h=i(u),m=h?r():null;super(c,!1,d,m);this._nativePannerNode=d,this._orientationX=e(this,h,d.orientationX,Nr,kr),this._orientationY=e(this,h,d.orientationY,Nr,kr),this._orientationZ=e(this,h,d.orientationZ,Nr,kr),this._positionX=e(this,h,d.positionX,Nr,kr),this._positionY=e(this,h,d.positionY,Nr,kr),this._positionZ=e(this,h,d.positionZ,Nr,kr),s(this,1)}get coneInnerAngle(){return this._nativePannerNode.coneInnerAngle}set coneInnerAngle(c){this._nativePannerNode.coneInnerAngle=c}get coneOuterAngle(){return this._nativePannerNode.coneOuterAngle}set coneOuterAngle(c){this._nativePannerNode.coneOuterAngle=c}get coneOuterGain(){return this._nativePannerNode.coneOuterGain}set coneOuterGain(c){this._nativePannerNode.coneOuterGain=c}get distanceModel(){return this._nativePannerNode.distanceModel}set distanceModel(c){this._nativePannerNode.distanceModel=c}get maxDistance(){return this._nativePannerNode.maxDistance}set maxDistance(c){this._nativePannerNode.maxDistance=c}get orientationX(){return this._orientationX}get orientationY(){return this._orientationY}get orientationZ(){return this._orientationZ}get panningModel(){return this._nativePannerNode.panningModel}set panningModel(c){this._nativePannerNode.panningModel=c}get positionX(){return this._positionX}get positionY(){return this._positionY}get positionZ(){return this._positionZ}get refDistance(){return this._nativePannerNode.refDistance}set refDistance(c){this._nativePannerNode.refDistance=c}get rolloffFactor(){return this._nativePannerNode.rolloffFactor}set rolloffFactor(c){this._nativePannerNode.rolloffFactor=c}};var bL=(o,e,t,r,n,i,s,a,c,l)=>()=>{let u=new WeakMap,p=null,d=async(h,m)=>{let f=null,v=i(h),g={channelCount:v.channelCount,channelCountMode:v.channelCountMode,channelInterpretation:v.channelInterpretation},_={...g,coneInnerAngle:v.coneInnerAngle,coneOuterAngle:v.coneOuterAngle,coneOuterGain:v.coneOuterGain,distanceModel:v.distanceModel,maxDistance:v.maxDistance,panningModel:v.panningModel,refDistance:v.refDistance,rolloffFactor:v.rolloffFactor},T=Lt(v,m);if("bufferSize"in v)f=r(m,{...g,gain:1});else if(!T){let b={..._,orientationX:v.orientationX.value,orientationY:v.orientationY.value,orientationZ:v.orientationZ.value,positionX:v.positionX.value,positionY:v.positionY.value,positionZ:v.positionZ.value};v=n(m,b)}if(u.set(m,f===null?v:f),f!==null){if(p===null){if(s===null)throw new Error("Missing the native OfflineAudioContext constructor.");let C=new s(6,h.context.length,m.sampleRate),N=e(C,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6});N.connect(C.destination),p=(async()=>{let R=await Promise.all([h.orientationX,h.orientationY,h.orientationZ,h.positionX,h.positionY,h.positionZ].map(async(D,V)=>{let F=t(C,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:V===0?1:0});return await a(C,D,F.offset),F}));for(let D=0;D<6;D+=1)R[D].connect(N,0,D),R[D].start(0);return l(C)})()}let b=await p,x=r(m,{...g,gain:1});await c(h,m,x);let A=[];for(let C=0;C<b.numberOfChannels;C+=1)A.push(b.getChannelData(C));let E=[A[0][0],A[1][0],A[2][0]],S=[A[3][0],A[4][0],A[5][0]],w=r(m,{...g,gain:1}),O=n(m,{..._,orientationX:E[0],orientationY:E[1],orientationZ:E[2],positionX:S[0],positionY:S[1],positionZ:S[2]});x.connect(w).connect(O.inputs[0]),O.connect(f);for(let C=128;C<b.length;C+=128){let N=[A[0][C],A[1][C],A[2][C]],R=[A[3][C],A[4][C],A[5][C]];if(N.some((D,V)=>D!==E[V])||R.some((D,V)=>D!==S[V])){E=N,S=R;let D=C/m.sampleRate;w.gain.setValueAtTime(0,D),w=r(m,{...g,gain:0}),O=n(m,{..._,orientationX:E[0],orientationY:E[1],orientationZ:E[2],positionX:S[0],positionY:S[1],positionZ:S[2]}),w.gain.setValueAtTime(1,D),x.connect(w).connect(O.inputs[0]),O.connect(f)}}return f}return T?(await o(m,h.orientationX,v.orientationX),await o(m,h.orientationY,v.orientationY),await o(m,h.orientationZ,v.orientationZ),await o(m,h.positionX,v.positionX),await o(m,h.positionY,v.positionY),await o(m,h.positionZ,v.positionZ)):(await a(m,h.orientationX,v.orientationX),await a(m,h.orientationY,v.orientationY),await a(m,h.orientationZ,v.orientationZ),await a(m,h.positionX,v.positionX),await a(m,h.positionY,v.positionY),await a(m,h.positionZ,v.positionZ)),fi(v)?await c(h,m,v.inputs[0]):await c(h,m,v),v};return{render(h,m){let f=u.get(m);return f!==void 0?Promise.resolve(f):d(h,m)}}};var Lee={disableNormalization:!1},TL=(o,e,t,r)=>class AL{constructor(i,s){let a=e(i),c=r({...Lee,...s}),l=o(a,c);return t.add(l),l}static[Symbol.hasInstance](i){return i!==null&&typeof i=="object"&&Object.getPrototypeOf(i)===AL.prototype||t.has(i)}};var CL=(o,e)=>(t,r,n)=>(o(r).replay(n),e(r,t,n));var EL=(o,e,t)=>async(r,n,i)=>{let s=o(r);await Promise.all(s.activeInputs.map((a,c)=>Array.from(a).map(async([l,u])=>{let d=await e(l).render(l,n),h=r.context.destination;!t(l)&&(r!==h||!t(r))&&d.connect(i,u,c)})).reduce((a,c)=>[...a,...c],[]))};var SL=(o,e,t)=>async(r,n,i)=>{let s=e(r);await Promise.all(Array.from(s.activeInputs).map(async([a,c])=>{let u=await o(a).render(a,n);t(a)||u.connect(i,c)}))};var wL=(o,e,t,r)=>n=>o(ji,()=>ji(n))?Promise.resolve(o(r,r)).then(i=>{if(!i){let s=t(n,512,0,1);n.oncomplete=()=>{s.onaudioprocess=null,s.disconnect()},s.onaudioprocess=()=>n.currentTime,s.connect(n.destination)}return n.startRendering()}):new Promise(i=>{let s=e(n,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});n.oncomplete=a=>{s.disconnect(),i(a.renderedBuffer)},s.connect(n.destination),n.startRendering()});var ML=o=>(e,t)=>{o.set(e,t)};var NL=o=>(e,t)=>o.set(e,t);var OL=(o,e,t,r,n,i,s,a)=>(c,l)=>t(c).render(c,l).then(()=>Promise.all(Array.from(r(l)).map(u=>t(u).render(u,l)))).then(()=>n(l)).then(u=>(typeof u.copyFromChannel!="function"?(s(u),bp(u)):e(i,()=>i(u))||a(u),o.add(u),u));var Dee={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",pan:0},PL=(o,e,t,r,n,i)=>class extends o{constructor(a,c){let l=n(a),u={...Dee,...c},p=t(l,u),d=i(l),h=d?r():null;super(a,!1,p,h);this._pan=e(this,d,p.pan)}get pan(){return this._pan}};var RL=(o,e,t,r,n)=>()=>{let i=new WeakMap,s=async(a,c)=>{let l=t(a),u=Lt(l,c);if(!u){let p={channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,pan:l.pan.value};l=e(c,p)}return i.set(c,l),u?await o(c,a.pan,l.pan):await r(c,a.pan,l.pan),fi(l)?await n(a,c,l.inputs[0]):await n(a,c,l),l};return{render(a,c){let l=i.get(c);return l!==void 0?Promise.resolve(l):s(a,c)}}};var IL=o=>()=>{if(o===null)return!1;try{new o({length:1,sampleRate:44100})}catch{return!1}return!0};var LL=(o,e)=>async()=>{if(o===null)return!0;if(e===null)return!1;let t=new Blob(['class A extends AudioWorkletProcessor{process(i){this.port.postMessage(i,[i[0][0].buffer])}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),r=new e(1,128,44100),n=URL.createObjectURL(t),i=!1,s=!1;try{await r.audioWorklet.addModule(n);let a=new o(r,"a",{numberOfOutputs:0}),c=r.createOscillator();a.port.onmessage=()=>i=!0,a.onprocessorerror=()=>s=!0,c.connect(a),c.start(0),await r.startRendering()}catch{}finally{URL.revokeObjectURL(n)}return i&&!s};var DL=(o,e)=>()=>{if(e===null)return Promise.resolve(!1);let t=new e(1,1,44100),r=o(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return new Promise(n=>{t.oncomplete=()=>{r.disconnect(),n(t.currentTime!==0)},t.startRendering()})};var B7=()=>new DOMException("","UnknownError");var kee={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",curve:null,oversample:"none"},kL=(o,e,t,r,n,i,s)=>class extends o{constructor(c,l){let u=n(c),p={...kee,...l},d=t(u,p),m=i(u)?r():null;super(c,!0,d,m);this._isCurveNullified=!1,this._nativeWaveShaperNode=d,s(this,1)}get curve(){return this._isCurveNullified?null:this._nativeWaveShaperNode.curve}set curve(c){if(c===null)this._isCurveNullified=!0,this._nativeWaveShaperNode.curve=new Float32Array([0,0]);else{if(c.length<2)throw e();this._isCurveNullified=!1,this._nativeWaveShaperNode.curve=c}}get oversample(){return this._nativeWaveShaperNode.oversample}set oversample(c){this._nativeWaveShaperNode.oversample=c}};var BL=(o,e,t)=>()=>{let r=new WeakMap,n=async(i,s)=>{let a=e(i);if(!Lt(a,s)){let l={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,curve:a.curve,oversample:a.oversample};a=o(s,l)}return r.set(s,a),fi(a)?await t(i,s,a.inputs[0]):await t(i,s,a),a};return{render(i,s){let a=r.get(s);return a!==void 0?Promise.resolve(a):n(i,s)}}};var FL=()=>typeof window>"u"?null:window;var UL=(o,e)=>t=>{t.copyFromChannel=(r,n,i=0)=>{let s=o(i),a=o(n);if(a>=t.numberOfChannels)throw e();let c=t.length,l=t.getChannelData(a),u=r.length;for(let p=s<0?-s:0;p+s<c&&p<u;p+=1)r[p]=l[p+s]},t.copyToChannel=(r,n,i=0)=>{let s=o(i),a=o(n);if(a>=t.numberOfChannels)throw e();let c=t.length,l=t.getChannelData(a),u=r.length;for(let p=s<0?-s:0;p+s<c&&p<u;p+=1)l[p+s]=r[p]}};var VL=o=>e=>{e.copyFromChannel=(t=>(r,n,i=0)=>{let s=o(i),a=o(n);if(s<e.length)return t.call(e,r,a,s)})(e.copyFromChannel),e.copyToChannel=(t=>(r,n,i=0)=>{let s=o(i),a=o(n);if(s<e.length)return t.call(e,r,a,s)})(e.copyToChannel)};var GL=o=>(e,t)=>{let r=t.createBuffer(1,1,44100);e.buffer===null&&(e.buffer=r),o(e,"buffer",n=>()=>{let i=n.call(e);return i===r?null:i},n=>i=>n.call(e,i===null?r:i))};var zL=(o,e)=>(t,r)=>{r.channelCount=1,r.channelCountMode="explicit",Object.defineProperty(r,"channelCount",{get:()=>1,set:()=>{throw o()}}),Object.defineProperty(r,"channelCountMode",{get:()=>"explicit",set:()=>{throw o()}});let n=t.createBufferSource();e(r,()=>{let a=r.numberOfInputs;for(let c=0;c<a;c+=1)n.connect(r,0,c)},()=>n.disconnect(r))};var F7=(o,e,t)=>o.copyFromChannel===void 0?o.getChannelData(t)[0]:(o.copyFromChannel(e,t),e[0]);var U7=o=>{if(o===null)return!1;let e=o.length;return e%2!==0?o[Math.floor(e/2)]!==0:o[e/2-1]+o[e/2]!==0};var Rp=(o,e,t,r)=>{let n=o;for(;!n.hasOwnProperty(e);)n=Object.getPrototypeOf(n);let{get:i,set:s}=Object.getOwnPropertyDescriptor(n,e);Object.defineProperty(o,e,{get:t(i),set:r(s)})};var HL=o=>({...o,outputChannelCount:o.outputChannelCount!==void 0?o.outputChannelCount:o.numberOfInputs===1&&o.numberOfOutputs===1?[o.channelCount]:Array.from({length:o.numberOfOutputs},()=>1)});var jL=o=>({...o,channelCount:o.numberOfOutputs});var WL=o=>{let{imag:e,real:t}=o;return e===void 0?t===void 0?{...o,imag:[0,0],real:[0,0]}:{...o,imag:Array.from(t,()=>0),real:t}:t===void 0?{...o,imag:e,real:Array.from(e,()=>0)}:{...o,imag:e,real:t}};var V7=(o,e,t)=>{try{o.setValueAtTime(e,t)}catch(r){if(r.code!==9)throw r;V7(o,e,t+1e-7)}};var qL=o=>{let e=o.createBufferSource();e.start();try{e.start()}catch{return!0}return!1};var XL=o=>{let e=o.createBufferSource(),t=o.createBuffer(1,1,44100);e.buffer=t;try{e.start(0,1)}catch{return!1}return!0};var YL=o=>{let e=o.createBufferSource();e.start();try{e.stop()}catch{return!1}return!0};var l9=o=>{let e=o.createOscillator();try{e.start(-1)}catch(t){return t instanceof RangeError}return!1};var G7=o=>{let e=o.createBuffer(1,1,44100),t=o.createBufferSource();t.buffer=e,t.start(),t.stop();try{return t.stop(),!0}catch{return!1}};var u9=o=>{let e=o.createOscillator();try{e.stop(-1)}catch(t){return t instanceof RangeError}return!1};var $L=o=>{let{port1:e,port2:t}=new MessageChannel;try{e.postMessage(o)}finally{e.close(),t.close()}};var KL=o=>{o.start=(e=>(t=0,r=0,n)=>{let i=o.buffer,s=i===null?r:Math.min(i.duration,r);i!==null&&s>i.duration-.5/o.context.sampleRate?e.call(o,t,0,0):e.call(o,t,s,n)})(o.start)};var z7=(o,e)=>{let t=e.createGain();o.connect(t);let r=(n=>()=>{n.call(o,t),o.removeEventListener("ended",r)})(o.disconnect);o.addEventListener("ended",r),mi(o,t),o.stop=(n=>{let i=!1;return(s=0)=>{if(i)try{n.call(o,s)}catch{t.gain.setValueAtTime(0,s)}else n.call(o,s),i=!0}})(o.stop)};var Kc=(o,e)=>t=>{let r={value:o};return Object.defineProperties(t,{currentTarget:r,target:r}),typeof e=="function"?e.call(o,t):e.handleEvent.call(o,t)};var Bee=UP(Hi),Fee=$P(Hi),Uee=WR(Aa),ZL=new WeakMap,Vee=aI(ZL),_i=SR(new Map,new WeakMap),Us=FL(),QL=kI(_i,hi),H7=sI(Qr),Co=EL(Qr,H7,T0),Gee=QP(QL,Jt,Co),lr=uI(yp),A0=cL(Us),Zt=EI(A0),eD=new WeakMap,tD=eI(Kc),Ip=VI(Us),j7=bI(Ip),W7=TI(Us),rD=AI(Us),pf=zI(Us),Br=_R(VP(J_),YP(Bee,Fee,Tp,Uee,Ap,Qr,Vee,Bs,Jt,Hi,Zo,T0,Cp),_i,_I(sf,Ap,Qr,Jt,Yc,Zo),hi,wp,Ao,zR(Tp,sf,Qr,Jt,Yc,lr,Zo,Zt),YR(eD,Qr,Hr),tD,lr,j7,W7,rD,Zt,pf),zee=ZP(Br,Gee,hi,QL,lr,Zt);var q7=new WeakSet,JL=BI(Us),oD=kR(new Uint32Array(1)),X7=UL(oD,hi),Y7=VL(oD),Hee=eR(q7,_i,Ao,JL,A0,IL(JL),X7,Y7);var p9=KP(Qo),nD=SL(H7,Ca,T0),Vs=PR(nD),Lp=UI(p9,_i,qL,XL,YL,l9,G7,u9,KL,GL(Rp),z7),Gs=CL(cI(Ca),nD),jee=oR(Vs,Lp,Jt,Gs,Co),Wi=vR(GP(Z_),eD,nf,yR,An.createCancelAndHoldAutomationEvent,An.createCancelScheduledValuesAutomationEvent,An.createExponentialRampToValueAutomationEvent,An.createLinearRampToValueAutomationEvent,An.createSetTargetAutomationEvent,An.createSetValueAutomationEvent,An.createSetValueCurveAutomationEvent,Ip,V7),Wee=rR(Br,jee,Wi,_r,Lp,lr,Zt,Kc);var qee=pR(Br,dR,hi,_r,GI(Qo,Rp),lr,Zt,Co),Xee=ER(Vs,D7,Jt,Gs,Co),Jc=NL(ZL),Yee=CR(Br,Wi,Xee,wp,D7,lr,Zt,Jc),wa=LI(Hi,W7),$ee=zL(_r,wa),Ma=$I(Ip,$ee),Kee=MR(Ma,Jt,Co),Jee=wR(Br,Kee,Ma,lr,Zt),Zee=OR(Op,Jt,Co),Qee=NR(Br,Zee,Op,lr,Zt,jL),ete=ZI(p9,Lp,Qo,wa),Dp=JI(p9,_i,ete,l9,u9),tte=DR(Vs,Dp,Jt,Gs,Co),rte=LR(Br,Wi,tte,Dp,lr,Zt,Kc),iD=QI(Ao,Rp),ote=FR(iD,Jt,Co),nte=BR(Br,ote,iD,lr,Zt,Jc),ite=jR(Vs,k7,Jt,Gs,Co),ste=HR(Br,Wi,ite,k7,lr,Zt,Jc),sD=eL(Ao),ate=JR(Vs,sD,Jt,Gs,Co),cte=KR(Br,Wi,ate,sD,Ao,lr,Zt,Jc),lte=nI(Vs,Qo,Jt,Gs,Co),ute=oI(Br,Wi,lte,Qo,lr,Zt),pte=oL(wp,_r,Pp,Ao),d9=wL(_i,Qo,Pp,DL(Qo,A0)),dte=mI(Lp,Jt,A0,Co,d9),hte=tL(pte),fte=fI(Br,hte,dte,lr,Zt,Jc),mte=hR(Wi,Ma,Dp,Pp,Ao,F7,Zt,Rp),aD=new WeakMap,$7=RI(qee,mte,tD,Zt,aD,Kc),cD=lL(p9,_i,l9,G7,u9,z7),_te=yL(Vs,cD,Jt,Gs,Co),gte=vL(Br,Wi,cD,_te,lr,Zt,Kc),lD=IR(Lp),vte=_L(lD,_r,Qo,U7,wa),h9=mL(lD,_r,vte,U7,wa,Ip,Rp),yte=pL(Tp,_r,Ma,Qo,Pp,h9,Ao,Ap,F7,wa),uD=uL(yte),xte=bL(Vs,Ma,Dp,Qo,uD,Jt,A0,Gs,Co,d9),bte=xL(Br,Wi,uD,xte,lr,Zt,Jc),Tte=dL(hi),Ate=TL(Tte,lr,new WeakSet,WL),Cte=fL(Ma,Op,Qo,h9,Ao,wa),pD=hL(Cte,Ao),Ete=RL(Vs,pD,Jt,Gs,Co),Ste=PL(Br,Wi,pD,Ete,lr,Zt),wte=BL(h9,Jt,Co),Mte=kL(Br,_r,h9,wte,lr,Zt,Jc),dD=SI(Us),K7=tI(Us),hD=new WeakMap,Nte=pI(hD,A0),Ote=dD?XP(_i,Ao,QR(Us),K7,rI(FP),lr,Nte,Zt,pf,new WeakMap,new WeakMap,LL(pf,A0),Us):void 0,Pte=CI(j7,Zt),Rte=GR(q7,_i,VR,ZR,new WeakSet,lr,Pte,xp,ji,X7,Y7),fD=AR(Ote,zee,Hee,Wee,Yee,Jee,Qee,rte,nte,Rte,ste,cte,ute,fte,$7,gte,bte,Ate,Ste,Mte),Ite=wI(Br,nL,lr,Zt),Lte=MI(Br,iL,lr,Zt),Dte=NI(Br,sL,lr,Zt),kte=aL(_r,Zt),Bte=OI(Br,kte,lr),mD=uR(fD,_r,Ao,B7,Ite,Lte,Dte,Bte,Ip);var J7=dI(aD),Fte=JP(J7),_D=RR(hi),Ute=qR(J7),gD=$R(hi),vD=new WeakMap,Vte=iI(vD,Hr),Gte=YI(_D,hi,_r,Ma,Op,Dp,Qo,Pp,Ao,gD,K7,Vte,wa),zte=jI(_r,Gte,Qo,Ao,wa),Hte=TR(Vs,_D,Lp,Ma,Op,Dp,Qo,Ute,gD,K7,Jt,pf,A0,Gs,Co,d9),jte=lI(hD),Wte=ML(vD),Z7=dD?xR(Fte,Br,Wi,Hte,zte,Qr,jte,lr,Zt,pf,HL,Wte,$L,Kc):void 0;var kYe=PI(_r,Ao,B7,$7,Ip);var yD=UR(Ao,A0),xD=OL(q7,_i,H7,J7,d9,xp,X7,Y7),BYe=II(_i,_r,yD,$7,xD);var bD=gL(fD,_i,_r,yD,xD);var TD=gI(yp,j7),AD=vI(vp,W7),CD=yI(nf,rD),ED=xI(yp,Zt);function qi(o){return CD(o)}function zs(o){return AD(o)}function kp(o){return ED(o)}function Na(o){return TD(o)}function f9(o){return o instanceof AudioBuffer}function eo(o){return typeof o>"u"}function $e(o){return!eo(o)}function SD(o){return typeof o=="function"}function jn(o){return typeof o=="number"}function Hs(o){return Object.prototype.toString.call(o)==="[object Object]"&&o.constructor===Object}function wD(o){return typeof o=="boolean"}function fo(o){return Array.isArray(o)}function Eo(o){return typeof o=="string"}function df(o){return Eo(o)&&/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i.test(o)}function qte(o,e){return o==="value"||qi(e)||zs(e)||f9(e)}function hf(o,...e){if(!e.length)return o;let t=e.shift();if(Hs(o)&&Hs(t))for(let r in t)qte(r,t[r])?o[r]=t[r]:Hs(t[r])?(o[r]||Object.assign(o,{[r]:{}}),hf(o[r],t[r])):Object.assign(o,{[r]:t[r]});return hf(o,...e)}function MD(o,e){return o.length===e.length&&o.every((t,r)=>e[r]===t)}function pe(o,e,t=[],r){let n={},i=Array.from(e);if(Hs(i[0])&&r&&!Reflect.has(i[0],r)&&(Object.keys(i[0]).some(a=>Reflect.has(o,a))||(hf(n,{[r]:i[0]}),t.splice(t.indexOf(r),1),i.shift())),i.length===1&&Hs(i[0]))hf(n,i[0]);else for(let s=0;s<t.length;s++)$e(i[s])&&(n[t[s]]=i[s]);return hf(o,n)}function ND(o){return o.constructor.getDefaults()}function C0(o,e){return eo(o)?e:o}function Oa(o,e){return e.forEach(t=>{Reflect.has(o,t)&&delete o[t]}),o}function Bp(o){return Math.pow(10,o/20)}function m9(o){return 20*(Math.log(o)/Math.LN10)}function _9(o){return Math.pow(2,o/12)}var g9=440;function OD(){return g9}function PD(o){g9=o}function ff(o){return Math.round(Q7(o))}function Q7(o){return 69+12*Math.log2(o/g9)}function RD(o){return g9*Math.pow(2,(o-69)/12)}var mf="14.7.77";function ze(o,e){if(!o)throw new Error(e)}function Uo(o,e,t=1/0){if(!(e<=o&&o<=t))throw new RangeError(`Value must be within [${e}, ${t}], got: ${o}`)}function v9(o){!o.isOffline&&o.state!=="running"&&_f('The AudioContext is "suspended". Invoke Tone.start() from a user action to start the audio.')}var ID=console;function LD(...o){ID.log(...o)}function _f(...o){ID.warn(...o)}function DD(o){return new mD(o)}function kD(o,e,t){return new bD(o,e,t)}var E0=typeof self=="object"?self:null,BD=E0&&(E0.hasOwnProperty("AudioContext")||E0.hasOwnProperty("webkitAudioContext"));function FD(o,e,t){return ze($e(Z7),"This node only works in a secure context (https or localhost)"),new Z7(o,e,t)}var mo=class{constructor(){this.debug=!1,this._wasDisposed=!1}static getDefaults(){return{}}log(...e){(this.debug||E0&&this.toString()===E0.TONE_DEBUG_CLASS)&&LD(this,...e)}dispose(){return this._wasDisposed=!0,this}get disposed(){return this._wasDisposed}toString(){return this.name}};mo.version=mf;function Fp(o,e){return o>e+1e-6}function gf(o,e){return Fp(o,e)||en(o,e)}function y9(o,e){return o+1e-6<e}function en(o,e){return Math.abs(o-e)<1e-6}function UD(o,e,t){return Math.max(Math.min(o,t),e)}var So=class extends mo{constructor(){super();this.name="Timeline",this._timeline=[];let e=pe(So.getDefaults(),arguments,["memory"]);this.memory=e.memory,this.increasing=e.increasing}static getDefaults(){return{memory:1/0,increasing:!1}}get length(){return this._timeline.length}add(e){if(ze(Reflect.has(e,"time"),"Timeline: events must have a time attribute"),e.time=e.time.valueOf(),this.increasing&&this.length){let t=this._timeline[this.length-1];ze(gf(e.time,t.time),"The time must be greater than or equal to the last scheduled time"),this._timeline.push(e)}else{let t=this._search(e.time);this._timeline.splice(t+1,0,e)}if(this.length>this.memory){let t=this.length-this.memory;this._timeline.splice(0,t)}return this}remove(e){let t=this._timeline.indexOf(e);return t!==-1&&this._timeline.splice(t,1),this}get(e,t="time"){let r=this._search(e,t);return r!==-1?this._timeline[r]:null}peek(){return this._timeline[0]}shift(){return this._timeline.shift()}getAfter(e,t="time"){let r=this._search(e,t);return r+1<this._timeline.length?this._timeline[r+1]:null}getBefore(e){let t=this._timeline.length;if(t>0&&this._timeline[t-1].time<e)return this._timeline[t-1];let r=this._search(e);return r-1>=0?this._timeline[r-1]:null}cancel(e){if(this._timeline.length>1){let t=this._search(e);if(t>=0)if(en(this._timeline[t].time,e)){for(let r=t;r>=0&&en(this._timeline[r].time,e);r--)t=r;this._timeline=this._timeline.slice(0,t)}else this._timeline=this._timeline.slice(0,t+1);else this._timeline=[]}else this._timeline.length===1&&gf(this._timeline[0].time,e)&&(this._timeline=[]);return this}cancelBefore(e){let t=this._search(e);return t>=0&&(this._timeline=this._timeline.slice(t+1)),this}previousEvent(e){let t=this._timeline.indexOf(e);return t>0?this._timeline[t-1]:null}_search(e,t="time"){if(this._timeline.length===0)return-1;let r=0,n=this._timeline.length,i=n;if(n>0&&this._timeline[n-1][t]<=e)return n-1;for(;r<i;){let s=Math.floor(r+(i-r)/2),a=this._timeline[s],c=this._timeline[s+1];if(en(a[t],e)){for(let l=s;l<this._timeline.length;l++){let u=this._timeline[l];if(en(u[t],e))s=l;else break}return s}else{if(y9(a[t],e)&&Fp(c[t],e))return s;Fp(a[t],e)?i=s:r=s+1}}return-1}_iterate(e,t=0,r=this._timeline.length-1){this._timeline.slice(t,r+1).forEach(e)}forEach(e){return this._iterate(e),this}forEachBefore(e,t){let r=this._search(e);return r!==-1&&this._iterate(t,0,r),this}forEachAfter(e,t){let r=this._search(e);return this._iterate(t,r+1),this}forEachBetween(e,t,r){let n=this._search(e),i=this._search(t);return n!==-1&&i!==-1?(this._timeline[n].time!==e&&(n+=1),this._timeline[i].time===t&&(i-=1),this._iterate(r,n,i)):n===-1&&this._iterate(r,0,i),this}forEachFrom(e,t){let r=this._search(e);for(;r>=0&&this._timeline[r].time>=e;)r--;return this._iterate(t,r+1),this}forEachAtTime(e,t){let r=this._search(e);if(r!==-1&&en(this._timeline[r].time,e)){let n=r;for(let i=r;i>=0&&en(this._timeline[i].time,e);i--)n=i;this._iterate(i=>{t(i)},n,r)}return this}dispose(){return super.dispose(),this._timeline=[],this}};var ak=Ni(sk(),1),{__extends:h$e,__assign:f$e,__rest:m$e,__decorate:Wn,__param:_$e,__metadata:g$e,__awaiter:xt,__generator:v$e,__exportStar:y$e,__createBinding:x$e,__values:b$e,__read:T$e,__spread:A$e,__spreadArrays:C$e,__spreadArray:E$e,__await:S$e,__asyncGenerator:w$e,__asyncDelegator:M$e,__asyncValues:N$e,__makeTemplateObject:O$e,__importStar:P$e,__importDefault:R$e,__classPrivateFieldGet:I$e,__classPrivateFieldSet:L$e}=ak.default;var tg=class{constructor(e,t,r){this._callback=e,this._type=t,this._updateInterval=r,this._createClock()}_createWorker(){let e=new Blob([`
			// the initial timeout time
			let timeoutTime =  ${(this._updateInterval*1e3).toFixed(1)};
			// onmessage callback
			self.onmessage = function(msg){
				timeoutTime = parseInt(msg.data);
			};
			// the tick function which posts a message
			// and schedules a new tick
			function tick(){
				setTimeout(tick, timeoutTime);
				self.postMessage('tick');
			}
			// call tick initially
			tick();
			`],{type:"text/javascript"}),t=URL.createObjectURL(e),r=new Worker(t);r.onmessage=this._callback.bind(this),this._worker=r}_createTimeout(){this._timeout=setTimeout(()=>{this._createTimeout(),this._callback()},this._updateInterval*1e3)}_createClock(){if(this._type==="worker")try{this._createWorker()}catch{this._type="timeout",this._createClock()}else this._type==="timeout"&&this._createTimeout()}_disposeClock(){this._timeout&&(clearTimeout(this._timeout),this._timeout=0),this._worker&&(this._worker.terminate(),this._worker.onmessage=null)}get updateInterval(){return this._updateInterval}set updateInterval(e){this._updateInterval=Math.max(e,128/44100),this._type==="worker"&&this._worker.postMessage(Math.max(e*1e3,1))}get type(){return this._type}set type(e){this._disposeClock(),this._type=e,this._createClock()}dispose(){this._disposeClock()}};var ck=[];function Vp(o){ck.push(o)}function lk(o){ck.forEach(e=>e(o))}var uk=[];function Gp(o){uk.push(o)}function pk(o){uk.forEach(e=>e(o))}var S0=class extends mo{constructor(){super(...arguments);this.name="Emitter"}on(e,t){return e.split(/\W+/).forEach(n=>{eo(this._events)&&(this._events={}),this._events.hasOwnProperty(n)||(this._events[n]=[]),this._events[n].push(t)}),this}once(e,t){let r=(...n)=>{t(...n),this.off(e,r)};return this.on(e,r),this}off(e,t){return e.split(/\W+/).forEach(n=>{if(eo(this._events)&&(this._events={}),this._events.hasOwnProperty(e))if(eo(t))this._events[e]=[];else{let i=this._events[e];for(let s=i.length-1;s>=0;s--)i[s]===t&&i.splice(s,1)}}),this}emit(e,...t){if(this._events&&this._events.hasOwnProperty(e)){let r=this._events[e].slice(0);for(let n=0,i=r.length;n<i;n++)r[n].apply(this,t)}return this}static mixin(e){["on","once","off","emit"].forEach(t=>{let r=Object.getOwnPropertyDescriptor(S0.prototype,t);Object.defineProperty(e.prototype,t,r)})}dispose(){return super.dispose(),this._events=void 0,this}};var vf=class extends S0{constructor(){super(...arguments);this.isOffline=!1}toJSON(){return{}}};var Pa=class extends vf{constructor(){super();this.name="Context",this._constants=new Map,this._timeouts=new So,this._timeoutIds=0,this._initialized=!1,this.isOffline=!1,this._workletModules=new Map;let e=pe(Pa.getDefaults(),arguments,["context"]);e.context?this._context=e.context:this._context=DD({latencyHint:e.latencyHint}),this._ticker=new tg(this.emit.bind(this,"tick"),e.clockSource,e.updateInterval),this.on("tick",this._timeoutLoop.bind(this)),this._context.onstatechange=()=>{this.emit("statechange",this.state)},this._setLatencyHint(e.latencyHint),this.lookAhead=e.lookAhead}static getDefaults(){return{clockSource:"worker",latencyHint:"interactive",lookAhead:.1,updateInterval:.05}}initialize(){return this._initialized||(lk(this),this._initialized=!0),this}createAnalyser(){return this._context.createAnalyser()}createOscillator(){return this._context.createOscillator()}createBufferSource(){return this._context.createBufferSource()}createBiquadFilter(){return this._context.createBiquadFilter()}createBuffer(e,t,r){return this._context.createBuffer(e,t,r)}createChannelMerger(e){return this._context.createChannelMerger(e)}createChannelSplitter(e){return this._context.createChannelSplitter(e)}createConstantSource(){return this._context.createConstantSource()}createConvolver(){return this._context.createConvolver()}createDelay(e){return this._context.createDelay(e)}createDynamicsCompressor(){return this._context.createDynamicsCompressor()}createGain(){return this._context.createGain()}createIIRFilter(e,t){return this._context.createIIRFilter(e,t)}createPanner(){return this._context.createPanner()}createPeriodicWave(e,t,r){return this._context.createPeriodicWave(e,t,r)}createStereoPanner(){return this._context.createStereoPanner()}createWaveShaper(){return this._context.createWaveShaper()}createMediaStreamSource(e){return ze(Na(this._context),"Not available if OfflineAudioContext"),this._context.createMediaStreamSource(e)}createMediaElementSource(e){return ze(Na(this._context),"Not available if OfflineAudioContext"),this._context.createMediaElementSource(e)}createMediaStreamDestination(){return ze(Na(this._context),"Not available if OfflineAudioContext"),this._context.createMediaStreamDestination()}decodeAudioData(e){return this._context.decodeAudioData(e)}get currentTime(){return this._context.currentTime}get state(){return this._context.state}get sampleRate(){return this._context.sampleRate}get listener(){return this.initialize(),this._listener}set listener(e){ze(!this._initialized,"The listener cannot be set after initialization."),this._listener=e}get transport(){return this.initialize(),this._transport}set transport(e){ze(!this._initialized,"The transport cannot be set after initialization."),this._transport=e}get draw(){return this.initialize(),this._draw}set draw(e){ze(!this._initialized,"Draw cannot be set after initialization."),this._draw=e}get destination(){return this.initialize(),this._destination}set destination(e){ze(!this._initialized,"The destination cannot be set after initialization."),this._destination=e}createAudioWorkletNode(e,t){return FD(this.rawContext,e,t)}addAudioWorkletModule(e,t){return xt(this,void 0,void 0,function*(){ze($e(this.rawContext.audioWorklet),"AudioWorkletNode is only available in a secure context (https or localhost)"),this._workletModules.has(t)||this._workletModules.set(t,this.rawContext.audioWorklet.addModule(e)),yield this._workletModules.get(t)})}workletsAreReady(){return xt(this,void 0,void 0,function*(){let e=[];this._workletModules.forEach(t=>e.push(t)),yield Promise.all(e)})}get updateInterval(){return this._ticker.updateInterval}set updateInterval(e){this._ticker.updateInterval=e}get clockSource(){return this._ticker.type}set clockSource(e){this._ticker.type=e}get latencyHint(){return this._latencyHint}_setLatencyHint(e){let t=0;if(this._latencyHint=e,Eo(e))switch(e){case"interactive":t=.1;break;case"playback":t=.5;break;case"balanced":t=.25;break}this.lookAhead=t,this.updateInterval=t/2}get rawContext(){return this._context}now(){return this._context.currentTime+this.lookAhead}immediate(){return this._context.currentTime}resume(){return Na(this._context)?this._context.resume():Promise.resolve()}close(){return xt(this,void 0,void 0,function*(){Na(this._context)&&(yield this._context.close()),this._initialized&&pk(this)})}getConstant(e){if(this._constants.has(e))return this._constants.get(e);{let t=this._context.createBuffer(1,128,this._context.sampleRate),r=t.getChannelData(0);for(let i=0;i<r.length;i++)r[i]=e;let n=this._context.createBufferSource();return n.channelCount=1,n.channelCountMode="explicit",n.buffer=t,n.loop=!0,n.start(0),this._constants.set(e,n),n}}dispose(){return super.dispose(),this._ticker.dispose(),this._timeouts.dispose(),Object.keys(this._constants).map(e=>this._constants[e].disconnect()),this}_timeoutLoop(){let e=this.now(),t=this._timeouts.peek();for(;this._timeouts.length&&t&&t.time<=e;)t.callback(),this._timeouts.shift(),t=this._timeouts.peek()}setTimeout(e,t){this._timeoutIds++;let r=this.now();return this._timeouts.add({callback:e,id:this._timeoutIds,time:r+t}),this._timeoutIds}clearTimeout(e){return this._timeouts.forEach(t=>{t.id===e&&this._timeouts.remove(t)}),this}clearInterval(e){return this.clearTimeout(e)}setInterval(e,t){let r=++this._timeoutIds,n=()=>{let i=this.now();this._timeouts.add({callback:()=>{e(),n()},id:r,time:i+t})};return n(),r}};var rg=class extends vf{constructor(){super(...arguments);this.lookAhead=0,this.latencyHint=0,this.isOffline=!1}createAnalyser(){return{}}createOscillator(){return{}}createBufferSource(){return{}}createBiquadFilter(){return{}}createBuffer(e,t,r){return{}}createChannelMerger(e){return{}}createChannelSplitter(e){return{}}createConstantSource(){return{}}createConvolver(){return{}}createDelay(e){return{}}createDynamicsCompressor(){return{}}createGain(){return{}}createIIRFilter(e,t){return{}}createPanner(){return{}}createPeriodicWave(e,t,r){return{}}createStereoPanner(){return{}}createWaveShaper(){return{}}createMediaStreamSource(e){return{}}createMediaElementSource(e){return{}}createMediaStreamDestination(){return{}}decodeAudioData(e){return Promise.resolve({})}createAudioWorkletNode(e,t){return{}}get rawContext(){return{}}addAudioWorkletModule(e,t){return xt(this,void 0,void 0,function*(){return Promise.resolve()})}resume(){return Promise.resolve()}setTimeout(e,t){return 0}clearTimeout(e){return this}setInterval(e,t){return 0}clearInterval(e){return this}getConstant(e){return{}}get currentTime(){return 0}get state(){return{}}get sampleRate(){return 0}get listener(){return{}}get transport(){return{}}get draw(){return{}}set draw(e){}get destination(){return{}}set destination(e){}now(){return 0}immediate(){return 0}};function _t(o,e){fo(e)?e.forEach(t=>_t(o,t)):Object.defineProperty(o,e,{enumerable:!0,writable:!1})}function og(o,e){fo(e)?e.forEach(t=>og(o,t)):Object.defineProperty(o,e,{writable:!0})}var gt=()=>{};var zt=class extends mo{constructor(){super();this.name="ToneAudioBuffer",this.onload=gt;let e=pe(zt.getDefaults(),arguments,["url","onload","onerror"]);this.reverse=e.reverse,this.onload=e.onload,e.url&&f9(e.url)||e.url instanceof zt?this.set(e.url):Eo(e.url)&&this.load(e.url).catch(e.onerror)}static getDefaults(){return{onerror:gt,onload:gt,reverse:!1}}get sampleRate(){return this._buffer?this._buffer.sampleRate:Xi().sampleRate}set(e){return e instanceof zt?e.loaded?this._buffer=e.get():e.onload=()=>{this.set(e),this.onload(this)}:this._buffer=e,this._reversed&&this._reverse(),this}get(){return this._buffer}load(e){return xt(this,void 0,void 0,function*(){let t=zt.load(e).then(r=>{this.set(r),this.onload(this)});zt.downloads.push(t);try{yield t}finally{let r=zt.downloads.indexOf(t);zt.downloads.splice(r,1)}return this})}dispose(){return super.dispose(),this._buffer=void 0,this}fromArray(e){let t=fo(e)&&e[0].length>0,r=t?e.length:1,n=t?e[0].length:e.length,i=Xi(),s=i.createBuffer(r,n,i.sampleRate),a=!t&&r===1?[e]:e;for(let c=0;c<r;c++)s.copyToChannel(a[c],c);return this._buffer=s,this}toMono(e){if(jn(e))this.fromArray(this.toArray(e));else{let t=new Float32Array(this.length),r=this.numberOfChannels;for(let n=0;n<r;n++){let i=this.toArray(n);for(let s=0;s<i.length;s++)t[s]+=i[s]}t=t.map(n=>n/r),this.fromArray(t)}return this}toArray(e){if(jn(e))return this.getChannelData(e);if(this.numberOfChannels===1)return this.toArray(0);{let t=[];for(let r=0;r<this.numberOfChannels;r++)t[r]=this.getChannelData(r);return t}}getChannelData(e){return this._buffer?this._buffer.getChannelData(e):new Float32Array(0)}slice(e,t=this.duration){let r=Math.floor(e*this.sampleRate),n=Math.floor(t*this.sampleRate);ze(r<n,"The start time must be less than the end time");let i=n-r,s=Xi().createBuffer(this.numberOfChannels,i,this.sampleRate);for(let a=0;a<this.numberOfChannels;a++)s.copyToChannel(this.getChannelData(a).subarray(r,n),a);return new zt(s)}_reverse(){if(this.loaded)for(let e=0;e<this.numberOfChannels;e++)this.getChannelData(e).reverse();return this}get loaded(){return this.length>0}get duration(){return this._buffer?this._buffer.duration:0}get length(){return this._buffer?this._buffer.length:0}get numberOfChannels(){return this._buffer?this._buffer.numberOfChannels:0}get reverse(){return this._reversed}set reverse(e){this._reversed!==e&&(this._reversed=e,this._reverse())}static fromArray(e){return new zt().fromArray(e)}static fromUrl(e){return xt(this,void 0,void 0,function*(){return yield new zt().load(e)})}static load(e){return xt(this,void 0,void 0,function*(){let t=e.match(/\[([^\]\[]+\|.+)\]$/);if(t){let a=t[1].split("|"),c=a[0];for(let l of a)if(zt.supportsType(l)){c=l;break}e=e.replace(t[0],c)}let r=zt.baseUrl===""||zt.baseUrl.endsWith("/")?zt.baseUrl:zt.baseUrl+"/",n=yield fetch(r+e);if(!n.ok)throw new Error(`could not load url: ${e}`);let i=yield n.arrayBuffer();return yield Xi().decodeAudioData(i)})}static supportsType(e){let t=e.split("."),r=t[t.length-1];return document.createElement("audio").canPlayType("audio/"+r)!==""}static loaded(){return xt(this,void 0,void 0,function*(){for(yield Promise.resolve();zt.downloads.length;)yield zt.downloads[0]})}};zt.baseUrl="";zt.downloads=[];var Zc=class extends Pa{constructor(){super({clockSource:"offline",context:kp(arguments[0])?arguments[0]:kD(arguments[0],arguments[1]*arguments[2],arguments[2]),lookAhead:0,updateInterval:kp(arguments[0])?128/arguments[0].sampleRate:128/arguments[2]});this.name="OfflineContext",this._currentTime=0,this.isOffline=!0,this._duration=kp(arguments[0])?arguments[0].length/arguments[0].sampleRate:arguments[1]}now(){return this._currentTime}get currentTime(){return this._currentTime}_renderClock(e){return xt(this,void 0,void 0,function*(){let t=0;for(;this._duration-this._currentTime>=0;){this.emit("tick"),this._currentTime+=128/this.sampleRate,t++;let r=Math.floor(this.sampleRate/128);e&&t%r===0&&(yield new Promise(n=>setTimeout(n,1)))}})}render(e=!0){return xt(this,void 0,void 0,function*(){yield this.workletsAreReady(),yield this._renderClock(e);let t=yield this._context.startRendering();return new zt(t)})}close(){return Promise.resolve()}};var dk=new rg,zp=dk;function Xi(){return zp===dk&&BD&&Xte(new Pa),zp}function Xte(o){Na(o)?zp=new Pa(o):kp(o)?zp=new Zc(o):zp=o}function hk(){return zp.resume()}if(E0&&!E0.TONE_SILENCE_LOGGING){let o="v";mf==="dev"&&(o="");let e=` * Tone.js ${o}${mf} * `;console.log(`%c${e}`,"background: #000; color: #fff")}var yf=class extends mo{constructor(e,t,r){super();this.defaultUnits="s",this._val=t,this._units=r,this.context=e,this._expressions=this._getExpressions()}_getExpressions(){return{hz:{method:e=>this._frequencyToUnits(parseFloat(e)),regexp:/^(\d+(?:\.\d+)?)hz$/i},i:{method:e=>this._ticksToUnits(parseInt(e,10)),regexp:/^(\d+)i$/i},m:{method:e=>this._beatsToUnits(parseInt(e,10)*this._getTimeSignature()),regexp:/^(\d+)m$/i},n:{method:(e,t)=>{let r=parseInt(e,10),n=t==="."?1.5:1;return r===1?this._beatsToUnits(this._getTimeSignature())*n:this._beatsToUnits(4/r)*n},regexp:/^(\d+)n(\.?)$/i},number:{method:e=>this._expressions[this.defaultUnits].method.call(this,e),regexp:/^(\d+(?:\.\d+)?)$/},s:{method:e=>this._secondsToUnits(parseFloat(e)),regexp:/^(\d+(?:\.\d+)?)s$/},samples:{method:e=>parseInt(e,10)/this.context.sampleRate,regexp:/^(\d+)samples$/},t:{method:e=>{let t=parseInt(e,10);return this._beatsToUnits(8/(Math.floor(t)*3))},regexp:/^(\d+)t$/i},tr:{method:(e,t,r)=>{let n=0;return e&&e!=="0"&&(n+=this._beatsToUnits(this._getTimeSignature()*parseFloat(e))),t&&t!=="0"&&(n+=this._beatsToUnits(parseFloat(t))),r&&r!=="0"&&(n+=this._beatsToUnits(parseFloat(r)/4)),n},regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?$/}}}valueOf(){if(this._val instanceof yf&&this.fromType(this._val),eo(this._val))return this._noArg();if(Eo(this._val)&&eo(this._units)){for(let e in this._expressions)if(this._expressions[e].regexp.test(this._val.trim())){this._units=e;break}}else if(Hs(this._val)){let e=0;for(let t in this._val)if($e(this._val[t])){let r=this._val[t];e+=new this.constructor(this.context,t).valueOf()*r}return e}if($e(this._units)){let e=this._expressions[this._units],t=this._val.toString().trim().match(e.regexp);return t?e.method.apply(this,t.slice(1)):e.method.call(this,this._val)}else return Eo(this._val)?parseFloat(this._val):this._val}_frequencyToUnits(e){return 1/e}_beatsToUnits(e){return 60/this._getBpm()*e}_secondsToUnits(e){return e}_ticksToUnits(e){return e*this._beatsToUnits(1)/this._getPPQ()}_noArg(){return this._now()}_getBpm(){return this.context.transport.bpm.value}_getTimeSignature(){return this.context.transport.timeSignature}_getPPQ(){return this.context.transport.PPQ}fromType(e){switch(this._units=void 0,this.defaultUnits){case"s":this._val=e.toSeconds();break;case"i":this._val=e.toTicks();break;case"hz":this._val=e.toFrequency();break;case"midi":this._val=e.toMidi();break}return this}toFrequency(){return 1/this.toSeconds()}toSamples(){return this.toSeconds()*this.context.sampleRate}toMilliseconds(){return this.toSeconds()*1e3}};var Vo=class extends yf{constructor(){super(...arguments);this.name="TimeClass"}_getExpressions(){return Object.assign(super._getExpressions(),{now:{method:e=>this._now()+new this.constructor(this.context,e).valueOf(),regexp:/^\+(.+)/},quantize:{method:e=>{let t=new Vo(this.context,e).valueOf();return this._secondsToUnits(this.context.transport.nextSubdivision(t))},regexp:/^@(.+)/}})}quantize(e,t=1){let r=new this.constructor(this.context,e).valueOf(),n=this.valueOf(),a=Math.round(n/r)*r-n;return n+a*t}toNotation(){let e=this.toSeconds(),t=["1m"];for(let i=1;i<9;i++){let s=Math.pow(2,i);t.push(s+"n."),t.push(s+"n"),t.push(s+"t")}t.push("0");let r=t[0],n=new Vo(this.context,t[0]).toSeconds();return t.forEach(i=>{let s=new Vo(this.context,i).toSeconds();Math.abs(s-e)<Math.abs(n-e)&&(r=i,n=s)}),r}toBarsBeatsSixteenths(){let e=this._beatsToUnits(1),t=this.valueOf()/e;t=parseFloat(t.toFixed(4));let r=Math.floor(t/this._getTimeSignature()),n=t%1*4;t=Math.floor(t)%this._getTimeSignature();let i=n.toString();return i.length>3&&(n=parseFloat(parseFloat(i).toFixed(3))),[r,t,n].join(":")}toTicks(){let e=this._beatsToUnits(1),t=this.valueOf()/e;return Math.round(t*this._getPPQ())}toSeconds(){return this.valueOf()}toMidi(){return ff(this.toFrequency())}_now(){return this.context.now()}};var tn=class extends Vo{constructor(){super(...arguments);this.name="Frequency",this.defaultUnits="hz"}static get A4(){return OD()}static set A4(e){PD(e)}_getExpressions(){return Object.assign({},super._getExpressions(),{midi:{regexp:/^(\d+(?:\.\d+)?midi)/,method(e){return this.defaultUnits==="midi"?e:tn.mtof(e)}},note:{regexp:/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i,method(e,t){let n=Yte[e.toLowerCase()]+(parseInt(t,10)+1)*12;return this.defaultUnits==="midi"?n:tn.mtof(n)}},tr:{regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?/,method(e,t,r){let n=1;return e&&e!=="0"&&(n*=this._beatsToUnits(this._getTimeSignature()*parseFloat(e))),t&&t!=="0"&&(n*=this._beatsToUnits(parseFloat(t))),r&&r!=="0"&&(n*=this._beatsToUnits(parseFloat(r)/4)),n}}})}transpose(e){return new tn(this.context,this.valueOf()*_9(e))}harmonize(e){return e.map(t=>this.transpose(t))}toMidi(){return ff(this.valueOf())}toNote(){let e=this.toFrequency(),t=Math.log2(e/tn.A4),r=Math.round(12*t)+57,n=Math.floor(r/12);return n<0&&(r+=-12*n),$te[r%12]+n.toString()}toSeconds(){return 1/super.toSeconds()}toTicks(){let e=this._beatsToUnits(1),t=this.valueOf()/e;return Math.floor(t*this._getPPQ())}_noArg(){return 0}_frequencyToUnits(e){return e}_ticksToUnits(e){return 1/(e*60/(this._getBpm()*this._getPPQ()))}_beatsToUnits(e){return 1/super._beatsToUnits(e)}_secondsToUnits(e){return 1/e}static mtof(e){return RD(e)}static ftom(e){return ff(e)}},Yte={cbb:-2,cb:-1,c:0,"c#":1,cx:2,dbb:0,db:1,d:2,"d#":3,dx:4,ebb:2,eb:3,e:4,"e#":5,ex:6,fbb:3,fb:4,f:5,"f#":6,fx:7,gbb:5,gb:6,g:7,"g#":8,gx:9,abb:7,ab:8,a:9,"a#":10,ax:11,bbb:9,bb:10,b:11,"b#":12,bx:13},$te=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];var w0=class extends Vo{constructor(){super(...arguments);this.name="TransportTime"}_now(){return this.context.transport.seconds}};var to=class extends mo{constructor(){super();let e=pe(to.getDefaults(),arguments,["context"]);this.defaultContext?this.context=this.defaultContext:this.context=e.context}static getDefaults(){return{context:Xi()}}now(){return this.context.currentTime+this.context.lookAhead}immediate(){return this.context.currentTime}get sampleTime(){return 1/this.context.sampleRate}get blockTime(){return 128/this.context.sampleRate}toSeconds(e){return new Vo(this.context,e).toSeconds()}toFrequency(e){return new tn(this.context,e).toFrequency()}toTicks(e){return new w0(this.context,e).toTicks()}_getPartialProperties(e){let t=this.get();return Object.keys(t).forEach(r=>{eo(e[r])&&delete t[r]}),t}get(){let e=ND(this);return Object.keys(e).forEach(t=>{if(Reflect.has(this,t)){let r=this[t];$e(r)&&$e(r.value)&&$e(r.setValueAtTime)?e[t]=r.value:r instanceof to?e[t]=r._getPartialProperties(e[t]):fo(r)||jn(r)||Eo(r)||wD(r)?e[t]=r:delete e[t]}}),e}set(e){return Object.keys(e).forEach(t=>{Reflect.has(this,t)&&$e(this[t])&&(this[t]&&$e(this[t].value)&&$e(this[t].setValueAtTime)?this[t].value!==e[t]&&(this[t].value=e[t]):this[t]instanceof to?this[t].set(e[t]):this[t]=e[t])}),this}};var ft=class extends to{constructor(){super(pe(ft.getDefaults(),arguments,["param","units","convert"]));this.name="Param",this.overridden=!1,this._minOutput=1e-7;let e=pe(ft.getDefaults(),arguments,["param","units","convert"]);for(ze($e(e.param)&&(qi(e.param)||e.param instanceof ft),"param must be an AudioParam");!qi(e.param);)e.param=e.param._param;this._swappable=$e(e.swappable)?e.swappable:!1,this._swappable?(this.input=this.context.createGain(),this._param=e.param,this.input.connect(this._param)):this._param=this.input=e.param,this._events=new So(1e3),this._initialValue=this._param.defaultValue,this.units=e.units,this.convert=e.convert,this._minValue=e.minValue,this._maxValue=e.maxValue,$e(e.value)&&e.value!==this._toType(this._initialValue)&&this.setValueAtTime(e.value,0)}static getDefaults(){return Object.assign(to.getDefaults(),{convert:!0,units:"number"})}get value(){let e=this.now();return this.getValueAtTime(e)}set value(e){this.cancelScheduledValues(this.now()),this.setValueAtTime(e,this.now())}get minValue(){return $e(this._minValue)?this._minValue:this.units==="time"||this.units==="frequency"||this.units==="normalRange"||this.units==="positive"||this.units==="transportTime"||this.units==="ticks"||this.units==="bpm"||this.units==="hertz"||this.units==="samples"?0:this.units==="audioRange"?-1:this.units==="decibels"?-1/0:this._param.minValue}get maxValue(){return $e(this._maxValue)?this._maxValue:this.units==="normalRange"||this.units==="audioRange"?1:this._param.maxValue}_is(e,t){return this.units===t}_assertRange(e){return $e(this.maxValue)&&$e(this.minValue)&&Uo(e,this._fromType(this.minValue),this._fromType(this.maxValue)),e}_fromType(e){return this.convert&&!this.overridden?this._is(e,"time")?this.toSeconds(e):this._is(e,"decibels")?Bp(e):this._is(e,"frequency")?this.toFrequency(e):e:this.overridden?0:e}_toType(e){return this.convert&&this.units==="decibels"?m9(e):e}setValueAtTime(e,t){let r=this.toSeconds(t),n=this._fromType(e);return ze(isFinite(n)&&isFinite(r),`Invalid argument(s) to setValueAtTime: ${JSON.stringify(e)}, ${JSON.stringify(t)}`),this._assertRange(n),this.log(this.units,"setValueAtTime",e,r),this._events.add({time:r,type:"setValueAtTime",value:n}),this._param.setValueAtTime(n,r),this}getValueAtTime(e){let t=Math.max(this.toSeconds(e),0),r=this._events.getAfter(t),n=this._events.get(t),i=this._initialValue;if(n===null)i=this._initialValue;else if(n.type==="setTargetAtTime"&&(r===null||r.type==="setValueAtTime")){let s=this._events.getBefore(n.time),a;s===null?a=this._initialValue:a=s.value,n.type==="setTargetAtTime"&&(i=this._exponentialApproach(n.time,a,n.value,n.constant,t))}else if(r===null)i=n.value;else if(r.type==="linearRampToValueAtTime"||r.type==="exponentialRampToValueAtTime"){let s=n.value;if(n.type==="setTargetAtTime"){let a=this._events.getBefore(n.time);a===null?s=this._initialValue:s=a.value}r.type==="linearRampToValueAtTime"?i=this._linearInterpolate(n.time,s,r.time,r.value,t):i=this._exponentialInterpolate(n.time,s,r.time,r.value,t)}else i=n.value;return this._toType(i)}setRampPoint(e){e=this.toSeconds(e);let t=this.getValueAtTime(e);return this.cancelAndHoldAtTime(e),this._fromType(t)===0&&(t=this._toType(this._minOutput)),this.setValueAtTime(t,e),this}linearRampToValueAtTime(e,t){let r=this._fromType(e),n=this.toSeconds(t);return ze(isFinite(r)&&isFinite(n),`Invalid argument(s) to linearRampToValueAtTime: ${JSON.stringify(e)}, ${JSON.stringify(t)}`),this._assertRange(r),this._events.add({time:n,type:"linearRampToValueAtTime",value:r}),this.log(this.units,"linearRampToValueAtTime",e,n),this._param.linearRampToValueAtTime(r,n),this}exponentialRampToValueAtTime(e,t){let r=this._fromType(e);r=en(r,0)?this._minOutput:r,this._assertRange(r);let n=this.toSeconds(t);return ze(isFinite(r)&&isFinite(n),`Invalid argument(s) to exponentialRampToValueAtTime: ${JSON.stringify(e)}, ${JSON.stringify(t)}`),this._events.add({time:n,type:"exponentialRampToValueAtTime",value:r}),this.log(this.units,"exponentialRampToValueAtTime",e,n),this._param.exponentialRampToValueAtTime(r,n),this}exponentialRampTo(e,t,r){return r=this.toSeconds(r),this.setRampPoint(r),this.exponentialRampToValueAtTime(e,r+this.toSeconds(t)),this}linearRampTo(e,t,r){return r=this.toSeconds(r),this.setRampPoint(r),this.linearRampToValueAtTime(e,r+this.toSeconds(t)),this}targetRampTo(e,t,r){return r=this.toSeconds(r),this.setRampPoint(r),this.exponentialApproachValueAtTime(e,r,t),this}exponentialApproachValueAtTime(e,t,r){t=this.toSeconds(t),r=this.toSeconds(r);let n=Math.log(r+1)/Math.log(200);return this.setTargetAtTime(e,t,n),this.cancelAndHoldAtTime(t+r*.9),this.linearRampToValueAtTime(e,t+r),this}setTargetAtTime(e,t,r){let n=this._fromType(e);ze(isFinite(r)&&r>0,"timeConstant must be a number greater than 0");let i=this.toSeconds(t);return this._assertRange(n),ze(isFinite(n)&&isFinite(i),`Invalid argument(s) to setTargetAtTime: ${JSON.stringify(e)}, ${JSON.stringify(t)}`),this._events.add({constant:r,time:i,type:"setTargetAtTime",value:n}),this.log(this.units,"setTargetAtTime",e,i,r),this._param.setTargetAtTime(n,i,r),this}setValueCurveAtTime(e,t,r,n=1){r=this.toSeconds(r),t=this.toSeconds(t);let i=this._fromType(e[0])*n;this.setValueAtTime(this._toType(i),t);let s=r/(e.length-1);for(let a=1;a<e.length;a++){let c=this._fromType(e[a])*n;this.linearRampToValueAtTime(this._toType(c),t+a*s)}return this}cancelScheduledValues(e){let t=this.toSeconds(e);return ze(isFinite(t),`Invalid argument to cancelScheduledValues: ${JSON.stringify(e)}`),this._events.cancel(t),this._param.cancelScheduledValues(t),this.log(this.units,"cancelScheduledValues",t),this}cancelAndHoldAtTime(e){let t=this.toSeconds(e),r=this._fromType(this.getValueAtTime(t));ze(isFinite(t),`Invalid argument to cancelAndHoldAtTime: ${JSON.stringify(e)}`),this.log(this.units,"cancelAndHoldAtTime",t,"value="+r);let n=this._events.get(t),i=this._events.getAfter(t);return n&&en(n.time,t)?i?(this._param.cancelScheduledValues(i.time),this._events.cancel(i.time)):(this._param.cancelAndHoldAtTime(t),this._events.cancel(t+this.sampleTime)):i&&(this._param.cancelScheduledValues(i.time),this._events.cancel(i.time),i.type==="linearRampToValueAtTime"?this.linearRampToValueAtTime(this._toType(r),t):i.type==="exponentialRampToValueAtTime"&&this.exponentialRampToValueAtTime(this._toType(r),t)),this._events.add({time:t,type:"setValueAtTime",value:r}),this._param.setValueAtTime(r,t),this}rampTo(e,t=.1,r){return this.units==="frequency"||this.units==="bpm"||this.units==="decibels"?this.exponentialRampTo(e,t,r):this.linearRampTo(e,t,r),this}apply(e){let t=this.context.currentTime;e.setValueAtTime(this.getValueAtTime(t),t);let r=this._events.get(t);if(r&&r.type==="setTargetAtTime"){let n=this._events.getAfter(r.time),i=n?n.time:t+2,s=(i-t)/10;for(let a=t;a<i;a+=s)e.linearRampToValueAtTime(this.getValueAtTime(a),a)}return this._events.forEachAfter(this.context.currentTime,n=>{n.type==="cancelScheduledValues"?e.cancelScheduledValues(n.time):n.type==="setTargetAtTime"?e.setTargetAtTime(n.value,n.time,n.constant):e[n.type](n.value,n.time)}),this}setParam(e){ze(this._swappable,"The Param must be assigned as 'swappable' in the constructor");let t=this.input;return t.disconnect(this._param),this.apply(e),this._param=e,t.connect(this._param),this}dispose(){return super.dispose(),this._events.dispose(),this}get defaultValue(){return this._toType(this._param.defaultValue)}_exponentialApproach(e,t,r,n,i){return r+(t-r)*Math.exp(-(i-e)/n)}_linearInterpolate(e,t,r,n,i){return t+(n-t)*((i-e)/(r-e))}_exponentialInterpolate(e,t,r,n,i){return t*Math.pow(n/t,(i-e)/(r-e))}};var je=class extends to{constructor(){super(...arguments);this.name="ToneAudioNode",this._internalChannels=[]}get numberOfInputs(){return $e(this.input)?qi(this.input)||this.input instanceof ft?1:this.input.numberOfInputs:0}get numberOfOutputs(){return $e(this.output)?this.output.numberOfOutputs:0}_isAudioNode(e){return $e(e)&&(e instanceof je||zs(e))}_getInternalNodes(){let e=this._internalChannels.slice(0);return this._isAudioNode(this.input)&&e.push(this.input),this._isAudioNode(this.output)&&this.input!==this.output&&e.push(this.output),e}_setChannelProperties(e){this._getInternalNodes().forEach(r=>{r.channelCount=e.channelCount,r.channelCountMode=e.channelCountMode,r.channelInterpretation=e.channelInterpretation})}_getChannelProperties(){let e=this._getInternalNodes();ze(e.length>0,"ToneAudioNode does not have any internal nodes");let t=e[0];return{channelCount:t.channelCount,channelCountMode:t.channelCountMode,channelInterpretation:t.channelInterpretation}}get channelCount(){return this._getChannelProperties().channelCount}set channelCount(e){let t=this._getChannelProperties();this._setChannelProperties(Object.assign(t,{channelCount:e}))}get channelCountMode(){return this._getChannelProperties().channelCountMode}set channelCountMode(e){let t=this._getChannelProperties();this._setChannelProperties(Object.assign(t,{channelCountMode:e}))}get channelInterpretation(){return this._getChannelProperties().channelInterpretation}set channelInterpretation(e){let t=this._getChannelProperties();this._setChannelProperties(Object.assign(t,{channelInterpretation:e}))}connect(e,t=0,r=0){return gi(this,e,t,r),this}toDestination(){return this.connect(this.context.destination),this}toMaster(){return _f("toMaster() has been renamed toDestination()"),this.toDestination()}disconnect(e,t=0,r=0){return Kte(this,e,t,r),this}chain(...e){return A9(this,...e),this}fan(...e){return e.forEach(t=>this.connect(t)),this}dispose(){return super.dispose(),$e(this.input)&&(this.input instanceof je?this.input.dispose():zs(this.input)&&this.input.disconnect()),$e(this.output)&&(this.output instanceof je?this.output.dispose():zs(this.output)&&this.output.disconnect()),this._internalChannels=[],this}};function A9(...o){let e=o.shift();o.reduce((t,r)=>(t instanceof je?t.connect(r):zs(t)&&gi(t,r),r),e)}function gi(o,e,t=0,r=0){for(ze($e(o),"Cannot connect from undefined node"),ze($e(e),"Cannot connect to undefined node"),(e instanceof je||zs(e))&&ze(e.numberOfInputs>0,"Cannot connect to node with no inputs"),ze(o.numberOfOutputs>0,"Cannot connect from node with no outputs");e instanceof je||e instanceof ft;)$e(e.input)&&(e=e.input);for(;o instanceof je;)$e(o.output)&&(o=o.output);qi(e)?o.connect(e,t):o.connect(e,t,r)}function Kte(o,e,t=0,r=0){if($e(e))for(;e instanceof je;)e=e.input;for(;!zs(o);)$e(o.output)&&(o=o.output);qi(e)?o.disconnect(e,t):zs(e)?o.disconnect(e,t,r):o.disconnect()}var Qt=class extends je{constructor(){super(pe(Qt.getDefaults(),arguments,["gain","units"]));this.name="Gain",this._gainNode=this.context.createGain(),this.input=this._gainNode,this.output=this._gainNode;let e=pe(Qt.getDefaults(),arguments,["gain","units"]);this.gain=new ft({context:this.context,convert:e.convert,param:this._gainNode.gain,units:e.units,value:e.gain,minValue:e.minValue,maxValue:e.maxValue}),_t(this,"gain")}static getDefaults(){return Object.assign(je.getDefaults(),{convert:!0,gain:1,units:"gain"})}dispose(){return super.dispose(),this._gainNode.disconnect(),this.gain.dispose(),this}};var js=class extends je{constructor(e){super(e);this.onended=gt,this._startTime=-1,this._stopTime=-1,this._timeout=-1,this.output=new Qt({context:this.context,gain:0}),this._gainNode=this.output,this.getStateAtTime=function(t){let r=this.toSeconds(t);return this._startTime!==-1&&r>=this._startTime&&(this._stopTime===-1||r<=this._stopTime)?"started":"stopped"},this._fadeIn=e.fadeIn,this._fadeOut=e.fadeOut,this._curve=e.curve,this.onended=e.onended}static getDefaults(){return Object.assign(je.getDefaults(),{curve:"linear",fadeIn:0,fadeOut:0,onended:gt})}_startGain(e,t=1){ze(this._startTime===-1,"Source cannot be started more than once");let r=this.toSeconds(this._fadeIn);return this._startTime=e+r,this._startTime=Math.max(this._startTime,this.context.currentTime),r>0?(this._gainNode.gain.setValueAtTime(0,e),this._curve==="linear"?this._gainNode.gain.linearRampToValueAtTime(t,e+r):this._gainNode.gain.exponentialApproachValueAtTime(t,e,r)):this._gainNode.gain.setValueAtTime(t,e),this}stop(e){return this.log("stop",e),this._stopGain(this.toSeconds(e)),this}_stopGain(e){ze(this._startTime!==-1,"'start' must be called before 'stop'"),this.cancelStop();let t=this.toSeconds(this._fadeOut);return this._stopTime=this.toSeconds(e)+t,this._stopTime=Math.max(this._stopTime,this.context.currentTime),t>0?this._curve==="linear"?this._gainNode.gain.linearRampTo(0,t,e):this._gainNode.gain.targetRampTo(0,t,e):(this._gainNode.gain.cancelAndHoldAtTime(e),this._gainNode.gain.setValueAtTime(0,e)),this.context.clearTimeout(this._timeout),this._timeout=this.context.setTimeout(()=>{let r=this._curve==="exponential"?t*2:0;this._stopSource(this.now()+r),this._onended()},this._stopTime-this.context.currentTime),this}_onended(){if(this.onended!==gt&&(this.onended(this),this.onended=gt,!this.context.isOffline)){let e=()=>this.dispose();typeof window.requestIdleCallback<"u"?window.requestIdleCallback(e):setTimeout(e,1e3)}}get state(){return this.getStateAtTime(this.now())}cancelStop(){return this.log("cancelStop"),ze(this._startTime!==-1,"Source is not started"),this._gainNode.gain.cancelScheduledValues(this._startTime+this.sampleTime),this.context.clearTimeout(this._timeout),this._stopTime=-1,this}dispose(){return super.dispose(),this._gainNode.disconnect(),this}};var Hp=class extends js{constructor(){super(pe(Hp.getDefaults(),arguments,["offset"]));this.name="ToneConstantSource",this._source=this.context.createConstantSource();let e=pe(Hp.getDefaults(),arguments,["offset"]);gi(this._source,this._gainNode),this.offset=new ft({context:this.context,convert:e.convert,param:this._source.offset,units:e.units,value:e.offset,minValue:e.minValue,maxValue:e.maxValue})}static getDefaults(){return Object.assign(js.getDefaults(),{convert:!0,offset:1,units:"number"})}start(e){let t=this.toSeconds(e);return this.log("start",t),this._startGain(t),this._source.start(t),this}_stopSource(e){this._source.stop(e)}dispose(){return super.dispose(),this.state==="started"&&this.stop(),this._source.disconnect(),this.offset.dispose(),this}};var kt=class extends je{constructor(){super(pe(kt.getDefaults(),arguments,["value","units"]));this.name="Signal",this.override=!0;let e=pe(kt.getDefaults(),arguments,["value","units"]);this.output=this._constantSource=new Hp({context:this.context,convert:e.convert,offset:e.value,units:e.units,minValue:e.minValue,maxValue:e.maxValue}),this._constantSource.start(0),this.input=this._param=this._constantSource.offset}static getDefaults(){return Object.assign(je.getDefaults(),{convert:!0,units:"number",value:0})}connect(e,t=0,r=0){return xf(this,e,t,r),this}dispose(){return super.dispose(),this._param.dispose(),this._constantSource.dispose(),this}setValueAtTime(e,t){return this._param.setValueAtTime(e,t),this}getValueAtTime(e){return this._param.getValueAtTime(e)}setRampPoint(e){return this._param.setRampPoint(e),this}linearRampToValueAtTime(e,t){return this._param.linearRampToValueAtTime(e,t),this}exponentialRampToValueAtTime(e,t){return this._param.exponentialRampToValueAtTime(e,t),this}exponentialRampTo(e,t,r){return this._param.exponentialRampTo(e,t,r),this}linearRampTo(e,t,r){return this._param.linearRampTo(e,t,r),this}targetRampTo(e,t,r){return this._param.targetRampTo(e,t,r),this}exponentialApproachValueAtTime(e,t,r){return this._param.exponentialApproachValueAtTime(e,t,r),this}setTargetAtTime(e,t,r){return this._param.setTargetAtTime(e,t,r),this}setValueCurveAtTime(e,t,r,n){return this._param.setValueCurveAtTime(e,t,r,n),this}cancelScheduledValues(e){return this._param.cancelScheduledValues(e),this}cancelAndHoldAtTime(e){return this._param.cancelAndHoldAtTime(e),this}rampTo(e,t,r){return this._param.rampTo(e,t,r),this}get value(){return this._param.value}set value(e){this._param.value=e}get convert(){return this._param.convert}set convert(e){this._param.convert=e}get units(){return this._param.units}get overridden(){return this._param.overridden}set overridden(e){this._param.overridden=e}get maxValue(){return this._param.maxValue}get minValue(){return this._param.minValue}apply(e){return this._param.apply(e),this}};function xf(o,e,t,r){(e instanceof ft||qi(e)||e instanceof kt&&e.override)&&(e.cancelScheduledValues(0),e.setValueAtTime(0,0),e instanceof kt&&(e.overridden=!0)),gi(o,e,t,r)}var Qc=class extends je{constructor(){super(Object.assign(pe(Qc.getDefaults(),arguments,["context"])))}connect(e,t=0,r=0){return xf(this,e,t,r),this}};var Ra=class extends Qc{constructor(){super(Object.assign(pe(Ra.getDefaults(),arguments,["mapping","length"])));this.name="WaveShaper",this._shaper=this.context.createWaveShaper(),this.input=this._shaper,this.output=this._shaper;let e=pe(Ra.getDefaults(),arguments,["mapping","length"]);fo(e.mapping)||e.mapping instanceof Float32Array?this.curve=Float32Array.from(e.mapping):SD(e.mapping)&&this.setMap(e.mapping,e.length)}static getDefaults(){return Object.assign(kt.getDefaults(),{length:1024})}setMap(e,t=1024){let r=new Float32Array(t);for(let n=0,i=t;n<i;n++){let s=n/(i-1)*2-1;r[n]=e(s,n)}return this.curve=r,this}get curve(){return this._shaper.curve}set curve(e){this._shaper.curve=e}get oversample(){return this._shaper.oversample}set oversample(e){let t=["none","2x","4x"].some(r=>r.includes(e));ze(t,"oversampling must be either 'none', '2x', or '4x'"),this._shaper.oversample=e}dispose(){return super.dispose(),this._shaper.disconnect(),this}};var bf=class extends Qc{constructor(){super(...arguments);this.name="AudioToGain",this._norm=new Ra({context:this.context,mapping:e=>(e+1)/2}),this.input=this._norm,this.output=this._norm}dispose(){return super.dispose(),this._norm.dispose(),this}};var qn=class extends kt{constructor(){super(Object.assign(pe(qn.getDefaults(),arguments,["value"])));this.name="Multiply",this.override=!1;let e=pe(qn.getDefaults(),arguments,["value"]);this._mult=this.input=this.output=new Qt({context:this.context,minValue:e.minValue,maxValue:e.maxValue}),this.factor=this._param=this._mult.gain,this.factor.setValueAtTime(e.value,0)}static getDefaults(){return Object.assign(kt.getDefaults(),{value:0})}dispose(){return super.dispose(),this._mult.dispose(),this}};function fk(o,e=1/0){let t=new WeakMap;return function(r,n){Reflect.defineProperty(r,n,{configurable:!0,enumerable:!0,get:function(){return t.get(this)},set:function(i){Uo(i,o,e),t.set(this,i)}})}}function vi(o,e=1/0){let t=new WeakMap;return function(r,n){Reflect.defineProperty(r,n,{configurable:!0,enumerable:!0,get:function(){return t.get(this)},set:function(i){Uo(this.toSeconds(i),o,e),t.set(this,i)}})}}var rn=class extends je{constructor(){super(pe(rn.getDefaults(),arguments,["attack","decay","sustain","release"]));this.name="Envelope",this._sig=new kt({context:this.context,value:0}),this.output=this._sig,this.input=void 0;let e=pe(rn.getDefaults(),arguments,["attack","decay","sustain","release"]);this.attack=e.attack,this.decay=e.decay,this.sustain=e.sustain,this.release=e.release,this.attackCurve=e.attackCurve,this.releaseCurve=e.releaseCurve,this.decayCurve=e.decayCurve}static getDefaults(){return Object.assign(je.getDefaults(),{attack:.01,attackCurve:"linear",decay:.1,decayCurve:"exponential",release:1,releaseCurve:"exponential",sustain:.5})}get value(){return this.getValueAtTime(this.now())}_getCurve(e,t){if(Eo(e))return e;{let r;for(r in C9)if(C9[r][t]===e)return r;return e}}_setCurve(e,t,r){if(Eo(r)&&Reflect.has(C9,r)){let n=C9[r];Hs(n)?e!=="_decayCurve"&&(this[e]=n[t]):this[e]=n}else if(fo(r)&&e!=="_decayCurve")this[e]=r;else throw new Error("Envelope: invalid curve: "+r)}get attackCurve(){return this._getCurve(this._attackCurve,"In")}set attackCurve(e){this._setCurve("_attackCurve","In",e)}get releaseCurve(){return this._getCurve(this._releaseCurve,"Out")}set releaseCurve(e){this._setCurve("_releaseCurve","Out",e)}get decayCurve(){return this._decayCurve}set decayCurve(e){ze(["linear","exponential"].some(t=>t===e),`Invalid envelope curve: ${e}`),this._decayCurve=e}triggerAttack(e,t=1){this.log("triggerAttack",e,t),e=this.toSeconds(e);let n=this.toSeconds(this.attack),i=this.toSeconds(this.decay),s=this.getValueAtTime(e);if(s>0){let a=1/n;n=(1-s)/a}if(n<this.sampleTime)this._sig.cancelScheduledValues(e),this._sig.setValueAtTime(t,e);else if(this._attackCurve==="linear")this._sig.linearRampTo(t,n,e);else if(this._attackCurve==="exponential")this._sig.targetRampTo(t,n,e);else{this._sig.cancelAndHoldAtTime(e);let a=this._attackCurve;for(let c=1;c<a.length;c++)if(a[c-1]<=s&&s<=a[c]){a=this._attackCurve.slice(c),a[0]=s;break}this._sig.setValueCurveAtTime(a,e,n,t)}if(i&&this.sustain<1){let a=t*this.sustain,c=e+n;this.log("decay",c),this._decayCurve==="linear"?this._sig.linearRampToValueAtTime(a,i+c):this._sig.exponentialApproachValueAtTime(a,c,i)}return this}triggerRelease(e){this.log("triggerRelease",e),e=this.toSeconds(e);let t=this.getValueAtTime(e);if(t>0){let r=this.toSeconds(this.release);r<this.sampleTime?this._sig.setValueAtTime(0,e):this._releaseCurve==="linear"?this._sig.linearRampTo(0,r,e):this._releaseCurve==="exponential"?this._sig.targetRampTo(0,r,e):(ze(fo(this._releaseCurve),"releaseCurve must be either 'linear', 'exponential' or an array"),this._sig.cancelAndHoldAtTime(e),this._sig.setValueCurveAtTime(this._releaseCurve,e,r,t))}return this}getValueAtTime(e){return this._sig.getValueAtTime(e)}triggerAttackRelease(e,t,r=1){return t=this.toSeconds(t),this.triggerAttack(t,r),this.triggerRelease(t+this.toSeconds(e)),this}cancel(e){return this._sig.cancelScheduledValues(this.toSeconds(e)),this}connect(e,t=0,r=0){return xf(this,e,t,r),this}asArray(e=1024){return xt(this,void 0,void 0,function*(){let t=e/this.context.sampleRate,r=new Zc(1,t,this.context.sampleRate),n=this.toSeconds(this.attack)+this.toSeconds(this.decay),i=n+this.toSeconds(this.release),s=i*.1,a=i+s,c=new this.constructor(Object.assign(this.get(),{attack:t*this.toSeconds(this.attack)/a,decay:t*this.toSeconds(this.decay)/a,release:t*this.toSeconds(this.release)/a,context:r}));return c._sig.toDestination(),c.triggerAttackRelease(t*(n+s)/a,0),(yield r.render()).getChannelData(0)})}dispose(){return super.dispose(),this._sig.dispose(),this}};Wn([vi(0)],rn.prototype,"attack",void 0);Wn([vi(0)],rn.prototype,"decay",void 0);Wn([fk(0,1)],rn.prototype,"sustain",void 0);Wn([vi(0)],rn.prototype,"release",void 0);var C9=(()=>{let e,t,r=[];for(e=0;e<128;e++)r[e]=Math.sin(e/(128-1)*(Math.PI/2));let n=[],i=6.4;for(e=0;e<128-1;e++){t=e/(128-1);let d=Math.sin(t*(Math.PI*2)*i-Math.PI/2)+1;n[e]=d/10+t*.83}n[128-1]=1;let s=[],a=5;for(e=0;e<128;e++)s[e]=Math.ceil(e/(128-1)*a)/a;let c=[];for(e=0;e<128;e++)t=e/(128-1),c[e]=.5*(1-Math.cos(Math.PI*t));let l=[];for(e=0;e<128;e++){t=e/(128-1);let d=Math.pow(t,3)*4+.2,h=Math.cos(d*Math.PI*2*t);l[e]=Math.abs(h*(1-t))}function u(d){let h=new Array(d.length);for(let m=0;m<d.length;m++)h[m]=1-d[m];return h}function p(d){return d.slice(0).reverse()}return{bounce:{In:u(l),Out:l},cosine:{In:r,Out:p(r)},exponential:"exponential",linear:"linear",ripple:{In:n,Out:u(n)},sine:{In:c,Out:u(c)},step:{In:s,Out:u(s)}}})();var Cn=class extends je{constructor(){super(pe(Cn.getDefaults(),arguments,["volume"]));this.name="Volume";let e=pe(Cn.getDefaults(),arguments,["volume"]);this.input=this.output=new Qt({context:this.context,gain:e.volume,units:"decibels"}),this.volume=this.output.gain,_t(this,"volume"),this._unmutedVolume=e.volume,this.mute=e.mute}static getDefaults(){return Object.assign(je.getDefaults(),{mute:!1,volume:0})}get mute(){return this.volume.value===-1/0}set mute(e){!this.mute&&e?(this._unmutedVolume=this.volume.value,this.volume.value=-1/0):this.mute&&!e&&(this.volume.value=this._unmutedVolume)}dispose(){return super.dispose(),this.input.dispose(),this.volume.dispose(),this}};var Ws=class extends je{constructor(){super(pe(Ws.getDefaults(),arguments));this._scheduledEvents=[],this._synced=!1,this._original_triggerAttack=this.triggerAttack,this._original_triggerRelease=this.triggerRelease;let e=pe(Ws.getDefaults(),arguments);this._volume=this.output=new Cn({context:this.context,volume:e.volume}),this.volume=this._volume.volume,_t(this,"volume")}static getDefaults(){return Object.assign(je.getDefaults(),{volume:0})}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",0)),this}_syncState(){let e=!1;return this._synced||(this._synced=!0,e=!0),e}_syncMethod(e,t){let r=this["_original_"+e]=this[e];this[e]=(...n)=>{let i=n[t],s=this.context.transport.schedule(a=>{n[t]=a,r.apply(this,n)},i);this._scheduledEvents.push(s)}}unsync(){return this._scheduledEvents.forEach(e=>this.context.transport.clear(e)),this._scheduledEvents=[],this._synced&&(this._synced=!1,this.triggerAttack=this._original_triggerAttack,this.triggerRelease=this._original_triggerRelease),this}triggerAttackRelease(e,t,r,n){let i=this.toSeconds(r),s=this.toSeconds(t);return this.triggerAttack(e,i,n),this.triggerRelease(i+s),this}dispose(){return super.dispose(),this._volume.dispose(),this.unsync(),this._scheduledEvents=[],this}};var Yi=class extends Ws{constructor(){super(pe(Yi.getDefaults(),arguments));let e=pe(Yi.getDefaults(),arguments);this.portamento=e.portamento,this.onsilence=e.onsilence}static getDefaults(){return Object.assign(Ws.getDefaults(),{detune:0,onsilence:gt,portamento:0})}triggerAttack(e,t,r=1){this.log("triggerAttack",e,t,r);let n=this.toSeconds(t);return this._triggerEnvelopeAttack(n,r),this.setNote(e,n),this}triggerRelease(e){this.log("triggerRelease",e);let t=this.toSeconds(e);return this._triggerEnvelopeRelease(t),this}setNote(e,t){let r=this.toSeconds(t),n=e instanceof tn?e.toFrequency():e;if(this.portamento>0&&this.getLevelAtTime(r)>.05){let i=this.toSeconds(this.portamento);this.frequency.exponentialRampTo(n,i,r)}else this.frequency.setValueAtTime(n,r);return this}};Wn([vi(0)],Yi.prototype,"portamento",void 0);var Tf=class extends je{constructor(){super(pe(Tf.getDefaults(),arguments));this.name="Destination",this.input=new Cn({context:this.context}),this.output=new Qt({context:this.context}),this.volume=this.input.volume;let e=pe(Tf.getDefaults(),arguments);A9(this.input,this.output,this.context.rawContext.destination),this.mute=e.mute,this._internalChannels=[this.input,this.context.rawContext.destination,this.output]}static getDefaults(){return Object.assign(je.getDefaults(),{mute:!1,volume:0})}get mute(){return this.input.mute}set mute(e){this.input.mute=e}chain(...e){return this.input.disconnect(),e.unshift(this.input),e.push(this.output),A9(...e),this}get maxChannelCount(){return this.context.rawContext.destination.maxChannelCount}dispose(){return super.dispose(),this.volume.dispose(),this}};Vp(o=>{o.destination=new Tf({context:o})});Gp(o=>{o.destination.dispose()});var ng=class extends mo{constructor(e){super();this.name="TimelineValue",this._timeline=new So({memory:10}),this._initialValue=e}set(e,t){return this._timeline.add({value:e,time:t}),this}get(e){let t=this._timeline.get(e);return t?t.value:this._initialValue}};var yi=class extends w0{constructor(){super(...arguments);this.name="Ticks",this.defaultUnits="i"}_now(){return this.context.transport.ticks}_beatsToUnits(e){return this._getPPQ()*e}_secondsToUnits(e){return Math.floor(e/(60/this._getBpm())*this._getPPQ())}_ticksToUnits(e){return e}toTicks(){return this.valueOf()}toSeconds(){return this.valueOf()/this._getPPQ()*(60/this._getBpm())}};var ig=class extends mo{constructor(){super(...arguments);this.name="IntervalTimeline",this._root=null,this._length=0}add(e){ze($e(e.time),"Events must have a time property"),ze($e(e.duration),"Events must have a duration parameter"),e.time=e.time.valueOf();let t=new mk(e.time,e.time+e.duration,e);for(this._root===null?this._root=t:this._root.insert(t),this._length++;t!==null;)t.updateHeight(),t.updateMax(),this._rebalance(t),t=t.parent;return this}remove(e){if(this._root!==null){let t=[];this._root.search(e.time,t);for(let r of t)if(r.event===e){this._removeNode(r),this._length--;break}}return this}get length(){return this._length}cancel(e){return this.forEachFrom(e,t=>this.remove(t)),this}_setRoot(e){this._root=e,this._root!==null&&(this._root.parent=null)}_replaceNodeInParent(e,t){e.parent!==null?(e.isLeftChild()?e.parent.left=t:e.parent.right=t,this._rebalance(e.parent)):this._setRoot(t)}_removeNode(e){if(e.left===null&&e.right===null)this._replaceNodeInParent(e,null);else if(e.right===null)this._replaceNodeInParent(e,e.left);else if(e.left===null)this._replaceNodeInParent(e,e.right);else{let t=e.getBalance(),r,n=null;if(t>0)if(e.left.right===null)r=e.left,r.right=e.right,n=r;else{for(r=e.left.right;r.right!==null;)r=r.right;r.parent&&(r.parent.right=r.left,n=r.parent,r.left=e.left,r.right=e.right)}else if(e.right.left===null)r=e.right,r.left=e.left,n=r;else{for(r=e.right.left;r.left!==null;)r=r.left;r.parent&&(r.parent.left=r.right,n=r.parent,r.left=e.left,r.right=e.right)}e.parent!==null?e.isLeftChild()?e.parent.left=r:e.parent.right=r:this._setRoot(r),n&&this._rebalance(n)}e.dispose()}_rotateLeft(e){let t=e.parent,r=e.isLeftChild(),n=e.right;n&&(e.right=n.left,n.left=e),t!==null?r?t.left=n:t.right=n:this._setRoot(n)}_rotateRight(e){let t=e.parent,r=e.isLeftChild(),n=e.left;n&&(e.left=n.right,n.right=e),t!==null?r?t.left=n:t.right=n:this._setRoot(n)}_rebalance(e){let t=e.getBalance();t>1&&e.left?e.left.getBalance()<0?this._rotateLeft(e.left):this._rotateRight(e):t<-1&&e.right&&(e.right.getBalance()>0?this._rotateRight(e.right):this._rotateLeft(e))}get(e){if(this._root!==null){let t=[];if(this._root.search(e,t),t.length>0){let r=t[0];for(let n=1;n<t.length;n++)t[n].low>r.low&&(r=t[n]);return r.event}}return null}forEach(e){if(this._root!==null){let t=[];this._root.traverse(r=>t.push(r)),t.forEach(r=>{r.event&&e(r.event)})}return this}forEachAtTime(e,t){if(this._root!==null){let r=[];this._root.search(e,r),r.forEach(n=>{n.event&&t(n.event)})}return this}forEachFrom(e,t){if(this._root!==null){let r=[];this._root.searchAfter(e,r),r.forEach(n=>{n.event&&t(n.event)})}return this}dispose(){return super.dispose(),this._root!==null&&this._root.traverse(e=>e.dispose()),this._root=null,this}},mk=class{constructor(e,t,r){this._left=null,this._right=null,this.parent=null,this.height=0,this.event=r,this.low=e,this.high=t,this.max=this.high}insert(e){e.low<=this.low?this.left===null?this.left=e:this.left.insert(e):this.right===null?this.right=e:this.right.insert(e)}search(e,t){e>this.max||(this.left!==null&&this.left.search(e,t),this.low<=e&&this.high>e&&t.push(this),!(this.low>e)&&this.right!==null&&this.right.search(e,t))}searchAfter(e,t){this.low>=e&&(t.push(this),this.left!==null&&this.left.searchAfter(e,t)),this.right!==null&&this.right.searchAfter(e,t)}traverse(e){e(this),this.left!==null&&this.left.traverse(e),this.right!==null&&this.right.traverse(e)}updateHeight(){this.left!==null&&this.right!==null?this.height=Math.max(this.left.height,this.right.height)+1:this.right!==null?this.height=this.right.height+1:this.left!==null?this.height=this.left.height+1:this.height=0}updateMax(){this.max=this.high,this.left!==null&&(this.max=Math.max(this.max,this.left.max)),this.right!==null&&(this.max=Math.max(this.max,this.right.max))}getBalance(){let e=0;return this.left!==null&&this.right!==null?e=this.left.height-this.right.height:this.left!==null?e=this.left.height+1:this.right!==null&&(e=-(this.right.height+1)),e}isLeftChild(){return this.parent!==null&&this.parent.left===this}get left(){return this._left}set left(e){this._left=e,e!==null&&(e.parent=this),this.updateHeight(),this.updateMax()}get right(){return this._right}set right(e){this._right=e,e!==null&&(e.parent=this),this.updateHeight(),this.updateMax()}dispose(){this.parent=null,this._left=null,this._right=null,this.event=null}};var el=class extends So{constructor(e="stopped"){super();this.name="StateTimeline",this._initial=e,this.setStateAtTime(this._initial,0)}getValueAtTime(e){let t=this.get(e);return t!==null?t.state:this._initial}setStateAtTime(e,t,r){return Uo(t,0),this.add(Object.assign({},r,{state:e,time:t})),this}getLastState(e,t){let r=this._search(t);for(let n=r;n>=0;n--){let i=this._timeline[n];if(i.state===e)return i}}getNextState(e,t){let r=this._search(t);if(r!==-1)for(let n=r;n<this._timeline.length;n++){let i=this._timeline[n];if(i.state===e)return i}}};var jp=class extends ft{constructor(){super(pe(jp.getDefaults(),arguments,["value"]));this.name="TickParam",this._events=new So(1/0),this._multiplier=1;let e=pe(jp.getDefaults(),arguments,["value"]);this._multiplier=e.multiplier,this._events.cancel(0),this._events.add({ticks:0,time:0,type:"setValueAtTime",value:this._fromType(e.value)}),this.setValueAtTime(e.value,0)}static getDefaults(){return Object.assign(ft.getDefaults(),{multiplier:1,units:"hertz",value:1})}setTargetAtTime(e,t,r){t=this.toSeconds(t),this.setRampPoint(t);let n=this._fromType(e),i=this._events.get(t),s=Math.round(Math.max(1/r,1));for(let a=0;a<=s;a++){let c=r*a+t,l=this._exponentialApproach(i.time,i.value,n,r,c);this.linearRampToValueAtTime(this._toType(l),c)}return this}setValueAtTime(e,t){let r=this.toSeconds(t);super.setValueAtTime(e,t);let n=this._events.get(r),i=this._events.previousEvent(n),s=this._getTicksUntilEvent(i,r);return n.ticks=Math.max(s,0),this}linearRampToValueAtTime(e,t){let r=this.toSeconds(t);super.linearRampToValueAtTime(e,t);let n=this._events.get(r),i=this._events.previousEvent(n),s=this._getTicksUntilEvent(i,r);return n.ticks=Math.max(s,0),this}exponentialRampToValueAtTime(e,t){t=this.toSeconds(t);let r=this._fromType(e),n=this._events.get(t),i=Math.round(Math.max((t-n.time)*10,1)),s=(t-n.time)/i;for(let a=0;a<=i;a++){let c=s*a+n.time,l=this._exponentialInterpolate(n.time,n.value,t,r,c);this.linearRampToValueAtTime(this._toType(l),c)}return this}_getTicksUntilEvent(e,t){if(e===null)e={ticks:0,time:0,type:"setValueAtTime",value:0};else if(eo(e.ticks)){let s=this._events.previousEvent(e);e.ticks=this._getTicksUntilEvent(s,e.time)}let r=this._fromType(this.getValueAtTime(e.time)),n=this._fromType(this.getValueAtTime(t)),i=this._events.get(t);return i&&i.time===t&&i.type==="setValueAtTime"&&(n=this._fromType(this.getValueAtTime(t-this.sampleTime))),.5*(t-e.time)*(r+n)+e.ticks}getTicksAtTime(e){let t=this.toSeconds(e),r=this._events.get(t);return Math.max(this._getTicksUntilEvent(r,t),0)}getDurationOfTicks(e,t){let r=this.toSeconds(t),n=this.getTicksAtTime(t);return this.getTimeOfTick(n+e)-r}getTimeOfTick(e){let t=this._events.get(e,"ticks"),r=this._events.getAfter(e,"ticks");if(t&&t.ticks===e)return t.time;if(t&&r&&r.type==="linearRampToValueAtTime"&&t.value!==r.value){let n=this._fromType(this.getValueAtTime(t.time)),s=(this._fromType(this.getValueAtTime(r.time))-n)/(r.time-t.time),a=Math.sqrt(Math.pow(n,2)-2*s*(t.ticks-e)),c=(-n+a)/s,l=(-n-a)/s;return(c>0?c:l)+t.time}else return t?t.value===0?1/0:t.time+(e-t.ticks)/t.value:e/this._initialValue}ticksToTime(e,t){return this.getDurationOfTicks(e,t)}timeToTicks(e,t){let r=this.toSeconds(t),n=this.toSeconds(e),i=this.getTicksAtTime(r);return this.getTicksAtTime(r+n)-i}_fromType(e){return this.units==="bpm"&&this.multiplier?1/(60/e/this.multiplier):super._fromType(e)}_toType(e){return this.units==="bpm"&&this.multiplier?e/this.multiplier*60:super._toType(e)}get multiplier(){return this._multiplier}set multiplier(e){let t=this.value;this._multiplier=e,this.cancelScheduledValues(0),this.setValueAtTime(t,0)}};var Wp=class extends kt{constructor(){super(pe(Wp.getDefaults(),arguments,["value"]));this.name="TickSignal";let e=pe(Wp.getDefaults(),arguments,["value"]);this.input=this._param=new jp({context:this.context,convert:e.convert,multiplier:e.multiplier,param:this._constantSource.offset,units:e.units,value:e.value})}static getDefaults(){return Object.assign(kt.getDefaults(),{multiplier:1,units:"hertz",value:1})}ticksToTime(e,t){return this._param.ticksToTime(e,t)}timeToTicks(e,t){return this._param.timeToTicks(e,t)}getTimeOfTick(e){return this._param.getTimeOfTick(e)}getDurationOfTicks(e,t){return this._param.getDurationOfTicks(e,t)}getTicksAtTime(e){return this._param.getTicksAtTime(e)}get multiplier(){return this._param.multiplier}set multiplier(e){this._param.multiplier=e}dispose(){return super.dispose(),this._param.dispose(),this}};var qp=class extends to{constructor(){super(pe(qp.getDefaults(),arguments,["frequency"]));this.name="TickSource",this._state=new el,this._tickOffset=new So;let e=pe(qp.getDefaults(),arguments,["frequency"]);this.frequency=new Wp({context:this.context,units:e.units,value:e.frequency}),_t(this,"frequency"),this._state.setStateAtTime("stopped",0),this.setTicksAtTime(0,0)}static getDefaults(){return Object.assign({frequency:1,units:"hertz"},to.getDefaults())}get state(){return this.getStateAtTime(this.now())}start(e,t){let r=this.toSeconds(e);return this._state.getValueAtTime(r)!=="started"&&(this._state.setStateAtTime("started",r),$e(t)&&this.setTicksAtTime(t,r)),this}stop(e){let t=this.toSeconds(e);if(this._state.getValueAtTime(t)==="stopped"){let r=this._state.get(t);r&&r.time>0&&(this._tickOffset.cancel(r.time),this._state.cancel(r.time))}return this._state.cancel(t),this._state.setStateAtTime("stopped",t),this.setTicksAtTime(0,t),this}pause(e){let t=this.toSeconds(e);return this._state.getValueAtTime(t)==="started"&&this._state.setStateAtTime("paused",t),this}cancel(e){return e=this.toSeconds(e),this._state.cancel(e),this._tickOffset.cancel(e),this}getTicksAtTime(e){let t=this.toSeconds(e),r=this._state.getLastState("stopped",t),n={state:"paused",time:t};this._state.add(n);let i=r,s=0;return this._state.forEachBetween(r.time,t+this.sampleTime,a=>{let c=i.time,l=this._tickOffset.get(a.time);l&&l.time>=i.time&&(s=l.ticks,c=l.time),i.state==="started"&&a.state!=="started"&&(s+=this.frequency.getTicksAtTime(a.time)-this.frequency.getTicksAtTime(c)),i=a}),this._state.remove(n),s}get ticks(){return this.getTicksAtTime(this.now())}set ticks(e){this.setTicksAtTime(e,this.now())}get seconds(){return this.getSecondsAtTime(this.now())}set seconds(e){let t=this.now(),r=this.frequency.timeToTicks(e,t);this.setTicksAtTime(r,t)}getSecondsAtTime(e){e=this.toSeconds(e);let t=this._state.getLastState("stopped",e),r={state:"paused",time:e};this._state.add(r);let n=t,i=0;return this._state.forEachBetween(t.time,e+this.sampleTime,s=>{let a=n.time,c=this._tickOffset.get(s.time);c&&c.time>=n.time&&(i=c.seconds,a=c.time),n.state==="started"&&s.state!=="started"&&(i+=s.time-a),n=s}),this._state.remove(r),i}setTicksAtTime(e,t){return t=this.toSeconds(t),this._tickOffset.cancel(t),this._tickOffset.add({seconds:this.frequency.getDurationOfTicks(e,t),ticks:e,time:t}),this}getStateAtTime(e){return e=this.toSeconds(e),this._state.getValueAtTime(e)}getTimeOfTick(e,t=this.now()){let r=this._tickOffset.get(t),n=this._state.get(t),i=Math.max(r.time,n.time),s=this.frequency.getTicksAtTime(i)+e-r.ticks;return this.frequency.getTimeOfTick(s)}forEachTickBetween(e,t,r){let n=this._state.get(e);this._state.forEachBetween(e,t,s=>{n&&n.state==="started"&&s.state!=="started"&&this.forEachTickBetween(Math.max(n.time,e),s.time-this.sampleTime,r),n=s});let i=null;if(n&&n.state==="started"){let s=Math.max(n.time,e),a=this.frequency.getTicksAtTime(s),c=this.frequency.getTicksAtTime(n.time),l=a-c,u=Math.ceil(l)-l;u=en(u,1)?0:u;let p=this.frequency.getTimeOfTick(a+u);for(;p<t;){try{r(p,Math.round(this.getTicksAtTime(p)))}catch(d){i=d;break}p+=this.frequency.getDurationOfTicks(1,p)}}if(i)throw i;return this}dispose(){return super.dispose(),this._state.dispose(),this._tickOffset.dispose(),this.frequency.dispose(),this}};var tl=class extends to{constructor(){super(pe(tl.getDefaults(),arguments,["callback","frequency"]));this.name="Clock",this.callback=gt,this._lastUpdate=0,this._state=new el("stopped"),this._boundLoop=this._loop.bind(this);let e=pe(tl.getDefaults(),arguments,["callback","frequency"]);this.callback=e.callback,this._tickSource=new qp({context:this.context,frequency:e.frequency,units:e.units}),this._lastUpdate=0,this.frequency=this._tickSource.frequency,_t(this,"frequency"),this._state.setStateAtTime("stopped",0),this.context.on("tick",this._boundLoop)}static getDefaults(){return Object.assign(to.getDefaults(),{callback:gt,frequency:1,units:"hertz"})}get state(){return this._state.getValueAtTime(this.now())}start(e,t){v9(this.context);let r=this.toSeconds(e);return this.log("start",r),this._state.getValueAtTime(r)!=="started"&&(this._state.setStateAtTime("started",r),this._tickSource.start(r,t),r<this._lastUpdate&&this.emit("start",r,t)),this}stop(e){let t=this.toSeconds(e);return this.log("stop",t),this._state.cancel(t),this._state.setStateAtTime("stopped",t),this._tickSource.stop(t),t<this._lastUpdate&&this.emit("stop",t),this}pause(e){let t=this.toSeconds(e);return this._state.getValueAtTime(t)==="started"&&(this._state.setStateAtTime("paused",t),this._tickSource.pause(t),t<this._lastUpdate&&this.emit("pause",t)),this}get ticks(){return Math.ceil(this.getTicksAtTime(this.now()))}set ticks(e){this._tickSource.ticks=e}get seconds(){return this._tickSource.seconds}set seconds(e){this._tickSource.seconds=e}getSecondsAtTime(e){return this._tickSource.getSecondsAtTime(e)}setTicksAtTime(e,t){return this._tickSource.setTicksAtTime(e,t),this}getTimeOfTick(e,t=this.now()){return this._tickSource.getTimeOfTick(e,t)}getTicksAtTime(e){return this._tickSource.getTicksAtTime(e)}nextTickTime(e,t){let r=this.toSeconds(t),n=this.getTicksAtTime(r);return this._tickSource.getTimeOfTick(n+e,r)}_loop(){let e=this._lastUpdate,t=this.now();this._lastUpdate=t,this.log("loop",e,t),e!==t&&(this._state.forEachBetween(e,t,r=>{switch(r.state){case"started":let n=this._tickSource.getTicksAtTime(r.time);this.emit("start",r.time,n);break;case"stopped":r.time!==0&&this.emit("stop",r.time);break;case"paused":this.emit("pause",r.time);break}}),this._tickSource.forEachTickBetween(e,t,(r,n)=>{this.callback(r,n)}))}getStateAtTime(e){let t=this.toSeconds(e);return this._state.getValueAtTime(t)}dispose(){return super.dispose(),this.context.off("tick",this._boundLoop),this._tickSource.dispose(),this._state.dispose(),this}};S0.mixin(tl);var $i=class{constructor(e,t){this.id=$i._eventId++;let r=Object.assign($i.getDefaults(),t);this.transport=e,this.callback=r.callback,this._once=r.once,this.time=r.time}static getDefaults(){return{callback:gt,once:!1,time:0}}invoke(e){this.callback&&(this.callback(e),this._once&&this.transport.clear(this.id))}dispose(){return this.callback=void 0,this}};$i._eventId=0;var Af=class extends $i{constructor(e,t){super(e,t);this._currentId=-1,this._nextId=-1,this._nextTick=this.time,this._boundRestart=this._restart.bind(this);let r=Object.assign(Af.getDefaults(),t);this.duration=new yi(e.context,r.duration).valueOf(),this._interval=new yi(e.context,r.interval).valueOf(),this._nextTick=r.time,this.transport.on("start",this._boundRestart),this.transport.on("loopStart",this._boundRestart),this.context=this.transport.context,this._restart()}static getDefaults(){return Object.assign({},$i.getDefaults(),{duration:1/0,interval:1,once:!1})}invoke(e){this._createEvents(e),super.invoke(e)}_createEvents(e){let t=this.transport.getTicksAtTime(e);t>=this.time&&t>=this._nextTick&&this._nextTick+this._interval<this.time+this.duration&&(this._nextTick+=this._interval,this._currentId=this._nextId,this._nextId=this.transport.scheduleOnce(this.invoke.bind(this),new yi(this.context,this._nextTick).toSeconds()))}_restart(e){this.transport.clear(this._currentId),this.transport.clear(this._nextId),this._nextTick=this.time;let t=this.transport.getTicksAtTime(e);t>this.time&&(this._nextTick=this.time+Math.ceil((t-this.time)/this._interval)*this._interval),this._currentId=this.transport.scheduleOnce(this.invoke.bind(this),new yi(this.context,this._nextTick).toSeconds()),this._nextTick+=this._interval,this._nextId=this.transport.scheduleOnce(this.invoke.bind(this),new yi(this.context,this._nextTick).toSeconds())}dispose(){return super.dispose(),this.transport.clear(this._currentId),this.transport.clear(this._nextId),this.transport.off("start",this._boundRestart),this.transport.off("loopStart",this._boundRestart),this}};var Xp=class extends to{constructor(){super(pe(Xp.getDefaults(),arguments));this.name="Transport",this._loop=new ng(!1),this._loopStart=0,this._loopEnd=0,this._scheduledEvents={},this._timeline=new So,this._repeatedEvents=new ig,this._syncedSignals=[],this._swingAmount=0;let e=pe(Xp.getDefaults(),arguments);this._ppq=e.ppq,this._clock=new tl({callback:this._processTick.bind(this),context:this.context,frequency:0,units:"bpm"}),this._bindClockEvents(),this.bpm=this._clock.frequency,this._clock.frequency.multiplier=e.ppq,this.bpm.setValueAtTime(e.bpm,0),_t(this,"bpm"),this._timeSignature=e.timeSignature,this._swingTicks=e.ppq/2}static getDefaults(){return Object.assign(to.getDefaults(),{bpm:120,loopEnd:"4m",loopStart:0,ppq:192,swing:0,swingSubdivision:"8n",timeSignature:4})}_processTick(e,t){if(this._loop.get(e)&&t>=this._loopEnd&&(this.emit("loopEnd",e),this._clock.setTicksAtTime(this._loopStart,e),t=this._loopStart,this.emit("loopStart",e,this._clock.getSecondsAtTime(e)),this.emit("loop",e)),this._swingAmount>0&&t%this._ppq!==0&&t%(this._swingTicks*2)!==0){let r=t%(this._swingTicks*2)/(this._swingTicks*2),n=Math.sin(r*Math.PI)*this._swingAmount;e+=new yi(this.context,this._swingTicks*2/3).toSeconds()*n}this._timeline.forEachAtTime(t,r=>r.invoke(e))}schedule(e,t){let r=new $i(this,{callback:e,time:new w0(this.context,t).toTicks()});return this._addEvent(r,this._timeline)}scheduleRepeat(e,t,r,n=1/0){let i=new Af(this,{callback:e,duration:new Vo(this.context,n).toTicks(),interval:new Vo(this.context,t).toTicks(),time:new w0(this.context,r).toTicks()});return this._addEvent(i,this._repeatedEvents)}scheduleOnce(e,t){let r=new $i(this,{callback:e,once:!0,time:new w0(this.context,t).toTicks()});return this._addEvent(r,this._timeline)}clear(e){if(this._scheduledEvents.hasOwnProperty(e)){let t=this._scheduledEvents[e.toString()];t.timeline.remove(t.event),t.event.dispose(),delete this._scheduledEvents[e.toString()]}return this}_addEvent(e,t){return this._scheduledEvents[e.id.toString()]={event:e,timeline:t},t.add(e),e.id}cancel(e=0){let t=this.toTicks(e);return this._timeline.forEachFrom(t,r=>this.clear(r.id)),this._repeatedEvents.forEachFrom(t,r=>this.clear(r.id)),this}_bindClockEvents(){this._clock.on("start",(e,t)=>{t=new yi(this.context,t).toSeconds(),this.emit("start",e,t)}),this._clock.on("stop",e=>{this.emit("stop",e)}),this._clock.on("pause",e=>{this.emit("pause",e)})}get state(){return this._clock.getStateAtTime(this.now())}start(e,t){let r;return $e(t)&&(r=this.toTicks(t)),this._clock.start(e,r),this}stop(e){return this._clock.stop(e),this}pause(e){return this._clock.pause(e),this}toggle(e){return e=this.toSeconds(e),this._clock.getStateAtTime(e)!=="started"?this.start(e):this.stop(e),this}get timeSignature(){return this._timeSignature}set timeSignature(e){fo(e)&&(e=e[0]/e[1]*4),this._timeSignature=e}get loopStart(){return new Vo(this.context,this._loopStart,"i").toSeconds()}set loopStart(e){this._loopStart=this.toTicks(e)}get loopEnd(){return new Vo(this.context,this._loopEnd,"i").toSeconds()}set loopEnd(e){this._loopEnd=this.toTicks(e)}get loop(){return this._loop.get(this.now())}set loop(e){this._loop.set(e,this.now())}setLoopPoints(e,t){return this.loopStart=e,this.loopEnd=t,this}get swing(){return this._swingAmount}set swing(e){this._swingAmount=e}get swingSubdivision(){return new yi(this.context,this._swingTicks).toNotation()}set swingSubdivision(e){this._swingTicks=this.toTicks(e)}get position(){let e=this.now(),t=this._clock.getTicksAtTime(e);return new yi(this.context,t).toBarsBeatsSixteenths()}set position(e){let t=this.toTicks(e);this.ticks=t}get seconds(){return this._clock.seconds}set seconds(e){let t=this.now(),r=this._clock.frequency.timeToTicks(e,t);this.ticks=r}get progress(){if(this.loop){let e=this.now();return(this._clock.getTicksAtTime(e)-this._loopStart)/(this._loopEnd-this._loopStart)}else return 0}get ticks(){return this._clock.ticks}set ticks(e){if(this._clock.ticks!==e){let t=this.now();if(this.state==="started"){let r=this._clock.getTicksAtTime(t),n=this._clock.frequency.getDurationOfTicks(Math.ceil(r)-r,t),i=t+n;this.emit("stop",i),this._clock.setTicksAtTime(e,i),this.emit("start",i,this._clock.getSecondsAtTime(i))}else this._clock.setTicksAtTime(e,t)}}getTicksAtTime(e){return Math.round(this._clock.getTicksAtTime(e))}getSecondsAtTime(e){return this._clock.getSecondsAtTime(e)}get PPQ(){return this._clock.frequency.multiplier}set PPQ(e){this._clock.frequency.multiplier=e}nextSubdivision(e){if(e=this.toTicks(e),this.state!=="started")return 0;{let t=this.now(),r=this.getTicksAtTime(t),n=e-r%e;return this._clock.nextTickTime(n,t)}}syncSignal(e,t){if(!t){let n=this.now();if(e.getValueAtTime(n)!==0){let i=this.bpm.getValueAtTime(n),s=1/(60/i/this.PPQ);t=e.getValueAtTime(n)/s}else t=0}let r=new Qt(t);return this.bpm.connect(r),r.connect(e._param),this._syncedSignals.push({initial:e.value,ratio:r,signal:e}),e.value=0,this}unsyncSignal(e){for(let t=this._syncedSignals.length-1;t>=0;t--){let r=this._syncedSignals[t];r.signal===e&&(r.ratio.dispose(),r.signal.value=r.initial,this._syncedSignals.splice(t,1))}return this}dispose(){return super.dispose(),this._clock.dispose(),og(this,"bpm"),this._timeline.dispose(),this._repeatedEvents.dispose(),this}};S0.mixin(Xp);Vp(o=>{o.transport=new Xp({context:o})});Gp(o=>{o.transport.dispose()});var ur=class extends je{constructor(e){super(e);this.input=void 0,this._state=new el("stopped"),this._synced=!1,this._scheduled=[],this._syncedStart=gt,this._syncedStop=gt,this._state.memory=100,this._state.increasing=!0,this._volume=this.output=new Cn({context:this.context,mute:e.mute,volume:e.volume}),this.volume=this._volume.volume,_t(this,"volume"),this.onstop=e.onstop}static getDefaults(){return Object.assign(je.getDefaults(),{mute:!1,onstop:gt,volume:0})}get state(){return this._synced?this.context.transport.state==="started"?this._state.getValueAtTime(this.context.transport.seconds):"stopped":this._state.getValueAtTime(this.now())}get mute(){return this._volume.mute}set mute(e){this._volume.mute=e}_clampToCurrentTime(e){return this._synced?e:Math.max(e,this.context.currentTime)}start(e,t,r){let n=eo(e)&&this._synced?this.context.transport.seconds:this.toSeconds(e);if(n=this._clampToCurrentTime(n),!this._synced&&this._state.getValueAtTime(n)==="started")ze(Fp(n,this._state.get(n).time),"Start time must be strictly greater than previous start time"),this._state.cancel(n),this._state.setStateAtTime("started",n),this.log("restart",n),this.restart(n,t,r);else if(this.log("start",n),this._state.setStateAtTime("started",n),this._synced){let i=this._state.get(n);i&&(i.offset=this.toSeconds(C0(t,0)),i.duration=r?this.toSeconds(r):void 0);let s=this.context.transport.schedule(a=>{this._start(a,t,r)},n);this._scheduled.push(s),this.context.transport.state==="started"&&this.context.transport.getSecondsAtTime(this.immediate())>n&&this._syncedStart(this.now(),this.context.transport.seconds)}else v9(this.context),this._start(n,t,r);return this}stop(e){let t=eo(e)&&this._synced?this.context.transport.seconds:this.toSeconds(e);if(t=this._clampToCurrentTime(t),this._state.getValueAtTime(t)==="started"||$e(this._state.getNextState("started",t))){if(this.log("stop",t),!this._synced)this._stop(t);else{let r=this.context.transport.schedule(this._stop.bind(this),t);this._scheduled.push(r)}this._state.cancel(t),this._state.setStateAtTime("stopped",t)}return this}restart(e,t,r){return e=this.toSeconds(e),this._state.getValueAtTime(e)==="started"&&(this._state.cancel(e),this._restart(e,t,r)),this}sync(){return this._synced||(this._synced=!0,this._syncedStart=(e,t)=>{if(t>0){let r=this._state.get(t);if(r&&r.state==="started"&&r.time!==t){let n=t-this.toSeconds(r.time),i;r.duration&&(i=this.toSeconds(r.duration)-n),this._start(e,this.toSeconds(r.offset)+n,i)}}},this._syncedStop=e=>{let t=this.context.transport.getSecondsAtTime(Math.max(e-this.sampleTime,0));this._state.getValueAtTime(t)==="started"&&this._stop(e)},this.context.transport.on("start",this._syncedStart),this.context.transport.on("loopStart",this._syncedStart),this.context.transport.on("stop",this._syncedStop),this.context.transport.on("pause",this._syncedStop),this.context.transport.on("loopEnd",this._syncedStop)),this}unsync(){return this._synced&&(this.context.transport.off("stop",this._syncedStop),this.context.transport.off("pause",this._syncedStop),this.context.transport.off("loopEnd",this._syncedStop),this.context.transport.off("start",this._syncedStart),this.context.transport.off("loopStart",this._syncedStart)),this._synced=!1,this._scheduled.forEach(e=>this.context.transport.clear(e)),this._scheduled=[],this._state.cancel(0),this._stop(0),this}dispose(){return super.dispose(),this.onstop=gt,this.unsync(),this._volume.dispose(),this._state.dispose(),this}};function En(o,e){return xt(this,void 0,void 0,function*(){let t=e/o.context.sampleRate,r=new Zc(1,t,o.context.sampleRate);return new o.constructor(Object.assign(o.get(),{frequency:2/t,detune:0,context:r})).toDestination().start(0),(yield r.render()).getChannelData(0)})}var Yp=class extends js{constructor(){super(pe(Yp.getDefaults(),arguments,["frequency","type"]));this.name="ToneOscillatorNode",this._oscillator=this.context.createOscillator(),this._internalChannels=[this._oscillator];let e=pe(Yp.getDefaults(),arguments,["frequency","type"]);gi(this._oscillator,this._gainNode),this.type=e.type,this.frequency=new ft({context:this.context,param:this._oscillator.frequency,units:"frequency",value:e.frequency}),this.detune=new ft({context:this.context,param:this._oscillator.detune,units:"cents",value:e.detune}),_t(this,["frequency","detune"])}static getDefaults(){return Object.assign(js.getDefaults(),{detune:0,frequency:440,type:"sine"})}start(e){let t=this.toSeconds(e);return this.log("start",t),this._startGain(t),this._oscillator.start(t),this}_stopSource(e){this._oscillator.stop(e)}setPeriodicWave(e){return this._oscillator.setPeriodicWave(e),this}get type(){return this._oscillator.type}set type(e){this._oscillator.type=e}dispose(){return super.dispose(),this.state==="started"&&this.stop(),this._oscillator.disconnect(),this.frequency.dispose(),this.detune.dispose(),this}};var er=class extends ur{constructor(){super(pe(er.getDefaults(),arguments,["frequency","type"]));this.name="Oscillator",this._oscillator=null;let e=pe(er.getDefaults(),arguments,["frequency","type"]);this.frequency=new kt({context:this.context,units:"frequency",value:e.frequency}),_t(this,"frequency"),this.detune=new kt({context:this.context,units:"cents",value:e.detune}),_t(this,"detune"),this._partials=e.partials,this._partialCount=e.partialCount,this._type=e.type,e.partialCount&&e.type!=="custom"&&(this._type=this.baseType+e.partialCount.toString()),this.phase=e.phase}static getDefaults(){return Object.assign(ur.getDefaults(),{detune:0,frequency:440,partialCount:0,partials:[],phase:0,type:"sine"})}_start(e){let t=this.toSeconds(e),r=new Yp({context:this.context,onended:()=>this.onstop(this)});this._oscillator=r,this._wave?this._oscillator.setPeriodicWave(this._wave):this._oscillator.type=this._type,this._oscillator.connect(this.output),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.start(t)}_stop(e){let t=this.toSeconds(e);this._oscillator&&this._oscillator.stop(t)}_restart(e){let t=this.toSeconds(e);return this.log("restart",t),this._oscillator&&this._oscillator.cancelStop(),this._state.cancel(t),this}syncFrequency(){return this.context.transport.syncSignal(this.frequency),this}unsyncFrequency(){return this.context.transport.unsyncSignal(this.frequency),this}_getCachedPeriodicWave(){if(this._type==="custom")return er._periodicWaveCache.find(t=>t.phase===this._phase&&MD(t.partials,this._partials));{let e=er._periodicWaveCache.find(t=>t.type===this._type&&t.phase===this._phase);return this._partialCount=e?e.partialCount:this._partialCount,e}}get type(){return this._type}set type(e){this._type=e;let t=["sine","square","sawtooth","triangle"].indexOf(e)!==-1;if(this._phase===0&&t)this._wave=void 0,this._partialCount=0,this._oscillator!==null&&(this._oscillator.type=e);else{let r=this._getCachedPeriodicWave();if($e(r)){let{partials:n,wave:i}=r;this._wave=i,this._partials=n,this._oscillator!==null&&this._oscillator.setPeriodicWave(this._wave)}else{let[n,i]=this._getRealImaginary(e,this._phase),s=this.context.createPeriodicWave(n,i);this._wave=s,this._oscillator!==null&&this._oscillator.setPeriodicWave(this._wave),er._periodicWaveCache.push({imag:i,partialCount:this._partialCount,partials:this._partials,phase:this._phase,real:n,type:this._type,wave:this._wave}),er._periodicWaveCache.length>100&&er._periodicWaveCache.shift()}}}get baseType(){return this._type.replace(this.partialCount.toString(),"")}set baseType(e){this.partialCount&&this._type!=="custom"&&e!=="custom"?this.type=e+this.partialCount:this.type=e}get partialCount(){return this._partialCount}set partialCount(e){Uo(e,0);let t=this._type,r=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(this._type);if(r&&(t=r[1]),this._type!=="custom")e===0?this.type=t:this.type=t+e.toString();else{let n=new Float32Array(e);this._partials.forEach((i,s)=>n[s]=i),this._partials=Array.from(n),this.type=this._type}}_getRealImaginary(e,t){let n=2048,i=new Float32Array(n),s=new Float32Array(n),a=1;if(e==="custom"){if(a=this._partials.length+1,this._partialCount=this._partials.length,n=a,this._partials.length===0)return[i,s]}else{let c=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(e);c?(a=parseInt(c[2],10)+1,this._partialCount=parseInt(c[2],10),e=c[1],a=Math.max(a,2),n=a):this._partialCount=0,this._partials=[]}for(let c=1;c<n;++c){let l=2/(c*Math.PI),u;switch(e){case"sine":u=c<=a?1:0,this._partials[c-1]=u;break;case"square":u=c&1?2*l:0,this._partials[c-1]=u;break;case"sawtooth":u=l*(c&1?1:-1),this._partials[c-1]=u;break;case"triangle":c&1?u=2*(l*l)*(c-1>>1&1?-1:1):u=0,this._partials[c-1]=u;break;case"custom":u=this._partials[c-1];break;default:throw new TypeError("Oscillator: invalid type: "+e)}u!==0?(i[c]=-u*Math.sin(t*c),s[c]=u*Math.cos(t*c)):(i[c]=0,s[c]=0)}return[i,s]}_inverseFFT(e,t,r){let n=0,i=e.length;for(let s=0;s<i;s++)n+=e[s]*Math.cos(s*r)+t[s]*Math.sin(s*r);return n}getInitialValue(){let[e,t]=this._getRealImaginary(this._type,0),r=0,n=Math.PI*2,i=32;for(let s=0;s<i;s++)r=Math.max(this._inverseFFT(e,t,s/i*n),r);return UD(-this._inverseFFT(e,t,this._phase)/r,-1,1)}get partials(){return this._partials.slice(0,this.partialCount)}set partials(e){this._partials=e,this._partialCount=this._partials.length,e.length&&(this.type="custom")}get phase(){return this._phase*(180/Math.PI)}set phase(e){this._phase=e*Math.PI/180,this.type=this._type}asArray(e=1024){return xt(this,void 0,void 0,function*(){return En(this,e)})}dispose(){return super.dispose(),this._oscillator!==null&&this._oscillator.dispose(),this._wave=void 0,this.frequency.dispose(),this.detune.dispose(),this}};er._periodicWaveCache=[];var rl=class extends ur{constructor(){super(pe(rl.getDefaults(),arguments,["frequency","type","modulationType"]));this.name="AMOscillator",this._modulationScale=new bf({context:this.context}),this._modulationNode=new Qt({context:this.context});let e=pe(rl.getDefaults(),arguments,["frequency","type","modulationType"]);this._carrier=new er({context:this.context,detune:e.detune,frequency:e.frequency,onstop:()=>this.onstop(this),phase:e.phase,type:e.type}),this.frequency=this._carrier.frequency,this.detune=this._carrier.detune,this._modulator=new er({context:this.context,phase:e.phase,type:e.modulationType}),this.harmonicity=new qn({context:this.context,units:"positive",value:e.harmonicity}),this.frequency.chain(this.harmonicity,this._modulator.frequency),this._modulator.chain(this._modulationScale,this._modulationNode.gain),this._carrier.chain(this._modulationNode,this.output),_t(this,["frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(er.getDefaults(),{harmonicity:1,modulationType:"square"})}_start(e){this._modulator.start(e),this._carrier.start(e)}_stop(e){this._modulator.stop(e),this._carrier.stop(e)}_restart(e){this._modulator.restart(e),this._carrier.restart(e)}get type(){return this._carrier.type}set type(e){this._carrier.type=e}get baseType(){return this._carrier.baseType}set baseType(e){this._carrier.baseType=e}get partialCount(){return this._carrier.partialCount}set partialCount(e){this._carrier.partialCount=e}get modulationType(){return this._modulator.type}set modulationType(e){this._modulator.type=e}get phase(){return this._carrier.phase}set phase(e){this._carrier.phase=e,this._modulator.phase=e}get partials(){return this._carrier.partials}set partials(e){this._carrier.partials=e}asArray(e=1024){return xt(this,void 0,void 0,function*(){return En(this,e)})}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this._modulationScale.dispose(),this}};var ol=class extends ur{constructor(){super(pe(ol.getDefaults(),arguments,["frequency","type","spread"]));this.name="FatOscillator",this._oscillators=[];let e=pe(ol.getDefaults(),arguments,["frequency","type","spread"]);this.frequency=new kt({context:this.context,units:"frequency",value:e.frequency}),this.detune=new kt({context:this.context,units:"cents",value:e.detune}),this._spread=e.spread,this._type=e.type,this._phase=e.phase,this._partials=e.partials,this._partialCount=e.partialCount,this.count=e.count,_t(this,["frequency","detune"])}static getDefaults(){return Object.assign(er.getDefaults(),{count:3,spread:20,type:"sawtooth"})}_start(e){e=this.toSeconds(e),this._forEach(t=>t.start(e))}_stop(e){e=this.toSeconds(e),this._forEach(t=>t.stop(e))}_restart(e){this._forEach(t=>t.restart(e))}_forEach(e){for(let t=0;t<this._oscillators.length;t++)e(this._oscillators[t],t)}get type(){return this._type}set type(e){this._type=e,this._forEach(t=>t.type=e)}get spread(){return this._spread}set spread(e){if(this._spread=e,this._oscillators.length>1){let t=-e/2,r=e/(this._oscillators.length-1);this._forEach((n,i)=>n.detune.value=t+r*i)}}get count(){return this._oscillators.length}set count(e){if(Uo(e,1),this._oscillators.length!==e){this._forEach(t=>t.dispose()),this._oscillators=[];for(let t=0;t<e;t++){let r=new er({context:this.context,volume:-6-e*1.1,type:this._type,phase:this._phase+t/e*360,partialCount:this._partialCount,onstop:t===0?()=>this.onstop(this):gt});this.type==="custom"&&(r.partials=this._partials),this.frequency.connect(r.frequency),this.detune.connect(r.detune),r.detune.overridden=!1,r.connect(this.output),this._oscillators[t]=r}this.spread=this._spread,this.state==="started"&&this._forEach(t=>t.start())}}get phase(){return this._phase}set phase(e){this._phase=e,this._forEach((t,r)=>t.phase=this._phase+r/this.count*360)}get baseType(){return this._oscillators[0].baseType}set baseType(e){this._forEach(t=>t.baseType=e),this._type=this._oscillators[0].type}get partials(){return this._oscillators[0].partials}set partials(e){this._partials=e,this._partialCount=this._partials.length,e.length&&(this._type="custom",this._forEach(t=>t.partials=e))}get partialCount(){return this._oscillators[0].partialCount}set partialCount(e){this._partialCount=e,this._forEach(t=>t.partialCount=e),this._type=this._oscillators[0].type}asArray(e=1024){return xt(this,void 0,void 0,function*(){return En(this,e)})}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this._forEach(e=>e.dispose()),this}};var nl=class extends ur{constructor(){super(pe(nl.getDefaults(),arguments,["frequency","type","modulationType"]));this.name="FMOscillator",this._modulationNode=new Qt({context:this.context,gain:0});let e=pe(nl.getDefaults(),arguments,["frequency","type","modulationType"]);this._carrier=new er({context:this.context,detune:e.detune,frequency:0,onstop:()=>this.onstop(this),phase:e.phase,type:e.type}),this.detune=this._carrier.detune,this.frequency=new kt({context:this.context,units:"frequency",value:e.frequency}),this._modulator=new er({context:this.context,phase:e.phase,type:e.modulationType}),this.harmonicity=new qn({context:this.context,units:"positive",value:e.harmonicity}),this.modulationIndex=new qn({context:this.context,units:"positive",value:e.modulationIndex}),this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.frequency.chain(this.modulationIndex,this._modulationNode),this._modulator.connect(this._modulationNode.gain),this._modulationNode.connect(this._carrier.frequency),this._carrier.connect(this.output),this.detune.connect(this._modulator.detune),_t(this,["modulationIndex","frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(er.getDefaults(),{harmonicity:1,modulationIndex:2,modulationType:"square"})}_start(e){this._modulator.start(e),this._carrier.start(e)}_stop(e){this._modulator.stop(e),this._carrier.stop(e)}_restart(e){return this._modulator.restart(e),this._carrier.restart(e),this}get type(){return this._carrier.type}set type(e){this._carrier.type=e}get baseType(){return this._carrier.baseType}set baseType(e){this._carrier.baseType=e}get partialCount(){return this._carrier.partialCount}set partialCount(e){this._carrier.partialCount=e}get modulationType(){return this._modulator.type}set modulationType(e){this._modulator.type=e}get phase(){return this._carrier.phase}set phase(e){this._carrier.phase=e,this._modulator.phase=e}get partials(){return this._carrier.partials}set partials(e){this._carrier.partials=e}asArray(e=1024){return xt(this,void 0,void 0,function*(){return En(this,e)})}dispose(){return super.dispose(),this.frequency.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this.modulationIndex.dispose(),this}};var M0=class extends ur{constructor(){super(pe(M0.getDefaults(),arguments,["frequency","width"]));this.name="PulseOscillator",this._widthGate=new Qt({context:this.context,gain:0}),this._thresh=new Ra({context:this.context,mapping:t=>t<=0?-1:1});let e=pe(M0.getDefaults(),arguments,["frequency","width"]);this.width=new kt({context:this.context,units:"audioRange",value:e.width}),this._triangle=new er({context:this.context,detune:e.detune,frequency:e.frequency,onstop:()=>this.onstop(this),phase:e.phase,type:"triangle"}),this.frequency=this._triangle.frequency,this.detune=this._triangle.detune,this._triangle.chain(this._thresh,this.output),this.width.chain(this._widthGate,this._thresh),_t(this,["width","frequency","detune"])}static getDefaults(){return Object.assign(ur.getDefaults(),{detune:0,frequency:440,phase:0,type:"pulse",width:.2})}_start(e){e=this.toSeconds(e),this._triangle.start(e),this._widthGate.gain.setValueAtTime(1,e)}_stop(e){e=this.toSeconds(e),this._triangle.stop(e),this._widthGate.gain.cancelScheduledValues(e),this._widthGate.gain.setValueAtTime(0,e)}_restart(e){this._triangle.restart(e),this._widthGate.gain.cancelScheduledValues(e),this._widthGate.gain.setValueAtTime(1,e)}get phase(){return this._triangle.phase}set phase(e){this._triangle.phase=e}get type(){return"pulse"}get baseType(){return"pulse"}get partials(){return[]}get partialCount(){return 0}set carrierType(e){this._triangle.type=e}asArray(e=1024){return xt(this,void 0,void 0,function*(){return En(this,e)})}dispose(){return super.dispose(),this._triangle.dispose(),this.width.dispose(),this._widthGate.dispose(),this._thresh.dispose(),this}};var il=class extends ur{constructor(){super(pe(il.getDefaults(),arguments,["frequency","modulationFrequency"]));this.name="PWMOscillator",this.sourceType="pwm",this._scale=new qn({context:this.context,value:2});let e=pe(il.getDefaults(),arguments,["frequency","modulationFrequency"]);this._pulse=new M0({context:this.context,frequency:e.modulationFrequency}),this._pulse.carrierType="sine",this.modulationFrequency=this._pulse.frequency,this._modulator=new er({context:this.context,detune:e.detune,frequency:e.frequency,onstop:()=>this.onstop(this),phase:e.phase}),this.frequency=this._modulator.frequency,this.detune=this._modulator.detune,this._modulator.chain(this._scale,this._pulse.width),this._pulse.connect(this.output),_t(this,["modulationFrequency","frequency","detune"])}static getDefaults(){return Object.assign(ur.getDefaults(),{detune:0,frequency:440,modulationFrequency:.4,phase:0,type:"pwm"})}_start(e){e=this.toSeconds(e),this._modulator.start(e),this._pulse.start(e)}_stop(e){e=this.toSeconds(e),this._modulator.stop(e),this._pulse.stop(e)}_restart(e){this._modulator.restart(e),this._pulse.restart(e)}get type(){return"pwm"}get baseType(){return"pwm"}get partials(){return[]}get partialCount(){return 0}get phase(){return this._modulator.phase}set phase(e){this._modulator.phase=e}asArray(e=1024){return xt(this,void 0,void 0,function*(){return En(this,e)})}dispose(){return super.dispose(),this._pulse.dispose(),this._scale.dispose(),this._modulator.dispose(),this}};var _k={am:rl,fat:ol,fm:nl,oscillator:er,pulse:M0,pwm:il},qs=class extends ur{constructor(){super(pe(qs.getDefaults(),arguments,["frequency","type"]));this.name="OmniOscillator";let e=pe(qs.getDefaults(),arguments,["frequency","type"]);this.frequency=new kt({context:this.context,units:"frequency",value:e.frequency}),this.detune=new kt({context:this.context,units:"cents",value:e.detune}),_t(this,["frequency","detune"]),this.set(e)}static getDefaults(){return Object.assign(er.getDefaults(),nl.getDefaults(),rl.getDefaults(),ol.getDefaults(),M0.getDefaults(),il.getDefaults())}_start(e){this._oscillator.start(e)}_stop(e){this._oscillator.stop(e)}_restart(e){return this._oscillator.restart(e),this}get type(){let e="";return["am","fm","fat"].some(t=>this._sourceType===t)&&(e=this._sourceType),e+this._oscillator.type}set type(e){e.substr(0,2)==="fm"?(this._createNewOscillator("fm"),this._oscillator=this._oscillator,this._oscillator.type=e.substr(2)):e.substr(0,2)==="am"?(this._createNewOscillator("am"),this._oscillator=this._oscillator,this._oscillator.type=e.substr(2)):e.substr(0,3)==="fat"?(this._createNewOscillator("fat"),this._oscillator=this._oscillator,this._oscillator.type=e.substr(3)):e==="pwm"?(this._createNewOscillator("pwm"),this._oscillator=this._oscillator):e==="pulse"?this._createNewOscillator("pulse"):(this._createNewOscillator("oscillator"),this._oscillator=this._oscillator,this._oscillator.type=e)}get partials(){return this._oscillator.partials}set partials(e){!this._getOscType(this._oscillator,"pulse")&&!this._getOscType(this._oscillator,"pwm")&&(this._oscillator.partials=e)}get partialCount(){return this._oscillator.partialCount}set partialCount(e){!this._getOscType(this._oscillator,"pulse")&&!this._getOscType(this._oscillator,"pwm")&&(this._oscillator.partialCount=e)}set(e){return Reflect.has(e,"type")&&e.type&&(this.type=e.type),super.set(e),this}_createNewOscillator(e){if(e!==this._sourceType){this._sourceType=e;let t=_k[e],r=this.now();if(this._oscillator){let n=this._oscillator;n.stop(r),this.context.setTimeout(()=>n.dispose(),this.blockTime)}this._oscillator=new t({context:this.context}),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.connect(this.output),this._oscillator.onstop=()=>this.onstop(this),this.state==="started"&&this._oscillator.start(r)}}get phase(){return this._oscillator.phase}set phase(e){this._oscillator.phase=e}get sourceType(){return this._sourceType}set sourceType(e){let t="sine";this._oscillator.type!=="pwm"&&this._oscillator.type!=="pulse"&&(t=this._oscillator.type),e==="fm"?this.type="fm"+t:e==="am"?this.type="am"+t:e==="fat"?this.type="fat"+t:e==="oscillator"?this.type=t:e==="pulse"?this.type="pulse":e==="pwm"&&(this.type="pwm")}_getOscType(e,t){return e instanceof _k[t]}get baseType(){return this._oscillator.baseType}set baseType(e){!this._getOscType(this._oscillator,"pulse")&&!this._getOscType(this._oscillator,"pwm")&&e!=="pulse"&&e!=="pwm"&&(this._oscillator.baseType=e)}get width(){if(this._getOscType(this._oscillator,"pulse"))return this._oscillator.width}get count(){if(this._getOscType(this._oscillator,"fat"))return this._oscillator.count}set count(e){this._getOscType(this._oscillator,"fat")&&jn(e)&&(this._oscillator.count=e)}get spread(){if(this._getOscType(this._oscillator,"fat"))return this._oscillator.spread}set spread(e){this._getOscType(this._oscillator,"fat")&&jn(e)&&(this._oscillator.spread=e)}get modulationType(){if(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))return this._oscillator.modulationType}set modulationType(e){(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))&&Eo(e)&&(this._oscillator.modulationType=e)}get modulationIndex(){if(this._getOscType(this._oscillator,"fm"))return this._oscillator.modulationIndex}get harmonicity(){if(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))return this._oscillator.harmonicity}get modulationFrequency(){if(this._getOscType(this._oscillator,"pwm"))return this._oscillator.modulationFrequency}asArray(e=1024){return xt(this,void 0,void 0,function*(){return En(this,e)})}dispose(){return super.dispose(),this.detune.dispose(),this.frequency.dispose(),this._oscillator.dispose(),this}};var Cf=class extends rn{constructor(){super(pe(Cf.getDefaults(),arguments,["attack","decay","sustain","release"]));this.name="AmplitudeEnvelope",this._gainNode=new Qt({context:this.context,gain:0}),this.output=this._gainNode,this.input=this._gainNode,this._sig.connect(this._gainNode.gain),this.output=this._gainNode,this.input=this._gainNode}dispose(){return super.dispose(),this._gainNode.dispose(),this}};var sl=class extends Yi{constructor(){super(pe(sl.getDefaults(),arguments));this.name="Synth";let e=pe(sl.getDefaults(),arguments);this.oscillator=new qs(Object.assign({context:this.context,detune:e.detune,onstop:()=>this.onsilence(this)},e.oscillator)),this.frequency=this.oscillator.frequency,this.detune=this.oscillator.detune,this.envelope=new Cf(Object.assign({context:this.context},e.envelope)),this.oscillator.chain(this.envelope,this.output),_t(this,["oscillator","frequency","detune","envelope"])}static getDefaults(){return Object.assign(Yi.getDefaults(),{envelope:Object.assign(Oa(rn.getDefaults(),Object.keys(je.getDefaults())),{attack:.005,decay:.1,release:1,sustain:.3}),oscillator:Object.assign(Oa(qs.getDefaults(),[...Object.keys(ur.getDefaults()),"frequency","detune"]),{type:"triangle"})})}_triggerEnvelopeAttack(e,t){if(this.envelope.triggerAttack(e,t),this.oscillator.start(e),this.envelope.sustain===0){let r=this.toSeconds(this.envelope.attack),n=this.toSeconds(this.envelope.decay);this.oscillator.stop(e+r+n)}}_triggerEnvelopeRelease(e){this.envelope.triggerRelease(e),this.oscillator.stop(e+this.toSeconds(this.envelope.release))}getLevelAtTime(e){return e=this.toSeconds(e),this.envelope.getValueAtTime(e)}dispose(){return super.dispose(),this.oscillator.dispose(),this.envelope.dispose(),this}};var $p=class extends Yi{constructor(){super(pe($p.getDefaults(),arguments));this.name="ModulationSynth";let e=pe($p.getDefaults(),arguments);this._carrier=new sl({context:this.context,oscillator:e.oscillator,envelope:e.envelope,onsilence:()=>this.onsilence(this),volume:-10}),this._modulator=new sl({context:this.context,oscillator:e.modulation,envelope:e.modulationEnvelope,volume:-10}),this.oscillator=this._carrier.oscillator,this.envelope=this._carrier.envelope,this.modulation=this._modulator.oscillator,this.modulationEnvelope=this._modulator.envelope,this.frequency=new kt({context:this.context,units:"frequency"}),this.detune=new kt({context:this.context,value:e.detune,units:"cents"}),this.harmonicity=new qn({context:this.context,value:e.harmonicity,minValue:0}),this._modulationNode=new Qt({context:this.context,gain:0}),_t(this,["frequency","harmonicity","oscillator","envelope","modulation","modulationEnvelope","detune"])}static getDefaults(){return Object.assign(Yi.getDefaults(),{harmonicity:3,oscillator:Object.assign(Oa(qs.getDefaults(),[...Object.keys(ur.getDefaults()),"frequency","detune"]),{type:"sine"}),envelope:Object.assign(Oa(rn.getDefaults(),Object.keys(je.getDefaults())),{attack:.01,decay:.01,sustain:1,release:.5}),modulation:Object.assign(Oa(qs.getDefaults(),[...Object.keys(ur.getDefaults()),"frequency","detune"]),{type:"square"}),modulationEnvelope:Object.assign(Oa(rn.getDefaults(),Object.keys(je.getDefaults())),{attack:.5,decay:0,sustain:1,release:.5})})}_triggerEnvelopeAttack(e,t){this._carrier._triggerEnvelopeAttack(e,t),this._modulator._triggerEnvelopeAttack(e,t)}_triggerEnvelopeRelease(e){return this._carrier._triggerEnvelopeRelease(e),this._modulator._triggerEnvelopeRelease(e),this}getLevelAtTime(e){return e=this.toSeconds(e),this.envelope.getValueAtTime(e)}dispose(){return super.dispose(),this._carrier.dispose(),this._modulator.dispose(),this.frequency.dispose(),this.detune.dispose(),this.harmonicity.dispose(),this._modulationNode.dispose(),this}};var Ef=class extends $p{constructor(){super(pe(Ef.getDefaults(),arguments));this.name="AMSynth",this._modulationScale=new bf({context:this.context}),this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.detune.fan(this._carrier.detune,this._modulator.detune),this._modulator.chain(this._modulationScale,this._modulationNode.gain),this._carrier.chain(this._modulationNode,this.output)}dispose(){return super.dispose(),this._modulationScale.dispose(),this}};var Kp={attackCurve:"linear",attack:.01,decayCurve:"exponential",decay:.1,releaseCurve:"exponential",release:1,sustain:.5},gk=class extends U{constructor(){super(...arguments);this.attack=y.FLOAT(Kp.attack,{range:[0,.1],rangeLocked:[!0,!1]}),this.decay=y.FLOAT(Kp.decay,{range:[0,1],rangeLocked:[!0,!1]}),this.sustain=y.FLOAT(Kp.sustain,{range:[0,1],rangeLocked:[!0,!1]}),this.release=y.FLOAT(Kp.release,{range:[0,1],rangeLocked:[!0,!1]})}},Jte=new gk,sg=class extends Zr{constructor(){super(...arguments);this.paramsConfig=Jte}static type(){return"envelope"}initializeNode(){this.io.inputs.setCount(0)}cook(e){let t=new Hn;t.setEnvelopeParams({attackCurve:"linear",attack:this.pv.attack,decayCurve:"exponential",decay:this.pv.decay,releaseCurve:"exponential",release:this.pv.release,sustain:this.pv.sustain}),this.setAudioBuilder(t)}};var vk=class extends U{},Zte=new vk,ag=class extends Zr{constructor(){super(...arguments);this.paramsConfig=Zte}static type(){return"AMSynth"}initializeNode(){this.io.inputs.setCount(0,1)}static displayedInputNames(){return["envelope"]}cook(e){let r=e[0].envelopeParams()||Kp,n=new Ef({harmonicity:2.5,oscillator:{type:"fatsawtooth"},envelope:r,modulation:{type:"square"},modulationEnvelope:{attack:.5,decay:.01}}),i=new Hn;i.setInstrument(n),this.setAudioBuilder(i)}};var Jp=class extends je{constructor(){super(pe(Jp.getDefaults(),arguments,["channels"]));this.name="Split";let e=pe(Jp.getDefaults(),arguments,["channels"]);this._splitter=this.input=this.output=this.context.createChannelSplitter(e.channels),this._internalChannels=[this._splitter]}static getDefaults(){return Object.assign(je.getDefaults(),{channels:2})}dispose(){return super.dispose(),this._splitter.disconnect(),this}};var Ia=class extends je{constructor(){super(pe(Ia.getDefaults(),arguments,["type","size"]));this.name="Analyser",this._analysers=[],this._buffers=[];let e=pe(Ia.getDefaults(),arguments,["type","size"]);this.input=this.output=this._gain=new Qt({context:this.context}),this._split=new Jp({context:this.context,channels:e.channels}),this.input.connect(this._split),Uo(e.channels,1);for(let t=0;t<e.channels;t++)this._analysers[t]=this.context.createAnalyser(),this._split.connect(this._analysers[t],t,0);this.size=e.size,this.type=e.type}static getDefaults(){return Object.assign(je.getDefaults(),{size:1024,smoothing:.8,type:"fft",channels:1})}getValue(){return this._analysers.forEach((e,t)=>{let r=this._buffers[t];this._type==="fft"?e.getFloatFrequencyData(r):this._type==="waveform"&&e.getFloatTimeDomainData(r)}),this.channels===1?this._buffers[0]:this._buffers}get size(){return this._analysers[0].frequencyBinCount}set size(e){this._analysers.forEach((t,r)=>{t.fftSize=e*2,this._buffers[r]=new Float32Array(e)})}get channels(){return this._analysers.length}get type(){return this._type}set type(e){ze(e==="waveform"||e==="fft",`Analyser: invalid type: ${e}`),this._type=e}get smoothing(){return this._analysers[0].smoothingTimeConstant}set smoothing(e){this._analysers.forEach(t=>t.smoothingTimeConstant=e)}dispose(){return super.dispose(),this._analysers.forEach(e=>e.disconnect()),this._split.dispose(),this._gain.dispose(),this}};var Ki=class extends je{constructor(){super(pe(Ki.getDefaults(),arguments));this.name="MeterBase",this.input=this.output=this._analyser=new Ia({context:this.context,size:256,type:"waveform"})}dispose(){return super.dispose(),this._analyser.dispose(),this}};var Zp=class extends Ki{constructor(){super(pe(Zp.getDefaults(),arguments,["size"]));this.name="FFT";let e=pe(Zp.getDefaults(),arguments,["size"]);this.normalRange=e.normalRange,this._analyser.type="fft",this.size=e.size}static getDefaults(){return Object.assign(je.getDefaults(),{normalRange:!1,size:1024,smoothing:.8})}getValue(){return this._analyser.getValue().map(t=>this.normalRange?Bp(t):t)}get size(){return this._analyser.size}set size(e){this._analyser.size=e}get smoothing(){return this._analyser.smoothing}set smoothing(e){this._analyser.smoothing=e}getFrequencyOfIndex(e){return ze(0<=e&&e<this.size,`index must be greater than or equal to 0 and less than ${this.size}`),e*this.context.sampleRate/(this.size*2)}};function La(o){return{cook:!1,callback:o}}var al=class extends Zr{};function yk(o,e,t){let r=t,n=0,i=1,s=o.length,a=t==2?Qte:ere;for(let c=0;c<s;){let{octaveIndexTmp:l}=a({values:o,target:e,currentOctaveSize:i,i:c,octaveIndex:n,divisionsMult:r});n=l,c+=i,i*=2}}function Qte(o){let{values:e,target:t,currentOctaveSize:r,i:n,octaveIndex:i,divisionsMult:s}=o,a=i,[c,l]=E9(r),u=0,p=[c,l];for(let d of p){let h=0;for(let m=0;m<d;m++){let f=n+m+u;h+=e[f]}u+=d,t[a]=h*s,a++}return{octaveIndexTmp:a}}function E9(o){let e=Math.max(1,Math.floor(o/3)),t=o-e;return[e,t]}function ere(o){let{values:e,target:t,currentOctaveSize:r,i:n,octaveIndex:i,divisionsMult:s}=o,a=i,[c,l]=E9(r),[u,p]=E9(c),[d,h]=E9(l),m=0,f=[u,p,d,h];for(let v of f){let g=0;for(let _=0;_<v;_++){let T=n+_+m;g+=e[T]}m+=v,t[a]=g*s,a++}return{octaveIndexTmp:a}}function xk(o,e){let t=0,r=1,n=o.length;for(let i=0;i<n;){let s=0;for(let a=0;a<r;a++)s+=o[i+a];e[t]=s,i+=r,r*=2,t++}}var tre={normalRange:!1,size:1024,smoothing:.8},bk=o=>{Qp.PARAM_CALLBACK_updateEffect(o)},Ak=[1e4,-1e4],Ck=class extends U{constructor(){super(...arguments);this.sizeExponent=y.INTEGER(10,{range:[4,14],rangeLocked:[!0,!0]}),this.arraySize=y.INTEGER("2**ch('sizeExponent')",{editable:!1}),this.smoothing=y.FLOAT(tre.smoothing,{range:[0,1],rangeLocked:[!0,!0],...La(bk)}),this.normalRange=y.BOOLEAN(1,La(bk)),this.asOctaves=y.BOOLEAN(0,{}),this.octaveDivisions=y.INTEGER(1,{range:[1,2],rangeLocked:[!0,!0],visibleIf:{asOctaves:1},separatorAfter:!0}),this.updateRangeParam=y.BOOLEAN(1,{cook:!1,callback:e=>{Qp.PARAM_CALLBACK_updateUpdateRangeParam(e)}}),this.range=y.VECTOR2([0,0],{visibleIf:{updateRangeParam:1},editable:!1,cook:!1}),this.maxRange=y.VECTOR2(Ak,{visibleIf:{updateRangeParam:1},editable:!1,cook:!1}),this.resetMaxRange=y.BUTTON(null,{visibleIf:{updateRangeParam:1},callback:e=>{Qp.PARAM_CALLBACK_resetMaxRange(e)}})}},rre=new Ck,Qp=class extends al{constructor(){super(...arguments);this.paramsConfig=rre}static type(){return wc.FFT}initializeNode(){this.io.inputs.setCount(1)}cook(e){let t=e[0];this._resetEffect();let r=this._effect();this._updateOnTickHook();let n=t.audioNode();n&&n.connect(r),t.setAudioNode(r),this.setAudioBuilder(t)}getAnalyserValue(){if(this.__effect__){let e=this.__effect__.getValue();if(this.pv.asOctaves){let t=this._octaveValues();return this._octaveDivisions()==1?xk(e,t):yk(e,t,this._octaveDivisions()),t}else return e}}_octaveDivisions(){return 2**(this.pv.octaveDivisions-1)}_octaveValues(){let e=this.pv.asOctaves?this.pv.sizeExponent*this._octaveDivisions():this.pv.sizeExponent;return this.__octaveValues&&this.__octaveValues.length!=e&&(this.__octaveValues=void 0),this.__octaveValues=this.__octaveValues||new Float32Array(e)}_effect(){return this.__effect__=this.__effect__||this._createEffect()}_createEffect(){return new Zp({size:this._FFTSize(),normalRange:this.pv.normalRange,smoothing:this.pv.smoothing})}_resetEffect(){this.__effect__&&(this.__effect__.dispose(),this.__effect__=void 0)}static PARAM_CALLBACK_updateEffect(e){e._updateEffect()}_updateEffect(){let e=this._effect();e.normalRange=this.pv.normalRange,e.smoothing=this.pv.smoothing}_FFTSize(){return 2**this.pv.sizeExponent}static PARAM_CALLBACK_updateUpdateRangeParam(e){e._updateRangeParam(),e._updateOnTickHook()}static PARAM_CALLBACK_resetMaxRange(e){e.p.maxRange.set(Ak)}_updateRangeParam(){if(!this.__effect__)return;let e=this.getAnalyserValue();if(!e)return;let t=Math.min(...e),r=Math.max(...e);this.p.range.set([t,r]),t<this.pv.maxRange.x&&K.isNumber(t)&&isFinite(t)&&this.p.maxRange.x.set(t),r>this.pv.maxRange.y&&K.isNumber(r)&&isFinite(r)&&this.p.maxRange.y.set(r)}_updateOnTickHook(){this.pv.updateRangeParam?this._registerOnTickHook():this._unRegisterOnTickHook()}async _registerOnTickHook(){this.scene().registeredBeforeTickCallbacks().has(this._tickCallbackName())||this.scene().registerOnBeforeTick(this._tickCallbackName(),this._updateRangeParam.bind(this))}async _unRegisterOnTickHook(){this.scene().unRegisterOnBeforeTick(this._tickCallbackName())}_tickCallbackName(){return`audio/FFT-${this.graphNodeId()}`}};var Ek=class extends fr{static context(){return oe.AUDIO}cook(){this.cookController.endCook()}},Sf=class extends Ek{};var cg=class extends Sf{constructor(){super(...arguments);this._childrenControllerContext=oe.COP}static type(){return uo.COP}createNode(e,t){return super.createNode(e,t)}children(){return super.children()}nodesByType(e){return super.nodesByType(e)}};var lg=class extends Sf{constructor(){super(...arguments);this._childrenControllerContext=oe.EVENT}static type(){return uo.EVENT}createNode(e,t){return super.createNode(e,t)}children(){return super.children()}nodesByType(e){return super.nodesByType(e)}};var Da=class extends js{constructor(){super(pe(Da.getDefaults(),arguments,["url","onload"]));this.name="ToneBufferSource",this._source=this.context.createBufferSource(),this._internalChannels=[this._source],this._sourceStarted=!1,this._sourceStopped=!1;let e=pe(Da.getDefaults(),arguments,["url","onload"]);gi(this._source,this._gainNode),this._source.onended=()=>this._stopSource(),this.playbackRate=new ft({context:this.context,param:this._source.playbackRate,units:"positive",value:e.playbackRate}),this.loop=e.loop,this.loopStart=e.loopStart,this.loopEnd=e.loopEnd,this._buffer=new zt(e.url,e.onload,e.onerror),this._internalChannels.push(this._source)}static getDefaults(){return Object.assign(js.getDefaults(),{url:new zt,loop:!1,loopEnd:0,loopStart:0,onload:gt,onerror:gt,playbackRate:1})}get fadeIn(){return this._fadeIn}set fadeIn(e){this._fadeIn=e}get fadeOut(){return this._fadeOut}set fadeOut(e){this._fadeOut=e}get curve(){return this._curve}set curve(e){this._curve=e}start(e,t,r,n=1){ze(this.buffer.loaded,"buffer is either not set or not loaded");let i=this.toSeconds(e);this._startGain(i,n),this.loop?t=C0(t,this.loopStart):t=C0(t,0);let s=Math.max(this.toSeconds(t),0);if(this.loop){let a=this.toSeconds(this.loopEnd)||this.buffer.duration,c=this.toSeconds(this.loopStart),l=a-c;gf(s,a)&&(s=(s-c)%l+c),en(s,this.buffer.duration)&&(s=0)}if(this._source.buffer=this.buffer.get(),this._source.loopEnd=this.toSeconds(this.loopEnd)||this.buffer.duration,y9(s,this.buffer.duration)&&(this._sourceStarted=!0,this._source.start(i,s)),$e(r)){let a=this.toSeconds(r);a=Math.max(a,0),this.stop(i+a)}return this}_stopSource(e){!this._sourceStopped&&this._sourceStarted&&(this._sourceStopped=!0,this._source.stop(this.toSeconds(e)),this._onended())}get loopStart(){return this._source.loopStart}set loopStart(e){this._source.loopStart=this.toSeconds(e)}get loopEnd(){return this._source.loopEnd}set loopEnd(e){this._source.loopEnd=this.toSeconds(e)}get buffer(){return this._buffer}set buffer(e){this._buffer.set(e)}get loop(){return this._source.loop}set loop(e){this._source.loop=e,this._sourceStarted&&this.cancelStop()}dispose(){return super.dispose(),this._source.onended=null,this._source.disconnect(),this._buffer.dispose(),this.playbackRate.dispose(),this}};var ka=class extends ur{constructor(){super(pe(ka.getDefaults(),arguments,["url","onload"]));this.name="Player",this._activeSources=new Set;let e=pe(ka.getDefaults(),arguments,["url","onload"]);this._buffer=new zt({onload:this._onload.bind(this,e.onload),onerror:e.onerror,reverse:e.reverse,url:e.url}),this.autostart=e.autostart,this._loop=e.loop,this._loopStart=e.loopStart,this._loopEnd=e.loopEnd,this._playbackRate=e.playbackRate,this.fadeIn=e.fadeIn,this.fadeOut=e.fadeOut}static getDefaults(){return Object.assign(ur.getDefaults(),{autostart:!1,fadeIn:0,fadeOut:0,loop:!1,loopEnd:0,loopStart:0,onload:gt,onerror:gt,playbackRate:1,reverse:!1})}load(e){return xt(this,void 0,void 0,function*(){return yield this._buffer.load(e),this._onload(),this})}_onload(e=gt){e(),this.autostart&&this.start()}_onSourceEnd(e){this.onstop(this),this._activeSources.delete(e),this._activeSources.size===0&&!this._synced&&this._state.getValueAtTime(this.now())==="started"&&(this._state.cancel(this.now()),this._state.setStateAtTime("stopped",this.now()))}start(e,t,r){return super.start(e,t,r),this}_start(e,t,r){this._loop?t=C0(t,this._loopStart):t=C0(t,0);let n=this.toSeconds(t),i=r;r=C0(r,Math.max(this._buffer.duration-n,0));let s=this.toSeconds(r);s=s/this._playbackRate,e=this.toSeconds(e);let a=new Da({url:this._buffer,context:this.context,fadeIn:this.fadeIn,fadeOut:this.fadeOut,loop:this._loop,loopEnd:this._loopEnd,loopStart:this._loopStart,onended:this._onSourceEnd.bind(this),playbackRate:this._playbackRate}).connect(this.output);!this._loop&&!this._synced&&(this._state.cancel(e+s),this._state.setStateAtTime("stopped",e+s,{implicitEnd:!0})),this._activeSources.add(a),this._loop&&eo(i)?a.start(e,n):a.start(e,n,s-this.toSeconds(this.fadeOut))}_stop(e){let t=this.toSeconds(e);this._activeSources.forEach(r=>r.stop(t))}restart(e,t,r){return super.restart(e,t,r),this}_restart(e,t,r){this._stop(e),this._start(e,t,r)}seek(e,t){let r=this.toSeconds(t);if(this._state.getValueAtTime(r)==="started"){let n=this.toSeconds(e);this._stop(r),this._start(r,n)}return this}setLoopPoints(e,t){return this.loopStart=e,this.loopEnd=t,this}get loopStart(){return this._loopStart}set loopStart(e){this._loopStart=e,this.buffer.loaded&&Uo(this.toSeconds(e),0,this.buffer.duration),this._activeSources.forEach(t=>{t.loopStart=e})}get loopEnd(){return this._loopEnd}set loopEnd(e){this._loopEnd=e,this.buffer.loaded&&Uo(this.toSeconds(e),0,this.buffer.duration),this._activeSources.forEach(t=>{t.loopEnd=e})}get buffer(){return this._buffer}set buffer(e){this._buffer.set(e)}get loop(){return this._loop}set loop(e){if(this._loop!==e&&(this._loop=e,this._activeSources.forEach(t=>{t.loop=e}),e)){let t=this._state.getNextState("stopped",this.now());t&&this._state.cancel(t.time)}}get playbackRate(){return this._playbackRate}set playbackRate(e){this._playbackRate=e;let t=this.now(),r=this._state.getNextState("stopped",t);r&&r.implicitEnd&&(this._state.cancel(r.time),this._activeSources.forEach(n=>n.cancelStop())),this._activeSources.forEach(n=>{n.playbackRate.setValueAtTime(e,t)})}get reverse(){return this._buffer.reverse}set reverse(e){this._buffer.reverse=e}get loaded(){return this._buffer.loaded}dispose(){return super.dispose(),this._activeSources.forEach(e=>e.dispose()),this._activeSources.clear(),this._buffer.dispose(),this}};Wn([vi(0)],ka.prototype,"fadeIn",void 0);Wn([vi(0)],ka.prototype,"fadeOut",void 0);function ore(){let o=new v1;return o.setURLModifier(e=>{let t=Q.assetUrls.remapedUrl(e);if(t)return t;let r=Q.blobs.blobUrl(e);return r||e}),o}var ed=ore(),Sk=class{constructor(o,e,t,r={}){this._url=o,this._scene=e,this._node=t,this.blobOptions=r,this.loadingManager=ed}static extension(o){let e=null;try{e=new URL(o).searchParams.get("ext")}catch{}if(!e){let r=o.split("?")[0].split(".");e=r[r.length-1].toLowerCase()}return e}extension(){return Sk.extension(this._url)}async _urlToLoad(){let o=this._url;return this._node&&await Q.blobs.fetchBlobForNode({fullUrl:o,node:this._node,multiAssetsForNode:this.blobOptions.multiAssetsForNode}),Q.blobs.blobUrl(o)||o}static async _loadMultipleBlobGlobal(o){let e=[];for(let r of o.files){let n=r.fullUrl;e.push(Q.blobs.fetchBlobGlobal(n))}let t=await Promise.all(e);if(o.node)for(let r of t)r.error&&o.node.states.error.set(o.error)}},Go=Sk;Go.loadingManager=ed;var S9,wk={getContext:function(){return S9===void 0&&(S9=new(window.AudioContext||window.webkitAudioContext)),S9},setContext:function(o){S9=o}};var Mk=class extends lo{constructor(e){super(e);this.manager=e}load(e,t,r,n){let i=this,s=new Xo(this.manager);s.setResponseType("arraybuffer"),s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,function(a){try{if(!(a instanceof ArrayBuffer)){n(new ErrorEvent("file content is not an ArrayBuffer"));return}let c=a.slice(0);wk.getContext().decodeAudioData(c,function(u){t(u)},function(u){n(new ErrorEvent("failed to decode file"))})}catch{n(new ErrorEvent("failed to decode file")),i.manager.itemError(e)}},r,n)}},wf=class extends Go{async load(){let e=new Mk(this.loadingManager),t=await this._urlToLoad();return new Promise((r,n)=>{let i=c=>{r(c)},s=c=>{},a=c=>{console.log("error:"),console.log(c),n()};e.load(t,i,s,a)})}};var nre={cook:!1,callback:o=>{xi.PARAM_CALLBACK_updateLoop(o)}},Nk=class extends U{constructor(){super(...arguments);this.url=y.STRING("",{fileBrowse:{type:[Oc.AUDIO]}}),this.autostart=y.BOOLEAN(1),this.duration=y.FLOAT(-1,{cook:!1,editable:!1}),this.updateCurrentTimeParam=y.BOOLEAN(0,{cook:!1,callback:e=>{xi.PARAM_CALLBACK_updateUpdateCurrentTimeParam(e)}}),this.currentTime=y.FLOAT(0,{visibleIf:{updateCurrentTimeParam:1},range:[0,100],editable:!1,cook:!1}),this.loop=y.BOOLEAN(1,{...nre}),this.play=y.BUTTON(null,{callback:e=>{xi.PARAM_CALLBACK_play(e)},hidden:!0}),this.pause=y.BUTTON(null,{callback:e=>{xi.PARAM_CALLBACK_pause(e)},hidden:!0}),this.restart=y.BUTTON(null,{callback:e=>{xi.PARAM_CALLBACK_restart(e)},hidden:!0}),this.seekM10=y.BUTTON(null,{callback:e=>{xi.PARAM_CALLBACK_seekOffset(e,-10)},hidden:!0}),this.seekM5=y.BUTTON(null,{callback:e=>{xi.PARAM_CALLBACK_seekOffset(e,-5)},hidden:!0}),this.seekP5=y.BUTTON(null,{callback:e=>{xi.PARAM_CALLBACK_seekOffset(e,5)},hidden:!0}),this.seekP10=y.BUTTON(null,{callback:e=>{xi.PARAM_CALLBACK_seekOffset(e,10)},hidden:!0})}},ire=new Nk,xi=class extends Zr{constructor(){super(...arguments);this.paramsConfig=ire,this._stoppedAt=0}static type(){return"file"}initializeNode(){this.io.inputs.setCount(0)}dispose(){super.dispose(),this._player&&(this.pause(),this._player.dispose()),Q.blobs.clearBlobsForNode(this)}async cook(e){if(await this._loadUrl(),this._updateOnTickHook(),this._player){let t=new Hn;t.setSource(this._player),this.setAudioBuilder(t)}else this.cookController.endCook()}async _loadUrl(){try{let t=await new wf(this.pv.url,this.scene(),this).load();return new Promise(r=>{this._player&&this._player.dispose(),this._player=new ka({url:t,loop:this.pv.loop,volume:0,onstop:()=>{this._runOnStopCallbacks()}}),this._reset(),this.p.duration.set(t.duration),this.pv.autostart&&this.play(),r(this._player)})}catch{this.states.error.set(`failed to load url '${this.pv.url}'`);return}}async play(){if(!this._player)return;let e=this.pv.updateCurrentTimeParam?this.pv.currentTime:this._currentTime(),t=Math.max(e,0);try{this._runOnBeforePlayCallbacks(t),this._player.start(0,t),this._runOnPlaySuccessCallbacks()}catch(r){console.error(r),this._runOnPlayErrorCallbacks(r)}this._startedAt=this._player.now()-this._stoppedAt,this._stoppedAt=0}async pause(){if(!this._player||this._startedAt==null)return;let e=this._player.now()-this._startedAt;this._player.stop(),this._stoppedAt=e}_reset(){this._stoppedAt=0,this._startedAt=void 0,this.p.currentTime.set(0)}async restart(){!this._player||(this._player.seek(0),this._reset(),this.play())}seekOffset(e){if(!this._player||this._startedAt==null)return;let t=this._currentTime();this._startedAt-=e,this._player.seek(t+e)}static PARAM_CALLBACK_updateUpdateCurrentTimeParam(e){e._updateCurrentTimeParam(),e._updateOnTickHook()}_updateCurrentTimeParam(){if(!this._player)return;let e=this._currentTime();this.p.currentTime.set(e)}_currentTime(){if(this._stoppedAt)return this._stoppedAt;if(this._player&&this._startedAt!=null){let e=this._player.now()-this._startedAt,t=this.pv.duration;return e>t&&(e-=t),e}return 0}static PARAM_CALLBACK_updateLoop(e){e._updateLoop()}_updateLoop(){!this._player||(this._player.loop=this.pv.loop)}_updateOnTickHook(){this.pv.updateCurrentTimeParam?this._registerOnTickHook():this._unRegisterOnTickHook()}async _registerOnTickHook(){this.scene().registeredBeforeTickCallbacks().has(this._tickCallbackName())||this.scene().registerOnBeforeTick(this._tickCallbackName(),this._updateCurrentTimeParam.bind(this))}async _unRegisterOnTickHook(){this.scene().unRegisterOnBeforeTick(this._tickCallbackName())}_tickCallbackName(){return`audio/File-${this.graphNodeId()}`}static PARAM_CALLBACK_seekOffset(e,t){e.seekOffset(t)}static PARAM_CALLBACK_play(e){e.play()}static PARAM_CALLBACK_pause(e){e.pause()}static PARAM_CALLBACK_restart(e){e.restart()}onBeforePlay(e){this._onBeforePlayCallbacks=this._onBeforePlayCallbacks||new Set,this._onBeforePlayCallbacks.add(e)}_runOnBeforePlayCallbacks(e){!this._onBeforePlayCallbacks||this._onBeforePlayCallbacks.forEach(t=>t(e))}onPlaySuccess(e){this._onPlaySuccessCallbacks=this._onPlaySuccessCallbacks||new Set,this._onPlaySuccessCallbacks.add(e)}_runOnPlaySuccessCallbacks(){!this._onPlaySuccessCallbacks||this._onPlaySuccessCallbacks.forEach(e=>e())}onPlayError(e){this._onPlayErrorCallbacks=this._onPlayErrorCallbacks||new Set,this._onPlayErrorCallbacks.add(e)}_runOnPlayErrorCallbacks(e){!this._onPlayErrorCallbacks||this._onPlayErrorCallbacks.forEach(t=>t(e))}onStop(e){this._onStopCallbacks=this._onStopCallbacks||new Set,this._onStopCallbacks.add(e)}_runOnStopCallbacks(){!this._onStopCallbacks||this._onStopCallbacks.forEach(e=>e())}};var td=class extends Ki{constructor(){super(pe(td.getDefaults(),arguments,["smoothing"]));this.name="Meter",this._rms=0;let e=pe(td.getDefaults(),arguments,["smoothing"]);this.input=this.output=this._analyser=new Ia({context:this.context,size:256,type:"waveform",channels:e.channels}),this.smoothing=e.smoothing,this.normalRange=e.normalRange}static getDefaults(){return Object.assign(Ki.getDefaults(),{smoothing:.8,normalRange:!1,channels:1})}getLevel(){return _f("'getLevel' has been changed to 'getValue'"),this.getValue()}getValue(){let e=this._analyser.getValue(),r=(this.channels===1?[e]:e).map(n=>{let i=n.reduce((a,c)=>a+c*c,0),s=Math.sqrt(i/n.length);return this._rms=Math.max(s,this._rms*this.smoothing),this.normalRange?this._rms:m9(this._rms)});return this.channels===1?r[0]:r}get channels(){return this._analyser.channels}dispose(){return super.dispose(),this._analyser.dispose(),this}};var sre={smoothing:.8},Ok=o=>{rd.PARAM_CALLBACK_updateEffect(o)},are=[1e4,-1e4],Pk=class extends U{constructor(){super(...arguments);this.smoothing=y.FLOAT(sre.smoothing,{range:[0,1],rangeLocked:[!0,!0],...La(Ok)}),this.normalRange=y.BOOLEAN(1,La(Ok)),this.updateRangeParam=y.BOOLEAN(1,{cook:!1,callback:e=>{rd.PARAM_CALLBACK_updateUpdateMeterParam(e)}}),this.value=y.FLOAT(0,{visibleIf:{updateRangeParam:1},range:[-100,100],editable:!1,cook:!1}),this.maxRange=y.VECTOR2([1e4,-1e4],{visibleIf:{updateRangeParam:1},editable:!1,cook:!1}),this.resetMaxRange=y.BUTTON(null,{visibleIf:{updateRangeParam:1},callback:e=>{rd.PARAM_CALLBACK_resetMaxRange(e)}})}},cre=new Pk,rd=class extends al{constructor(){super(...arguments);this.paramsConfig=cre,this._arrayValue=new Float32Array(1)}static type(){return wc.METER}initializeNode(){this.io.inputs.setCount(1)}cook(e){let t=e[0];this._resetEffect();let r=this._effect();this._updateOnTickHook();let n=t.audioNode();n&&n.connect(r),t.setAudioNode(r),this.setAudioBuilder(t)}getAnalyserValue(){if(this.__effect__){let e=this.__effect__.getValue();return K.isNumber(e)?(this._arrayValue[0]=e,this._arrayValue):e}}_effect(){return this.__effect__=this.__effect__||this._createEffect()}_createEffect(){return new td({smoothing:this.pv.smoothing,normalRange:this.pv.normalRange})}_resetEffect(){this.__effect__&&(this.__effect__.dispose(),this.__effect__=void 0)}static PARAM_CALLBACK_updateEffect(e){e._updateEffect()}_updateEffect(){let e=this._effect();e.normalRange=this.pv.normalRange,e.smoothing=this.pv.smoothing}static PARAM_CALLBACK_updateUpdateMeterParam(e){e._updateMeterParam(),e._updateOnTickHook()}static PARAM_CALLBACK_resetMaxRange(e){e.p.maxRange.set(are)}_updateMeterParam(){if(!this.__effect__)return;let e=this.getAnalyserValue();if(!e)return;let t=e[0];if(!isFinite(t))return;K.isNumber(t)&&this.p.value.set(t);let r=t;r<this.pv.maxRange.x?this.p.maxRange.x.set(r):r>this.pv.maxRange.y&&this.p.maxRange.y.set(r)}_updateOnTickHook(){this.pv.updateRangeParam?this._registerOnTickHook():this._unRegisterOnTickHook()}async _registerOnTickHook(){this.scene().registeredBeforeTickCallbacks().has(this._tickCallbackName())||this.scene().registerOnBeforeTick(this._tickCallbackName(),this._updateMeterParam.bind(this))}async _unRegisterOnTickHook(){this.scene().unRegisterOnBeforeTick(this._tickCallbackName())}_tickCallbackName(){return`audio/Meter-${this.graphNodeId()}`}};var Rk=class extends U{},lre=new Rk,ug=class extends Zr{constructor(){super(...arguments);this.paramsConfig=lre}static type(){return"null"}initializeNode(){this.io.inputs.setCount(1)}cook(e){let t=e[0];this.setAudioBuilder(t)}};var Ik="C1",Lk=["Cbb-4","Cb-4","C-4","C#-4","Cx-4","Dbb-4","Db-4","D-4","D#-4","Dx-4","Ebb-4","Eb-4","E-4","E#-4","Ex-4","Fbb-4","Fb-4","F-4","F#-4","Fx-4","Gbb-4","Gb-4","G-4","G#-4","Gx-4","Abb-4","Ab-4","A-4","A#-4","Ax-4","Bbb-4","Bb-4","B-4","B#-4","Bx-4","Cbb-3","Cb-3","C-3","C#-3","Cx-3","Dbb-3","Db-3","D-3","D#-3","Dx-3","Ebb-3","Eb-3","E-3","E#-3","Ex-3","Fbb-3","Fb-3","F-3","F#-3","Fx-3","Gbb-3","Gb-3","G-3","G#-3","Gx-3","Abb-3","Ab-3","A-3","A#-3","Ax-3","Bbb-3","Bb-3","B-3","B#-3","Bx-3","Cbb-2","Cb-2","C-2","C#-2","Cx-2","Dbb-2","Db-2","D-2","D#-2","Dx-2","Ebb-2","Eb-2","E-2","E#-2","Ex-2","Fbb-2","Fb-2","F-2","F#-2","Fx-2","Gbb-2","Gb-2","G-2","G#-2","Gx-2","Abb-2","Ab-2","A-2","A#-2","Ax-2","Bbb-2","Bb-2","B-2","B#-2","Bx-2","Cbb-1","Cb-1","C-1","C#-1","Cx-1","Dbb-1","Db-1","D-1","D#-1","Dx-1","Ebb-1","Eb-1","E-1","E#-1","Ex-1","Fbb-1","Fb-1","F-1","F#-1","Fx-1","Gbb-1","Gb-1","G-1","G#-1","Gx-1","Abb-1","Ab-1","A-1","A#-1","Ax-1","Bbb-1","Bb-1","B-1","B#-1","Bx-1","Cbb0","Cb0","C0","C#0","Cx0","Dbb0","Db0","D0","D#0","Dx0","Ebb0","Eb0","E0","E#0","Ex0","Fbb0","Fb0","F0","F#0","Fx0","Gbb0","Gb0","G0","G#0","Gx0","Abb0","Ab0","A0","A#0","Ax0","Bbb0","Bb0","B0","B#0","Bx0","Cbb1","Cb1","C1","C#1","Cx1","Dbb1","Db1","D1","D#1","Dx1","Ebb1","Eb1","E1","E#1","Ex1","Fbb1","Fb1","F1","F#1","Fx1","Gbb1","Gb1","G1","G#1","Gx1","Abb1","Ab1","A1","A#1","Ax1","Bbb1","Bb1","B1","B#1","Bx1","Cbb2","Cb2","C2","C#2","Cx2","Dbb2","Db2","D2","D#2","Dx2","Ebb2","Eb2","E2","E#2","Ex2","Fbb2","Fb2","F2","F#2","Fx2","Gbb2","Gb2","G2","G#2","Gx2","Abb2","Ab2","A2","A#2","Ax2","Bbb2","Bb2","B2","B#2","Bx2","Cbb3","Cb3","C3","C#3","Cx3","Dbb3","Db3","D3","D#3","Dx3","Ebb3","Eb3","E3","E#3","Ex3","Fbb3","Fb3","F3","F#3","Fx3","Gbb3","Gb3","G3","G#3","Gx3","Abb3","Ab3","A3","A#3","Ax3","Bbb3","Bb3","B3","B#3","Bx3","Cbb4","Cb4","C4","C#4","Cx4","Dbb4","Db4","D4","D#4","Dx4","Ebb4","Eb4","E4","E#4","Ex4","Fbb4","Fb4","F4","F#4","Fx4","Gbb4","Gb4","G4","G#4","Gx4","Abb4","Ab4","A4","A#4","Ax4","Bbb4","Bb4","B4","B#4","Bx4","Cbb5","Cb5","C5","C#5","Cx5","Dbb5","Db5","D5","D#5","Dx5","Ebb5","Eb5","E5","E#5","Ex5","Fbb5","Fb5","F5","F#5","Fx5","Gbb5","Gb5","G5","G#5","Gx5","Abb5","Ab5","A5","A#5","Ax5","Bbb5","Bb5","B5","B#5","Bx5","Cbb6","Cb6","C6","C#6","Cx6","Dbb6","Db6","D6","D#6","Dx6","Ebb6","Eb6","E6","E#6","Ex6","Fbb6","Fb6","F6","F#6","Fx6","Gbb6","Gb6","G6","G#6","Gx6","Abb6","Ab6","A6","A#6","Ax6","Bbb6","Bb6","B6","B#6","Bx6","Cbb7","Cb7","C7","C#7","Cx7","Dbb7","Db7","D7","D#7","Dx7","Ebb7","Eb7","E7","E#7","Ex7","Fbb7","Fb7","F7","F#7","Fx7","Gbb7","Gb7","G7","G#7","Gx7","Abb7","Ab7","A7","A#7","Ax7","Bbb7","Bb7","B7","B#7","Bx7","Cbb8","Cb8","C8","C#8","Cx8","Dbb8","Db8","D8","D#8","Dx8","Ebb8","Eb8","E8","E#8","Ex8","Fbb8","Fb8","F8","F#8","Fx8","Gbb8","Gb8","G8","G#8","Gx8","Abb8","Ab8","A8","A#8","Ax8","Bbb8","Bb8","B8","B#8","Bx8","Cbb9","Cb9","C9","C#9","Cx9","Dbb9","Db9","D9","D#9","Dx9","Ebb9","Eb9","E9","E#9","Ex9","Fbb9","Fb9","F9","F#9","Fx9","Gbb9","Gb9","G9","G#9","Gx9","Abb9","Ab9","A9","A#9","Ax9","Bbb9","Bb9","B9","B#9","Bx9","Cbb10","Cb10","C10","C#10","Cx10","Dbb10","Db10","D10","D#10","Dx10","Ebb10","Eb10","E10","E#10","Ex10","Fbb10","Fb10","F10","F#10","Fx10","Gbb10","Gb10","G10","G#10","Gx10","Abb10","Ab10","A10","A#10","Ax10","Bbb10","Bb10","B10","B#10","Bx10","Cbb11","Cb11","C11","C#11","Cx11","Dbb11","Db11","D11","D#11","Dx11","Ebb11","Eb11","E11","E#11","Ex11","Fbb11","Fb11","F11","F#11","Fx11","Gbb11","Gb11","G11","G#11","Gx11","Abb11","Ab11","A11","A#11","Ax11","Bbb11","Bb11","B11","B#11","Bx11"];var Dk=class extends U{constructor(){super(...arguments);this.note=y.STRING(Ik,{menuString:{entries:Lk.sort().map(e=>({value:e,name:e}))},cook:!1}),this.duration=y.FLOAT(.125,{range:[0,1],rangeLocked:[!0,!1],cook:!1}),this.showNotes=y.BOOLEAN(0,{separatorBefore:!0}),this.showKeys=y.BOOLEAN(0),this.startOctave=y.INTEGER(2,{range:[1,8],rangeLocked:[!1,!1]}),this.endOctave=y.INTEGER(4,{range:[1,8],rangeLocked:[!1,!1]}),this.updateNoteFromInstrument=y.BOOLEAN(0)}},ure=new Dk,pg=class extends Zr{constructor(){super(...arguments);this.paramsConfig=ure}static type(){return"playInstrument"}initializeNode(){this.io.inputs.setCount(1)}cook(e){let t=e[0];this.setAudioBuilder(t)}async play(){let e=await this._getInstrument();if(!e){console.log("no instrument");return}e.triggerAttackRelease(this.pv.note,this.pv.duration)}async _getInstrument(){this.isDirty()&&await this.compute();let e=this.containerController.container().coreContent();if(!!e)return e.instrument()}};var Mf=class extends mo{constructor(){super();this.name="ToneAudioBuffers",this._buffers=new Map,this._loadingCount=0;let e=pe(Mf.getDefaults(),arguments,["urls","onload","baseUrl"],"urls");this.baseUrl=e.baseUrl,Object.keys(e.urls).forEach(t=>{this._loadingCount++;let r=e.urls[t];this.add(t,r,this._bufferLoaded.bind(this,e.onload),e.onerror)})}static getDefaults(){return{baseUrl:"",onerror:gt,onload:gt,urls:{}}}has(e){return this._buffers.has(e.toString())}get(e){return ze(this.has(e),`ToneAudioBuffers has no buffer named: ${e}`),this._buffers.get(e.toString())}_bufferLoaded(e){this._loadingCount--,this._loadingCount===0&&e&&e()}get loaded(){return Array.from(this._buffers).every(([e,t])=>t.loaded)}add(e,t,r=gt,n=gt){return Eo(t)?this._buffers.set(e.toString(),new zt(this.baseUrl+t,r,n)):this._buffers.set(e.toString(),new zt(t,r,n)),this}dispose(){return super.dispose(),this._buffers.forEach(e=>e.dispose()),this._buffers.clear(),this}};var Ba=class extends Ws{constructor(){super(pe(Ba.getDefaults(),arguments,["urls","onload","baseUrl"],"urls"));this.name="Sampler",this._activeSources=new Map;let e=pe(Ba.getDefaults(),arguments,["urls","onload","baseUrl"],"urls"),t={};Object.keys(e.urls).forEach(r=>{let n=parseInt(r,10);if(ze(df(r)||jn(n)&&isFinite(n),`url key is neither a note or midi pitch: ${r}`),df(r)){let i=new tn(this.context,r).toMidi();t[i]=e.urls[r]}else jn(n)&&isFinite(n)&&(t[n]=e.urls[n])}),this._buffers=new Mf({urls:t,onload:e.onload,baseUrl:e.baseUrl,onerror:e.onerror}),this.attack=e.attack,this.release=e.release,this.curve=e.curve,this._buffers.loaded&&Promise.resolve().then(e.onload)}static getDefaults(){return Object.assign(Ws.getDefaults(),{attack:0,baseUrl:"",curve:"exponential",onload:gt,onerror:gt,release:.1,urls:{}})}_findClosest(e){let r=0;for(;r<96;){if(this._buffers.has(e+r))return-r;if(this._buffers.has(e-r))return r;r++}throw new Error(`No available buffers for note: ${e}`)}triggerAttack(e,t,r=1){return this.log("triggerAttack",e,t,r),Array.isArray(e)||(e=[e]),e.forEach(n=>{let i=Q7(new tn(this.context,n).toFrequency()),s=Math.round(i),a=i-s,c=this._findClosest(s),l=s-c,u=this._buffers.get(l),p=_9(c+a),d=new Da({url:u,context:this.context,curve:this.curve,fadeIn:this.attack,fadeOut:this.release,playbackRate:p}).connect(this.output);d.start(t,0,u.duration/p,r),fo(this._activeSources.get(s))||this._activeSources.set(s,[]),this._activeSources.get(s).push(d),d.onended=()=>{if(this._activeSources&&this._activeSources.has(s)){let h=this._activeSources.get(s),m=h.indexOf(d);m!==-1&&h.splice(m,1)}}}),this}triggerRelease(e,t){return this.log("triggerRelease",e,t),Array.isArray(e)||(e=[e]),e.forEach(r=>{let n=new tn(this.context,r).toMidi();if(this._activeSources.has(n)&&this._activeSources.get(n).length){let i=this._activeSources.get(n);t=this.toSeconds(t),i.forEach(s=>{s.stop(t)}),this._activeSources.set(n,[])}}),this}releaseAll(e){let t=this.toSeconds(e);return this._activeSources.forEach(r=>{for(;r.length;)r.shift().stop(t)}),this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",1)),this}triggerAttackRelease(e,t,r,n=1){let i=this.toSeconds(r);return this.triggerAttack(e,i,n),fo(t)?(ze(fo(e),"notes must be an array when duration is array"),e.forEach((s,a)=>{let c=t[Math.min(a,t.length-1)];this.triggerRelease(s,i+this.toSeconds(c))})):this.triggerRelease(e,i+this.toSeconds(t)),this}add(e,t,r){if(ze(df(e)||isFinite(e),`note must be a pitch or midi: ${e}`),df(e)){let n=new tn(this.context,e).toMidi();this._buffers.add(n,t,r)}else this._buffers.add(e,t,r);return this}get loaded(){return this._buffers.loaded}dispose(){return super.dispose(),this._buffers.dispose(),this._activeSources.forEach(e=>{e.forEach(t=>t.dispose())}),this._activeSources.clear(),this}};Wn([vi(0)],Ba.prototype,"attack",void 0);Wn([vi(0)],Ba.prototype,"release",void 0);var dg=class{static sanitize(e){return e.replace(/([^:])\/\//g,"$1/")}static urlParam(e){let t=window.location.search;return new URLSearchParams(t).get(e)}};var pre={attack:.01,release:1},dre={A0:"A0",C1:"C1","D#1":"Ds1","F#1":"Fs1",A1:"A1",C2:"C2","D#2":"Ds2","F#2":"Fs2",A2:"A2",C3:"C3","D#3":"Ds3","F#3":"Fs3",A3:"A3",C4:"C4","D#4":"Ds4","F#4":"Fs4",A4:"A4",C5:"C5","D#5":"Ds5","F#5":"Fs5",A5:"A5",C6:"C6","D#6":"Ds6","F#6":"Fs6",A6:"A6",C7:"C7","D#7":"Ds7","F#7":"Fs7",A7:"A7",C8:"C8"},kk=class extends U{constructor(){super(...arguments);this.urlsMap=y.STRING(JSON.stringify(dre,null,2),{multiline:!0,language:J5.JSON}),this.baseUrl=y.STRING("./"),this.extension=y.STRING("mp3")}},hre=new kk,hg=class extends Zr{constructor(){super(...arguments);this.paramsConfig=hre}static type(){return"sampler"}initializeNode(){this.io.inputs.setCount(1)}static displayedInputNames(){return["envelope"]}dispose(){super.dispose(),Q.blobs.clearBlobsForNode(this)}async cook(e){let r=e[0].envelopeParams()||pre,n={},i=[];try{let c=this.pv.extension;n=JSON.parse(this.pv.urlsMap);let l=Object.keys(n);for(let u of l){let p=n[u],d=`${this.pv.baseUrl}/${p}.${c}`;n[u]=dg.sanitize(d),i.push(d)}}catch{this.states.error.set("urlsMap is invalid JSON")}let s=i.map(c=>new wf(c,this.scene(),this,{multiAssetsForNode:!0}));await Promise.all(s.map(c=>c.load()));let a=new Ba({urls:n,attack:r.attack,release:r.release,baseUrl:"",onerror:c=>{this.states.error.set(c.message)},onload:()=>{let c=new Hn;c.setInstrument(a),this.setAudioBuilder(c)}})}};var Fa=class extends je{constructor(){super(pe(Fa.getDefaults(),arguments,["volume"]));this.name="UserMedia";let e=pe(Fa.getDefaults(),arguments,["volume"]);this._volume=this.output=new Cn({context:this.context,volume:e.volume}),this.volume=this._volume.volume,_t(this,"volume"),this.mute=e.mute}static getDefaults(){return Object.assign(je.getDefaults(),{mute:!1,volume:0})}open(e){return xt(this,void 0,void 0,function*(){ze(Fa.supported,"UserMedia is not supported"),this.state==="started"&&this.close();let t=yield Fa.enumerateDevices();jn(e)?this._device=t[e]:(this._device=t.find(i=>i.label===e||i.deviceId===e),!this._device&&t.length>0&&(this._device=t[0]),ze($e(this._device),`No matching device ${e}`));let r={audio:{echoCancellation:!1,sampleRate:this.context.sampleRate,noiseSuppression:!1,mozNoiseSuppression:!1}};this._device&&(r.audio.deviceId=this._device.deviceId);let n=yield navigator.mediaDevices.getUserMedia(r);if(!this._stream){this._stream=n;let i=this.context.createMediaStreamSource(n);gi(i,this.output),this._mediaStream=i}return this})}close(){return this._stream&&this._mediaStream&&(this._stream.getAudioTracks().forEach(e=>{e.stop()}),this._stream=void 0,this._mediaStream.disconnect(),this._mediaStream=void 0),this._device=void 0,this}static enumerateDevices(){return xt(this,void 0,void 0,function*(){return(yield navigator.mediaDevices.enumerateDevices()).filter(t=>t.kind==="audioinput")})}get state(){return this._stream&&this._stream.active?"started":"stopped"}get deviceId(){if(this._device)return this._device.deviceId}get groupId(){if(this._device)return this._device.groupId}get label(){if(this._device)return this._device.label}get mute(){return this._volume.mute}set mute(e){this._volume.mute=e}dispose(){return super.dispose(),this.close(),this._volume.dispose(),this.volume.dispose(),this}static get supported(){return $e(navigator.mediaDevices)&&$e(navigator.mediaDevices.getUserMedia)}};var Bk=class extends U{constructor(){super(...arguments);this.autostart=y.BOOLEAN(1),this.open=y.BUTTON(null,{callback:e=>{Nf.PARAM_CALLBACK_open(e)}}),this.close=y.BUTTON(null,{callback:e=>{Nf.PARAM_CALLBACK_close(e)}})}},fre=new Bk,Nf=class extends Zr{constructor(){super(...arguments);this.paramsConfig=fre}static type(){return"userMedia"}initializeNode(){this.io.inputs.setCount(0)}async cook(e){let t=new Hn,r=this._userMedia();this.pv.autostart&&await r.open(),t.setSource(r),this.setAudioBuilder(t)}_userMedia(){return this.__userMedia__=this.__userMedia__||this._createEffect()}_createEffect(){return new Fa}async open(){return await this._userMedia().open()}close(){this._userMedia().close()}static PARAM_CALLBACK_open(e){e.open()}static PARAM_CALLBACK_close(e){e.close()}};var mre={volume:0},_re=o=>{w9.PARAM_CALLBACK_updateEffect(o)},Fk=class extends U{constructor(){super(...arguments);this.volume=y.FLOAT(mre.volume,{range:[-20,20],rangeLocked:[!1,!1],...La(_re)})}},gre=new Fk,w9=class extends Zr{constructor(){super(...arguments);this.paramsConfig=gre}static type(){return"volume"}initializeNode(){this.io.inputs.setCount(1)}cook(e){let t=e[0],r=this._effect(),n=t.audioNode();n&&n.connect(r),t.setAudioNode(r),this.setAudioBuilder(t)}_effect(){return this.__effect__=this.__effect__||this._createEffect()}_createEffect(){return new Cn({volume:this.pv.volume})}static PARAM_CALLBACK_updateEffect(e){e._updateEffect()}_updateEffect(){this._effect().volume.linearRampToValueAtTime(this.pv.volume,"+1")}};var od=class extends Ki{constructor(){super(pe(od.getDefaults(),arguments,["size"]));this.name="Waveform";let e=pe(od.getDefaults(),arguments,["size"]);this._analyser.type="waveform",this.size=e.size}static getDefaults(){return Object.assign(Ki.getDefaults(),{size:1024})}getValue(){return this._analyser.getValue()}get size(){return this._analyser.size}set size(e){this._analyser.size=e}};var vre={size:1024,smoothing:.8},Uk=[1e4,-1e4],Vk=class extends U{constructor(){super(...arguments);this.sizeExponent=y.INTEGER(10,{range:[4,14],rangeLocked:[!0,!0]}),this.arraySize=y.INTEGER("2**ch('sizeExponent')",{editable:!1}),this.smoothing=y.FLOAT(vre.smoothing,{range:[0,1],rangeLocked:[!0,!0],cook:!1}),this.normalRange=y.BOOLEAN(1,{cook:!1}),this.updateRangeParam=y.BOOLEAN(1,{cook:!1,callback:e=>{Of.PARAM_CALLBACK_updateUpdateRangeParam(e)}}),this.range=y.VECTOR2([0,0],{visibleIf:{updateRangeParam:1},editable:!1,cook:!1}),this.maxRange=y.VECTOR2(Uk,{visibleIf:{updateRangeParam:1},editable:!1,cook:!1}),this.resetMaxRange=y.BUTTON(null,{visibleIf:{updateRangeParam:1},callback:e=>{Of.PARAM_CALLBACK_resetMaxRange(e)}})}},yre=new Vk,Of=class extends al{constructor(){super(...arguments);this.paramsConfig=yre}static type(){return wc.WAVEFORM}initializeNode(){this.io.inputs.setCount(1)}cook(e){let t=e[0];this._resetEffect();let r=this._effect();this._updateOnTickHook();let n=t.audioNode();n&&n.connect(r),t.setAudioNode(r),this.setAudioBuilder(t)}getAnalyserValue(){let e=this._getWaveFormValue();if(!e)return;let t=this._previousValue!=null&&e.length==this._previousValue.length?this._blendValue(e,this._previousValue):e;return(!this._previousValue||e.length!=this._previousValue.length)&&(this._previousValue=new Float32Array(e.length)),this._previousValue.set(e),t}_getWaveFormValue(){if(this.__effect__){let e=this.__effect__.getValue();return this.pv.normalRange?e.map(t=>Bp(t)):e}}_blendValue(e,t){let r=this.pv.smoothing;if(r==0)return e;if(r==1)return t;let n=e.length;for(let i=0;i<n;i++)e[i]=r*t[i]+(1-r)*e[i];return e}_effect(){return this.__effect__=this.__effect__||this._createEffect()}_createEffect(){return new od({size:this._effectSize()})}_resetEffect(){this.__effect__&&(this.__effect__.dispose(),this.__effect__=void 0)}_effectSize(){return 2**this.pv.sizeExponent}static PARAM_CALLBACK_updateUpdateRangeParam(e){e._updateRangeParam(),e._updateOnTickHook()}static PARAM_CALLBACK_resetMaxRange(e){e.p.maxRange.set(Uk)}_updateRangeParam(){if(!this.__effect__)return;let e=this.getAnalyserValue();if(!e)return;let t=Math.min(...e),r=Math.max(...e);this.p.range.set([t,r]),t<this.pv.maxRange.x&&K.isNumber(t)&&isFinite(t)&&this.p.maxRange.x.set(t),r>this.pv.maxRange.y&&K.isNumber(r)&&isFinite(r)&&this.p.maxRange.y.set(r)}_updateOnTickHook(){this.pv.updateRangeParam?this._registerOnTickHook():this._unRegisterOnTickHook()}async _registerOnTickHook(){this.scene().registeredBeforeTickCallbacks().has(this._tickCallbackName())||this.scene().registerOnBeforeTick(this._tickCallbackName(),this._updateRangeParam.bind(this))}async _unRegisterOnTickHook(){this.scene().unRegisterOnBeforeTick(this._tickCallbackName())}_tickCallbackName(){return`audio/FFT-${this.graphNodeId()}`}};var M9="input texture",xre=[M9,M9,M9,M9],fg=32,Gk=new Uint16Array(fg);for(N9=0;N9<fg;N9++)Gk[N9]=28898;var N9,bre=new Rr(Gk,fg,1,pu,qr),Ua=class extends fr{constructor(){super(...arguments);this.flags=new d5(this)}static context(){return oe.COP}static displayedInputNames(){return xre}initializeBaseNode(){this.io.outputs.setHasOneOutput()}setTexture(e){e.name=this.path(),this._setContainer(e)}_clearTexture(){this._setContainer(bre)}},mg=class extends Ua{};var Tre={R:0,G:1,B:2,A:3},zk=["R","G","B","A"],Are=2,Hk=1,O9=.04,jk=class extends U{constructor(){super(...arguments);this.activeR=y.BOOLEAN(0),this.audioNodeR=y.NODE_PATH("",{nodeSelection:{context:oe.AUDIO,types:ph},visibleIf:{activeR:1}}),this.rangeR=y.VECTOR2([0,1],{visibleIf:{activeR:1}}),this.speedMultR=y.FLOAT(O9,{visibleIf:{activeR:1},separatorAfter:!0}),this.activeG=y.BOOLEAN(0),this.audioNodeG=y.NODE_PATH("",{nodeSelection:{context:oe.AUDIO,types:ph},visibleIf:{activeG:1}}),this.rangeG=y.VECTOR2([0,1],{visibleIf:{activeG:1}}),this.speedMultG=y.FLOAT(O9,{visibleIf:{activeG:1},separatorAfter:!0}),this.activeB=y.BOOLEAN(0),this.audioNodeB=y.NODE_PATH("",{nodeSelection:{context:oe.AUDIO,types:ph},visibleIf:{activeB:1}}),this.rangeB=y.VECTOR2([0,1],{visibleIf:{activeB:1}}),this.speedMultB=y.FLOAT(O9,{visibleIf:{activeB:1},separatorAfter:!0}),this.activeA=y.BOOLEAN(0),this.audioNodeA=y.NODE_PATH("",{nodeSelection:{context:oe.AUDIO,types:ph},visibleIf:{activeA:1}}),this.rangeA=y.VECTOR2([0,1],{visibleIf:{activeA:1}}),this.speedMultA=y.FLOAT(O9,{visibleIf:{activeA:1},separatorAfter:!0})}},Cre=new jk,_g=class extends Ua{constructor(){super(...arguments);this.paramsConfig=Cre,this._audioNodesByChannel={},this._valuesByChannel={}}static type(){return"audioAnalyser"}async cook(){this._initParamsByChannel(),await this._getAudioNodes(),this._registerOnTickHook(),this._updateTexture(1),this.cookController.endCook()}dispose(){super.dispose(),this._unRegisterOnTickHook()}async _getAudioNodes(){let e=[this._getAudioNode("R"),this._getAudioNode("G"),this._getAudioNode("B"),this._getAudioNode("A")];await Promise.all(e)}async _getAudioNode(e){if(!this._paramSetByChannel)return;let t=this._paramSetByChannel[e];if(!t.active.value)return;let n=t.node.value.nodeWithContext(oe.AUDIO);if(!n){this.states.error.set("no audio analyser node found"),this.cookController.endCook();return}let i=n;!i.getAnalyserValue||(await n.compute(),this._audioNodesByChannel[e]=i)}_updateTexture(e){if(!this._paramSetByChannel)return;let t=-1;for(let r of zk){let n=this._valuesForChannel(r,this._paramSetByChannel[r]);if(this._valuesByChannel[r]=n,n){let i=n.length;t<i&&(t=i)}}if(this._dataTexture?this._dataTexture.image.width!=t&&this._createDataTexture(t):this._createDataTexture(t),!!this._dataTexture)for(let r of zk){let n=this._valuesByChannel[r];n&&this._updateTextureChannel(r,this._paramSetByChannel[r],n,this._dataTexture,e)}}_valuesForChannel(e,t){let r=this._audioNodesByChannel[e];if(!!r&&!!t.active.value)return r.getAnalyserValue()}async _updateTextureChannel(e,t,r,n,i){if(!this._dataTexture)return;let s=this._dataTexture.image.width,a=Tre[e],c=t.range.x.value,l=t.range.y.value,u=n.image.data,p=s*4,d=t.speedMult.value;for(let h=0;h<s;h++){let m=(r[h]-c)/(l-c),v=Math.max(0,Math.min(1,m))*Hk,g=h*4+a,_=u[g];u[g]=v;let T=d*(v-_)/i;u[p+g]=T}n.needsUpdate=!0}_createDataTexture(e){if(e<=0)return;let t=Are,r=e,n=r*t*4,i=new Float32Array(n);i.fill(0);for(let a=0;a<n;a++)i[a*4+3]=Hk;let s=new Rr(i,r,t,at,qt);s.minFilter=it,s.magFilter=it,this._dataTexture=s,this.setTexture(this._dataTexture)}_initParamsByChannel(){this._paramSetByChannel=this._paramSetByChannel||{R:{active:this.p.activeR,node:this.p.audioNodeR,range:this.p.rangeR,speedMult:this.p.speedMultR},G:{active:this.p.activeG,node:this.p.audioNodeG,range:this.p.rangeG,speedMult:this.p.speedMultG},B:{active:this.p.activeB,node:this.p.audioNodeB,range:this.p.rangeB,speedMult:this.p.speedMultB},A:{active:this.p.activeA,node:this.p.audioNodeA,range:this.p.rangeA,speedMult:this.p.speedMultA}}}async _registerOnTickHook(){this.scene().registeredBeforeTickCallbacks().has(this._tickCallbackName())||this.scene().registerOnBeforeTick(this._tickCallbackName(),this._updateTexture.bind(this))}async _unRegisterOnTickHook(){this.scene().unRegisterOnBeforeTick(this._tickCallbackName())}_tickCallbackName(){return`cop/audioAnalyserNode-${this.graphNodeId()}`}};var gg=class{static overlay(e,t){return new Promise((r,n)=>{let i=document.createElement("canvas");i.width=Math.max(e.width,t.width),i.height=Math.max(e.height,t.height);let s=i.getContext("2d");s.drawImage(e,0,0,e.width,e.height),s.drawImage(t,0,0,t.width,t.height);let a=i.toDataURL("image/png"),c=new Image;c.onload=()=>{r(c)},c.src=a})}static create_white_image(e,t){return new Promise((r,n)=>{let i=document.createElement("canvas");i.width=e,i.height=t;let s=i.getContext("2d");s.beginPath(),s.rect(0,0,e,t),s.fillStyle="white",s.fill();let a=i.toDataURL("image/png"),c=new Image;c.onload=()=>{r(c)},c.src=a})}static make_square(e){return new Promise((t,r)=>{let n=document.createElement("canvas"),i=Math.min(e.width,e.height),s=e.width/e.height;n.width=i,n.height=i;let a=n.getContext("2d"),c=s>1,l=c?(e.width-i)/2:(e.height-i)/2;c?a.drawImage(e,l,0,i,i,0,0,i,i):a.drawImage(e,0,l,i,i,0,0,i,i);let u=n.toDataURL("image/png"),p=new Image;p.onload=()=>{t(p)},p.src=u})}static async image_to_blob(e){return new Promise(function(t,r){try{let n=new XMLHttpRequest;n.open("GET",e.src),n.responseType="blob",n.onerror=function(){r("Network error.")},n.onload=function(){n.status===200?t(n.response):r("Loading error:"+n.statusText)},n.send()}catch(n){r(n.message)}})}static data_from_url(e){return new Promise((t,r)=>{let n=new Image;n.crossOrigin="Anonymous",n.onload=()=>{let i=this.data_from_image(n);t(i)},n.src=e})}static data_from_image(e){let t=document.createElement("canvas");t.width=e.width,t.height=e.height;let r=t.getContext("2d");return r.drawImage(e,0,0,e.width,e.height),r.getImageData(0,0,e.width,e.height)}};var vg=(o=>(o.Uint8Array="Uint8Array",o.Uint8ClampedArray="Uint8ClampedArray",o.Float32Array="Float32Array",o))(vg||{}),yg=class{constructor(e){this.buffer_type=e}from_render_target(e,t){return(!this._data_texture||!this._same_dimensions(t.texture))&&(this._data_texture=this._create_data_texture(t.texture)),this._copy_to_data_texture(e,t),this._data_texture}from_texture(e){let t=gg.data_from_image(e.image);(!this._data_texture||!this._same_dimensions(e))&&(this._data_texture=this._create_data_texture(e));let r=t.width*t.height,n=t.data,i=this._data_texture.image.data,a=r*4;for(let c=0;c<a;c++)i[c]=n[c];return this._data_texture}get data_texture(){return this._data_texture}reset(){this._data_texture=void 0}_copy_to_data_texture(e,t){let r=t.texture.image;this._data_texture=this._data_texture||this._create_data_texture(t.texture),e.readRenderTargetPixels(t,0,0,r.width,r.height,this._data_texture.image.data),this._data_texture.needsUpdate=!0}_create_data_texture(e){let t=e.image,r=this._create_pixel_buffer(t.width,t.height);return new Rr(r,t.width,t.height,e.format,e.type,e.mapping,e.wrapS,e.wrapT,e.magFilter,e.minFilter,e.anisotropy,e.encoding)}_create_pixel_buffer(e,t){let r=e*t*4;switch(this.buffer_type){case"Uint8Array":return new Uint8Array(r);case"Uint8ClampedArray":return new Uint8ClampedArray(r);case"Float32Array":return new Float32Array(r)}Be.unreachable(this.buffer_type)}_same_dimensions(e){if(this._data_texture){let t=this._data_texture.image.width==e.image.width,r=this._data_texture.image.height==e.image.height;return t&&r}else return!0}};var Wk=class extends U{},bit=new Wk;var Pf=class{constructor(e){this.node=e}async renderer(){return await this.cameraRenderer()}reset(){var e;(e=this._renderer)==null||e.dispose(),this._renderer=void 0}async cameraRenderer(){let e=await Q.renderersController.waitForRenderer();return e||await Q.renderersController.waitForRenderer()}saveState(){this._makeLinear()}_makeLinear(){}restoreState(){}};var qk=["reflection","refraction"],Xk=class extends U{constructor(){super(...arguments);this.useCameraRenderer=y.BOOLEAN(1),this.mode=y.INTEGER(0,{menu:{entries:qk.map((e,t)=>({name:e,value:t}))}})}},Ere=new Xk,xg=class extends Ua{constructor(){super(...arguments);this.paramsConfig=Ere}static type(){return"envMap"}initializeNode(){this.io.inputs.setCount(1),this.io.inputs.initInputsClonedState(ke.NEVER)}async cook(e){let t=e[0];this.convert_texture_to_env_map(t)}async convert_texture_to_env_map(e){this._renderer_controller=this._renderer_controller||new Pf(this);let t=await this._renderer_controller.renderer();if(t){let n=new Tu(t).fromEquirectangular(e);if(this.pv.useCameraRenderer)this._set_mapping(n.texture),this.setTexture(n.texture);else{this._data_texture_controller=this._data_texture_controller||new yg(vg.Uint8Array);let i=this._data_texture_controller.from_render_target(t,n);this._set_mapping(i),this.setTexture(i)}}else this.states.error.set("no renderer found to convert the texture to an env map"),this.cookController.endCook()}_set_mapping(e){qk[this.pv.mode]=="reflection"?e.mapping=dn:e.mapping=Pi}};var P9=class extends vr{constructor(e,t,r,n,i,s,a,c,l){super(e,t,r,n,i,s,a,c,l);this.minFilter=s!==void 0?s:lt,this.magFilter=i!==void 0?i:lt,this.generateMipmaps=!1;let u=this;function p(){u.needsUpdate=!0,e.requestVideoFrameCallback(p)}"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(p)}clone(){return new this.constructor(this.image).copy(this)}update(){let e=this.image;"requestVideoFrameCallback"in e===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}};P9.prototype.isVideoTexture=!0;var nd=class extends lo{constructor(e){super(e)}load(e,t,r,n){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);let i=this,s=mu.get(e);if(s!==void 0)return i.manager.itemStart(e),setTimeout(function(){t&&t(s),i.manager.itemEnd(e)},0),s;let a=fu("img");function c(){u(),mu.add(e,this),t&&t(this),i.manager.itemEnd(e)}function l(p){u(),n&&n(p),i.manager.itemError(e),i.manager.itemEnd(e)}function u(){a.removeEventListener("load",c,!1),a.removeEventListener("error",l,!1)}return a.addEventListener("load",c,!1),a.addEventListener("error",l,!1),e.substr(0,5)!=="data:"&&this.crossOrigin!==void 0&&(a.crossOrigin=this.crossOrigin),i.manager.itemStart(e),a.src=e,a}};var Rf=class extends lo{constructor(e){super(e)}load(e,t,r,n){let i=new vr,s=new nd(this.manager);return s.setCrossOrigin(this.crossOrigin),s.setPath(this.path),s.load(e,function(a){i.image=a,i.needsUpdate=!0,t!==void 0&&t(i)},r,n),i}};var pt=(o=>(o.DRACOLoader="DRACOLoader",o.EXRLoader="EXRLoader",o.FBXLoader="FBXLoader",o.GLTFLoader="GLTFLoader",o.KTX2Loader="KTX2Loader",o.LDrawLoader="LDrawLoader",o.OBJLoader="OBJLoader",o.PDBLoader="PDBLoader",o.PLYLoader="PLYLoader",o.RGBELoader="RGBELoader",o.SVGLoader="SVGLoader",o.STLLoader="STLLoader",o.TTFLoader="TTFLoader",o))(pt||{});var If="https://raw.githubusercontent.com/polygonjs/polygonjs-assets/master/";var Yk=["mp4","ogv","ogg"],Va=(o=>(o.JPG="jpg",o.JPEG="jpeg",o.PNG="png",o.EXR="exr",o.KTX2="ktx2",o.HDR="hdr",o))(Va||{}),bg=["jpeg","jpg","png","exr","ktx2","hdr"];function Sre(o){let t=o.split("?")[0].split(".");return t[t.length-1]}function $k(o){return bg.includes(Sre(o).toLowerCase())}var ro=class extends Go{constructor(o,e,t,r,n){super(o,r,t);this._param=e,this._node=t,this._scene=r,this._forceVideo=!1,this._forceImage=!1,this._forceVideo=(n==null?void 0:n.forceVideo)||this._forceVideo,this._forceImage=(n==null?void 0:n.forceImage)||this._forceImage}static onTextureLoaded(o){this._onTextureLoadedCallback=o}async load_texture_from_url_or_op(o){this._node&&Q.blobs.clearBlobsForNode(this._node);let e=null,t=null;if(this._url.substring(0,3)=="op:"){let r=this._url.substring(3);t=ut.findNode(this._node,r),t?t instanceof mg?e=(await t.compute()).texture():this._node.states.error.set("found node is not a texture node"):this._node.states.error.set(`no node found in path '${r}'`)}else e=await this._loadUrl(o),e||this._node.states.error.set(`could not load texture ${this._url}`);return t&&this._param.graphPredecessors()[0]!=t&&(this._param.graphDisconnectPredecessors(),this._param.addGraphInput(t)),e}async _loadUrl(o){return new Promise(async(e,t)=>{let r=this.extension(),n=await this._urlToLoad();if(this._forceVideo||Yk.includes(r)){let i=await this._loadVideo(n);e(i)}else if(this._forceImage||bg.includes(r))try{let i=await this._loadImage(n,o);e(i)}catch{t()}})}_loadImage(o,e){return new Promise(async(t,r)=>{let n=this.extension();this.loader_for_ext(n,e).then(async i=>{i?(ro.incrementInProgressLoadsCount(),await ro.waitForMaxConcurrentLoadsQueueFreed(),i.load(o,s=>{ro.decrementInProgressLoadsCount();let a=ro._onTextureLoadedCallback;a&&a(o,s),t(s)},void 0,s=>{ro.decrementInProgressLoadsCount(),Q.warn("error",s),r()})):r()})})}_loadVideo(o){return new Promise(async(e,t)=>{ro.incrementInProgressLoadsCount(),await ro.waitForMaxConcurrentLoadsQueueFreed();let r=document.createElement("video");r.setAttribute("crossOrigin","anonymous"),r.setAttribute("autoplay",`${!0}`),r.setAttribute("loop",`${!0}`),r.onloadedmetadata=function(){r.pause();let u=new P9(r);ro.decrementInProgressLoadsCount();let p=ro._onTextureLoadedCallback;p&&p(o,u),e(u)};let n=document.createElement("source"),i=Go.extension(o),s=ro.VIDEO_SOURCE_TYPE_BY_EXT[i];s=s||ro._default_video_source_type(o),n.setAttribute("type",s),n.setAttribute("src",o),r.appendChild(n);let a;i=="mp4"?a=ro.replaceExtension(o,"ogv"):a=ro.replaceExtension(o,"mp4");let c=document.createElement("source"),l=Go.extension(a);s=ro.VIDEO_SOURCE_TYPE_BY_EXT[l],s=s||ro._default_video_source_type(o),c.setAttribute("type",s),c.setAttribute("src",o),r.appendChild(c)})}static module_names(o){switch(o){case Va.EXR:return[pt.EXRLoader];case Va.HDR:return[pt.RGBELoader];case Va.KTX2:return[pt.KTX2Loader]}}async loader_for_ext(o,e){switch(o.toLowerCase()){case Va.EXR:return await this._exr_loader(e);case Va.HDR:return await this._hdr_loader(e);case Va.KTX2:return await ro._KTX2loader(this._node)}return new Rf(this.loadingManager)}async _exr_loader(o){let e=await Q.modulesRegister.module(pt.EXRLoader);if(e){let t=new e(this.loadingManager);return o.tdataType&&t.setDataType(o.dataType),t}}async _hdr_loader(o){let e=await Q.modulesRegister.module(pt.RGBELoader);if(e){let t=new e(this.loadingManager);return o.tdataType&&t.setDataType(o.dataType),t}}static async _KTX2loader(o){let e=await Q.modulesRegister.module(pt.KTX2Loader);if(e){let t=new e(this.loadingManager),r=Q.libs.root(),n=Q.libs.KTX2Path();if(r||n){let s=`${r||""}${n||""}/`;if(o){let a=["basis_transcoder.js","basis_transcoder.wasm"];await this._loadMultipleBlobGlobal({files:a.map(c=>({fullUrl:`${s}${c}`})),node:o,error:"failed to load basis libraries. Make sure to install them to load .basis files"})}t.setTranscoderPath(s)}else t.setTranscoderPath(void 0);let i=await Q.renderersController.waitForRenderer();return i?t.detectSupport(i):Q.warn("texture loader found no renderer for KTX2Loader"),t}}static _default_video_source_type(o){return`video/${Go.extension(o)}`}static pixel_data(o){let e=o.image,t=document.createElement("canvas");t.width=e.width,t.height=e.height;let r=t.getContext("2d");if(r)return r.drawImage(e,0,0,e.width,e.height),r.getImageData(0,0,e.width,e.height)}static replaceExtension(o,e){let t=o.split("?"),n=t[0].split(".");return n.pop(),n.push(e),[n.join("."),t[1]].join("?")}static setMaxConcurrentLoadsCount(o){this._maxConcurrentLoadsCountMethod=o}static _init_max_concurrent_loads_count(){return this._maxConcurrentLoadsCountMethod?this._maxConcurrentLoadsCountMethod():Un.isChrome()?10:4}static _init_concurrent_loads_delay(){return Un.isChrome()?0:10}static incrementInProgressLoadsCount(){this.in_progress_loads_count++}static decrementInProgressLoadsCount(){this.in_progress_loads_count--;let o=this._queue.pop();if(o){let e=this.CONCURRENT_LOADS_DELAY;setTimeout(()=>{o()},e)}}static async waitForMaxConcurrentLoadsQueueFreed(){if(!(this.in_progress_loads_count<=this.MAX_CONCURRENT_LOADS_COUNT))return new Promise(o=>{this._queue.push(o)})}},Ji=ro;Ji.PARAM_DEFAULT=`${If}/textures/uv.jpg`;Ji.PARAM_ENV_DEFAULT=`${If}/textures/piz_compressed.exr`;Ji.VIDEO_SOURCE_TYPE_BY_EXT={ogg:'video/ogg; codecs="theora, vorbis"',ogv:'video/ogg; codecs="theora, vorbis"',mp4:'video/mp4; codecs="avc1.42E01E, mp4a.40.2"'};Ji.MAX_CONCURRENT_LOADS_COUNT=ro._init_max_concurrent_loads_count();Ji.CONCURRENT_LOADS_DELAY=ro._init_concurrent_loads_delay();Ji.in_progress_loads_count=0;Ji._queue=[];var R9=[{LinearFilter:lt},{NearestFilter:it}],I9=[{NearestFilter:it},{NearestMipMapNearestFilter:$x},{NearestMipMapLinearFilter:Kx},{LinearFilter:lt},{LinearMipMapNearestFilter:Jx},{LinearMipMapLinearFilter:Zx}],Kk=Object.values(R9[0])[0],Jk=Object.values(I9[5])[0],Zk=R9.map(o=>({name:Object.keys(o)[0],value:Object.values(o)[0]})),Qk=I9.map(o=>({name:Object.keys(o)[0],value:Object.values(o)[0]}));var L9=[{LinearEncoding:Xr},{sRGBEncoding:bt},{BasicDepthPacking:h1},{RGBADepthPacking:f1}],wre={};for(let o of L9){let e=Object.keys(o)[0],t=Object.values(o)[0];wre[`${t}`]=e}var D9=[{ClampToEdgeWrapping:Ft},{RepeatWrapping:Zn},{MirroredRepeatWrapping:j0}];var Tg=[{UVMapping:Oi},{CubeReflectionMapping:pn},{CubeRefractionMapping:Sn},{EquirectangularReflectionMapping:n0},{EquirectangularRefractionMapping:i0},{CubeUVReflectionMapping:dn},{CubeUVRefractionMapping:Pi}];var eB=[{UnsignedByteType:Wo},{ByteType:Km},{ShortType:Jm},{UnsignedShortType:Ii},{IntType:Zm},{UnsignedIntType:W0},{FloatType:qt},{HalfFloatType:qr},{UnsignedShort4444Type:Qm},{UnsignedShort5551Type:e1},{UnsignedInt248Type:Qn}];var tB=[{AlphaFormat:t1},{RedFormat:o1},{RedIntegerFormat:n1},{RGFormat:i1},{RGIntegerFormat:s1},{RGBAFormat:at},{RGBAIntegerFormat:a1},{LuminanceFormat:pu},{LuminanceAlphaFormat:r1},{DepthFormat:wn},{DepthStencilFormat:ei}];function Ti(o){return{cook:!1,callback:e=>{Df[o](e)}}}var bi={ENCODING:Xr,FORMAT:at,MAPPING:Oi,MIN_FILTER:lt,MAG_FILTER:lt,TYPE:Wo,WRAPPING:Zn},rB=Ti("PARAM_CALLBACK_update_encoding"),oB=Ti("PARAM_CALLBACK_update_mapping"),Ag=Ti("PARAM_CALLBACK_update_wrap"),k9=Ti("PARAM_CALLBACK_update_filter"),Cg=Ti("PARAM_CALLBACK_update_anisotropy"),nB=Ti("PARAM_CALLBACK_update_flipY"),Mre=Ti("PARAM_CALLBACK_update_transform"),Nre=Ti("PARAM_CALLBACK_update_repeat"),Ore=Ti("PARAM_CALLBACK_update_offset"),Pre=Ti("PARAM_CALLBACK_update_rotation"),Rre=Ti("PARAM_CALLBACK_update_center"),Lf=Ti("PARAM_CALLBACK_update_advanced");function Eg(o,e){return class extends o{constructor(){super(...arguments);this.tencoding=y.BOOLEAN((e==null?void 0:e.tencoding)||0,{...rB}),this.encoding=y.INTEGER((e==null?void 0:e.encoding)||bi.ENCODING,{visibleIf:{tencoding:1},menu:{entries:L9.map(r=>({name:Object.keys(r)[0],value:Object.values(r)[0]}))},...rB}),this.tmapping=y.BOOLEAN(0,{...oB}),this.mapping=y.INTEGER(bi.MAPPING,{visibleIf:{tmapping:1},menu:{entries:Tg.map(r=>({name:Object.keys(r)[0],value:Object.values(r)[0]}))},...oB}),this.twrap=y.BOOLEAN(0,{...Ag}),this.wrapS=y.INTEGER(bi.WRAPPING,{visibleIf:{twrap:1},menu:{entries:D9.map(r=>({name:Object.keys(r)[0],value:Object.values(r)[0]}))},...Ag}),this.wrapT=y.INTEGER(bi.WRAPPING,{visibleIf:{twrap:1},menu:{entries:D9.map(r=>({name:Object.keys(r)[0],value:Object.values(r)[0]}))},separatorAfter:!0,...Ag}),this.tminFilter=y.BOOLEAN(0,{...k9}),this.minFilter=y.INTEGER(Jk,{visibleIf:{tminFilter:1},menu:{entries:Qk},...k9}),this.tmagFilter=y.BOOLEAN(0,{...k9}),this.magFilter=y.INTEGER(Kk,{visibleIf:{tmagFilter:1},menu:{entries:Zk},...k9}),this.tanisotropy=y.BOOLEAN(0,{...Cg}),this.useRendererMaxAnisotropy=y.BOOLEAN(0,{visibleIf:{tanisotropy:1},...Cg}),this.anisotropy=y.INTEGER(2,{visibleIf:{tanisotropy:1,useRendererMaxAnisotropy:0},range:[0,32],rangeLocked:[!0,!1],...Cg}),this.tflipY=y.BOOLEAN(0,{...nB}),this.flipY=y.BOOLEAN(0,{visibleIf:{tflipY:1},...nB}),this.ttransform=y.BOOLEAN(0,{...Mre}),this.offset=y.VECTOR2([0,0],{visibleIf:{ttransform:1},...Ore}),this.repeat=y.VECTOR2([1,1],{visibleIf:{ttransform:1},...Nre}),this.rotation=y.FLOAT(0,{range:[-1,1],visibleIf:{ttransform:1},...Pre}),this.center=y.VECTOR2([0,0],{visibleIf:{ttransform:1},...Rre}),this.tadvanced=y.BOOLEAN(0,{...Lf}),this.tformat=y.BOOLEAN(0,{visibleIf:{tadvanced:1},...Lf}),this.format=y.INTEGER(bi.FORMAT,{visibleIf:{tadvanced:1,tformat:1},menu:{entries:tB.map(r=>({name:Object.keys(r)[0],value:Object.values(r)[0]}))},...Lf}),this.ttype=y.BOOLEAN(0,{visibleIf:{tadvanced:1},...Lf}),this.type=y.INTEGER(bi.TYPE,{visibleIf:{tadvanced:1,ttype:1},menu:{entries:eB.map(r=>({name:Object.keys(r)[0],value:Object.values(r)[0]}))},...Lf})}}}var iB=class extends Eg(U){},Cst=new iB;var Df=class{constructor(e){this.node=e}async update(e){let t=this.node.pv;this._updateEncoding(e,t),this._updateAdvanced(e,t),this._updateMapping(e,t),this._updateWrap(e,t),this._updateFilter(e,t),this._updateFlip(e,t),await this._updateAnisotropy(e,t),this._updateTransform(e)}_updateEncoding(e,t){t.tencoding?e.encoding=t.encoding:e.encoding=bi.ENCODING,e.needsUpdate=!0}_updateAdvanced(e,t){t.tadvanced&&(t.tformat?e.format=t.format:e.format=bi.FORMAT,t.ttype?e.type=t.type:e.type=bi.TYPE),e.needsUpdate=!0}_updateMapping(e,t){t.tmapping?e.mapping=t.mapping:e.mapping=bi.MAPPING,e.needsUpdate=!0}_updateWrap(e,t){t.twrap?(e.wrapS=t.wrapS,e.wrapT=t.wrapT):(e.wrapS=bi.WRAPPING,e.wrapT=bi.WRAPPING),e.needsUpdate=!0}_updateFilter(e,t){t.tminFilter?e.minFilter=t.minFilter:e.minFilter=lt,t.tmagFilter?e.magFilter=t.magFilter:e.magFilter=lt,e.needsUpdate=!0}_updateFlip(e,t){e.flipY=t.tflipY&&t.flipY,e.needsUpdate=!0}async _updateAnisotropy(e,t){if(!t.tanisotropy){e.anisotropy=1;return}if(t.useRendererMaxAnisotropy)e.anisotropy=await this._maxRendererAnisotropy();else{let r=t.anisotropy;r<=2?e.anisotropy=r:e.anisotropy=Math.min(r,await this._maxRendererAnisotropy())}e.needsUpdate=!0}async _maxRendererAnisotropy(){return this._renderer_controller=this._renderer_controller||new Pf(this.node),(await this._renderer_controller.renderer()).capabilities.getMaxAnisotropy()}_updateTransform(e){if(!this.node.pv.ttransform){e.offset.set(0,0),e.rotation=0,e.repeat.set(1,1),e.center.set(0,0);return}this._updateTransformOffset(e,!1),this._updateTransformRepeat(e,!1),this._updateTransformRotation(e,!1),this._updateTransformCenter(e,!1),e.updateMatrix()}async _updateTransformOffset(e,t){e.offset.copy(this.node.pv.offset),t&&e.updateMatrix()}async _updateTransformRepeat(e,t){e.repeat.copy(this.node.pv.repeat),t&&e.updateMatrix()}async _updateTransformRotation(e,t){e.rotation=this.node.pv.rotation,t&&e.updateMatrix()}async _updateTransformCenter(e,t){e.center.copy(this.node.pv.center),t&&e.updateMatrix()}static PARAM_CALLBACK_update_encoding(e){let t=e.containerController.container().texture();!t||e.textureParamsController._updateEncoding(t,e.pv)}static PARAM_CALLBACK_update_mapping(e){let t=e.containerController.container().texture();!t||e.textureParamsController._updateMapping(t,e.pv)}static PARAM_CALLBACK_update_wrap(e){let t=e.containerController.container().texture();!t||e.textureParamsController._updateWrap(t,e.pv)}static PARAM_CALLBACK_update_filter(e){let t=e.containerController.container().texture();!t||e.textureParamsController._updateFilter(t,e.pv)}static PARAM_CALLBACK_update_anisotropy(e){let t=e.containerController.container().texture();!t||e.textureParamsController._updateAnisotropy(t,e.pv)}static PARAM_CALLBACK_update_flipY(e){let t=e.containerController.container().texture();!t||e.textureParamsController._updateFlip(t,e.pv)}static PARAM_CALLBACK_update_transform(e){let t=e.containerController.container().texture();!t||e.textureParamsController._updateTransform(t)}static PARAM_CALLBACK_update_offset(e){let t=e.containerController.container().texture();!t||e.textureParamsController._updateTransformOffset(t,!0)}static PARAM_CALLBACK_update_repeat(e){let t=e.containerController.container().texture();!t||e.textureParamsController._updateTransformRepeat(t,!0)}static PARAM_CALLBACK_update_rotation(e){let t=e.containerController.container().texture();!t||e.textureParamsController._updateTransformRotation(t,!0)}static PARAM_CALLBACK_update_center(e){let t=e.containerController.container().texture();!t||e.textureParamsController._updateTransformCenter(t,!0)}static PARAM_CALLBACK_update_advanced(e){let t=e.containerController.container().texture();!t||e.textureParamsController._updateAdvanced(t,e.pv)}static copyTextureAttributes(e,t){e.encoding=t.encoding,e.mapping=t.mapping,e.wrapS=t.wrapS,e.wrapT=t.wrapT,e.minFilter=t.minFilter,e.magFilter=t.magFilter,e.magFilter=t.magFilter,e.anisotropy=t.anisotropy,e.flipY=t.flipY,e.repeat.copy(t.repeat),e.offset.copy(t.offset),e.center.copy(t.center),e.rotation=t.rotation,e.type=t.type,e.format=t.format,e.needsUpdate=!0}paramLabelsParams(){let e=this.node.p;return[e.tencoding,e.encoding,e.tmapping,e.mapping,e.twrap,e.wrapS,e.wrapT,e.tminFilter,e.minFilter,e.tmagFilter,e.magFilter,e.tflipY,e.flipY]}paramLabels(){let e=[],t=this.node.pv;if(t.tencoding)for(let r of L9){let n=Object.keys(r)[0];r[n]==t.encoding&&e.push(`encoding: ${n}`)}if(t.tmapping)for(let r of Tg){let n=Object.keys(r)[0];r[n]==t.mapping&&e.push(`mapping: ${n}`)}if(t.twrap){let r=function(n){for(let i of D9){let s=Object.keys(i)[0];i[s]==t[n]&&e.push(`${n}: ${s}`)}};r("wrapS"),r("wrapT")}if(t.tminFilter)for(let r of I9){let n=Object.keys(r)[0];r[n]==t.minFilter&&e.push(`minFilter: ${n}`)}if(t.tmagFilter)for(let r of R9){let n=Object.keys(r)[0];r[n]==t.magFilter&&e.push(`magFilter: ${n}`)}return t.tflipY&&e.push(`flipY: ${t.flipY}`),e}};function sB(o){return class extends o{constructor(){super(...arguments);this.checkFileType=y.BOOLEAN(!0)}}}function Ire(o){return class extends o{constructor(){super(...arguments);this.url=y.STRING(Ji.PARAM_DEFAULT,{fileBrowse:{type:[Oc.TEXTURE_IMAGE]}}),this.reload=y.BUTTON(null,{callback:(t,r)=>{B9.PARAM_CALLBACK_reload(t,r)}})}}}var aB=class extends sB(Eg(Ire(U))){},Lre=new aB,B9=class extends Ua{constructor(){super(...arguments);this.paramsConfig=Lre,this.textureParamsController=new Df(this)}static type(){return"image"}async requiredModules(){this.p.url.isDirty()&&await this.p.url.compute();let e=Go.extension(this.pv.url||"");return Ji.module_names(e)}static displayedInputNames(){return["optional texture to copy attributes from"]}dispose(){super.dispose(),Q.blobs.clearBlobsForNode(this)}initializeNode(){this.io.inputs.setCount(0,1),this.io.inputs.initInputsClonedState(ke.NEVER)}async cook(e){if(this.pv.checkFileType&&!$k(this.pv.url))this.states.error.set("url is not an image");else{let t=await this._loadTexture();if(t){let r=e[0];r&&Df.copyTextureAttributes(t,r),await this.textureParamsController.update(t),this.setTexture(t)}else this._clearTexture()}}static PARAM_CALLBACK_reload(e,t){e.paramCallbackReload()}paramCallbackReload(){this.p.url.setDirty()}_loader(){return new Ji(this.pv.url,this.p.url,this,this.scene(),{forceImage:!this.pv.checkFileType})}async _loadTexture(){let e=null;try{e=await this._loader().load_texture_from_url_or_op({tdataType:this.pv.ttype&&this.pv.tadvanced,dataType:this.pv.type}),e&&(e.matrixAutoUpdate=!1)}catch{}return e||this.states.error.set(`could not load texture '${this.pv.url}'`),e}};var cB=class extends U{constructor(){super(...arguments);this.animation=y.NODE_PATH("",{nodeSelection:{context:oe.ANIM},dependentOnFoundNode:!1}),this.play=y.BUTTON(null,{callback:e=>{kf.PARAM_CALLBACK_play(e)}}),this.pause=y.BUTTON(null,{callback:e=>{kf.PARAM_CALLBACK_pause(e)}}),this.stopsPreviousAnim=y.BOOLEAN(1)}},Dre=new cB,kf=class extends Lr{constructor(){super(...arguments);this.paramsConfig=Dre}static type(){return"animation"}initializeNode(){this.io.inputs.setNamedInputConnectionPoints([new qe("start",We.BASE,this._play.bind(this)),new qe("stop",We.BASE,this._pause.bind(this))]),this.io.outputs.setNamedOutputConnectionPoints([new qe("start",We.BASE),new qe("completed",We.BASE)])}processEvent(e){}static PARAM_CALLBACK_play(e){e._play({})}static PARAM_CALLBACK_pause(e){e._pause()}async _play(e){let t=this.p.animation;t.isDirty()&&await t.compute();let r=t.value.nodeWithContext(oe.ANIM);if(!r)return;let n=await r.compute();!n||(this._timelineBuilder=n.coreContent(),!!this._timelineBuilder&&(this._timeline&&this.pv.stopsPreviousAnim&&this._timeline.kill(),this._timeline=Gi.timeline(),this._timelineBuilder.populate(this._timeline,{registerproperties:!0}),this._timeline.vars.onStart=()=>{this._triggerAnimationStarted(e)},this._timeline.vars.onComplete=()=>{this._triggerAnimationCompleted(e)}))}_pause(){this._timeline&&this._timeline.pause()}_triggerAnimationStarted(e){this.dispatchEventToOutput("start",e)}_triggerAnimationCompleted(e){this.dispatchEventToOutput("completed",e)}};var Sg=class extends Lr{constructor(){super(...arguments);this._controls_by_viewer=new Map}async apply_controls(e,t){var r;(r=t.controlsController())==null||r.dispose_controls();let n=t.canvas();if(!n)return;let i=await this.createControlsInstance(e,n),s=this._controls_by_viewer.get(t);s&&s.dispose(),this._controls_by_viewer.set(t,i);let c=Q.performance.performanceManager().now();return i.name=`${this.path()}:${e.name}:${c}:${this.controls_id()}`,await this.params.evalAll(),this.setupControls(i),i}controls_id(){return JSON.stringify(this.params.all.map(e=>e.valueSerialized()))}};var F9=class{constructor(e=1,t=0,r=0){return this.radius=e,this.phi=t,this.theta=r,this}set(e,t,r){return this.radius=e,this.phi=t,this.theta=r,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,r){return this.radius=Math.sqrt(e*e+t*t+r*r),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,r),this.phi=Math.acos(Li(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}};var lB={type:"change"},wg={type:"start"},Mg={type:"end"},Ng=class extends hu{constructor(e,t){super();t===void 0&&console.warn('THREE.OrbitControls: The second parameter "domElement" is now mandatory.'),t===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),this.object=e,this.domElement=t,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new M,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.enableKeys=!0,this.keyMode="pan",this.keyRotateSpeedVertical=1,this.keyRotateSpeedHorizontal=1,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:mc.ROTATE,MIDDLE:mc.DOLLY,RIGHT:mc.PAN},this.touches={ONE:_c.ROTATE,TWO:_c.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return a.phi},this.getAzimuthalAngle=function(){return a.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(G){G.addEventListener("keydown",et),this._domElementKeyEvents=G},this.saveState=function(){r.target0.copy(r.target),r.position0.copy(r.object.position),r.zoom0=r.object.zoom},this.reset=function(){r.target.copy(r.target0),r.object.position.copy(r.position0),r.object.zoom=r.zoom0,r.object.updateProjectionMatrix(),r.dispatchEvent(lB),r.update(),i=n.NONE},this.update=function(){let G=new M,se=new It().setFromUnitVectors(e.up,new M(0,1,0)),ve=se.clone().invert(),Fe=new M,q=new It,Le=2*Math.PI,Me=!1;return function(){let _e=r.object.position;if(G.copy(_e).sub(r.target),G.applyQuaternion(se),a.setFromVector3(G),r.autoRotate&&i===n.NONE&&w(E()),r.enableDamping){let nr=c.theta*r.dampingFactor,Oo=c.phi*r.dampingFactor;nr<s&&Oo<s?Me||(r.dispatchEvent(Mg),Me=!0):Me=!1,a.theta+=nr,a.phi+=Oo}else a.theta+=c.theta,a.phi+=c.phi;let He=r.minAzimuthAngle,tt=r.maxAzimuthAngle;return isFinite(He)&&isFinite(tt)&&(He<-Math.PI?He+=Le:He>Math.PI&&(He-=Le),tt<-Math.PI?tt+=Le:tt>Math.PI&&(tt-=Le),He<tt?a.theta=Math.max(He,Math.min(tt,a.theta)):a.theta=a.theta>(He+tt)/2?Math.max(He,a.theta):Math.min(tt,a.theta)),a.phi=Math.max(r.minPolarAngle,Math.min(r.maxPolarAngle,a.phi)),a.makeSafe(),a.radius*=l,a.radius=Math.max(r.minDistance,Math.min(r.maxDistance,a.radius)),r.enableDamping===!0?r.target.addScaledVector(u,r.dampingFactor):r.target.add(u),G.setFromSpherical(a),G.applyQuaternion(ve),_e.copy(r.target).add(G),r.object.lookAt(r.target),r.enableDamping===!0?(c.theta*=1-r.dampingFactor,c.phi*=1-r.dampingFactor,u.multiplyScalar(1-r.dampingFactor)):(c.set(0,0,0),u.set(0,0,0)),l=1,p||Fe.distanceToSquared(r.object.position)>s||8*(1-q.dot(r.object.quaternion))>s?(r.dispatchEvent(lB),Fe.copy(r.object.position),q.copy(r.object.quaternion),p=!1,!0):!1}}(),this.dispose=function(){r.domElement.removeEventListener("contextmenu",fe),r.domElement.removeEventListener("pointerdown",be),r.domElement.removeEventListener("pointercancel",we),r.domElement.removeEventListener("wheel",Xe),r.domElement.ownerDocument.removeEventListener("pointermove",ne),r.domElement.ownerDocument.removeEventListener("pointerup",he),r._domElementKeyEvents!==null&&r._domElementKeyEvents.removeEventListener("keydown",et)};let r=this,n={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},i=n.NONE,s=1e-6,a=new F9,c=new F9,l=1,u=new M,p=!1,d=new z,h=new z,m=new z,f=new z,v=new z,g=new z,_=new z,T=new z,b=new z,x=[],A={};function E(){return 2*Math.PI/60/60*r.autoRotateSpeed}function S(){return Math.pow(.95,r.zoomSpeed)}function w(G){c.theta-=G}function O(G){c.phi-=G}let C=function(){let G=new M;return function(ve,Fe){G.setFromMatrixColumn(Fe,0),G.multiplyScalar(-ve),u.add(G)}}(),N=function(){let G=new M;return function(ve,Fe){r.screenSpacePanning===!0?G.setFromMatrixColumn(Fe,1):(G.setFromMatrixColumn(Fe,0),G.crossVectors(r.object.up,G)),G.multiplyScalar(ve),u.add(G)}}(),R=function(){let G=new M;return function(ve,Fe){let q=r.domElement;if(r.object.isPerspectiveCamera){let Le=r.object.position;G.copy(Le).sub(r.target);let Me=G.length();Me*=Math.tan(r.object.fov/2*Math.PI/180),C(2*ve*Me/q.clientHeight,r.object.matrix),N(2*Fe*Me/q.clientHeight,r.object.matrix)}else r.object.isOrthographicCamera?(C(ve*(r.object.right-r.object.left)/r.object.zoom/q.clientWidth,r.object.matrix),N(Fe*(r.object.top-r.object.bottom)/r.object.zoom/q.clientHeight,r.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),r.enablePan=!1)}}();function D(G){r.object.isPerspectiveCamera?l/=G:r.object.isOrthographicCamera?(r.object.zoom=Math.max(r.minZoom,Math.min(r.maxZoom,r.object.zoom*G)),r.object.updateProjectionMatrix(),p=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),r.enableZoom=!1)}function V(G){r.object.isPerspectiveCamera?l*=G:r.object.isOrthographicCamera?(r.object.zoom=Math.max(r.minZoom,Math.min(r.maxZoom,r.object.zoom/G)),r.object.updateProjectionMatrix(),p=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),r.enableZoom=!1)}function F(G){d.set(G.clientX,G.clientY)}function j(G){_.set(G.clientX,G.clientY)}function $(G){f.set(G.clientX,G.clientY)}function Y(G){h.set(G.clientX,G.clientY),m.subVectors(h,d).multiplyScalar(r.rotateSpeed);var se=r.domElement;w(2*Math.PI*m.x/se.clientHeight),O(2*Math.PI*m.y/se.clientHeight),d.copy(h),r.update()}function H(G){T.set(G.clientX,G.clientY),b.subVectors(T,_),b.y>0?D(S()):b.y<0&&V(S()),_.copy(T),r.update()}function B(G){v.set(G.clientX,G.clientY),g.subVectors(v,f).multiplyScalar(r.panSpeed),R(g.x,g.y),f.copy(v),r.update()}function te(G){G.deltaY<0?V(S()):G.deltaY>0&&D(S()),r.update()}function X(G){let se=!1;if(r.keyMode=="pan")switch(G.code){case r.keys.UP:R(0,r.keyPanSpeed),se=!0;break;case r.keys.BOTTOM:R(0,-r.keyPanSpeed),se=!0;break;case r.keys.LEFT:R(r.keyPanSpeed,0),se=!0;break;case r.keys.RIGHT:R(-r.keyPanSpeed,0),se=!0;break}else switch(G.code){case r.keys.UP:O(r.keyRotateSpeedVertical),se=!0;break;case r.keys.BOTTOM:O(-r.keyRotateSpeedVertical),se=!0;break;case r.keys.LEFT:w(r.keyRotateSpeedHorizontal),se=!0;break;case r.keys.RIGHT:w(-r.keyRotateSpeedHorizontal),se=!0;break}se&&(G.preventDefault(),r.update())}function W(){if(x.length===1)d.set(x[0].pageX,x[0].pageY);else{let G=.5*(x[0].pageX+x[1].pageX),se=.5*(x[0].pageY+x[1].pageY);d.set(G,se)}}function L(){if(x.length===1)f.set(x[0].pageX,x[0].pageY);else{let G=.5*(x[0].pageX+x[1].pageX),se=.5*(x[0].pageY+x[1].pageY);f.set(G,se)}}function Ne(){let G=x[0].pageX-x[1].pageX,se=x[0].pageY-x[1].pageY,ve=Math.sqrt(G*G+se*se);_.set(0,ve)}function ye(){r.enableZoom&&Ne(),r.enablePan&&L()}function ae(){r.enableZoom&&Ne(),r.enableRotate&&W()}function Ae(G){if(x.length==1)h.set(G.pageX,G.pageY);else{let ve=Se(G),Fe=.5*(G.pageX+ve.x),q=.5*(G.pageY+ve.y);h.set(Fe,q)}m.subVectors(h,d).multiplyScalar(r.rotateSpeed);let se=r.domElement;w(2*Math.PI*m.x/se.clientHeight),O(2*Math.PI*m.y/se.clientHeight),d.copy(h)}function Ie(G){if(x.length===1)v.set(G.pageX,G.pageY);else{let se=Se(G),ve=.5*(G.pageX+se.x),Fe=.5*(G.pageY+se.y);v.set(ve,Fe)}g.subVectors(v,f).multiplyScalar(r.panSpeed),R(g.x,g.y),f.copy(v)}function Oe(G){let se=Se(G),ve=G.pageX-se.x,Fe=G.pageY-se.y,q=Math.sqrt(ve*ve+Fe*Fe);T.set(0,q),b.set(0,Math.pow(T.y/_.y,r.zoomSpeed)),D(b.y),_.copy(T)}function le(G){r.enableZoom&&Oe(G),r.enablePan&&Ie(G)}function xe(G){r.enableZoom&&Oe(G),r.enableRotate&&Ae(G)}function be(G){r.enabled!==!1&&(x.length===0&&(r.domElement.setPointerCapture(G.pointerId),r.domElement.ownerDocument.addEventListener("pointermove",ne),r.domElement.ownerDocument.addEventListener("pointerup",he)),ee(G),G.pointerType==="touch"?k(G):Ee(G))}function ne(G){r.enabled!==!1&&(G.pointerType==="touch"?P(G):Pe(G))}function he(G){me(G),x.length===0&&(r.domElement.releasePointerCapture(G.pointerId),r.domElement.ownerDocument.removeEventListener("pointermove",ne),r.domElement.ownerDocument.removeEventListener("pointerup",he)),r.dispatchEvent(Mg),i=n.NONE}function we(G){me(G)}function Ee(G){let se;switch(G.button){case 0:se=r.mouseButtons.LEFT;break;case 1:se=r.mouseButtons.MIDDLE;break;case 2:se=r.mouseButtons.RIGHT;break;default:se=-1}switch(se){case mc.DOLLY:if(r.enableZoom===!1)return;j(G),i=n.DOLLY;break;case mc.ROTATE:if(G.ctrlKey||G.metaKey||G.shiftKey){if(r.enablePan===!1)return;$(G),i=n.PAN}else{if(r.enableRotate===!1)return;F(G),i=n.ROTATE}break;case mc.PAN:if(G.ctrlKey||G.metaKey||G.shiftKey){if(r.enableRotate===!1)return;F(G),i=n.ROTATE}else{if(r.enablePan===!1)return;$(G),i=n.PAN}break;default:i=n.NONE}i!==n.NONE&&r.dispatchEvent(wg)}function Pe(G){if(r.enabled!==!1)switch(i){case n.ROTATE:if(r.enableRotate===!1)return;Y(G);break;case n.DOLLY:if(r.enableZoom===!1)return;H(G);break;case n.PAN:if(r.enablePan===!1)return;B(G);break}}function Xe(G){r.enabled===!1||r.enableZoom===!1||i!==n.NONE||(G.preventDefault(),r.dispatchEvent(wg),te(G),r.dispatchEvent(Mg))}function et(G){r.enabled===!1||r.enablePan===!1||X(G)}function k(G){switch(Z(G),x.length){case 1:switch(r.touches.ONE){case _c.ROTATE:if(r.enableRotate===!1)return;W(),i=n.TOUCH_ROTATE;break;case _c.PAN:if(r.enablePan===!1)return;L(),i=n.TOUCH_PAN;break;default:i=n.NONE}break;case 2:switch(r.touches.TWO){case _c.DOLLY_PAN:if(r.enableZoom===!1&&r.enablePan===!1)return;ye(),i=n.TOUCH_DOLLY_PAN;break;case _c.DOLLY_ROTATE:if(r.enableZoom===!1&&r.enableRotate===!1)return;ae(),i=n.TOUCH_DOLLY_ROTATE;break;default:i=n.NONE}break;default:i=n.NONE}i!==n.NONE&&r.dispatchEvent(wg)}function P(G){switch(Z(G),i){case n.TOUCH_ROTATE:if(r.enableRotate===!1)return;Ae(G),r.update();break;case n.TOUCH_PAN:if(r.enablePan===!1)return;Ie(G),r.update();break;case n.TOUCH_DOLLY_PAN:if(r.enableZoom===!1&&r.enablePan===!1)return;le(G),r.update();break;case n.TOUCH_DOLLY_ROTATE:if(r.enableZoom===!1&&r.enableRotate===!1)return;xe(G),r.update();break;default:i=n.NONE}}function fe(G){r.enabled!==!1&&G.preventDefault()}function ee(G){x.push(G)}function me(G){delete A[G.pointerId];for(let se=0;se<x.length;se++)if(x[se].pointerId==G.pointerId){x.splice(se,1);return}}function Z(G){let se=A[G.pointerId];se===void 0&&(se=new z,A[G.pointerId]=se),se.set(G.pageX,G.pageY)}function Se(G){let se=G.pointerId===x[0].pointerId?x[1]:x[0];return A[se.pointerId]}r.domElement.addEventListener("contextmenu",fe),r.domElement.addEventListener("pointerdown",be),r.domElement.addEventListener("pointercancel",we),r.domElement.addEventListener("wheel",Xe,{passive:!1}),this.update()}};var uB="start",pB="change",dB="end";var id=["pan","rotate"],hB=class extends U{constructor(){super(...arguments);this.enabled=y.BOOLEAN(1),this.allowPan=y.BOOLEAN(1),this.allowRotate=y.BOOLEAN(1),this.allowZoom=y.BOOLEAN(1),this.tdamping=y.BOOLEAN(1),this.damping=y.FLOAT(.1,{visibleIf:{tdamping:!0}}),this.screenSpacePanning=y.BOOLEAN(1),this.rotateSpeed=y.FLOAT(.5),this.minDistance=y.FLOAT(.1,{range:[.1,100],rangeLocked:[!0,!1]}),this.maxDistance=y.FLOAT(50,{range:[0,100],rangeLocked:[!0,!1]}),this.limitAzimuthAngle=y.BOOLEAN(0),this.azimuthAngleRange=y.VECTOR2(["-2*$PI","2*$PI"],{visibleIf:{limitAzimuthAngle:1}}),this.polarAngleRange=y.VECTOR2([0,"$PI"]),this.target=y.VECTOR3([0,0,0],{cook:!1,computeOnDirty:!0,callback:e=>{U9.PARAM_CALLBACK_update_target(e)}}),this.enableKeys=y.BOOLEAN(0),this.keysMode=y.INTEGER(id.indexOf("pan"),{visibleIf:{enableKeys:1},menu:{entries:id.map((e,t)=>({name:e,value:t}))}}),this.keysPanSpeed=y.FLOAT(7,{range:[0,10],rangeLocked:[!1,!1],visibleIf:{enableKeys:1,keysMode:id.indexOf("pan")}}),this.keysRotateSpeedVertical=y.FLOAT(1,{range:[0,1],rangeLocked:[!1,!1],visibleIf:{enableKeys:1,keysMode:id.indexOf("rotate")}}),this.keysRotateSpeedHorizontal=y.FLOAT(1,{range:[0,1],rangeLocked:[!1,!1],visibleIf:{enableKeys:1,keysMode:id.indexOf("rotate")}})}},kre=new hB,U9=class extends Sg{constructor(){super(...arguments);this.paramsConfig=kre,this._controls_by_element_id=new Map,this._target_array=[0,0,0]}static type(){return S5.ORBIT}endEventName(){return"end"}initializeNode(){this.io.outputs.setNamedOutputConnectionPoints([new qe(uB,We.BASE),new qe(pB,We.BASE),new qe(dB,We.BASE)])}async createControlsInstance(e,t){let r=new Ng(e,t);return r.addEventListener("end",()=>{this._on_controls_end(r)}),this._controls_by_element_id.set(t.id,r),this._bind_listeners_to_controls_instance(r),r}_bind_listeners_to_controls_instance(e){e.addEventListener("start",()=>{this.dispatchEventToOutput(uB,{})}),e.addEventListener("change",()=>{this.dispatchEventToOutput(pB,{})}),e.addEventListener("end",()=>{this.dispatchEventToOutput(dB,{})})}setupControls(e){e.enabled=this.pv.enabled,e.enablePan=this.pv.allowPan,e.enableRotate=this.pv.allowRotate,e.enableZoom=this.pv.allowZoom,e.enableDamping=this.pv.tdamping,e.dampingFactor=this.pv.damping,e.rotateSpeed=this.pv.rotateSpeed,e.screenSpacePanning=this.pv.screenSpacePanning,e.minDistance=this.pv.minDistance,e.maxDistance=this.pv.maxDistance,this._set_azimuth_angle(e),e.minPolarAngle=this.pv.polarAngleRange.x,e.maxPolarAngle=this.pv.polarAngleRange.y,e.target.copy(this.pv.target),e.enabled&&e.update(),e.enableKeys=this.pv.enableKeys,e.enableKeys&&(e.keyMode=id[this.pv.keysMode],e.keyRotateSpeedVertical=this.pv.keysRotateSpeedVertical,e.keyRotateSpeedHorizontal=this.pv.keysRotateSpeedHorizontal,e.keyPanSpeed=this.pv.keysPanSpeed)}_set_azimuth_angle(e){this.pv.limitAzimuthAngle?(e.minAzimuthAngle=this.pv.azimuthAngleRange.x,e.maxAzimuthAngle=this.pv.azimuthAngleRange.y):(e.minAzimuthAngle=1/0,e.maxAzimuthAngle=1/0)}updateRequired(){return this.pv.tdamping}_on_controls_end(e){!this.pv.allowPan||(e.target.toArray(this._target_array),this.p.target.set(this._target_array))}static PARAM_CALLBACK_update_target(e){e._update_target()}_update_target(){let e=this.pv.target;this._controls_by_element_id.forEach((t,r)=>{let n=t.target;n.equals(e)||(n.copy(e),t.update())})}disposeControlsForHtmlElementId(e){this._controls_by_element_id.get(e)&&this._controls_by_element_id.delete(e)}};var Bre="in",fB="out",mB=class extends U{constructor(){super(...arguments);this.delay=y.INTEGER(1e3,{range:[0,1e3],rangeLocked:[!0,!1]})}},Fre=new mB,Og=class extends Lr{constructor(){super(...arguments);this.paramsConfig=Fre}static type(){return"delay"}initializeNode(){this.io.inputs.setNamedInputConnectionPoints([new qe(Bre,We.BASE,this._process_input.bind(this))]),this.io.outputs.setNamedOutputConnectionPoints([new qe(fB,We.BASE)])}_process_input(e){setTimeout(()=>{this.dispatchEventToOutput(fB,e)},this.pv.delay)}};var V9=["all together","batch"],_B=class extends U{constructor(){super(...arguments);this.mask=y.STRING("/geo*",{callback:e=>{N0.PARAM_CALLBACK_updateResolvedNodes(e)}}),this.force=y.BOOLEAN(0),this.cookMode=y.INTEGER(V9.indexOf("all together"),{menu:{entries:V9.map((e,t)=>({name:e,value:t}))}}),this.batchSize=y.INTEGER(1,{visibleIf:{cookMode:V9.indexOf("batch")},separatorAfter:!0}),this.registerOnlyFirstCooks=y.BOOLEAN(!0),this.updateResolve=y.BUTTON(null,{callback:(e,t)=>{N0.PARAM_CALLBACK_updateResolve(e)}}),this.printResolve=y.BUTTON(null,{callback:(e,t)=>{N0.PARAM_CALLBACK_printResolve(e)}})}},Ure=new _B,Ga=class extends Lr{constructor(){super(...arguments);this.paramsConfig=Ure,this._resolvedNodes=[],this._dispatchedFirstNodeCooked=!1,this._dispatchedAllNodesCooked=!1,this._cookStateByNodeId=new Map}static type(){return"nodeCook"}initializeNode(){this.io.inputs.setNamedInputConnectionPoints([new qe(Ga.INPUT_TRIGGER,We.BASE,this.processEventTrigger.bind(this))]),this.io.outputs.setNamedOutputConnectionPoints([new qe(Ga.OUTPUT_FIRST_NODE,We.BASE),new qe(Ga.OUTPUT_EACH_NODE,We.BASE),new qe(Ga.OUTPUT_ALL_NODES,We.BASE)])}trigger(){this.processEventTrigger({})}cook(){this._updateResolvedNodes(),this.cookController.endCook()}dispose(){super.dispose(),this._reset()}resolvedNodes(){return this._resolvedNodes}processEventTrigger(o){this._cookNodesWithMode()}_cookNodesWithMode(){this._updateResolvedNodes();let o=V9[this.pv.cookMode];switch(o){case"all together":return this._cookNodesAllTogether();case"batch":return this._cookNodesInBatch()}Be.unreachable(o)}_cookNodesAllTogether(){this._cookNodes(this._resolvedNodes)}async _cookNodesInBatch(){let o=this.pv.batchSize,e=Math.ceil(this._resolvedNodes.length/o);for(let t=0;t<e;t++){let r=t*o,n=(t+1)*o,i=this._resolvedNodes.slice(r,n);await this._cookNodes(i)}}async _cookNodes(o){let e=[];for(let t of o)e.push(this._cookNode(t));return await Promise.all(e)}_cookNode(o){return this.pv.force&&o.setDirty(this),o.compute()}static PARAM_CALLBACK_updateResolvedNodes(o){o._updateResolvedNodes()}_updateResolvedNodes(){this._reset(),this._resolvedNodes=this.scene().nodesController.nodesFromMask(this.pv.mask||"");for(let o of this._resolvedNodes)o.cookController.registerOnCookEnd(this._callbackNameForNode(o),()=>{this._onNodeCookComplete(o)}),this._cookStateByNodeId.set(o.graphNodeId(),!1)}_callbackNameForNode(o){return`owner-${this.graphNodeId()}-target-${o.graphNodeId()}`}_reset(){this._dispatchedFirstNodeCooked=!1,this._cookStateByNodeId.clear();for(let o of this._resolvedNodes)o.cookController.deregisterOnCookEnd(this._callbackNameForNode(o));this._resolvedNodes=[]}_allNodesHaveCooked(){for(let o of this._resolvedNodes)if(!this._cookStateByNodeId.get(o.graphNodeId()))return!1;return!0}_onNodeCookComplete(o){let e=this.pv.registerOnlyFirstCooks,t={value:{node:o}};(!this._dispatchedFirstNodeCooked||!e)&&(this._dispatchedFirstNodeCooked=!0,this.dispatchEventToOutput(Ga.OUTPUT_FIRST_NODE,t)),(!this._cookStateByNodeId.get(o.graphNodeId())||!e)&&this.dispatchEventToOutput(Ga.OUTPUT_EACH_NODE,t),this._cookStateByNodeId.set(o.graphNodeId(),!0),(!this._dispatchedAllNodesCooked||!e)&&this._allNodesHaveCooked()&&(this._dispatchedAllNodesCooked=!0,this.dispatchEventToOutput(Ga.OUTPUT_ALL_NODES,{}))}static PARAM_CALLBACK_updateResolve(o){o._updateResolvedNodes()}static PARAM_CALLBACK_printResolve(o){o.printResolve()}printResolve(){console.log(this._resolvedNodes)}},N0=Ga;N0.INPUT_TRIGGER="trigger";N0.OUTPUT_FIRST_NODE="first";N0.OUTPUT_EACH_NODE="each";N0.OUTPUT_ALL_NODES="all";var Bf=class{constructor(e,t,r=0,n=1/0){this.ray=new g1(e,t),this.near=r,this.far=n,this.camera=null,this.layers=new _1,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t&&t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t&&t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}intersectObject(e,t=!0,r=[]){return Pg(e,this,r,t),r.sort(gB),r}intersectObjects(e,t=!0,r=[]){for(let n=0,i=e.length;n<i;n++)Pg(e[n],this,r,t);return r.sort(gB),r}};function gB(o,e){return o.distance-e.distance}function Pg(o,e,t,r){if(o.layers.test(e.layers)&&o.raycast(e,t),r===!0){let n=o.children;for(let i=0,s=n.length;i<s;i++)Pg(n[i],e,t,!0)}}var Rg=class{constructor(e){this._node=e,this._set_pos_timestamp=-1,this._hit_velocity=new M(0,0,0),this._hit_velocity_array=[0,0,0]}process(e){if(!this._node.pv.tvelocity)return;if(!this._prev_position){this._prev_position=this._prev_position||new M,this._prev_position.copy(e);return}let r=Q.performance.performanceManager().now(),n=r-this._set_pos_timestamp;if(this._set_pos_timestamp=r,this._hit_velocity.copy(e).sub(this._prev_position).divideScalar(n).multiplyScalar(1e3),this._hit_velocity.toArray(this._hit_velocity_array),this._node.pv.tvelocityTarget){if(Q.playerMode())this._found_velocity_target_param=this._found_velocity_target_param||this._node.pv.velocityTarget.paramWithType(J.VECTOR3);else{let i=this._node.pv.velocityTarget;this._found_velocity_target_param=i.paramWithType(J.VECTOR3)}this._found_velocity_target_param&&this._found_velocity_target_param.set(this._hit_velocity_array)}else this._node.p.velocity.set(this._hit_velocity_array);this._prev_position.copy(e)}reset(){this._prev_position=void 0}};var za=(o=>(o.GEOMETRY="geometry",o.PLANE="plane",o))(za||{}),cl=["geometry","plane"];var vB=class extends U{constructor(){super(...arguments);this.attributeName=y.STRING("id",{cook:!1}),this.attributeType=y.INTEGER(Et.indexOf(Ge.NUMERIC),{menu:{entries:na}}),this.attributeValue1=y.FLOAT(0,{cook:!1,visibleIf:{attributeType:Et.indexOf(Ge.NUMERIC)}}),this.resetValue1=y.FLOAT(-1,{cook:!1,visibleIf:{attributeType:Et.indexOf(Ge.NUMERIC)}}),this.attributeValues=y.STRING("",{visibleIf:{attributeType:Et.indexOf(Ge.STRING)}}),this.resetValues=y.STRING("",{visibleIf:{attributeType:Et.indexOf(Ge.STRING)}})}},Vre=new vB,Ff=class extends Lr{constructor(){super(...arguments);this.paramsConfig=Vre}static type(){return"intersectData"}initializeNode(){this.io.inputs.setNamedInputConnectionPoints([new qe(Ff.INPUT_HIT,We.BASE,this._processHit.bind(this)),new qe(Ff.INPUT_MISS,We.BASE,this._processMiss.bind(this))])}_processHit(o){var e;let t=(e=o.value)==null?void 0:e.intersect;!t||this._resolveIntersectAttribute(t)}_processMiss(o){let e=Et[this.pv.attributeType];switch(e){case Ge.NUMERIC:{this.p.attributeValue1.set(this.pv.resetValue1);return}case Ge.STRING:{this.p.attributeValues.set(this.pv.resetValues);return}}Be.unreachable(e)}_resolveIntersectAttribute(o){let e=Et[this.pv.attributeType],t=Ff.resolveObjectAttribute(o,this.pv.attributeName);if(t==null&&(t=Ff.resolveGeometryAttribute(o,this.pv.attributeName,e)),t!=null){switch(e){case Ge.NUMERIC:{this.p.attributeValue1.set(t);return}case Ge.STRING:{K.isString(t)&&this.p.attributeValues.set(t);return}}Be.unreachable(e)}}static resolveObjectAttribute(o,e){let t=br.attribValue(o.object,e);if(t!=null){if(K.isNumber(t)||K.isString(t))return t;if(K.isArray(t))return t[0];if(K.isVector(t))return t.x}}static resolveGeometryAttribute(o,e,t){switch(si(o.object.constructor)){case jt.MESH:return this.resolveGeometryAttributeForMesh(o,e,t);case jt.POINTS:return this.resolveGeometryAttributeForPoint(o,e,t)}}static resolveGeometryAttributeForMesh(o,e,t){let r=o.object.geometry;if(r){let n=r.getAttribute(e);if(n){switch(t){case Ge.NUMERIC:{let i=r.getAttribute("position");return o.face?(this._vA.fromBufferAttribute(i,o.face.a),this._vB.fromBufferAttribute(i,o.face.b),this._vC.fromBufferAttribute(i,o.face.c),this._uvA.fromBufferAttribute(n,o.face.a),this._uvB.fromBufferAttribute(n,o.face.b),this._uvC.fromBufferAttribute(n,o.face.c),o.uv=mn.getUV(o.point,this._vA,this._vB,this._vC,this._uvA,this._uvB,this._uvC,this._hitUV),this._hitUV.x):void 0}case Ge.STRING:{let s=new At(r).points()[0];return s?s.stringAttribValue(e):void 0}}Be.unreachable(t)}}}static resolveGeometryAttributeForPoint(o,e,t){let r=o.object.geometry;if(r&&o.index!=null){switch(t){case Ge.NUMERIC:{let n=r.getAttribute(e);return n?n.array[o.index]:void 0}case Ge.STRING:{let i=new At(r).points()[o.index];return i?i.stringAttribValue(e):void 0}}Be.unreachable(t)}}},Ai=Ff;Ai.INPUT_HIT="hit";Ai.INPUT_MISS="miss";Ai._vA=new M;Ai._vB=new M;Ai._vC=new M;Ai._uvA=new z;Ai._uvB=new z;Ai._uvC=new z;Ai._hitUV=new z;function yB(o,e,t){var r=e.getBoundingClientRect();t.offsetX=o.pageX-r.left,t.offsetY=o.pageY-r.top}function Gre(){let o=new Bf;return o.firstHitOnly=!0,o}var ll=class{constructor(e){this._node=e,this._offset={offsetX:0,offsetY:0},this._mouse=new z,this._mouse_array=[0,0],this._raycaster=Gre(),this._plane=new Io,this._plane_intersect_target=new M,this._intersections=[],this._hit_position_array=[0,0,0],this.velocity_controller=new Rg(this._node)}updateMouse(e){var t;let r=(t=e.viewer)==null?void 0:t.canvas(),n=e.cameraNode;if(!(r&&n))return;let i=a=>{this._mouse.x=a.offsetX/r.offsetWidth*2-1,this._mouse.y=-(a.offsetY/r.offsetHeight)*2+1,this._mouse.toArray(this._mouse_array),this._node.p.mouse.set(this._mouse_array)},s=e.event;if((s instanceof MouseEvent||s instanceof DragEvent||s instanceof PointerEvent)&&yB(s,r,this._offset),window.TouchEvent&&s instanceof TouchEvent){let a=s.touches[0];yB(a,r,this._offset)}i(this._offset),this._raycaster.setFromCamera(this._mouse,n.object)}processEvent(e){this._prepareRaycaster(e);let t=cl[this._node.pv.intersectWith];switch(t){case za.GEOMETRY:return this._intersectGeometry(e);case za.PLANE:return this._intersectPlane(e)}Be.unreachable(t)}_intersectPlane(e){this._plane.normal.copy(this._node.pv.planeDirection),this._plane.constant=this._node.pv.planeOffset,this._raycaster.ray.intersectPlane(this._plane,this._plane_intersect_target),this._setPositionParam(this._plane_intersect_target),this._node.triggerHit(e)}_intersectGeometry(e){if(this._resolved_targets||this.update_target(),this._resolved_targets){this._intersections.length=0;let r=this._raycaster.intersectObjects(this._resolved_targets,this._node.pv.traverseChildren,this._intersections)[0];r?(this._node.pv.tposition&&this._setPositionParam(r.point),this._node.pv.geoAttribute&&this._resolveIntersectAttribute(r),e.value={intersect:r},this._node.triggerHit(e)):this._node.triggerMiss(e)}}_resolveIntersectAttribute(e){let t=Et[this._node.pv.geoAttributeType],r=Ai.resolveObjectAttribute(e,this._node.pv.geoAttributeName);if(r==null&&(r=Ai.resolveGeometryAttribute(e,this._node.pv.geoAttributeName,t)),r!=null){switch(t){case Ge.NUMERIC:{this._node.p.geoAttributeValue1.set(r);return}case Ge.STRING:{K.isString(r)&&this._node.p.geoAttributeValues.set(r);return}}Be.unreachable(t)}}_setPositionParam(e){if(e.toArray(this._hit_position_array),this._node.pv.tpositionTarget){if(Q.playerMode())this._found_position_target_param=this._found_position_target_param||this._node.pv.positionTarget.paramWithType(J.VECTOR3);else{let t=this._node.pv.positionTarget;this._found_position_target_param=t.paramWithType(J.VECTOR3)}this._found_position_target_param&&this._found_position_target_param.set(this._hit_position_array)}else this._node.p.position.set(this._hit_position_array);this.velocity_controller.process(e)}_prepareRaycaster(e){let t=this._raycaster.params.Points;t&&(t.threshold=this._node.pv.pointsThreshold);let r=e.cameraNode;if(this._node.pv.overrideCamera)if(this._node.pv.overrideRay)this._raycaster.ray.origin.copy(this._node.pv.rayOrigin),this._raycaster.ray.direction.copy(this._node.pv.rayDirection);else{let n=this._node.pv.camera.nodeWithContext(oe.OBJ,this._node.states.error);n&&q1.includes(n.type())&&(r=n)}r&&!this._node.pv.overrideRay&&r.prepareRaycaster(this._mouse,this._raycaster)}update_target(){let e=sd[this._node.pv.targetType];switch(e){case G9.NODE:return this._update_target_from_node();case G9.SCENE_GRAPH:return this._update_target_from_scene_graph()}Be.unreachable(e)}_update_target_from_node(){let e=this._node.p.targetNode.value.nodeWithContext(oe.OBJ);if(e){let t=this._node.pv.traverseChildren?e.object:e.childrenDisplayController.sopGroup();t?this._resolved_targets=[t]:this._resolved_targets=void 0}else this._node.states.error.set("node is not an object")}_update_target_from_scene_graph(){let e=this._node.scene().objectsByMask(this._node.pv.objectMask);e.length>0?this._resolved_targets=e:this._resolved_targets=void 0}async update_position_target(){this._node.p.positionTarget.isDirty()&&await this._node.p.positionTarget.compute()}static PARAM_CALLBACK_update_target(e){e.cpuController.update_target()}static PARAM_CALLBACK_print_resolve(e){e.cpuController.print_resolve()}print_resolve(){this.update_target(),console.log(this._resolved_targets)}};var z9=class{constructor(e){this._node=e,this._resolved_material=null,this._restore_context={scene:{overrideMaterial:null},renderer:{toneMapping:-1,outputEncoding:-1}},this._mouse=new z,this._mouseArray=[0,0],this._read=new Float32Array(4),this._param_read=[0,0,0,0]}updateMouse(e){var t;let r=(t=e.viewer)==null?void 0:t.canvas();!(r&&e.event)||(e.event instanceof MouseEvent||e.event instanceof DragEvent||e.event instanceof PointerEvent?(this._mouse.x=e.event.offsetX/r.offsetWidth,this._mouse.y=1-e.event.offsetY/r.offsetHeight,this._mouse.toArray(this._mouseArray),this._node.p.mouse.set(this._mouseArray)):console.warn("event type not implemented"))}processEvent(e){var t;let r=(t=e.viewer)==null?void 0:t.canvas();if(!(r&&e.cameraNode))return;let n=e.cameraNode,i=n.renderController();if(i){if(this._renderTarget=this._renderTarget||new yr(r.offsetWidth,r.offsetHeight,{minFilter:lt,magFilter:it,format:at,type:qt}),!this._resolved_material){this.update_material(),console.warn("no material found");return}let s=n,a=i.resolvedScene()||n.scene().threejsScene(),c=i.renderer(r);if(!c)return;this._modify_scene_and_renderer(a,c),c.setRenderTarget(this._renderTarget),c.clear(),c.render(a,s.object),c.setRenderTarget(null),this._restore_scene_and_renderer(a,c),c.readRenderTargetPixels(this._renderTarget,Math.round(this._mouse.x*r.offsetWidth),Math.round(this._mouse.y*r.offsetHeight),1,1,this._read),this._param_read[0]=this._read[0],this._param_read[1]=this._read[1],this._param_read[2]=this._read[2],this._param_read[3]=this._read[3],this._node.p.pixelValue.set(this._param_read),this._node.pv.pixelValue.x>this._node.pv.hitThreshold?this._node.triggerHit(e):this._node.triggerMiss(e)}}_modify_scene_and_renderer(e,t){this._restore_context.scene.overrideMaterial=e.overrideMaterial,this._restore_context.renderer.outputEncoding=t.outputEncoding,this._restore_context.renderer.toneMapping=t.toneMapping,e.overrideMaterial=this._resolved_material,t.toneMapping=Ro,t.outputEncoding=Xr}_restore_scene_and_renderer(e,t){e.overrideMaterial=this._restore_context.scene.overrideMaterial,t.outputEncoding=this._restore_context.renderer.outputEncoding,t.toneMapping=this._restore_context.renderer.toneMapping}update_material(){let e=this._node.pv.material.nodeWithContext(oe.MAT,this._node.states.error);e?e.context()==oe.MAT?this._resolved_material=e.material:this._node.states.error.set("target is not an obj"):this._node.states.error.set("no target found")}static PARAM_CALLBACK_update_material(e){e.gpuController.update_material()}};var Ig=1e3/60;var Zi=["cpu","gpu"];function O0(o={}){return o.mode=Zi.indexOf("cpu"),{visibleIf:o}}function Xs(o={}){return o.mode=Zi.indexOf("cpu"),o.intersectWith=cl.indexOf(za.GEOMETRY),{visibleIf:o}}function xB(o={}){return o.mode=Zi.indexOf("cpu"),o.intersectWith=cl.indexOf(za.PLANE),{visibleIf:o}}function Lg(o={}){return o.mode=Zi.indexOf("gpu"),{visibleIf:o}}var G9=(o=>(o.SCENE_GRAPH="scene graph",o.NODE="node",o))(G9||{}),sd=["scene graph","node"],bB=class extends U{constructor(){super(...arguments);this.mode=y.INTEGER(Zi.indexOf("cpu"),{menu:{entries:Zi.map((e,t)=>({name:e,value:t}))}}),this.mouse=y.VECTOR2([0,0],{cook:!1}),this.overrideCamera=y.BOOLEAN(0),this.overrideRay=y.BOOLEAN(0,{visibleIf:{mode:Zi.indexOf("cpu"),overrideCamera:1}}),this.camera=y.NODE_PATH("",{nodeSelection:{context:oe.OBJ,types:q1},dependentOnFoundNode:!1,visibleIf:{overrideCamera:1,overrideRay:0}}),this.rayOrigin=y.VECTOR3([0,0,0],{visibleIf:{overrideCamera:1,overrideRay:1}}),this.rayDirection=y.VECTOR3([0,0,1],{visibleIf:{overrideCamera:1,overrideRay:1}}),this.material=y.NODE_PATH("",{nodeSelection:{context:oe.MAT},dependentOnFoundNode:!1,callback:(e,t)=>{z9.PARAM_CALLBACK_update_material(e)},...Lg()}),this.pixelValue=y.VECTOR4([0,0,0,0],{cook:!1,...Lg()}),this.hitThreshold=y.FLOAT(.5,{cook:!1,...Lg()}),this.intersectWith=y.INTEGER(cl.indexOf(za.GEOMETRY),{menu:{entries:cl.map((e,t)=>({name:e,value:t}))},...O0()}),this.pointsThreshold=y.FLOAT(1,{range:[0,100],rangeLocked:[!0,!1],...O0()}),this.planeDirection=y.VECTOR3([0,1,0],{...xB()}),this.planeOffset=y.FLOAT(0,{...xB()}),this.targetType=y.INTEGER(0,{menu:{entries:sd.map((e,t)=>({name:e,value:t}))},...Xs()}),this.targetNode=y.NODE_PATH("",{nodeSelection:{context:oe.OBJ},dependentOnFoundNode:!1,callback:(e,t)=>{ll.PARAM_CALLBACK_update_target(e)},...Xs({targetType:sd.indexOf("node")})}),this.objectMask=y.STRING("*geo1*",{callback:(e,t)=>{ll.PARAM_CALLBACK_update_target(e)},...Xs({targetType:sd.indexOf("scene graph")})}),this.printFoundObjectsFromMask=y.BUTTON(null,{callback:(e,t)=>{ll.PARAM_CALLBACK_print_resolve(e)},...Xs({targetType:sd.indexOf("scene graph")})}),this.traverseChildren=y.BOOLEAN(!0,{callback:(e,t)=>{ll.PARAM_CALLBACK_update_target(e)},...Xs(),separatorAfter:!0}),this.tposition=y.BOOLEAN(1,{cook:!1,...O0()}),this.tpositionTarget=y.BOOLEAN(0,{cook:!1,...O0({tposition:1})}),this.position=y.VECTOR3([0,0,0],{cook:!1,...O0({tposition:1,tpositionTarget:0})}),this.positionTarget=y.PARAM_PATH("",{cook:!1,...O0({tposition:1,tpositionTarget:1}),paramSelection:J.VECTOR3,computeOnDirty:!0}),this.tvelocity=y.BOOLEAN(0,{cook:!1}),this.tvelocityTarget=y.BOOLEAN(0,{cook:!1,...O0({tvelocity:1})}),this.velocity=y.VECTOR3([0,0,0],{cook:!1,...O0({tvelocity:1,tvelocityTarget:0})}),this.velocityTarget=y.PARAM_PATH("",{cook:!1,...O0({tvelocity:1,tvelocityTarget:1}),paramSelection:J.VECTOR3,computeOnDirty:!0}),this.geoAttribute=y.BOOLEAN(0,Xs()),this.geoAttributeName=y.STRING("id",{cook:!1,...Xs({geoAttribute:1})}),this.geoAttributeType=y.INTEGER(Et.indexOf(Ge.NUMERIC),{menu:{entries:na},...Xs({geoAttribute:1})}),this.geoAttributeValue1=y.FLOAT(0,{cook:!1,...Xs({geoAttribute:1,geoAttributeType:Et.indexOf(Ge.NUMERIC)})}),this.geoAttributeValues=y.STRING("",{...Xs({geoAttribute:1,geoAttributeType:Et.indexOf(Ge.STRING)})})}},zre=new bB,P0=class extends Lr{constructor(){super(...arguments);this.paramsConfig=zre,this.cpuController=new ll(this),this.gpuController=new z9(this),this._lastEventProcessedAt=-1}static type(){return"raycast"}initializeNode(){this.io.inputs.setNamedInputConnectionPoints([new qe(P0.INPUT_TRIGGER,We.BASE,this._processTriggerEventThrottled.bind(this)),new qe(P0.INPUT_MOUSE,We.MOUSE,this._processMouseEvent.bind(this)),new qe(P0.INPUT_UPDATE_OBJECTS,We.BASE,this._process_trigger_update_objects.bind(this)),new qe(P0.INPUT_TRIGGER_VEL_RESET,We.BASE,this._process_trigger_vel_reset.bind(this))]),this.io.outputs.setNamedOutputConnectionPoints([new qe(P0.OUTPUT_HIT,We.BASE),new qe(P0.OUTPUT_MISS,We.BASE)])}triggerHit(o){this.dispatchEventToOutput(P0.OUTPUT_HIT,o)}triggerMiss(o){this.dispatchEventToOutput(P0.OUTPUT_MISS,o)}_processMouseEvent(o){this.pv.mode==Zi.indexOf("cpu")?this.cpuController.updateMouse(o):this.gpuController.updateMouse(o)}_processTriggerEventThrottled(o){let e=Q.performance.performanceManager().now(),t=n=>{let i=this._lastEventProcessedAt;return n-i},r=t(e);r<Ig?setTimeout(()=>{t(e)<Ig&&this._processTriggerEvent(o)},Ig-r):this._processTriggerEvent(o)}_processTriggerEvent(o){this._processMouseEvent(o),this._lastEventProcessedAt=Q.performance.performanceManager().now(),this.pv.mode==Zi.indexOf("cpu")?this.cpuController.processEvent(o):this.gpuController.processEvent(o)}_process_trigger_update_objects(o){this.pv.mode==Zi.indexOf("cpu")&&this.cpuController.update_target()}_process_trigger_vel_reset(o){this.pv.mode==Zi.indexOf("cpu")&&this.cpuController.velocity_controller.reset()}},Ha=P0;Ha.INPUT_TRIGGER="trigger";Ha.INPUT_MOUSE="mouse";Ha.INPUT_UPDATE_OBJECTS="updateObjects";Ha.INPUT_TRIGGER_VEL_RESET="triggerVelReset";Ha.OUTPUT_HIT="hit";Ha.OUTPUT_MISS="miss";var Dg={visibleIf:{active:1},callback:o=>{ul.PARAM_CALLBACK_updateSceneEventsController(o)}},kg={visibleIf:{active:1},callback:o=>{ul.PARAM_CALLBACK_updateTimeDependency(o)}},TB=class extends U{constructor(){super(...arguments);this.active=y.BOOLEAN(!0,{callback:(e,t)=>{ul.PARAM_CALLBACK_updateActiveState(e)},separatorAfter:!0}),this.element=y.INTEGER(0,{hidden:!0}),this.sceneLoaded=y.BOOLEAN(1,Dg),this.play=y.BOOLEAN(1,Dg),this.pause=y.BOOLEAN(1,Dg),this.tick=y.BOOLEAN(1,{separatorAfter:!0,...kg}),this.treachedTime=y.BOOLEAN(0,kg),this.reachedTime=y.FLOAT(10,{visibleIf:{treachedTime:1},range:[0,100],separatorAfter:!0,...kg}),this.setFrameValue=y.INTEGER(1,{range:[0,100]}),this.setFrame=y.BUTTON(null,{callback:e=>{ul.PARAM_CALLBACK_setFrame(e)}})}},Hre=new TB,ul=class extends Lr{constructor(){super(...arguments);this.paramsConfig=Hre,this._timeReached=!1}static type(){return"scene"}dispose(){var e;(e=this._graphNode)==null||e.dispose(),super.dispose()}initializeNode(){this.io.inputs.setNamedInputConnectionPoints([new qe("setFrame",We.BASE,this._onSetFrame.bind(this)),new qe(Tc.PLAY,We.BASE,this._play.bind(this)),new qe(Tc.PAUSE,We.BASE,this._pause.bind(this))]);let e=WC.map(n=>new qe(n,We.BASE));e.push(new qe("tick",We.BASE)),e.push(new qe("timeReached",We.BASE)),this.io.outputs.setNamedOutputConnectionPoints(e),this.params.onParamsCreated("updateTimeDependency",()=>{this._updateTimeDependency()}),this._updateSceneEventsController();let t=()=>{this._updateSceneEventsController()},r=()=>{this.scene().eventsDispatcher.sceneEventsController.removeObserverFromAllEventTypes(this)};this.lifecycle.onAfterAdded(t),this.lifecycle.onBeforeDeleted(r)}processEvent(e){!this.pv.active||!e.event||this.dispatchEventToOutput(e.event.type,e)}_onSetFrame(e){this.scene().setFrame(this.pv.setFrameValue)}_play(e){this.scene().play()}_pause(e){this.scene().pause()}_onTickCheckTimeReached(e,t){e>=this.pv.reachedTime?this._timeReached||(this._timeReached=!0,this.dispatchEventToOutput("timeReached",{})):this._timeReached=!1}_onTickEvent(){this.dispatchEventToOutput("tick",{})}_updateTimeDependency(){var e,t;let r=this.scene().timeController.graphNode;if((e=this._graphNode)==null||e.removeGraphInput(r),!!this.pv.active&&(this.pv.treachedTime||this.pv.tick)){this._graphNode=this._graphNode||new Kt(this.scene(),"sceneNodeTimeGraphNode"),this._graphNode.addGraphInput(r);let n={tick:this.pv.tick,treachedTime:this.pv.treachedTime,reachedTime:this.pv.reachedTime},i=(t=this._buildOnTickCallback(n))==null?void 0:t.bind(this);if(i){let s="timeUpdate";this._graphNode.removePostDirtyHook(s),this._graphNode.addPostDirtyHook(s,i)}}}_buildOnTickCallback(e){if(e.treachedTime&&e.tick)return()=>{let t=this.scene().time();this._onTickEvent(),this._onTickCheckTimeReached(t,e.reachedTime)};if(e.treachedTime)return()=>{let t=this.scene().time();this._onTickCheckTimeReached(t,e.reachedTime)};if(e.tick)return this._onTickEvent.bind(this)}static PARAM_CALLBACK_setFrame(e){e._onSetFrame({})}static PARAM_CALLBACK_updateTimeDependency(e){e._updateTimeDependency()}static PARAM_CALLBACK_updateSceneEventsController(e){e._updateSceneEventsController()}static PARAM_CALLBACK_updateActiveState(e){e._updateTimeDependency(),e._updateSceneEventsController()}_updateSceneEventsController(){let e=this.scene().eventsDispatcher.sceneEventsController;e.removeObserverFromAllEventTypes(this),!!this.pv.active&&(this._updateTimeDependency(),this.pv.sceneLoaded&&e.addObserver(this,Tc.LOADED),this.pv.play&&e.addObserver(this,Tc.PLAY),this.pv.pause&&e.addObserver(this,Tc.PAUSE))}};var R0=["boolean","button","number","vector2","vector3","vector4","string"],AB=R0.indexOf("boolean"),Bg=R0.indexOf("number"),CB=R0.indexOf("vector2"),EB=R0.indexOf("vector3"),SB=R0.indexOf("vector4"),jre=R0.indexOf("string");function pl(){return{cook:!1}}var wB="output",MB=class extends U{constructor(){super(...arguments);this.param=y.PARAM_PATH("",{paramSelection:!0,computeOnDirty:!0}),this.type=y.INTEGER(Bg,{menu:{entries:R0.map((e,t)=>({name:e,value:t}))}}),this.toggle=y.BOOLEAN(0,{visibleIf:{type:AB}}),this.boolean=y.BOOLEAN(0,{visibleIf:{type:AB,toggle:0},...pl()}),this.number=y.FLOAT(0,{visibleIf:{type:Bg},...pl()}),this.vector2=y.VECTOR2([0,0],{visibleIf:{type:CB},...pl()}),this.vector3=y.VECTOR3([0,0,0],{visibleIf:{type:EB},...pl()}),this.vector4=y.VECTOR4([0,0,0,0],{visibleIf:{type:SB},...pl()}),this.increment=y.BOOLEAN(0,{visibleIf:[{type:Bg},{type:CB},{type:EB},{type:SB}],...pl()}),this.string=y.STRING("",{visibleIf:{type:jre},...pl()}),this.execute=y.BUTTON(null,{callback:e=>{H9.PARAM_CALLBACK_execute(e)}})}},Wre=new MB,H9=class extends Lr{constructor(){super(...arguments);this.paramsConfig=Wre,this._tmp_vector2=new z,this._tmp_vector3=new M,this._tmp_vector4=new De,this._tmp_array2=[0,0],this._tmp_array3=[0,0,0],this._tmp_array4=[0,0,0,0]}static type(){return"setParam"}initializeNode(){this.io.inputs.setNamedInputConnectionPoints([new qe("trigger",We.BASE)]),this.io.outputs.setNamedOutputConnectionPoints([new qe(wB,We.BASE)])}setParamType(e){let t=R0.indexOf(e);this.p.type.set(t)}async processEvent(e){this.p.param.isDirty()&&await this.p.param.compute();let t=this.p.param.value.param();if(t){let r=await this._newParamValue(t);r!=null&&t.set(r)}else this.states.error.set("target param not found");this.dispatchEventToOutput(wB,e)}async _newParamValue(e){let t=R0[this.pv.type];switch(t){case"boolean":return await this._computeParamsIfDirty([this.p.toggle]),this.pv.toggle?e.value?0:1:this.pv.boolean?1:0;case"button":return e.options.executeCallback();case"number":return await this._computeParamsIfDirty([this.p.increment,this.p.number]),this.pv.increment?e.type()==J.FLOAT?e.value+this.pv.number:e.value:this.pv.number;case"vector2":return await this._computeParamsIfDirty([this.p.increment,this.p.vector2]),this.pv.increment?e.type()==J.VECTOR2?(this._tmp_vector2.copy(e.value),this._tmp_vector2.add(this.pv.vector2),this._tmp_vector2.toArray(this._tmp_array2)):e.value.toArray(this._tmp_array2):this.pv.vector2.toArray(this._tmp_array2),this._tmp_array2;case"vector3":return await this._computeParamsIfDirty([this.p.increment,this.p.vector3]),this.pv.increment?e.type()==J.VECTOR3?(this._tmp_vector3.copy(e.value),this._tmp_vector3.add(this.pv.vector3),this._tmp_vector3.toArray(this._tmp_array3)):e.value.toArray(this._tmp_array3):this.pv.vector3.toArray(this._tmp_array3),this._tmp_array3;case"vector4":return await this._computeParamsIfDirty([this.p.increment,this.p.vector4]),this.pv.increment?e.type()==J.VECTOR4?(this._tmp_vector4.copy(e.value),this._tmp_vector4.add(this.pv.vector4),this._tmp_vector4.toArray(this._tmp_array4)):e.value.toArray(this._tmp_array4):this.pv.vector4.toArray(this._tmp_array4),this._tmp_array4;case"string":return await this._computeParamsIfDirty([this.p.string]),this.pv.string}Be.unreachable(t)}static PARAM_CALLBACK_execute(e){e.processEvent({})}async _computeParamsIfDirty(e){let t=[];for(let n of e)n.isDirty()&&t.push(n);let r=[];for(let n of t)r.push(n.compute());return await Promise.all(r)}};var qB=Ni(WB()),Ug={callback:o=>{j9.PARAM_CALLBACK_resetDebouncedFunc(o)}},XB=class extends U{constructor(){super(...arguments);this.time=y.INTEGER(100,{range:[0,1e3],rangeLocked:[!0,!1],...Ug}),this.leading=y.BOOLEAN(!0,Ug),this.trailing=y.BOOLEAN(!0,Ug)}},yoe=new XB,Vg=class extends Lr{constructor(){super(...arguments);this.paramsConfig=yoe}static type(){return"throttle"}initializeNode(){this.io.inputs.setNamedInputConnectionPoints([new qe("trigger",We.BASE)]),this.io.outputs.setNamedOutputConnectionPoints([new qe(Vg.OUTPUT_NAME,We.BASE)])}processEvent(o){this._lastEventContextReceived=o,this._debouncedFunc=this._debouncedFunc||this._buildDebouncedFunc(),this._debouncedFunc()}_buildDebouncedFunc(){let{leading:o,trailing:e,time:t}=this.pv;return(0,qB.default)(()=>{this._lastEventContextReceived&&this.dispatchEventToOutput(Vg.OUTPUT_NAME,this._lastEventContextReceived)},t,{leading:o,trailing:e})}_resetDebouncedFunc(){this._debouncedFunc=void 0}static PARAM_CALLBACK_resetDebouncedFunc(o){o._resetDebouncedFunc()}},j9=Vg;j9.OUTPUT_NAME="output";var Qi=class extends fr{constructor(){super(...arguments);this._cook_main_without_inputs_when_dirty_bound=this._cook_main_without_inputs_when_dirty.bind(this)}static context(){return oe.MAT}initializeBaseNode(){super.initializeBaseNode(),this.nameController.add_post_set_fullPath_hook(this.set_material_name.bind(this)),this.addPostDirtyHook("_cook_main_without_inputs_when_dirty",()=>{setTimeout(this._cook_main_without_inputs_when_dirty_bound,0)})}async _cook_main_without_inputs_when_dirty(){await this.cookController.cookMainWithoutInputs()}set_material_name(){this._material&&(this._material.name=this.path())}get material(){return this._material=this._material||this.createMaterial()}setMaterial(e){this._setContainer(e)}};var Fr=class{constructor(e){this.node=e}update(){}get material(){return this.node.material}};function Uf(o,e){let t=e.front?gr:Mt,r=e.doubleSided?Wr:t;if(r!=o.side&&(o.side=r,o.needsUpdate=!0),e.overrideShadowSide){let i=e.shadowFront?gr:Mt,s=e.shadowDoubleSided?Wr:i;s!=o.shadowSide&&(o.shadowSide=s,o.needsUpdate=!0)}else o.shadowSide=null;let n=o.customMaterials;if(n){let i=Object.keys(n);for(let s of i){let a=n[s];a&&Uf(a,e)}}}var YB={NoBlending:un,NormalBlending:gc,AdditiveBlending:Vd,SubtractiveBlending:Gd,MultiplyBlending:zd},xoe=Object.keys(YB);function oo(o){return class extends o{constructor(){super(...arguments);this.doubleSided=y.BOOLEAN(0),this.front=y.BOOLEAN(1,{visibleIf:{doubleSided:!1}}),this.overrideShadowSide=y.BOOLEAN(0),this.shadowDoubleSided=y.BOOLEAN(0,{visibleIf:{overrideShadowSide:!0}}),this.shadowFront=y.BOOLEAN(1,{visibleIf:{overrideShadowSide:!0,shadowDoubleSided:!1}}),this.colorWrite=y.BOOLEAN(1,{separatorBefore:!0,cook:!1,callback:(t,r)=>{Or.update(t)}}),this.depthWrite=y.BOOLEAN(1,{cook:!1,callback:(t,r)=>{Or.update(t)}}),this.depthTest=y.BOOLEAN(1,{cook:!1,callback:(t,r)=>{Or.update(t)}}),this.premultipliedAlpha=y.BOOLEAN(!1,{separatorAfter:!0}),this.blending=y.INTEGER(gc,{menu:{entries:xoe.map(t=>({name:t,value:YB[t]}))}}),this.dithering=y.BOOLEAN(0),this.polygonOffset=y.BOOLEAN(!1,{separatorBefore:!0}),this.polygonOffsetFactor=y.INTEGER(0,{range:[0,1e3],visibleIf:{polygonOffset:1}}),this.polygonOffsetUnits=y.INTEGER(0,{range:[0,1e3],visibleIf:{polygonOffset:1}})}}}var boe=class extends oo(U){};var Or=class extends Fr{constructor(e){super(e);this.node=e}initializeNode(){}async update(){let e=this.node.material,t=this.node.pv;this._updateSides(e,t),e.colorWrite=t.colorWrite,e.depthWrite=t.depthWrite,e.depthTest=t.depthTest,e.blending=t.blending,e.premultipliedAlpha=t.premultipliedAlpha,e.dithering=t.dithering,e.polygonOffset=t.polygonOffset,e.polygonOffset&&(e.polygonOffsetFactor=t.polygonOffsetFactor,e.polygonOffsetUnits=t.polygonOffsetUnits,e.needsUpdate=!0)}_updateSides(e,t){Uf(e,t)}static async update(e){e.controllers.advancedCommon.update()}};var $B=class extends oo(U){constructor(){super(...arguments);this.color=y.COLOR([1,1,1]),this.lineWidth=y.FLOAT(1,{range:[1,10],rangeLocked:[!0,!1]})}},Toe=new $B,Gg=class extends Qi{constructor(){super(...arguments);this.paramsConfig=Toe,this.controllers={advancedCommon:new Or(this)},this.controllerNames=Object.keys(this.controllers)}static type(){return"lineBasic"}createMaterial(){return new ir({color:16777215,linewidth:1})}initializeNode(){this.params.onParamsCreated("init controllers",()=>{for(let e of this.controllerNames)this.controllers[e].initializeNode()})}async cook(){for(let e of this.controllerNames)this.controllers[e].update();this.material.color.copy(this.pv.color),this.material.linewidth=this.pv.lineWidth,this.material.needsUpdate=!0,this.setMaterial(this.material)}};function es(o){return class extends o{constructor(){super(...arguments);this.transparent=y.BOOLEAN(0),this.opacity=y.FLOAT(1),this.alphaTest=y.FLOAT(0)}}}var Aoe=class extends es(U){};var ts=class extends Fr{constructor(e){super(e);this.node=e}static update(e){let t=e.material,r=e.pv;this._updateTransparency(t,r)}static _updateTransparency(e,t){e.transparent=t.transparent,this._updateCommon(e,t)}static _updateCommon(e,t){let r=e;r.uniforms&&r.uniforms.opacity&&(r.uniforms.opacity.value=t.opacity),e.opacity=t.opacity,r.uniforms&&r.uniforms.alphaTest&&(r.uniforms.alphaTest.value=t.alphaTest),e.alphaTest=t.alphaTest;let n=e.customMaterials;if(n){let i=Object.keys(n);for(let s of i){let a=n[s];a&&this._updateCommon(a,t)}}}};var zg={};x3(zg,{LineBasicMaterial:()=>ir,LineDashedMaterial:()=>$9,Material:()=>Ut,MeshBasicMaterial:()=>_n,MeshDepthMaterial:()=>Eu,MeshDistanceMaterial:()=>Su,MeshLambertMaterial:()=>cd,MeshMatcapMaterial:()=>Y9,MeshNormalMaterial:()=>X9,MeshPhongMaterial:()=>y1,MeshPhysicalMaterial:()=>on,MeshStandardMaterial:()=>In,MeshToonMaterial:()=>q9,PointsMaterial:()=>c0,RawShaderMaterial:()=>K0,ShaderMaterial:()=>Sr,ShadowMaterial:()=>W9,SpriteMaterial:()=>ad});var W9=class extends Ut{constructor(e){super();this.type="ShadowMaterial",this.color=new de(0),this.transparent=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this}};W9.prototype.isShadowMaterial=!0;var ad=class extends Ut{constructor(e){super();this.type="SpriteMaterial",this.color=new de(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this}};ad.prototype.isSpriteMaterial=!0;var on=class extends In{constructor(e){super();this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new z(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Li(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.sheenColor=new de(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=0,this.attenuationColor=new de(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new de(1,1,1),this.specularColorMap=null,this._sheen=0,this._clearcoat=0,this._transmission=0,this.setValues(e)}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}};on.prototype.isMeshPhysicalMaterial=!0;var q9=class extends Ut{constructor(e){super();this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new de(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new de(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=hn,this.normalScale=new z(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this}};q9.prototype.isMeshToonMaterial=!0;var X9=class extends Ut{constructor(e){super();this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=hn,this.normalScale=new z(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}};X9.prototype.isMeshNormalMaterial=!0;var cd=class extends Ut{constructor(e){super();this.type="MeshLambertMaterial",this.color=new de(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new de(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=lu,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this}};cd.prototype.isMeshLambertMaterial=!0;var Y9=class extends Ut{constructor(e){super();this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new de(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=hn,this.normalScale=new z(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this}};Y9.prototype.isMeshMatcapMaterial=!0;var $9=class extends ir{constructor(e){super();this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}};$9.prototype.isLineDashedMaterial=!0;var Vf=class extends lo{constructor(e){super(e);this.textures={}}load(e,t,r,n){let i=this,s=new Xo(i.manager);s.setPath(i.path),s.setRequestHeader(i.requestHeader),s.setWithCredentials(i.withCredentials),s.load(e,function(a){try{t(i.parse(JSON.parse(a)))}catch(c){n?n(c):console.error(c),i.manager.itemError(e)}},r,n)}parse(e){let t=this.textures;function r(i){return t[i]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",i),t[i]}let n=new zg[e.type];if(e.uuid!==void 0&&(n.uuid=e.uuid),e.name!==void 0&&(n.name=e.name),e.color!==void 0&&n.color!==void 0&&n.color.setHex(e.color),e.roughness!==void 0&&(n.roughness=e.roughness),e.metalness!==void 0&&(n.metalness=e.metalness),e.sheen!==void 0&&(n.sheen=e.sheen),e.sheenColor!==void 0&&(n.sheenColor=new de().setHex(e.sheenColor)),e.sheenRoughness!==void 0&&(n.sheenRoughness=e.sheenRoughness),e.emissive!==void 0&&n.emissive!==void 0&&n.emissive.setHex(e.emissive),e.specular!==void 0&&n.specular!==void 0&&n.specular.setHex(e.specular),e.specularIntensity!==void 0&&(n.specularIntensity=e.specularIntensity),e.specularColor!==void 0&&n.specularColor!==void 0&&n.specularColor.setHex(e.specularColor),e.shininess!==void 0&&(n.shininess=e.shininess),e.clearcoat!==void 0&&(n.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(n.clearcoatRoughness=e.clearcoatRoughness),e.transmission!==void 0&&(n.transmission=e.transmission),e.thickness!==void 0&&(n.thickness=e.thickness),e.attenuationDistance!==void 0&&(n.attenuationDistance=e.attenuationDistance),e.attenuationColor!==void 0&&n.attenuationColor!==void 0&&n.attenuationColor.setHex(e.attenuationColor),e.fog!==void 0&&(n.fog=e.fog),e.flatShading!==void 0&&(n.flatShading=e.flatShading),e.blending!==void 0&&(n.blending=e.blending),e.combine!==void 0&&(n.combine=e.combine),e.side!==void 0&&(n.side=e.side),e.shadowSide!==void 0&&(n.shadowSide=e.shadowSide),e.opacity!==void 0&&(n.opacity=e.opacity),e.transparent!==void 0&&(n.transparent=e.transparent),e.alphaTest!==void 0&&(n.alphaTest=e.alphaTest),e.depthTest!==void 0&&(n.depthTest=e.depthTest),e.depthWrite!==void 0&&(n.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(n.colorWrite=e.colorWrite),e.stencilWrite!==void 0&&(n.stencilWrite=e.stencilWrite),e.stencilWriteMask!==void 0&&(n.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(n.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(n.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(n.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(n.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(n.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(n.stencilZPass=e.stencilZPass),e.wireframe!==void 0&&(n.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(n.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(n.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(n.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(n.rotation=e.rotation),e.linewidth!==1&&(n.linewidth=e.linewidth),e.dashSize!==void 0&&(n.dashSize=e.dashSize),e.gapSize!==void 0&&(n.gapSize=e.gapSize),e.scale!==void 0&&(n.scale=e.scale),e.polygonOffset!==void 0&&(n.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(n.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(n.polygonOffsetUnits=e.polygonOffsetUnits),e.dithering!==void 0&&(n.dithering=e.dithering),e.alphaToCoverage!==void 0&&(n.alphaToCoverage=e.alphaToCoverage),e.premultipliedAlpha!==void 0&&(n.premultipliedAlpha=e.premultipliedAlpha),e.visible!==void 0&&(n.visible=e.visible),e.toneMapped!==void 0&&(n.toneMapped=e.toneMapped),e.userData!==void 0&&(n.userData=e.userData),e.vertexColors!==void 0&&(typeof e.vertexColors=="number"?n.vertexColors=e.vertexColors>0:n.vertexColors=e.vertexColors),e.uniforms!==void 0)for(let i in e.uniforms){let s=e.uniforms[i];switch(n.uniforms[i]={},s.type){case"t":n.uniforms[i].value=r(s.value);break;case"c":n.uniforms[i].value=new de().setHex(s.value);break;case"v2":n.uniforms[i].value=new z().fromArray(s.value);break;case"v3":n.uniforms[i].value=new M().fromArray(s.value);break;case"v4":n.uniforms[i].value=new De().fromArray(s.value);break;case"m3":n.uniforms[i].value=new qo().fromArray(s.value);break;case"m4":n.uniforms[i].value=new Ue().fromArray(s.value);break;default:n.uniforms[i].value=s.value}}if(e.defines!==void 0&&(n.defines=e.defines),e.vertexShader!==void 0&&(n.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(n.fragmentShader=e.fragmentShader),e.extensions!==void 0)for(let i in e.extensions)n.extensions[i]=e.extensions[i];if(e.shading!==void 0&&(n.flatShading=e.shading===1),e.size!==void 0&&(n.size=e.size),e.sizeAttenuation!==void 0&&(n.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(n.map=r(e.map)),e.matcap!==void 0&&(n.matcap=r(e.matcap)),e.alphaMap!==void 0&&(n.alphaMap=r(e.alphaMap)),e.bumpMap!==void 0&&(n.bumpMap=r(e.bumpMap)),e.bumpScale!==void 0&&(n.bumpScale=e.bumpScale),e.normalMap!==void 0&&(n.normalMap=r(e.normalMap)),e.normalMapType!==void 0&&(n.normalMapType=e.normalMapType),e.normalScale!==void 0){let i=e.normalScale;Array.isArray(i)===!1&&(i=[i,i]),n.normalScale=new z().fromArray(i)}return e.displacementMap!==void 0&&(n.displacementMap=r(e.displacementMap)),e.displacementScale!==void 0&&(n.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(n.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(n.roughnessMap=r(e.roughnessMap)),e.metalnessMap!==void 0&&(n.metalnessMap=r(e.metalnessMap)),e.emissiveMap!==void 0&&(n.emissiveMap=r(e.emissiveMap)),e.emissiveIntensity!==void 0&&(n.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(n.specularMap=r(e.specularMap)),e.specularIntensityMap!==void 0&&(n.specularIntensityMap=r(e.specularIntensityMap)),e.specularColorMap!==void 0&&(n.specularColorMap=r(e.specularColorMap)),e.envMap!==void 0&&(n.envMap=r(e.envMap)),e.envMapIntensity!==void 0&&(n.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(n.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(n.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(n.lightMap=r(e.lightMap)),e.lightMapIntensity!==void 0&&(n.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(n.aoMap=r(e.aoMap)),e.aoMapIntensity!==void 0&&(n.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(n.gradientMap=r(e.gradientMap)),e.clearcoatMap!==void 0&&(n.clearcoatMap=r(e.clearcoatMap)),e.clearcoatRoughnessMap!==void 0&&(n.clearcoatRoughnessMap=r(e.clearcoatRoughnessMap)),e.clearcoatNormalMap!==void 0&&(n.clearcoatNormalMap=r(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(n.clearcoatNormalScale=new z().fromArray(e.clearcoatNormalScale)),e.transmissionMap!==void 0&&(n.transmissionMap=r(e.transmissionMap)),e.thicknessMap!==void 0&&(n.thicknessMap=r(e.thicknessMap)),e.sheenColorMap!==void 0&&(n.sheenColorMap=r(e.sheenColorMap)),e.sheenRoughnessMap!==void 0&&(n.sheenRoughnessMap=r(e.sheenRoughnessMap)),n}setTextures(e){return this.textures=e,this}};var Gf=class{constructor(e){this.node=e}toJSON(){}load(e){}_materialToJson(e,t){let r;return this._withPreparedMaterial(e,()=>{try{r=e.toJSON({}),r&&(r.shadowSide=e.shadowSide,r.colorWrite=e.colorWrite)}catch(n){console.error("failed to save material data"),console.log(e),console.log(n)}r&&e.lights!=null&&(r.lights=e.lights),r&&(r.uuid=`${t.node.path()}-${t.suffix}`)}),r}_withPreparedMaterial(e,t){this._withUnassignedUniformTextures(e,()=>{this._withUnassignedBasePropertyTextures(e,()=>{this._withUnassignedOnBeforeCompileData(e,()=>{t()})})})}_withUnassignedOnBeforeCompileData(e,t){let r=Uu.removeUniforms(e),n=sa.removeData(e);t(),r&&Uu.setUniforms(e,r),n&&sa.setData(e,n)}_withUnassignedUniformTextures(e,t){let r=new Map,n=e.uniforms;if(n){let i=Object.keys(n);for(let s of i){let a=n[s].value;if(a&&a.uuid){let c=a;r.set(s,c),n[s].value=null}}}t(),n&&r.forEach((i,s)=>{n[s].value=i})}_withUnassignedBasePropertyTextures(e,t){let r=new Map,n=Object.keys(e);for(let i of n){let s=e[i];s&&s.uuid&&s instanceof vr&&(r.set(i,s),e[i]=null)}t(),r.forEach((i,s)=>{e[s]=i})}_loadMaterial(e){e.color=void 0;let r=new Vf().parse(e);e.shadowSide&&(r.shadowSide=e.shadowSide),e.lights!=null&&(r.lights=e.lights);let n=r.uniforms;if(n){let i=n.uv2Transform;i&&this.mat4ToMat3(i);let s=n.uvTransform;s&&this.mat4ToMat3(s)}return r}mat4ToMat3(e){let t=e.value;if(t.elements[t.elements.length-1]==null){let n=new qo;for(let i=0;i<n.elements.length;i++)n.elements[i]=t.elements[i];e.value=n}}};var Hg=class extends Gf{constructor(e){super(e);this.node=e}toJSON(){let e=this.node.assemblerController();if(!e)return;let t=e.assembler,r=t.onBeforeCompileData();if(!r)return;let n=ia.toJSON(r),i={},s=this.node.material.customMaterials;s&&t.traverseCustomAssemblers((l,u)=>{let p=l.onBeforeCompileData();if(p){let d=s[u];if(d){let h=this._materialToJson(d,{node:this.node,suffix:u});h&&(i[u]={material:h,onBeforeCompileDataJSON:ia.toJSON(p)})}}});let a=this._materialToJson(this.node.material,{node:this.node,suffix:"main"});return a||console.warn("failed to save material from node",this.node.path()),{material:a||{},onBeforeCompileDataJSON:n,customMaterials:i}}load(e){if(this.node.assemblerController()||(this._material=this._loadMaterial(e.material),!this._material))return;let r=ia.fromJSON(e.onBeforeCompileDataJSON),n=this._material;Q1(this.node.scene(),n,r);for(let i of r.paramConfigs)i.applyToNode(this.node);if(this._material.customMaterials=this._material.customMaterials||{},e.customMaterials){let i=Object.keys(e.customMaterials);for(let s of i){let a=e.customMaterials[s],c=this._loadMaterial(a.material);if(c){let l=ia.fromJSON(a.onBeforeCompileDataJSON);l.paramConfigs=r.paramConfigs,Q1(this.node.scene(),c,l),this._material.customMaterials[s]=c}}}}material(){return this._material}};function rs(o){return class extends o{constructor(){super(...arguments);this.setBuilderNode=y.BOOLEAN(0,{callback:t=>{Xn.PARAM_CALLBACK_setCompileRequired(t)}}),this.builderNode=y.NODE_PATH("",{visibleIf:{setBuilderNode:!0},callback:t=>{Xn.PARAM_CALLBACK_setCompileRequired(t)}})}}}var Coe=class extends rs(U){},Xn=class extends Qi{constructor(){super(...arguments);this._childrenControllerContext=oe.GL,this.persisted_config=new Hg(this)}createMaterial(){var e;let t;return this.persisted_config&&(t=this.persisted_config.material()),t||(t=(e=this.assemblerController())==null?void 0:e.assembler.createMaterial()),t}assemblerController(){return this._assemblerController=this._assemblerController||this._createAssemblerController()}createNode(e,t){return super.createNode(e,t)}children(){return super.children()}nodesByType(e){return super.nodesByType(e)}childrenAllowed(){return this.assemblerController()?super.childrenAllowed():(this.scene().markAsReadOnly(this),!1)}compileIfRequired(){var e;if((e=this.assemblerController())==null?void 0:e.compileRequired())try{this._compile()}catch(t){let r=t.message||"failed to compile";this.states.error.set(r)}}_compile(){let e=this.assemblerController();this.material&&e&&(e.assembler.setGlParentNode(this),this._setAssemblerGlParentNode(e),e.assembler.compileMaterial(this.material),e.post_compile())}_setAssemblerGlParentNode(e){if(!this.pv.setBuilderNode)return;let t=this.pv.builderNode.nodeWithContext(oe.MAT);if(!t)return;let r=t;if(!r.assemblerController()){this.states.error.set(`resolved node '${t.path()}' is not a builder node`);return}if(r.type()!=this.type()){this.states.error.set(`resolved node '${t.path()}' does not have the same type '${t.type()}' as current node '${this.type()}'`);return}e.assembler.setGlParentNode(r)}static PARAM_CALLBACK_setCompileRequired(e){e.PARAM_CALLBACK_setCompileRequired()}PARAM_CALLBACK_setCompileRequired(){var e;(e=this.assemblerController())==null||e.setCompilationRequired(!0)}};function os(o){return class extends o{constructor(){super(...arguments);this.useFog=y.BOOLEAN(0)}}}var Eoe=class extends os(U){};var ns=class extends Fr{constructor(e){super(e);this.node=e}static update(e){let t=e.material,r=e.pv;t.fog=r.useFog}};function zo(o){return class extends o{constructor(){super(...arguments);this.default=y.FOLDER(null)}}}function Ho(o){return class extends o{constructor(){super(...arguments);this.advanced=y.FOLDER(null)}}}var KB=class extends os(oo(rs(Ho(es(zo(U)))))){constructor(){super(...arguments);this.linewidth=y.FLOAT(1,{range:[0,10],rangeLocked:[!0,!1]})}},Soe=new KB,jg=class extends Xn{constructor(){super(...arguments);this.paramsConfig=Soe,this.controllers={advancedCommon:new Or(this)},this.controllerNames=Object.keys(this.controllers)}static type(){return"lineBasicBuilder"}usedAssembler(){return Pn.GL_LINE}_createAssemblerController(){return Q.assemblersRegister.assembler(this,this.usedAssembler())}initializeNode(){this.params.onParamsCreated("init controllers",()=>{for(let e of this.controllerNames)this.controllers[e].initializeNode()})}async cook(){for(let e of this.controllerNames)this.controllers[e].update();ts.update(this),ns.update(this),this.compileIfRequired(),this.material.linewidth=this.pv.linewidth,this.setMaterial(this.material)}};function dl(o){return class extends o{constructor(){super(...arguments);this.color=y.COLOR([1,1,1],{conversion:ko.SRGB_TO_LINEAR}),this.useVertexColors=y.BOOLEAN(0,{separatorAfter:!0}),this.transparent=y.BOOLEAN(0),this.opacity=y.FLOAT(1),this.alphaTest=y.FLOAT(0)}}}var woe=class extends dl(U){};var hl=class extends Fr{constructor(e){super(e);this.node=e}static update(e){let t=e.material,r=e.pv;t.color.copy(r.color);let n=r.useVertexColors;n!=t.vertexColors&&(t.vertexColors=n,t.needsUpdate=!0),t.opacity=r.opacity,t.transparent=r.transparent,t.alphaTest=r.alphaTest}};function fl(o){return class extends o{constructor(){super(...arguments);this.useFog=y.BOOLEAN(0)}}}var Moe=class extends fl(U){};var ml=class extends Fr{constructor(e){super(e);this.node=e}static update(e){let t=e.material,r=e.pv;t.fog=r.useFog}};function $t(o){return{cook:!1,callback:(e,t)=>{o.update(e)}}}function Pt(o,e,t){return{visibleIf:{[e]:1},nodeSelection:{context:oe.COP,types:t==null?void 0:t.types},cook:!1,callback:(r,n)=>{o.update(r)}}}var or=class extends Fr{constructor(e){super(e);this.node=e}add_hooks(e,t){e.addPostDirtyHook("TextureController",()=>{this.update()}),t.addPostDirtyHook("TextureController",()=>{this.update()})}static update(e){}async _update(e,t,r,n){let i=e,s=t;await this._update_texture_on_material(i,s,r,n)}async _update_texture_on_material(e,t,r,n){this._update_required_attribute(e,e,t,r,n,this._apply_texture_on_material.bind(this),this._remove_texture_from_material.bind(this))}_apply_texture_on_material(e,t,r,n){let i=t[r],s=!1;i&&i.uuid!=n.uuid&&(s=!0),(i==null||s)&&(t[r]=n,e.needsUpdate=!0)}_remove_texture_from_material(e,t,r){t[r]&&(t[r]=null,e.needsUpdate=!0)}async _update_required_attribute(e,t,r,n,i,s,a){if(n.isDirty()&&await n.compute(),n.value){i.isDirty()&&await i.compute();let l=i.value.nodeWithContext(oe.COP);if(l){let p=(await l.compute()).texture();if(p){s(e,t,r,p);return}}}a(e,t,r)}};function Yn(o){return class extends o{constructor(){super(...arguments);this.useMap=y.BOOLEAN(0,$t(nn)),this.map=y.NODE_PATH("",Pt(nn,"useMap"))}}}var Noe=class extends Yn(U){};var nn=class extends or{constructor(e){super(e);this.node=e}initializeNode(){this.add_hooks(this.node.p.useMap,this.node.p.map)}async update(){this._update(this.node.material,"map",this.node.p.useMap,this.node.p.map)}static async update(e){e.controllers.map.update()}};function $n(o){return class extends o{constructor(){super(...arguments);this.useAlphaMap=y.BOOLEAN(0,{separatorBefore:!0,...$t(sn)}),this.alphaMap=y.NODE_PATH("",Pt(sn,"useAlphaMap"))}}}var Ooe=class extends $n(U){};var sn=class extends or{constructor(e){super(e);this.node=e}initializeNode(){this.add_hooks(this.node.p.useAlphaMap,this.node.p.alphaMap)}async update(){this._update(this.node.material,"alphaMap",this.node.p.useAlphaMap,this.node.p.alphaMap)}static async update(e){e.controllers.alphaMap.update()}};function Kn(o){return class extends o{constructor(){super(...arguments);this.useAOMap=y.BOOLEAN(0,{separatorBefore:!0,...$t(an)}),this.aoMap=y.NODE_PATH("",Pt(an,"useAOMap")),this.aoMapIntensity=y.FLOAT(1,{range:[0,1],rangeLocked:[!1,!1],visibleIf:{useAOMap:1}})}}}var Poe=class extends Kn(U){};var an=class extends or{constructor(e){super(e);this.node=e}initializeNode(){this.add_hooks(this.node.p.useAOMap,this.node.p.aoMap)}async update(){this._update(this.node.material,"aoMap",this.node.p.useAOMap,this.node.p.aoMap);let e=this.node.material;e.aoMapIntensity=this.node.pv.aoMapIntensity}static async update(e){e.controllers.aoMap.update()}};var Wg=(o=>(o.CUBE_CAMERA="cubeCamera",o.VIDEO="video",o.WEB_CAM="webCam",o.SNAPSHOT="snapshot",o))(Wg||{});var JB=["mult","add","mix"],Roe={mult:lu,add:Wm,mix:jm};function I0(o){return class extends o{constructor(){super(...arguments);this.useEnvMap=y.BOOLEAN(0,{separatorBefore:!0,...$t(is)}),this.envMap=y.NODE_PATH("",Pt(is,"useEnvMap",{types:[Wg.CUBE_CAMERA]})),this.combine=y.INTEGER(0,{visibleIf:{useEnvMap:1},menu:{entries:JB.map((t,r)=>({name:t,value:r}))}}),this.reflectivity=y.FLOAT(1,{visibleIf:{useEnvMap:1}}),this.refractionRatio=y.FLOAT(.98,{range:[-1,1],rangeLocked:[!1,!1],visibleIf:{useEnvMap:1}})}}}var Ioe=class extends I0(U){};var is=class extends or{constructor(e){super(e);this.node=e}initializeNode(){this.add_hooks(this.node.p.useEnvMap,this.node.p.envMap)}async update(){this._update(this.node.material,"envMap",this.node.p.useEnvMap,this.node.p.envMap);let e=Roe[JB[this.node.pv.combine]],t=this.node.material;t.combine=e,t.reflectivity=this.node.pv.reflectivity,t.refractionRatio=this.node.pv.refractionRatio}static async update(e){e.controllers.envMap.update()}};function ss(o){return class extends o{constructor(){super(...arguments);this.useLightMap=y.BOOLEAN(0,{separatorBefore:!0,...$t(Jn)}),this.lightMap=y.NODE_PATH("",Pt(Jn,"useLightMap")),this.lightMapIntensity=y.FLOAT(1,{visibleIf:{useLightMap:1}})}}}var Loe=class extends ss(U){};var Jn=class extends or{constructor(e){super(e);this.node=e}initializeNode(){this.add_hooks(this.node.p.useLightMap,this.node.p.lightMap)}async update(){this._update(this.node.material,"lightMap",this.node.p.useLightMap,this.node.p.lightMap);let e=this.node.material;e.lightMapIntensity=this.node.pv.lightMapIntensity}static async update(e){e.controllers.lightMap.update()}};var ZB=["round","butt","square"];var QB=["round","bevel","miter"];function _l(o){return class extends o{constructor(){super(...arguments);this.wireframe=y.BOOLEAN(0,{separatorBefore:!0}),this.wireframeLinecap=y.INTEGER(0,{menu:{entries:ZB.map((t,r)=>({name:t,value:r}))},visibleIf:{wireframe:1}}),this.wireframeLinejoin=y.INTEGER(0,{menu:{entries:QB.map((t,r)=>({name:t,value:r}))},visibleIf:{wireframe:1}})}}}var Doe=class extends _l(U){};var gl=class extends Fr{constructor(e){super(e);this.node=e}static update(e){let t=e.material,r=e.pv;t.wireframe=r.wireframe,t.wireframeLinecap=ZB[r.wireframeLinecap],t.wireframeLinejoin=QB[r.wireframeLinejoin],t.needsUpdate=!0}};function Ci(o){return class extends o{constructor(){super(...arguments);this.textures=y.FOLDER(null)}}}var eF=class extends fl(_l(oo(Ho(ss(I0(Kn($n(Yn(Ci(dl(zo(U)))))))))))){},koe=new eF,qg=class extends Qi{constructor(){super(...arguments);this.paramsConfig=koe,this.controllers={advancedCommon:new Or(this),alphaMap:new sn(this),aoMap:new an(this),envMap:new is(this),lightMap:new Jn(this),map:new nn(this)},this.controllerNames=Object.keys(this.controllers)}static type(){return"meshBasic"}createMaterial(){return new _n({vertexColors:!1,side:gr,color:16777215,opacity:1})}initializeNode(){this.params.onParamsCreated("init controllers",()=>{for(let e of this.controllerNames)this.controllers[e].initializeNode()})}async cook(){for(let e of this.controllerNames)this.controllers[e].update();hl.update(this),ml.update(this),gl.update(this),this.setMaterial(this.material)}};function vl(o){return class extends o{constructor(){super(...arguments);this.wireframe=y.BOOLEAN(0)}}}var Boe=class extends vl(U){};var yl=class extends Fr{constructor(e){super(e);this.node=e}static update(e){let t=e.material,r=e.pv,n=t;n.wireframe!=null&&(n.wireframe=r.wireframe,n.needsUpdate=!0)}};var tF=class extends os(vl(oo(rs(Ho(I0(Kn($n(Yn(Ci(es(zo(U)))))))))))){},Foe=new tF,Xg=class extends Xn{constructor(){super(...arguments);this.paramsConfig=Foe,this.controllers={advancedCommon:new Or(this),alphaMap:new sn(this),aoMap:new an(this),envMap:new is(this),map:new nn(this)},this.controllerNames=Object.keys(this.controllers)}static type(){return"meshBasicBuilder"}usedAssembler(){return Pn.GL_MESH_BASIC}_createAssemblerController(){return Q.assemblersRegister.assembler(this,this.usedAssembler())}initializeNode(){this.params.onParamsCreated("init controllers",()=>{for(let e of this.controllerNames)this.controllers[e].initializeNode()})}async cook(){for(let e of this.controllerNames)this.controllers[e].update();ts.update(this),ns.update(this),yl.update(this),this.compileIfRequired(),this.setMaterial(this.material)}};function L0(o){return class extends o{constructor(){super(...arguments);this.emissive=y.COLOR([0,0,0],{separatorBefore:!0}),this.useEmissiveMap=y.BOOLEAN(0,$t(as)),this.emissiveMap=y.NODE_PATH("",Pt(as,"useEmissiveMap")),this.emissiveIntensity=y.FLOAT(1)}}}var Uoe=class extends L0(U){};var as=class extends or{constructor(e){super(e);this.node=e}initializeNode(){this.add_hooks(this.node.p.useEmissiveMap,this.node.p.emissiveMap)}async update(){this._update(this.node.material,"emissiveMap",this.node.p.useEmissiveMap,this.node.p.emissiveMap);let e=this.node.material;e.emissive.copy(this.node.pv.emissive),e.emissiveIntensity=this.node.pv.emissiveIntensity}static async update(e){e.controllers.emissiveMap.update()}};var sF=Ni(oF()),aF=Ni(iF());var ja=class{static any(e){return K.isString(e)?e:K.isBoolean(e)?`${e}`:K.isNumber(e)?`${Ve.ensureFloat(e)}`:K.isArray(e)?this.numeric_array(e):e instanceof z||e instanceof M||e instanceof De||e instanceof de?this.numeric_array(e.toArray()):`ThreeToGl error: unknown value type '${e}'`}static numeric_array(e){let t=new Array(e.length);for(let n=0;n<e.length;n++)t[n]=`${Ve.ensureFloat(e[n])}`;return`${`vec${e.length}`}(${t.join(", ")})`}static vector4(e){return K.isString(e)?e:`vec4(${e.toArray().map(r=>`${Ve.ensureFloat(r)}`).join(", ")})`}static vector3(e){return K.isString(e)?e:`vec3(${e.toArray().map(r=>`${Ve.ensureFloat(r)}`).join(", ")})`}static vector2(e){return K.isString(e)?e:`vec2(${e.toArray().map(r=>`${Ve.ensureFloat(r)}`).join(", ")})`}static vector3_float(e,t){return K.isNumber(t)&&(t=Ve.ensureFloat(t)),`vec4(${this.vector3(e)}, ${t})`}static float4(e,t,r,n){return K.isNumber(e)&&(e=Ve.ensureFloat(e)),K.isNumber(t)&&(t=Ve.ensureFloat(t)),K.isNumber(r)&&(r=Ve.ensureFloat(r)),K.isNumber(n)&&(n=Ve.ensureFloat(n)),`vec4(${e}, ${t}, ${r}, ${n})`}static float3(e,t,r){return K.isNumber(e)&&(e=Ve.ensureFloat(e)),K.isNumber(t)&&(t=Ve.ensureFloat(t)),K.isNumber(r)&&(r=Ve.ensureFloat(r)),`vec3(${e}, ${t}, ${r})`}static float2(e,t){return K.isNumber(e)&&(e=Ve.ensureFloat(e)),K.isNumber(t)&&(t=Ve.ensureFloat(t)),`vec2(${e}, ${t})`}static float(e){if(K.isNumber(e))return Ve.ensureFloat(e);{let t=parseFloat(e);return K.isNaN(t)?e:Ve.ensureFloat(t)}}static integer(e){if(K.isNumber(e))return Ve.ensureInteger(e);{let t=parseInt(e);return K.isNaN(t)?e:Ve.ensureInteger(t)}}static bool(e){return K.isBoolean(e)?`${e}`:e}};function zf(o){return class extends o{constructor(){super(...arguments);this.shadowPCSS=y.BOOLEAN(0,{callback:t=>{Wa.PARAM_CALLBACK_setRecompileRequired(t)},separatorBefore:!0}),this.shadowPCSSFilterSize=y.FLOAT(1,{visibleIf:{shadowPCSS:1},range:[0,10],rangeLocked:[!0,!1]})}}}var Voe=class extends zf(U){};var Wa=class extends Fr{constructor(e){super(e);this.node=e}initializeNode(){}static filterFragmentShader(e,t){let r=`
#define PCSS_FILTER_SIZE ${ja.float(e.pv.shadowPCSSFilterSize)}
${sF.default}
`,n=A1;return n=n.replace("#ifdef USE_SHADOWMAP",`#ifdef USE_SHADOWMAP
${r}
				`),n=n.replace("#if defined( SHADOWMAP_TYPE_PCF )",`
				${aF.default}
				#if defined( SHADOWMAP_TYPE_PCF )`),t=t.replace("#include <shadowmap_pars_fragment>",n),t}async update(){var e,t;let r=this.node;if(!r.assemblerController)return;let n="PCSS";this.node.pv.shadowPCSS?(e=r.assemblerController())==null||e.addFilterFragmentShaderCallback(n,i=>Wa.filterFragmentShader(this.node,i)):(t=r.assemblerController())==null||t.removeFilterFragmentShaderCallback(n)}static async update(e){e.controllers.PCSS.update()}static PARAM_CALLBACK_setRecompileRequired(e){e.controllers.PCSS.update()}};var cF=class extends zf(os(vl(oo(rs(Ho(ss(I0(L0(Kn($n(Yn(Ci(es(zo(U))))))))))))))){},Goe=new cF,Yg=class extends Xn{constructor(){super(...arguments);this.paramsConfig=Goe,this.controllers={advancedCommon:new Or(this),alphaMap:new sn(this),aoMap:new an(this),emissiveMap:new as(this),envMap:new is(this),lightMap:new Jn(this),map:new nn(this),PCSS:new Wa(this)},this.controllerNames=Object.keys(this.controllers)}static type(){return"meshLambertBuilder"}usedAssembler(){return Pn.GL_MESH_LAMBERT}_createAssemblerController(){return Q.assemblersRegister.assembler(this,this.usedAssembler())}initializeNode(){this.params.onParamsCreated("init controllers",()=>{for(let e of this.controllerNames)this.controllers[e].initializeNode()})}async cook(){for(let e of this.controllerNames)this.controllers[e].update();ts.update(this),ns.update(this),yl.update(this),this.compileIfRequired(),this.setMaterial(this.material)}};function xl(o){return class extends o{constructor(){super(...arguments);this.useBumpMap=y.BOOLEAN(0,{separatorBefore:!0,...$t(cs)}),this.bumpMap=y.NODE_PATH("",Pt(cs,"useBumpMap")),this.bumpScale=y.FLOAT(1,{range:[0,1],rangeLocked:[!1,!1],...Pt(cs,"useBumpMap")}),this.bumpBias=y.FLOAT(0,{range:[0,1],rangeLocked:[!1,!1],...Pt(cs,"useBumpMap")})}}}var zoe=class extends xl(U){};var cs=class extends or{constructor(e){super(e);this.node=e}initializeNode(){this.add_hooks(this.node.p.useBumpMap,this.node.p.bumpMap)}async update(){this._update(this.node.material,"bumpMap",this.node.p.useBumpMap,this.node.p.bumpMap);let e=this.node.material;e.bumpScale=this.node.pv.bumpScale}static async update(e){e.controllers.bumpMap.update()}};var lF=["tangent","object"],Hoe={tangent:hn,object:m1};function bl(o){return class extends o{constructor(){super(...arguments);this.useNormalMap=y.BOOLEAN(0,{separatorBefore:!0,...$t(D0)}),this.normalMap=y.NODE_PATH("",Pt(D0,"useNormalMap")),this.normalMapType=y.INTEGER(0,{visibleIf:{useNormalMap:1},menu:{entries:lF.map((t,r)=>({name:t,value:r}))}}),this.normalScale=y.VECTOR2([1,1],{visibleIf:{useNormalMap:1}}),this.normalScaleMult=y.FLOAT(1,{range:[0,1],rangeLocked:[!1,!1],visibleIf:{useNormalMap:1}})}}}var joe=class extends bl(U){};var D0=class extends or{constructor(e){super(e);this.node=e}initializeNode(){this.add_hooks(this.node.p.useNormalMap,this.node.p.normalMap)}async update(){let{p:e,pv:t,material:r}=this.node;this._update(this.node.material,"normalMap",e.useNormalMap,e.normalMap);let n=Hoe[lF[t.normalMapType]],i=r;i.normalMapType=n,i.normalScale.copy(t.normalScale).multiplyScalar(t.normalScaleMult)}static async update(e){e.controllers.normalMap.update()}};function $g(o){return class extends o{constructor(){super(...arguments);this.useSpecularMap=y.BOOLEAN(0,$t(Hf)),this.specularMap=y.NODE_PATH("",Pt(Hf,"useSpecularMap"))}}}var Woe=class extends $g(U){};var Hf=class extends or{constructor(e){super(e);this.node=e}initializeNode(){this.add_hooks(this.node.p.useSpecularMap,this.node.p.specularMap)}async update(){this._update(this.node.material,"specularMap",this.node.p.useSpecularMap,this.node.p.specularMap)}static async update(e){e.controllers.specularMap.update()}};function Tl(o){return class extends o{constructor(){super(...arguments);this.useDisplacementMap=y.BOOLEAN(0,{separatorBefore:!0,...$t(ls)}),this.displacementMap=y.NODE_PATH("",Pt(ls,"useDisplacementMap")),this.displacementScale=y.FLOAT(1,{range:[0,1],rangeLocked:[!1,!1],...Pt(ls,"useDisplacementMap")}),this.displacementBias=y.FLOAT(0,{range:[0,1],rangeLocked:[!1,!1],...Pt(ls,"useDisplacementMap")})}}}var qoe=class extends Tl(U){};var ls=class extends or{constructor(e){super(e);this.node=e}initializeNode(){this.add_hooks(this.node.p.useDisplacementMap,this.node.p.displacementMap)}async update(){this._update(this.node.material,"displacementMap",this.node.p.useDisplacementMap,this.node.p.displacementMap);let e=this.node.material;e.displacementScale=this.node.pv.displacementScale,e.displacementBias=this.node.pv.displacementBias}static async update(e){e.controllers.displacementMap.update()}};var uF=class extends fl(_l(oo(Ho($g(bl(ss(I0(L0(Tl(xl(Kn($n(Yn(Ci(dl(zo(U))))))))))))))))){constructor(){super(...arguments);this.flatShading=y.BOOLEAN(0)}},Xoe=new uF,Kg=class extends Qi{constructor(){super(...arguments);this.paramsConfig=Xoe,this.controllers={advancedCommon:new Or(this),alphaMap:new sn(this),aoMap:new an(this),bumpMap:new cs(this),displacementMap:new ls(this),emissiveMap:new as(this),envMap:new is(this),lightMap:new Jn(this),map:new nn(this),normalMap:new D0(this),specularMap:new Hf(this)},this.controllerNames=Object.keys(this.controllers)}static type(){return"meshPhong"}createMaterial(){return new y1({vertexColors:!1,side:gr,color:16777215,opacity:1})}initializeNode(){this.params.onParamsCreated("init controllers",()=>{for(let e of this.controllerNames)this.controllers[e].initializeNode()})}async cook(){for(let e of this.controllerNames)this.controllers[e].update();hl.update(this),ml.update(this),gl.update(this),this.material.flatShading!=this.pv.flatShading&&(this.material.flatShading=this.pv.flatShading,this.material.needsUpdate=!0),this.setMaterial(this.material)}};function jf(o){return class extends o{constructor(){super(...arguments);this.useEnvMap=y.BOOLEAN(0,{separatorBefore:!0,...$t(Al)}),this.envMap=y.NODE_PATH("",Pt(Al,"useEnvMap")),this.envMapIntensity=y.FLOAT(1,{visibleIf:{useEnvMap:1}}),this.refractionRatio=y.FLOAT(.98,{range:[-1,1],rangeLocked:[!1,!1],visibleIf:{useEnvMap:1}})}}}var Yoe=class extends jf(U){};var Al=class extends or{constructor(e){super(e);this.node=e}initializeNode(){this.add_hooks(this.node.p.useEnvMap,this.node.p.envMap)}async update(){this._update(this.node.material,"envMap",this.node.p.useEnvMap,this.node.p.envMap);let e=this.node.material;e.envMapIntensity=this.node.pv.envMapIntensity,e.refractionRatio=this.node.pv.refractionRatio}static async update(e){e.controllers.envMap.update()}};function Wf(o){return class extends o{constructor(){super(...arguments);this.useMetalnessMap=y.BOOLEAN(0,{separatorBefore:!0,...$t(k0)}),this.metalnessMap=y.NODE_PATH("",Pt(k0,"useMetalnessMap")),this.metalness=y.FLOAT(1),this.useRoughnessMap=y.BOOLEAN(0,{separatorBefore:!0,...$t(k0)}),this.roughnessMap=y.NODE_PATH("",Pt(k0,"useRoughnessMap")),this.roughness=y.FLOAT(.5)}}}var $oe=class extends Wf(U){};var k0=class extends or{constructor(e){super(e);this.node=e}initializeNode(){this.add_hooks(this.node.p.useMetalnessMap,this.node.p.metalnessMap)}async update(){this._update(this.node.material,"metalnessMap",this.node.p.useMetalnessMap,this.node.p.metalnessMap);let e=this.node.material;e.metalness=this.node.pv.metalness,this._update(this.node.material,"roughnessMap",this.node.p.useRoughnessMap,this.node.p.roughnessMap),e.roughness=this.node.pv.roughness}static async update(e){e.controllers.metalnessRoughnessMap.update()}};function Jg(o){return class extends o{constructor(){super(...arguments);this.clearcoat=y.FLOAT(0,{separatorBefore:!0}),this.useClearCoatMap=y.BOOLEAN(0,$t(B0)),this.clearcoatMap=y.NODE_PATH("",Pt(B0,"useClearCoatMap")),this.useClearCoatNormalMap=y.BOOLEAN(0,$t(B0)),this.clearcoatNormalMap=y.NODE_PATH("",Pt(B0,"useClearCoatNormalMap")),this.clearcoatNormalScale=y.VECTOR2([1,1],{visibleIf:{useClearCoatNormalMap:1}}),this.clearcoatRoughness=y.FLOAT(0),this.useClearCoatRoughnessMap=y.BOOLEAN(0,$t(B0)),this.clearcoatRoughnessMap=y.NODE_PATH("",Pt(B0,"useClearCoatRoughnessMap")),this.useSheen=y.BOOLEAN(0),this.sheen=y.FLOAT(0,{range:[0,1],rangeLocked:[!0,!1],visibleIf:{useSheen:1}}),this.sheenRoughness=y.FLOAT(1,{range:[0,1],rangeLocked:[!0,!1],visibleIf:{useSheen:1}}),this.sheenColor=y.COLOR([1,1,1],{visibleIf:{useSheen:1}}),this.transmission=y.FLOAT(0,{range:[0,1]}),this.useTransmissionMap=y.BOOLEAN(0),this.transmissionMap=y.NODE_PATH("",{visibleIf:{useTransmissionMap:1}}),this.ior=y.FLOAT(1.5,{range:[1,2.3333],rangeLocked:[!0,!0]}),this.thickness=y.FLOAT(.01,{range:[0,10],rangeLocked:[!0,!1]}),this.useThicknessMap=y.BOOLEAN(0),this.thicknessMap=y.NODE_PATH("",{visibleIf:{useThicknessMap:1}}),this.attenuationDistance=y.FLOAT(0,{range:[0,10],rangeLocked:[!0,!1]}),this.attenuationColor=y.COLOR([1,1,1])}}}var Koe=class extends Jg(U){};var pF=new on,B0=class extends or{constructor(e){super(e);this.node=e,this._sheenColorClone=new de}initializeNode(){this.add_hooks(this.node.p.useClearCoatMap,this.node.p.clearcoatMap),this.add_hooks(this.node.p.useClearCoatNormalMap,this.node.p.clearcoatNormalMap),this.add_hooks(this.node.p.useClearCoatRoughnessMap,this.node.p.clearcoatRoughnessMap),this.add_hooks(this.node.p.useTransmissionMap,this.node.p.transmissionMap),this.add_hooks(this.node.p.useThicknessMap,this.node.p.thicknessMap)}async update(){this._update(this.node.material,"clearcoatMap",this.node.p.useClearCoatMap,this.node.p.clearcoatMap),this._update(this.node.material,"clearcoatNormalMap",this.node.p.useClearCoatNormalMap,this.node.p.clearcoatNormalMap),this._update(this.node.material,"clearcoatRoughnessMap",this.node.p.useClearCoatRoughnessMap,this.node.p.clearcoatRoughnessMap),this._update(this.node.material,"transmissionMap",this.node.p.useTransmissionMap,this.node.p.transmissionMap),this._update(this.node.material,"thicknessMap",this.node.p.useThicknessMap,this.node.p.thicknessMap);let e=this.node.pv;pF.ior=e.ior;let t=pF.reflectivity,r=this.node.material;r.clearcoat=e.clearcoat,r.clearcoatNormalScale!=null&&r.clearcoatNormalScale.copy(e.clearcoatNormalScale),r.clearcoatRoughness=e.clearcoatRoughness,r.reflectivity=t,e.useSheen?(this._sheenColorClone.copy(e.sheenColor),r.sheen=e.sheen,r.sheenRoughness=e.sheenRoughness,r.sheenColor=this._sheenColorClone):r.sheen=0,r.transmission=e.transmission,r.thickness=e.thickness,r.attenuationDistance=e.attenuationDistance,r.attenuationColor=e.attenuationColor}static async update(e){e.controllers.physical.update()}};var dF=class extends fl(_l(oo(Ho(Jg(Wf(bl(ss(jf(L0(Tl(xl(Kn($n(Yn(Ci(dl(zo(U)))))))))))))))))){},Joe=new dF,Zg=class extends Qi{constructor(){super(...arguments);this.paramsConfig=Joe,this.controllers={advancedCommon:new Or(this),alphaMap:new sn(this),aoMap:new an(this),bumpMap:new cs(this),displacementMap:new ls(this),emissiveMap:new as(this),envMap:new Al(this),lightMap:new Jn(this),map:new nn(this),metalnessRoughnessMap:new k0(this),normalMap:new D0(this),physical:new B0(this)},this.controllerNames=Object.keys(this.controllers)}static type(){return"meshPhysical"}createMaterial(){return new on({vertexColors:!1,side:gr,color:16777215,opacity:1,metalness:1,roughness:0})}initializeNode(){this.params.onParamsCreated("init controllers",()=>{for(let e of this.controllerNames)this.controllers[e].initializeNode()})}async cook(){for(let e of this.controllerNames)this.controllers[e].update();hl.update(this),ml.update(this),gl.update(this),this.setMaterial(this.material)}};var hF=class extends zf(os(vl(oo(rs(Ho(Wf(bl(ss(jf(L0(Tl(xl(Kn($n(Yn(Ci(es(zo(U))))))))))))))))))){},Zoe=new hF,Qg=class extends Xn{constructor(){super(...arguments);this.paramsConfig=Zoe,this.controllers={advancedCommon:new Or(this),alphaMap:new sn(this),aoMap:new an(this),bumpMap:new cs(this),displacementMap:new ls(this),emissiveMap:new as(this),envMap:new Al(this),lightMap:new Jn(this),map:new nn(this),metalnessRoughnessMap:new k0(this),normalMap:new D0(this),PCSS:new Wa(this)},this.controllerNames=Object.keys(this.controllers)}static type(){return"meshStandardBuilder"}usedAssembler(){return Pn.GL_MESH_STANDARD}_createAssemblerController(){return Q.assemblersRegister.assembler(this,this.usedAssembler())}initializeNode(){this.params.onParamsCreated("init controllers",()=>{for(let e of this.controllerNames)this.controllers[e].initializeNode()})}async cook(){for(let e of this.controllerNames)this.controllers[e].update();ts.update(this),ns.update(this),yl.update(this),this.compileIfRequired(),this.setMaterial(this.material)}};function ev(o){return class extends o{constructor(){super(...arguments);this.size=y.FLOAT(1,{range:[0,10],rangeLocked:[!0,!1]}),this.sizeAttenuation=y.BOOLEAN(1,{separatorAfter:!0})}}}var Qoe=class extends ev(U){};var tv=class extends Fr{constructor(e){super(e);this.node=e}static update(e){let t=e.material,r=e.pv;t.size=r.size;let n=t.sizeAttenuation,i=r.sizeAttenuation;n!=i&&(t.sizeAttenuation=i,t.needsUpdate=!0)}};var fF=class extends os(oo(rs(Ho(es(ev(zo(U))))))){},ene=new fF,rv=class extends Xn{constructor(){super(...arguments);this.paramsConfig=ene,this.controllers={advancedCommon:new Or(this)},this.controllerNames=Object.keys(this.controllers)}static type(){return"pointsBuilder"}usedAssembler(){return Pn.GL_POINTS}_createAssemblerController(){return Q.assemblersRegister.assembler(this,this.usedAssembler())}initializeNode(){this.params.onParamsCreated("init controllers",()=>{for(let e of this.controllerNames)this.controllers[e].initializeNode()})}async cook(){for(let e of this.controllerNames)this.controllers[e].update();ts.update(this),ns.update(this),tv.update(this),this.compileIfRequired(),this.setMaterial(this.material)}};var K9="parent object",tne=[K9,K9,K9,K9],Cl=(o=>(o[o.MANAGER=0]="MANAGER",o[o.CAMERA=2]="CAMERA",o[o.LIGHT=3]="LIGHT",o))(Cl||{}),no=class extends fr{constructor(){super(...arguments);this.renderOrder=0,this._children_group=this._create_children_group(),this._attachableToHierarchy=!0,this._used_in_scene=!0}static context(){return oe.OBJ}static displayedInputNames(){return tne}_create_children_group(){let e=new st;return e.matrixAutoUpdate=!1,e}attachableToHierarchy(){return this._attachableToHierarchy}usedInScene(){return this._used_in_scene}addObjectToParent(e){this.attachableToHierarchy()&&e.add(this.object)}removeObjectFromParent(){if(this.attachableToHierarchy()){let e=this.object.parent;e&&e.remove(this.object)}}initializeBaseNode(){this._object=this._create_object_with_attributes(),this.nameController.add_post_set_fullPath_hook(this.set_object_name.bind(this)),this.set_object_name()}childrenGroup(){return this._children_group}get object(){return this._object}_create_object_with_attributes(){let e=this.createObject();return e.node=this,e.add(this._children_group),e}set_object_name(){this._object&&(this._object.name=this.path(),this._children_group.name=`${this.path()}:parentedOutputs`)}createObject(){let e=new vt;return e.matrixAutoUpdate=!1,e}isDisplayNodeCooking(){if(this.displayNodeController){let e=this.displayNodeController.displayNode();if(e)return e.cookController.isCooking()}return!1}isDisplayed(){var e,t;return((t=(e=this.flags)==null?void 0:e.display)==null?void 0:t.active())||!1}};var qf=class extends no{constructor(){super(...arguments);this.flags=new vo(this),this.renderOrder=Cl.LIGHT,this._color_with_intensity=new de(0),this._used_in_scene=!0,this._cook_main_without_inputs_when_dirty_bound=this._cook_main_without_inputs_when_dirty.bind(this)}get light(){return this._light}initializeBaseNode(){super.initializeBaseNode(),this._light=this.createLight(),this.object.add(this._light),this.flags.display.onUpdate(()=>{this._updateLightAttachment()}),this.dirtyController.addPostDirtyHook("_cook_main_without_inputs_when_dirty",this._cook_main_without_inputs_when_dirty_bound)}async _cook_main_without_inputs_when_dirty(){await this.cookController.cookMainWithoutInputs()}set_object_name(){super.set_object_name(),this._light&&(this._light.name=`${this.path()}:light`)}_updateLightAttachment(){this.flags.display.active()?(this.object.add(this.light),this._cook_main_without_inputs_when_dirty()):this.object.remove(this.light)}cook(){this.updateLightParams(),this.updateShadowParams(),this.cookController.endCook()}updateLightParams(){}updateShadowParams(){}};function io(o,e){let t=(e==null?void 0:e.matrixAutoUpdate)||!1;return class extends o{constructor(){super(...arguments);this.transform=y.FOLDER(),this.keepPosWhenParenting=y.BOOLEAN(0),this.rotationOrder=y.INTEGER(Rs.indexOf(Bc.XYZ),{menu:{entries:Rs.map((n,i)=>({name:n,value:i}))}}),this.t=y.VECTOR3([0,0,0]),this.r=y.VECTOR3([0,0,0]),this.s=y.VECTOR3([1,1,1]),this.scale=y.FLOAT(1),this.matrixAutoUpdate=y.BOOLEAN(t?1:0),this.updateTransformFromObject=y.BUTTON(null,{callback:n=>{jo.PARAM_CALLBACK_update_transform_from_object(n)}})}}}var rne=class extends io(U){};var mF="_cook_main_without_inputs_when_dirty",jo=class{constructor(e){this.node=e,this._cook_main_without_inputs_when_dirty_bound=this._cook_main_without_inputs_when_dirty.bind(this),this._core_transform=new Yt,this._keep_pos_when_parenting_m_object=new Ue,this._keep_pos_when_parenting_m_new_parent_inv=new Ue}initializeNode(){this.node.dirtyController.hasHook(mF)||this.node.dirtyController.addPostDirtyHook(mF,this._cook_main_without_inputs_when_dirty_bound)}async _cook_main_without_inputs_when_dirty(){await this.node.cookController.cookMainWithoutInputs()}update(){this.update_transform_with_matrix();let e=this.node.object;e.matrixAutoUpdate=this.node.pv.matrixAutoUpdate}update_transform_with_matrix(e){let t=this.node.object;e!=null&&!e.equals(t.matrix)?(t.matrix.copy(e),t.dispatchEvent({type:"change"})):this._update_matrix_from_params_with_core_transform()}_update_matrix_from_params_with_core_transform(){let e=this.node.object,t=e.matrixAutoUpdate;t&&(e.matrixAutoUpdate=!1);let r=this._core_transform.matrix(this.node.pv.t,this.node.pv.r,this.node.pv.s,this.node.pv.scale,Rs[this.node.pv.rotationOrder]);e.matrix.identity(),e.applyMatrix4(r),this._apply_look_at(),e.updateMatrix(),t&&(e.matrixAutoUpdate=!0),e.dispatchEvent({type:"change"})}_apply_look_at(){}set_params_from_matrix(e,t={}){Yt.setParamsFromMatrix(e,this.node,t)}static update_node_transform_params_if_required(e,t){e.transformController.update_node_transform_params_if_required(t)}update_node_transform_params_if_required(e){if(!this.node.pv.keepPosWhenParenting||!this.node.scene().loadingController.loaded()||e==this.node.object.parent)return;let t=this.node.object;t.updateMatrixWorld(!0),e.updateMatrixWorld(!0),this._keep_pos_when_parenting_m_object.copy(t.matrixWorld),this._keep_pos_when_parenting_m_new_parent_inv.copy(e.matrixWorld),this._keep_pos_when_parenting_m_new_parent_inv.invert(),this._keep_pos_when_parenting_m_object.premultiply(this._keep_pos_when_parenting_m_new_parent_inv),Yt.setParamsFromMatrix(this._keep_pos_when_parenting_m_object,this.node,{scale:!0})}update_node_transform_params_from_object(e=!1){let t=this.node.object;e&&t.updateMatrix(),Yt.setParamsFromMatrix(t.matrix,this.node,{scale:!0})}static PARAM_CALLBACK_update_transform_from_object(e){e.transformController.update_node_transform_params_from_object()}};var so=class{constructor(e){this.node=e}initializeNode(){this.node.io.inputs.setCount(0,1),this.node.io.inputs.set_depends_on_inputs(!1),this.node.io.outputs.setHasOneOutput(),this.node.io.inputs.add_on_set_input_hook("on_input_updated:update_parent",()=>{this.on_input_updated()})}static on_input_updated(e){let t=e.root().getParentForNode(e);e.transformController&&t&&jo.update_node_transform_params_if_required(e,t),e.io.inputs.input(0)!=null?e.root().addToParentTransform(e):e.root().removeFromParentTransform(e)}on_input_updated(){so.on_input_updated(this.node)}};var one=class extends io(U){},Xf=class extends qf{constructor(){super(...arguments);this.flags=new vo(this),this.hierarchyController=new so(this),this.transformController=new jo(this)}initializeBaseNode(){super.initializeBaseNode(),this.hierarchyController.initializeNode(),this.transformController.initializeNode()}cook(){this.transformController.update(),this.updateLightParams(),this.updateShadowParams(),this.cookController.endCook()}};var ov={color:new de(1,1,1),intensity:1,width:1,height:1,showHelper:!1},Yf=ov;function _F(o){return class extends o{constructor(){super(...arguments);this.light=y.FOLDER(),this.color=y.COLOR(Yf.color.toArray(),{conversion:ko.SRGB_TO_LINEAR}),this.intensity=y.FLOAT(Yf.intensity,{range:[0,10],rangeLocked:[!0,!1]}),this.width=y.FLOAT(Yf.width,{range:[0,10],rangeLocked:[!0,!1]}),this.height=y.FLOAT(Yf.height,{range:[0,10],rangeLocked:[!0,!1]}),this.showHelper=y.BOOLEAN(Yf.showHelper)}}}function nne(){let o=new Re,e=[1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0];return o.setAttribute("position",new Ce(e,3)),o.computeBoundingSphere(),o}function ine(){let o=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],e=new Re;return e.setAttribute("position",new Ce(o,3)),e.computeBoundingSphere(),e}var El=class extends bs{constructor(e){super();this.light=e,this.geometry=nne(),this.material=new ir({fog:!1}),this.type="RectAreaLightHelper",this._childMesh=new ct(ine(),new _n({side:Mt,fog:!1})),this.add(this._childMesh)}update(){this.scale.set(.5*this.light.width,.5*this.light.height,1),this.material.color.copy(this.light.color).multiplyScalar(this.light.intensity);let e=this.material.color,t=Math.max(e.r,e.g,e.b);t>1&&e.multiplyScalar(1/t),this._childMesh.material.color.copy(this.material.color),this.matrixWorld.extractRotation(this.light.matrixWorld).scale(this.scale).copyPosition(this.light.matrixWorld),this._childMesh.matrixWorld.copy(this.matrixWorld)}dispose(){this.geometry.dispose(),this.material.dispose(),this._childMesh.geometry.dispose(),this._childMesh.material.dispose()}clone(e){let t=new El(this.light);return t.updateMatrixWorld(),t}};var wo=class extends vt{constructor(e,t=1){super();this.type="Light",this.color=new de(e),this.intensity=t}dispose(){}copy(e){return super.copy(e),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){let t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),t}};wo.prototype.isLight=!0;var ld=class extends wo{constructor(e,t,r=10,n=10){super(e,t);this.type="RectAreaLight",this.width=r,this.height=n}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){let t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}};ld.prototype.isRectAreaLight=!0;var $f=class{static init(){let e=[1,0,0,2e-5,1,0,0,503905e-9,1,0,0,.00201562,1,0,0,.00453516,1,0,0,.00806253,1,0,0,.0125978,1,0,0,.018141,1,0,0,.0246924,1,0,0,.0322525,1,0,0,.0408213,1,0,0,.0503999,1,0,0,.0609894,1,0,0,.0725906,1,0,0,.0852058,1,0,0,.0988363,1,0,0,.113484,1,0,0,.129153,1,0,0,.145839,1,0,0,.163548,1,0,0,.182266,1,0,0,.201942,1,0,0,.222314,1,0,0,.241906,1,0,0,.262314,1,0,0,.285754,1,0,0,.310159,1,0,0,.335426,1,0,0,.361341,1,0,0,.387445,1,0,0,.412784,1,0,0,.438197,1,0,0,.466966,1,0,0,.49559,1,0,0,.523448,1,0,0,.549938,1,0,0,.57979,1,0,0,.608746,1,0,0,.636185,1,0,0,.664748,1,0,0,.69313,1,0,0,.71966,1,0,0,.747662,1,0,0,.774023,1,0,0,.799775,1,0,0,.825274,1,0,0,.849156,1,0,0,.873248,1,0,0,.89532,1,0,0,.917565,1,0,0,.937863,1,0,0,.958139,1,0,0,.976563,1,0,0,.994658,1,0,0,1.0112,1,0,0,1.02712,1,0,0,1.04189,1,0,0,1.05568,1,0,0,1.06877,1,0,0,1.08058,1,0,0,1.09194,1,0,0,1.10191,1,0,0,1.11161,1,0,0,1.1199,1,0,0,1.12813,.999547,-448815e-12,.0224417,199902e-10,.999495,-113079e-10,.0224406,503651e-9,.999496,-452317e-10,.0224406,.00201461,.999496,-101772e-9,.0224406,.00453287,.999495,-180928e-9,.0224406,.00805845,.999497,-282702e-9,.0224406,.0125914,.999496,-407096e-9,.0224406,.0181319,.999498,-554114e-9,.0224406,.02468,.999499,-723768e-9,.0224406,.0322363,.999495,-916058e-9,.0224405,.0408009,.999499,-.00113101,.0224408,.050375,.999494,-.00136863,.0224405,.0609586,.999489,-.00162896,.0224401,.0725537,.999489,-.00191201,.0224414,.0851619,.999498,-.00221787,.0224413,.0987867,.999492,-.00254642,.0224409,.113426,.999507,-.00289779,.0224417,.129088,.999494,-.0032716,.0224386,.145767,.999546,-.0036673,.0224424,.163472,.999543,-.00408166,.0224387,.182182,.999499,-.00450056,.0224338,.201843,.999503,-.00483661,.0224203,.222198,.999546,-.00452928,.022315,.241714,.999508,-.00587403,.0224329,.262184,.999509,-.00638806,.0224271,.285609,.999501,-.00691028,.0224166,.309998,.999539,-.00741979,.0223989,.335262,.999454,-.00786282,.0223675,.361154,.999529,-.00811928,.0222828,.387224,.999503,-.00799941,.0221063,.41252,.999561,-.00952753,.0223057,.438006,.999557,-.0099134,.0222065,.466735,.999541,-.0100935,.0220402,.495332,.999562,-.00996821,.0218067,.523197,.999556,-.0105031,.0217096,.550223,.999561,-.0114191,.0217215,.579498,.999588,-.0111818,.0213357,.608416,.999633,-.0107725,.0208689,.635965,.999527,-.0121671,.0210149,.664476,.999508,-.0116005,.020431,.692786,.999568,-.0115604,.0199791,.719709,.999671,-.0121117,.0197415,.74737,.999688,-.0110769,.0188846,.773692,.99962,-.0122368,.0188452,.799534,.999823,-.0110325,.0178001,.825046,.999599,-.0114923,.0174221,.849075,.999619,-.0105923,.0164345,.872999,.999613,-.0105988,.0158227,.895371,.99964,-.00979861,.0148131,.917364,.99977,-.00967238,.0140721,.938002,.999726,-.00869175,.0129543,.957917,.99973,-.00866872,.0122329,.976557,.999773,-.00731956,.0108958,.994459,.999811,-.00756027,.0102715,1.01118,.999862,-.00583732,.00878781,1.02701,.999835,-.00631438,.00827529,1.04186,.999871,-.00450785,.00674583,1.05569,.999867,-.00486079,.00621041,1.06861,.999939,-.00322072,.00478301,1.08064,.999918,-.00318199,.00406395,1.09181,1.00003,-.00193348,.00280682,1.10207,.999928,-.00153729,.00198741,1.11152,.999933,-623666e-9,917714e-9,1.12009,1,-102387e-11,907581e-12,1.12813,.997866,-896716e-12,.0448334,199584e-10,.997987,-225945e-10,.0448389,502891e-9,.997987,-903781e-10,.0448388,.00201156,.997985,-203351e-9,.0448388,.00452602,.997986,-361514e-9,.0448388,.00804629,.997987,-56487e-8,.0448389,.0125724,.997988,-813423e-9,.0448389,.0181045,.997984,-.00110718,.0448387,.0246427,.997985,-.00144616,.0448388,.0321875,.997987,-.00183038,.044839,.0407392,.997983,-.00225987,.0448387,.0502986,.997991,-.00273467,.0448389,.0608667,.997984,-.00325481,.0448384,.0724444,.998002,-.00382043,.044839,.0850348,.997997,-.00443145,.0448396,.0986372,.998007,-.00508796,.0448397,.113255,.998008,-.00578985,.04484,.128891,.998003,-.00653683,.0448384,.145548,.997983,-.00732713,.0448358,.163221,.997985,-.00815454,.0448358,.181899,.998005,-.00898985,.0448286,.201533,.998026,-.00964404,.0447934,.221821,.998055,-.00922677,.044611,.241282,.99804,-.0117361,.0448245,.261791,.998048,-.0127628,.0448159,.285181,.998088,-.0138055,.0447996,.30954,.998058,-.0148206,.0447669,.334751,.998099,-.0156998,.044697,.36061,.998116,-.0161976,.0445122,.386603,.998195,-.015945,.0441711,.411844,.998168,-.0183947,.0444255,.43773,.998184,-.0197913,.0443809,.466009,.998251,-.0201426,.0440689,.494574,.998305,-.0198847,.0435632,.522405,.998273,-.0210577,.043414,.549967,.998254,-.0227901,.0433943,.578655,.998349,-.0223108,.0426529,.60758,.99843,-.0223088,.042,.635524,.998373,-.0241141,.0418987,.663621,.998425,-.0231446,.0408118,.691906,.998504,-.0233684,.0400565,.719339,.998443,-.0241652,.0394634,.74643,.99848,-.0228715,.0380002,.773086,.998569,-.023519,.0372322,.798988,.998619,-.0223108,.0356468,.824249,.998594,-.0223105,.034523,.848808,.998622,-.0213426,.0328887,.87227,.998669,-.0207912,.0314374,.895157,.998705,-.0198416,.0296925,.916769,.998786,-.0189168,.0279634,.937773,.998888,-.0178811,.0261597,.957431,.99906,-.0166845,.0242159,.976495,.999038,-.0155464,.0222638,.994169,.999237,-.0141349,.0201967,1.01112,.999378,-.0129324,.0181744,1.02692,.999433,-.0113192,.0159898,1.04174,.999439,-.0101244,.0140385,1.05559,.999614,-.00837456,.0117826,1.06852,.999722,-.00721769,.00983745,1.08069,.999817,-.00554067,.00769002,1.09176,.99983,-.00426961,.005782,1.10211,.999964,-.00273904,.00374503,1.11152,1.00001,-.00136739,.00187176,1.12031,.999946,393227e-10,-28919e-9,1.12804,.995847,-13435e-10,.0671785,19916e-9,.995464,-338387e-10,.0671527,501622e-9,.99547,-135355e-9,.0671531,.00200649,.995471,-30455e-8,.0671532,.00451461,.99547,-541423e-9,.0671531,.008026,.995471,-84598e-8,.0671531,.0125407,.99547,-.00121823,.0671531,.0180589,.99547,-.00165817,.0671531,.0245806,.995463,-.00216583,.0671526,.0321062,.995468,-.00274127,.0671527,.0406366,.995474,-.00338447,.0671534,.0501717,.995473,-.00409554,.0671533,.0607131,.995478,-.00487451,.0671531,.0722618,.995476,-.00572148,.0671532,.0848191,.995477,-.00663658,.0671539,.0983882,.995498,-.00761986,.0671541,.112972,.995509,-.00867094,.0671542,.128568,.995509,-.00978951,.0671531,.145183,.995503,-.0109725,.0671491,.162808,.995501,-.012211,.0671465,.181441,.99553,-.0134565,.0671371,.201015,.99555,-.014391,.0670831,.221206,.99558,-.014351,.0668883,.240813,.995577,-.0173997,.0671055,.261257,.995602,-.0191111,.0671178,.284467,.995623,-.0206705,.0670946,.308765,.995658,-.022184,.0670472,.333905,.995705,-.0234832,.0669417,.359677,.995719,-.0241933,.0666714,.385554,.995786,-.0243539,.066266,.410951,.995887,-.0271866,.0664367,.437163,.995944,-.0296012,.0664931,.464842,.996004,-.0301045,.0660105,.49332,.996128,-.0298311,.0652694,.521131,.996253,-.0316426,.0650739,.549167,.996244,-.0339043,.0649433,.57737,.996309,-.033329,.0638926,.606073,.996417,-.0338935,.0630849,.634527,.996372,-.0353104,.0625083,.66256,.996542,-.0348942,.0611986,.690516,.996568,-.0351614,.060069,.718317,.996711,-.0354317,.0588522,.74528,.996671,-.0349513,.0571902,.772061,.996865,-.0345622,.0555321,.798089,.996802,-.0342566,.0537816,.823178,.996992,-.0330862,.0516095,.847949,.996944,-.0324666,.0495537,.871431,.997146,-.0309544,.0470302,.894357,.997189,-.0299372,.0446043,.916142,.997471,-.0281389,.0418812,.937193,.997515,-.0268702,.0391823,.957,.997812,-.0247166,.0361338,.975936,.998027,-.0233525,.0333945,.99391,.998233,-.0209839,.0301917,1.01075,.998481,-.0194309,.027271,1.02669,.998859,-.0169728,.0240162,1.04173,.99894,-.0152322,.0210517,1.05551,.999132,-.0127497,.0178632,1.06856,.999369,-.0108282,.014787,1.08054,.999549,-.00845886,.0116185,1.09185,.999805,-.0063937,.00867209,1.10207,.99985,-.00414582,.00566823,1.1117,.999912,-.00207443,.00277562,1.12022,1.00001,870226e-10,-53766e-9,1.12832,.991943,-178672e-11,.0893382,198384e-10,.991952,-450183e-10,.089339,499849e-9,.991956,-180074e-9,.0893394,.0019994,.991955,-405167e-9,.0893393,.00449867,.991953,-720298e-9,.0893391,.00799764,.991955,-.00112548,.0893393,.0124964,.991957,-.0016207,.0893395,.0179951,.991958,-.00220601,.0893396,.0244939,.991947,-.00288137,.0893385,.0319929,.991962,-.00364693,.0893399,.0404933,.991965,-.00450264,.0893399,.049995,.99198,-.00544862,.0893411,.0604995,.99197,-.00648491,.0893397,.0720074,.991976,-.00761164,.089341,.0845207,.99198,-.00882891,.0893405,.0980413,.991982,-.0101367,.0893396,.112571,.992008,-.011535,.0893415,.128115,.992026,-.0130228,.0893414,.144672,.992064,-.0145966,.0893418,.162241,.992041,-.0162421,.0893359,.180801,.992086,-.0178888,.0893214,.200302,.992157,-.0190368,.0892401,.220332,.992181,-.0195584,.0890525,.240144,.992175,-.0227257,.0892153,.260728,.99221,-.0254195,.089304,.283473,.99222,-.0274883,.0892703,.307673,.992317,-.0294905,.0892027,.332729,.992374,-.0311861,.0890577,.358387,.992505,-.0320656,.0886994,.384102,.992568,-.0329715,.0883198,.409767,.992675,-.036006,.0883602,.436145,.992746,-.0392897,.0884591,.463217,.992873,-.0399337,.0878287,.491557,.992934,-.040231,.0870108,.519516,.993091,-.0422013,.0865857,.547741,.993259,-.0443503,.0861937,.575792,.993455,-.0446368,.0851187,.604233,.993497,-.0454299,.0840576,.632925,.993694,-.0463296,.0829671,.660985,.993718,-.0470619,.0817185,.688714,.993973,-.0468838,.0800294,.716743,.994207,-.046705,.0781286,.74377,.994168,-.0469698,.0763337,.77042,.9945,-.0456816,.0738184,.796659,.994356,-.0455518,.0715545,.821868,.994747,-.0439488,.0686085,.846572,.994937,-.0430056,.065869,.870435,.995142,-.0413414,.0626446,.893272,.995451,-.0396521,.05929,.915376,.995445,-.0378453,.0558503,.936196,.995967,-.0355219,.0520949,.956376,.996094,-.0335146,.048377,.975327,.996622,-.030682,.0442575,.993471,.996938,-.0285504,.0404693,1.01052,.997383,-.0253399,.0360903,1.02637,.997714,-.0231651,.0322176,1.04139,.998249,-.0198138,.0278433,1.05542,.998596,-.0174337,.0238759,1.06846,.998946,-.0141349,.0195944,1.08056,.99928,-.0115603,.0156279,1.09181,.999507,-.00839065,.0114607,1.10213,.999697,-.005666,.00763325,1.11169,.999869,-.00269902,.00364946,1.12042,1.00001,623836e-10,-319288e-10,1.12832,.987221,-222675e-11,.111332,197456e-10,.98739,-561116e-10,.111351,497563e-9,.987448,-224453e-9,.111357,.00199031,.987441,-505019e-9,.111357,.0044782,.987442,-897816e-9,.111357,.00796129,.987442,-.00140284,.111357,.0124396,.987444,-.00202012,.111357,.0179132,.987442,-.00274964,.111357,.0243824,.987446,-.00359147,.111357,.0318474,.987435,-.00454562,.111356,.0403086,.987461,-.00561225,.111358,.0497678,.987458,-.00679125,.111358,.0602239,.987443,-.0080828,.111356,.0716792,.987476,-.0094872,.111358,.0841364,.98749,-.0110044,.111361,.097597,.987508,-.0126344,.111362,.112062,.987494,-.0143767,.111357,.127533,.987526,-.0162307,.111359,.144015,.987558,-.0181912,.111361,.161502,.987602,-.0202393,.111355,.179979,.987692,-.022273,.111346,.199386,.987702,-.0235306,.111215,.219183,.987789,-.0247628,.111061,.239202,.987776,-.0280668,.111171,.259957,.987856,-.0316751,.111327,.282198,.987912,-.0342468,.111282,.306294,.988,-.0367205,.111198,.331219,.988055,-.0387766,.110994,.356708,.988241,-.0397722,.110547,.382234,.988399,-.0416076,.110198,.408227,.988539,-.0448192,.110137,.434662,.988661,-.0483793,.110143,.461442,.988967,-.0495895,.109453,.489318,.989073,-.0506797,.108628,.517516,.989274,-.0526953,.108003,.545844,.989528,-.054578,.107255,.573823,.989709,-.0561503,.106294,.601944,.989991,-.056866,.104896,.630855,.990392,-.0572914,.103336,.658925,.990374,-.0586224,.10189,.686661,.990747,-.0584764,.099783,.714548,.991041,-.0582662,.0974309,.74186,.991236,-.0584118,.0951678,.768422,.991585,-.0573055,.0921581,.794817,.991984,-.0564241,.0891167,.820336,.9921,-.0553608,.085805,.84493,.992749,-.0533816,.0820354,.868961,.99288,-.0518661,.0782181,.891931,.993511,-.0492492,.0738935,.914186,.993617,-.0471956,.0696402,.93532,.99411,-.044216,.0649659,.95543,.994595,-.0416654,.0603177,.974685,.994976,-.0384314,.0553493,.992807,.995579,-.0353491,.0503942,1.00996,.996069,-.0319787,.0452123,1.02606,.996718,-.028472,.0400112,1.04114,.997173,-.0250789,.0349456,1.05517,.997818,-.0213326,.029653,1.0683,.998318,-.0178509,.024549,1.0805,.998853,-.0141118,.0194197,1.09177,.999218,-.0105914,.0143869,1.1022,.999594,-.00693474,.00943517,1.11175,.99975,-.00340478,.00464051,1.12056,1.00001,109172e-9,-112821e-9,1.12853,.983383,-266524e-11,.133358,196534e-10,.981942,-671009e-10,.133162,494804e-9,.981946,-268405e-9,.133163,.00197923,.981944,-603912e-9,.133163,.00445326,.981941,-.00107362,.133162,.00791693,.981946,-.00167755,.133163,.0123703,.981944,-.00241569,.133162,.0178135,.981945,-.00328807,.133163,.0242466,.981945,-.00429472,.133162,.03167,.981955,-.00543573,.133164,.0400846,.981951,-.00671105,.133163,.0494901,.981968,-.00812092,.133165,.0598886,.981979,-.00966541,.133166,.0712811,.981996,-.0113446,.133168,.083669,.982014,-.0131585,.133169,.0970533,.982011,-.0151073,.133167,.111438,.982062,-.0171906,.133172,.126826,.9821,-.0194067,.133175,.143215,.982149,-.0217502,.133176,.160609,.982163,-.0241945,.133173,.178981,.982247,-.0265907,.133148,.198249,.982291,-.027916,.132974,.217795,.982396,-.0299663,.132868,.238042,.982456,-.0334544,.132934,.258901,.982499,-.0378636,.133137,.280639,.982617,-.0409274,.133085,.304604,.98274,-.0438523,.132985,.329376,.982944,-.0462288,.132728,.354697,.98308,-.0475995,.132228,.380102,.983391,-.0501901,.131924,.406256,.983514,-.0535899,.131737,.432735,.98373,-.0571858,.131567,.459359,.984056,-.0592353,.130932,.486637,.984234,-.0610488,.130092,.51509,.984748,-.0630758,.12923,.543461,.985073,-.0647398,.128174,.571376,.985195,-.0671941,.127133,.599414,.985734,-.0681345,.125576,.628134,.986241,-.0686089,.123639,.656399,.986356,-.0698511,.121834,.684258,.986894,-.0700931,.119454,.711818,.987382,-.0698321,.116718,.739511,.988109,-.0693975,.113699,.766267,.988363,-.0689584,.110454,.792456,.989112,-.0672353,.106602,.81813,.989241,-.0662034,.10267,.842889,.990333,-.0638938,.0981381,.867204,.990591,-.0618534,.0935388,.89038,.991106,-.0593117,.088553,.912576,.991919,-.0562676,.0832187,.934118,.992111,-.0534085,.0778302,.954254,.992997,-.0495459,.0720453,.973722,.993317,-.0463707,.0663458,.991949,.994133,-.0421245,.0601883,1.00936,.994705,-.0384977,.0542501,1.02559,.995495,-.0340956,.0479862,1.04083,.996206,-.030105,.041887,1.05497,.996971,-.0256095,.0355355,1.06824,.997796,-.0213932,.0293655,1.08056,.998272,-.0169612,.0232926,1.09182,.998857,-.0126756,.0172786,1.10219,.99939,-.00832486,.0113156,1.11192,.999752,-.00410826,.00557892,1.12075,1,150957e-9,-119101e-9,1.12885,.975169,-309397e-11,.154669,195073e-10,.975439,-779608e-10,.154712,491534e-9,.975464,-311847e-9,.154716,.00196617,.975464,-701656e-9,.154716,.00442387,.975462,-.0012474,.154715,.0078647,.975461,-.00194906,.154715,.0122886,.975464,-.00280667,.154715,.0176959,.975468,-.00382025,.154716,.0240867,.975471,-.00498985,.154716,.0314612,.975472,-.00631541,.154717,.0398199,.975486,-.00779719,.154718,.0491639,.975489,-.00943505,.154718,.0594932,.975509,-.0112295,.154721,.0708113,.97554,-.0131802,.154724,.0831176,.975557,-.0152876,.154726,.096415,.975585,-.0175512,.154728,.110705,.975605,-.0199713,.154729,.125992,.975645,-.0225447,.154729,.142272,.975711,-.0252649,.154735,.159549,.975788,-.0280986,.154736,.177805,.975872,-.0308232,.154704,.196911,.975968,-.0324841,.154525,.216324,.976063,-.0351281,.154432,.236628,.976157,-.0388618,.15446,.257539,.976204,-.0437704,.154665,.278975,.976358,-.047514,.154652,.302606,.976571,-.0508638,.154535,.327204,.976725,-.0534995,.154221,.352276,.977013,-.0555547,.153737,.377696,.977294,-.0586728,.153403,.403855,.977602,-.0622715,.15312,.430333,.977932,-.0658166,.152755,.456855,.978241,-.0689877,.152233,.483668,.978602,-.0712805,.15132,.512097,.979234,-.0732775,.150235,.540455,.97977,-.075163,.148978,.568486,.979995,-.0778026,.147755,.596524,.98078,-.0791854,.146019,.624825,.981628,-.0799666,.143906,.653403,.982067,-.0808532,.141561,.681445,.98271,-.0816024,.139025,.708918,.983734,-.0812511,.135764,.736594,.98431,-.0806201,.132152,.763576,.985071,-.0801605,.12846,.789797,.98618,-.0784208,.124084,.815804,.986886,-.0766643,.1193,.840869,.987485,-.0747744,.114236,.864952,.988431,-.0716701,.108654,.888431,.988886,-.0691609,.102994,.910963,.990024,-.0654048,.0967278,.932629,.990401,-.0619765,.090384,.95313,.991093,-.0579296,.0837885,.972587,.992018,-.0536576,.0770171,.991184,.992536,-.0493719,.0701486,1.00863,.993421,-.0444813,.062953,1.02494,.993928,-.040008,.0560455,1.04017,.994994,-.0347982,.04856,1.05463,.995866,-.0301017,.0416152,1.06807,.996916,-.0248225,.0342597,1.08039,.997766,-.0199229,.0271668,1.09177,.998479,-.0147422,.0201387,1.10235,.99921,-.00980173,.0131944,1.11206,.999652,-.0047426,.00640712,1.12104,.999998,891673e-10,-10379e-8,1.12906,.967868,-351885e-11,.175947,193569e-10,.968001,-886733e-10,.175972,487782e-9,.96801,-354697e-9,.175973,.00195115,.968012,-798063e-9,.175974,.00439006,.968011,-.00141879,.175973,.00780461,.968011,-.00221686,.175973,.0121948,.968016,-.00319231,.175974,.0175607,.968019,-.00434515,.175974,.0239027,.968018,-.00567538,.175974,.0312208,.968033,-.00718308,.175977,.0395158,.968049,-.00886836,.175979,.0487885,.968047,-.0107312,.175978,.0590394,.968072,-.0127719,.175981,.0702705,.968108,-.0149905,.175986,.0824836,.968112,-.0173866,.175985,.0956783,.968173,-.0199611,.175993,.109862,.96827,-.0227128,.176008,.125033,.968292,-.025639,.17601,.141193,.968339,-.0287299,.176007,.158336,.968389,-.0319399,.176001,.176441,.968501,-.034941,.175962,.195359,.968646,-.0370812,.175793,.214686,.968789,-.0402329,.175708,.234973,.96886,-.0442601,.1757,.255871,.969013,-.049398,.175876,.277238,.969242,-.0539932,.17594,.300326,.969419,-.0577299,.175781,.324702,.969763,-.0605643,.175432,.349527,.970093,-.0634488,.174992,.374976,.970361,-.0670589,.174611,.401097,.970825,-.0708246,.174226,.427496,.971214,-.0742871,.173684,.453858,.971622,-.0782608,.173186,.480637,.972175,-.0813151,.172288,.508655,.972944,-.0832678,.170979,.536973,.973595,-.0855964,.169573,.565138,.974345,-.0882163,.168152,.593222,.975233,-.0901671,.166314,.621201,.976239,-.0912111,.163931,.649919,.977289,-.0916959,.161106,.678011,.978076,-.0927061,.158272,.705717,.979533,-.0925562,.15475,.733228,.980335,-.0918159,.150638,.760454,.981808,-.0908508,.146201,.786918,.983061,-.0896172,.141386,.812953,.984148,-.0871588,.135837,.838281,.985047,-.0850624,.130135,.862594,.986219,-.0818541,.123882,.88633,.987043,-.0784523,.117126,.908952,.988107,-.0749601,.110341,.930744,.988955,-.0703548,.102885,.951728,.989426,-.0662798,.0954167,.971166,.990421,-.0610834,.0876331,.989984,.991032,-.0562936,.0797785,1.00765,.992041,-.0508154,.0718166,1.02434,.992794,-.0454045,.0637125,1.03976,.993691,-.0398194,.0555338,1.05418,.994778,-.0341482,.0473388,1.06772,.995915,-.028428,.0391016,1.08028,.997109,-.022642,.0309953,1.09185,.998095,-.0168738,.0230288,1.10247,.998985,-.0111274,.0150722,1.11229,.999581,-.00543881,.00740605,1.12131,1.00003,162239e-9,-105549e-9,1.12946,.959505,-393734e-11,.196876,191893e-10,.959599,-992157e-10,.196895,483544e-9,.959641,-396868e-9,.196903,.0019342,.959599,-892948e-9,.196895,.00435193,.959603,-.00158747,.196896,.0077368,.959604,-.00248042,.196896,.0120888,.959605,-.00357184,.196896,.0174082,.959605,-.00486169,.196896,.0236949,.959613,-.00635008,.196897,.0309497,.959619,-.00803696,.196898,.0391725,.959636,-.00992255,.196901,.0483649,.959634,-.0120067,.1969,.0585266,.959675,-.0142898,.196906,.0696609,.959712,-.0167717,.196911,.0817678,.959752,-.0194524,.196918,.0948494,.959807,-.0223321,.196925,.10891,.959828,-.0254091,.196924,.123947,.959906,-.0286815,.196934,.139968,.960005,-.0321371,.196944,.156968,.960071,-.0357114,.196936,.17491,.960237,-.0389064,.196882,.193597,.960367,-.041623,.196731,.21285,.960562,-.0452655,.196654,.233075,.960735,-.0496207,.196643,.253941,.960913,-.0549379,.196774,.275278,.961121,-.0603414,.196893,.297733,.96139,-.0644244,.196717,.321877,.961818,-.067556,.196314,.346476,.962175,-.0712709,.195917,.371907,.96255,-.0752848,.1955,.397916,.963164,-.0792073,.195026,.424229,.963782,-.0828225,.194424,.450637,.964306,-.0873119,.193831,.477288,.964923,-.0911051,.192973,.504716,.966048,-.093251,.19151,.533053,.967024,-.0958983,.190013,.561366,.968038,-.09835,.188253,.589464,.969152,-.100754,.186257,.617433,.970557,-.102239,.183775,.645801,.972104,-.102767,.180645,.674278,.973203,-.103492,.177242,.702004,.975123,-.103793,.17345,.729529,.97641,-.102839,.168886,.756712,.978313,-.101687,.163892,.783801,.980036,-.100314,.158439,.809671,.981339,-.097836,.152211,.835402,.982794,-.0950006,.145679,.860081,.984123,-.0920994,.138949,.883757,.984918,-.0878641,.131283,.90685,.985999,-.083939,.123464,.928786,.987151,-.0791234,.115324,.94983,.987827,-.0739332,.106854,.96962,.988806,-.0688088,.0982691,.98861,.989588,-.0628962,.0893456,1.00667,.990438,-.0573146,.0805392,1.02344,.991506,-.0509433,.0713725,1.03933,.992492,-.0448724,.0623732,1.05378,.993663,-.0383497,.0530838,1.06747,.994956,-.0319593,.0439512,1.08007,.99634,-.025401,.0347803,1.09182,.99761,-.0189687,.0257954,1.1025,.99863,-.0124441,.0169893,1.11247,.99947,-.00614003,.00829498,1.12151,1.00008,216624e-9,-146107e-9,1.12993,.950129,-434955e-11,.217413,190081e-10,.950264,-10957e-8,.217444,47884e-8,.9503,-438299e-9,.217451,.00191543,.950246,-986124e-9,.21744,.00430951,.950246,-.00175311,.21744,.00766137,.950245,-.00273923,.21744,.011971,.950253,-.00394453,.217441,.0172385,.950258,-.00536897,.217442,.0234641,.950267,-.00701262,.217444,.030648,.950277,-.00887551,.217446,.038791,.950284,-.0109576,.217446,.0478931,.950312,-.0132591,.217451,.0579568,.950334,-.01578,.217454,.0689821,.950378,-.0185204,.217462,.0809714,.950417,-.0214803,.217467,.0939265,.950488,-.0246594,.217479,.10785,.950534,-.0280565,.217483,.122743,.950633,-.0316685,.217498,.138611,.950698,-.0354787,.217499,.155442,.950844,-.0394003,.217507,.173208,.950999,-.0426812,.217419,.191605,.951221,-.0461302,.217317,.21084,.951412,-.0502131,.217238,.230945,.951623,-.0549183,.21722,.251745,.951867,-.0604493,.217306,.273001,.952069,-.0665189,.217466,.294874,.952459,-.0709179,.217266,.318732,.952996,-.0746112,.216891,.34318,.953425,-.0789252,.216503,.36849,.953885,-.0833293,.216042,.394373,.954617,-.087371,.215469,.420505,.955429,-.0914054,.214802,.446907,.956068,-.0961671,.214146,.473522,.957094,-.10048,.213286,.50052,.958372,-.103248,.211796,.528715,.959654,-.106033,.21016,.557065,.961305,-.108384,.208149,.585286,.962785,-.111122,.206024,.613334,.964848,-.112981,.203442,.641334,.966498,-.113717,.19996,.669955,.968678,-.114121,.196105,.698094,.970489,-.114524,.191906,.725643,.972903,-.113792,.186963,.752856,.974701,-.112406,.181343,.780013,.976718,-.110685,.175185,.806268,.978905,-.108468,.168535,.832073,.980267,-.105061,.161106,.857149,.981967,-.101675,.153387,.881145,.983063,-.0974492,.145199,.904255,.984432,-.0925815,.136527,.926686,.985734,-.0877983,.127584,.947901,.986228,-.081884,.118125,.968111,.98719,-.0761208,.108594,.98719,.988228,-.0698196,.0989996,1.00559,.989046,-.0632739,.0890074,1.02246,.990242,-.056522,.0790832,1.03841,.991252,-.0495272,.0689182,1.05347,.992542,-.0425373,.0588592,1.06724,.994096,-.0353198,.0486833,1.08009,.995593,-.028235,.0385977,1.09177,.99711,-.0209511,.0286457,1.10274,.998263,-.0139289,.0188497,1.11262,.999254,-.0067359,.009208,1.12191,.999967,141846e-9,-657764e-10,1.13024,.935608,-474692e-11,.236466,187817e-10,.93996,-11971e-8,.237568,473646e-9,.939959,-478845e-9,.237567,.0018946,.939954,-.0010774,.237566,.00426284,.939956,-.00191538,.237566,.00757842,.939954,-.00299277,.237566,.0118413,.93996,-.00430961,.237567,.0170518,.939969,-.00586589,.237569,.02321,.939982,-.00766166,.237572,.0303164,.939987,-.00969686,.237572,.0383711,.939997,-.0119715,.237574,.0473751,.940031,-.0144858,.237581,.0573298,.940073,-.0172399,.237589,.0682366,.94012,-.0202335,.237598,.080097,.940162,-.0234663,.237604,.0929116,.940237,-.0269387,.237615,.106686,.940328,-.0306489,.237632,.121421,.940419,-.0345917,.237645,.137115,.940522,-.0387481,.237654,.153766,.940702,-.0429906,.237661,.17133,.940871,-.0465089,.237561,.189502,.941103,-.050531,.23748,.208616,.941369,-.0550657,.237423,.228595,.941641,-.0601337,.237399,.249287,.941903,-.0658804,.237443,.270467,.942224,-.0722674,.237597,.292024,.942633,-.0771788,.237419,.315272,.943172,-.0815623,.237068,.339579,.943691,-.0863973,.236682,.364717,.944382,-.0911536,.236213,.390435,.945392,-.0952967,.235562,.416425,.946185,-.0998948,.234832,.442772,.947212,-.104796,.234114,.469347,.948778,-.10928,.233222,.496162,.950149,-.113081,.231845,.523978,.951989,-.115893,.230005,.552295,.953921,-.11846,.227862,.580569,.955624,-.12115,.225439,.608698,.958234,-.123373,.222635,.636696,.960593,-.124519,.219093,.665208,.963201,-.124736,.214749,.693557,.965642,-.125012,.210059,.721334,.968765,-.124661,.204935,.748613,.971753,-.122996,.198661,.776224,.973751,-.120998,.191823,.802461,.976709,-.118583,.184359,.828399,.977956,-.115102,.176437,.853693,.979672,-.111077,.167681,.877962,.981816,-.10688,.158872,.901564,.98238,-.101469,.149398,.924057,.983964,-.0960013,.139436,.945751,.984933,-.0899626,.12943,.966272,.985694,-.0832973,.11894,.985741,.986822,-.0767082,.108349,1.00407,.987725,-.0693614,.0976026,1.02154,.98877,-.06211,.086652,1.03757,.990129,-.0544143,.0756182,1.05296,.991337,-.046744,.0645753,1.06683,.992978,-.0387931,.0534683,1.0798,.994676,-.030973,.0424137,1.09181,.99645,-.0230311,.0314035,1.10286,.997967,-.0152065,.0206869,1.11291,.99922,-.00744837,.010155,1.12237,1.00002,240209e-9,-752767e-10,1.13089,.922948,-515351e-11,.255626,186069e-10,.928785,-129623e-9,.257244,468009e-9,.928761,-51849e-8,.257237,.00187202,.928751,-.0011666,.257235,.00421204,.928751,-.00207395,.257234,.0074881,.928754,-.00324055,.257235,.0117002,.92876,-.00466639,.257236,.0168486,.928763,-.00635149,.257237,.0229334,.928774,-.00829584,.257239,.029955,.928791,-.0104995,.257243,.0379139,.928804,-.0129623,.257245,.0468108,.928847,-.0156846,.257255,.0566473,.92889,-.0186661,.257263,.0674246,.928924,-.0219067,.257268,.0791433,.928989,-.0254066,.257282,.0918076,.92909,-.0291651,.257301,.105419,.92918,-.0331801,.257316,.119978,.92929,-.0374469,.257332,.135491,.929453,-.041939,.257357,.151948,.929586,-.0464612,.257347,.169275,.929858,-.0503426,.257269,.187257,.930125,-.0548409,.257199,.206204,.930403,-.0598063,.257149,.22601,.930726,-.0652437,.257122,.246561,.931098,-.0712376,.257153,.267618,.931396,-.0777506,.257237,.288993,.931947,-.0832374,.257124,.311527,.932579,-.0883955,.25683,.335697,.933194,-.0937037,.256444,.360634,.934013,-.0987292,.255939,.386126,.935307,-.103215,.255282,.412018,.936374,-.108234,.254538,.438292,.93776,-.113234,.253728,.464805,.939599,-.118013,.25275,.491464,.941036,-.122661,.251404,.518751,.94337,-.125477,.249435,.547133,.945318,-.128374,.247113,.575456,.947995,-.130996,.244441,.60372,.950818,-.133438,.241352,.63174,.954378,-.135004,.237849,.659971,.957151,-.135313,.233188,.688478,.960743,-.13521,.228001,.716767,.964352,-.135007,.222249,.744349,.967273,-.133523,.21542,.771786,.969767,-.131155,.208039,.798639,.973195,-.128492,.200076,.824774,.975557,-.125094,.191451,.850222,.977692,-.120578,.18184,.874761,.98026,-.115882,.172102,.898497,.981394,-.110372,.161859,.921636,.982386,-.10415,.15108,.943467,.983783,-.0978128,.140407,.964045,.98422,-.0906171,.129058,.98398,.985447,-.0832921,.117614,1.00276,.986682,-.0754412,.10585,1.02047,.987326,-.0673885,.0940943,1.03678,.988707,-.0592565,.0822093,1.05218,.990185,-.050717,.070192,1.06652,.991866,-.0423486,.0582081,1.07965,.993897,-.0336118,.0460985,1.09188,.995841,-.0252178,.0342737,1.10307,.997605,-.0164893,.0224829,1.11324,.999037,-.00817112,.0110647,1.12262,1.00003,291686e-9,-168673e-9,1.13139,.915304,-552675e-11,.275999,183285e-10,.91668,-139285e-9,.276414,461914e-9,.916664,-55713e-8,.276409,.00184763,.916653,-.00125354,.276406,.00415715,.916651,-.00222851,.276405,.00739053,.916655,-.00348205,.276406,.0115478,.916653,-.00501414,.276405,.0166291,.916667,-.00682478,.276409,.0226346,.91668,-.00891398,.276412,.0295648,.91669,-.0112817,.276413,.0374199,.916727,-.013928,.276422,.0462016,.916759,-.0168528,.276429,.0559101,.916793,-.0200558,.276436,.0665466,.916849,-.0235373,.276448,.0781139,.916964,-.0272973,.276474,.0906156,.917047,-.0313344,.276491,.104051,.917152,-.0356465,.276511,.118424,.917286,-.0402271,.276533,.133736,.917469,-.0450408,.276564,.149978,.917686,-.0497872,.276563,.167057,.917953,-.0540937,.276493,.184846,.918228,-.0590709,.276437,.203614,.918572,-.0644277,.276398,.223212,.918918,-.0702326,.276362,.243584,.919356,-.076484,.276383,.264465,.919842,-.0830808,.276434,.285701,.920451,-.0892972,.276407,.307559,.921113,-.095016,.276128,.331501,.921881,-.100771,.275754,.356207,.923027,-.106029,.275254,.381477,.924364,-.111029,.274595,.40722,.925818,-.116345,.273841,.433385,.92746,-.121424,.272913,.459848,.929167,-.12657,.271837,.486493,.931426,-.131581,.270575,.513432,.934001,-.135038,.268512,.541502,.936296,-.138039,.266135,.569658,.939985,-.140687,.263271,.598375,.943516,-.143247,.260058,.626563,.94782,-.145135,.256138,.654711,.951023,-.145733,.251154,.683285,.955338,-.145554,.245562,.711831,.959629,-.145008,.239265,.739573,.963123,-.144003,.232064,.767027,.966742,-.141289,.224036,.794359,.969991,-.138247,.215305,.820361,.973403,-.134786,.206051,.846548,.975317,-.129966,.195914,.871541,.977647,-.12471,.185184,.895313,.980137,-.119086,.174161,.918398,.981031,-.112297,.162792,.940679,.982037,-.105372,.150952,.961991,.983164,-.097821,.138921,.981913,.983757,-.0897245,.126611,1.00109,.985036,-.0815974,.114228,1.01902,.986289,-.0727725,.101389,1.03604,.987329,-.0639323,.0886476,1.05149,.989193,-.0548109,.0756837,1.06619,.990716,-.045687,.0627581,1.07948,.992769,-.0364315,.0498337,1.09172,.99524,-.0271761,.0370305,1.1033,.997154,-.0179609,.0243959,1.11353,.998845,-.00878063,.0119567,1.12319,1.00002,259038e-9,-108146e-9,1.13177,.903945,-591681e-11,.295126,181226e-10,.903668,-148672e-9,.295037,455367e-9,.903677,-594683e-9,.29504,.00182145,.903673,-.00133805,.295039,.00409831,.903666,-.00237872,.295036,.00728584,.903668,-.00371676,.295037,.0113842,.903679,-.00535212,.29504,.0163936,.903684,-.00728479,.295041,.0223141,.903698,-.00951473,.295044,.0291462,.903718,-.0120419,.295049,.0368904,.903754,-.0148664,.295058,.0455477,.903801,-.017988,.29507,.0551194,.903851,-.0214064,.295082,.0656058,.903921,-.0251219,.295097,.0770109,.904002,-.0291337,.295116,.0893354,.904111,-.033441,.29514,.102583,.904246,-.0380415,.295169,.116755,.904408,-.0429258,.295202,.131853,.904637,-.0480468,.295245,.147869,.904821,-.0529208,.295214,.164658,.905163,-.0577748,.295185,.182274,.905469,-.0631763,.295143,.200828,.905851,-.068917,.295112,.2202,.906322,-.0750861,.295104,.240372,.906761,-.0815855,.295086,.261082,.90735,-.0882138,.295095,.282123,.908087,-.095082,.295139,.303563,.908826,-.101488,.29492,.327028,.909832,-.107577,.294577,.351464,.911393,-.113033,.294115,.376497,.912804,-.118629,.293446,.402115,.914081,-.124232,.292581,.428111,.91637,-.129399,.29166,.454442,.91814,-.134892,.290422,.481024,.921179,-.140069,.289194,.507924,.924544,-.144431,.287421,.535557,.927995,-.147498,.284867,.563984,.931556,-.150197,.281722,.5923,.935777,-.152711,.278207,.620832,.940869,-.154836,.274148,.649069,.945994,-.155912,.269057,.677746,.949634,-.155641,.262799,.706293,.955032,-.154809,.256097,.734278,.95917,-.153678,.248618,.761751,.962931,-.151253,.239794,.789032,.966045,-.147625,.230281,.815422,.96971,-.143964,.220382,.841787,.972747,-.139464,.209846,.867446,.975545,-.133459,.198189,.892004,.978381,-.127424,.186362,.915458,.979935,-.120506,.173964,.937948,.980948,-.11282,.161429,.959732,.982234,-.104941,.148557,.980118,.982767,-.0962905,.135508,.999463,.983544,-.0873625,.122338,1.01756,.984965,-.0783447,.108669,1.03492,.986233,-.0684798,.0949911,1.05087,.987796,-.0590867,.0811386,1.0656,.989885,-.0489145,.0673099,1.0794,.991821,-.0391,.0535665,1.09174,.99448,-.029087,.0397529,1.10341,.996769,-.019114,.0261463,1.11383,.998641,-.00947007,.0128731,1.1237,.999978,446316e-9,-169093e-9,1.13253,.888362,-627064e-11,.312578,178215e-10,.889988,-157791e-9,.313148,448451e-9,.889825,-631076e-9,.313092,.00179356,.88984,-.00141994,.313097,.00403554,.889828,-.0025243,.313092,.00717429,.889831,-.00394421,.313093,.0112099,.889831,-.00567962,.313093,.0161425,.889844,-.00773051,.313096,.0219724,.889858,-.0100968,.3131,.0286999,.889882,-.0127786,.313106,.0363256,.889918,-.0157757,.313116,.0448509,.889967,-.0190878,.313129,.0542758,.89003,-.022715,.313145,.0646032,.890108,-.0266566,.313165,.0758339,.890218,-.0309131,.313193,.0879729,.890351,-.0354819,.313226,.101019,.89051,-.0403613,.313263,.114979,.890672,-.0455385,.313294,.129848,.890882,-.0509444,.313333,.145616,.891189,-.0559657,.313324,.162122,.891457,-.0613123,.313281,.179524,.891856,-.0671488,.313281,.197855,.892312,-.0732732,.313268,.216991,.892819,-.0797865,.313263,.236924,.893369,-.0865269,.313247,.257433,.894045,-.0931592,.313205,.278215,.894884,-.100532,.313276,.299467,.895832,-.107716,.313205,.322276,.897043,-.114099,.312873,.34642,.898515,-.119941,.312331,.371187,.900191,-.126044,.311731,.396656,.90188,-.131808,.310859,.422488,.904359,-.137289,.309857,.448744,.906923,-.142991,.308714,.475239,.910634,-.148253,.307465,.501983,.914502,-.153332,.305774,.529254,.919046,-.156646,.303156,.557709,.923194,-.159612,.299928,.586267,.928858,-.162027,.296245,.614925,.934464,-.164203,.291832,.643187,.939824,-.165602,.286565,.671601,.944582,-.165383,.280073,.700213,.949257,-.164439,.272891,.728432,.954389,-.162953,.264771,.756082,.958595,-.161007,.255927,.78369,.962138,-.157243,.245769,.810769,.966979,-.152872,.235127,.836999,.969566,-.148209,.22347,.862684,.972372,-.142211,.211147,.887847,.975916,-.135458,.198606,.911843,.978026,-.128398,.185498,.934795,.979686,-.120313,.17171,.956787,.980748,-.11166,.158159,.978046,.981622,-.103035,.144399,.997693,.982356,-.0930328,.13001,1.01642,.983308,-.0834627,.115778,1.03366,.985037,-.0732249,.101327,1.05014,.986493,-.0628145,.086554,1.06507,.988484,-.0526556,.0720413,1.07907,.991051,-.0415744,.0571151,1.09189,.993523,-.0314275,.0426643,1.10369,.99628,-.0203603,.0279325,1.11423,.998344,-.0102446,.0138182,1.12421,.999997,42612e-8,-193628e-9,1.1333,.871555,-660007e-11,.329176,174749e-10,.875255,-166579e-9,.330571,441051e-9,.875644,-666394e-9,.330718,.00176441,.875159,-.00149903,.330536,.00396899,.87516,-.00266493,.330536,.007056,.875158,-.00416393,.330535,.0110251,.87516,-.00599598,.330535,.0158764,.875163,-.00816108,.330536,.0216101,.875174,-.0106591,.330538,.0282266,.875199,-.0134899,.330545,.0357266,.875257,-.0166538,.330563,.0441117,.875304,-.0201501,.330575,.0533821,.875373,-.0239785,.330595,.0635395,.875464,-.0281389,.330619,.0745872,.875565,-.0326301,.330645,.0865255,.875691,-.0374516,.330676,.0993599,.875897,-.0425993,.330733,.113093,.876091,-.0480576,.330776,.127722,.876353,-.0537216,.330826,.143227,.876649,-.0589807,.330809,.159462,.877034,-.0647865,.330819,.176642,.877443,-.0709789,.330817,.194702,.877956,-.0774782,.330832,.213577,.878499,-.0843175,.330822,.233246,.879144,-.0912714,.330804,.253512,.879982,-.0980824,.330766,.274137,.88097,-.105823,.330864,.295209,.882051,-.113671,.330896,.317226,.883397,-.120303,.330545,.341068,.884987,-.12667,.330068,.365613,.886789,-.133118,.329418,.390807,.889311,-.139024,.328683,.416494,.891995,-.144971,.327729,.442618,.895106,-.150747,.326521,.469131,.899527,-.156283,.325229,.495921,.90504,-.161707,.32378,.523162,.909875,-.165661,.32122,.55092,.91561,-.168755,.317942,.579928,.921225,-.171193,.313983,.608539,.927308,-.17319,.309636,.636854,.933077,-.174819,.304262,.66523,.938766,-.175002,.297563,.693609,.943667,-.173946,.289613,.722157,.949033,-.172221,.281227,.750021,.953765,-.169869,.271545,.777466,.95804,-.166578,.261034,.804853,.962302,-.161761,.249434,.831569,.966544,-.156636,.237484,.857779,.969372,-.150784,.224395,.883051,.972486,-.143672,.210786,.907864,.975853,-.135772,.196556,.931223,.977975,-.127942,.182307,.954061,.979122,-.118347,.167607,.97531,.980719,-.109112,.152739,.995666,.981223,-.0991789,.137932,1.01475,.98216,-.0883553,.122692,1.03253,.983379,-.0780825,.107493,1.04917,.985434,-.0665646,.0917791,1.06464,.987332,-.0557714,.0764949,1.07896,.990004,-.0442805,.060721,1.09199,.992975,-.0331676,.0452284,1.10393,.995811,-.0219547,.0297934,1.11476,.9982,-.0107613,.0146415,1.12484,1.00002,248678e-9,-14555e-8,1.13413,.859519,-693595e-11,.347264,171673e-10,.859843,-17503e-8,.347394,433219e-9,.859656,-700076e-9,.347319,.00173277,.859671,-.00157517,.347325,.00389875,.859669,-.00280028,.347324,.00693112,.85967,-.0043754,.347324,.01083,.859665,-.00630049,.347321,.0155954,.859685,-.0085755,.347328,.0212278,.859694,-.0112003,.347329,.0277273,.859718,-.0141747,.347336,.0350946,.85976,-.0174988,.347348,.0433314,.85982,-.0211722,.347366,.0524384,.859892,-.0251941,.347387,.0624168,.860006,-.0295649,.347422,.0732708,.860122,-.0342825,.347453,.0849999,.860282,-.0393462,.347499,.0976102,.860482,-.0447513,.347554,.111104,.860719,-.0504775,.347614,.125479,.860998,-.0563577,.347666,.140703,.861322,-.0619473,.347662,.156681,.861724,-.0681277,.347684,.173597,.862198,-.0746567,.347709,.191371,.862733,-.0815234,.347727,.209976,.863371,-.0886643,.347744,.229351,.86414,-.0957908,.347734,.24934,.865138,-.102912,.34772,.269797,.866182,-.110924,.3478,.290654,.867436,-.119223,.347911,.312074,.869087,-.126197,.347649,.335438,.870859,-.133145,.347222,.359732,.872997,-.139869,.346645,.38467,.875939,-.146089,.345935,.41019,.879012,-.152334,.345012,.436218,.883353,-.15821,.343924,.462641,.888362,-.164097,.342636,.489449,.895026,-.169528,.341351,.516629,.900753,-.174408,.339115,.544109,.906814,-.17751,.335809,.572857,.912855,-.180101,.331597,.601554,.919438,-.182116,.32698,.630198,.925962,-.183494,.321449,.658404,.931734,-.184159,.314595,.686625,.93762,-.18304,.306462,.71531,.943858,-.181323,.297514,.744272,.948662,-.178683,.287447,.771462,.953299,-.175379,.276166,.798593,.957346,-.170395,.263758,.8256,.962565,-.165042,.251019,.852575,.966075,-.158655,.237011,.878316,.969048,-.151707,.222518,.90329,.972423,-.143271,.207848,.927745,.975833,-.134824,.192463,.950859,.977629,-.125444,.1768,.972947,.978995,-.114949,.161033,.993263,.980533,-.104936,.145523,1.01337,.980745,-.0935577,.129799,1.03128,.981814,-.0822956,.113486,1.04825,.983943,-.0710082,.0972925,1.06405,.986141,-.0587931,.0808138,1.0785,.988878,-.0472755,.0644915,1.09204,.992132,-.0349128,.0478128,1.10413,.9953,-.0232407,.031621,1.11527,.998117,-.0112713,.0154935,1.12551,1.00003,339743e-9,-195763e-9,1.13504,.845441,-729126e-11,.364305,169208e-10,.843588,-183164e-9,.363506,425067e-9,.843412,-73253e-8,.36343,.00169999,.843401,-.00164818,.363426,.00382495,.843399,-.00293008,.363425,.00679993,.843401,-.00457822,.363425,.010625,.843394,-.00659249,.363421,.0153002,.843398,-.00897282,.363421,.0208258,.843415,-.0117191,.363426,.0272024,.843438,-.0148312,.363432,.0344305,.843483,-.018309,.363447,.0425116,.84356,-.0221521,.363472,.0514471,.843646,-.0263597,.363499,.061238,.843743,-.0309315,.363527,.0718873,.84388,-.0358658,.363569,.0833969,.844079,-.0411624,.363631,.0957742,.844279,-.0468128,.363688,.109015,.844549,-.0527923,.363761,.123124,.844858,-.0588204,.363817,.138044,.84522,-.0647573,.36383,.153755,.845669,-.0713181,.363879,.170394,.846155,-.0781697,.363908,.187861,.846789,-.0853913,.363969,.206176,.847502,-.0928086,.363999,.225244,.8484,-.10005,.363997,.244926,.849461,-.107615,.364008,.265188,.850562,-.115814,.364055,.28587,.851962,-.124334,.364179,.306926,.854326,-.131995,.364233,.329605,.856295,-.139338,.363856,.35359,.858857,-.146346,.363347,.37831,.862428,-.152994,.362807,.403722,.866203,-.159463,.361963,.429537,.871629,-.165623,.36112,.456,.877365,-.171649,.359917,.482773,.883744,-.177151,.35848,.509705,.890693,-.182381,.356523,.537215,.897278,-.186076,.3533,.565493,.903958,-.188602,.349095,.594293,.910908,-.190755,.344215,.623165,.918117,-.192063,.338606,.651573,.924644,-.192758,.331544,.679869,.931054,-.192238,.323163,.708668,.937303,-.190035,.313529,.737201,.943387,-.187162,.303152,.764977,.948494,-.183876,.29146,.792683,.952546,-.178901,.277917,.819228,.958077,-.173173,.264753,.846559,.962462,-.16645,.25002,.872962,.966569,-.159452,.234873,.898729,.969108,-.15074,.218752,.923126,.973072,-.141523,.202673,.947278,.975452,-.132075,.186326,.969938,.977784,-.121257,.169396,.991325,.97899,-.110182,.153044,1.01123,.979777,-.0989634,.136485,1.0299,.980865,-.0865894,.119343,1.04727,.982432,-.0746115,.102452,1.06341,.984935,-.0621822,.0852423,1.07834,.987776,-.0495694,.0678546,1.092,.99103,-.0372386,.0506917,1.1043,.99474,-.0244353,.0333316,1.11576,.997768,-.0121448,.0164348,1.12617,1.00003,31774e-8,-169504e-9,1.13598,.825551,-756799e-11,.378425,165099e-10,.82664,-190922e-9,.378923,416504e-9,.826323,-763495e-9,.378779,.0016656,.826359,-.00171789,.378795,.00374768,.82636,-.00305402,.378795,.00666259,.826368,-.00477185,.378798,.0104104,.826364,-.00687131,.378795,.0149912,.826368,-.00935232,.378795,.0204054,.826376,-.0122146,.378797,.0266532,.826399,-.0154581,.378803,.0337355,.82646,-.0190825,.378824,.0416537,.826525,-.0230873,.378846,.0504091,.826614,-.0274719,.378876,.0600032,.82674,-.0322355,.378917,.0704393,.826888,-.0373766,.378964,.0817195,.827078,-.0428936,.379024,.0938492,.827318,-.0487778,.379099,.106828,.82764,-.0549935,.379199,.120659,.827926,-.0611058,.379227,.13526,.828325,-.0675054,.379275,.150713,.828801,-.0743455,.379332,.167034,.8294,-.0815523,.379415,.184209,.830094,-.0890779,.379495,.202203,.8309,-.096736,.379555,.220945,.831943,-.104135,.379577,.240306,.833037,-.112106,.379604,.260317,.834278,-.120554,.379668,.2808,.836192,-.129128,.3799,.301654,.838671,-.137541,.380109,.323502,.840939,-.14523,.379809,.347176,.844575,-.15248,.379593,.371706,.848379,-.159607,.37909,.39688,.853616,-.166267,.378617,.422702,.858921,-.172698,.377746,.448919,.865324,-.178823,.376749,.475661,.872207,-.184542,.375363,.502599,.880018,-.189836,.373657,.529914,.88694,-.194294,.370673,.557683,.894779,-.197022,.36662,.586848,.902242,-.199108,.36138,.615831,.909914,-.200398,.355434,.644478,.917088,-.20094,.348173,.672905,.923888,-.200671,.339482,.701327,.930495,-.198773,.32956,.730101,.937247,-.195394,.318363,.758383,.943108,-.191956,.306323,.786539,.948296,-.187227,.292576,.813637,.953472,-.181165,.278234,.840793,.958485,-.174119,.263054,.867712,.962714,-.166564,.246756,.893635,.966185,-.158181,.229945,.919028,.970146,-.148275,.212633,.943413,.973491,-.138157,.195229,.966627,.975741,-.127574,.178048,.988817,.977238,-.11554,.160312,1.00924,.978411,-.10364,.142857,1.02845,.979811,-.0913122,.125317,1.04648,.98116,-.0782558,.107627,1.06284,.983543,-.0655957,.0895862,1.07798,.986789,-.0520411,.0713756,1.092,.990292,-.0389727,.053228,1.10484,.994187,-.025808,.0351945,1.11642,.997499,-.0126071,.0173198,1.12703,.999999,275604e-9,-148602e-9,1.13674,.81075,-78735e-10,.394456,161829e-10,.808692,-198293e-9,.393453,407564e-9,.80846,-792877e-9,.39334,.00162965,.808595,-.00178416,.393407,.00366711,.808597,-.00317182,.393408,.00651934,.808598,-.00495589,.393408,.0101866,.808591,-.00713627,.393403,.0146689,.808592,-.00971285,.393402,.0199667,.80861,-.0126855,.393407,.0260803,.808633,-.0160538,.393413,.0330107,.80868,-.0198175,.393429,.0407589,.808748,-.0239758,.393453,.0493264,.808854,-.0285286,.39349,.0587161,.808992,-.0334748,.39354,.0689304,.809141,-.0388116,.393588,.0799707,.809352,-.0445375,.39366,.0918432,.809608,-.0506427,.393742,.104549,.809915,-.0570708,.393834,.118085,.810253,-.0633526,.393885,.132377,.810687,-.0700966,.393953,.147537,.811233,-.0772274,.394047,.163543,.811865,-.0847629,.394148,.180394,.812648,-.0925663,.394265,.198051,.813583,-.100416,.394363,.216443,.814683,-.108119,.394402,.235502,.815948,-.11644,.394489,.255242,.817278,-.125036,.394542,.275441,.819605,-.133655,.39486,.296094,.822256,-.142682,.395248,.317309,.825349,-.150756,.395241,.340516,.829605,-.158392,.395285,.364819,.83391,-.165801,.394922,.389736,.839808,-.172677,.394691,.415409,.845708,-.179448,.394006,.441546,.853025,-.185746,.393279,.46832,.859666,-.191684,.391655,.495302,.86789,-.197146,.390068,.52262,.875845,-.201904,.38727,.550336,.882634,-.205023,.382688,.578825,.891076,-.207098,.377543,.608103,.900589,-.208474,.371752,.63723,.90791,-.209068,.364016,.665769,.915971,-.208655,.355593,.694428,.923455,-.20729,.345439,.723224,.931514,-.203821,.334099,.751925,.937885,-.19986,.321069,.780249,.943136,-.194993,.306571,.8077,.948818,-.189132,.291556,.83497,.954433,-.181617,.275745,.86188,.959078,-.173595,.258695,.888562,.962705,-.164855,.240825,.914008,.966753,-.155129,.22268,.939145,.970704,-.144241,.204542,.963393,.973367,-.133188,.185927,.985983,.975984,-.121146,.167743,1.00704,.976994,-.108366,.149218,1.02715,.978485,-.0956746,.13131,1.0455,.980074,-.0820733,.112513,1.06221,.98225,-.0684061,.0938323,1.07782,.98553,-.0549503,.0749508,1.09199,.989529,-.0407857,.055848,1.10508,.993536,-.0271978,.0368581,1.11684,.997247,-.0132716,.0181845,1.12789,1,431817e-9,-198809e-9,1.13792,.785886,-812608e-11,.405036,157669e-10,.790388,-205278e-9,.407355,398297e-9,.790145,-820824e-9,.407231,.00159263,.790135,-.00184681,.407226,.00358336,.790119,-.00328316,.407218,.00637039,.790126,-.00512988,.40722,.0099539,.79013,-.00738684,.407221,.0143339,.790135,-.0100538,.407221,.0195107,.790134,-.0131306,.407217,.0254848,.79016,-.0166169,.407224,.0322572,.790197,-.020512,.407236,.0398284,.790273,-.0248157,.407263,.0482014,.790381,-.029527,.407304,.0573777,.790521,-.0346446,.407355,.0673602,.790704,-.0401665,.40742,.0781522,.790925,-.0460896,.407499,.0897582,.791195,-.0524017,.407589,.10218,.791522,-.0590121,.407691,.11541,.791878,-.0654876,.407748,.12939,.792361,-.0725207,.407849,.144237,.792942,-.0799844,.407963,.159924,.79362,-.0877896,.408087,.176425,.794529,-.0958451,.408259,.193733,.795521,-.103827,.408362,.211756,.796778,-.111937,.408482,.230524,.798027,-.120521,.408547,.249967,.799813,-.129242,.408721,.269926,.802387,-.138048,.409148,.290338,.805279,-.147301,.409641,.311193,.809251,-.155895,.410154,.333611,.813733,-.163942,.410297,.357615,.819081,-.171666,.410373,.382339,.825427,-.178905,.410348,.407828,.83172,-.185812,.409486,.434034,.83877,-.192318,.408776,.460493,.845817,-.198249,.407176,.487346,.854664,-.204034,.405719,.514832,.863495,-.208908,.403282,.542401,.871883,-.212765,.399293,.570683,.88065,-.214911,.393803,.599947,.89004,-.216214,.387536,.62932,.898476,-.216745,.379846,.658319,.906738,-.216387,.370625,.687138,.914844,-.215053,.360139,.71601,.923877,-.212007,.348849,.745124,.931925,-.207481,.335639,.773366,.938054,-.202418,.320798,.801636,.943895,-.196507,.304772,.829055,.949468,-.189009,.288033,.856097,.955152,-.180539,.270532,.88301,.959403,-.171437,.251639,.909296,.963309,-.161661,.232563,.934868,.967399,-.150425,.213231,.959662,.972009,-.138659,.194247,.98302,.97433,-.126595,.174718,1.00517,.975823,-.113205,.155518,1.02566,.976371,-.0996096,.136709,1.04418,.978705,-.0860754,.117571,1.06146,.981477,-.0714438,.0980046,1.07777,.984263,-.0572304,.0782181,1.09214,.988423,-.0428875,.0584052,1.10553,.993,-.0282442,.038522,1.11758,.99704,-.0140183,.0190148,1.12864,.999913,369494e-9,-145203e-9,1.13901,.777662,-84153e-10,.423844,154403e-10,.770458,-211714e-9,.419915,38845e-8,.770716,-846888e-9,.420055,.00155386,.770982,-.00190567,.420202,.00349653,.770981,-.00338782,.420201,.00621606,.77098,-.00529338,.4202,.00971274,.770983,-.00762223,.4202,.0139867,.770985,-.0103741,.420198,.0190381,.770996,-.0135489,.4202,.0248677,.771029,-.0171461,.420212,.0314764,.771052,-.0211647,.420215,.0388648,.771131,-.0256048,.420245,.047036,.771235,-.0304647,.420284,.0559911,.771383,-.0357436,.420341,.0657346,.771591,-.0414392,.420423,.0762694,.771819,-.0475462,.420506,.0875984,.772123,-.0540506,.420617,.099727,.772464,-.060797,.42072,.112637,.772855,-.0675393,.420799,.126313,.773317,-.0748323,.420893,.140824,.773981,-.0825681,.421058,.15617,.774746,-.0906307,.421226,.172322,.77566,-.0988982,.421397,.189253,.776837,-.106994,.421569,.206912,.778097,-.115528,.421704,.225359,.779588,-.124317,.421849,.24447,.781574,-.133139,.422097,.264156,.784451,-.142179,.422615,.284318,.787682,-.15165,.423269,.304902,.792433,-.160771,.424396,.3265,.797359,-.169166,.424772,.35014,.803986,-.177149,.425475,.374768,.809504,-.184745,.424996,.399928,.815885,-.19173,.424247,.425796,.823513,-.198525,.423515,.452287,.832549,-.204709,.422787,.479321,.841653,-.210447,.421187,.506718,.850401,-.215501,.418519,.53432,.859854,-.219752,.414715,.56242,.869364,-.222305,.409462,.591558,.878837,-.223744,.402926,.621074,.888636,-.224065,.395043,.650538,.898132,-.223742,.38564,.679538,.907181,-.222308,.375378,.708674,.915621,-.219837,.363212,.737714,.9239,-.215233,.349313,.767014,.931644,-.209592,.334162,.795133,.938887,-.203644,.317943,.823228,.945282,-.196349,.300581,.850822,.950758,-.18742,.282195,.877594,.956146,-.177879,.262481,.904564,.960355,-.167643,.242487,.930741,.965256,-.156671,.222668,.955868,.968029,-.144123,.201907,.979869,.97251,-.131305,.18202,1.00291,.974925,-.118335,.161909,1.02392,.975402,-.103714,.142129,1.0433,.976987,-.089415,.122447,1.06089,.979677,-.0748858,.102248,1.07713,.983184,-.0596086,.0814851,1.09218,.987466,-.0447671,.0609484,1.10585,.992348,-.0295217,.0401835,1.11829,.996674,-.0143917,.0198163,1.12966,1.00003,321364e-9,-149983e-9,1.1402,.757901,-869074e-11,.436176,151011e-10,.751195,-217848e-9,.432317,378533e-9,.751178,-871373e-9,.432307,.0015141,.751195,-.00196061,.432317,.0034068,.751198,-.00348552,.432318,.00605659,.751195,-.00544599,.432315,.00946353,.751207,-.00784203,.43232,.013628,.751213,-.0106732,.43232,.0185499,.751221,-.0139393,.432319,.0242302,.751244,-.0176398,.432325,.0306694,.7513,-.0217743,.432348,.0378698,.751358,-.0263412,.432367,.0458321,.751458,-.0313396,.432404,.0545587,.751608,-.0367682,.432464,.0640543,.7518,-.0426246,.43254,.0743222,.752065,-.0489031,.432645,.0853668,.752376,-.0555828,.432762,.0971911,.752715,-.0623861,.432859,.109768,.753137,-.069415,.432958,.123126,.753676,-.0770039,.433099,.137308,.754345,-.084971,.433272,.15229,.755235,-.0932681,.433504,.168075,.756186,-.10171,.433693,.184625,.757363,-.110019,.433857,.201897,.75884,-.11887,.434102,.220014,.760467,-.127881,.434306,.238778,.762969,-.136766,.434751,.258172,.765823,-.14612,.43529,.278062,.769676,-.15566,.436236,.298437,.774909,-.165177,.437754,.319532,.77994,-.17402,.438343,.342505,.785757,-.182201,.438609,.366693,.792487,-.190104,.438762,.391668,.80038,-.197438,.438795,.417494,.808494,-.204365,.438226,.443933,.817695,-.210714,.437283,.470929,.828111,-.216651,.436087,.498569,.837901,-.221804,.433717,.526165,.847813,-.226318,.430133,.554155,.858314,-.229297,.425213,.582822,.868891,-.230999,.418576,.612847,.878941,-.231155,.410405,.642445,.888809,-.230935,.400544,.672024,.898089,-.229343,.389613,.701366,.908081,-.226886,.377197,.730763,.916819,-.222676,.363397,.759642,.924968,-.216835,.347437,.788775,.932906,-.210245,.32995,.817135,.940025,-.202992,.312262,.844912,.946101,-.19436,.293313,.872164,.952835,-.184125,.273638,.899443,.957347,-.173657,.252385,.926389,.961434,-.162204,.231038,.951947,.965522,-.14979,.209834,.976751,.969412,-.136307,.188821,1.00022,.973902,-.122527,.168013,1.02229,.974045,-.108213,.147634,1.04199,.975775,-.0927397,.12705,1.06019,.978383,-.0778212,.106309,1.07711,.98211,-.0621216,.0849279,1.09245,.986517,-.0463847,.0633519,1.10651,.991696,-.0309353,.0419698,1.11903,.996349,-.0150914,.0206272,1.13073,1.00003,442449e-9,-231396e-9,1.14146,.727498,-885074e-11,.441528,145832e-10,.730897,-223525e-9,.443589,368298e-9,.730796,-893996e-9,.443528,.00147303,.730805,-.00201149,.443533,.00331433,.730814,-.00357596,.443538,.00589222,.730815,-.00558734,.443538,.00920678,.730822,-.00804544,.44354,.0132582,.730836,-.0109501,.443545,.0180468,.730848,-.0143008,.443546,.0235732,.730871,-.0180969,.443552,.0298382,.730915,-.022338,.443567,.0368438,.730982,-.0270225,.443591,.044591,.731076,-.0321491,.443627,.0530831,.731245,-.0377166,.443699,.0623243,.73144,-.0437216,.443777,.0723181,.7317,-.0501576,.443881,.0830691,.732034,-.0569942,.444014,.0945809,.732388,-.0638756,.444113,.106825,.732853,-.071203,.444247,.119859,.733473,-.0790076,.444442,.13369,.734195,-.0871937,.444645,.148304,.735069,-.095696,.444877,.163702,.736169,-.10426,.445133,.179861,.73747,-.112853,.44537,.196778,.738991,-.12199,.445651,.214496,.740865,-.131153,.445958,.232913,.743637,-.140245,.446548,.251977,.746797,-.149722,.447246,.271551,.751517,-.159341,.448656,.291774,.756156,-.169106,.449866,.312455,.761519,-.178436,.450919,.334552,.768295,-.186904,.451776,.358491,.776613,-.195117,.452832,.383446,.783966,-.202695,.45249,.408945,.793542,-.20985,.452587,.435364,.803192,-.216403,.451852,.462336,.813892,-.22251,.450708,.48987,.824968,-.227676,.4486,.517697,.835859,-.232443,.445156,.545975,.846825,-.235775,.440351,.574483,.858085,-.237897,.433641,.604246,.868825,-.238074,.425354,.634101,.879638,-.237661,.415383,.664201,.889966,-.236186,.404136,.693918,.899479,-.233599,.390917,.723481,.908769,-.229737,.376352,.75258,.917966,-.223836,.360372,.781764,.926304,-.217067,.342551,.811139,.934626,-.209309,.324238,.839585,.941841,-.20071,.304484,.867044,.94789,-.190602,.283607,.894579,.954196,-.179253,.262205,.921743,.958383,-.167646,.239847,.948026,.963119,-.155073,.218078,.973296,.966941,-.141426,.195899,.998135,.970836,-.126849,.174121,1.02021,.973301,-.112296,.153052,1.04085,.97448,-.0964965,.131733,1.05946,.977045,-.080489,.10997,1.07693,.980751,-.064844,.0881657,1.09254,.985475,-.0481938,.0657987,1.10697,.991089,-.0319185,.0435215,1.12004,.996122,-.0158088,.0214779,1.13173,1.00001,372455e-9,-200295e-9,1.14291,.708622,-907597e-11,.45304,141962e-10,.711162,-228911e-9,.454662,358052e-9,.709812,-914446e-9,.453797,.00143034,.709865,-.00205819,.453834,.00321935,.709864,-.00365894,.453833,.00572331,.709855,-.00571692,.453826,.00894278,.709862,-.00823201,.453828,.012878,.709875,-.011204,.453832,.0175295,.709896,-.0146323,.453839,.0228978,.709925,-.0185163,.453847,.0289839,.709974,-.0228551,.453866,.0357894,.710045,-.0276473,.453892,.0433161,.710133,-.032891,.453924,.0515665,.710292,-.0385851,.453992,.0605458,.710485,-.0447254,.45407,.0702574,.710769,-.0513051,.454192,.0807077,.711106,-.0582733,.454329,.091896,.711516,-.0652866,.45446,.103814,.712071,-.0728426,.454653,.116508,.712676,-.0808307,.45484,.129968,.713476,-.0892216,.455096,.144206,.714377,-.0979047,.455346,.159212,.715579,-.106531,.455647,.174973,.716977,-.115492,.455961,.191504,.71862,-.124821,.456315,.208835,.72084,-.134079,.4568,.226869,.723786,-.143427,.457521,.245582,.727464,-.153061,.458475,.264957,.732771,-.162768,.460239,.284948,.736515,-.172627,.460899,.30522,.743519,-.182487,.463225,.326717,.750041,-.191295,.464027,.350113,.758589,-.199746,.465227,.374782,.767703,-.207584,.465877,.400226,.777484,-.214973,.465996,.426442,.788792,-.221796,.466019,.453688,.800194,-.228038,.465083,.481246,.811234,-.233346,.462506,.509086,.822859,-.238073,.459257,.537338,.835082,-.241764,.454863,.566108,.846332,-.244241,.448163,.595126,.858355,-.244736,.439709,.625574,.87034,-.244278,.429837,.65617,.881027,-.24255,.418002,.686029,.891007,-.239912,.404325,.716039,.900874,-.236133,.389222,.745518,.911072,-.230672,.373269,.775026,.920359,-.22356,.355083,.804521,.928604,-.215591,.335533,.834045,.937175,-.206503,.315278,.861612,.942825,-.196684,.293653,.889131,.949805,-.185116,.271503,.916853,.955535,-.172703,.248821,.943541,.959843,-.159978,.225591,.970132,.964393,-.146375,.202719,.994709,.968008,-.131269,.179928,1.0186,.971013,-.11569,.158007,1.03928,.973334,-.1003,.13624,1.05887,.975775,-.0833352,.1138,1.07652,.979579,-.0668981,.0913141,1.09297,.984323,-.0500902,.0683051,1.10734,.990351,-.0332377,.0451771,1.12084,.995823,-.0161491,.0221705,1.13296,1.0001,234083e-9,-108712e-9,1.14441,.683895,-924677e-11,.46015,137429e-10,.68833,-233383e-9,.463134,346865e-9,.688368,-933547e-9,.463159,.00138748,.688367,-.00210049,.463159,.00312187,.688369,-.00373415,.463159,.00555004,.688377,-.00583449,.463163,.00867216,.688386,-.00840128,.463166,.0124884,.688398,-.0114343,.463169,.0169993,.688418,-.0149329,.463175,.0222054,.688453,-.0188964,.463188,.028108,.688515,-.0233239,.463214,.0347085,.68857,-.0282136,.463231,.0420091,.688679,-.033564,.463276,.0500132,.688854,-.0393733,.463356,.0587255,.689038,-.0456354,.46343,.0681476,.689321,-.0523433,.463553,.0782897,.689662,-.059412,.463693,.0891501,.690188,-.0665736,.4639,.100735,.690755,-.0743106,.464107,.113074,.691405,-.0824722,.464329,.126161,.692198,-.0910484,.464585,.140007,.693196,-.0998778,.464893,.154612,.69454,-.108651,.465285,.169984,.695921,-.117855,.465596,.186106,.697749,-.12734,.466056,.203034,.700375,-.136714,.466771,.220703,.703395,-.146386,.467579,.239062,.707904,-.156096,.469067,.258188,.711673,-.165904,.469851,.277759,.717489,-.175812,.471815,.297935,.724051,-.185931,.47389,.318916,.731965,-.195238,.47587,.341591,.741151,-.204021,.477523,.366062,.751416,-.212113,.478881,.391396,.761848,-.21979,.479226,.417599,.771886,-.2267,.478495,.444401,.783998,-.232991,.477622,.472084,.796523,-.238645,.475833,.500193,.808851,-.243396,.472568,.52865,.821191,-.247226,.467857,.557362,.834261,-.250102,.461871,.586768,.846762,-.251056,.453543,.617085,.859867,-.250604,.443494,.647659,.871948,-.248783,.431711,.678119,.882967,-.245855,.417911,.708399,.892826,-.242168,.401993,.738256,.90332,-.237062,.385371,.767999,.913633,-.22997,.366837,.798191,.922774,-.221687,.346372,.827756,.931371,-.212345,.325682,.856425,.938929,-.20206,.303665,.884299,.944821,-.190981,.280786,.912023,.951792,-.178065,.2573,.939669,.957712,-.164634,.233448,.96655,.961912,-.150863,.209504,.992366,.966382,-.13577,.18597,1.01633,.969588,-.119593,.162905,1.03843,.971777,-.103203,.14053,1.05841,.97433,-.0865888,.117909,1.07632,.978686,-.0690829,.0944101,1.09326,.983281,-.0516568,.0705671,1.10796,.989562,-.034558,.0468592,1.12182,.995465,-.0167808,.0229846,1.1342,.999991,373016e-9,-235606e-9,1.1459,.662251,-939016e-11,.468575,132714e-10,.666634,-237624e-9,.471675,335842e-9,.666411,-950385e-9,.471516,.00134321,.666399,-.00213833,.471509,.00302221,.666386,-.0038014,.471499,.00537283,.666405,-.00593958,.471511,.00839533,.666406,-.00855253,.471508,.0120898,.666428,-.0116401,.471519,.0164569,.666444,-.0152015,.471522,.0214971,.66649,-.0192362,.471543,.027212,.666537,-.0237428,.471558,.033603,.666617,-.0287198,.471591,.0406728,.666718,-.0341647,.471631,.0484238,.666889,-.0400759,.47171,.0568621,.667104,-.0464479,.471805,.0659915,.667374,-.0532677,.471923,.0758178,.667772,-.0603805,.472098,.0863425,.668371,-.0677392,.472363,.0975917,.668971,-.0756028,.472596,.109567,.669696,-.0839293,.472869,.122272,.670481,-.0926683,.473126,.135718,.6715,-.1016,.473442,.149914,.672911,-.110566,.47389,.164882,.674512,-.119984,.474354,.180602,.67651,-.129574,.474922,.19711,.679292,-.139106,.475764,.214371,.682798,-.148993,.476886,.232405,.686955,-.158737,.478179,.251153,.691406,-.168754,.479432,.270436,.697438,-.178703,.481481,.290374,.704761,-.188955,.484143,.311044,.713599,-.198814,.487007,.333003,.723194,-.207869,.488962,.357144,.732601,-.216189,.489815,.382169,.744193,-.22398,.490888,.408227,.754907,-.231156,.490355,.434928,.767403,-.23747,.489548,.462599,.78107,-.243503,.488274,.490908,.793893,-.248114,.484843,.519421,.807296,-.25222,.4803,.548561,.820529,-.255265,.474097,.577772,.833716,-.256741,.466041,.607782,.848403,-.25637,.456547,.638807,.860755,-.254804,.443946,.670058,.874012,-.251834,.430852,.700749,.885619,-.247867,.414903,.731446,.896069,-.242634,.397276,.761191,.906266,-.236093,.378535,.791053,.916759,-.227543,.358038,.821298,.92523,-.21783,.335705,.850747,.93436,-.207534,.313797,.879258,.941631,-.195983,.289671,.907734,.947564,-.183567,.265319,.935206,.953681,-.169345,.240815,.962739,.960008,-.154909,.216119,.989227,.964145,-.140161,.192096,1.01465,.968171,-.123411,.167855,1.03737,.969859,-.106525,.144817,1.05767,.972666,-.0891023,.12149,1.0761,.977055,-.0718094,.0975306,1.09336,.982527,-.0534213,.0730217,1.10878,.989001,-.0355579,.0483366,1.12285,.99512,-.0176383,.023938,1.13548,1.00007,368831e-9,-211581e-9,1.14744,.651047,-960845e-11,.484101,12922e-9,.644145,-241347e-9,.478968,324578e-9,.64396,-965142e-9,.478831,.00129798,.64396,-.00217154,.47883,.00292046,.643968,-.00386049,.478835,.00519202,.643974,-.00603186,.478838,.0081128,.643977,-.0086854,.478836,.011683,.643982,-.0118207,.478834,.0159031,.644024,-.0154374,.478856,.0207743,.644059,-.0195343,.478868,.0262975,.644122,-.0241103,.478896,.0324747,.644207,-.0291638,.478933,.039309,.64432,-.0346919,.478981,.0468029,.644481,-.0406919,.479053,.0549614,.644722,-.047159,.479169,.0637909,.645013,-.0540748,.479302,.0732974,.645503,-.0612001,.479541,.0834898,.646117,-.0687303,.479829,.0943873,.646707,-.0767846,.480061,.105991,.647431,-.0852465,.480343,.11831,.64831,-.0940719,.48066,.131348,.649486,-.103056,.481083,.14514,.650864,-.112261,.481528,.159676,.652604,-.121852,.482102,.174979,.654825,-.131505,.482813,.191079,.657876,-.141189,.483876,.207927,.661339,-.151239,.48499,.225586,.665463,-.161091,.486279,.243947,.670542,-.171235,.487968,.262957,.677361,-.181347,.49053,.282781,.685672,-.191679,.493862,.303311,.694551,-.201781,.49699,.324607,.703753,-.211164,.498884,.347916,.713703,-.219675,.500086,.372628,.725911,-.227836,.501554,.398694,.73862,-.23533,.502193,.425529,.752118,-.241786,.501811,.453209,.76579,-.247865,.500185,.481381,.779568,-.252696,.497159,.51011,.793991,-.256802,.492765,.539322,.808182,-.259942,.486827,.569078,.821698,-.261703,.478386,.598818,.836009,-.262006,.468772,.629762,.849824,-.260333,.456352,.661366,.863888,-.257398,.442533,.69295,.876585,-.253264,.426573,.723608,.888665,-.248026,.408964,.754378,.899537,-.241487,.389677,.784761,.9094,-.233463,.368516,.814688,.920166,-.223397,.346624,.845009,.928899,-.21255,.322717,.874431,.937156,-.200869,.298698,.902922,.943861,-.188387,.273491,.931356,.949557,-.174341,.247866,.958854,.955862,-.158994,.222496,.986098,.961721,-.143664,.197522,1.01229,.965976,-.127412,.17302,1.03571,.968652,-.109798,.148954,1.05699,.971084,-.0916787,.125044,1.07587,.975584,-.0739634,.100577,1.09372,.98122,-.055322,.0753666,1.10948,.988253,-.0366825,.0498899,1.12394,.99482,-.0180389,.024611,1.13694,1.00001,229839e-9,-188283e-9,1.14919,.613867,-964198e-11,.479449,123452e-10,.621485,-244534e-9,.485399,313091e-9,.621429,-978202e-9,.485353,.00125245,.62112,-.00220004,.485114,.00281687,.621119,-.0039111,.485112,.00500783,.621122,-.00611091,.485112,.00782498,.621133,-.00879922,.485117,.0112687,.621152,-.0119756,.485125,.0153394,.621183,-.0156396,.485139,.0200382,.621227,-.0197898,.485158,.0253663,.621298,-.0244253,.485192,.0313261,.621388,-.0295441,.485233,.0379204,.621507,-.0351432,.485286,.0451523,.621693,-.0412198,.485378,.0530277,.621933,-.0477673,.485495,.0615522,.622232,-.0547574,.485635,.0707316,.622809,-.0619417,.485943,.0805883,.623407,-.069625,.486232,.0911267,.62406,-.077796,.486516,.102354,.624835,-.0863731,.486838,.114279,.625758,-.095251,.487188,.126902,.627043,-.104299,.487695,.140285,.628438,-.113724,.488163,.154397,.630325,-.123417,.488858,.169267,.632801,-.133137,.489754,.184941,.635784,-.143052,.490815,.20136,.639406,-.153132,.492048,.218643,.643872,-.163143,.49363,.236615,.6499,-.17333,.496009,.255449,.657201,-.183622,.498994,.275006,.666221,-.194019,.502888,.295354,.674419,-.204192,.505459,.316244,.683729,-.21406,.507771,.33849,.695584,-.222854,.510245,.363166,.708583,-.231315,.512293,.389071,.721233,-.238911,.512747,.415737,.735134,-.245657,.512482,.443331,.750179,-.251879,.511526,.471891,.765073,-.256911,.508935,.500892,.779794,-.261144,.504341,.530294,.794801,-.264316,.498515,.560144,.810339,-.266276,.491015,.590213,.824818,-.266981,.481126,.620865,.839375,-.265778,.468685,.652687,.853043,-.262748,.453925,.684759,.867335,-.258474,.437912,.716209,.88037,-.253187,.419648,.747508,.891711,-.246476,.39982,.77797,.902896,-.238735,.37879,.808586,.913601,-.22885,.355891,.838843,.923019,-.217656,.331773,.869014,.933432,-.205539,.307356,.898512,.939691,-.192595,.281321,.9269,.946938,-.178945,.255441,.955297,.952372,-.163587,.229013,.983231,.95909,-.147214,.203179,1.00971,.963675,-.13064,.17792,1.03438,.968247,-.113121,.152898,1.05625,.97001,-.0945824,.128712,1.07598,.974458,-.0755648,.103349,1.094,.980168,-.0571998,.0776731,1.1104,.987295,-.0377994,.0514445,1.12491,.994432,-.0186417,.025429,1.13851,.999975,542714e-9,-282356e-9,1.15108,.592656,-980249e-11,.486018,119532e-10,.598467,-247275e-9,.490781,301531e-9,.597934,-988317e-9,.490343,.00120517,.597903,-.00222366,.490319,.0027116,.597913,-.00395315,.490327,.00482077,.597919,-.00617653,.490329,.00753264,.597936,-.00889375,.490339,.0108478,.597956,-.0121043,.490347,.0147668,.597992,-.0158073,.490365,.0192905,.598032,-.0200017,.490382,.0244204,.598109,-.0246865,.49042,.0301593,.598215,-.0298594,.490474,.03651,.59833,-.0355167,.490524,.0434757,.598525,-.0416559,.490624,.0510629,.598778,-.0482692,.490753,.0592781,.599135,-.0553114,.49094,.0681304,.599802,-.062542,.491328,.0776467,.600361,-.0703638,.491598,.0878184,.60101,-.0786256,.491882,.0986573,.601811,-.0872962,.492232,.11018,.602861,-.0962284,.492684,.1224,.604167,-.10538,.493213,.135354,.605693,-.114896,.493799,.149034,.607682,-.124654,.494576,.163469,.610672,-.13456,.4959,.178747,.613313,-.144581,.496713,.194723,.617603,-.154703,.498499,.211617,.622174,-.16489,.500188,.229183,.628855,-.175164,.503072,.247786,.636963,-.185565,.506798,.267116,.644866,-.195911,.509719,.28702,.653741,-.206104,.512776,.307763,.664942,-.216447,.516812,.329631,.67633,-.22552,.519181,.353515,.690012,-.234316,.521681,.379226,.704243,-.242032,.523129,.405901,.719396,-.249172,.523768,.433585,.734471,-.255543,.522541,.462085,.750539,-.260697,.520217,.491233,.766365,-.26501,.516293,.521094,.781677,-.268409,.509708,.551014,.797132,-.270399,.501944,.581463,.812655,-.271247,.492025,.612402,.828592,-.270708,.480424,.643798,.844044,-.268085,.465955,.67682,.857305,-.263459,.448425,.708496,.87114,-.258151,.430243,.74046,.884936,-.251171,.410578,.771583,.895772,-.243305,.38862,.802234,.906961,-.234037,.365214,.833179,.917775,-.222714,.34116,.86353,.927883,-.210175,.31572,.893557,.936617,-.196925,.289159,.922976,.943384,-.182788,.261996,.951606,.949713,-.167965,.235324,.979958,.955818,-.151109,.208408,1.00765,.961344,-.133834,.182591,1.03329,.965469,-.115987,.156958,1.0557,.968693,-.09746,.132239,1.07583,.973165,-.0778514,.106195,1.09451,.979387,-.0585067,.0797669,1.11137,.98671,-.0390409,.0530263,1.12643,.994093,-.019408,.0263163,1.14016,1.00002,540029e-9,-194487e-9,1.15299,.574483,-989066e-11,.494533,114896e-10,.574478,-249127e-9,.494528,289403e-9,.574607,-996811e-9,.494637,.00115797,.574396,-.00224241,.494458,.00260498,.574377,-.00398632,.49444,.00463102,.574386,-.00622836,.494445,.00723623,.574401,-.0089683,.494453,.010421,.574419,-.0122056,.49446,.0141859,.574459,-.0159396,.494481,.0185322,.574525,-.0201692,.49452,.0234617,.574587,-.0248924,.494547,.0289762,.574697,-.0301074,.494604,.0350797,.574853,-.0358114,.494688,.0417767,.575027,-.041999,.494772,.0490718,.575294,-.0486618,.494915,.0569728,.575733,-.0557148,.495173,.0654955,.576356,-.0630489,.495537,.0746612,.576944,-.0709285,.495836,.0844615,.57765,-.0792723,.496177,.0949142,.578491,-.0880167,.496563,.10603,.579639,-.0969462,.497096,.117841,.580989,-.10622,.497684,.130367,.582587,-.115861,.498337,.143609,.584951,-.125605,.499414,.157625,.587602,-.135608,.500518,.172413,.59076,-.145742,.501767,.187999,.594992,-.155934,.503542,.20445,.600656,-.166303,.506135,.221764,.607816,-.176681,.509542,.24002,.61522,-.187071,.51263,.258992,.623702,-.197465,.516021,.278773,.634192,-.207816,.520422,.299377,.644936,-.218183,.524073,.320802,.657888,-.2278,.528049,.34384,.670666,-.236747,.52986,.36916,.685626,-.24484,.531892,.395867,.701304,-.252071,.532727,.423488,.717727,-.258714,.532146,.452201,.733914,-.264211,.529883,.481579,.750529,-.26859,.5259,.511558,.76747,-.272046,.51999,.542042,.785189,-.274225,.513083,.572799,.800954,-.275189,.502936,.603816,.816962,-.274946,.490921,.635461,.83336,-.272695,.47684,.6676,.848143,-.268223,.459405,.70051,.861818,-.262768,.440319,.732902,.876828,-.255872,.420123,.765084,.889312,-.247703,.398379,.796391,.900412,-.238381,.374496,.827333,.912251,-.227783,.349874,.858385,.921792,-.214832,.323181,.888652,.931273,-.200949,.296624,.917763,.940295,-.186537,.269211,.947878,.946812,-.171538,.241447,.977016,.953588,-.155254,.213829,1.00501,.958841,-.137156,.186807,1.03179,.963746,-.118699,.160706,1.05502,.966468,-.0998358,.135504,1.07568,.971178,-.0805186,.109131,1.09479,.97831,-.0599348,.0818293,1.1123,.985886,-.0399661,.0545872,1.12771,.994021,-.0198682,.0269405,1.14186,1.00009,271022e-9,-12989e-8,1.15514,.538716,-990918e-11,.486732,109675e-10,.550656,-250642e-9,.497518,277412e-9,.55057,-.00100265,.497441,.00110974,.550903,-.00225672,.497733,.00249779,.550568,-.00401046,.497438,.00443906,.550574,-.00626613,.49744,.00693637,.550591,-.0090226,.497449,.00998921,.550623,-.0122795,.497469,.0135984,.550667,-.0160361,.497495,.0177654,.550724,-.0202908,.497526,.0224915,.550792,-.0250421,.497557,.0277795,.550918,-.0302878,.49763,.0336334,.551058,-.0360241,.497701,.0400573,.551276,-.0422473,.497824,.0470585,.551551,-.0489441,.497977,.0546433,.552074,-.0559596,.498312,.0628367,.552681,-.0633978,.498679,.071646,.553324,-.0713176,.499031,.0810746,.554011,-.0797268,.499365,.091129,.55488,-.0885238,.499779,.101837,.556171,-.0974417,.500444,.113239,.557498,-.106841,.501025,.125316,.559299,-.116533,.501864,.138128,.561647,-.126298,.502967,.151695,.564347,-.136388,.504129,.16604,.567863,-.146576,.505713,.181207,.572569,-.156832,.507953,.197259,.578919,-.167323,.511186,.214258,.585387,-.177712,.514042,.232038,.593134,-.188184,.517484,.250733,.603295,-.198717,.522345,.270454,.613854,-.209177,.526751,.290807,.626092,-.219644,.531595,.312202,.637868,-.229494,.534721,.334435,.652458,-.238718,.538304,.359184,.666985,-.247061,.539875,.385637,.683301,-.254652,.541042,.41328,.69998,-.261376,.540735,.441903,.717824,-.267085,.539139,.471609,.734617,-.271465,.534958,.501446,.753663,-.27528,.53032,.532571,.770512,-.277617,.522134,.563641,.787356,-.278525,.51206,.595067,.806252,-.278512,.50119,.627226,.822061,-.277023,.486791,.659402,.838959,-.273175,.470467,.692874,.85379,-.267238,.450688,.725702,.868268,-.260327,.429741,.75832,.881994,-.251946,.407223,.790189,.893885,-.242432,.383214,.821625,.905118,-.231904,.357297,.853011,.916045,-.219545,.330733,.883773,.927614,-.205378,.303916,.914435,.936005,-.190388,.275941,.944502,.944533,-.1749,.247493,.974439,.950758,-.158588,.218996,1.00286,.957078,-.141027,.191559,1.0304,.962448,-.121507,.164457,1.05466,.964993,-.102068,.138636,1.0761,.970017,-.0822598,.111861,1.09541,.97661,-.062033,.0843438,1.11317,.985073,-.0409832,.0558496,1.12911,.993515,-.020146,.0275331,1.1438,1.00006,27329e-8,-107883e-9,1.15736,.525324,-999341e-11,.498153,105385e-10,.526513,-251605e-9,.499277,265329e-9,.526517,-.00100641,.499282,.0010613,.526588,-.00226466,.499337,.00238823,.526539,-.0040255,.499302,.00424535,.526547,-.00628954,.499306,.00663364,.526561,-.00905628,.499313,.00955337,.526593,-.0123253,.499334,.0130054,.526642,-.0160957,.499365,.0169911,.5267,-.0203661,.499396,.0215122,.526792,-.0251347,.499451,.0265718,.526904,-.0303985,.499511,.0321732,.527079,-.0361554,.499617,.0383231,.527285,-.0423982,.499731,.045026,.527602,-.0491121,.499924,.0522936,.528166,-.0561127,.500306,.0601528,.52879,-.0635988,.5007,.0686059,.529421,-.071581,.501048,.0776518,.530144,-.0799854,.501421,.0873148,.531062,-.0888032,.501884,.0976084,.532374,-.0977643,.50259,.108588,.533828,-.107197,.50329,.120234,.53581,-.116887,.504312,.132602,.538063,-.126755,.505365,.145721,.5409,-.136819,.506668,.159617,.544882,-.147117,.508731,.174369,.550238,-.157446,.511601,.190028,.556038,-.167988,.514431,.206587,.563031,-.178364,.517808,.224046,.571543,-.189007,.521937,.242503,.582255,-.199546,.527415,.261977,.59272,-.210084,.531682,.282162,.605648,-.220448,.537123,.303426,.61785,-.230593,.540664,.325323,.632223,-.240238,.544467,.348993,.648819,-.24887,.547594,.375462,.665825,-.256657,.54912,.403024,.683389,-.263711,.549294,.431773,.701495,-.269666,.547649,.461494,.719197,-.274169,.543786,.491623,.737906,-.278124,.538644,.522994,.756652,-.280632,.531057,.554775,.775279,-.281741,.521972,.586441,.792688,-.281652,.509613,.618596,.811894,-.280345,.496497,.651462,.827938,-.277128,.47968,.684023,.844837,-.271646,.460688,.718024,.859239,-.264397,.438872,.751207,.874088,-.256144,.41577,.784232,.887693,-.246311,.391369,.816191,.899402,-.235497,.365872,.847828,.910973,-.223631,.338618,.87934,.92204,-.209874,.310803,.910325,.930987,-.194265,.281802,.940695,.94,-.178125,.252836,.970958,.948018,-.161479,.224239,1.00078,.955141,-.144038,.195857,1.0288,.960513,-.124915,.168487,1.05371,.963964,-.104284,.141495,1.07596,.968713,-.0838732,.114437,1.09628,.975524,-.0635579,.0863105,1.11448,.98431,-.042291,.0574774,1.13069,.992916,-.0209131,.0284343,1.14568,.999926,743097e-9,-379265e-9,1.15955,.501042,-998428e-11,.498726,100306e-10,.502992,-252112e-9,.500665,253283e-9,.502417,-.00100791,.500092,.00101259,.502965,-.00226919,.500621,.00227978,.502318,-.00403109,.499994,.00405011,.502333,-.00629832,.500005,.00632868,.502362,-.00906907,.500027,.00911446,.502369,-.0123423,.500023,.0124078,.50243,-.0161178,.500066,.016211,.502493,-.0203937,.500103,.0205256,.502592,-.0251684,.500166,.0253548,.502707,-.0304389,.50023,.0307029,.502881,-.0362015,.500335,.0365753,.503124,-.0424507,.500488,.0429798,.503443,-.0491582,.500686,.0499268,.504083,-.0561476,.501155,.0574541,.504668,-.0636846,.501524,.0655408,.505319,-.0716834,.501904,.0742072,.50609,-.0800925,.502321,.0834699,.507122,-.0888425,.502896,.0933603,.508414,-.097855,.503603,.10391,.509955,-.107304,.504416,.115113,.512061,-.116921,.505565,.127054,.514419,-.12689,.506732,.139709,.517529,-.136934,.508338,.153173,.522085,-.147327,.510987,.167528,.526986,-.157612,.513527,.182708,.533122,-.168213,.516717,.198881,.540807,-.178688,.520832,.215986,.550687,-.189511,.52632,.234335,.560567,-.199998,.531009,.253375,.571698,-.210652,.535839,.273499,.584364,-.220917,.541091,.294355,.599066,-.23137,.546875,.316525,.614148,-.241206,.551306,.339671,.631157,-.250379,.555187,.36531,.647919,-.258397,.556595,.392767,.666112,-.265528,.556949,.421397,.686158,-.271827,.556617,.451433,.704838,-.27674,.552975,.482131,.723957,-.280733,.547814,.513458,.74262,-.283359,.53997,.545446,.762009,-.284541,.530422,.57775,.781314,-.284507,.518546,.610434,.799116,-.283309,.504178,.643178,.817604,-.280378,.48843,.676248,.83459,-.275619,.469457,.709698,.850974,-.26856,.447698,.744245,.866747,-.260094,.424791,.777695,.881412,-.249929,.399913,.810392,.8936,-.239137,.37308,.842872,.905943,-.226818,.345705,.874677,.916408,-.213699,.31706,.906257,.927215,-.198428,.288444,.936881,.935625,-.181643,.258329,.96795,.944076,-.164386,.228488,.998216,.951229,-.146339,.199763,1.02689,.958793,-.127709,.172153,1.0535,.963219,-.107244,.144989,1.07646,.967562,-.0857764,.11685,1.09675,.974866,-.0645377,.0880571,1.11576,.983353,-.0431732,.0587352,1.13227,.992503,-.0218356,.0294181,1.1478,1.00003,605203e-9,-231013e-9,1.16207,.482935,-101177e-10,.504695,968142e-11,.477554,-251521e-9,.499071,240676e-9,.477904,-.00100683,.499436,96342e-8,.478368,-.00226636,.499899,.0021687,.477977,-.00402719,.499513,.00385384,.477993,-.00629226,.499525,.0060221,.478011,-.00906011,.499536,.00867289,.478051,-.0123305,.499566,.0118074,.478089,-.016102,.499587,.0154269,.478171,-.0203736,.499645,.0195341,.478254,-.025143,.499692,.0241318,.47839,-.0304071,.499779,.0292247,.478588,-.0361631,.499911,.0348196,.478812,-.0424023,.500046,.0409231,.479208,-.0490724,.500326,.047552,.479841,-.0560722,.500805,.0547377,.480392,-.0636125,.501152,.0624607,.481068,-.0716134,.501561,.0707473,.481898,-.0800062,.502054,.0796118,.483022,-.0886568,.502728,.0890974,.484332,-.0977553,.503479,.0992099,.486126,-.107173,.504546,.10999,.488066,-.11677,.50557,.121476,.490521,-.126725,.506849,.133672,.494232,-.136793,.50911,.146731,.498302,-.147116,.511345,.160577,.503565,-.157446,.514344,.175335,.510902,-.168121,.518824,.191207,.519263,-.178799,.523666,.208058,.528204,-.189407,.528296,.225875,.538854,-.200145,.533724,.244782,.551278,-.210701,.539833,.264753,.565222,-.221303,.546131,.285745,.579403,-.231688,.551496,.307592,.595469,-.241718,.556809,.330582,.610929,-.250992,.559641,.354995,.629433,-.259602,.562379,.382471,.648504,-.267038,.563676,.411126,.66756,-.273388,.562092,.440924,.689143,-.278788,.560807,.472118,.709056,-.282783,.555701,.503774,.729855,-.285836,.548698,.536364,.748954,-.287078,.538544,.56895,.768373,-.287133,.526711,.601991,.78827,-.285839,.512511,.635403,.807465,-.283238,.496323,.668797,.825194,-.27906,.477638,.702584,.842203,-.272286,.456253,.736393,.857749,-.263854,.432412,.77096,.874799,-.253943,.407806,.80489,.887497,-.24237,.38033,.83771,.89966,-.230278,.352446,.870376,.911753,-.21646,.323268,.902256,.923011,-.202071,.294314,.933306,.932375,-.185519,.264104,.965177,.940537,-.167604,.234035,.996303,.948904,-.149068,.20412,1.0261,.955263,-.129539,.175431,1.05304,.960303,-.109932,.148116,1.07617,.965512,-.0880572,.119693,1.09742,.973466,-.0660548,.0901619,1.11721,.98284,-.0439228,.0599875,1.13436,.992216,-.0219588,.0298975,1.15006,.999946,119402e-9,-208547e-10,1.16471,.447827,-100414e-10,.491543,914833e-11,.454778,-251257e-9,.499172,22891e-8,.453519,-.00100342,.497787,914184e-9,.45357,-.00225776,.497847,.00205701,.453578,-.00401371,.497855,.00365705,.45357,-.00627107,.497841,.00571453,.453598,-.00902968,.497864,.00823019,.453627,-.0122888,.497882,.0112049,.453684,-.0160475,.497923,.0146405,.453764,-.0203044,.49798,.0185394,.453866,-.0250576,.498049,.0229054,.453996,-.0303028,.49813,.0277424,.454196,-.0360379,.498267,.0330587,.454457,-.0422521,.498445,.0388613,.454926,-.0488393,.498812,.0451767,.455525,-.0558653,.499272,.0520153,.456074,-.0633772,.499625,.0593754,.456752,-.0713606,.500049,.0672751,.457648,-.07971,.500615,.0757447,.458849,-.0883032,.501399,.0848231,.46029,-.0974095,.502293,.0945135,.462,-.106729,.503301,.104848,.464121,-.116354,.504533,.115884,.466889,-.126214,.506172,.127652,.470744,-.136324,.508667,.14024,.47488,-.146595,.510995,.153673,.480845,-.157027,.514832,.168053,.488262,-.167658,.519506,.183508,.496547,-.178343,.524347,.199948,.506254,-.188916,.52983,.217503,.517961,-.199975,.536357,.236272,.531484,-.210624,.543641,.256096,.545496,-.221227,.550048,.277085,.559497,-.231568,.555076,.298615,.575752,-.241698,.560541,.321547,.591999,-.251172,.564156,.345602,.610654,-.260178,.567607,.371851,.630484,-.268094,.56923,.40076,.651807,-.274661,.569779,.430801,.67239,-.280331,.566791,.461939,.693024,-.284501,.562007,.493854,.715473,-.287852,.555791,.526992,.736323,-.28929,.546345,.560102,.755771,-.289405,.534,.593543,.775424,-.2881,.519114,.627256,.795447,-.285562,.502543,.661464,.815319,-.281416,.484773,.695206,.831769,-.275523,.463445,.729044,.849464,-.267516,.440269,.764069,.866775,-.257584,.415049,.799089,.881252,-.245817,.388049,.831948,.894209,-.233127,.35889,.865526,.906922,-.219579,.329915,.89818,.919686,-.204491,.300441,.930013,.929044,-.188962,.269445,.962061,.938393,-.171079,.238402,.994214,.94661,-.15199,.208204,1.02533,.953095,-.131953,.178653,1.0529,.958644,-.111233,.150684,1.0771,.963925,-.0903098,.122359,1.09855,.971995,-.0680505,.0923342,1.11874,.981658,-.0448512,.0614195,1.13635,.991649,-.0221931,.0303582,1.15238,.999985,393403e-9,-111086e-9,1.16772,.396806,-971563e-11,.457671,842355e-11,.429186,-249421e-9,.495017,21625e-8,.429324,-998052e-9,.495173,865322e-9,.429175,-.00224487,.494999,.00194637,.429129,-.00399041,.494952,.00346004,.429153,-.00623476,.494974,.00540684,.429168,-.0089773,.494983,.00778714,.429207,-.0122175,.495012,.0106022,.429257,-.0159542,.495047,.0138535,.429338,-.0201864,.495106,.0175443,.429431,-.0249104,.495165,.0216774,.429587,-.0301252,.495279,.0262594,.429796,-.0358249,.495432,.0312968,.430065,-.0419972,.495621,.0367985,.430588,-.0485144,.496061,.042798,.43113,-.0555028,.496472,.0492914,.431743,-.0629852,.496904,.0562907,.432448,-.0709256,.497369,.0638056,.433414,-.0791942,.498032,.071885,.434638,-.0877346,.498854,.0805517,.43611,-.0968056,.499812,.0898047,.437859,-.106002,.500891,.0997142,.440017,-.115648,.502198,.110289,.443236,-.125427,.504389,.121644,.44697,-.135492,.506809,.133769,.451689,-.145746,.509858,.146787,.45811,-.156219,.514247,.160793,.465305,-.166834,.518816,.175791,.474085,-.177546,.524331,.191906,.484808,-.188262,.53104,.209199,.49732,-.199346,.538511,.227825,.509693,-.209951,.544554,.247269,.524367,-.220533,.551616,.267978,.539228,-.231082,.557368,.289672,.55644,-.241342,.563782,.31268,.574204,-.250964,.568851,.33651,.593388,-.260306,.57312,.362219,.613358,-.268667,.574916,.390322,.634512,-.275591,.575053,.420478,.65563,-.281328,.572404,.451614,.678265,-.285948,.568893,.484112,.70011,-.289408,.561878,.517348,.723005,-.291328,.55359,.551355,.743744,-.291418,.541099,.585109,.763949,-.290252,.526489,.619487,.784186,-.287648,.509496,.65404,.804304,-.283782,.491484,.688649,.823629,-.278067,.470517,.723133,.84094,-.270588,.44705,.757163,.857852,-.261188,.421252,.792816,.874934,-.249313,.394191,.827248,.888709,-.236492,.365359,.861074,.902589,-.222185,.336016,.894417,.914201,-.207314,.30527,.926825,.925978,-.191146,.274532,.9595,.93512,-.174135,.243393,.991583,.943656,-.155231,.212414,1.02356,.951719,-.134403,.182005,1.05239,.957164,-.113023,.153043,1.07754,.962656,-.0914493,.124186,1.09984,.970695,-.0694179,.0941654,1.12,.980749,-.0466199,.0629671,1.13849,.991205,-.0227032,.0311146,1.15494,.999884,632388e-9,-254483e-9,1.1706,.379821,-957289e-11,.460637,789337e-11,.405188,-247483e-9,.491396,204064e-9,.404796,-989434e-9,.490914,815853e-9,.40483,-.00222607,.490949,.00183559,.40473,-.00395723,.49084,.00326332,.404731,-.00618287,.490836,.00509945,.404768,-.00890258,.490871,.00734463,.404791,-.0121156,.490883,.00999992,.404857,-.0158214,.490938,.0130676,.404943,-.0200178,.491004,.0165503,.405059,-.0247027,.491093,.0204521,.405213,-.0298729,.491205,.0247788,.405399,-.0355226,.491333,.0295373,.405731,-.0416352,.491604,.034741,.406303,-.0480807,.492116,.0404255,.406814,-.0550458,.492506,.0465732,.407404,-.0624652,.492926,.0532058,.408149,-.0702958,.493442,.0603442,.409128,-.0784623,.494136,.0680297,.410408,-.087007,.495054,.0762786,.411813,-.0959639,.495962,.0851046,.413735,-.105075,.497257,.0945878,.416137,-.114646,.498882,.104725,.41934,-.124394,.501132,.11563,.423326,-.134328,.503883,.127325,.428419,-.14458,.50747,.139911,.43484,-.154979,.511964,.153481,.442641,-.165628,.517328,.168114,.452511,-.176365,.524258,.183995,.463473,-.187298,.531248,.200953,.475564,-.198244,.538367,.219176,.488664,-.208938,.545175,.238514,.504073,-.219599,.553227,.259129,.520832,-.230378,.560653,.280997,.538455,-.240703,.567523,.303821,.55709,-.250548,.573287,.327948,.576646,-.259964,.577795,.353362,.596705,-.268721,.580077,.380336,.618053,-.276054,.58018,.4101,.640303,-.282176,.578747,.44161,.662365,-.286931,.574294,.474106,.684542,-.290521,.567035,.507549,.707984,-.292672,.558687,.541853,.730913,-.293189,.547606,.576581,.752948,-.292199,.533471,.61172,.773452,-.289508,.516395,.646339,.794715,-.285716,.497873,.682131,.814251,-.280051,.476845,.716396,.833057,-.272873,.453449,.751503,.84959,-.263982,.427857,.786085,.867022,-.252745,.400335,.821355,.882277,-.239655,.371304,.85646,.895375,-.225386,.340397,.890828,.909347,-.209587,.310005,.923532,.921885,-.193433,.2796,.956419,.932127,-.176135,.247276,.989445,.941869,-.157872,.216186,1.02221,.949735,-.137577,.185602,1.05195,.956617,-.115285,.155767,1.07822,.961974,-.0928418,.126103,1.10149,.96972,-.0700592,.0956758,1.12207,.98012,-.0474671,.0643269,1.1408,.990825,-.0238113,.0320863,1.1577,.999876,381574e-9,-812203e-10,1.17403,.367636,-961342e-11,.469176,753287e-11,.380377,-244772e-9,.485434,191797e-9,.380416,-978857e-9,.485475,767015e-9,.380376,-.00220165,.485435,.00172522,.380419,-.00391408,.485487,.00306734,.380438,-.00611549,.485505,.00479332,.380462,-.00880558,.485525,.00690391,.380496,-.0119837,.485551,.00940039,.38056,-.0156487,.485605,.0122848,.38064,-.0197988,.485666,.0155601,.380767,-.0244324,.48577,.0192313,.380909,-.0295444,.485871,.0233032,.381142,-.0351321,.48606,.0277861,.381472,-.0411535,.486336,.0326939,.382015,-.0475408,.486833,.0380565,.382523,-.0544395,.487231,.0438615,.383129,-.061784,.487683,.0501332,.383952,-.0695085,.488313,.0568996,.38498,-.0775819,.489077,.0641952,.386331,-.0860443,.490113,.0720324,.387788,-.0948406,.491099,.0804379,.389808,-.103899,.492566,.0894899,.39252,-.113313,.494601,.0992098,.395493,-.123007,.496619,.109641,.399826,-.132859,.499912,.120919,.405341,-.143077,.504061,.133107,.411932,-.153465,.508905,.146263,.420591,-.164108,.515482,.160544,.43101,-.174893,.523191,.176123,.441881,-.185839,.53026,.192757,.453919,-.196633,.537295,.210535,.468715,-.207611,.546156,.229886,.485182,-.218517,.555173,.250543,.501926,-.229249,.562728,.27221,.51785,-.239481,.567494,.294892,.536947,-.249395,.573889,.318987,.557115,-.259,.578831,.344348,.577966,-.268075,.582055,.371223,.599489,-.276115,.583307,.399834,.62479,-.282523,.583902,.431415,.647504,-.287663,.57953,.464301,.670601,-.291538,.573103,.498123,.693539,-.293842,.563731,.532662,.717385,-.294681,.553169,.567925,.741533,-.293717,.539908,.603502,.762142,-.291156,.521902,.639074,.783014,-.28719,.502815,.674439,.805158,-.281773,.482598,.710497,.823646,-.274682,.458949,.7456,.841879,-.266184,.433129,.781085,.859515,-.255682,.406064,.816,.875335,-.242849,.376509,.851074,.890147,-.228329,.345502,.886473,.903144,-.212491,.31428,.920751,.916618,-.195695,.282994,.954606,.927953,-.178267,.251091,.988402,.937414,-.159549,.219107,1.02141,.946823,-.140022,.18896,1.05167,.954651,-.118154,.158667,1.07819,.959955,-.0946636,.128808,1.1025,.96858,-.0711792,.0973787,1.12391,.97938,-.0475046,.0650965,1.14322,.990498,-.024059,.0326267,1.16077,.999844,-512408e-10,112444e-9,1.17727,.316912,-934977e-11,.425996,695559e-11,.356423,-241372e-9,.479108,179562e-9,.356272,-965292e-9,.478897,71811e-8,.356262,-.00217182,.478894,.00161574,.356265,-.00386092,.478895,.00287261,.356278,-.0060324,.478905,.00448907,.356293,-.00868565,.478914,.00646572,.356346,-.0118207,.478965,.00880438,.356395,-.0154355,.479001,.0115066,.356484,-.019529,.479075,.0145762,.356609,-.0240991,.47918,.018018,.356766,-.0291413,.479305,.0218379,.357009,-.0346498,.479512,.0260454,.357424,-.0405462,.479909,.0306657,.357899,-.0468825,.480337,.0357054,.358424,-.0536887,.480771,.0411728,.359041,-.0609416,.481242,.0470841,.359903,-.0685239,.481943,.0534831,.360932,-.0764883,.482741,.0603795,.362196,-.0848364,.483688,.0678028,.363847,-.0935002,.484947,.0758086,.365972,-.102471,.486588,.0844173,.368741,-.111751,.488787,.0937199,.372146,-.121334,.491405,.103732,.377114,-.131147,.495604,.114608,.38226,-.141213,.499436,.126345,.389609,-.151632,.505334,.139116,.397925,-.162073,.51168,.152995,.407824,-.172819,.518876,.168071,.420014,-.183929,.527639,.184495,.434266,-.195032,.537588,.20232,.447352,-.205792,.544379,.221189,.463726,-.216704,.553422,.241616,.481406,-.227531,.562074,.263298,.498707,-.238017,.568227,.286116,.518039,-.247936,.574473,.3101,.538277,-.257437,.579191,.335401,.561166,-.266829,.584807,.362246,.583189,-.275329,.586476,.390609,.606024,-.28234,.585578,.420998,.632419,-.287924,.584496,.454357,.656128,-.291972,.577766,.488233,.679953,-.29456,.56875,.523248,.704654,-.295816,.558388,.559168,.729016,-.295157,.544826,.595326,.752062,-.292779,.528273,.631864,.773138,-.288681,.508482,.667793,.794869,-.283358,.487341,.704035,.815101,-.27608,.46354,.739925,.834212,-.26767,.438672,.775539,.852368,-.257397,.411239,.810895,.870207,-.245689,.3829,.846472,.884063,-.231452,.351496,.881788,.898284,-.215561,.31895,.917438,.912964,-.198208,.287367,.952422,.924666,-.180426,.254487,.987551,.934429,-.161525,.222226,1.02142,.943485,-.141197,.191143,1.05218,.9521,-.120085,.161112,1.07937,.957876,-.0975881,.130982,1.10403,.966943,-.0726842,.0990553,1.12616,.978313,-.0483705,.0662818,1.14619,.990048,-.0239072,.0329243,1.16413,.999984,461885e-9,-772859e-10,1.18099,.321287,-935049e-11,.455413,659662e-11,.332595,-237513e-9,.471437,167562e-9,.332729,-949964e-9,.471618,670192e-9,.332305,-.00213618,.471028,.00150712,.332326,-.00379765,.471055,.00267959,.332344,-.00593353,.471072,.00418751,.332356,-.00854349,.471077,.00603172,.332403,-.0116268,.471121,.00821362,.332461,-.0151824,.47117,.0107357,.332552,-.0192088,.471251,.0136014,.332657,-.0237024,.47133,.0168152,.332835,-.0286615,.471487,.0203853,.333083,-.0340765,.471708,.0243212,.333547,-.0398563,.47219,.0286518,.333989,-.0460916,.472587,.0333763,.334532,-.0527897,.473054,.0385084,.335167,-.0599284,.473568,.0440638,.33608,-.0673514,.474362,.0500962,.337146,-.0752237,.475231,.0566022,.338462,-.083418,.476282,.0636272,.34014,-.0919382,.477615,.0712153,.342341,-.100741,.479404,.079417,.345088,-.109905,.481618,.0882631,.349049,-.119369,.485081,.0978851,.353939,-.129033,.489317,.108336,.359893,-.139038,.494309,.119698,.366945,-.149411,.499983,.132024,.375814,-.159843,.507185,.145558,.387112,-.170664,.516392,.160433,.40023,-.181897,.526519,.176648,.412555,-.192785,.53423,.193922,.427023,-.203663,.542741,.212662,.443685,-.214695,.552066,.232944,.461499,-.225561,.560762,.254495,.480975,-.236257,.569421,.277531,.501,-.24639,.576101,.301724,.521691,-.256101,.581493,.327112,.543478,-.265289,.585221,.353917,.566094,-.273938,.587614,.381941,.589578,-.281679,.587991,.41172,.614583,-.287655,.585928,.444148,.641813,-.292228,.582092,.478617,.666189,-.295172,.57398,.51397,.690475,-.29648,.561676,.550118,.715543,-.296203,.548758,.586933,.740405,-.293999,.532792,.62384,.762183,-.28998,.512735,.660723,.786069,-.28478,.492402,.69807,.806812,-.277568,.469058,.734422,.826987,-.268951,.443017,.770946,.844588,-.259049,.415501,.80699,.863725,-.2471,.387328,.842107,.879137,-.234157,.356108,.878078,.894634,-.218719,.324315,.914058,.909162,-.201293,.291813,.949922,.92072,-.18267,.258474,.985337,.93158,-.163212,.225593,1.0205,.941238,-.142771,.193986,1.05273,.949293,-.120956,.163392,1.08075,.956226,-.0985743,.132934,1.10559,.96546,-.075118,.101255,1.12823,.977403,-.0497921,.0675441,1.149,.989648,-.0241574,.0334681,1.16765,1.00001,5762e-7,-184807e-9,1.18519,.303474,-916603e-11,.4542,61243e-10,.308894,-232869e-9,.462306,155592e-9,.309426,-931661e-9,.463093,622499e-9,.308643,-.0020949,.461933,.00139979,.308651,-.0037242,.461941,.00248874,.308662,-.00581873,.46195,.00388933,.308687,-.00837818,.461974,.00560247,.308728,-.0114016,.462011,.00762948,.308789,-.0148884,.462067,.00997326,.308882,-.0188369,.462151,.0126375,.309007,-.0232436,.462263,.0156271,.30918,-.0281054,.462417,.0189498,.309442,-.0334065,.462667,.0226167,.309901,-.0390589,.463162,.0266614,.310331,-.0452042,.463555,.0310715,.310858,-.0517735,.464019,.0358698,.311576,-.0587359,.464669,.0410848,.312436,-.0660383,.465406,.0467453,.313526,-.0737266,.466339,.0528718,.314903,-.0817574,.467504,.0595039,.316814,-.090167,.469226,.0666888,.318965,-.0987555,.470981,.0744658,.322077,-.107792,.473814,.082912,.325947,-.117098,.477241,.0920846,.331008,-.126602,.48184,.102137,.337893,-.136619,.488334,.113135,.345106,-.146838,.494415,.12511,.355111,-.157357,.503275,.138356,.365095,-.167955,.510966,.152686,.378344,-.179157,.521508,.16856,.391599,-.190143,.530455,.18561,.407786,-.20123,.541275,.204308,.425294,-.212456,.551784,.224623,.444021,-.223568,.561493,.246172,.463418,-.234154,.569886,.268979,.484077,-.244546,.577116,.293411,.505513,-.254301,.582914,.318936,.527672,-.263564,.587208,.345856,.550565,-.272332,.589277,.374054,.573656,-.280011,.588426,.403276,.59827,-.286924,.587504,.43474,.624731,-.291994,.583401,.468767,.652396,-.295159,.576997,.504411,.67732,-.296954,.565863,.54114,.703147,-.296877,.552316,.57816,.728715,-.295147,.536773,.616124,.752448,-.291275,.51771,.653885,.775169,-.285905,.496087,.691537,.799307,-.279064,.474232,.729251,.819482,-.270294,.447676,.766267,.837659,-.260032,.419656,.802616,.856903,-.248497,.391328,.838583,.873325,-.235252,.360285,.874711,.889788,-.221126,.329215,.91077,.904486,-.204304,.296392,.94653,.917711,-.185562,.262159,.983828,.928969,-.165635,.229142,1.01955,.939707,-.14442,.19673,1.05317,.948167,-.122147,.165095,1.0823,.955222,-.099098,.13451,1.10791,.964401,-.0755332,.102476,1.1312,.976605,-.0513817,.0689667,1.15218,.989085,-.0258499,.034506,1.17129,.999908,617773e-9,-271268e-9,1.18961,.285803,-905752e-11,.452348,572272e-11,.284689,-22732e-8,.450581,143626e-9,.285263,-910214e-9,.451482,575099e-9,.285302,-.00204784,.451553,.00129395,.285318,-.00364057,.451574,.0023006,.28533,-.00568813,.451585,.00359547,.285361,-.00819001,.451618,.00517934,.285397,-.0111458,.45165,.007054,.285447,-.0145536,.451688,.00922167,.285527,-.0184127,.451758,.0116869,.285688,-.0227207,.451929,.0144555,.28584,-.0274712,.452055,.0175341,.286136,-.0326278,.452369,.0209406,.286574,-.0381792,.452853,.0246965,.287012,-.0441879,.453272,.0287996,.287542,-.0506096,.453752,.033268,.288299,-.0573634,.454488,.0381504,.289186,-.0645458,.455294,.0434447,.290302,-.0720405,.456301,.0491973,.291776,-.0799046,.457648,.0554453,.29372,-.088117,.459483,.0622311,.296052,-.0965328,.461571,.0695992,.299563,-.105409,.465085,.077658,.30335,-.114553,.468506,.0864176,.309167,-.123917,.474423,.0961078,.31529,-.13381,.47995,.106643,.324163,-.144021,.488592,.118322,.333272,-.154382,.496461,.131133,.344224,-.165015,.50562,.145208,.357733,-.176168,.516719,.16073,.373046,-.187468,.528513,.177807,.38788,-.198488,.537713,.196072,.405133,-.209545,.547999,.21605,.423845,-.220724,.55759,.237484,.443777,-.231518,.566246,.26039,.464824,-.242035,.574326,.284835,.486635,-.251898,.58037,.310518,.51012,-.261304,.58568,.337678,.535301,-.270384,.590197,.366242,.559193,-.27841,.590569,.395873,.583544,-.285325,.588161,.426857,.608834,-.291113,.584249,.459477,.635753,-.294882,.57763,.494734,.664367,-.297088,.569479,.532023,.689688,-.297364,.555064,.569629,.715732,-.295949,.539522,.608124,.741307,-.292259,.521613,.646231,.764949,-.287063,.49969,.684938,.788599,-.28012,.476747,.723548,.81048,-.27153,.45116,.761135,.831372,-.261289,.424101,.798916,.850092,-.249559,.39443,.835952,.867777,-.236348,.363849,.871606,.884632,-.221569,.332477,.907843,.90047,-.20618,.300667,.944187,.914524,-.188771,.266552,.981371,.926892,-.168362,.232349,1.01841,.937951,-.146761,.199359,1.05308,.947236,-.123813,.1675,1.0839,.954367,-.099984,.136166,1.11047,.963907,-.0759278,.103808,1.13414,.976218,-.0511367,.0697061,1.15575,.988772,-.0267415,.0352529,1.17531,.999888,-520778e-9,289926e-9,1.19389,.263546,-883274e-11,.441896,526783e-11,.262352,-221849e-9,.439889,132311e-9,.262325,-886683e-9,.439848,528824e-9,.26228,-.00199476,.439765,.00118975,.262372,-.00354671,.439922,.00211568,.26239,-.00554141,.439941,.00330652,.262412,-.00797888,.439961,.00476346,.262453,-.0108584,.440002,.00648818,.262528,-.0141788,.440085,.0084835,.262615,-.017938,.440166,.0107533,.262744,-.0221346,.440291,.0133044,.262939,-.026762,.440493,.0161445,.263277,-.0317573,.440889,.0192974,.26368,-.0371832,.441338,.0227699,.264106,-.0430371,.441753,.0265698,.264624,-.0493035,.442227,.0307178,.265378,-.0558669,.442985,.0352616,.266253,-.0628718,.443795,.0401968,.267478,-.0701569,.445008,.04559,.269062,-.077845,.446599,.0514539,.270926,-.0857941,.448349,.0578382,.273693,-.0940773,.451221,.0648363,.276746,-.102704,.454097,.0724389,.281693,-.111735,.459517,.0808744,.287335,-.121004,.46531,.0901551,.29448,-.130734,.472605,.100371,.30257,-.140777,.480251,.111644,.312465,-.15111,.489444,.124111,.324856,-.16189,.500919,.137979,.33774,-.172946,.511317,.153163,.35255,-.184152,.522684,.169817,.367786,-.19522,.53248,.187886,.385474,-.20632,.543326,.207634,.404976,-.217744,.554109,.229165,.425203,-.228691,.563395,.252068,.446704,-.239299,.571565,.276471,.468951,-.249348,.577935,.302323,.493487,-.258933,.584309,.329882,.517861,-.268009,.58773,.358525,.543309,-.276238,.589612,.388585,.569704,-.28356,.589294,.419787,.594871,-.289497,.585137,.452114,.622555,-.294452,.580356,.486466,.651167,-.296918,.57185,.523079,.677332,-.297647,.558428,.5611,.703718,-.296321,.542232,.599592,.730262,-.293339,.524541,.639138,.754304,-.288036,.502691,.677978,.778051,-.281018,.479212,.716537,.801557,-.272414,.454071,.75586,.822559,-.262419,.425952,.794477,.843051,-.250702,.397313,.832664,.86232,-.237264,.366534,.869876,.879044,-.222716,.334816,.906973,.896362,-.206827,.303143,.943558,.910342,-.189659,.269699,.979759,.924119,-.171108,.236411,1.01718,.935374,-.149579,.202224,1.05289,.944295,-.126295,.16989,1.08496,.952227,-.101511,.138089,1.11256,.962041,-.0766392,.105053,1.1375,.97528,-.0511967,.070329,1.15983,.988476,-.025463,.0351268,1.17987,.999962,286808e-10,145564e-10,1.19901,.227089,-841413e-11,.404216,472707e-11,.239725,-215083e-9,.426708,120833e-9,.239904,-860718e-9,.427028,483555e-9,.239911,-.00193661,.427039,.00108806,.239914,-.00344276,.42704,.00193457,.239933,-.00537907,.427064,.00302363,.239944,-.00774482,.427065,.00435604,.239993,-.01054,.427122,.00593398,.240052,-.0137626,.427179,.00775987,.240148,-.0174115,.427279,.00983854,.240278,-.021484,.42741,.0121763,.240472,-.0259729,.427618,.0147827,.240839,-.0308131,.428086,.0176837,.241201,-.0360893,.428482,.0208775,.241626,-.0417723,.428907,.0243821,.242207,-.0478337,.42952,.0282228,.24298,-.0542199,.430332,.0324333,.243881,-.0610015,.431222,.0370252,.245123,-.0680874,.432512,.0420535,.24667,-.0755482,.434088,.0475414,.248779,-.0832873,.436323,.0535542,.251665,-.0913546,.439509,.0601716,.255305,-.0998489,.443478,.0674282,.260049,-.108576,.448713,.0754673,.266192,-.117754,.455524,.084339,.273158,-.127294,.4627,.0941683,.282131,-.137311,.472068,.10515,.293332,-.147736,.483565,.117402,.304667,-.158357,.493702,.130824,.317785,-.169274,.504708,.145724,.333245,-.180595,.517107,.16215,.349843,-.191892,.528849,.180149,.367944,-.203168,.540301,.199746,.387579,-.214443,.551514,.221047,.408247,-.225624,.560906,.243981,.43014,-.236422,.56959,.268513,.452669,-.24654,.576098,.294409,.476196,-.256157,.580925,.322002,.501157,-.265289,.584839,.351052,.527632,-.273671,.587614,.3812,.555754,-.281254,.589119,.412994,.581682,-.287448,.585204,.445498,.608196,-.292614,.579006,.479505,.635661,-.296068,.571297,.514643,.664999,-.297395,.560855,.552213,.691039,-.296645,.544525,.591365,.7179,-.293785,.526535,.630883,.744059,-.289089,.50545,.670932,.76863,-.282239,.482514,.710904,.793273,-.273688,.457246,.750259,.814731,-.26328,.428872,.78948,.835603,-.251526,.399384,.828597,.85489,-.238339,.368811,.866892,.872828,-.223607,.336617,.90563,.889462,-.207538,.303997,.943538,.904929,-.190297,.270812,.980591,.919101,-.172034,.237453,1.01935,.930536,-.152058,.204431,1.05498,.941223,-.129515,.172495,1.08717,.94982,-.104263,.140175,1.11551,.960592,-.0781944,.106465,1.14098,.974629,-.051688,.0711592,1.16418,.98811,-.0253929,.0354432,1.18465,1.00004,804378e-9,-330876e-9,1.20462,.214668,-821282e-11,.406619,433582e-11,.218053,-208144e-9,.413025,109887e-9,.217987,-832212e-9,.412901,439362e-9,.217971,-.00187246,.412876,988623e-9,.217968,-.00332855,.41286,.00175772,.217985,-.00520055,.412882,.00274729,.218014,-.00748814,.412916,.00395842,.218054,-.0101901,.412957,.00539274,.218106,-.0133057,.413005,.00705348,.218217,-.0168342,.413139,.00894581,.218338,-.0207707,.413258,.0110754,.21855,-.0251001,.413509,.0134551,.218913,-.0297861,.413992,.0161081,.219265,-.0348956,.414383,.0190307,.219696,-.0403909,.414839,.0222458,.220329,-.0462003,.415567,.025792,.220989,-.0524208,.41621,.0296637,.222027,-.058948,.417385,.0339323,.223301,-.0658208,.418779,.0386055,.224988,-.0730347,.420665,.0437355,.227211,-.0805274,.423198,.0493844,.230131,-.088395,.426566,.0556135,.233908,-.0966208,.43091,.0624829,.239092,-.105223,.437148,.0701636,.245315,-.11424,.444302,.0786949,.253166,-.12368,.453262,.0882382,.262374,-.133569,.463211,.0988682,.273145,-.143836,.474271,.110727,.285512,-.154577,.4863,.123945,.299512,-.165501,.498817,.138581,.314287,-.176698,.510341,.154676,.331083,-.188066,.522583,.172459,.349615,-.199597,.534879,.191979,.369318,-.210843,.546083,.21309,.390377,-.222068,.5562,.235998,.412411,-.233059,.564704,.260518,.435715,-.24357,.572314,.286795,.461196,-.253356,.579395,.314559,.485587,-.262362,.581985,.343581,.511908,-.270895,.584347,.374367,.539798,-.278452,.58505,.406015,.567974,-.284877,.583344,.439168,.594303,-.290124,.577348,.473005,.622951,-.294183,.570751,.508534,.652404,-.296389,.561541,.544764,.679291,-.296605,.546426,.582927,.706437,-.294095,.528599,.622681,.734485,-.28978,.508676,.663567,.758841,-.283363,.484768,.704092,.78537,-.275015,.460434,.745101,.807315,-.264689,.432166,.784712,.8271,-.252597,.401807,.824241,.849191,-.239154,.371458,.863803,.867046,-.224451,.338873,.903063,.8852,-.208342,.306175,.942763,.901771,-.190684,.272759,.981559,.915958,-.172105,.239306,1.02048,.928046,-.152214,.206071,1.05765,.939961,-.130247,.17367,1.08999,.948711,-.10672,.142201,1.11829,.959305,-.0808688,.108454,1.14467,.973009,-.0539145,.0728109,1.16839,.987631,-.0262947,.0360625,1.19004,.999978,.00132758,-559424e-9,1.21058,.193925,-793421e-11,.391974,392537e-11,.196746,-200315e-9,.397675,991033e-10,.19667,-801099e-9,.397521,396342e-9,.196633,-.00180246,.397445,891829e-9,.196654,-.00320443,.397482,.00158582,.196659,-.00500647,.39748,.00247867,.196683,-.0072086,.397506,.00357167,.196728,-.00981001,.397562,.00486675,.196792,-.0128096,.397633,.00636707,.19689,-.0162055,.397746,.00807752,.197017,-.0199943,.397884,.0100052,.19729,-.024139,.39827,.0121691,.197583,-.0286671,.398639,.0145755,.197927,-.0335858,.399034,.0172355,.198383,-.0388806,.399554,.0201718,.199002,-.0444736,.400289,.0234194,.199739,-.0504583,.401111,.026984,.200784,-.056729,.402349,.0309217,.202075,-.0633643,.403841,.0352496,.203898,-.0703247,.406076,.0400313,.206199,-.0775565,.408841,.0453282,.209252,-.085184,.41259,.0511794,.213638,-.0931994,.418288,.0577459,.21881,-.101617,.424681,.0650508,.225642,-.11052,.433429,.0732759,.233717,-.119772,.442897,.0824683,.242823,-.129505,.452888,.0927484,.254772,-.139906,.466407,.104417,.266603,-.150402,.477413,.117211,.28073,-.161395,.490519,.131598,.295399,-.172465,.50201,.147407,.312705,-.183982,.515311,.165031,.331335,-.195532,.52786,.184336,.351037,-.206971,.5392,.205361,.372175,-.218117,.54941,.228043,.394548,-.229327,.558642,.25267,.419598,-.240052,.567861,.279071,.443922,-.249937,.573332,.306882,.471495,-.259407,.58013,.33661,.496769,-.267749,.580564,.367328,.524951,-.275524,.581696,.399753,.55318,-.282148,.579885,.433134,.581577,-.287533,.575471,.467534,.609231,-.291612,.567445,.502943,.637478,-.293911,.557657,.53871,.667795,-.295096,.546535,.576568,.694272,-.294073,.529561,.614929,.722937,-.290386,.510561,.655909,.749682,-.284481,.487846,.697663,.774754,-.276188,.462487,.738515,.799301,-.266215,.43481,.779802,.820762,-.254116,.404879,.820045,.843231,-.240393,.374559,.860294,.861857,-.225503,.341582,.900965,.880815,-.209382,.308778,.941727,.89766,-.19155,.275232,.980916,.912926,-.172346,.240938,1.02162,.926391,-.151799,.207223,1.0597,.938429,-.129968,.17484,1.09291,.947834,-.10651,.142984,1.12248,.958432,-.0824098,.109902,1.149,.972402,-.0565242,.0744454,1.1733,.987191,-.028427,.0373794,1.19538,.999975,385685e-10,-4203e-8,1.21676,.178114,-766075e-11,.385418,354027e-11,.176074,-191966e-9,.381002,887135e-10,.17601,-767549e-9,.380861,354715e-9,.17598,-.00172696,.380798,798168e-9,.175994,-.00307012,.380824,.00141928,.176017,-.00479684,.380858,.00221859,.176019,-.00690648,.380839,.00319714,.176072,-.00939888,.380913,.0043572,.176131,-.0122726,.380979,.005702,.176239,-.0155264,.38112,.00723689,.176371,-.0191551,.381272,.00896907,.176638,-.023117,.381669,.0109194,.176912,-.0274633,.382015,.0130903,.177279,-.032173,.382476,.0154949,.17774,-.0372219,.383041,.0181669,.178344,-.0426132,.38378,.0211209,.179153,-.0483309,.384773,.0243899,.180197,-.0543447,.386076,.0280062,.181581,-.0607122,.387809,.032004,.18344,-.0673855,.390205,.036453,.186139,-.0743989,.393944,.0414162,.189432,-.0817731,.39832,.0469394,.193795,-.0895464,.404188,.0531442,.199641,-.0978264,.4121,.0601374,.206679,-.106499,.421425,.0680078,.214865,-.115654,.431504,.076919,.224406,-.125268,.442526,.0868835,.235876,-.135475,.455465,.0981875,.248335,-.146023,.4681,.110759,.262868,-.157016,.482069,.124885,.278962,-.168245,.496182,.140645,.295082,-.17958,.507401,.157838,.313738,-.191227,.520252,.17695,.333573,-.202718,.531708,.197817,.356433,-.214424,.544509,.220785,.378853,-.225492,.55373,.245306,.402717,-.236236,.561348,.271593,.428375,-.246568,.568538,.299776,.454724,-.255941,.573462,.329433,.482291,-.264511,.576356,.360598,.509706,-.272129,.576446,.393204,.538805,-.278979,.575298,.427227,.568919,-.284528,.572154,.462157,.596804,-.288801,.564691,.497997,.625987,-.291334,.555134,.534467,.656414,-.292722,.545051,.571736,.683916,-.292185,.528813,.610158,.711809,-.290043,.51106,.649061,.739547,-.285246,.490103,.690081,.766914,-.277647,.465523,.732554,.791375,-.267603,.437718,.773982,.814772,-.256109,.40882,.81609,.836691,-.242281,.377823,.856849,.856984,-.227155,.34496,.898363,.876332,-.210395,.311335,.939471,.894988,-.192612,.277703,.980799,.911113,-.173236,.243019,1.02215,.924092,-.152258,.209037,1.06139,.936828,-.129575,.175909,1.09635,.946869,-.10594,.143852,1.12707,.958284,-.081318,.110289,1.15419,.972325,-.0556133,.0747232,1.17909,.986878,-.0297899,.0383149,1.20163,.999936,-.00197169,912402e-9,1.22338,.151174,-720365e-11,.351531,309789e-11,.155594,-18279e-8,.361806,78608e-9,.156099,-731569e-9,.362982,314615e-9,.156053,-.00164578,.362869,707845e-9,.156093,-.0029261,.362961,.00125884,.156099,-.00457155,.362959,.00196783,.15612,-.00658224,.362982,.00283622,.156168,-.00895774,.363048,.00386625,.156221,-.0116962,.363101,.00506109,.156324,-.0147973,.363241,.00642675,.156476,-.0182503,.363448,.00797175,.156731,-.0220266,.36384,.00971484,.156994,-.026176,.364179,.0116575,.157341,-.0306701,.36462,.0138207,.157867,-.0354591,.365364,.0162356,.15846,-.0406141,.366111,.0189092,.159308,-.0460519,.367248,.021885,.160426,-.0518096,.368767,.0252004,.161877,-.0578906,.370745,.0288825,.163995,-.0642812,.373831,.0330139,.16655,-.0710067,.377366,.0376283,.170237,-.0781522,.382799,.0428493,.175096,-.0857172,.389915,.0487324,.181069,-.0938025,.398487,.0554214,.188487,-.102363,.408799,.0630189,.197029,-.111343,.419991,.071634,.206684,-.120812,.431455,.0812797,.218698,-.131033,.445746,.0923651,.230726,-.141373,.457471,.104545,.245516,-.152387,.472388,.118449,.261551,-.163628,.486671,.133923,.277437,-.174814,.49762,.150849,.296662,-.186713,.51162,.169924,.31795,-.198513,.525435,.190848,.339422,-.210119,.536267,.213504,.362143,-.221354,.545982,.237947,.387198,-.23224,.555364,.264427,.412349,-.24257,.561489,.292519,.439274,-.252284,.566903,.322561,.466779,-.261023,.569614,.353952,.496011,-.26899,.571589,.387278,.524964,-.275498,.570325,.421356,.556518,-.281449,.568792,.457314,.584363,-.285526,.560268,.493199,.614214,-.28844,.55205,.530276,.645684,-.289777,.541906,.56855,.673446,-.289722,.526464,.606927,.701924,-.287792,.509872,.645945,.73037,-.284315,.490649,.685564,.757405,-.278804,.467964,.726511,.784025,-.269543,.441468,.768601,.808255,-.258117,.41216,.811321,.830739,-.244728,.380606,.853496,.851914,-.229428,.348111,.895374,.872586,-.212508,.314732,.937674,.891581,-.194025,.280338,.979869,.907641,-.174711,.245203,1.02253,.922233,-.153509,.21077,1.06371,.935878,-.130418,.177399,1.09972,.946338,-.105558,.144507,1.13124,.957265,-.080059,.110508,1.15973,.971668,-.0539766,.0742311,1.18515,.9866,-.0277101,.0375224,1.20858,1.00021,-515531e-9,135226e-9,1.23135,.137468,-686011e-11,.345041,273315e-11,.13703,-173378e-9,.343936,690761e-10,.136986,-693048e-9,.34383,276126e-9,.136964,-.00155931,.343761,621337e-9,.137003,-.00277211,.343863,.00110494,.137012,-.00433103,.343868,.00172744,.137043,-.00623606,.343916,.00249022,.13709,-.0084868,.343986,.00339559,.137145,-.0110814,.344045,.00444687,.137242,-.0140187,.344177,.00565007,.137431,-.0172713,.344491,.00701868,.137644,-.0208605,.344805,.00856042,.13791,-.024792,.345172,.0102863,.138295,-.0290461,.345734,.0122185,.138764,-.0335957,.346371,.0143771,.139415,-.038467,.347298,.0167894,.140272,-.0436176,.348527,.0194895,.141457,-.0491016,.350276,.0225043,.14303,-.0548764,.352646,.0258962,.145289,-.0610096,.356206,.0297168,.148502,-.0674777,.361488,.0340562,.152188,-.074345,.367103,.0389534,.157359,-.0817442,.375247,.0445541,.16379,-.0896334,.385064,.0509535,.171376,-.098005,.396082,.0582611,.179901,-.106817,.407418,.06654,.189892,-.116239,.420031,.075994,.201838,-.12627,.434321,.0867239,.214311,-.136701,.447631,.0987517,.228902,-.147616,.462046,.112353,.245107,-.158871,.476942,.127605,.262292,-.170261,.490285,.144469,.281215,-.182017,.503783,.163282,.301058,-.193729,.515505,.183873,.322752,-.205512,.52682,.206466,.347547,-.217214,.539473,.231194,.370969,-.227966,.546625,.257288,.397533,-.238555,.55472,.285789,.42398,-.248278,.559468,.315746,.452928,-.257422,.564095,.347724,.482121,-.265306,.565426,.380922,.510438,-.272043,.563205,.415639,.541188,-.277614,.561087,.451702,.571667,-.281927,.554922,.48845,.602432,-.285015,.546838,.526442,.634126,-.286512,.537415,.564896,.662816,-.286388,.522906,.604037,.692411,-.284734,.507003,.643795,.720946,-.281297,.488398,.68298,.748293,-.276262,.466353,.723466,.776931,-.269978,.443573,.764565,.801065,-.260305,.415279,.805838,.825843,-.247426,.384773,.849985,.84807,-.232437,.352555,.893174,.869122,-.215806,.318642,.936564,.888963,-.197307,.28381,.980253,.905547,-.177203,.247888,1.02463,.918554,-.155542,.212904,1.06714,.931395,-.131948,.1787,1.10451,.941749,-.106723,.145902,1.13694,.954551,-.0804939,.111193,1.1666,.970279,-.0534239,.0744697,1.19249,.986117,-.0257452,.0368788,1.21665,.999938,.00190634,-.0010291,1.23981,.118493,-647439e-11,.32272,23772e-10,.118765,-163023e-9,.323456,598573e-10,.118772,-65212e-8,.323477,239447e-9,.118843,-.00146741,.323657,538881e-9,.118804,-.00260846,.323553,95826e-8,.118826,-.00407576,.323595,.00149845,.118846,-.00586826,.323617,.00216047,.118886,-.00798578,.32367,.00294679,.118947,-.0104273,.323753,.00386124,.119055,-.0131909,.323922,.00490999,.119241,-.0162444,.324251,.00610804,.11944,-.0196339,.324544,.00745805,.119739,-.0233378,.325026,.00897805,.12011,-.0273179,.325586,.0106895,.120571,-.0316143,.326231,.0126073,.12124,-.0361939,.327264,.0147654,.122162,-.0410511,.328733,.0172001,.123378,-.0462233,.330659,.0199375,.125183,-.0517109,.333754,.0230498,.127832,-.0575652,.338507,.026597,.130909,-.0637441,.343666,.0306345,.135221,-.0704302,.351063,.035273,.14082,-.0776364,.360604,.0406137,.146781,-.0852293,.369638,.0466788,.155121,-.0935351,.3827,.0537628,.16398,-.102234,.39522,.0617985,.173926,-.111465,.40793,.07097,.185137,-.121296,.42105,.0813426,.19826,-.13169,.435735,.0931596,.212938,-.142614,.450932,.106547,.229046,-.153884,.465726,.121575,.246246,-.165382,.479461,.138286,.264637,-.176806,.492106,.15666,.284959,-.188793,.504774,.17728,.308157,-.200763,.518805,.19988,.330951,-.21239,.528231,.224293,.3549,-.223521,.536376,.250541,.381502,-.234169,.544846,.278902,.409529,-.244077,.551717,.309227,.437523,-.253363,.55517,.341426,.467624,-.261659,.557772,.37518,.497268,-.268498,.556442,.41007,.528294,-.274018,.553915,.446445,.559053,-.278169,.549153,.483779,.589329,-.281229,.539878,.522249,.622503,-.282902,.53162,.561754,.652382,-.282815,.518119,.601544,.681847,-.281247,.502187,.641574,.712285,-.277986,.484824,.682633,.740094,-.273017,.463483,.723426,.768478,-.266692,.441299,.763747,.794556,-.258358,.415238,.805565,.819408,-.248807,.386912,.847254,.843411,-.236214,.356165,.891091,.862397,-.219794,.320562,.936174,.883113,-.201768,.285322,.982562,.90023,-.181672,.249713,1.02862,.915192,-.159279,.214546,1.07163,.928458,-.134725,.180285,1.10995,.94069,-.10913,.147119,1.14354,.953409,-.0821315,.112492,1.17372,.969537,-.0542677,.0752014,1.20043,.985612,-.0259096,.0370361,1.22528,.999835,.00298198,-.00151801,1.24959,.10097,-602574e-11,.300277,202619e-11,.101577,-152164e-9,.302077,511662e-10,.101572,-608889e-9,.302066,204751e-9,.101566,-.00136997,.302047,460753e-9,.101592,-.00243557,.302114,819497e-9,.101608,-.0038053,.30214,.00128154,.101627,-.00547906,.30216,.0018483,.101669,-.00745647,.302224,.00252223,.101732,-.00973615,.302318,.00330716,.101844,-.0123097,.302513,.00421061,.102025,-.0151681,.30285,.00524481,.102224,-.0183334,.303166,.0064154,.102515,-.0217819,.303654,.00774063,.102886,-.0255067,.304243,.0092398,.103395,-.029514,.305089,.0109339,.104109,-.0337912,.306301,.0128561,.105074,-.0383565,.30798,.0150338,.10654,-.0432132,.310726,.0175228,.108478,-.0484244,.314351,.0203648,.111015,-.0539339,.319032,.0236325,.114682,-.0598885,.32605,.0274188,.11911,-.0663375,.334109,.0317905,.124736,-.0733011,.344013,.0368502,.131479,-.0807744,.355358,.0427104,.139283,-.0888204,.367614,.0494788,.148054,-.0973394,.380072,.0572367,.159037,-.10665,.395678,.0662704,.169794,-.116221,.40795,.0763192,.18314,-.126632,.423546,.087956,.197515,-.137383,.438213,.101042,.213514,-.148641,.453248,.115827,.23065,-.160117,.46688,.132283,.249148,-.171807,.479962,.150644,.270219,-.183695,.494618,.171073,.292338,-.195574,.506937,.193378,.314999,-.207205,.516463,.217585,.340991,-.218955,.528123,.24428,.367982,-.229917,.537025,.272784,.39432,-.239737,.541627,.302742,.423364,-.249048,.546466,.335112,.453751,-.257329,.549466,.369032,.48416,-.264623,.549503,.404577,.515262,-.270411,.547008,.441337,.547036,-.274581,.542249,.479162,.576614,-.277266,.533015,.517904,.611143,-.279144,.525512,.558508,.640989,-.279001,.51154,.598995,.671182,-.277324,.495641,.639935,.700848,-.273908,.477526,.681017,.729862,-.269063,.457955,.722764,.758273,-.262282,.434846,.764349,.784121,-.254281,.409203,.806206,.809798,-.24505,.382694,.848617,.834953,-.233861,.354034,.892445,.856817,-.221308,.321764,.936263,.877609,-.205996,.288118,.982401,.897489,-.186702,.253277,1.02975,.913792,-.164618,.217963,1.07488,.92785,-.140023,.183221,1.11487,.940378,-.11328,.149385,1.14947,.95273,-.0853958,.114152,1.1807,.969059,-.0568698,.0769845,1.20912,.985574,-.0276502,.0381186,1.23498,.999943,.00239052,-.00126861,1.25987,.0852715,-560067e-11,.279021,171162e-11,.0854143,-140871e-9,.279483,430516e-10,.0854191,-563385e-9,.2795,172184e-9,.0854188,-.00126753,.279493,387464e-9,.0854229,-.00225337,.279501,68918e-8,.0854443,-.00352086,.279549,.00107803,.0854697,-.00506962,.279591,.00155536,.0855093,-.00689873,.279652,.00212354,.0855724,-.00900821,.279752,.00278703,.0856991,-.0113799,.280011,.0035551,.085855,-.0140314,.280297,.00443449,.0860682,-.016963,.280682,.00543636,.086344,-.0201438,.281159,.0065788,.0867426,-.0235999,.281886,.00787977,.087239,-.0273069,.282745,.0093606,.0879815,-.031269,.284139,.011056,.0891258,-.035531,.28647,.0130065,.0906909,-.0400947,.289708,.0152495,.0927624,-.0449638,.293904,.0178454,.0958376,-.0502427,.300471,.0208915,.0995827,-.0559514,.30806,.0244247,.104526,-.0622152,.317874,.0285721,.110532,-.0690046,.329332,.0334227,.117385,-.0763068,.341217,.0390466,.12522,-.084184,.353968,.0455786,.134037,-.0925248,.366797,.0530773,.144014,-.101487,.380209,.0617424,.156013,-.111273,.395956,.071777,.168872,-.121431,.41053,.0830905,.183089,-.132105,.425073,.0959341,.198763,-.143286,.439833,.110448,.216159,-.154841,.454507,.126769,.234859,-.166588,.468368,.14495,.255879,-.178626,.482846,.165233,.27677,-.190218,.493489,.187217,.301184,-.202227,.506549,.211659,.325852,-.213764,.5158,.237922,.352824,-.22487,.525442,.26632,.380882,-.235246,.532487,.296691,.410137,-.244847,.537703,.329179,.439787,-.253122,.540361,.363135,.472291,-.260517,.542734,.399222,.501856,-.266519,.538826,.436352,.534816,-.270905,.535152,.474505,.565069,-.273826,.525979,.513988,.597154,-.275333,.516394,.554852,.630473,-.275314,.506206,.596592,.660574,-.273323,.489769,.638117,.692015,-.270008,.472578,.680457,.720647,-.265001,.452134,.723008,.750528,-.258311,.430344,.765954,.777568,-.250046,.405624,.809012,.80387,-.240114,.378339,.852425,.828439,-.228737,.349877,.895346,.851472,-.216632,.318968,.940695,.873906,-.202782,.287489,.987235,.89467,-.187059,.254394,1.03348,.912281,-.168818,.221294,1.07812,.927358,-.146494,.18675,1.11928,.940385,-.120009,.152322,1.15609,.952672,-.0917183,.117514,1.18875,.968496,-.0620321,.0797405,1.21821,.985236,-.0314945,.0402383,1.24523,.99998,-575153e-9,110644e-9,1.27133,.0702429,-512222e-11,.255273,140947e-11,.0702981,-128826e-9,.255469,354488e-10,.0703691,-515562e-9,.255727,141874e-9,.0703805,-.00116,.255754,31929e-8,.0703961,-.00206224,.255813,567999e-9,.0704102,-.00322223,.255839,88871e-8,.0704298,-.00463928,.255863,.00128272,.0704759,-.00631375,.255953,.00175283,.0705434,-.00824317,.256079,.00230342,.0706693,-.010412,.25636,.0029443,.0708189,-.0128439,.256647,.00368031,.0710364,-.0155177,.257084,.00452614,.0713223,-.0184374,.257637,.00549706,.0717182,-.0216002,.258416,.00661246,.072321,-.0249966,.259699,.00790147,.0731446,-.0286566,.261475,.0093884,.0743352,-.0325888,.264132,.0111186,.0760676,-.036843,.26815,.013145,.078454,-.0414292,.273636,.0155251,.0818618,-.0464634,.281653,.0183525,.0857382,-.0519478,.289992,.0216642,.0908131,-.0579836,.30066,.0255956,.0967512,-.0645124,.312204,.0301954,.103717,-.0716505,.325001,.0356017,.111596,-.0793232,.338129,.041896,.120933,-.087645,.352853,.0492447,.130787,-.096492,.366192,.0576749,.142311,-.105973,.380864,.0673969,.155344,-.116182,.396575,.0785899,.169535,-.126815,.411443,.0912377,.185173,-.138015,.426256,.105607,.201755,-.149325,.439607,.121551,.221334,-.161207,.455467,.139608,.241461,-.173162,.469096,.159591,.26294,-.18504,.481014,.18156,.286776,-.196881,.493291,.205781,.311596,-.208311,.503556,.231819,.338667,-.219671,.513268,.260274,.366021,-.230451,.519414,.290862,.395875,-.240131,.526766,.323196,.425564,-.248566,.52905,.357071,.457094,-.256195,.530796,.393262,.488286,-.262331,.528703,.430797,.522291,-.267141,.52727,.470231,.554172,-.270411,.519848,.510477,.586427,-.271986,.510307,.551594,.619638,-.27192,.499158,.593849,.650656,-.269817,.483852,.636314,.68284,-.266267,.467515,.679679,.714356,-.26113,.44931,.723884,.742717,-.254067,.425789,.767245,.770894,-.245652,.401144,.811819,.797358,-.235554,.374224,.856315,.823377,-.223896,.346167,.901077,.847456,-.210865,.316056,.946502,.870697,-.196574,.284503,.993711,.891068,-.180814,.251628,1.04134,.909267,-.163314,.219065,1.08609,.925653,-.143304,.186446,1.12702,.940017,-.121322,.153416,1.16371,.952398,-.0973872,.120334,1.19712,.967568,-.0698785,.08352,1.22791,.984772,-.0390031,.0439209,1.25672,1.00026,-.0070087,.00315668,1.28428,.0556653,-459654e-11,.227325,112556e-11,.0565238,-116382e-9,.230826,284985e-10,.0565717,-465666e-9,.231026,114036e-9,.0565859,-.00104773,.231079,256656e-9,.0565761,-.00186255,.231025,45663e-8,.0565913,-.00291002,.231058,714664e-9,.0566108,-.00418998,.231085,.00103224,.0566532,-.00570206,.231169,.00141202,.0567473,-.00743666,.231417,.00186018,.0568567,-.00940298,.231661,.00238264,.0569859,-.0115991,.231895,.00298699,.0572221,-.0140096,.232456,.00368957,.057519,-.0166508,.233096,.00450303,.0579534,-.01951,.234094,.00544945,.0585922,-.0225991,.235629,.00655564,.0595647,-.0259416,.238106,.00785724,.0609109,-.0295661,.241557,.00939127,.0628751,-.0335126,.246652,.0112198,.0656908,-.0378604,.254091,.0134168,.0691347,-.0426543,.262666,.0160374,.0732165,-.0478967,.272029,.0191514,.0782863,-.0536716,.283007,.0228597,.0843973,-.0600683,.295732,.0272829,.0913598,-.0670095,.308779,.032484,.0994407,-.0745516,.322886,.0385886,.108189,-.082712,.336408,.0457133,.118574,-.0914927,.351692,.0539832,.129989,-.100854,.366502,.0635162,.142722,-.110837,.381675,.0744386,.156654,-.121353,.3963,.0868483,.172151,-.132414,.411477,.100963,.188712,-.143809,.42508,.116795,.208093,-.155765,.441328,.134715,.227936,-.167608,.454328,.154396,.249495,-.179579,.467235,.176179,.27362,-.191488,.480248,.200193,.296371,-.202618,.487886,.225775,.324234,-.214133,.499632,.25441,.353049,-.225212,.509532,.285077,.381785,-.234875,.514265,.317047,.414038,-.244205,.521282,.351874,.445251,-.252145,.522931,.388279,.476819,-.258433,.520947,.425825,.509209,-.263411,.517669,.465104,.542759,-.266732,.512841,.505741,.574822,-.268263,.503317,.547611,.609324,-.268489,.493035,.590953,.641772,-.266941,.478816,.63488,.674049,-.263297,.462863,.679072,.705071,-.257618,.442931,.723487,.734709,-.250625,.421299,.768708,.763704,-.24179,.397085,.814375,.791818,-.231115,.370577,.859907,.817439,-.21922,.34232,.906715,.843202,-.205658,.312627,.953943,.866639,-.190563,.280933,1.00185,.888129,-.173978,.248393,1.05105,.907239,-.155485,.216007,1.09704,.923893,-.134782,.183233,1.13857,.938882,-.11249,.150376,1.17539,.952464,-.0890706,.117177,1.20924,.968529,-.0646523,.0813095,1.24055,.984763,-.038606,.0439378,1.27018,1.00053,-.01238,.00598668,1.29873,.0437928,-409594e-11,.204012,879224e-12,.0440166,-103395e-9,.205049,221946e-10,.0440529,-413633e-9,.205225,887981e-10,.0440493,-930594e-9,.2052,199858e-9,.0439884,-.00165352,.204901,355495e-9,.0440716,-.0025849,.205255,556983e-9,.0440968,-.00372222,.205311,805326e-9,.0441359,-.00506478,.205391,.00110333,.0442231,-.00660384,.205638,.00145768,.0443254,-.00835246,.205877,.00187275,.0444832,-.0102992,.20627,.00235938,.0447001,-.0124449,.206796,.0029299,.0450168,-.0147935,.207593,.0036005,.0454816,-.017336,.208819,.00439246,.0462446,-.0201156,.211036,.00533864,.0473694,-.0231568,.214388,.00646984,.0490191,-.0264941,.219357,.00783856,.0512776,-.030184,.226061,.00950182,.0541279,-.0342661,.234094,.0115156,.0578989,-.0388539,.244297,.0139687,.0620835,-.0438735,.254457,.0169015,.0673497,-.04951,.266706,.0204554,.0731759,-.0556263,.278753,.0246606,.0803937,-.0624585,.29309,.0297126,.0879287,-.0697556,.305856,.0355868,.0970669,-.0778795,.321059,.0425768,.106508,-.0863541,.333873,.05056,.11776,-.0955935,.349008,.0598972,.130081,-.105438,.363776,.0706314,.144454,-.115899,.380112,.0828822,.1596,-.126827,.394843,.0967611,.176097,-.138161,.409033,.112381,.194726,-.149904,.424257,.129952,.213944,-.161675,.436945,.149333,.235516,-.173659,.450176,.170892,.260564,-.185963,.466305,.194984,.285183,-.197582,.477328,.220805,.311095,-.208697,.486566,.248694,.338924,-.219519,.494811,.279015,.369757,-.229766,.504065,.311725,.3996,-.238879,.507909,.345844,.430484,-.246802,.509805,.381749,.46413,-.253924,.511436,.420251,.497077,-.259319,.508787,.459957,.530434,-.263297,.50394,.501356,.565725,-.265619,.49804,.544252,.599254,-.265842,.487346,.587856,.631251,-.263978,.472975,.631969,.663972,-.26043,.457135,.677471,.697724,-.255358,.439844,.723744,.727725,-.248308,.417872,.770653,.756417,-.239181,.39273,.817357,.785419,-.22814,.367839,.864221,.81266,-.215681,.339449,.912701,.839391,-.201623,.309279,.962419,.86366,-.185624,.278029,1.0122,.885028,-.16797,.245294,1.06186,.904639,-.148336,.212689,1.10934,.922048,-.12637,.179616,1.15063,.936952,-.102928,.146749,1.18885,.951895,-.0785268,.112733,1.22352,.967198,-.0530153,.0760056,1.25681,.984405,-.02649,.0383183,1.28762,1.00021,70019e-8,-20039e-8,1.31656,.0325964,-355447e-11,.176706,655682e-12,.0329333,-899174e-10,.178527,165869e-10,.0329181,-359637e-9,.178453,663498e-10,.0329085,-808991e-9,.178383,149332e-9,.0329181,-.00143826,.178394,265873e-9,.0329425,-.00224678,.178517,416597e-9,.0329511,-.00323575,.17849,603299e-9,.033011,-.00439875,.178695,829422e-9,.0330733,-.00574059,.178843,.00109908,.0331857,-.00725896,.179176,.00141933,.0333445,-.00895289,.179618,.0017999,.0335674,-.0108219,.180238,.00225316,.033939,-.0128687,.181417,.00279765,.0345239,-.015114,.183395,.0034564,.0354458,-.017596,.186616,.00425864,.0368313,-.0203524,.191547,.00524936,.0386115,-.0234105,.197508,.00647033,.0410303,-.0268509,.205395,.00798121,.0442245,-.0307481,.215365,.0098557,.0478659,-.0350863,.225595,.0121417,.0522416,-.0399506,.236946,.0149385,.0574513,-.045357,.249442,.0183189,.0631208,-.0512863,.261222,.0223644,.0701124,-.0579273,.275418,.0272418,.0777331,-.0650652,.288989,.0329458,.0862709,-.0728813,.302546,.0396819,.096103,-.081363,.317164,.04757,.106976,-.0904463,.331733,.0567012,.119175,-.100105,.34661,.067202,.132919,-.110375,.362249,.0792588,.147727,-.121115,.376978,.0928672,.163618,-.132299,.390681,.108228,.182234,-.143887,.406571,.125502,.201809,-.155827,.42042,.144836,.225041,-.168357,.438411,.166706,.247621,-.18004,.450368,.189909,.27097,-.191536,.460083,.215251,.296658,-.203024,.469765,.243164,.325892,-.214056,.481837,.273388,.35406,-.224104,.487474,.305344,.384372,-.233489,.492773,.339741,.41749,-.241874,.498451,.376287,.45013,-.248834,.499632,.414195,.481285,-.254658,.495233,.454077,.519183,-.259367,.496401,.496352,.551544,-.261818,.487686,.538798,.587349,-.262964,.479453,.583626,.621679,-.262128,.467709,.629451,.654991,-.258998,.452123,.67566,.686873,-.254119,.433495,.723248,.719801,-.246946,.413657,.771156,.750355,-.237709,.390366,.81989,.780033,-.226549,.364947,.868601,.809254,-.214186,.337256,.920034,.836576,-.199639,.307395,.971706,.861774,-.183169,.275431,1.02479,.885707,-.165111,.243431,1.07837,.904742,-.144363,.210921,1.12783,.915604,-.121305,.17647,1.17254,.930959,-.0962119,.143106,1.21012,.948404,-.069969,.108112,1.24474,.967012,-.0427586,.0708478,1.27718,.984183,-.0147043,.032335,1.3083,.999577,.0142165,-.00726867,1.3382,.0229227,-299799e-11,.148623,462391e-12,.0232194,-758796e-10,.15054,117033e-10,.0232315,-303636e-9,.15063,468397e-10,.0232354,-683189e-9,.150624,105472e-9,.0232092,-.0012136,.150445,187744e-9,.0232523,-.00189765,.150679,294847e-9,.0232828,-.00273247,.150789,428013e-9,.0233371,-.00371287,.150995,591134e-9,.0234015,-.00484794,.15118,787642e-9,.023514,-.00612877,.151562,.00102547,.023679,-.00756125,.152116,.00131351,.0239559,-.00914651,.153162,.00166594,.0244334,-.010904,.155133,.00210182,.025139,-.0128615,.158035,.00264406,.0262598,-.0150628,.162751,.00332923,.0277875,-.0175532,.168944,.00419773,.0298472,-.0203981,.176835,.00530034,.0325444,-.023655,.186686,.00669777,.0355581,-.0272982,.196248,.00842661,.0392841,-.0314457,.207352,.0105854,.0436815,-.0361157,.219279,.0132458,.0485272,-.0412932,.230728,.0164736,.0541574,-.0470337,.242994,.0203715,.0609479,-.0535002,.257042,.0250953,.0685228,-.0605409,.27102,.0306856,.0768042,-.0680553,.28406,.037193,.0864844,-.0765011,.299186,.0449795,.0969415,-.0852674,.3132,.0538316,.108478,-.0947333,.327138,.0641149,.121705,-.10481,.342345,.0759185,.136743,-.115474,.358472,.0894116,.152986,-.126536,.374067,.104562,.170397,-.138061,.388267,.121632,.191392,-.150203,.406467,.140996,.211566,-.161751,.418641,.161696,.233567,-.173407,.430418,.184557,.257769,-.185397,.44277,.210092,.28531,-.197048,.457191,.237827,.311726,-.20784,.464712,.267253,.340537,-.218345,.472539,.299332,.372921,-.228306,.482331,.333988,.402924,-.236665,.484378,.369722,.434475,-.244097,.484717,.407836,.469736,-.250547,.487093,.448465,.505045,-.25511,.485575,.490263,.540262,-.258444,.481225,.534495,.576347,-.259903,.473481,.579451,.608656,-.259572,.4603,.625604,.646679,-.257908,.450341,.674511,.679902,-.253663,.431561,.723269,.714159,-.247419,.412684,.773263,.745345,-.239122,.389388,.824182,.778248,-.228837,.365361,.876634,.807208,-.216197,.337667,.92945,.835019,-.201772,.307197,.985261,.860261,-.185291,.274205,1.04299,.877601,-.165809,.240178,1.09816,.898211,-.143897,.207571,1.14694,.915789,-.119513,.174904,1.19008,.931831,-.0932919,.141423,1.2297,.949244,-.0656528,.105603,1.26553,.967527,-.0370262,.0679551,1.29986,.984139,-.00730117,.0283133,1.33252,.999713,.0234648,-.0121785,1.36397,.0152135,-245447e-11,.122795,304092e-12,.0151652,-615778e-10,.122399,76292e-10,.0151181,-245948e-9,.122023,304802e-10,.0151203,-553394e-9,.12203,686634e-10,.015125,-983841e-9,.122037,122463e-9,.0151427,-.00153774,.12214,192706e-9,.0151708,-.0022103,.122237,281219e-9,.0152115,-.00300741,.12238,390804e-9,.0152877,-.00392494,.1227,526317e-9,.015412,-.00496597,.123244,69443e-8,.0156201,-.00613314,.124228,90547e-8,.0159658,-.00744113,.125945,.0011732,.0165674,-.00892546,.129098,.00151888,.017487,-.010627,.133865,.00197007,.018839,-.0126043,.140682,.0025637,.020554,-.0148814,.148534,.00333637,.0226727,-.0175123,.157381,.00433738,.0251879,-.0205266,.166685,.00561664,.0283635,-.0240319,.177796,.00725563,.0318694,-.0279432,.188251,.00928811,.0361044,-.0324313,.200038,.011835,.0406656,-.0373527,.210685,.0149146,.0463846,-.0430132,.224182,.0187254,.0525696,-.0491013,.23634,.0232283,.0598083,-.0559175,.250013,.0286521,.0679437,-.0633657,.263981,.0350634,.0771181,-.0714602,.278072,.0425882,.0881273,-.0803502,.29511,.0514487,.0996628,-.0896903,.309976,.0615766,.112702,-.099644,.325611,.0732139,.126488,-.109829,.339321,.0862324,.142625,-.120859,.35574,.101275,.15953,-.131956,.369845,.117892,.176991,-.143145,.38146,.136205,.199715,-.155292,.40052,.157252,.220787,-.167066,.412055,.179966,.243697,-.178396,.423133,.204418,.272106,-.190433,.439524,.232141,.297637,-.201265,.447041,.261109,.325273,-.211834,.454488,.292627,.357219,-.221889,.465004,.326669,.387362,-.230729,.468527,.362426,.423131,-.23924,.475836,.401533,.45543,-.246067,.475017,.441902,.493393,-.251557,.478017,.484239,.526253,-.255571,.4709,.528586,.560554,-.257752,.463167,.574346,.599306,-.258076,.456452,.621655,.634541,-.256471,.443725,.670492,.668907,-.253283,.428719,.721943,.705619,-.247562,.411348,.772477,.739034,-.240626,.388939,.8264,.771408,-.231493,.36425,.881702,.803312,-.220125,.337321,.9385,.828457,-.206645,.305364,.997437,.854819,-.190664,.273715,1.05693,.878666,-.171429,.242218,1.11251,.898404,-.149235,.209556,1.16398,.917416,-.12435,.176863,1.21014,.933133,-.0972703,.142775,1.25178,.95066,-.0683607,.106735,1.29028,.968589,-.0378724,.0681609,1.32703,.984776,-.00605712,.0273966,1.36158,.99994,.0263276,-.0138124,1.3943,.00867437,-186005e-11,.0928979,173682e-12,.00864003,-466389e-10,.0925237,435505e-11,.00864593,-186594e-9,.0925806,174322e-10,.00864095,-419639e-9,.0924903,392862e-10,.00863851,-746272e-9,.0924589,702598e-10,.00868531,-.00116456,.0929,111188e-9,.00869667,-.00167711,.0928529,163867e-9,.00874332,-.00228051,.0930914,23104e-8,.00882709,-.00297864,.0935679,31741e-8,.00898874,-.00377557,.0946165,430186e-9,.00929346,-.00469247,.0967406,580383e-9,.00978271,-.00575491,.100084,783529e-9,.0105746,-.00701514,.105447,.00106304,.0116949,-.00851797,.112494,.00144685,.0130419,-.0102757,.119876,.00196439,.0148375,-.012381,.129034,.00266433,.0168725,-.01482,.137812,.00358364,.0193689,-.0176563,.147696,.00478132,.0222691,-.0209211,.157795,.00631721,.0256891,-.0246655,.168431,.00826346,.0294686,-.0288597,.178587,.0106714,.0340412,-.0336441,.190251,.0136629,.0393918,-.039033,.202999,.0173272,.0453947,-.0450087,.215655,.0217448,.0521936,-.0515461,.228686,.0269941,.0600279,-.058817,.242838,.033272,.0692398,-.0667228,.258145,.0406457,.0793832,-.0752401,.273565,.0492239,.0902297,-.0841851,.287735,.0590105,.102014,-.0936479,.301161,.0702021,.116054,-.103967,.317438,.0832001,.13191,-.114622,.334166,.0977951,.148239,-.125452,.348192,.113985,.165809,-.136453,.361094,.131928,.184616,-.147648,.373534,.151811,.207491,-.159607,.39101,.174476,.230106,-.171119,.402504,.198798,.257036,-.182906,.418032,.225796,.281172,-.193605,.425468,.254027,.312034,-.204771,.440379,.285713,.340402,-.214988,.445406,.319196,.370231,-.224711,.44968,.35537,.407105,-.233516,.460747,.393838,.439037,-.240801,.460624,.433747,.47781,-.24762,.465957,.477234,.510655,-.251823,.460054,.52044,.550584,-.255552,.459172,.567853,.585872,-.257036,.450311,.615943,.620466,-.257535,.437763,.667693,.660496,-.255248,.426639,.718988,.695578,-.251141,.409185,.772503,.732176,-.244718,.39015,.827023,.760782,-.236782,.362594,.885651,.79422,-.225923,.33711,.943756,.824521,-.213855,.308272,1.00874,.854964,-.197723,.278529,1.06764,.878065,-.179209,.246208,1.12836,.899834,-.157569,.21329,1.18318,.918815,-.133206,.181038,1.23161,.934934,-.106545,.146993,1.27644,.952115,-.0780574,.111175,1.31842,.96906,-.0478279,.0728553,1.35839,.985178,-.0160014,.032579,1.39697,1.00039,.0173126,-.0095256,1.43312,.00384146,-124311e-11,.0613583,778271e-13,.00390023,-314043e-10,.0622919,196626e-11,.00389971,-125622e-9,.0622632,787379e-11,.00389491,-282352e-9,.0620659,1778e-8,.00391618,-502512e-9,.0624687,320918e-10,.00392662,-784458e-9,.0625113,515573e-10,.00396053,-.00112907,.0628175,778668e-10,.00401911,-.00153821,.0633286,113811e-9,.00414994,-.0020208,.0646443,16445e-8,.00441223,-.00260007,.0673886,237734e-9,.00484427,-.0033097,.0716528,345929e-9,.00549109,-.00418966,.0774998,505987e-9,.00636293,-.00527331,.0844758,739208e-9,.00746566,-.00660428,.0921325,.00107347,.00876625,-.00818826,.0997067,.00153691,.0103125,-.0100811,.107433,.00217153,.0123309,-.0123643,.117088,.00303427,.0146274,-.0150007,.126438,.00416018,.0172295,-.0180531,.135672,.00561513,.0204248,-.0215962,.146244,.007478,.0241597,-.0256234,.157481,.00981046,.0284693,-.0302209,.169125,.0127148,.033445,-.0353333,.181659,.0162453,.0391251,-.0410845,.1944,.0205417,.0454721,-.0473451,.207082,.0256333,.0530983,-.0542858,.221656,.0317036,.0615356,-.0618384,.236036,.0388319,.0703363,-.0697631,.248398,.046974,.0810391,-.0784757,.263611,.0565246,.0920144,-.0873488,.275857,.0671724,.105584,-.0973652,.292555,.0798105,.119506,-.107271,.306333,.0935945,.134434,-.117608,.318888,.109106,.153399,-.128938,.337552,.127074,.171258,-.139944,.349955,.14643,.191059,-.151288,.361545,.168,.215069,-.163018,.378421,.192082,.237838,-.174226,.38879,.217838,.266965,-.186063,.405857,.246931,.292827,-.196909,.414146,.277505,.324352,-.207473,.426955,.310711,.354427,-.217713,.433429,.346794,.389854,-.227183,.443966,.385237,.420749,-.235131,.44471,.424955,.459597,-.242786,.451729,.468446,.495316,-.248767,.45072,.513422,.534903,-.253351,.450924,.560618,.572369,-.256277,.445266,.609677,.612383,-.2576,.438798,.660995,.644037,-.256931,.421693,.713807,.686749,-.254036,.4109,.767616,.719814,-.249785,.390151,.82533,.754719,-.244283,.367847,.888311,.792022,-.235076,.345013,.948177,.822404,-.225061,.316193,1.01661,.853084,-.211113,.287013,1.08075,.879871,-.19449,.255424,1.14501,.901655,-.174023,.222879,1.20203,.919957,-.1509,.18989,1.25698,.938412,-.124923,.15606,1.30588,.953471,-.0968139,.120512,1.3529,.970451,-.066734,.0828515,1.3986,.985522,-.034734,.0424458,1.44148,1.00099,-.00102222,678929e-9,1.48398,965494e-9,-627338e-12,.0306409,197672e-13,99168e-8,-158573e-10,.0314638,499803e-12,991068e-9,-634012e-10,.031363,200682e-11,974567e-9,-14144e-8,.03036,457312e-11,998079e-9,-252812e-9,.031496,860131e-11,.00102243,-396506e-9,.0319955,148288e-10,.00107877,-577593e-9,.0331376,249141e-10,.00121622,-816816e-9,.0359396,423011e-10,.0014455,-.00113761,.0399652,724613e-10,.00178791,-.00156959,.0450556,123929e-9,.00225668,-.00214064,.0508025,208531e-9,.00285627,-.00287655,.0568443,341969e-9,.0035991,-.00380271,.0630892,544158e-9,.00455524,-.00496264,.0702204,842423e-9,.00569143,-.0063793,.0773426,.00126704,.00716928,-.00813531,.0860839,.00186642,.00885307,-.0101946,.0944079,.00267014,.0109316,-.0126386,.103951,.00374033,.0133704,-.0154876,.113786,.0051304,.0161525,-.0187317,.123477,.00688858,.0194267,-.0224652,.133986,.00910557,.0230967,-.0265976,.143979,.0118074,.0273627,-.0312848,.154645,.0151266,.0323898,-.0365949,.166765,.0191791,.0379225,-.0422914,.177932,.0239236,.0447501,-.0487469,.19167,.0296568,.0519391,-.0556398,.203224,.0362924,.0599464,-.0631646,.215652,.0440585,.0702427,-.0714308,.232089,.0531619,.0806902,-.0800605,.245258,.0634564,.0923194,-.0892815,.258609,.0752481,.106938,-.09931,.276654,.0888914,.121238,-.109575,.289847,.104055,.138817,-.120461,.307566,.121266,.15595,-.131209,.320117,.139944,.178418,-.143049,.339677,.161591,.197875,-.154074,.349886,.184303,.224368,-.166307,.369352,.210669,.252213,-.178051,.386242,.238895,.277321,-.189335,.395294,.269182,.310332,-.200683,.412148,.302508,.338809,-.210856,.418266,.337264,.372678,-.220655,.428723,.374881,.405632,-.230053,.433887,.415656,.442293,-.237993,.439911,.457982,.477256,-.244897,.440175,.502831,.515592,-.250657,.441079,.550277,.550969,-.255459,.435219,.601102,.592883,-.257696,.432882,.651785,.629092,-.259894,.421054,.708961,.672033,-.258592,.41177,.763806,.709147,-.256525,.395267,.824249,.745367,-.254677,.375013,.8951,.784715,-.247892,.353906,.959317,.818107,-.240162,.327801,1.03153,.847895,-.229741,.298821,1.10601,.879603,-.213084,.269115,1.164,.902605,-.195242,.236606,1.22854,.922788,-.174505,.203442,1.29017,.944831,-.150169,.169594,1.34157,.959656,-.124099,.135909,1.3956,.972399,-.0960626,.0990563,1.45128,.986549,-.0657097,.0602348,1.50312,1.00013,-.0333558,.0186694,1.55364,619747e-11,-1e-7,.00778326,796756e-16,237499e-13,-999999e-13,282592e-10,114596e-15,100292e-11,-166369e-11,250354e-9,677492e-14,350752e-11,-637769e-11,357289e-9,631655e-13,826445e-11,-174689e-10,516179e-9,31851e-11,242481e-10,-450868e-10,.0010223,130577e-11,455631e-10,-89044e-9,.00144302,374587e-11,971222e-10,-178311e-9,.00241912,102584e-10,171403e-9,-313976e-9,.00354938,236481e-10,292747e-9,-520026e-9,.00513765,496014e-10,789827e-9,-.00118187,.0238621,139056e-9,.00114093,-.00171827,.0286691,244093e-9,.00176119,-.00249667,.0368565,420623e-9,.0022233,-.00333742,.0400469,65673e-8,.00343382,-.00481976,.0535751,.00109323,.00427602,-.00600755,.057099,.00155268,.00461435,-.00737637,.0551084,.00215031,.00695698,-.00971401,.0715767,.00316529,.00867619,-.0120943,.0793314,.00436995,.0106694,-.0148202,.0869391,.0058959,.0140351,-.0183501,.101572,.00798757,.0168939,-.022006,.11018,.0104233,.020197,-.0261568,.119041,.0134167,.0254702,-.0312778,.135404,.0173009,.0298384,-.0362469,.1437,.0215428,.035159,-.042237,.15512,.0268882,.0427685,-.0488711,.17128,.033235,.0494848,-.0557997,.181813,.0404443,.0592394,-.0635578,.198745,.0490043,.0681463,-.071838,.210497,.0588239,.0804753,-.0809297,.228864,.0702835,.0942205,-.0906488,.247008,.0834012,.106777,-.100216,.258812,.0975952,.124471,-.110827,.278617,.114162,.138389,-.121193,.287049,.131983,.159543,-.13253,.307151,.152541,.176432,-.143611,.31564,.174673,.201723,-.15548,.33538,.199842,.229721,-.167166,.355256,.227097,.250206,-.178238,.360047,.256014,.282118,-.189905,.378761,.28855,.312821,-.201033,.39181,.323348,.341482,-.211584,.397716,.360564,.377368,-.221314,.410141,.400004,.418229,-.230474,.423485,.442371,.444881,-.239443,.418874,.488796,.488899,-.245987,.427545,.535012,.520317,-.253948,.422147,.589678,.568566,-.256616,.42719,.637683,.599607,-.26376,.415114,.703363,.64222,-.268687,.408715,.771363,.685698,-.2694,.399722,.83574,.732327,-.266642,.388651,.897764,.769873,-.267712,.369198,.983312,.806733,-.263479,.346802,1.06222,.843466,-.254575,.321368,1.13477,.873008,-.242749,.29211,1.20712,.908438,-.22725,.262143,1.27465,.936321,-.207621,.228876,1.33203,.950353,-.187932,.19484,1.40439,.96442,-.165154,.163178,1.4732,.979856,-.139302,.127531,1.53574,.982561,-.11134,.0903457,1.59982,.996389,-.0808124,.0489007,1.6577],t=[1,0,0,0,1,791421e-36,0,0,1,104392e-29,0,0,1,349405e-26,0,0,1,109923e-23,0,0,1,947414e-22,0,0,1,359627e-20,0,0,1,772053e-19,0,0,1,108799e-17,0,0,1,110655e-16,0,0,1,865818e-16,0,0,.999998,545037e-15,0,0,.999994,285095e-14,0,0,.999989,126931e-13,0,0,.999973,489938e-13,0,0,.999947,166347e-12,0,0,.999894,502694e-12,0,0,.999798,136532e-11,0,0,.999617,335898e-11,0,0,.999234,752126e-11,0,0,.998258,152586e-10,0,0,.99504,266207e-10,0,0,.980816,236802e-10,0,0,.967553,207684e-11,0,0,.966877,403733e-11,0,0,.965752,741174e-11,0,0,.96382,127746e-10,0,0,.960306,202792e-10,0,0,.953619,280232e-10,0,0,.941103,278816e-10,0,0,.926619,160221e-10,0,0,.920983,235164e-10,0,0,.912293,311924e-10,0,.0158731,.899277,348118e-10,0,.0476191,.880884,26041e-9,0,.0793651,.870399,338726e-10,0,.111111,.856138,392906e-10,0,.142857,.837436,372874e-10,0,.174603,.820973,392558e-10,0,.206349,.803583,434658e-10,0,.238095,.782168,40256e-9,0,.269841,.764107,448159e-10,0,.301587,.743092,457627e-10,0,.333333,.721626,455314e-10,0,.365079,.700375,477335e-10,0,.396825,.677334,461072e-10,0,.428571,.655702,484393e-10,0,.460317,.632059,464583e-10,0,.492064,.610125,483923e-10,0,.52381,.58653,464342e-10,0,.555556,.564508,477033e-10,0,.587302,.541405,459263e-10,0,.619048,.519556,46412e-9,0,.650794,.497292,448913e-10,0,.68254,.475898,445789e-10,0,.714286,.454722,433496e-10,0,.746032,.434042,423054e-10,0,.777778,.414126,413737e-10,0,.809524,.394387,397265e-10,0,.84127,.375841,390709e-10,0,.873016,.357219,369938e-10,0,.904762,.340084,365618e-10,0,.936508,.322714,342533e-10,0,.968254,.306974,339596e-10,0,1,1,101524e-23,0,0,1,10292e-22,0,0,1,130908e-23,0,0,1,473331e-23,0,0,1,625319e-22,0,0,1,107932e-20,0,0,1,163779e-19,0,0,1,203198e-18,0,0,1,204717e-17,0,0,.999999,168995e-16,0,0,.999998,115855e-15,0,0,.999996,66947e-14,0,0,.999991,330863e-14,0,0,.999983,141737e-13,0,0,.999968,532626e-13,0,0,.99994,177431e-12,0,0,.999891,528835e-12,0,0,.999797,142169e-11,0,0,.999617,347057e-11,0,0,.999227,77231e-10,0,0,.998239,155753e-10,0,0,.994937,268495e-10,0,0,.980225,213742e-10,0,0,.967549,21631e-10,0,0,.966865,417989e-11,0,0,.965739,763341e-11,0,0,.963794,130892e-10,0,0,.960244,206456e-10,0,0,.953495,282016e-10,0,148105e-9,.940876,271581e-10,0,.002454,.926569,164159e-10,0,.00867491,.920905,239521e-10,0,.01956,.912169,315127e-10,0,.035433,.899095,346626e-10,0,.056294,.882209,290223e-10,0,.0818191,.870272,342992e-10,0,.111259,.855977,394164e-10,0,.142857,.837431,372343e-10,0,.174603,.820826,396691e-10,0,.206349,.803408,435395e-10,0,.238095,.782838,419579e-10,0,.269841,.763941,450953e-10,0,.301587,.742904,455847e-10,0,.333333,.721463,458833e-10,0,.365079,.700197,477159e-10,0,.396825,.677501,470641e-10,0,.428571,.655527,484732e-10,0,.460317,.6324,476834e-10,0,.492064,.609964,484213e-10,0,.52381,.586839,475541e-10,0,.555556,.564353,476951e-10,0,.587302,.541589,467611e-10,0,.619048,.519413,463493e-10,0,.650794,.497337,453994e-10,0,.68254,.475797,445308e-10,0,.714286,.454659,435787e-10,0,.746032,.434065,424839e-10,0,.777778,.414018,41436e-9,0,.809524,.39455,401902e-10,0,.84127,.375742,390813e-10,0,.873016,.357501,377116e-10,0,.904762,.339996,36535e-9,0,.936508,.323069,351265e-10,0,.968254,.306897,339112e-10,0,1,1,10396e-19,0,0,1,104326e-20,0,0,1,110153e-20,0,0,1,144668e-20,0,0,1,34528e-19,0,0,1,175958e-19,0,0,1,12627e-17,0,0,1,936074e-18,0,0,1,645742e-17,0,0,.999998,401228e-16,0,0,.999997,222338e-15,0,0,.999995,10967e-13,0,0,.999991,482132e-14,0,0,.999981,189434e-13,0,0,.999967,667716e-13,0,0,.999938,212066e-12,0,0,.999886,60977e-11,0,0,.999792,159504e-11,0,0,.999608,381191e-11,0,0,.999209,833727e-11,0,0,.998179,165288e-10,0,0,.994605,274387e-10,0,0,.979468,167316e-10,0,0,.967529,242877e-11,0,0,.966836,461696e-11,0,0,.96569,830977e-11,0,0,.963706,140427e-10,0,244659e-11,.960063,217353e-10,0,760774e-9,.953113,286606e-10,0,.00367261,.940192,247691e-10,0,.00940263,.927731,195814e-10,0,.018333,.920669,252531e-10,0,.0306825,.911799,324277e-10,0,.0465556,.89857,340982e-10,0,.0659521,.883283,319622e-10,0,.0887677,.86989,35548e-9,0,.114784,.855483,397143e-10,0,.143618,.837987,391665e-10,0,.174606,.820546,411306e-10,0,.206349,.802878,436753e-10,0,.238095,.783402,444e-7,0,.269841,.763439,458726e-10,0,.301587,.742925,467097e-10,0,.333333,.721633,478887e-10,0,.365079,.69985,481251e-10,0,.396825,.67783,491811e-10,0,.428571,.655126,488199e-10,0,.460318,.632697,496025e-10,0,.492064,.609613,48829e-9,0,.52381,.587098,492754e-10,0,.555556,.564119,482625e-10,0,.587302,.541813,482807e-10,0,.619048,.519342,471552e-10,0,.650794,.497514,466765e-10,0,.68254,.475879,455582e-10,0,.714286,.454789,446007e-10,0,.746032,.434217,435382e-10,0,.777778,.414086,421753e-10,0,.809524,.394744,412093e-10,0,.84127,.375782,396634e-10,0,.873016,.357707,386419e-10,0,.904762,.340038,370345e-10,0,.936508,.323284,359725e-10,0,.968254,.306954,3436e-8,0,1,1,599567e-19,0,0,1,600497e-19,0,0,1,614839e-19,0,0,1,686641e-19,0,0,1,972658e-19,0,0,1,221271e-18,0,0,1,833195e-18,0,0,1,403601e-17,0,0,.999999,206001e-16,0,0,.999998,101739e-15,0,0,.999997,470132e-15,0,0,.999993,200436e-14,0,0,.999988,783682e-14,0,0,.999979,280338e-13,0,0,.999962,917033e-13,0,0,.999933,274514e-12,0,0,.999881,753201e-12,0,0,.999783,189826e-11,0,0,.999594,440279e-11,0,0,.999178,93898e-10,0,0,.998073,181265e-10,0,0,.993993,280487e-10,0,0,.979982,149422e-10,0,0,.968145,378481e-11,0,0,.966786,53771e-10,0,0,.965611,947508e-11,0,388934e-10,.963557,156616e-10,0,9693e-7,.959752,235144e-10,0,.00370329,.952461,291568e-10,0,.00868428,.940193,240102e-10,0,.0161889,.929042,231235e-10,0,.0263948,.920266,273968e-10,0,.0394088,.911178,337915e-10,0,.0552818,.897873,333629e-10,0,.0740138,.884053,351405e-10,0,.0955539,.869455,378034e-10,0,.119795,.854655,399378e-10,0,.14656,.838347,419108e-10,0,.175573,.820693,440831e-10,0,.206388,.802277,445599e-10,0,.238095,.783634,472691e-10,0,.269841,.763159,476984e-10,0,.301587,.742914,491487e-10,0,.333333,.721662,502312e-10,0,.365079,.699668,502817e-10,0,.396825,.677839,51406e-9,0,.428571,.655091,511095e-10,0,.460317,.632665,516067e-10,0,.492064,.609734,512255e-10,0,.52381,.587043,510263e-10,0,.555556,.564298,50565e-9,0,.587302,.541769,497951e-10,0,.619048,.519529,492698e-10,0,.650794,.497574,482066e-10,0,.68254,.476028,473689e-10,0,.714286,.454961,461941e-10,0,.746032,.434341,450618e-10,0,.777778,.414364,438355e-10,0,.809524,.394832,424196e-10,0,.84127,.376109,412563e-10,0,.873016,.35779,396226e-10,0,.904762,.340379,384886e-10,0,.936508,.323385,368214e-10,0,.968254,.307295,356636e-10,0,1,1,106465e-17,0,0,1,106555e-17,0,0,1,107966e-17,0,0,1,114601e-17,0,0,1,137123e-17,0,0,1,21243e-16,0,0,.999999,489653e-17,0,0,.999999,160283e-16,0,0,.999998,62269e-15,0,0,.999997,251859e-15,0,0,.999996,996192e-15,0,0,.999992,374531e-14,0,0,.999986,132022e-13,0,0,.999975,433315e-13,0,0,.999959,131956e-12,0,0,.999927,372249e-12,0,0,.999871,972461e-12,0,0,.999771,235343e-11,0,0,.999572,52768e-10,0,0,.999133,109237e-10,0,0,.997912,203675e-10,0,0,.993008,279396e-10,0,0,.980645,139604e-10,0,0,.970057,646596e-11,0,0,.966717,65089e-10,0,474145e-10,.965497,111863e-10,0,89544e-8,.96334,179857e-10,0,.0032647,.959294,259045e-10,0,.0075144,.951519,292327e-10,0,.0138734,.940517,249769e-10,0,.0224952,.93014,26803e-9,0,.0334828,.91972,303656e-10,0,.0468973,.910294,353323e-10,0,.0627703,.897701,351002e-10,0,.0811019,.884522,388104e-10,0,.10186,.869489,412932e-10,0,.124985,.853983,415781e-10,0,.150372,.838425,454066e-10,0,.177868,.820656,471624e-10,0,.207245,.801875,475243e-10,0,.238143,.783521,505621e-10,0,.269841,.763131,50721e-9,0,.301587,.74261,523293e-10,0,.333333,.72148,528699e-10,0,.365079,.699696,538677e-10,0,.396825,.677592,539255e-10,0,.428571,.65525,546367e-10,0,.460317,.632452,541348e-10,0,.492064,.609903,544976e-10,0,.52381,.586928,536201e-10,0,.555556,.564464,535185e-10,0,.587302,.541801,524949e-10,0,.619048,.519681,51812e-9,0,.650794,.497685,507687e-10,0,.68254,.47622,496243e-10,0,.714286,.455135,485714e-10,0,.746032,.4346,471847e-10,0,.777778,.414564,459294e-10,0,.809524,.395165,444705e-10,0,.84127,.376333,430772e-10,0,.873016,.358197,416229e-10,0,.904762,.34064,401019e-10,0,.936508,.323816,386623e-10,0,.968254,.307581,370933e-10,0,1,1,991541e-17,0,0,1,992077e-17,0,0,1,100041e-16,0,0,1,10385e-15,0,0,1,115777e-16,0,0,1,150215e-16,0,0,.999999,254738e-16,0,0,.999999,598822e-16,0,0,.999998,179597e-15,0,0,.999997,602367e-15,0,0,.999994,206835e-14,0,0,.99999,694952e-14,0,0,.999984,223363e-13,0,0,.999972,678578e-13,0,0,.999952,193571e-12,0,0,.999919,516594e-12,0,0,.99986,128739e-11,0,0,.999753,299298e-11,0,0,.999546,648258e-11,0,0,.999074,129985e-10,0,0,.997671,232176e-10,0,0,.991504,256701e-10,0,0,.981148,131141e-10,0,0,.971965,869048e-11,0,280182e-10,.966624,808301e-11,0,695475e-9,.965344,135235e-10,0,.00265522,.963048,210592e-10,0,.00622975,.958673,287473e-10,0,.0116234,.950262,281379e-10,0,.018976,.940836,271089e-10,0,.0283844,.930996,30926e-9,0,.0399151,.919848,348359e-10,0,.0536063,.909136,366092e-10,0,.0694793,.897554,384162e-10,0,.0875342,.884691,430971e-10,0,.107749,.869414,447803e-10,0,.130087,.853462,452858e-10,0,.154481,.838187,495769e-10,0,.180833,.820381,502709e-10,0,.209005,.801844,522713e-10,0,.238791,.783061,541505e-10,0,.269869,.763205,553712e-10,0,.301587,.742362,564909e-10,0,.333333,.721393,572646e-10,0,.365079,.699676,581012e-10,0,.396825,.677395,58096e-9,0,.428571,.655208,585766e-10,0,.460317,.632451,583602e-10,0,.492064,.609839,580234e-10,0,.52381,.587093,577161e-10,0,.555556,.564467,568447e-10,0,.587302,.542043,563166e-10,0,.619048,.519826,55156e-9,0,.650794,.497952,541682e-10,0,.68254,.476477,528971e-10,0,.714286,.455412,514952e-10,0,.746032,.434926,502222e-10,0,.777778,.4149,485779e-10,0,.809524,.395552,472242e-10,0,.84127,.376712,454891e-10,0,.873016,.358622,440924e-10,0,.904762,.341048,422984e-10,0,.936508,.324262,408582e-10,0,.968254,.308013,390839e-10,0,1,1,613913e-16,0,0,1,614145e-16,0,0,1,617708e-16,0,0,1,633717e-16,0,0,1,681648e-16,0,0,1,808291e-16,0,0,1,114608e-15,0,0,.999998,210507e-15,0,0,.999997,499595e-15,0,0,.999995,139897e-14,0,0,.999994,419818e-14,0,0,.999988,127042e-13,0,0,.999979,375153e-13,0,0,.999965,106206e-12,0,0,.999945,285381e-12,0,0,.999908,723611e-12,0,0,.999846,17255e-10,0,0,.999733,386104e-11,0,0,.999511,808493e-11,0,0,.998993,156884e-10,0,0,.997326,265538e-10,0,0,.989706,206466e-10,0,0,.981713,130756e-10,0,70005e-10,.973636,106473e-10,0,464797e-9,.966509,10194e-9,0,.00201743,.965149,165881e-10,0,.00497549,.962669,249147e-10,0,.00953262,.95786,317449e-10,0,.0158211,.949334,281045e-10,0,.0239343,.941041,303263e-10,0,.0339372,.931575,356754e-10,0,.0458738,.920102,397075e-10,0,.059772,.908002,384886e-10,0,.075645,.897269,43027e-9,0,.0934929,.884559,479925e-10,0,.113302,.869161,48246e-9,0,.135045,.853342,509505e-10,0,.158678,.837633,542846e-10,0,.184136,.820252,554139e-10,0,.211325,.801872,581412e-10,0,.240113,.782418,585535e-10,0,.270306,.7631,610923e-10,0,.301594,.742183,613678e-10,0,.333333,.721098,627275e-10,0,.365079,.699512,629413e-10,0,.396825,.677372,636351e-10,0,.428571,.655059,633555e-10,0,.460317,.632567,636513e-10,0,.492064,.609784,628965e-10,0,.52381,.587237,625546e-10,0,.555556,.564525,615825e-10,0,.587302,.542181,605048e-10,0,.619048,.520017,596329e-10,0,.650794,.498204,581516e-10,0,.68254,.476742,569186e-10,0,.714286,.455803,553833e-10,0,.746032,.435251,537807e-10,0,.777778,.415374,522025e-10,0,.809524,.395921,503421e-10,0,.84127,.377253,488211e-10,0,.873016,.359021,468234e-10,0,.904762,.341637,453269e-10,0,.936508,.3247,433014e-10,0,.968254,.308625,418007e-10,0,1,1,286798e-15,0,0,1,286877e-15,0,0,1,288094e-15,0,0,1,293506e-15,0,0,1,309262e-15,0,0,.999999,348593e-15,0,0,.999999,444582e-15,0,0,.999998,688591e-15,0,0,.999996,134391e-14,0,0,.999993,317438e-14,0,0,.999989,835609e-14,0,0,.999983,228677e-13,0,0,.999974,623361e-13,0,0,.999959,165225e-12,0,0,.999936,419983e-12,0,0,.999896,101546e-11,0,0,.99983,232376e-11,0,0,.999709,50156e-10,0,0,.999469,10167e-9,0,0,.998886,190775e-10,0,0,.996819,300511e-10,0,0,.988837,185092e-10,0,168222e-12,.982178,134622e-10,0,259622e-9,.975017,125961e-10,0,.00142595,.967101,13507e-9,0,.00382273,.964905,205003e-10,0,.00764164,.96218,29546e-9,0,.0130121,.956821,343738e-10,0,.0200253,.948829,305063e-10,0,.0287452,.941092,346487e-10,0,.039218,.931883,412061e-10,0,.0514748,.920211,444651e-10,0,.0655351,.907307,431252e-10,0,.0814082,.89684,490382e-10,0,.0990939,.884119,53334e-9,0,.118583,.869148,54114e-9,0,.139856,.853377,578536e-10,0,.162882,.836753,592285e-10,0,.187615,.820063,622787e-10,0,.213991,.801694,645492e-10,0,.241918,.782116,65353e-9,0,.271267,.762673,674344e-10,0,.301847,.742133,682788e-10,0,.333333,.720779,691959e-10,0,.365079,.699386,696817e-10,0,.396826,.67732,699583e-10,0,.428572,.654888,698447e-10,0,.460318,.632499,694063e-10,0,.492064,.609825,691612e-10,0,.52381,.587287,681576e-10,0,.555556,.564743,674138e-10,0,.587302,.542409,661617e-10,0,.619048,.520282,647785e-10,0,.650794,.498506,633836e-10,0,.68254,.477102,615905e-10,0,.714286,.456167,601013e-10,0,.746032,.435728,581457e-10,0,.777778,.415809,564215e-10,0,.809524,.396517,544997e-10,0,.84127,.377737,525061e-10,0,.873016,.359698,506831e-10,0,.904762,.342164,48568e-9,0,.936508,.325417,467826e-10,0,.968254,.309186,446736e-10,0,1,1,109018e-14,0,0,1,10904e-13,0,0,1,109393e-14,0,0,1,11095e-13,0,0,1,1154e-12,0,0,1,126089e-14,0,0,.999999,15059e-13,0,0,.999997,207899e-14,0,0,.999994,348164e-14,0,0,.999993,705728e-14,0,0,.999987,163692e-13,0,0,.999981,406033e-13,0,0,.999969,10245e-11,0,0,.999953,255023e-12,0,0,.999925,61511e-11,0,0,.999881,142218e-11,0,0,.99981,313086e-11,0,0,.99968,653119e-11,0,0,.999418,12832e-9,0,0,.998748,232497e-10,0,0,.996066,329522e-10,0,0,.988379,179613e-10,0,108799e-9,.982567,143715e-10,0,921302e-9,.976097,148096e-10,0,.00280738,.968475,178905e-10,0,.00596622,.964606,253921e-10,0,.0105284,.961564,348623e-10,0,.0165848,.955517,357612e-10,0,.0242,.948381,343493e-10,0,.03342,.941095,405849e-10,0,.0442777,.931923,475394e-10,0,.0567958,.91996,484328e-10,0,.0709879,.907419,502146e-10,0,.086861,.89618,561654e-10,0,.104415,.88337,587612e-10,0,.123643,.869046,618057e-10,0,.144531,.853278,657392e-10,0,.167057,.836091,66303e-9,0,.191188,.819644,704445e-10,0,.216878,.801246,714071e-10,0,.244062,.782031,740093e-10,0,.272649,.762066,74685e-9,0,.302509,.741964,766647e-10,0,.333442,.720554,766328e-10,0,.365079,.699098,777857e-10,0,.396826,.677189,774633e-10,0,.428572,.65484,776235e-10,0,.460318,.632496,770316e-10,0,.492064,.609908,762669e-10,0,.52381,.587312,753972e-10,0,.555556,.564938,739994e-10,0,.587302,.542577,728382e-10,0,.619048,.52062,71112e-9,0,.650794,.498819,694004e-10,0,.68254,.477555,675575e-10,0,.714286,.456568,653449e-10,0,.746032,.436278,636068e-10,0,.777778,.41637,613466e-10,0,.809524,.397144,594177e-10,0,.84127,.378412,570987e-10,0,.873016,.360376,550419e-10,0,.904762,.342906,527422e-10,0,.936508,.326136,506544e-10,0,.968254,.30997,484307e-10,0,1,1,354014e-14,0,0,1,354073e-14,0,0,1,354972e-14,0,0,1,358929e-14,0,0,1,370093e-14,0,0,.999999,396194e-14,0,0,.999998,453352e-14,0,0,.999997,578828e-14,0,0,.999994,863812e-14,0,0,.999991,153622e-13,0,0,.999985,316356e-13,0,0,.999977,712781e-13,0,0,.999964,166725e-12,0,0,.999945,390501e-12,0,0,.999912,895622e-12,0,0,.999866,198428e-11,0,0,.999786,421038e-11,0,0,.999647,850239e-11,0,0,.999356,162059e-10,0,0,.998563,282652e-10,0,0,.994928,336309e-10,0,244244e-10,.987999,178458e-10,0,523891e-9,.982893,159162e-10,0,.00194729,.977044,178056e-10,0,.00451099,.969972,230624e-10,0,.00835132,.964237,313922e-10,0,.013561,.960791,406145e-10,0,.0202056,.954292,372796e-10,0,.0283321,.948052,403199e-10,0,.0379739,.940938,479537e-10,0,.0491551,.931689,545292e-10,0,.0618918,.91987,54038e-9,0,.0761941,.907665,589909e-10,0,.0920672,.895281,642651e-10,0,.109511,.882621,659707e-10,0,.12852,.86873,709973e-10,0,.149085,.853008,742221e-10,0,.171189,.835944,761754e-10,0,.194809,.818949,797052e-10,0,.21991,.800951,812434e-10,0,.246447,.781847,838075e-10,0,.274352,.761649,84501e-9,0,.303535,.74152,860258e-10,0,.333857,.720495,866233e-10,0,.365104,.698742,868326e-10,0,.396826,.677096,87133e-9,0,.428572,.654782,863497e-10,0,.460318,.632335,860206e-10,0,.492064,.610031,849337e-10,0,.52381,.587457,838279e-10,0,.555556,.56513,82309e-9,0,.587302,.542877,803542e-10,0,.619048,.5209,786928e-10,0,.650794,.499291,765171e-10,0,.68254,.477971,744753e-10,0,.714286,.457221,72209e-9,0,.746032,.436803,697448e-10,0,.777778,.417083,675333e-10,0,.809524,.397749,648058e-10,0,.84127,.379177,625759e-10,0,.873016,.361061,598584e-10,0,.904762,.343713,575797e-10,0,.936508,.326894,549999e-10,0,.968254,.310816,527482e-10,0,1,1,10153e-12,0,0,1,101544e-13,0,0,1,101751e-13,0,0,1,102662e-13,0,0,1,10521e-12,0,0,.999999,111049e-13,0,0,.999999,123408e-13,0,0,.999996,14924e-12,0,0,.999992,204471e-13,0,0,.999989,326539e-13,0,0,.99998,603559e-13,0,0,.999971,123936e-12,0,0,.999955,269058e-12,0,0,.999933,593604e-12,0,0,.999901,129633e-11,0,0,.999847,275621e-11,0,0,.999761,564494e-11,0,0,.999607,110485e-10,0,0,.999282,204388e-10,0,0,.99831,341084e-10,0,22038e-11,.993288,294949e-10,0,242388e-9,.987855,192736e-10,0,.0012503,.983167,182383e-10,0,.0032745,.977908,218633e-10,0,.00646321,.971194,290662e-10,0,.0109133,.963867,386401e-10,0,.0166927,.95982,462827e-10,0,.0238494,.953497,420705e-10,0,.0324178,.947621,477743e-10,0,.0424225,.940611,568258e-10,0,.0538808,.931174,618061e-10,0,.0668047,.919919,627098e-10,0,.0812014,.907856,694714e-10,0,.0970745,.894509,735008e-10,0,.114424,.881954,763369e-10,0,.133246,.868309,821896e-10,0,.153534,.852511,83769e-9,0,.175275,.835821,881615e-10,0,.198453,.817981,896368e-10,0,.223042,.800504,930906e-10,0,.249009,.78141,945056e-10,0,.276304,.761427,963605e-10,0,.304862,.74094,968088e-10,0,.334584,.720233,981481e-10,0,.365322,.698592,979122e-10,0,.396826,.676763,981057e-10,0,.428571,.654808,973956e-10,0,.460318,.632326,962619e-10,0,.492064,.610049,952996e-10,0,.52381,.58763,933334e-10,0,.555556,.565261,917573e-10,0,.587302,.543244,896636e-10,0,.619048,.521273,873304e-10,0,.650794,.499818,852648e-10,0,.68254,.478536,823961e-10,0,.714286,.457826,79939e-9,0,.746032,.437549,77126e-9,0,.777778,.41776,743043e-10,0,.809524,.39863,716426e-10,0,.84127,.379954,686456e-10,0,.873016,.362025,660514e-10,0,.904762,.344581,630755e-10,0,.936508,.327909,605439e-10,0,.968254,.311736,576345e-10,0,1,1,263344e-13,0,0,1,263373e-13,0,0,1,263815e-13,0,0,1,265753e-13,0,0,1,271132e-13,0,0,.999999,283279e-13,0,0,.999997,30833e-12,0,0,.999995,358711e-13,0,0,.999992,461266e-13,0,0,.999985,67574e-12,0,0,.999977,11358e-11,0,0,.999966,213657e-12,0,0,.999948,431151e-12,0,0,.999923,896656e-12,0,0,.999884,186603e-11,0,0,.999826,381115e-11,0,0,.999732,754184e-11,0,0,.999561,143192e-10,0,0,.999191,257061e-10,0,0,.997955,405724e-10,0,744132e-10,.992228,276537e-10,0,716477e-9,.987638,208885e-10,0,.0022524,.983395,215226e-10,0,.00484816,.978614,270795e-10,0,.00860962,.972389,365282e-10,0,.0136083,.964392,474747e-10,0,.0198941,.95861,509141e-10,0,.0275023,.952806,48963e-9,0,.0364584,.94712,571119e-10,0,.04678,.940104,671704e-10,0,.0584799,.930398,687586e-10,0,.0715665,.919866,738161e-10,0,.086045,.907853,813235e-10,0,.101918,.894078,834582e-10,0,.119186,.881177,892093e-10,0,.137845,.867575,944548e-10,0,.157891,.852107,969607e-10,0,.179316,.835502,101456e-9,0,.202106,.81756,103256e-9,0,.226243,.79984,106954e-9,0,.251704,.780998,108066e-9,0,.278451,.761132,110111e-9,0,.306436,.740429,110459e-9,0,.335586,.719836,111219e-9,0,.365796,.698467,11145e-8,0,.3969,.676446,110393e-9,0,.428571,.654635,110035e-9,0,.460318,.632411,108548e-9,0,.492064,.609986,106963e-9,0,.52381,.587872,105238e-9,0,.555556,.565528,102665e-9,0,.587302,.543563,100543e-9,0,.619048,.52176,976182e-10,0,.650794,.500188,947099e-10,0,.68254,.479204,919929e-10,0,.714286,.458413,886139e-10,0,.746032,.438314,857839e-10,0,.777778,.418573,82411e-9,0,.809524,.39947,792211e-10,0,.84127,.380892,759546e-10,0,.873016,.362953,727571e-10,0,.904762,.345601,695738e-10,0,.936508,.328895,664907e-10,0,.968254,.312808,634277e-10,0,1,1,628647e-13,0,0,1,628705e-13,0,0,1,629587e-13,0,0,1,633441e-13,0,0,.999999,644087e-13,0,0,.999998,667856e-13,0,0,.999997,715889e-13,0,0,.999995,809577e-13,0,0,.999989,992764e-13,0,0,.999983,135834e-12,0,0,.999974,210482e-12,0,0,.999959,365215e-12,0,0,.999939,686693e-12,0,0,.999911,13472e-10,0,0,.999868,26731e-10,0,0,.999804,524756e-11,0,0,.9997,100403e-10,0,0,.99951,185019e-10,0,0,.999078,322036e-10,0,620676e-11,.997428,470002e-10,0,341552e-9,.99162,287123e-10,0,.00143727,.987479,234706e-10,0,.00349201,.983582,260083e-10,0,.0066242,.979186,337927e-10,0,.0109113,.97325,454689e-10,0,.0164064,.965221,573759e-10,0,.0231463,.957262,544114e-10,0,.0311571,.952211,587006e-10,0,.0404572,.946631,692256e-10,0,.0510592,.939391,787819e-10,0,.0629723,.929795,792368e-10,0,.0762025,.91965,875075e-10,0,.090753,.907737,950903e-10,0,.106626,.893899,972963e-10,0,.123822,.880239,10459e-8,0,.142337,.866562,107689e-9,0,.16217,.85164,113081e-9,0,.183314,.835021,116636e-9,0,.20576,.817311,120074e-9,0,.229496,.798845,121921e-9,0,.254502,.780479,12475e-8,0,.280753,.760694,125255e-9,0,.308212,.740142,126719e-9,0,.336825,.719248,12636e-8,0,.366517,.698209,126712e-9,0,.397167,.676398,125769e-9,0,.428578,.654378,124432e-9,0,.460318,.632484,123272e-9,0,.492064,.610113,12085e-8,0,.52381,.587931,118411e-9,0,.555556,.565872,11569e-8,0,.587302,.543814,112521e-9,0,.619048,.522265,109737e-9,0,.650794,.500835,106228e-9,0,.68254,.479818,102591e-9,0,.714286,.459258,991288e-10,0,.746032,.439061,952325e-10,0,.777778,.419552,91895e-9,0,.809524,.400399,879051e-10,0,.84127,.381976,844775e-10,0,.873016,.364009,806316e-10,0,.904762,.346761,771848e-10,0,.936508,.330049,735429e-10,0,.968254,.314018,702103e-10,0,1,1,139968e-12,0,0,1,139979e-12,0,0,1,140145e-12,0,0,1,14087e-11,0,0,.999999,142865e-12,0,0,.999998,147279e-12,0,0,.999997,156057e-12,0,0,.999992,17276e-11,0,0,.999989,204352e-12,0,0,.99998,26494e-11,0,0,.999969,383435e-12,0,0,.999953,618641e-12,0,0,.999929,108755e-11,0,0,.999898,201497e-11,0,0,.999849,381346e-11,0,0,.999778,719815e-11,0,0,.999661,133215e-10,0,0,.999451,238313e-10,0,0,.998936,401343e-10,0,113724e-9,.99662,517346e-10,0,820171e-9,.991094,304323e-10,0,.00238143,.987487,281757e-10,0,.00493527,.983731,320048e-10,0,.00856859,.979647,423905e-10,0,.0133393,.973837,562935e-10,0,.0192863,.96584,677442e-10,0,.0264369,.956309,623073e-10,0,.03481,.951523,704131e-10,0,.0444184,.946003,836594e-10,0,.0552713,.938454,911736e-10,0,.0673749,.929279,938264e-10,0,.0807329,.919239,103754e-9,0,.0953479,.907293,109928e-9,0,.111221,.893936,115257e-9,0,.128352,.879674,122265e-9,0,.14674,.865668,125733e-9,0,.166382,.850998,132305e-9,0,.187276,.834498,134844e-9,0,.209413,.816903,139276e-9,0,.232786,.798235,140984e-9,0,.257382,.779724,14378e-8,0,.283181,.760251,144623e-9,0,.310156,.739808,145228e-9,0,.338269,.718762,14539e-8,0,.367461,.697815,144432e-9,0,.397646,.67631,143893e-9,0,.428685,.654278,141846e-9,0,.460318,.632347,13935e-8,0,.492064,.610296,137138e-9,0,.52381,.588039,133806e-9,0,.555556,.566218,130755e-9,0,.587302,.544346,127128e-9,0,.619048,.522701,123002e-9,0,.650794,.501542,119443e-9,0,.68254,.480508,115055e-9,0,.714286,.460092,111032e-9,0,.746032,.440021,106635e-9,0,.777778,.420446,102162e-9,0,.809524,.401512,98184e-9,0,.84127,.38299,936497e-10,0,.873016,.365232,89813e-9,0,.904762,.347865,853073e-10,0,.936508,.331342,817068e-10,0,.968254,.315202,773818e-10,0,1,1,29368e-11,0,0,1,2937e-10,0,0,1,293998e-12,0,0,1,295298e-12,0,0,.999999,298865e-12,0,0,.999998,3067e-10,0,0,.999995,322082e-12,0,0,.999992,350767e-12,0,0,.999986,403538e-12,0,0,.999976,501372e-12,0,0,.999964,68562e-11,0,0,.999945,10374e-10,0,0,.999919,171269e-11,0,0,.999882,300175e-11,0,0,.999829,542144e-11,0,0,.999749,984182e-11,0,0,.99962,176213e-10,0,0,.999382,305995e-10,0,138418e-10,.998751,496686e-10,0,389844e-9,.995344,510733e-10,0,.00150343,.990768,345829e-10,0,.00352451,.987464,342841e-10,0,.00655379,.983846,399072e-10,0,.0106554,.980007,533219e-10,0,.0158723,.974494,696992e-10,0,.0222333,.96622,776754e-10,0,.029758,.956273,747718e-10,0,.0384596,.950952,864611e-10,0,.0483473,.945215,100464e-9,0,.0594266,.937287,103729e-9,0,.0717019,.928649,111665e-9,0,.0851752,.918791,12353e-8,0,.0998479,.906685,127115e-9,0,.115721,.893706,13628e-8,0,.132794,.879248,142427e-9,0,.151067,.864685,148091e-9,0,.170538,.850032,153517e-9,0,.191204,.833853,157322e-9,0,.213063,.816353,161086e-9,0,.236107,.797834,164111e-9,0,.260329,.778831,165446e-9,0,.285714,.759756,167492e-9,0,.312243,.739419,166928e-9,0,.339887,.718491,167e-6,0,.368604,.697392,165674e-9,0,.398329,.676102,163815e-9,0,.428961,.654243,162003e-9,0,.460331,.632176,158831e-9,0,.492064,.610407,155463e-9,0,.52381,.588394,152062e-9,0,.555556,.56645,147665e-9,0,.587302,.5449,14375e-8,0,.619048,.523276,138905e-9,0,.650794,.502179,134189e-9,0,.68254,.481359,129392e-9,0,.714286,.46092,124556e-9,0,.746032,.441084,11957e-8,0,.777778,.421517,114652e-9,0,.809524,.402721,109688e-9,0,.84127,.384222,104667e-9,0,.873016,.366534,999633e-10,0,.904762,.349205,950177e-10,0,.936508,.332702,907301e-10,0,.968254,.316599,859769e-10,0,1,1,585473e-12,0,0,1,585507e-12,0,0,1,58602e-11,0,0,.999999,588259e-12,0,0,.999999,594381e-12,0,0,.999998,607754e-12,0,0,.999995,633729e-12,0,0,.99999,68137e-11,0,0,.999984,767003e-12,0,0,.999973,921212e-12,0,0,.999959,120218e-11,0,0,.999936,172024e-11,0,0,.999907,268088e-11,0,0,.999866,445512e-11,0,0,.999806,768481e-11,0,0,.999716,1342e-8,0,0,.999576,232473e-10,0,0,.9993,391694e-10,0,129917e-9,.998498,608429e-10,0,845035e-9,.994132,489743e-10,0,.00237616,.99031,384644e-10,0,.00484456,.987409,421768e-10,0,.00832472,.983981,504854e-10,0,.0128643,.980268,671028e-10,0,.0184947,.974875,852749e-10,0,.025237,.966063,85531e-9,0,.0331046,.956779,900588e-10,0,.0421067,.950259,10577e-8,0,.0522487,.944239,119458e-9,0,.0635343,.936341,122164e-9,0,.0759654,.928047,134929e-9,0,.0895434,.918065,145544e-9,0,.104269,.906267,150531e-9,0,.120142,.893419,161652e-9,0,.137163,.878758,16593e-8,0,.15533,.863699,174014e-9,0,.174645,.848876,177877e-9,0,.195106,.833032,184049e-9,0,.21671,.815557,186088e-9,0,.239454,.797323,19054e-8,0,.263332,.778124,191765e-9,0,.288336,.758929,192535e-9,0,.314451,.738979,192688e-9,0,.341658,.718213,191522e-9,0,.369924,.696947,190491e-9,0,.399202,.675807,187913e-9,0,.429416,.654147,184451e-9,0,.460447,.63229,181442e-9,0,.492064,.610499,177139e-9,0,.523809,.588747,172596e-9,0,.555555,.566783,167457e-9,0,.587301,.545359,162518e-9,0,.619048,.523984,156818e-9,0,.650794,.502917,151884e-9,0,.68254,.482294,145514e-9,0,.714286,.461945,140199e-9,0,.746032,.442133,134101e-9,0,.777778,.422705,128374e-9,0,.809524,.403916,122996e-9,0,.84127,.38554,116808e-9,0,.873016,.367909,111973e-9,0,.904762,.350651,105938e-9,0,.936508,.334208,101355e-9,0,.968254,.318123,957629e-10,0,1,1,111633e-11,0,0,1,111639e-11,0,0,1,111725e-11,0,0,1,112096e-11,0,0,.999999,11311e-10,0,0,.999997,115315e-11,0,0,.999995,11956e-10,0,0,.999989,127239e-11,0,0,.999981,140772e-11,0,0,.999969,164541e-11,0,0,.999952,206607e-11,0,0,.999928,281783e-11,0,0,.999895,416835e-11,0,0,.999848,658728e-11,0,0,.999781,108648e-10,0,0,.999682,182579e-10,0,0,.999523,306003e-10,0,159122e-10,.999205,499862e-10,0,391184e-9,.998131,73306e-9,0,.00147534,.993334,513229e-10,0,.0034227,.99016,467783e-10,0,.00632232,.987321,523413e-10,0,.0102295,.984099,64267e-9,0,.0151794,.980432,843042e-10,0,.0211947,.974976,102819e-9,0,.0282899,.966429,996234e-10,0,.0364739,.957633,111074e-9,0,.0457522,.949422,128644e-9,0,.0561278,.943045,140076e-9,0,.0676023,.935448,146349e-9,0,.0801762,.927225,161854e-9,0,.0938499,.917033,169135e-9,0,.108623,.905762,179987e-9,0,.124496,.892879,189832e-9,0,.141469,.878435,195881e-9,0,.159541,.863114,20466e-8,0,.178713,.84776,209473e-9,0,.198985,.832084,214861e-9,0,.220355,.814915,217695e-9,0,.242823,.796711,220313e-9,0,.266385,.777603,22313e-8,0,.291036,.757991,222471e-9,0,.316767,.738371,222869e-9,0,.343563,.717872,221243e-9,0,.371402,.696619,218089e-9,0,.400248,.675379,21562e-8,0,.430047,.65411,21169e-8,0,.460709,.63241,206947e-9,0,.492079,.61046,201709e-9,0,.52381,.58903,196753e-9,0,.555556,.567267,189637e-9,0,.587302,.545886,184735e-9,0,.619048,.524714,177257e-9,0,.650794,.503789,171424e-9,0,.68254,.483204,164688e-9,0,.714286,.462976,157172e-9,0,.746032,.443294,151341e-9,0,.777778,.423988,143737e-9,0,.809524,.405325,138098e-9,0,.84127,.386981,130698e-9,0,.873016,.369436,125276e-9,0,.904762,.35219,118349e-9,0,.936508,.335804,11312e-8,0,.968254,.319749,106687e-9,0,1,1,204685e-11,0,0,1,204694e-11,0,0,1,204831e-11,0,0,.999999,205428e-11,0,0,.999999,207056e-11,0,0,.999997,210581e-11,0,0,.999993,21732e-10,0,0,.999987,229365e-11,0,0,.999979,250243e-11,0,0,.999965,286127e-11,0,0,.999947,348028e-11,0,0,.999918,455588e-11,0,0,.999881,643303e-11,0,0,.999828,970064e-11,0,0,.999753,153233e-10,0,0,.999642,24793e-9,0,0,.999464,402032e-10,0,122947e-9,.999089,635852e-10,0,807414e-9,.997567,857026e-10,0,.00227206,.992903,594912e-10,0,.00462812,.990011,578515e-10,0,.00794162,.987192,65399e-9,0,.0122534,.98418,819675e-10,0,.0175888,.980491,105514e-9,0,.0239635,.974779,121532e-9,0,.031387,.96675,119144e-9,0,.0398644,.958248,136125e-9,0,.0493982,.948884,155408e-9,0,.0599896,.941673,162281e-9,0,.0716382,.934521,176754e-9,0,.0843437,.926205,192873e-9,0,.0981056,.916089,200038e-9,0,.112923,.904963,213624e-9,0,.128796,.892089,221834e-9,0,.145725,.878028,232619e-9,0,.163709,.86249,238632e-9,0,.182749,.846587,247002e-9,0,.202847,.830988,250702e-9,0,.224001,.814165,255562e-9,0,.246214,.796135,257505e-9,0,.269482,.777052,258625e-9,0,.293805,.757201,258398e-9,0,.319176,.737655,256714e-9,0,.345587,.717477,255187e-9,0,.373021,.696433,251792e-9,0,.401454,.675084,247223e-9,0,.430844,.653907,242213e-9,0,.461125,.632561,237397e-9,0,.492187,.610658,229313e-9,0,.52381,.589322,224402e-9,0,.555556,.567857,216116e-9,0,.587302,.54652,209124e-9,0,.619048,.525433,201601e-9,0,.650794,.504679,192957e-9,0,.68254,.484203,186052e-9,0,.714286,.464203,177672e-9,0,.746032,.444549,170005e-9,0,.777778,.425346,162401e-9,0,.809524,.406706,1544e-7,0,.84127,.388576,147437e-9,0,.873016,.37094,139493e-9,0,.904762,.353996,133219e-9,0,.936508,.337391,125573e-9,0,.968254,.321648,119867e-9,0,1,1,362511e-11,0,0,1,362525e-11,0,0,1,362739e-11,0,0,.999999,363673e-11,0,0,.999998,366214e-11,0,0,.999996,371698e-11,0,0,.999992,382116e-11,0,0,.999986,400554e-11,0,0,.999976,432058e-11,0,0,.999961,485194e-11,0,0,.999938,574808e-11,0,0,.999908,726643e-11,0,0,.999865,984707e-11,0,0,.999807,142217e-10,0,0,.999723,215581e-10,0,0,.999602,336114e-10,0,119113e-10,.999398,527353e-10,0,355813e-9,.998946,805809e-10,0,.00137768,.996647,942908e-10,0,.00322469,.992298,668733e-10,0,.00597897,.989802,716564e-10,0,.00968903,.987019,821355e-10,0,.0143845,.984219,104555e-9,0,.0200831,.980425,131245e-9,0,.0267948,.974241,139613e-9,0,.034525,.967006,145931e-9,0,.0432757,.95893,167153e-9,0,.0530471,.949157,188146e-9,0,.0638386,.94062,194625e-9,0,.0756487,.933509,213721e-9,0,.0884762,.925088,229616e-9,0,.10232,.915178,239638e-9,0,.117178,.904093,254814e-9,0,.133051,.891337,263685e-9,0,.149939,.877326,274789e-9,0,.167841,.861794,280534e-9,0,.18676,.845758,289534e-9,0,.206696,.829792,294446e-9,0,.22765,.813037,296877e-9,0,.249625,.795285,300217e-9,0,.27262,.776323,299826e-9,0,.296636,.756673,299787e-9,0,.321671,.736856,297867e-9,0,.347718,.716883,294052e-9,0,.374768,.696089,289462e-9,0,.402804,.67505,285212e-9,0,.431796,.653509,27653e-8,0,.461695,.63258,271759e-9,0,.49242,.61104,262811e-9,0,.523822,.589567,255151e-9,0,.555556,.568322,246434e-9,0,.587302,.547235,237061e-9,0,.619048,.52616,228343e-9,0,.650794,.505716,219236e-9,0,.68254,.485274,209595e-9,0,.714286,.465411,201011e-9,0,.746032,.445854,19109e-8,0,.777778,.426911,182897e-9,0,.809524,.408222,173569e-9,0,.84127,.390307,165496e-9,0,.873016,.372624,156799e-9,0,.904762,.355804,14917e-8,0,.936508,.33924,140907e-9,0,.968254,.323534,134062e-9,0,1,1,622487e-11,0,0,1,62251e-10,0,0,1,622837e-11,0,0,.999999,624259e-11,0,0,.999998,628127e-11,0,0,.999996,636451e-11,0,0,.999991,65218e-10,0,0,.999984,679782e-11,0,0,.999973,726361e-11,0,0,.999955,803644e-11,0,0,.999931,931397e-11,0,0,.999896,114299e-10,0,0,.999847,149402e-10,0,0,.999784,207461e-10,0,0,.999692,302493e-10,0,0,.999554,454957e-10,0,997275e-10,.999326,690762e-10,0,724813e-9,.998757,101605e-9,0,.0020972,.995367,958745e-10,0,.00432324,.99209,832808e-10,0,.00746347,.989517,887601e-10,0,.0115534,.987008,10564e-8,0,.0166134,.98421,133179e-9,0,.0226552,.98021,161746e-9,0,.0296838,.973676,161821e-9,0,.0377016,.967052,178635e-9,0,.0467079,.959385,206765e-9,0,.0567013,.949461,22476e-8,0,.0676796,.939578,23574e-8,0,.0796403,.932416,25893e-8,0,.0925812,.923759,271228e-9,0,.106501,.914223,289165e-9,0,.121397,.902942,301156e-9,0,.13727,.890419,313852e-9,0,.15412,.876639,324408e-9,0,.171946,.861316,33249e-8,0,.190751,.84496,338497e-9,0,.210537,.828427,345861e-9,0,.231305,.811871,347863e-9,0,.253057,.794397,350225e-9,0,.275797,.775726,349915e-9,0,.299525,.75617,347297e-9,0,.324242,.736091,344232e-9,0,.349947,.716213,340835e-9,0,.376633,.695736,332369e-9,0,.404289,.674961,327943e-9,0,.432895,.653518,318533e-9,0,.462415,.632574,310391e-9,0,.492788,.61134,300755e-9,0,.523909,.590017,290506e-9,0,.555556,.568752,280446e-9,0,.587302,.548061,269902e-9,0,.619048,.52711,258815e-9,0,.650794,.506682,248481e-9,0,.68254,.486524,237141e-9,0,.714286,.466812,226872e-9,0,.746032,.44732,216037e-9,0,.777778,.428473,205629e-9,0,.809524,.409921,195691e-9,0,.84127,.392028,185457e-9,0,.873016,.374606,176436e-9,0,.904762,.357601,166508e-9,0,.936508,.341348,158385e-9,0,.968254,.32542,149203e-9,0,1,1,103967e-10,0,0,1,10397e-9,0,0,1,104019e-10,0,0,.999999,104231e-10,0,0,.999998,104806e-10,0,0,.999995,106042e-10,0,0,.999991,108366e-10,0,0,.999982,112415e-10,0,0,.999968,119174e-10,0,0,.99995,130227e-10,0,0,.999922,148176e-10,0,0,.999884,177303e-10,0,0,.99983,224564e-10,0,0,.999758,300966e-10,0,0,.999654,423193e-10,0,549083e-11,.999503,614848e-10,0,296087e-9,.999237,903576e-10,0,.00123144,.998491,1271e-7,0,.00295954,.994594,107754e-9,0,.00555829,.99178,103025e-9,0,.00907209,.989265,11154e-8,0,.0135257,.986998,136296e-9,0,.0189327,.984137,169154e-9,0,.0252993,.979798,196671e-9,0,.0326272,.97337,196678e-9,0,.0409157,.967239,223121e-9,0,.0501623,.959543,253809e-9,0,.0603638,.949466,265972e-9,0,.0715171,.939074,288372e-9,0,.0836187,.931118,310983e-9,0,.0966657,.922525,325561e-9,0,.110656,.912983,345725e-9,0,.125588,.901617,3556e-7,0,.141461,.889487,374012e-9,0,.158275,.875787,383445e-9,0,.176031,.860654,393972e-9,0,.19473,.844417,400311e-9,0,.214374,.82741,405004e-9,0,.234967,.810545,407378e-9,0,.256512,.793312,407351e-9,0,.279011,.774847,406563e-9,0,.302468,.755621,404903e-9,0,.326887,.735511,397486e-9,0,.352266,.715435,39357e-8,0,.378605,.695403,384739e-9,0,.405897,.674681,376108e-9,0,.43413,.65359,365997e-9,0,.463277,.632471,354957e-9,0,.493295,.61151,343593e-9,0,.524106,.59064,331841e-9,0,.555561,.569386,318891e-9,0,.587302,.548785,3072e-7,0,.619048,.528146,29361e-8,0,.650794,.507872,281709e-9,0,.68254,.487805,268627e-9,0,.714286,.468196,255887e-9,0,.746032,.448922,243997e-9,0,.777778,.430093,231662e-9,0,.809524,.411845,220339e-9,0,.84127,.393808,208694e-9,0,.873016,.376615,198045e-9,0,.904762,.359655,187375e-9,0,.936508,.343452,177371e-9,0,.968254,.32765,167525e-9,0,1,1,169351e-10,0,0,1,169356e-10,0,0,1,169427e-10,0,0,.999999,169736e-10,0,0,.999998,170575e-10,0,0,.999995,172372e-10,0,0,.99999,175739e-10,0,0,.999979,181568e-10,0,0,.999966,191206e-10,0,0,.999944,20677e-9,0,0,.999912,231644e-10,0,0,.999869,271268e-10,0,0,.999811,334272e-10,0,0,.99973,433979e-10,0,0,.999617,590083e-10,0,680315e-10,.999445,829497e-10,0,612796e-9,.999138,118019e-9,0,.00187408,.998095,156712e-9,0,.00395791,.993919,125054e-9,0,.00692144,.991333,126091e-9,0,.0107962,.989226,144912e-9,0,.0155986,.986954,175737e-9,0,.0213364,.983982,213883e-9,0,.0280114,.979128,234526e-9,0,.0356226,.973327,243725e-9,0,.0441668,.967416,2773e-7,0,.0536399,.959729,308799e-9,0,.0640376,.949758,322447e-9,0,.0753554,.939173,350021e-9,0,.0875893,.9296,370089e-9,0,.100736,.921181,391365e-9,0,.114793,.91164,413636e-9,0,.129759,.900435,427068e-9,0,.145632,.888183,441046e-9,0,.162412,.874772,454968e-9,0,.180101,.859566,461882e-9,0,.1987,.843579,471556e-9,0,.218213,.826453,474335e-9,0,.238641,.809164,477078e-9,0,.259989,.792179,47755e-8,0,.282262,.773866,472573e-9,0,.305464,.754944,469765e-9,0,.329599,.735133,462371e-9,0,.35467,.714858,453674e-9,0,.380678,.694829,443888e-9,0,.407622,.674453,432052e-9,0,.435493,.653685,420315e-9,0,.464275,.632666,406829e-9,0,.493938,.611676,392234e-9,0,.524422,.591193,379208e-9,0,.555624,.570145,36319e-8,0,.587302,.549566,349111e-9,0,.619048,.529278,334166e-9,0,.650794,.509026,318456e-9,0,.68254,.489186,30449e-8,0,.714286,.469662,289051e-9,0,.746032,.450691,275494e-9,0,.777778,.431841,261437e-9,0,.809524,.413752,247846e-9,0,.84127,.395951,235085e-9,0,.873016,.378633,222245e-9,0,.904762,.36194,210533e-9,0,.936508,.345599,198494e-9,0,.968254,.329999,188133e-9,0,1,1,269663e-10,0,0,1,26967e-9,0,0,1,269772e-10,0,0,.999999,270214e-10,0,0,.999998,271415e-10,0,0,.999994,27398e-9,0,0,.999988,278771e-10,0,0,.999977,287019e-10,0,0,.999961,300544e-10,0,0,.999937,322138e-10,0,0,.999904,356163e-10,0,0,.999854,409465e-10,0,0,.99979,492651e-10,0,0,.999699,621722e-10,0,88288e-11,.999572,819715e-10,0,223369e-9,.999381,111689e-9,0,.00105414,.999016,153862e-9,0,.0026493,.997437,187667e-9,0,.00508608,.993545,155672e-9,0,.00840554,.991135,161455e-9,0,.012629,.989157,188241e-9,0,.0177661,.986874,226229e-9,0,.0238198,.983714,268668e-9,0,.0307887,.978301,277109e-9,0,.0386688,.973227,303446e-9,0,.0474554,.967317,341851e-9,0,.0571428,.959477,370885e-9,0,.0677256,.950012,392753e-9,0,.0791988,.939484,42781e-8,0,.0915576,.928135,443866e-9,0,.104798,.919819,472959e-9,0,.118918,.910049,491551e-9,0,.133915,.899181,512616e-9,0,.149788,.886881,523563e-9,0,.166537,.87359,540183e-9,0,.184164,.858613,547386e-9,0,.202669,.842809,554809e-9,0,.222056,.825727,558316e-9,0,.242329,.808086,557824e-9,0,.263492,.790728,556346e-9,0,.285551,.772987,552672e-9,0,.30851,.7541,543738e-9,0,.332376,.734669,536107e-9,0,.357153,.714411,523342e-9,0,.382845,.694196,512238e-9,0,.409454,.674252,497465e-9,0,.436977,.65357,481096e-9,0,.465404,.632999,467054e-9,0,.494713,.611994,448771e-9,0,.524864,.591604,431889e-9,0,.555779,.571134,415238e-9,0,.587302,.550528,396369e-9,0,.619048,.530292,379477e-9,0,.650794,.510364,361488e-9,0,.68254,.490749,343787e-9,0,.714286,.471266,327822e-9,0,.746032,.452462,310626e-9,0,.777778,.433907,295352e-9,0,.809524,.415659,279179e-9,0,.84127,.398138,264685e-9,0,.873016,.380833,249905e-9,0,.904762,.364247,236282e-9,0,.936508,.348041,222905e-9,0,.968254,.332389,210522e-9,0,1,1,420604e-10,0,0,1,420614e-10,0,0,1,420757e-10,0,0,.999999,42138e-9,0,0,.999997,423067e-10,0,0,.999993,426668e-10,0,0,.999986,433372e-10,0,0,.999974,444857e-10,0,0,.999956,463554e-10,0,0,.99993,493105e-10,0,0,.999892,539077e-10,0,0,.999838,610005e-10,0,0,.999767,718822e-10,0,0,.999666,884581e-10,0,365471e-10,.999525,113398e-9,0,485623e-9,.999311,150043e-9,0,.00162096,.998865,200063e-9,0,.00355319,.996278,211014e-9,0,.00633818,.992956,189672e-9,0,.0100043,.991017,210262e-9,0,.0145648,.989055,244292e-9,0,.0200237,.986741,290481e-9,0,.0263798,.983288,334303e-9,0,.033629,.977784,340307e-9,0,.0417652,.973037,377864e-9,0,.0507821,.967181,4239e-7,0,.060673,.958971,443854e-9,0,.0714314,.950093,483039e-9,0,.0830518,.939552,517934e-9,0,.0955288,.927678,539449e-9,0,.108859,.918278,568604e-9,0,.123038,.908449,588505e-9,0,.138065,.897713,612473e-9,0,.153938,.885533,625575e-9,0,.170657,.872131,63854e-8,0,.188224,.857517,647034e-9,0,.20664,.841796,65209e-8,0,.225909,.824726,6544e-7,0,.246035,.807297,655744e-9,0,.267022,.789058,646716e-9,0,.288878,.77189,643898e-9,0,.311607,.753082,629973e-9,0,.335216,.7341,621564e-9,0,.359713,.714094,605171e-9,0,.385103,.693839,588752e-9,0,.41139,.673891,573294e-9,0,.438576,.653565,552682e-9,0,.466656,.633326,533446e-9,0,.495617,.612582,514635e-9,0,.525431,.59205,49303e-8,0,.556041,.571918,471842e-9,0,.587338,.551572,451713e-9,0,.619048,.531553,430049e-9,0,.650794,.51175,410445e-9,0,.68254,.49238,390098e-9,0,.714286,.473143,370033e-9,0,.746032,.45423,351205e-9,0,.777778,.435963,332049e-9,0,.809524,.41787,315021e-9,0,.84127,.400387,297315e-9,0,.873016,.383332,281385e-9,0,.904762,.366665,265397e-9,0,.936508,.350633,250601e-9,0,.968254,.334964,23589e-8,0,1,1,643736e-10,0,0,1,64375e-9,0,0,1,643947e-10,0,0,.999999,64481e-9,0,0,.999997,647143e-10,0,0,.999994,652119e-10,0,0,.999985,661359e-10,0,0,.999972,677116e-10,0,0,.999952,702599e-10,0,0,.999922,742517e-10,0,0,.99988,803906e-10,0,0,.99982,897315e-10,0,0,.999741,103838e-9,0,0,.999629,12496e-8,0,149024e-9,.999474,156161e-9,0,861027e-9,.999229,201034e-9,0,.00231198,.998662,259069e-9,0,.00458147,.995299,245439e-9,0,.00770895,.992732,24498e-8,0,.0117126,.990847,273211e-9,0,.0165989,.988911,316492e-9,0,.0223674,.98654,37161e-8,0,.0290135,.982636,410352e-9,0,.0365309,.977346,421756e-9,0,.0449117,.972909,475578e-9,0,.0541481,.966821,522482e-9,0,.0642326,.958686,545008e-9,0,.075158,.949754,589286e-9,0,.0869181,.939184,619995e-9,0,.0995074,.927505,654266e-9,0,.112922,.916606,682362e-9,0,.127157,.906707,704286e-9,0,.142212,.895937,725909e-9,0,.158085,.883913,743939e-9,0,.174776,.870642,755157e-9,0,.192287,.856241,764387e-9,0,.210619,.84069,771032e-9,0,.229775,.823728,765906e-9,0,.249761,.806481,767604e-9,0,.270582,.787924,754385e-9,0,.292243,.770588,749668e-9,0,.314753,.751991,731613e-9,0,.338118,.733407,717655e-9,0,.362347,.713688,700604e-9,0,.387447,.693595,678765e-9,0,.413424,.673426,657042e-9,0,.440284,.65359,635892e-9,0,.468027,.633576,611569e-9,0,.496645,.613144,586011e-9,0,.526122,.592711,563111e-9,0,.556417,.572722,537699e-9,0,.587451,.552762,512556e-9,0,.619048,.532985,489757e-9,0,.650794,.513219,464139e-9,0,.68254,.493992,442193e-9,0,.714286,.47509,418629e-9,0,.746032,.456287,397045e-9,0,.777778,.438152,375504e-9,0,.809524,.420294,35492e-8,0,.84127,.402749,335327e-9,0,.873016,.385879,316422e-9,0,.904762,.369352,298333e-9,0,.936508,.353301,281417e-9,0,.968254,.337781,265203e-9,0,1,1,968267e-10,0,0,1,968284e-10,0,0,1,968556e-10,0,0,.999999,969733e-10,0,0,.999997,972913e-10,0,0,.999993,979688e-10,0,0,.999984,992239e-10,0,0,.999969,101356e-9,0,0,.999946,104784e-9,0,0,.999913,110111e-9,0,0,.999868,118217e-9,0,0,.999801,130396e-9,0,0,.999712,148523e-9,0,124907e-10,.999589,175233e-9,0,355405e-9,.999416,213999e-9,0,.0013528,.999136,268529e-9,0,.00312557,.998367,333088e-9,0,.00573045,.994701,304757e-9,0,.00919397,.992497,318031e-9,0,.0135261,.990608,353863e-9,0,.0187278,.988715,409044e-9,0,.0247947,.986241,472967e-9,0,.0317196,.981696,495104e-9,0,.039494,.977097,532873e-9,0,.0481087,.972583,594447e-9,0,.0575549,.966142,636867e-9,0,.0678242,.95823,669899e-9,0,.0789089,.949677,719499e-9,0,.0908023,.939226,750584e-9,0,.103499,.927501,793183e-9,0,.116993,.915199,81995e-8,0,.131282,.90498,847654e-9,0,.146364,.894243,868929e-9,0,.162237,.882154,884278e-9,0,.178902,.869161,898108e-9,0,.196358,.854751,901254e-9,0,.21461,.839368,90679e-8,0,.23366,.822874,901541e-9,0,.253512,.805514,897297e-9,0,.274174,.78716,881856e-9,0,.29565,.769061,870032e-9,0,.31795,.751,851719e-9,0,.341081,.732614,830671e-9,0,.365053,.713171,806569e-9,0,.389874,.693472,78338e-8,0,.415553,.673528,756404e-9,0,.442098,.653397,726872e-9,0,.469512,.633781,700494e-9,0,.497794,.613877,67105e-8,0,.526935,.593506,640361e-9,0,.556908,.573667,613502e-9,0,.587657,.553932,583177e-9,0,.61906,.534345,554375e-9,0,.650794,.515042,527811e-9,0,.68254,.495674,499367e-9,0,.714286,.477132,47429e-8,0,.746032,.458609,447726e-9,0,.777778,.440354,424205e-9,0,.809524,.422765,399549e-9,0,.84127,.405472,378315e-9,0,.873016,.388482,355327e-9,0,.904762,.372191,336122e-9,0,.936508,.356099,315247e-9,0,.968254,.340737,29794e-8,0,1,1,143327e-9,0,0,1,14333e-8,0,0,1,143366e-9,0,0,.999999,143524e-9,0,0,.999996,143952e-9,0,0,.999991,144862e-9,0,0,.999981,146544e-9,0,0,.999966,149391e-9,0,0,.999941,153946e-9,0,0,.999905,160971e-9,0,0,.999852,171562e-9,0,0,.99978,18729e-8,0,0,.999681,210386e-9,0,826239e-10,.999546,243906e-9,0,664807e-9,.999352,291739e-9,0,.00196192,.999027,357419e-9,0,.00405941,.997886,422349e-9,0,.00699664,.99419,385008e-9,0,.0107896,.99214,409775e-9,0,.0154415,.990274,456418e-9,0,.0209488,.988455,527008e-9,0,.0273037,.985804,597685e-9,0,.0344969,.98103,613124e-9,0,.0425183,.976674,668321e-9,0,.0513575,.972021,736985e-9,0,.0610046,.965274,773789e-9,0,.0714508,.958046,830852e-9,0,.0826877,.949333,875766e-9,0,.0947085,.939135,917088e-9,0,.107507,.927119,952244e-9,0,.121078,.91469,990626e-9,0,.135419,.903006,.00101304,0,.150526,.892368,.00103834,0,.166399,.880231,.00105002,0,.183038,.867432,.00106331,0,.200443,.853208,.00106783,0,.218618,.837956,.00106458,0,.237566,.821772,.00105945,0,.257291,.804328,.00104685,0,.2778,.786465,.00103178,0,.2991,.768004,.00101077,0,.321199,.74972,985504e-9,0,.344106,.731682,962893e-9,0,.36783,.712813,932146e-9,0,.392383,.693139,89871e-8,0,.417774,.673566,869678e-9,0,.444013,.653483,835525e-9,0,.471107,.633891,799853e-9,0,.49906,.614433,766838e-9,0,.527869,.594586,732227e-9,0,.557517,.574769,696442e-9,0,.587966,.555149,663935e-9,0,.61913,.535898,629826e-9,0,.650794,.516753,596486e-9,0,.68254,.497816,567078e-9,0,.714286,.479034,534399e-9,0,.746032,.460975,507013e-9,0,.777778,.442935,477421e-9,0,.809524,.425263,451101e-9,0,.84127,.408248,424964e-9,0,.873016,.391339,39993e-8,0,.904762,.37513,377619e-9,0,.936508,.359172,354418e-9,0,.968254,.343876,334823e-9,0,1,1,209042e-9,0,0,1,209045e-9,0,0,1,209093e-9,0,0,.999999,209304e-9,0,0,.999996,209871e-9,0,0,.999991,211078e-9,0,0,.999979,213304e-9,0,0,.999963,217061e-9,0,0,.999933,223042e-9,0,0,.999894,232206e-9,0,0,.999837,245901e-9,0,0,.999756,266023e-9,0,102927e-11,.999648,295204e-9,0,233468e-9,.999499,336958e-9,0,.00108237,.999283,395563e-9,0,.00268832,.998896,473785e-9,0,.00511138,.997006,520008e-9,0,.00837705,.993819,497261e-9,0,.0124928,.991632,523722e-9,0,.0174561,.989875,587258e-9,0,.0232596,.988109,676329e-9,0,.0298932,.985155,747701e-9,0,.0373453,.980479,768803e-9,0,.0456045,.976271,841054e-9,0,.0546593,.971347,911469e-9,0,.0644994,.964528,953057e-9,0,.0751152,.957632,.00102221,0,.0864981,.948681,.00106122,0,.0986407,.938716,.00111857,0,.111537,.926629,.00114762,0,.125182,.914025,.00118995,0,.139571,.901026,.00121228,0,.154703,.890358,.00123946,0,.170576,.878283,.0012527,0,.18719,.865459,.00125536,0,.204547,.851407,.00126134,0,.222648,.836276,.00124759,0,.241498,.820436,.00124443,0,.261101,.803253,.00122071,0,.281465,.785562,.00120107,0,.302595,.76718,.00117762,0,.324501,.748551,.00114289,0,.347192,.730564,.00110872,0,.370679,.712253,.00107636,0,.394973,.692867,.00103646,0,.420085,.673695,996793e-9,0,.446027,.653912,95675e-8,0,.47281,.634129,916739e-9,0,.500441,.615004,874401e-9,0,.528921,.595587,833411e-9,0,.558244,.575965,794556e-9,0,.588384,.5566,75196e-8,0,.619281,.537428,716381e-9,0,.650795,.518623,676558e-9,0,.68254,.499964,64074e-8,0,.714286,.481356,605984e-9,0,.746032,.463279,570256e-9,0,.777778,.445673,540138e-9,0,.809524,.428032,507299e-9,0,.84127,.411112,479553e-9,0,.873016,.394444,450737e-9,0,.904762,.378247,424269e-9,0,.936508,.362415,399111e-9,0,.968254,.347103,375274e-9,0,1,1,300729e-9,0,0,1,300733e-9,0,0,1,300797e-9,0,0,.999998,301072e-9,0,0,.999996,301817e-9,0,0,.999989,303398e-9,0,0,.999977,306309e-9,0,0,.999958,311209e-9,0,0,.999927,318975e-9,0,0,.999884,330804e-9,0,0,.99982,34834e-8,0,0,.999733,373854e-9,0,326995e-10,.999613,410424e-9,0,477174e-9,.999447,462047e-9,0,.00161099,.999204,533322e-9,0,.00353153,.998725,624964e-9,0,.00627965,.995871,631786e-9,0,.0098693,.993194,632017e-9,0,.0143011,.991541,68923e-8,0,.019568,.989773,766892e-9,0,.0256593,.987647,863668e-9,0,.0325625,.984193,922089e-9,0,.0402647,.980016,970749e-9,0,.0487532,.975859,.00106027,0,.058016,.970514,.00112239,0,.0680419,.963625,.00117212,0,.0788208,.956959,.00125211,0,.0903439,.947956,.00129411,0,.102604,.93809,.00135879,0,.115594,.92659,.00139309,0,.129309,.913829,.00143253,0,.143745,.90005,.00145809,0,.158901,.888129,.0014748,0,.174774,.87607,.00148756,0,.191365,.863461,.00148714,0,.208674,.849594,.00148892,0,.226705,.834531,.00146496,0,.245461,.81903,.0014579,0,.264947,.802122,.00143039,0,.28517,.78445,.00139717,0,.306137,.766434,.00136312,0,.327857,.747816,.00132597,0,.350341,.729519,.00128323,0,.373598,.711454,.00123803,0,.397642,.692699,.00119097,0,.422485,.673723,.00114565,0,.448139,.654386,.00109552,0,.474619,.634673,.00104553,0,.501933,.615554,99985e-8,0,.530089,.596462,948207e-9,0,.559087,.577385,902299e-9,0,.588913,.558257,856448e-9,0,.619525,.5392,810395e-9,0,.650826,.520543,768558e-9,0,.68254,.502206,7239e-7,0,.714286,.48402,685794e-9,0,.746032,.465779,64471e-8,0,.777778,.448455,609583e-9,0,.809524,.431091,57227e-8,0,.84127,.414147,54042e-8,0,.873016,.39765,506545e-9,0,.904762,.381576,477635e-9,0,.936508,.365881,448446e-9,0,.968254,.350582,421424e-9,0,1,1,427144e-9,0,0,1,427151e-9,0,0,1,427232e-9,0,0,.999998,42759e-8,0,0,.999995,428555e-9,0,0,.999988,430603e-9,0,0,.999976,434368e-9,0,0,.999952,440688e-9,0,0,.999919,450667e-9,0,0,.999871,46578e-8,0,0,.999801,488024e-9,0,0,.999704,520092e-9,0,129791e-9,.999572,565553e-9,0,821056e-9,.999389,628906e-9,0,.00225241,.999114,714911e-9,0,.00449109,.998488,819218e-9,0,.00756249,.995234,80415e-8,0,.0114716,.993021,830181e-9,0,.0162131,.991407,902645e-9,0,.021776,.989625,996934e-9,0,.0281471,.987064,.00109707,0,.0353118,.983265,.00114353,0,.0432562,.979535,.0012272,0,.0519665,.975224,.00132642,0,.0614298,.969574,.00138092,0,.0716348,.963021,.00145896,0,.0825709,.956046,.00152834,0,.094229,.947136,.00158217,0,.106602,.937313,.0016347,0,.119682,.926073,.00168383,0,.133465,.913121,.00171627,0,.147947,.899165,.00174229,0,.163125,.885891,.00176137,0,.178998,.873783,.00176406,0,.195566,.861331,.00176156,0,.21283,.847569,.00175346,0,.230793,.832785,.00172753,0,.249459,.817442,.00170204,0,.268832,.800613,.00166576,0,.28892,.783597,.00162909,0,.30973,.76571,.0015826,0,.331271,.747021,.00153106,0,.353554,.728593,.00148036,0,.37659,.710661,.00142808,0,.400391,.692426,.00136906,0,.424973,.673623,.00131066,0,.450347,.65494,.00125569,0,.476531,.635448,.00119517,0,.503535,.616221,.00113828,0,.531372,.597531,.0010816,0,.560047,.578795,.00102673,0,.589554,.559892,970985e-9,0,.619869,.541307,919773e-9,0,.650923,.522608,868479e-9,0,.68254,.504484,82137e-8,0,.714286,.486603,772916e-9,0,.746032,.468802,730353e-9,0,.777778,.451172,684955e-9,0,.809524,.434348,647565e-9,0,.84127,.417445,605863e-9,0,.873016,.401077,571885e-9,0,.904762,.385039,536034e-9,0,.936508,.369483,504227e-9,0,.968254,.354272,473165e-9,0,1,1,599525e-9,0,0,1,599533e-9,0,0,1,599639e-9,0,0,.999998,600097e-9,0,0,.999994,601336e-9,0,0,.999987,603958e-9,0,0,.999972,608775e-9,0,0,.999949,616842e-9,0,0,.999912,629534e-9,0,0,.999857,648658e-9,0,0,.999781,676615e-9,0,538873e-11,.999674,716574e-9,0,308602e-9,.999528,772641e-9,0,.00127003,.999326,849806e-9,0,.00300783,.999009,952682e-9,0,.00556637,.998112,.00106394,0,.00895889,.994496,.00102228,0,.0131827,.992806,.00108586,0,.0182277,.991211,.0011759,0,.0240795,.989415,.00128955,0,.030723,.986499,.00139038,0,.0381418,.982679,.00144539,0,.046321,.978839,.00153954,0,.0552459,.974295,.00164417,0,.0649034,.968784,.00171517,0,.0752814,.962324,.00180282,0,.0863693,.954956,.00186387,0,.0981578,.94624,.00193817,0,.110639,.936517,.00198156,0,.123806,.925186,.00203042,0,.137655,.91252,.0020664,0,.15218,.898441,.00207822,0,.16738,.884394,.0020992,0,.183253,.871273,.00208748,0,.199799,.859057,.00208686,0,.21702,.845243,.00205519,0,.234918,.830723,.00202868,0,.253496,.815801,.00199501,0,.272761,.79914,.00194193,0,.292719,.782372,.00188824,0,.313377,.76482,.00183695,0,.334745,.746586,.00177418,0,.356833,.7281,.00170628,0,.379654,.709842,.00164063,0,.403221,.692019,.00157355,0,.427548,.67364,.00150262,0,.452651,.655277,.00143473,0,.478545,.636438,.00136371,0,.505246,.617364,.00129911,0,.532768,.598603,.00123014,0,.561122,.580195,.00116587,0,.590309,.561786,.00110398,0,.620318,.543377,.00104148,0,.651102,.525093,983984e-9,0,.682545,.506791,92667e-8,0,.714286,.489291,874326e-9,0,.746032,.471811,821734e-9,0,.777778,.454435,774698e-9,0,.809524,.437493,727302e-9,0,.84127,.420977,684039e-9,0,.873016,.404729,64373e-8,0,.904762,.388756,60285e-8,0,.936508,.373344,56765e-8,0,.968254,.358191,531929e-9,0,1,1,832169e-9,0,0,1,832178e-9,0,0,1,83231e-8,0,0,.999998,832893e-9,0,0,.999995,834465e-9,0,0,.999985,837791e-9,0,0,.999969,843893e-9,0,0,.999944,854086e-9,0,0,.999903,870071e-9,0,0,.999843,894042e-9,0,0,.999759,928865e-9,0,531805e-10,.999643,978242e-9,0,579365e-9,.99948,.00104684,0,.00182774,.999255,.00114012,0,.00387804,.998885,.00126188,0,.00675709,.997405,.00135888,0,.010468,.99424,.00133626,0,.0150018,.992458,.00140905,0,.0203443,.990929,.00152305,0,.0264786,.989116,.00165882,0,.0333875,.985624,.00174128,0,.0410536,.982003,.00182108,0,.0494609,.978336,.00194498,0,.0585941,.973184,.00202708,0,.0684396,.9678,.00212166,0,.0789851,.961348,.00221366,0,.0902199,.953841,.00228219,0,.102134,.94534,.00235662,0,.114721,.935552,.00240572,0,.127972,.924064,.00244405,0,.141884,.911827,.00247557,0,.156451,.897731,.00248374,0,.171672,.883409,.00249863,0,.187545,.868625,.00246688,0,.20407,.856529,.00246523,0,.221249,.842999,.00242368,0,.239083,.828505,.00237354,0,.257578,.813825,.00232588,0,.276738,.797813,.00226731,0,.296569,.781097,.00219704,0,.31708,.764038,.00212394,0,.338281,.746067,.00204786,0,.360181,.727687,.00196728,0,.382794,.709571,.00188779,0,.406133,.691503,.00180532,0,.430213,.673673,.00171849,0,.45505,.655732,.00164147,0,.480662,.637399,.00155858,0,.507065,.618616,.00147641,0,.534278,.60005,.00140125,0,.562313,.581713,.00132441,0,.59118,.563546,.00125014,0,.620875,.545605,.00118249,0,.651373,.527559,.0011116,0,.682593,.509764,.00104979,0,.714286,.49193,985977e-9,0,.746032,.475011,928592e-9,0,.777778,.457878,873466e-9,0,.809524,.440979,819585e-9,0,.84127,.424613,772365e-9,0,.873016,.408549,722195e-9,0,.904762,.392771,680014e-9,0,.936508,.377317,636797e-9,0,.968254,.362352,598318e-9,0,1,1,.00114313,0,0,1,.00114314,0,0,.999999,.00114331,0,0,.999998,.00114404,0,0,.999994,.00114601,0,0,.999984,.00115019,0,0,.999967,.00115784,0,0,.999937,.0011706,0,0,.999894,.00119054,0,0,.999828,.00122031,0,0,.999735,.00126331,0,169263e-9,.999606,.00132382,0,949167e-9,.999426,.0014071,0,.00249668,.999173,.00151895,0,.00486392,.99873,.00166102,0,.00806323,.996243,.0017023,0,.0120895,.993779,.00172782,0,.0169288,.9919,.0018108,0,.0225633,.990524,.00196028,0,.028974,.98868,.00212014,0,.036142,.984663,.00217598,0,.044049,.981457,.00230563,0,.0526781,.977608,.00243966,0,.0620137,.972215,.00251336,0,.0720418,.966798,.0026285,0,.0827499,.960241,.00271409,0,.0941271,.952489,.00278381,0,.106164,.944127,.00285399,0,.118852,.934282,.00290994,0,.132185,.923271,.00294558,0,.146157,.910803,.00296269,0,.160766,.896705,.00296803,0,.176007,.88238,.00296637,0,.19188,.867116,.00293163,0,.208385,.853636,.00289418,0,.225523,.840469,.00284663,0,.243296,.82639,.00278594,0,.261709,.811759,.00271618,0,.280767,.796113,.00263187,0,.300476,.779518,.00254589,0,.320845,.763142,.00246003,0,.341883,.745464,.00236529,0,.363601,.727491,.00226536,0,.386011,.709414,.00216375,0,.409128,.691396,.00207127,0,.432967,.67368,.00197106,0,.457545,.656049,.00187022,0,.482881,.638188,.00177605,0,.508992,.620177,.00168482,0,.535899,.601506,.00158909,0,.563619,.58362,.00150583,0,.592165,.565496,.00141791,0,.621544,.54789,.00133693,0,.651743,.530323,.00126038,0,.682709,.512795,.00118556,0,.714286,.495199,.00111527,0,.746032,.478101,.0010489,0,.777778,.461511,984264e-9,0,.809524,.444879,92591e-8,0,.84127,.428424,866582e-9,0,.873016,.412495,814463e-9,0,.904762,.396975,764498e-9,0,.936508,.381614,715967e-9,0,.968254,.366732,672483e-9,0,1,1,.00155501,0,0,1,.00155503,0,0,1,.00155524,0,0,.999998,.00155615,0,0,.999994,.0015586,0,0,.999983,.00156379,0,0,.999963,.0015733,0,0,.999932,.00158911,0,0,.999882,.00161376,0,0,.99981,.00165041,0,100875e-10,.999708,.00170304,0,367658e-9,.999565,.00177658,0,.0014234,.999368,.00187688,0,.00327939,.999081,.00200989,0,.00596629,.99852,.00217177,0,.0094852,.99549,.0021745,0,.013824,.993252,.00222357,0,.0189642,.991727,.00235022,0,.0248856,.989951,.00250561,0,.0315669,.988029,.00268829,0,.0389882,.984029,.0027496,0,.0471302,.980683,.00289793,0,.0559754,.976554,.00303315,0,.0655081,.97139,.00313257,0,.0757138,.965544,.00323656,0,.08658,.95912,.00333432,0,.0980954,.951183,.0034039,0,.110251,.942974,.00347515,0,.123038,.932642,.00350381,0,.13645,.922158,.00354519,0,.150482,.909404,.00353851,0,.165129,.896071,.0035435,0,.18039,.881206,.00349936,0,.196263,.866077,.00347256,0,.212748,.85093,.003415,0,.229847,.837703,.00333367,0,.247561,.823878,.003249,0,.265895,.809449,.00316347,0,.284854,.794379,.00306351,0,.304445,.778138,.0029499,0,.324675,.761997,.00284099,0,.345555,.744938,.00272104,0,.367095,.727212,.00260715,0,.389309,.709549,.00248855,0,.41221,.691704,.00236783,0,.435814,.673689,.00225178,0,.460138,.656453,.00213765,0,.485203,.639128,.00202178,0,.511028,.621512,.00191443,0,.537634,.603598,.00180977,0,.565041,.58559,.00170456,0,.593268,.567852,.00160927,0,.622327,.5503,.00151395,0,.652217,.533033,.00142499,0,.682907,.515942,.00133955,0,.714296,.498814,.0012602,0,.746032,.481595,.00118188,0,.777778,.465117,.00111171,0,.809524,.448865,.00104091,0,.84127,.432711,976618e-9,0,.873016,.416822,91859e-8,0,.904762,.401272,857704e-9,0,.936508,.386226,807172e-9,0,.968254,.371321,75464e-8,0,1,1,.00209596,0,0,1,.00209598,0,0,1,.00209624,0,0,.999997,.00209736,0,0,.999991,.00210039,0,0,.999979,.00210678,0,0,.999959,.00211847,0,0,.999925,.0021379,0,0,.99987,.00216809,0,0,.999791,.00221281,0,681487e-10,.999677,.00227669,0,658161e-9,.999521,.00236533,0,.00200635,.999301,.00248514,0,.0041779,.998977,.00264185,0,.00718648,.998191,.00281695,0,.0110239,.994801,.00278518,0,.015672,.993091,.00288774,0,.0211091,.991571,.00303931,0,.0273123,.9897,.00321643,0,.034259,.987023,.00337332,0,.0419282,.983289,.00346146,0,.0502998,.979892,.00363704,0,.0593562,.975111,.00373601,0,.069081,.970351,.0038842,0,.0794598,.964131,.00397053,0,.0904798,.957747,.00408078,0,.10213,.949536,.00413533,0,.1144,.941372,.00420305,0,.127284,.931049,.00422815,0,.140772,.920647,.00425048,0,.154862,.908033,.0042281,0,.169548,.895028,.00422026,0,.184828,.879968,.00415042,0,.200701,.864875,.00408821,0,.217167,.84918,.00400909,0,.234227,.834934,.00391178,0,.251884,.821397,.00380066,0,.270141,.807135,.00367974,0,.289004,.792363,.00355172,0,.308479,.776661,.003411,0,.328575,.760705,.00328123,0,.349301,.744408,.00314003,0,.370668,.726994,.0029906,0,.392689,.709598,.00285034,0,.415379,.692112,.00271179,0,.438754,.674435,.00257185,0,.46283,.65676,.00243425,0,.48763,.639982,.00230351,0,.513173,.622983,.0021777,0,.539482,.605471,.00204991,0,.566579,.58796,.00193759,0,.594488,.570463,.00181976,0,.623226,.553058,.00171497,0,.6528,.535894,.00161109,0,.683198,.519089,.00151394,0,.714354,.502454,.00142122,0,.746032,.485681,.00133488,0,.777778,.468935,.00124975,0,.809524,.452951,.00117309,0,.84127,.437139,.00110155,0,.873016,.421446,.00103124,0,.904762,.405951,966387e-9,0,.936508,.391003,908119e-9,0,.968254,.376198,848057e-9,0,1,1,.00280076,0,0,1,.00280078,0,0,.999999,.00280109,0,0,.999997,.00280246,0,0,.999992,.00280616,0,0,.999979,.00281396,0,0,.999956,.00282822,0,0,.999916,.00285186,0,0,.999857,.0028885,0,0,.999768,.00294259,0,196026e-9,.999645,.00301946,0,.00104842,.99947,.00312541,0,.00270199,.999229,.00326733,0,.00519449,.998852,.00344992,0,.00852602,.997558,.00361052,0,.0126804,.994417,.0035898,0,.017635,.992824,.00372393,0,.023365,.991344,.00390695,0,.0298456,.989337,.00410392,0,.0370529,.985811,.00420987,0,.0449651,.982772,.00437488,0,.0535615,.979001,.00455069,0,.0628243,.974102,.00464462,0,.0727368,.969197,.00480577,0,.0832844,.962759,.00487818,0,.0944545,.956207,.00498176,0,.106236,.947909,.00503392,0,.118619,.939596,.00507474,0,.131595,.929642,.00509798,0,.145159,.918807,.00508476,0,.159305,.906921,.00505634,0,.174028,.893312,.00498845,0,.189327,.878933,.0049133,0,.2052,.863986,.0048259,0,.221647,.847936,.00470848,0,.23867,.832253,.00456889,0,.25627,.818619,.00442726,0,.274453,.804788,.00427677,0,.293222,.790241,.00411906,0,.312585,.775162,.00394833,0,.33255,.759463,.00377366,0,.353126,.743598,.00361026,0,.374324,.72697,.00343627,0,.396158,.709646,.00326422,0,.418641,.69277,.00309717,0,.44179,.675371,.0029356,0,.465624,.657863,.00277712,0,.490163,.640772,.00261738,0,.515429,.624441,.0024737,0,.541445,.607497,.00233125,0,.568236,.590438,.00218994,0,.595828,.573224,.0020664,0,.624242,.556168,.00193526,0,.653496,.539232,.00182463,0,.683588,.522352,.00170735,0,.714482,.506172,.00160555,0,.746032,.489842,.00150451,0,.777778,.473463,.00140938,0,.809524,.457266,.00132568,0,.84127,.441609,.0012376,0,.873016,.426348,.00116265,0,.904762,.411002,.00108935,0,.936508,.396045,.00101946,0,.968254,.381448,955665e-9,0,1,1,.0037121,0,0,1,.00371213,0,0,1,.00371251,0,0,.999997,.00371417,0,0,.99999,.00371863,0,0,.999977,.00372807,0,0,.99995,.00374529,0,0,.999908,.0037738,0,0,.999843,.00381789,0,123596e-10,.999745,.00388273,0,407442e-9,.999608,.00397443,0,.0015447,.999415,.00409998,0,.00351385,.999143,.00426662,0,.0063316,.9987,.00447625,0,.00998679,.996363,.00455323,0,.0144569,.994021,.00461052,0,.0197151,.992372,.00476359,0,.0257344,.991007,.00499101,0,.0324882,.988767,.0051972,0,.0399517,.984872,.00528407,0,.0481022,.982004,.00548926,0,.0569191,.977714,.00564385,0,.0663839,.973076,.0057693,0,.0764801,.967565,.0058924,0,.0871928,.961384,.00599629,0,.0985095,.954435,.00605998,0,.110419,.946303,.0061133,0,.122912,.937662,.00612028,0,.13598,.927867,.00612209,0,.149617,.916475,.00604813,0,.163817,.90541,.00603088,0,.178577,.891591,.00592218,0,.193894,.877573,.00578854,0,.209767,.862511,.00566648,0,.226196,.846861,.00551481,0,.243182,.83068,.00533754,0,.260728,.815725,.00515487,0,.278837,.802321,.0049655,0,.297515,.787826,.00475421,0,.316768,.773454,.00456002,0,.336605,.758224,.00434727,0,.357034,.74265,.00414444,0,.378067,.726729,.00393738,0,.399717,.710155,.00373575,0,.421998,.693312,.00353736,0,.444928,.67653,.00334368,0,.468523,.659444,.00315981,0,.492806,.642051,.00297809,0,.517798,.625758,.00280592,0,.543525,.609615,.00264254,0,.570012,.592919,.00248459,0,.597288,.576298,.00233327,0,.625379,.559489,.00219519,0,.654307,.542891,.00205441,0,.684084,.526255,.00193385,0,.714693,.509853,.00180745,0,.746044,.494131,.00169817,0,.777778,.478114,.0015913,0,.809524,.462274,.00148981,0,.84127,.446412,.00139537,0,.873016,.431274,.00130984,0,.904762,.41635,.00122403,0,.936508,.401476,.00114809,0,.968254,.386993,.00107563,0,1,1,.00488216,0,0,1,.0048822,0,0,1,.00488265,0,0,.999997,.00488463,0,0,.999988,.00488999,0,0,.999974,.00490129,0,0,.999946,.00492191,0,0,.999897,.00495598,0,0,.999825,.00500855,0,744791e-10,.999718,.00508559,0,712744e-9,.999565,.005194,0,.00215249,.999352,.00534147,0,.00444576,.999046,.00553523,0,.00759218,.998492,.00577016,0,.0115714,.995564,.00578487,0,.0163557,.993339,.00586414,0,.021915,.991834,.00606002,0,.0282201,.990496,.00633312,0,.0352433,.987826,.00651941,0,.042959,.98383,.00660842,0,.0513439,.98109,.00685523,0,.0603772,.976131,.00695778,0,.0700402,.971922,.00714236,0,.0803163,.965901,.00721437,0,.0911908,.959606,.00732017,0,.102651,.952504,.00735788,0,.114686,.944365,.00738493,0,.127286,.935652,.00737969,0,.140443,.925813,.00733612,0,.154151,.914397,.00723094,0,.168405,.903257,.00714002,0,.183201,.890015,.00700149,0,.198536,.876014,.00682813,0,.214409,.861436,.00665567,0,.23082,.845752,.00644526,0,.24777,.829169,.00621635,0,.265263,.813435,.00597789,0,.283301,.799701,.00575694,0,.301889,.785726,.00549866,0,.321035,.77152,.0052503,0,.340746,.75683,.00499619,0,.361032,.741951,.0047543,0,.381904,.726367,.0045084,0,.403374,.710537,.00426784,0,.425457,.693965,.00403487,0,.448169,.677724,.0038075,0,.47153,.66117,.00359431,0,.495561,.644274,.00338354,0,.520284,.627449,.00318163,0,.545725,.611645,.00299672,0,.571911,.595614,.00281016,0,.598873,.579426,.00264252,0,.62664,.563016,.00247509,0,.655239,.546728,.00232647,0,.684692,.530539,.00217803,0,.714999,.514164,.00204216,0,.746106,.498344,.00191403,0,.777778,.482957,.00179203,0,.809524,.467336,.00167695,0,.84127,.451994,.00157567,0,.873016,.436514,.00147113,0,.904762,.42178,.00138034,0,.936508,.407271,.00129219,0,.968254,.392822,.0012098,0,1,1,.00637427,0,0,1,.00637431,0,0,.999999,.00637485,0,0,.999996,.00637721,0,0,.999987,.00638357,0,0,.999971,.006397,0,0,.999939,.00642142,0,0,.999888,.00646177,0,0,.999807,.00652387,0,207916e-9,.999689,.00661454,0,.00112051,.99952,.00674155,0,.00287719,.999283,.00691313,0,.00550145,.998936,.00713598,0,.00897928,.998165,.00738501,0,.0132829,.994847,.00734388,0,.01838,.993182,.00749991,0,.0242381,.991665,.0077246,0,.030826,.989708,.00797579,0,.0381152,.986663,.00813011,0,.0460794,.983288,.00830365,0,.0546951,.980104,.00853496,0,.0639411,.974855,.00861045,0,.0737988,.97045,.00879133,0,.0842516,.964509,.00886377,0,.0952848,.957594,.00890346,0,.106886,.950546,.00893289,0,.119044,.942225,.00890074,0,.131749,.933365,.00886826,0,.144994,.923202,.0087316,0,.158772,.912605,.00863082,0,.173078,.901099,.00847403,0,.187908,.888177,.00825838,0,.203261,.873955,.00801834,0,.219134,.860091,.00779026,0,.235527,.84434,.00752478,0,.252443,.828517,.00724074,0,.269883,.81239,.00693769,0,.287851,.79721,.00664817,0,.306352,.783489,.00634763,0,.325393,.769514,.00604221,0,.344981,.755419,.00573568,0,.365126,.741083,.00544359,0,.385839,.726059,.00515515,0,.407132,.710809,.00487139,0,.42902,.695052,.00459846,0,.45152,.678886,.00433412,0,.474651,.663042,.00407981,0,.498433,.646634,.00384264,0,.52289,.630117,.00360897,0,.548048,.613804,.00338863,0,.573936,.598338,.00318486,0,.600584,.582687,.00298377,0,.628027,.566809,.00280082,0,.656295,.550817,.00262255,0,.685417,.534937,.00245835,0,.715406,.519151,.00230574,0,.74624,.503118,.0021549,0,.777778,.487723,.00202008,0,.809524,.472725,.00189355,0,.84127,.457599,.00177108,0,.873016,.442558,.00165843,0,.904762,.427624,.00155494,0,.936508,.413171,.00145273,0,.968254,.399122,.00136454,0,1,1,.00826496,0,0,1,.00826499,0,0,1,.00826564,0,0,.999996,.00826842,0,0,.999987,.00827589,0,0,.999967,.00829167,0,0,.999933,.00832037,0,0,.999876,.00836768,0,109338e-10,.999786,.00844031,0,427145e-9,.999655,.00854603,0,.0016384,.999468,.00869337,0,.00372392,.999203,.008891,0,.00668513,.998803,.00914387,0,.0104968,.99748,.00935838,0,.015125,.994446,.00933309,0,.0205338,.99292,.00953084,0,.0266884,.991414,.0097893,0,.0335565,.989049,.0100228,0,.0411086,.98582,.0101664,0,.0493181,.982441,.0103582,0,.0581613,.978595,.0105292,0,.0676169,.973495,.0106274,0,.0776661,.968405,.0107261,0,.0882926,.962717,.0108234,0,.0994817,.955478,.0108102,0,.111221,.948275,.0107914,0,.123499,.940006,.0107161,0,.136308,.930831,.0106309,0,.149639,.920648,.0104083,0,.163485,.910205,.0102312,0,.177843,.898445,.0100051,0,.192707,.885986,.00971928,0,.208077,.872204,.00940747,0,.22395,.858436,.0091085,0,.240326,.843454,.00876595,0,.257208,.827437,.00839794,0,.274596,.811488,.00803692,0,.292496,.796039,.00767352,0,.310911,.781083,.0073097,0,.329849,.767642,.00694032,0,.349316,.753901,.00657476,0,.369323,.740131,.00622699,0,.38988,.725845,.0058838,0,.410999,.710991,.00555586,0,.432696,.696002,.00523089,0,.454987,.680461,.00492494,0,.47789,.664875,.00463464,0,.501426,.649273,.00435422,0,.52562,.63302,.0040875,0,.550498,.61705,.00384075,0,.576089,.601154,.00359557,0,.602427,.586008,.00337636,0,.629544,.570699,.00316019,0,.657479,.555166,.00296033,0,.686264,.539645,.00277552,0,.715924,.524159,.00259499,0,.746459,.508682,.00243257,0,.777789,.493163,.00227851,0,.809524,.478004,.00213083,0,.84127,.46347,.00199502,0,.873016,.448778,.00186967,0,.904762,.434105,.00174732,0,.936508,.419576,.00163861,0,.968254,.405541,.00153341,0,1,1,.0106462,0,0,1,.0106462,0,0,.999999,.010647,0,0,.999995,.0106502,0,0,.999985,.0106589,0,0,.999964,.0106773,0,0,.999925,.0107106,0,0,.999861,.0107655,0,712986e-10,.999763,.0108497,0,743959e-9,.999616,.0109716,0,.00227361,.999408,.0111408,0,.0046983,.999112,.0113659,0,.00800158,.998637,.0116475,0,.0121493,.996223,.0117231,0,.0171023,.994006,.0118064,0,.0228218,.992444,.0120254,0,.0292711,.991028,.0123314,0,.036417,.98803,.0124954,0,.0442295,.984816,.0126538,0,.0526815,.981399,.0128537,0,.0617492,.977085,.0129694,0,.0714114,.972154,.013091,0,.0816495,.966617,.0131166,0,.0924472,.960628,.0131583,0,.10379,.953295,.0131094,0,.115665,.94575,.0129966,0,.128062,.937654,.0128796,0,.140972,.927716,.0126477,0,.154387,.917932,.0123889,0,.168301,.907719,.012131,0,.182709,.89584,.0118013,0,.197608,.883526,.0114145,0,.212994,.870301,.0110075,0,.228867,.856272,.0106019,0,.245227,.842251,.0101938,0,.262074,.826466,.00973254,0,.279412,.810859,.0092846,0,.297244,.795051,.00883304,0,.315575,.780053,.00840272,0,.334412,.76575,.00796438,0,.35376,.752298,.00752526,0,.373631,.739153,.00711486,0,.394034,.725514,.00670361,0,.414983,.711473,.00632656,0,.436491,.696936,.00595206,0,.458575,.682126,.00559191,0,.481253,.667027,.00525362,0,.504547,.651875,.00493805,0,.528481,.636463,.00462848,0,.553081,.620641,.00433936,0,.578377,.604931,.00407,0,.604404,.589549,.00380864,0,.631197,.574712,.00357049,0,.658795,.559775,.00334466,0,.687238,.544514,.00312505,0,.716559,.529555,.00293199,0,.746776,.514402,.00274204,0,.777849,.499302,.00256647,0,.809524,.484114,.00239901,0,.84127,.469308,.00225148,0,.873016,.455133,.00210178,0,.904762,.440939,.0019727,0,.936508,.426627,.00184382,0,.968254,.412509,.00172548,0,1,1,.013628,0,0,1,.0136281,0,0,.999999,.0136289,0,0,.999995,.0136327,0,0,.999983,.0136427,0,0,.99996,.0136638,0,0,.999917,.0137022,0,0,.999846,.0137652,0,204597e-9,.999736,.0138615,0,.00116837,.999573,.0140007,0,.00303325,.99934,.0141927,0,.00580613,.999004,.0144457,0,.00945626,.998407,.0147489,0,.0139421,.995464,.014731,0,.0192202,.993328,.0148283,0,.0252495,.991799,.0150797,0,.0319921,.990397,.0154316,0,.0394138,.986835,.0155005,0,.0474843,.983938,.0157308,0,.0561763,.980154,.0158753,0,.0654661,.975659,.0159581,0,.0753326,.970171,.0159832,0,.0857571,.964803,.0160084,0,.0967236,.958366,.0159484,0,.108218,.950613,.0158001,0,.120227,.942874,.0155845,0,.132741,.935005,.0154292,0,.145751,.924991,.0150742,0,.159249,.914814,.0146757,0,.17323,.904743,.0143097,0,.187687,.893216,.0138695,0,.202619,.880769,.0133706,0,.218021,.868136,.0128606,0,.233894,.85469,.0123403,0,.250238,.840593,.0118091,0,.267052,.825808,.011253,0,.284341,.81009,.0107099,0,.302106,.79504,.0101636,0,.320354,.779757,.00964041,0,.33909,.764697,.00911896,0,.358322,.750913,.00859533,0,.378059,.738175,.00811592,0,.398311,.725242,.00764504,0,.41909,.711864,.00718885,0,.440412,.698009,.00675843,0,.462292,.683841,.00634984,0,.484748,.669391,.00595502,0,.507802,.654731,.00558671,0,.531477,.639805,.00523578,0,.555802,.624789,.00490834,0,.580805,.609325,.00459448,0,.606522,.593975,.00430342,0,.63299,.578983,.00403019,0,.66025,.564442,.0037707,0,.688346,.549835,.0035316,0,.717319,.535039,.00330255,0,.7472,.520403,.00308932,0,.777982,.505687,.00289335,0,.809524,.490939,.00270818,0,.84127,.476233,.0025343,0,.873016,.461624,.00237097,0,.904762,.447833,.00222065,0,.936508,.433992,.00207561,0,.968254,.420147,.00194955,0,1,1,.0173415,0,0,1,.0173416,0,0,.999999,.0173426,0,0,.999995,.0173468,0,0,.999983,.0173582,0,0,.999954,.0173822,0,0,.999908,.0174258,0,669501e-11,.999828,.0174973,0,427399e-9,.999705,.0176063,0,.00171019,.999524,.0177631,0,.0039248,.999263,.0179781,0,.00705382,.998878,.018258,0,.0110552,.998012,.0185551,0,.0158812,.994614,.0184264,0,.0214852,.993132,.0186385,0,.0278239,.991563,.0189067,0,.0348585,.989298,.0191577,0,.0425544,.986036,.0192522,0,.050881,.982558,.0194063,0,.059811,.978531,.019486,0,.0693209,.974198,.0195847,0,.0793895,.968148,.0194749,0,.0899984,.962565,.0194277,0,.101132,.956041,.0192991,0,.112775,.947749,.0189893,0,.124917,.94018,.018704,0,.137547,.93165,.0183458,0,.150655,.921798,.0178775,0,.164236,.911573,.0173618,0,.178281,.901569,.0168482,0,.192788,.890341,.016265,0,.207752,.877835,.0156199,0,.223171,.865472,.0149516,0,.239044,.852905,.0143274,0,.255371,.838906,.0136643,0,.272153,.824888,.0129903,0,.289393,.809977,.0123218,0,.307093,.794697,.0116572,0,.325259,.780028,.0110307,0,.343896,.765124,.0104236,0,.363012,.750411,.0098219,0,.382617,.737264,.00924397,0,.402719,.724799,.00868719,0,.423332,.712253,.00816476,0,.444469,.699267,.00767262,0,.466146,.685618,.00719746,0,.488383,.671736,.00673916,0,.511199,.657777,.00631937,0,.534618,.643497,.00592411,0,.558668,.62889,.00553928,0,.58338,.614299,.0051934,0,.608787,.599197,.00485985,0,.634929,.584175,.00454357,0,.661849,.569541,.00425787,0,.689594,.555193,.00397905,0,.718211,.540947,.00372364,0,.747742,.526593,.00348599,0,.778205,.512335,.00326103,0,.80953,.498017,.00305137,0,.84127,.483609,.00285485,0,.873016,.469368,.00267472,0,.904762,.455037,.00249945,0,.936508,.441493,.00234792,0,.968254,.428147,.00219936,0,1,1,.0219422,0,0,1,.0219423,0,0,.999998,.0219434,0,0,.999993,.0219481,0,0,.999981,.021961,0,0,.999949,.0219879,0,0,.999896,.0220367,0,593194e-10,.999808,.0221167,0,75364e-8,.99967,.0222383,0,.00237884,.999466,.0224125,0,.00495612,.999174,.0226495,0,.00844887,.998725,.0229525,0,.0128058,.996979,.0231123,0,.0179742,.994317,.0230742,0,.0239047,.992781,.0232895,0,.0305526,.991191,.0235734,0,.0378786,.987787,.0236152,0,.0458475,.985092,.0237994,0,.0544287,.981121,.0238553,0,.0635952,.976924,.0238706,0,.0733233,.97218,.0238704,0,.0835922,.965956,.0236598,0,.0943839,.959998,.0234735,0,.105682,.953245,.0232277,0,.117474,.944445,.0226973,0,.129747,.937087,.0223527,0,.142491,.928341,.0218144,0,.155697,.9184,.0211516,0,.169358,.907959,.0204553,0,.183469,.89808,.0197673,0,.198024,.887047,.0189915,0,.21302,.875221,.0182082,0,.228455,.86269,.0173584,0,.244329,.850735,.0165718,0,.260639,.837545,.0157524,0,.277389,.823639,.0149482,0,.29458,.809699,.0141431,0,.312216,.794797,.0133527,0,.3303,.780578,.0126193,0,.34884,.766019,.0118914,0,.367842,.751447,.0111839,0,.387315,.737275,.010514,0,.40727,.724545,.00987277,0,.427717,.712644,.00926569,0,.448671,.700432,.00869029,0,.470149,.687664,.00814691,0,.492167,.674288,.00763012,0,.514746,.660966,.00714437,0,.537911,.647264,.00668457,0,.561688,.633431,.00626581,0,.586108,.619133,.00585593,0,.611206,.604935,.00548188,0,.637022,.590236,.00513288,0,.663599,.575473,.0047906,0,.690989,.561228,.00448895,0,.719242,.547054,.00420233,0,.748411,.533175,.00392869,0,.778531,.519163,.00367445,0,.809583,.505328,.00344097,0,.84127,.491446,.00322003,0,.873016,.477356,.00301283,0,.904762,.46356,.00282592,0,.936508,.449623,.00264956,0,.968254,.436068,.00246956,0,1,1,.0276135,0,0,1,.0276136,0,0,.999998,.0276148,0,0,.999993,.0276201,0,0,.999976,.0276342,0,0,.999945,.027664,0,0,.999884,.0277179,0,18679e-8,.999784,.027806,0,.00119607,.99963,.0279394,0,.00318407,.999401,.0281295,0,.00613601,.999066,.0283858,0,.00999963,.998524,.0287027,0,.0147164,.995702,.0286256,0,.0202295,.993593,.0286733,0,.0264876,.992067,.0288989,0,.0334452,.990548,.0292135,0,.0410621,.986775,.0291296,0,.0493032,.984054,.0293099,0,.0581381,.979481,.0291881,0,.0675397,.975297,.0291598,0,.0774848,.96981,.028954,0,.0879528,.963524,.028628,0,.0989258,.957398,.0283135,0,.110388,.950088,.0278469,0,.122327,.941538,.0271798,0,.134729,.933332,.0265388,0,.147587,.924392,.0257776,0,.160889,.914581,.024916,0,.174631,.904347,.0240242,0,.188806,.894324,.0231229,0,.203409,.883724,.022153,0,.218437,.872207,.0211355,0,.233888,.859927,.0201048,0,.249761,.848373,.0191263,0,.266056,.836023,.0181306,0,.282774,.82289,.0171718,0,.299917,.809324,.0162196,0,.317488,.795361,.0152622,0,.335493,.781253,.01439,0,.353936,.767338,.013533,0,.372825,.753156,.0127244,0,.392168,.739122,.0119454,0,.411976,.725358,.0112054,0,.432259,.712949,.010487,0,.453032,.701621,.00984032,0,.47431,.689703,.00921495,0,.496111,.677216,.00862492,0,.518456,.664217,.00806882,0,.541367,.65137,.00755922,0,.564872,.638,.00705705,0,.589001,.62453,.00661266,0,.613789,.610601,.00618432,0,.639277,.59676,.00578033,0,.66551,.582433,.00540927,0,.692539,.568026,.00506104,0,.720422,.55414,.0047353,0,.749216,.540178,.00442889,0,.778974,.526513,.00414363,0,.809711,.512954,.00388237,0,.84127,.499403,.00362875,0,.873016,.486026,.00340827,0,.904762,.472345,.00318598,0,.936508,.458828,.00297635,0,.968254,.445379,.00279447,0,1,1,.0345716,0,0,1,.0345717,0,0,.999999,.034573,0,0,.999991,.0345787,0,0,.999974,.0345941,0,0,.999937,.0346263,0,188589e-11,.999869,.0346847,0,409238e-9,.999757,.0347798,0,.0017674,.999582,.0349233,0,.00413658,.999322,.0351265,0,.00747408,.998939,.0353967,0,.0117157,.998219,.0357018,0,.0167966,.994974,.0354726,0,.0226572,.993201,.0355621,0,.0292445,.991573,.0357641,0,.0365123,.989301,.0359252,0,.0444203,.985712,.0358017,0,.0529334,.982411,.0358353,0,.0620214,.977827,.035617,0,.0716574,.973278,.0354398,0,.0818186,.967397,.0350483,0,.0924846,.960696,.0344795,0,.103638,.954349,.0339861,0,.115263,.946066,.0331323,0,.127348,.938012,.032359,0,.13988,.929413,.0314413,0,.152849,.920355,.0304103,0,.166248,.910586,.0292785,0,.18007,.900609,.0281391,0,.194308,.890093,.0269103,0,.208958,.880013,.0257269,0,.224018,.869001,.0244671,0,.239485,.85751,.0232252,0,.255359,.84582,.0220117,0,.271638,.834383,.0208274,0,.288324,.822158,.0196628,0,.305419,.809056,.0185306,0,.322927,.795832,.0174174,0,.340851,.782547,.0163758,0,.359199,.7689,.015391,0,.377975,.755526,.0144488,0,.397189,.741681,.0135372,0,.416851,.728178,.0126957,0,.436971,.714642,.0118812,0,.457564,.702756,.0111165,0,.478644,.69175,.0104145,0,.500229,.680159,.00974439,0,.522339,.668073,.00911926,0,.544997,.655405,.00851393,0,.56823,.642921,.00797637,0,.592068,.629993,.00745119,0,.616546,.616828,.00696972,0,.641705,.603305,.00652425,0,.66759,.589833,.00610188,0,.694255,.575945,.00570834,0,.72176,.561745,.00533384,0,.750168,.548277,.00500001,0,.779545,.534467,.00467582,0,.809933,.521032,.00438092,0,.841272,.507877,.00410348,0,.873016,.494654,.00383618,0,.904762,.481592,.00358699,0,.936508,.468509,.00337281,0,.968254,.455293,.00316196,0,1,1,.0430698,0,0,1,.0430699,0,0,.999998,.0430713,0,0,.999991,.0430773,0,0,.99997,.0430936,0,0,.999928,.0431277,0,406396e-10,.999852,.0431893,0,744376e-9,.999724,.0432895,0,.0024806,.999527,.0434397,0,.00524779,.99923,.0436507,0,.00898164,.998783,.0439255,0,.0136083,.997507,.0441104,0,.0190582,.994418,.0438225,0,.0252694,.992864,.0439396,0,.0321879,.991127,.0440962,0,.039767,.987331,.0438408,0,.0479667,.984819,.0438991,0,.056752,.980384,.0435906,0,.0660929,.975846,.0432543,0,.075963,.970748,.0428293,0,.0863398,.964303,.042153,0,.0972035,.95772,.0414111,0,.108537,.950747,.0405893,0,.120325,.942533,.0394887,0,.132554,.934045,.0383544,0,.145215,.924942,.037057,0,.158296,.915811,.0356993,0,.17179,.90612,.0342401,0,.185691,.896434,.0328078,0,.199993,.886021,.031288,0,.214691,.876081,.0297776,0,.229782,.865608,.0282334,0,.245265,.854924,.026749,0,.261138,.843607,.02526,0,.277401,.832456,.0238214,0,.294056,.821342,.0224682,0,.311104,.809303,.0211297,0,.328548,.796468,.0198387,0,.346394,.784046,.0186227,0,.364645,.771262,.0174561,0,.38331,.758118,.0163806,0,.402396,.745075,.0153287,0,.421912,.731926,.0143647,0,.44187,.71863,.0134363,0,.462283,.705414,.0125603,0,.483165,.693792,.0117508,0,.504535,.683108,.0110016,0,.52641,.67183,.0102757,0,.548816,.66015,.00962044,0,.571776,.647907,.00898031,0,.595323,.635734,.00840811,0,.619489,.623208,.00786211,0,.644317,.610438,.00734953,0,.669852,.597345,.00687688,0,.696148,.584138,.00643469,0,.723267,.5707,.00602236,0,.75128,.556966,.0056324,0,.780258,.543607,.00528277,0,.810268,.530213,.00493999,0,.841311,.516912,.00462265,0,.873016,.503916,.0043307,0,.904762,.491146,.00406858,0,.936508,.478439,.00381436,0,.968254,.465834,.00358003,0,1,1,.0534039,0,0,1,.053404,0,0,.999998,.0534055,0,0,.999989,.0534116,0,0,.999968,.0534283,0,0,.999918,.0534633,0,155895e-9,.99983,.0535262,0,.00120914,.999685,.0536281,0,.00334944,.999461,.0537799,0,.00653077,.999119,.0539902,0,.0106718,.998582,.0542524,0,.0156907,.995919,.0540318,0,.0215147,.993735,.0538914,0,.0280801,.992126,.0539557,0,.0353323,.990266,.0540401,0,.0432247,.986317,.0536064,0,.0517172,.983213,.0534425,0,.0607754,.978303,.0528622,0,.0703698,.973665,.0523363,0,.0804742,.968091,.0516165,0,.0910667,.961026,.0505434,0,.102128,.954333,.049523,0,.113641,.946372,.0481698,0,.125591,.938254,.0467674,0,.137965,.929516,.0452341,0,.150754,.920106,.0435083,0,.163947,.910899,.0417399,0,.177537,.901532,.0399389,0,.191516,.891919,.0380901,0,.205881,.882006,.0362341,0,.220626,.871965,.0343444,0,.235749,.862145,.0324832,0,.251248,.852058,.0306681,0,.267121,.84161,.0289097,0,.283368,.830806,.0272079,0,.299992,.820476,.0256089,0,.316992,.809514,.0240394,0,.334374,.797865,.0225379,0,.35214,.785621,.0211235,0,.370296,.773765,.0197908,0,.388849,.761629,.0185235,0,.407807,.748891,.0173358,0,.427178,.736437,.0162305,0,.446974,.723707,.0151778,0,.467207,.710606,.0141791,0,.487892,.698019,.0132592,0,.509046,.686203,.0123887,0,.530687,.675692,.0115976,0,.552839,.664826,.0108325,0,.575527,.65349,.0101348,0,.59878,.641774,.00947756,0,.622634,.629794,.00886058,0,.647128,.617647,.00828526,0,.672308,.60534,.00775312,0,.698231,.592718,.00726033,0,.724958,.579746,.00679731,0,.752563,.566763,.00636111,0,.781127,.553515,.00595228,0,.810733,.540118,.00556876,0,.841426,.527325,.00523051,0,.873016,.514265,.00490712,0,.904762,.501406,.00460297,0,.936508,.488922,.00431247,0,.968254,.476541,.0040472,0,1,1,.0659184,0,0,1,.0659185,0,0,.999998,.06592,0,0,.999988,.0659259,0,0,.999963,.0659423,0,0,.999907,.0659764,0,374198e-9,.999806,.0660376,0,.00182071,.999639,.0661361,0,.0043894,.999378,.0662814,0,.00800055,.998985,.0664779,0,.0125594,.998285,.0666914,0,.0179786,.995071,.0661989,0,.0241822,.993172,.0660454,0,.031106,.991438,.0660105,0,.0386952,.988428,.0656875,0,.0469032,.985218,.0652913,0,.0556905,.981128,.0647107,0,.065023,.976015,.0638491,0,.0748717,.97097,.062993,0,.0852112,.964582,.0617927,0,.0960199,.957383,.0603626,0,.107279,.949969,.0588128,0,.118971,.941843,.0570274,0,.131084,.933624,.0551885,0,.143604,.924543,.053122,0,.156521,.914919,.0508897,0,.169825,.905773,.0486418,0,.18351,.896434,.0463364,0,.197569,.887195,.0440623,0,.211997,.877706,.0417799,0,.226789,.867719,.03945,0,.241944,.858587,.037243,0,.257458,.849317,.0350956,0,.273331,.839585,.0329852,0,.289563,.829856,.0310028,0,.306154,.819589,.0290953,0,.323108,.809714,.0272738,0,.340426,.79934,.0255631,0,.358113,.788224,.0239175,0,.376175,.776619,.0223831,0,.394616,.76521,.0209298,0,.413445,.753716,.0195786,0,.432671,.741564,.0183001,0,.452305,.729413,.0171259,0,.472358,.717146,.0159933,0,.492845,.70436,.0149495,0,.513783,.69219,.0139681,0,.535189,.680289,.0130577,0,.557087,.669611,.0122198,0,.5795,.659113,.0114174,0,.602459,.648148,.0106729,0,.625997,.636905,.00998997,0,.650154,.625154,.00934313,0,.674976,.613481,.00874839,0,.700518,.60154,.00818265,0,.726845,.58943,.00766889,0,.754032,.576828,.00717153,0,.782167,.564194,.00672696,0,.811344,.551501,.00630863,0,.841644,.538635,.00592177,0,.873016,.525724,.00554888,0,.904762,.513209,.00520225,0,.936508,.500457,.00488231,0,.968254,.48799,.00457153,0,1,1,.0810131,0,0,1,.0810133,0,0,.999997,.0810145,0,0,.999985,.08102,0,0,.999956,.0810347,0,195026e-10,.999893,.0810656,0,719316e-9,.999777,.0811205,0,.00259774,.999583,.081208,0,.00561807,.999281,.0813343,0,.00967472,.998813,.0814969,0,.0146627,.997597,.0815217,0,.0204902,.994379,.0808502,0,.0270802,.992744,.0806792,0,.0343674,.990745,.0804589,0,.0422974,.986646,.0796107,0,.0508242,.983611,.0790913,0,.0599087,.978869,.0780746,0,.0695175,.973475,.0768218,0,.0796223,.967845,.0754926,0,.0901983,.960778,.0737063,0,.101224,.953333,.0718052,0,.112682,.945274,.0695946,0,.124555,.936955,.0672492,0,.136831,.928319,.0647732,0,.149496,.919075,.0620947,0,.162542,.909114,.0591816,0,.175958,.900137,.0563917,0,.189739,.891069,.0535392,0,.203877,.882262,.0507642,0,.218368,.873232,.0479793,0,.233208,.864042,.045226,0,.248393,.855002,.0425413,0,.263923,.846569,.0400126,0,.279796,.837714,.0375269,0,.296012,.828918,.0352027,0,.312573,.819783,.0330011,0,.329479,.810129,.0308908,0,.346734,.800866,.0289112,0,.364342,.79093,.0270255,0,.382307,.780593,.0252758,0,.400637,.769511,.0236178,0,.419337,.758558,.0220652,0,.438418,.747632,.0206289,0,.457889,.736146,.0192873,0,.477761,.724093,.0180333,0,.49805,.71234,.0168264,0,.51877,.700201,.015746,0,.53994,.687949,.0147027,0,.561581,.676163,.0137512,0,.583718,.665001,.0128655,0,.60638,.65472,.0120366,0,.629599,.644213,.0112604,0,.653415,.633382,.0105413,0,.677874,.62212,.00986498,0,.70303,.610631,.00923308,0,.728948,.599078,.00864206,0,.755706,.587519,.00811784,0,.783396,.575505,.00761237,0,.812121,.563148,.00713949,0,.841989,.550828,.00668379,0,.873035,.538458,.00627715,0,.904762,.525905,.00588336,0,.936508,.513517,.00552687,0,.968254,.501395,.00519681,0,1,1,.0991506,0,0,1,.0991504,0,0,.999996,.0991515,0,0,.999984,.0991558,0,0,.999947,.0991672,0,114389e-9,.999874,.0991912,0,.00121503,.999739,.0992331,0,.00356108,.999514,.0992983,0,.00705578,.999159,.0993877,0,.011574,.998586,.0994837,0,.017003,.995731,.0988425,0,.0232484,.993384,.098276,0,.0302318,.991615,.0979269,0,.0378884,.989029,.0973432,0,.0461641,.985373,.0963539,0,.0550136,.981278,.0952306,0,.0643988,.975777,.0936233,0,.0742868,.970526,.0920219,0,.0846501,.963755,.0898912,0,.0954644,.956676,.0876064,0,.106709,.948099,.0847751,0,.118367,.939718,.0818638,0,.130423,.931305,.078857,0,.142862,.922342,.0756127,0,.155674,.912842,.0721473,0,.168849,.903304,.0686195,0,.182378,.89411,.0650589,0,.196255,.885512,.0616022,0,.210473,.877193,.0582434,0,.225027,.86877,.0548979,0,.239915,.860267,.0516095,0,.255132,.851915,.048468,0,.270678,.843912,.0454447,0,.286551,.83604,.0425612,0,.302751,.828245,.0398752,0,.31928,.820159,.0373198,0,.336138,.81167,.034916,0,.35333,.802659,.0326402,0,.370858,.793921,.0304901,0,.388728,.784713,.0284857,0,.406944,.774946,.0266186,0,.425515,.76448,.0248593,0,.444449,.753793,.0232114,0,.463756,.743506,.0217039,0,.483447,.732555,.0202841,0,.503535,.720965,.0189648,0,.524036,.709422,.0177189,0,.544968,.697756,.0165626,0,.56635,.685565,.015483,0,.588208,.673987,.0144892,0,.610569,.66244,.0135607,0,.633466,.651675,.0126956,0,.656936,.641598,.0118788,0,.681025,.63121,.0111261,0,.705788,.620514,.010437,0,.731289,.609366,.00978747,0,.757606,.598137,.00917257,0,.784834,.586966,.00859778,0,.813085,.575549,.00806803,0,.842485,.563797,.00757294,0,.87313,.551758,.00710592,0,.904762,.539894,.0066841,0,.936508,.527901,.00627901,0,.968254,.515819,.00590506,0,1,1,.120864,0,0,1,.120864,0,0,.999996,.120864,0,0,.99998,.120867,0,0,.99994,.120872,0,323781e-9,.999852,.120884,0,.00188693,.999693,.120903,0,.00473489,.999426,.120929,0,.00872704,.999002,.120955,0,.0137237,.998235,.120918,0,.0196068,.994608,.119764,0,.0262803,.992997,.119265,0,.0336657,.990968,.11863,0,.0416987,.987002,.117261,0,.0503261,.983524,.116009,0,.0595035,.97875,.114252,0,.0691935,.972652,.11193,0,.0793645,.966613,.109555,0,.0899894,.959275,.106612,0,.101045,.951272,.103375,0,.112512,.942323,.0996594,0,.124372,.933679,.0958841,0,.136611,.924822,.0919265,0,.149216,.915742,.0878061,0,.162176,.906348,.0834894,0,.175482,.896883,.079085,0,.189125,.88774,.0746745,0,.203098,.87986,.0705773,0,.217396,.871998,.0665005,0,.232015,.864325,.0625413,0,.24695,.856685,.0586781,0,.2622,.84925,.0550063,0,.277761,.841719,.0514727,0,.293634,.834755,.0481398,0,.309819,.827853,.0450172,0,.326315,.820888,.0420969,0,.343126,.813616,.0393702,0,.360254,.805767,.0367771,0,.377701,.797338,.0343274,0,.395474,.789122,.0320529,0,.413577,.780601,.0299485,0,.432018,.771424,.0279812,0,.450804,.761502,.0261054,0,.469944,.751166,.0243942,0,.489451,.741276,.0228087,0,.509337,.730898,.0213265,0,.529617,.719878,.0199307,0,.550307,.708379,.0186574,0,.571428,.697165,.0174446,0,.593003,.685554,.0163144,0,.615059,.673631,.015276,0,.637628,.662385,.0143003,0,.660746,.651059,.0134112,0,.68446,.640451,.0125794,0,.70882,.630536,.011793,0,.733893,.620316,.0110547,0,.759756,.609722,.0103668,0,.786505,.598804,.00973009,0,.814259,.587871,.00912812,0,.843157,.577121,.00858916,0,.87334,.566019,.00807333,0,.904762,.554664,.00759687,0,.936508,.543101,.00714759,0,.968254,.531558,.00673418,0,1,1,.146767,0,0,1,.146767,0,0,.999997,.146767,0,0,.999977,.146765,0,320658e-11,.999929,.146762,0,682576e-9,.999823,.146753,0,.00276402,.999633,.146735,0,.00614771,.999314,.146699,0,.0106613,.998796,.14662,0,.0161546,.997124,.146107,0,.0225063,.994062,.144857,0,.0296198,.992154,.144011,0,.037417,.989186,.142712,0,.0458348,.985279,.140926,0,.0548211,.980826,.13885,0,.0643326,.975056,.136168,0,.074333,.969005,.133217,0,.0847917,.961554,.12959,0,.0956828,.954206,.125886,0,.106984,.945046,.121335,0,.118675,.935678,.116492,0,.130741,.926748,.111635,0,.143166,.917764,.106625,0,.155939,.908358,.101325,0,.169049,.899219,.0960249,0,.182487,.890089,.0906527,0,.196245,.881488,.0853905,0,.210317,.874031,.0804177,0,.224697,.866932,.0756005,0,.23938,.859976,.0709019,0,.254364,.853375,.0664391,0,.269646,.846971,.0622012,0,.285223,.840483,.058129,0,.301096,.833969,.0542762,0,.317265,.82806,.0507042,0,.333729,.822128,.047368,0,.350491,.815989,.044272,0,.367554,.809336,.0413444,0,.38492,.802177,.038601,0,.402594,.79441,.0360227,0,.420582,.786573,.0336383,0,.438891,.778619,.0314321,0,.457527,.77,.029362,0,.476499,.760698,.0274102,0,.49582,.750932,.0256146,0,.5155,.740993,.023974,0,.535555,.731159,.0224182,0,.556,.720836,.0209889,0,.576855,.709913,.0196411,0,.598143,.698415,.0183824,0,.619888,.68745,.0172222,0,.642123,.676154,.0161509,0,.664883,.664383,.0151397,0,.688211,.6533,.0141873,0,.71216,.642072,.0133105,0,.736792,.631412,.0124932,0,.762186,.621622,.0117408,0,.788439,.611681,.0110358,0,.815672,.60142,.0103775,0,.844034,.59083,.00975623,0,.873699,.580254,.00918084,0,.904765,.569841,.00864721,0,.936508,.559224,.00815731,0,.968254,.548315,.00767924,0,1,1,.177563,0,0,1,.177563,0,0,.999994,.177562,0,0,.999972,.177555,0,664171e-10,.999914,.177536,0,.0012276,.999787,.177496,0,.00388025,.999556,.17742,0,.00783463,.999165,.177285,0,.0128953,.9985,.177037,0,.0189053,.995388,.175634,0,.025742,.993102,.174375,0,.033309,.990992,.173121,0,.0415298,.986932,.170896,0,.0503425,.982786,.16847,0,.0596964,.977592,.165455,0,.0695498,.971075,.161676,0,.0798676,.963967,.157458,0,.0906201,.956397,.152836,0,.101783,.947489,.147467,0,.113333,.937564,.14145,0,.125254,.928182,.135383,0,.137529,.919027,.129212,0,.150144,.909618,.12276,0,.163088,.900492,.116273,0,.176351,.891671,.1098,0,.189924,.883146,.103362,0,.203799,.875151,.0970799,0,.21797,.868338,.0911732,0,.232433,.862033,.0854966,0,.247182,.856107,.0800691,0,.262216,.850644,.0749618,0,.27753,.845261,.070079,0,.293124,.839885,.0654321,0,.308997,.834609,.0610975,0,.325149,.829083,.0569741,0,.341581,.82404,.0531736,0,.358294,.818968,.049665,0,.37529,.813496,.0463856,0,.392573,.807533,.0433217,0,.410148,.80099,.0404402,0,.428019,.793891,.0377578,0,.446192,.786281,.0352616,0,.464676,.778773,.0329577,0,.483478,.770737,.030808,0,.502608,.762094,.0287964,0,.522079,.752898,.0269254,0,.541905,.743306,.0251926,0,.5621,.733416,.023595,0,.582684,.723742,.0221155,0,.603677,.713542,.0207435,0,.625106,.702755,.019434,0,.646998,.691484,.0182046,0,.66939,.680531,.0170771,0,.692324,.66953,.0160339,0,.715849,.658126,.0150677,0,.740028,.646933,.0141551,0,.764937,.636107,.0133179,0,.790673,.625271,.0125284,0,.817358,.615225,.0117937,0,.84515,.605678,.0111181,0,.874244,.59583,.0104759,0,.904828,.585704,.00986672,0,.936508,.575413,.00929712,0,.968254,.565373,.00876713,0,1,1,.214058,0,0,.999999,.214058,0,0,.999994,.214055,0,0,.999966,.214039,0,259642e-9,.999893,.213998,0,.00200075,.999737,.21391,0,.00527775,.999449,.213745,0,.00983959,.99896,.213458,0,.0154755,.9979,.212855,0,.0220249,.994278,.210779,0,.0293654,.992254,.20926,0,.0374021,.98881,.206908,0,.0460604,.984715,.204009,0,.0552802,.979738,.200471,0,.0650127,.972884,.195813,0,.0752175,.965996,.190856,0,.0858612,.957974,.185077,0,.0969155,.949155,.17868,0,.108356,.939288,.171513,0,.120163,.928996,.163838,0,.132319,.919563,.156246,0,.144808,.910004,.148359,0,.157618,.900791,.140417,0,.170737,.892135,.132569,0,.184155,.883803,.124741,0,.197866,.876034,.117091,0,.211861,.869219,.109835,0,.226134,.863062,.102859,0,.240682,.857795,.0962928,0,.255499,.853009,.0900725,0,.270583,.848603,.0842101,0,.285931,.844335,.0786527,0,.301542,.840208,.0734397,0,.317415,.836035,.0685334,0,.33355,.83172,.0639275,0,.349948,.827135,.0595909,0,.36661,.822797,.0556204,0,.383539,.818387,.0519394,0,.400738,.813565,.0485317,0,.41821,.808142,.0453138,0,.435961,.802212,.0423354,0,.453997,.79573,.0395553,0,.472324,.788741,.036988,0,.490951,.781093,.0345688,0,.509887,.773597,.0323297,0,.529144,.765622,.0302719,0,.548735,.757083,.0283477,0,.568674,.747992,.0265562,0,.588979,.738591,.0248844,0,.609671,.728719,.0233342,0,.630773,.719146,.0219081,0,.652314,.709165,.0205711,0,.674328,.69875,.0193248,0,.696854,.687884,.0181582,0,.719942,.676818,.0170746,0,.743651,.666247,.0160718,0,.768057,.655284,.0151262,0,.793253,.64401,.0142561,0,.819363,.633353,.0134327,0,.846547,.622674,.012653,0,.875017,.612265,.0119354,0,.905021,.602455,.0112533,0,.936508,.593147,.0106234,0,.968254,.583592,.0100213,0,1,1,.25717,0,0,1,.25717,0,0,.999992,.257164,0,0,.999958,.257135,0,641715e-9,.999864,.25706,0,.00305314,.999666,.256897,0,.00700975,.999302,.256596,0,.0122194,.998663,.25607,0,.0184622,.995607,.254123,0,.0255773,.993094,.252081,0,.0334439,.9907,.249867,0,.0419696,.98594,.246118,0,.0510823,.981214,.242049,0,.0607242,.974966,.236869,0,.0708486,.967589,.230724,0,.081417,.95915,.223635,0,.0923974,.950257,.21596,0,.103763,.940165,.207296,0,.115491,.929396,.197901,0,.127562,.919288,.188437,0,.13996,.909428,.178762,0,.15267,.900105,.169072,0,.165679,.891418,.159478,0,.178979,.883347,.15002,0,.192558,.875992,.140813,0,.20641,.869466,.13196,0,.220529,.863699,.123501,0,.234907,.858553,.115436,0,.249542,.854379,.107901,0,.264428,.850894,.10088,0,.279564,.847632,.0942296,0,.294947,.844571,.0879861,0,.310575,.84163,.0821534,0,.326448,.838542,.0766409,0,.342566,.835412,.0715322,0,.358929,.831899,.0666883,0,.37554,.828177,.0622175,0,.392399,.82416,.0580452,0,.409511,.820393,.054267,0,.426878,.816068,.0507172,0,.444506,.811201,.0474041,0,.4624,.805785,.0443174,0,.480566,.799878,.0414562,0,.499013,.793469,.0388147,0,.517749,.786473,.0363453,0,.536785,.778874,.0340225,0,.556134,.771277,.0318599,0,.575809,.763426,.0298859,0,.595827,.755044,.0280357,0,.616207,.746161,.0262979,0,.636973,.737124,.0247295,0,.65815,.72761,.0232514,0,.679772,.717822,.0218755,0,.701876,.708279,.0205942,0,.724509,.698333,.0193947,0,.74773,.68802,.0182717,0,.771609,.677321,.0172044,0,.79624,.666504,.0162122,0,.821743,.656184,.0152924,0,.84828,.64556,.0144326,0,.876069,.634636,.0136157,0,.905404,.624124,.0128612,0,.936508,.613914,.0121435,0,.968254,.603589,.0114887,0,1,1,.307946,0,0,.999999,.307945,0,0,.999988,.307934,0,204479e-10,.999944,.307886,0,.00127833,.999824,.307756,0,.00445047,.999565,.30748,0,.00914673,.999085,.306966,0,.0150498,.998103,.306004,0,.0219367,.994249,.303028,0,.0296485,.991807,.300435,0,.038068,.987773,.296554,0,.0471062,.982673,.2916,0,.0566942,.976623,.285641,0,.0667768,.968757,.27815,0,.0773099,.959849,.269529,0,.088257,.950663,.260248,0,.0995879,.940129,.249704,0,.111277,.92895,.238291,0,.123304,.917996,.226501,0,.13565,.907813,.214669,0,.148299,.898305,.202835,0,.161237,.889626,.191158,0,.174455,.88175,.179695,0,.187941,.874715,.168548,0,.201687,.868746,.15792,0,.215687,.863703,.147807,0,.229933,.859315,.138149,0,.24442,.855538,.128993,0,.259145,.852428,.120414,0,.274103,.850168,.112498,0,.289293,.848132,.105054,0,.304711,.846291,.0981087,0,.320357,.844431,.0915942,0,.33623,.842493,.0855056,0,.35233,.840368,.0798204,0,.368658,.83798,.0745097,0,.385214,.83523,.0695424,0,.402002,.832091,.0649092,0,.419023,.828667,.0606291,0,.436282,.824805,.0566523,0,.453782,.820988,.0530229,0,.471529,.816635,.0496364,0,.489528,.811725,.0464658,0,.507788,.806316,.0435082,0,.526317,.800469,.0407873,0,.545124,.794107,.038255,0,.564221,.787218,.0358825,0,.583621,.779872,.0336785,0,.603341,.772097,.0316379,0,.623397,.764484,.0297379,0,.643812,.756428,.0279581,0,.664611,.748022,.0263153,0,.685824,.739268,.0247799,0,.707488,.73024,.0233385,0,.729646,.720893,.0220035,0,.752354,.71119,.0207555,0,.77568,.701791,.0195843,0,.799715,.692184,.0184891,0,.824574,.682258,.0174541,0,.850417,.67206,.0164873,0,.877466,.661717,.0155959,0,.90604,.651462,.0147519,0,.936528,.641467,.0139727,0,.968254,.631229,.0132363,0,1,1,.367573,0,0,.999999,.367571,0,0,.999984,.367553,0,183382e-9,.999925,.367473,0,.00225254,.999759,.367259,0,.00628165,.99941,.366801,0,.0117858,.998739,.365946,0,.0184359,.995529,.363191,0,.0260114,.992875,.360171,0,.0343581,.989135,.355981,0,.0433637,.984166,.350401,0,.0529438,.977871,.343348,0,.0630334,.96951,.334341,0,.0735805,.959964,.323862,0,.0845437,.950162,.312521,0,.095889,.938882,.299577,0,.107588,.926992,.285573,0,.119617,.915589,.271212,0,.131957,.904791,.256611,0,.144591,.895177,.242224,0,.157503,.886403,.227952,0,.170682,.878957,.214192,0,.184117,.872418,.200795,0,.197799,.867029,.188015,0,.21172,.862835,.175975,0,.225873,.859411,.164526,0,.240253,.856655,.153693,0,.254854,.854519,.14352,0,.269673,.852828,.13397,0,.284707,.851412,.124984,0,.299953,.850609,.116748,0,.315408,.849855,.10905,0,.331073,.849017,.101839,0,.346946,.848079,.0951359,0,.363028,.846911,.0888774,0,.379318,.845445,.0830375,0,.395818,.84362,.0775844,0,.41253,.841411,.0725054,0,.429457,.838768,.0677691,0,.446602,.835801,.0634016,0,.463968,.832341,.0593095,0,.481561,.828424,.0555121,0,.499386,.824312,.052024,0,.51745,.819918,.0487865,0,.535761,.815072,.0457801,0,.554328,.809863,.0430184,0,.573162,.804164,.0404245,0,.592275,.798034,.0380146,0,.611681,.791436,.0357436,0,.631398,.784498,.0336475,0,.651445,.777125,.0316666,0,.671845,.769365,.0298122,0,.692628,.761579,.0281001,0,.713827,.753746,.0265049,0,.735484,.745573,.0250067,0,.75765,.737083,.0236026,0,.78039,.728545,.0223302,0,.803789,.719691,.0211243,0,.82796,.710569,.0199983,0,.853056,.701216,.0189569,0,.879298,.692094,.0179702,0,.907014,.682909,.0170418,0,.936691,.673509,.0161732,0,.968254,.663863,.0153406,0,1,1,.437395,0,0,.999998,.437394,0,0,.99998,.437363,0,616704e-9,.999891,.437232,0,.00367925,.999656,.436877,0,.00867446,.999148,.436121,0,.0150679,.997959,.434564,0,.022531,.993464,.430134,0,.0308507,.990606,.426077,0,.0398805,.985027,.419397,0,.0495148,.978491,.41118,0,.0596749,.969643,.40048,0,.0703001,.959189,.38769,0,.0813427,.948223,.373575,0,.0927641,.935955,.357622,0,.104533,.923237,.34043,0,.116624,.911074,.322735,0,.129015,.899724,.30479,0,.141687,.890189,.287392,0,.154626,.881796,.270248,0,.167818,.874781,.253659,0,.181252,.869166,.237786,0,.194918,.864725,.222618,0,.208807,.861565,.208356,0,.222913,.859284,.194867,0,.237229,.857677,.18212,0,.25175,.856714,.17018,0,.266473,.856155,.158969,0,.281392,.8558,.148413,0,.296505,.855672,.138578,0,.311811,.855538,.129345,0,.327306,.855689,.120861,0,.342991,.855767,.112969,0,.358864,.855618,.105593,0,.374925,.85525,.0987451,0,.391176,.854583,.0923727,0,.407616,.853534,.0864143,0,.424249,.852061,.0808338,0,.441076,.850253,.0756771,0,.4581,.848004,.0708612,0,.475324,.845333,.0663784,0,.492754,.842376,.0622631,0,.510394,.838956,.0584112,0,.528251,.835121,.0548328,0,.546331,.830842,.0514838,0,.564644,.826212,.048355,0,.583198,.821522,.0454714,0,.602005,.816551,.0428263,0,.621078,.811211,.0403612,0,.640434,.805479,.038039,0,.660089,.799409,.0358739,0,.680066,.79306,.0338727,0,.70039,.786395,.0319985,0,.721094,.779416,.030241,0,.742215,.77214,.0285951,0,.7638,.764636,.0270747,0,.785912,.756836,.0256354,0,.808628,.749315,.0243027,0,.832055,.741561,.0230497,0,.856338,.733589,.0218801,0,.88169,.725479,.020784,0,.908441,.717255,.0197702,0,.937125,.708829,.0188168,0,.968254,.700191,.0179113,0,1,1,.518937,0,0,.999998,.518933,0,0,.999967,.518883,0,.00147741,.999832,.51866,0,.00573221,.999466,.518057,0,.011826,.998644,.516752,0,.0192116,.994458,.512347,0,.027573,.991223,.507675,0,.0367099,.985515,.500188,0,.046487,.978308,.490408,0,.0568071,.968359,.477357,0,.0675984,.95682,.461752,0,.0788059,.943929,.443796,0,.090386,.930224,.423893,0,.102304,.916514,.402682,0,.114532,.903653,.380914,0,.127047,.892315,.359212,0,.139828,.882942,.338102,0,.152861,.875438,.31773,0,.16613,.869642,.298186,0,.179624,.865304,.279491,0,.193332,.862382,.261804,0,.207247,.860666,.245146,0,.22136,.859788,.229406,0,.235666,.859608,.214605,0,.250158,.859912,.200691,0,.264832,.86053,.187623,0,.279684,.861368,.17539,0,.294711,.862237,.163901,0,.309911,.863127,.153175,0,.32528,.863923,.143147,0,.340819,.864567,.133781,0,.356524,.865013,.125042,0,.372397,.86539,.116952,0,.388438,.865591,.109476,0,.404645,.865517,.102542,0,.421022,.865084,.0960688,0,.437569,.864309,.0900499,0,.454287,.863151,.0844328,0,.471181,.861649,.0792218,0,.488253,.859742,.0743482,0,.505507,.857446,.0697963,0,.522947,.854757,.0655364,0,.54058,.851783,.061608,0,.558412,.848516,.0579701,0,.576449,.844897,.0545742,0,.594701,.840956,.0514167,0,.613178,.836676,.0484598,0,.631892,.832075,.0456934,0,.650856,.827191,.0431178,0,.670088,.822295,.0407718,0,.689606,.817294,.0386032,0,.709434,.812013,.0365675,0,.7296,.806465,.0346547,0,.750138,.800691,.0328717,0,.771093,.794709,.031211,0,.792519,.788493,.0296504,0,.814488,.782049,.0281782,0,.837097,.775403,.0267965,0,.860481,.76857,.0255002,0,.884842,.761536,.0242759,0,.910494,.754303,.0231142,0,.937985,.74692,.0220305,0,.968254,.739745,.0210192,0,1,1,.613914,0,0,.999996,.613907,0,963597e-10,.999942,.613814,0,.00301247,.999704,.613407,0,.00870385,.999046,.612302,0,.0160714,.995516,.608266,0,.0245899,.991726,.602863,0,.0339681,.985157,.593956,0,.0440254,.97642,.581748,0,.0546409,.964404,.565183,0,.0657284,.950601,.545273,0,.0772246,.935158,.522129,0,.0890812,.919364,.496782,0,.10126,.904754,.470571,0,.113731,.89176,.444037,0,.126469,.881492,.418322,0,.139454,.873656,.393522,0,.15267,.868053,.369795,0,.166101,.864336,.347171,0,.179736,.862259,.325737,0,.193565,.861556,.305532,0,.207578,.861776,.286416,0,.221769,.862661,.268355,0,.23613,.864015,.251334,0,.250656,.865711,.235352,0,.265343,.867519,.220302,0,.280187,.869351,.206161,0,.295183,.871144,.192908,0,.31033,.872839,.180505,0,.325624,.874307,.168848,0,.341065,.875667,.158021,0,.35665,.876758,.147877,0,.37238,.87764,.138441,0,.388253,.878237,.129627,0,.404269,.878563,.121415,0,.42043,.878572,.113741,0,.436735,.87842,.106652,0,.453187,.878057,.100097,0,.469786,.877413,.0940128,0,.486536,.87646,.0883462,0,.503439,.875233,.0830924,0,.520498,.8737,.0781975,0,.537717,.871873,.07364,0,.555102,.86978,.0694103,0,.572657,.867405,.0654696,0,.59039,.864751,.0617914,0,.608307,.861818,.0583491,0,.626419,.858645,.0551443,0,.644733,.855307,.0521894,0,.663264,.851736,.0494334,0,.682025,.847927,.0468504,0,.701032,.843888,.0444261,0,.720308,.839629,.0421497,0,.739875,.835158,.0400082,0,.759764,.830509,.0380076,0,.780014,.825714,.0361488,0,.800673,.820729,.0343956,0,.821803,.815751,.0327781,0,.843492,.810752,.031275,0,.86586,.805587,.0298542,0,.889087,.800317,.0285397,0,.913466,.79489,.0272948,0,.93952,.789314,.0261139,0,.96835,.783593,.0249938,0,1,1,.724258,0,0,.999992,.724243,0,726889e-9,.99987,.724044,0,.00569574,.999336,.72317,0,.0131702,.996271,.719432,0,.0220738,.991159,.712576,0,.0319405,.982465,.700927,0,.0425202,.97049,.684297,0,.0536599,.953973,.661244,0,.065258,.935546,.633804,0,.0772427,.916596,.603071,0,.0895616,.899353,.57105,0,.102175,.885216,.539206,0,.11505,.875076,.508714,0,.128164,.868334,.479571,0,.141495,.864414,.451796,0,.155026,.862678,.425328,0,.168745,.862835,.400352,0,.182639,.864067,.376532,0,.196699,.866086,.35391,0,.210915,.868557,.332424,0,.225282,.871271,.312053,0,.239792,.874058,.292764,0,.25444,.8768,.27453,0,.269223,.87939,.257297,0,.284135,.8819,.24114,0,.299174,.884187,.225934,0,.314337,.886262,.211669,0,.329622,.888119,.198311,0,.345026,.889709,.185783,0,.360549,.891054,.174063,0,.376189,.892196,.163143,0,.391946,.893101,.152952,0,.407819,.893803,.143475,0,.423808,.894277,.134647,0,.439914,.894532,.126434,0,.456137,.894576,.1188,0,.472479,.894393,.111694,0,.48894,.893976,.105069,0,.505523,.893346,.0989077,0,.52223,.892502,.0931724,0,.539064,.891441,.0878276,0,.556028,.890276,.082903,0,.573125,.888972,.0783505,0,.590361,.887469,.0741083,0,.607741,.885785,.0701633,0,.62527,.883914,.0664835,0,.642957,.881872,.0630567,0,.660809,.879651,.0598527,0,.678836,.877267,.0568615,0,.69705,.874717,.05406,0,.715465,.872012,.0514378,0,.734098,.869157,.0489805,0,.752968,.866155,.0466727,0,.772101,.863014,.0445056,0,.791529,.859748,.0424733,0,.81129,.856416,.0405957,0,.831438,.852958,.0388273,0,.852044,.849382,.0371619,0,.87321,.845694,.0355959,0,.89509,.841893,.0341155,0,.917932,.837981,.0327141,0,.942204,.833963,.0313856,0,.968981,.829847,.0301275,0,1,1,.85214,0,0,.999969,.852095,0,.00279627,.999483,.851408,0,.0107635,.994545,.84579,0,.0206454,.986188,.835231,0,.0315756,.969847,.814687,0,.0432021,.945951,.783735,0,.0553396,.91917,.746074,0,.0678766,.895488,.706938,0,.0807395,.878232,.669534,0,.0938767,.868252,.635168,0,.10725,.863873,.603069,0,.120832,.863369,.572514,0,.134598,.86545,.543169,0,.148533,.868803,.514578,0,.16262,.872794,.486762,0,.176849,.87702,.459811,0,.19121,.881054,.433654,0,.205694,.884974,.408574,0,.220294,.888587,.384525,0,.235005,.891877,.36156,0,.24982,.894793,.339661,0,.264737,.89743,.318913,0,.279751,.899796,.299302,0,.294859,.901943,.280843,0,.310058,.903858,.263481,0,.325346,.905574,.247197,0,.340721,.907069,.231915,0,.356181,.908379,.217614,0,.371725,.90952,.20425,0,.387353,.910483,.191758,0,.403063,.91128,.180092,0,.418854,.911936,.169222,0,.434727,.912454,.159098,0,.450682,.912835,.149668,0,.466718,.913078,.140884,0,.482837,.913192,.132709,0,.499038,.913175,.125095,0,.515324,.91304,.118012,0,.531695,.912781,.111417,0,.548153,.91241,.105281,0,.5647,.911924,.0995691,0,.581338,.911331,.0942531,0,.59807,.910637,.0893076,0,.6149,.90984,.0846998,0,.63183,.908941,.0804044,0,.648865,.907944,.0763984,0,.666011,.906857,.0726638,0,.683273,.90568,.0691783,0,.700659,.904416,.0659222,0,.718176,.903067,.0628782,0,.735834,.901637,.0600307,0,.753646,.900128,.0573647,0,.771625,.898544,.0548668,0,.78979,.89689,.052527,0,.808162,.895165,.0503306,0,.826771,.893371,.0482668,0,.845654,.891572,.0463605,0,.864863,.889763,.0445998,0,.884472,.887894,.0429451,0,.904592,.885967,.0413884,0,.925407,.883984,.0399225,0,.947271,.881945,.0385405,0,.97105,.879854,.0372362,0,1,.999804,.995833,0,0,.938155,.933611,0,.0158731,.864755,.854311,0,.0317461,.888594,.865264,0,.0476191,.905575,.863922,0,.0634921,.915125,.850558,0,.0793651,.920665,.829254,0,.0952381,.924073,.802578,0,.111111,.926304,.772211,0,.126984,.927829,.739366,0,.142857,.928924,.705033,0,.15873,.92973,.670019,0,.174603,.930339,.634993,0,.190476,.930811,.600485,0,.206349,.931191,.566897,0,.222222,.93149,.534485,0,.238095,.931737,.503429,0,.253968,.931939,.473811,0,.269841,.932108,.445668,0,.285714,.93225,.418993,0,.301587,.932371,.393762,0,.31746,.932474,.369939,0,.333333,.932562,.347479,0,.349206,.932638,.326336,0,.365079,.932703,.306462,0,.380952,.93276,.287805,0,.396825,.932809,.270313,0,.412698,.932851,.253933,0,.428571,.932887,.23861,0,.444444,.932917,.224289,0,.460317,.932943,.210917,0,.47619,.932965,.19844,0,.492063,.932982,.186807,0,.507937,.932995,.175966,0,.52381,.933005,.165869,0,.539683,.933011,.156468,0,.555556,.933013,.147719,0,.571429,.933013,.139579,0,.587302,.93301,.132007,0,.603175,.933004,.124965,0,.619048,.932994,.118416,0,.634921,.932982,.112326,0,.650794,.932968,.106663,0,.666667,.93295,.101397,0,.68254,.932931,.0964993,0,.698413,.932908,.0919438,0,.714286,.932883,.0877057,0,.730159,.932856,.0837623,0,.746032,.932827,.0800921,0,.761905,.932796,.0766754,0,.777778,.932762,.0734936,0,.793651,.932727,.0705296,0,.809524,.932689,.0677676,0,.825397,.93265,.0651929,0,.84127,.932609,.0627917,0,.857143,.932565,.0605515,0,.873016,.932521,.0584606,0,.888889,.932474,.0565082,0,.904762,.932427,.0546841,0,.920635,.932377,.0529793,0,.936508,.932326,.0513851,0,.952381,.932274,.0498936,0,.968254,.93222,.0484975,0,.984127,.932164,.0471899,0,1],r=new Float32Array(e),n=new Float32Array(t);Te.LTC_FLOAT_1=new Rr(r,64,64,at,qt,Oi,Ft,Ft,lt,it,1),Te.LTC_FLOAT_2=new Rr(n,64,64,at,qt,Oi,Ft,Ft,lt,it,1),Te.LTC_FLOAT_1.needsUpdate=!0,Te.LTC_FLOAT_2.needsUpdate=!0;let i=new Uint16Array(e.length);e.forEach(function(a,c){i[c]=Z3.toHalfFloat(a)});let s=new Uint16Array(t.length);t.forEach(function(a,c){s[c]=Z3.toHalfFloat(a)}),Te.LTC_HALF_1=new Rr(i,64,64,at,qr,Oi,Ft,Ft,lt,it,1),Te.LTC_HALF_2=new Rr(s,64,64,at,qr,Oi,Ft,Ft,lt,it,1),Te.LTC_HALF_1.needsUpdate=!0,Te.LTC_HALF_2.needsUpdate=!0}};var Kf=class extends Ke{static type(){return"areaLight"}cook(e,t){let r=this.createLight();if(this.updateLightParams(r,t),t.showHelper){let n=new st;return n.add(r),n.add(this._createHelper(r)),this.createCoreGroupFromObjects([n])}else return this.createCoreGroupFromObjects([r])}createLight(){let e=new ld(16777215,1,1,1);return e.matrixAutoUpdate=!1,$f.initialized||($f.init(),$f.initialized=!0),e}updateLightParams(e,t){e.color=t.color,e.intensity=t.intensity,e.width=t.width,e.height=t.height}_createHelper(e){let t=new El(e);return t.update(),t}};Kf.DEFAULT_PARAMS=ov;Kf.INPUT_CLONED_STATE=ke.NEVER;var gF=class extends _F(io(U)){},sne=new gF,nv=class extends Xf{constructor(){super(...arguments);this.paramsConfig=sne}static type(){return"areaLight"}_operation(){return this.__operation__=this.__operation__||new Kf(this._scene,this.states)}createLight(){return this._operation().createLight()}updateLightParams(){this._operation().updateLightParams(this.light,this.pv),this.pv.showHelper?(this._helper=this._helper||new El(this.light),this.light.add(this._helper),this._helper.update()):this._helper&&this.light.remove(this._helper)}};var F0=(o=>(o.GEO="geo",o.CUBE_CAMERA="cubeCamera",o.AUDIO_LISTENER="audioListener",o.POSITIONAL_AUDIO="positionalAudio",o.SCENE="scene",o))(F0||{});var Jf=class{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=vF(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){let t=vF();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}};function vF(){return(typeof performance>"u"?Date:performance).now()}var J9=class extends je{constructor(){super(...arguments);this.name="Listener",this.positionX=new ft({context:this.context,param:this.context.rawContext.listener.positionX}),this.positionY=new ft({context:this.context,param:this.context.rawContext.listener.positionY}),this.positionZ=new ft({context:this.context,param:this.context.rawContext.listener.positionZ}),this.forwardX=new ft({context:this.context,param:this.context.rawContext.listener.forwardX}),this.forwardY=new ft({context:this.context,param:this.context.rawContext.listener.forwardY}),this.forwardZ=new ft({context:this.context,param:this.context.rawContext.listener.forwardZ}),this.upX=new ft({context:this.context,param:this.context.rawContext.listener.upX}),this.upY=new ft({context:this.context,param:this.context.rawContext.listener.upY}),this.upZ=new ft({context:this.context,param:this.context.rawContext.listener.upZ})}static getDefaults(){return Object.assign(je.getDefaults(),{positionX:0,positionY:0,positionZ:0,forwardX:0,forwardY:0,forwardZ:-1,upX:0,upY:1,upZ:0})}dispose(){return super.dispose(),this.positionX.dispose(),this.positionY.dispose(),this.positionZ.dispose(),this.forwardX.dispose(),this.forwardY.dispose(),this.forwardZ.dispose(),this.upX.dispose(),this.upY.dispose(),this.upZ.dispose(),this}};Vp(o=>{o.listener=new J9({context:o})});Gp(o=>{o.listener.dispose()});var Sl=new M,yF=new It,ane=new M,wl=new M,iv=class extends vt{constructor(){super();this.timeDelta=0,this._clock=new Jf,this.listenerTransformAutoUpdate=!0;let e=new J9;this.context=e.context.rawContext,this.gain=new Qt,this.gain.connect(this.context.destination)}async addInput(e){e.connect(this.gain)}dispose(){this.setMasterVolume(0),this.gain.disconnect()}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}masterVolume(){return this.gain.gain.value}updateMatrixWorld(e){if(super.updateMatrixWorld(e),!this.listenerTransformAutoUpdate)return;let t=this.context.listener,r=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(Sl,yF,ane),wl.set(0,0,-1).applyQuaternion(yF),t.positionX){let n=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(Sl.x,n),t.positionY.linearRampToValueAtTime(Sl.y,n),t.positionZ.linearRampToValueAtTime(Sl.z,n),t.forwardX.linearRampToValueAtTime(wl.x,n),t.forwardY.linearRampToValueAtTime(wl.y,n),t.forwardZ.linearRampToValueAtTime(wl.z,n),t.upX.linearRampToValueAtTime(r.x,n),t.upY.linearRampToValueAtTime(r.y,n),t.upZ.linearRampToValueAtTime(r.z,n)}else t.setPosition(Sl.x,Sl.y,Sl.z),t.setOrientation(wl.x,wl.y,wl.z,r.x,r.y,r.z)}};var Z9=class{constructor(){this._started=!1}static instance(){return this._instance=this._instance||new Z9}async start(){this._started||await hk()}},xF=Z9.instance();var bF=class extends io(U){constructor(){super(...arguments);this.audio=y.FOLDER(),this.soundOn=y.BOOLEAN(1,{cook:!1,callback:e=>{Qf.PARAM_CALLBACK_update(e)}}),this.masterVolume=y.FLOAT(1,{range:[0,1],rangeLocked:[!0,!1]}),this.listenerTransformAutoUpdate=y.BOOLEAN(1)}},cne=new bF,Zf=class extends no{constructor(){super(...arguments);this.paramsConfig=cne,this.hierarchyController=new so(this),this.transformController=new jo(this),this.flags=new vo(this),this._boundEvents={pointerdown:this._onpointerdown.bind(this),keypress:this._onkeypress.bind(this)}}static type(){return F0.AUDIO_LISTENER}createObject(){let o=new iv;return o.matrixAutoUpdate=!1,o}initializeNode(){this.hierarchyController.initializeNode(),this.transformController.initializeNode(),this.lifecycle.onAfterAdded(()=>{this._setPositionalAudioNodesDirty(),this.addAudioActivationEvents(),this.root().audioController.update()})}dispose(){super.dispose(),this.object.dispose(),this._setPositionalAudioNodesDirty(),this.root().audioController.update()}toggleSound(){this.p.soundOn.set(!this.pv.soundOn)}_setPositionalAudioNodesDirty(){this.root().nodesByType("positionalAudio").forEach(o=>o.setDirty())}cook(){this.transformController.update(),this._validateUniq(),this._updateListenerAndViewers(),this.cookController.endCook()}_validateUniq(){this.root().audioController.audioListeners().length>1&&this.states.error.set("only 1 audioListener can exist in a scene")}_updateAudioListener(){let o=this.pv.soundOn?this.pv.masterVolume:0;this.object.setMasterVolume(o),this.object.listenerTransformAutoUpdate=this.pv.listenerTransformAutoUpdate}_updateViewers(){this.root().audioController.update()}_updateListenerAndViewers(){this._updateAudioListener(),this._updateViewers()}static PARAM_CALLBACK_update(o){o._updateListenerAndViewers()}async _onpointerdown(o){await this.activateSound()}async _onkeypress(o){await this.activateSound()}static soundActivated(){return this._audioActivated}soundActivated(){return Zf.soundActivated()}async activateSound(){this.soundActivated()||(await xF.start(),Zf._audioActivated=!0),this._removeAudioActivationEvents()}addAudioActivationEvents(){this.soundActivated()||Zf._eventsAdded||(Zf._eventsAdded=!0,document.body.addEventListener("pointerdown",this._boundEvents.pointerdown),document.body.addEventListener("keypress",this._boundEvents.keypress))}_removeAudioActivationEvents(){document.body.removeEventListener("pointerdown",this._boundEvents.pointerdown),document.body.removeEventListener("keypress",this._boundEvents.keypress)}},Qf=Zf;Qf._eventsAdded=!1;Qf._audioActivated=!1;var TF=class extends no{constructor(){super(...arguments);this._attachableToHierarchy=!1}createObject(){let e=new st;return e.matrixAutoUpdate=!1,e}cook(){this.cookController.endCook()}};var sv=class extends TF{};var av=class extends sv{constructor(){super(...arguments);this.renderOrder=Cl.MANAGER,this._childrenControllerContext=oe.EVENT}static type(){return uo.EVENT}createNode(e,t){return super.createNode(e,t)}children(){return super.children()}nodesByType(e){return super.nodesByType(e)}};var lne={dependsOnDisplayNode:!0},em=class{constructor(e,t,r=lne){this.node=e,this.options=r,this._initialized=!1,this._display_node=void 0,this._graph_node=new Kt(e.scene(),"DisplayNodeController"),this._graph_node.node=e,this._on_display_node_remove_callback=t.onDisplayNodeRemove,this._on_display_node_set_callback=t.onDisplayNodeSet,this._on_display_node_update_callback=t.onDisplayNodeUpdate}dispose(){this._graph_node.dispose()}displayNode(){return this._display_node}initializeNode(){if(this._initialized){console.error("display node controller already initialed",this.node);return}this._initialized=!0,this.node.lifecycle.onChildAdd(e=>{var t,r;this._display_node||(r=(t=e.flags)==null?void 0:t.display)==null||r.set(!0)}),this.node.lifecycle.onChildRemove(e=>{var t,r,n;if(e.graphNodeId()==((t=this._display_node)==null?void 0:t.graphNodeId())){let i=this.node.children(),s=i[i.length-1];s?(n=(r=s.flags)==null?void 0:r.display)==null||n.set(!0):this.setDisplayNode(void 0)}}),this._graph_node.dirtyController.addPostDirtyHook("_request_display_node_container",()=>{this._on_display_node_update_callback&&this._on_display_node_update_callback()})}async setDisplayNode(e){if(this._initialized||console.error("display node controller not initialized",this.node),this._display_node!=e){let t=this._display_node;t&&(t.flags.display.set(!1),this.options.dependsOnDisplayNode&&this._graph_node.removeGraphInput(t),this._on_display_node_remove_callback&&this._on_display_node_remove_callback()),this._display_node=e,this._display_node&&(this.options.dependsOnDisplayNode&&this._graph_node.addGraphInput(this._display_node),this._on_display_node_set_callback&&this._on_display_node_set_callback())}}};var AF="display",tm=class{constructor(e){this.node=e,this._children_uuids_dict=new Map,this._children_length=0,this._sopGroup=this._createSopGroup()}_createSopGroup(){let e=new st;return e.matrixAutoUpdate=!1,e}sopGroup(){return this._sopGroup}setSopGroupName(){this._sopGroup.name=`${this.node.name()}:sopGroup`}displayNodeControllerCallbacks(){return{onDisplayNodeRemove:()=>{this.remove_children()},onDisplayNodeSet:()=>{setTimeout(()=>{this.request_display_node_container()},0)},onDisplayNodeUpdate:()=>{this.request_display_node_container()}}}initializeNode(){var e;this.node.object.add(this.sopGroup()),this.node.nameController.add_post_set_fullPath_hook(this.setSopGroupName.bind(this)),this._createSopGroup();let t=(e=this.node.flags)==null?void 0:e.display;t&&t.onUpdate(()=>{this._updateSopGroupHierarchy(),t.active()&&this.request_display_node_container()})}_updateSopGroupHierarchy(){var e;if((e=this.node.flags)==null?void 0:e.display){let r=this.sopGroup();this.usedInScene()?(r.visible=!0,this.node.object.add(r),r.updateMatrix()):(r.visible=!1,this.node.object.remove(r))}}usedInScene(){var e,t;let r=this.node.params.has(AF),n=this.node.params.boolean(AF),i=this.node.usedInScene(),s=((t=(e=this.node.flags)==null?void 0:e.display)==null?void 0:t.active())||!1;return i&&s&&(!r||n)}async request_display_node_container(){!this.node.scene().loadingController.loaded()||this.usedInScene()&&await this._setContentUnderSopGroup()}remove_children(){if(this._sopGroup.children.length==0)return;let e;for(;e=this._sopGroup.children[0];)this._sopGroup.remove(e);this._children_uuids_dict.clear(),this._children_length=0}async _setContentUnderSopGroup(){var e;let t=this.node.displayNodeController.displayNode();if(t&&((e=t.parent())==null?void 0:e.graphNodeId())==this.node.graphNodeId()){let n=(await t.compute()).coreContent();if(n){let i=n.objects(),s=i.length!=this._children_length;if(!s)for(let a of i)this._children_uuids_dict.get(a.uuid)||(s=!0);if(s){this.remove_children();for(let a of i)this._sopGroup.add(a),a.updateMatrix(),this._children_uuids_dict.set(a.uuid,!0);this._children_length=i.length}return}}this.remove_children()}};var CF=class extends io(U){constructor(){super(...arguments);this.display=y.BOOLEAN(1),this.renderOrder=y.INTEGER(0,{range:[0,10],rangeLocked:[!0,!1]})}},une=new CF,cv=class extends no{constructor(){super(...arguments);this.paramsConfig=une,this.hierarchyController=new so(this),this.transformController=new jo(this),this.flags=new vo(this),this.childrenDisplayController=new tm(this),this.displayNodeController=new em(this,this.childrenDisplayController.displayNodeControllerCallbacks()),this._childrenControllerContext=oe.SOP,this._onChildAddBound=this._onChildAdd.bind(this)}static type(){return F0.GEO}createObject(){let e=new st;return e.matrixAutoUpdate=!1,e}initializeNode(){this.lifecycle.onChildAdd(this._onChildAddBound),this.hierarchyController.initializeNode(),this.transformController.initializeNode(),this.childrenDisplayController.initializeNode()}isDisplayNodeCooking(){if(this.flags.display.active()){let e=this.displayNodeController.displayNode();return e?e.isDirty():!1}else return!1}createNode(e,t){return super.createNode(e,t)}children(){return super.children()}nodesByType(e){return super.nodesByType(e)}_onChildAdd(e){var t,r;this.scene().loadingController.loaded()&&this.children().length==1&&((r=(t=e.flags)==null?void 0:t.display)==null||r.set(!0))}cook(){this.transformController.update(),this.object.visible=this.pv.display,this.object.renderOrder=this.pv.renderOrder,this.cookController.endCook()}};var rm=(o=>(o.DIRECTIONAL="directionalLight",o.HEMISPHERE="hemisphereLight",o.POINT="pointLight",o.SPOT="spotLight",o))(rm||{});var om={skyColor:new de(1,1,1),groundColor:new de(0,0,0),intensity:1,position:new M(0,0,0)},Q9=om;function EF(o){return class extends o{constructor(){super(...arguments);this.skyColor=y.COLOR(Q9.skyColor.toArray(),{conversion:ko.SRGB_TO_LINEAR}),this.groundColor=y.COLOR(Q9.groundColor.toArray(),{conversion:ko.SRGB_TO_LINEAR}),this.intensity=y.FLOAT(Q9.intensity,{range:[0,10],rangeLocked:[!0,!1]}),this.position=y.VECTOR3(Q9.position.toArray())}}}var ud=class extends wo{constructor(e,t,r){super(e,r);this.type="HemisphereLight",this.position.copy(vt.DefaultUp),this.updateMatrix(),this.groundColor=new de(t)}copy(e){return wo.prototype.copy.call(this,e),this.groundColor.copy(e.groundColor),this}};ud.prototype.isHemisphereLight=!0;var nm=class extends Ke{static type(){return"hemisphereLight"}cook(e,t){let r=this.createLight();return this.updateLightParams(r,t),this.updateLightParams(r,t),this.createCoreGroupFromObjects([r])}createLight(){let e=new ud;return e.name="Hemisphere",e.matrixAutoUpdate=!1,e.updateMatrix(),e.color.copy(om.skyColor),e.groundColor.copy(om.groundColor),e}updateLightParams(e,t){e.color.copy(t.skyColor),e.groundColor.copy(t.groundColor),e.intensity=t.intensity}};nm.DEFAULT_PARAMS=om;nm.INPUT_CLONED_STATE=ke.NEVER;var SF=class extends EF(U){},pne=new SF,lv=class extends qf{constructor(){super(...arguments);this.paramsConfig=pne}static type(){return rm.HEMISPHERE}_operation(){return this.__operation__=this.__operation__||new nm(this._scene,this.states)}createLight(){return this._operation().createLight()}updateLightParams(){this._operation().updateLightParams(this.light,this.pv)}};var im=class extends Gr{constructor(e=1){let t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],r=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],n=new Re;n.setAttribute("position",new Ce(t,3)),n.setAttribute("color",new Ce(r,3));let i=new ir({vertexColors:!0,toneMapped:!1});super(n,i);this.type="AxesHelper"}setColors(e,t,r){let n=new de,i=this.geometry.attributes.color.array;return n.set(e),n.toArray(i,0),n.toArray(i,3),n.set(t),n.toArray(i,6),n.toArray(i,9),n.set(r),n.toArray(i,12),n.toArray(i,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}};var wF=class extends io(U){},dne=new wF,uv=class extends no{constructor(){super(...arguments);this.paramsConfig=dne,this.hierarchyController=new so(this),this.transformController=new jo(this),this.flags=new vo(this),this._helper=new im(1)}static type(){return"null"}createObject(){let e=new st;return e.matrixAutoUpdate=!1,e}initializeNode(){this.hierarchyController.initializeNode(),this.transformController.initializeNode(),this._updateHelperHierarchy(),this._helper.matrixAutoUpdate=!1,this.flags.display.onUpdate(()=>{this._updateHelperHierarchy()})}_updateHelperHierarchy(){this.flags.display.active()?(this.object.add(this._helper),this._helper.updateMatrix()):this.object.remove(this._helper)}cook(){this.transformController.update(),this.cookController.endCook()}};var pv=class{constructor(e,t,r){this._camera_node_id=e,this._controls_node=t,this._controls=r,this._updateRequired=this._controls_node.updateRequired()}updateRequired(){return this._updateRequired}get camera_node_id(){return this._camera_node_id}get controls(){return this._controls}get controls_node(){return this._controls_node}is_equal(e){return e.camera_node_id==this._camera_node_id&&e.controls_node.graphNodeId()==this._controls_node.graphNodeId()}};var MF="controls",dv=class{constructor(e){this.node=e,this._applied_controls_by_element_id=new Map,this._controls_node=null}controls_param(){return this.node.params.has(MF)?this.node.params.get(MF):null}async controls_node(){let e=this.node.p.controls,t=e.rawInput();if(t&&t!=""){e.isDirty()&&await e.compute();let r=e.value.node();if(r){if(eN.includes(r.type()))return r;this.node.states.error.set("found node is not of a camera control type")}else this.node.states.error.set("no node has been found")}return null}async update_controls(){let e=await this.controls_node();e&&this._controls_node!=e&&this._dispose_control_refs(),this._controls_node=e}async apply_controls(e){let t=e.canvas();if(!t)return;let r=await this.controls_node();if(r){this._controlsEndEventName=r.endEventName();let n=r.controls_id(),i=!1,s=this._applied_controls_by_element_id.get(t.id);if(s&&s.get(n)&&(i=!0),!i){s=new Map,this._applied_controls_by_element_id.set(t.id,s),s.set(n,r);let a=await r.apply_controls(this.node.object,e);if(!a)return;let c=new pv(this.node.graphNodeId(),r,a);return this.set_controls_events(a),c}}}_dispose_control_refs(){this._applied_controls_by_element_id.forEach((e,t)=>{this._dispose_controls_for_element_id(t)}),this._applied_controls_by_element_id.clear(),this._controlsEndEventName=void 0}_dispose_controls_for_element_id(e){let t=this._applied_controls_by_element_id.get(e);t&&t.forEach((r,n)=>{r.disposeControlsForHtmlElementId(e)}),this._applied_controls_by_element_id.delete(e)}async dispose_controls(e){this._dispose_controls_for_element_id(e.id)}set_controls_events(e){let t=e2[this.node.pv.updateFromControlsMode];switch(t){case sm.ON_END:return this._set_controls_events_to_update_on_end(e);case sm.ALWAYS:return this._set_controls_events_to_update_always(e);case sm.NEVER:return this._reset(e)}Be.unreachable(t)}_reset(e){this.controls_change_listener&&(e.removeEventListener("change",this.controls_change_listener),this.controls_change_listener=void 0),this.controls_end_listener&&this._controlsEndEventName&&(e.removeEventListener(this._controlsEndEventName,this.controls_end_listener),this.controls_end_listener=void 0)}_set_controls_events_to_update_on_end(e){this._reset(e),!!this._controlsEndEventName&&(this.controls_end_listener=()=>{this.node.update_transform_params_from_object()},e.addEventListener(this._controlsEndEventName,this.controls_end_listener))}_set_controls_events_to_update_always(e){this._reset(e),this.controls_change_listener=()=>{this.node.update_transform_params_from_object()},e.addEventListener("change",this.controls_change_listener)}};var hne="layer";function t2(o){return class extends o{constructor(){super(...arguments);this.layer=y.INTEGER(0,{range:[0,31],rangeLocked:[!0,!0]})}}}var hv=class{constructor(e){this.node=e}update(){let e=this.node.object;e.layers.set(0),e.layers.enable(this.node.params.integer(hne))}};var fne={callback:o=>{am.PARAM_CALLBACK_reset_effects_composer(o)}};function r2(o){return class extends o{constructor(){super(...arguments);this.doPostProcess=y.BOOLEAN(0),this.postProcessNode=y.NODE_PATH("",{visibleIf:{doPostProcess:1},nodeSelection:{types:[uo.POST]},...fne})}}}var fv=class{constructor(e){this.node=e,this._composersByCanvasId=new Map,this.node.p.postProcessNode?this._add_param_dirty_hook():this.node.params.onParamsCreated("post process add param dirty hook",()=>{this._add_param_dirty_hook()})}_add_param_dirty_hook(){this.node.p.postProcessNode.addPostDirtyHook("on_post_node_dirty",()=>{this.reset()})}render(e,t){let r=this.composer(e);r&&(t&&r.setSize(t.x,t.y),r.render())}reset(){this._composersByCanvasId.clear()}composer(e){let t=this._composersByCanvasId.get(e.id);if(t)return t;{let r=this._createComposer(e);return r&&this._composersByCanvasId.set(e.id,r),r}}_createComposer(e){let t=this.node.renderController().renderer(e);if(t){let r=this.node.renderController().resolvedScene()||this.node.scene().threejsScene(),n=this.node.object,i=this.node.p.postProcessNode.value.node();if(i)if(i.type()==uo.POST){let s=i,a=this.node.renderController().canvasResolution(e);return a?s.effectsComposerController.createEffectsComposer({renderer:t,scene:r,camera:n,resolution:a,requester:this.node,camera_node:this.node}):void 0}else this.node.states.error.set("found node is not a post process node");else this.node.states.error.set("no post node found")}}};var NF=class extends p_(wh(l_(c_(a_(U))))){},mne=new NF,o2=class extends no{constructor(){super(...arguments);this.paramsConfig=mne,this.hierarchyController=new so(this),this.SceneAutoUpdateController=new zu(this),this.sceneBackgroundController=new ju(this),this.SceneEnvController=new Wu(this),this.sceneFogController=new Yu(this),this.sceneMaterialOverrideController=new $u(this)}static type(){return F0.SCENE}createObject(){let e=new ii;return e.matrixAutoUpdate=!1,e}initializeNode(){this.hierarchyController.initializeNode()}cook(){this.SceneAutoUpdateController.update(),this.sceneBackgroundController.update(),this.SceneEnvController.update(),this.sceneFogController.update(),this.sceneMaterialOverrideController.update(),this.cookController.endCook()}};var mv=class extends fr{constructor(){super(...arguments);this.flags=new ta(this)}static context(){return oe.ROP}initializeBaseNode(){this.dirtyController.addPostDirtyHook("cook_immediately",()=>{this.cookController.cookMainWithoutInputs()})}cook(){this.cookController.endCook()}};var qa=(o=>(o.CSS2D="CSS2DRenderer",o.CSS3D="CSS3DRenderer",o.WEBGL="WebGLRenderer",o))(qa||{});var n2=(o=>(o[o.Linear=Xr]="Linear",o[o.sRGB=bt]="sRGB",o))(n2||{}),_ne=["Linear","sRGB"],gne=[n2.Linear,n2.sRGB],vv=n2.sRGB;var Ml=(o=>(o[o.No=Ro]="No",o[o.Linear=qm]="Linear",o[o.Reinhard=Xm]="Reinhard",o[o.Cineon=Ym]="Cineon",o[o.ACESFilmic=$m]="ACESFilmic",o))(Ml||{}),vne=["No","Linear","Reinhard","Cineon","ACESFilmic"],yne=[Ml.No,Ml.Linear,Ml.Reinhard,Ml.Cineon,Ml.ACESFilmic],yv=Ml.ACESFilmic,xne=vne.map((o,e)=>({name:o,value:yne[e]}));var _v=["highp","mediump","lowp"];var gv=["high-performance","low-power","default"];var pd=(o=>(o[o.Basic=Sx]="Basic",o[o.PCF=au]="PCF",o[o.PCFSoft=Hm]="PCFSoft",o[o.VSM=o0]="VSM",o))(pd||{}),bne=["Basic","PCF","PCFSoft","VSM"],Tne=[pd.Basic,pd.PCF,pd.PCFSoft,pd.VSM];var xv=pd.PCFSoft,OF={alpha:!1,precision:"highp",premultipliedAlpha:!0,antialias:!1,stencil:!0,preserveDrawingBuffer:!1,powerPreference:"default",depth:!0,logarithmicDepthBuffer:!1},PF=class extends U{constructor(){super(...arguments);this.tprecision=y.BOOLEAN(0),this.precision=y.INTEGER(_v.indexOf("highp"),{visibleIf:{tprecision:1},menu:{entries:_v.map((e,t)=>({value:t,name:e}))}}),this.tpowerPreference=y.BOOLEAN(0),this.powerPreference=y.INTEGER(gv.indexOf("default"),{visibleIf:{tpowerPreference:1},menu:{entries:gv.map((e,t)=>({value:t,name:e}))}}),this.alpha=y.BOOLEAN(1),this.premultipliedAlpha=y.BOOLEAN(1),this.antialias=y.BOOLEAN(1),this.stencil=y.BOOLEAN(1),this.depth=y.BOOLEAN(1),this.logarithmicDepthBuffer=y.BOOLEAN(0),this.toneMapping=y.INTEGER(yv,{menu:{entries:xne}}),this.toneMappingExposure=y.FLOAT(1,{range:[0,2]}),this.outputEncoding=y.INTEGER(vv,{menu:{entries:_ne.map((e,t)=>({name:e,value:gne[t]}))}}),this.physicallyCorrectLights=y.BOOLEAN(1),this.sortObjects=y.BOOLEAN(1),this.tpixelRatio=y.BOOLEAN(0),this.pixelRatio=y.INTEGER(2,{visibleIf:{tpixelRatio:!0},range:[1,4],rangeLocked:[!0,!1]}),this.tshadowMap=y.BOOLEAN(1),this.shadowMapAutoUpdate=y.BOOLEAN(1,{visibleIf:{tshadowMap:1}}),this.shadowMapNeedsUpdate=y.BOOLEAN(0,{visibleIf:{tshadowMap:1}}),this.shadowMapType=y.INTEGER(xv,{visibleIf:{tshadowMap:1},menu:{entries:bne.map((e,t)=>({name:e,value:Tne[t]}))}})}},Ane=new PF,i2=class extends mv{constructor(){super(...arguments);this.paramsConfig=Ane,this._renderersbyCameraNode=new Map}static type(){return qa.WEBGL}createRenderer(e,t,r){let n={},i=Object.keys(OF),s;for(s of i)n[s]=OF[s];if(this.pv.tprecision){let c=_v[this.pv.precision];n.precision=c}if(this.pv.tpowerPreference){let c=gv[this.pv.powerPreference];n.powerPreference=c}n.antialias=this.pv.antialias,n.antialias=this.pv.antialias,n.alpha=this.pv.alpha,n.premultipliedAlpha=this.pv.premultipliedAlpha,n.depth=this.pv.depth,n.stencil=this.pv.stencil,n.logarithmicDepthBuffer=this.pv.logarithmicDepthBuffer,n.canvas=t,n.context=r;let a=Q.renderersController.createWebGLRenderer(n);return Q.renderersController.printDebug()&&(Q.renderersController.printDebugMessage(`create renderer from node '${this.path()}'`),Q.renderersController.printDebugMessage({params:n})),this._update_renderer(a),this._renderersbyCameraNode.set(e,a),a}cook(){this._renderersbyCameraNode.forEach((e,t)=>{this._update_renderer(e)}),this._traverse_scene_and_update_materials(),this.cookController.endCook()}_update_renderer(e){e.physicallyCorrectLights=this.pv.physicallyCorrectLights,e.outputEncoding=this.pv.outputEncoding,e.toneMapping=this.pv.toneMapping,e.toneMappingExposure=this.pv.toneMappingExposure,e.shadowMap.enabled=this.pv.tshadowMap,e.shadowMap.autoUpdate=this.pv.shadowMapAutoUpdate,e.shadowMap.needsUpdate=this.pv.shadowMapNeedsUpdate,e.shadowMap.type=this.pv.shadowMapType,e.sortObjects=this.pv.sortObjects;let t=this.pv.tpixelRatio?this.pv.pixelRatio:Nl.defaultPixelRatio();Q.renderersController.printDebug()&&(Q.renderersController.printDebugMessage(`set renderer pixelRatio from '${this.path()}'`),Q.renderersController.printDebugMessage({pixelRatio:t})),e.setPixelRatio(t)}_traverse_scene_and_update_materials(){this.scene().threejsScene().traverse(e=>{let t=e.material;if(t)if(K.isArray(t))for(let r of t)r.needsUpdate=!0;else t.needsUpdate=!0})}};function s2(o){return class extends o{constructor(){super(...arguments);this.render=y.FOLDER(),this.setScene=y.BOOLEAN(0),this.scene=y.NODE_PATH("",{visibleIf:{setScene:1},nodeSelection:{context:oe.OBJ,types:[o2.type()]}}),this.setRenderer=y.BOOLEAN(0),this.renderer=y.NODE_PATH("",{visibleIf:{setRenderer:1},nodeSelection:{context:oe.ROP,types:[i2.type()]}}),this.setCSSRenderer=y.BOOLEAN(0),this.CSSRenderer=y.NODE_PATH("",{visibleIf:{setCSSRenderer:1},nodeSelection:{context:oe.ROP,types:[qa.CSS2D,qa.CSS3D]}})}}}var Nl=class{constructor(e){this.node=e,this._renderersByCanvasId=new Map,this._resolutionByCanvasId=new Map,this._super_sampling_size=new z}render(e,t,r,n){if(this.node.pv.doPostProcess?this.node.postProcessController().render(e,t):this.renderWithRenderer(e,n),this._resolvedCSSRendererROP&&this._resolvedScene&&this.node.pv.setCSSRenderer){let i=this.cssRenderer(e);i&&i.render(this._resolvedScene,this.node.object)}}renderWithRenderer(e,t){let r=this.renderer(e);if(r){let n=this._resolvedScene;n&&r.render(n,this.node.object)}}preCompile(e){let t=this.renderer(e);if(t){let r=this._resolvedScene;r&&t.compile(r,this.node.object)}}async update(){await this._updateScene(),await this._updateRenderer(),await this._updateCSSRenderer()}resolvedScene(){return this._resolvedScene}async _updateScene(){if(this.node.pv.setScene){let e=this.node.p.scene;e.isDirty()&&await e.compute();let t=e.value.nodeWithContext(oe.OBJ,this.node.states.error);if(t&&t.type()==o2.type()){let r=t;r.isDirty()&&r.cookController.cookMainWithoutInputs(),this._resolvedScene=r.object}}else this._resolvedScene=this.node.scene().threejsScene()}async _updateRenderer(){if(this.node.pv.setRenderer){let e=this.node.p.renderer;e.isDirty()&&await e.compute();let t=e.value.nodeWithContext(oe.ROP,this.node.states.error);if(t&&t.type()==i2.type()){this._resolvedRendererROP=t;return}}this._resolvedRendererROP=void 0}async _updateCSSRenderer(){if(this.node.pv.setCSSRenderer){let e=this.node.p.CSSRenderer;e.isDirty()&&await e.compute();let t=e.value.nodeWithContext(oe.ROP,this.node.states.error),r=[qa.CSS2D,qa.CSS3D];if(t&&r.includes(t.type())){this._resolvedCSSRendererROP=t;return}}this._resolvedCSSRendererROP,this._resolvedCSSRendererROP=void 0}renderer(e){return this._renderersByCanvasId.get(e.id)}renderersByCanvasId(){return this._renderersByCanvasId}cssRenderer(e){if(this._resolvedCSSRendererROP&&this.node.pv.setCSSRenderer)return this._resolvedCSSRendererROP.renderer(e)}async createRenderer(e,t){let r=Q.renderersController.getRenderingContext(e);if(!r){console.error("failed to create webgl context");return}let n;return this.node.pv.setRenderer&&(await this._updateRenderer(),this._resolvedRendererROP&&(n=this._resolvedRendererROP.createRenderer(this.node,e,r))),n||(n=Nl._createDefaultRenderer(e,r)),Q.renderersController.registerRenderer(n),this._renderersByCanvasId.set(e.id,n),this._super_sampling_size.copy(t),this.setRendererSize(e,this._super_sampling_size),n}static defaultPixelRatio(){return Un.isMobile()?1:Math.max(2,window.devicePixelRatio)}static _createDefaultRenderer(e,t){let r={canvas:e,antialias:!1,context:t},n=Q.renderersController.createWebGLRenderer(r),i=this.defaultPixelRatio();return n.setPixelRatio(i),n.shadowMap.enabled=!0,n.shadowMap.type=xv,n.physicallyCorrectLights=!0,n.toneMapping=yv,n.toneMappingExposure=1,n.outputEncoding=vv,Q.renderersController.printDebug()&&(Q.renderersController.printDebugMessage("create default renderer"),Q.renderersController.printDebugMessage({params:r,pixelRatio:i})),n}deleteRenderer(e){let t=this.renderer(e);t&&Q.renderersController.deregisterRenderer(t)}canvasResolution(e){return this._resolutionByCanvasId.get(e.id)}setRendererSize(e,t){let r=this._resolutionByCanvasId.get(e.id);r||(r=new z,this._resolutionByCanvasId.set(e.id,r)),r.copy(t);let n=this.renderer(e);if(n&&n.setSize(t.x,t.y,!1),this._resolvedCSSRendererROP){let i=this.cssRenderer(e);i&&i.setSize(t.x,t.y)}}};var bv=class{constructor(e){this.viewer=e,this._active=!1,this._controls=null,this._bound_on_controls_start=this._on_controls_start.bind(this),this._bound_on_controls_end=this._on_controls_end.bind(this),this._update_graph_node()}controls(){return this._controls}async create_controls(){var e;this.dispose_controls(),!!this.viewer.canvas()&&(this._config=await((e=this.viewer.cameraControlsController())==null?void 0:e.apply_controls(this.viewer)),this._config&&(this._controls=this._config.controls,this._controls&&(this.viewer.active()?(this._controls.addEventListener("start",this._bound_on_controls_start),this._controls.addEventListener("end",this._bound_on_controls_end)):this.dispose_controls())))}update(e){this._config&&this._controls&&this._config.updateRequired()&&this._controls.update(e)}dispose(){var e;(e=this._graph_node)==null||e.graphDisconnectPredecessors(),this.dispose_controls()}dispose_controls(){var e;if(this._controls){let t=this.viewer.canvas();t&&((e=this.viewer)==null||e.cameraControlsController().dispose_controls(t)),this._bound_on_controls_start&&this._controls.removeEventListener("start",this._bound_on_controls_start),this._bound_on_controls_end&&this._controls.removeEventListener("end",this._bound_on_controls_end),this._controls.dispose(),this._controls=null}}_on_controls_start(){this._active=!0}_on_controls_end(){this._active=!1}_update_graph_node(){let e=this.viewer.cameraNode().p.controls;this._graph_node=this._graph_node||this._create_graph_node(),!!this._graph_node&&(this._graph_node.graphDisconnectPredecessors(),this._graph_node.addGraphInput(e))}_create_graph_node(){let e=new Kt(this.viewer.cameraNode().scene(),"viewer-controls");return e.addPostDirtyHook("this.viewer.controlsController",async()=>{await this.create_controls()}),e}};var Tv=class{constructor(e){this._viewer=e,this._size=new z(100,100),this._aspect=1}cameraNode(){return this._viewer.cameraNode()}get size(){return this._size}get aspect(){return this._aspect}computeSizeAndAspect(){this._updateSize(),this.cameraNode().scene().uniformsController.updateResolution(this._size),this._aspect=this._getAspect()}_updateSize(){var e,t;this._size.x=((e=this._viewer.domElement())==null?void 0:e.offsetWidth)||0,this._size.y=((t=this._viewer.domElement())==null?void 0:t.offsetHeight)||0}_getAspect(){return this._size.x/this._size.y}updateCameraAspect(){this.cameraNode().setupForAspectRatio(this._aspect)}async prepareCurrentCamera(){await this.cameraNode().compute(),await this._updateFromCameraContainer()}async _updateFromCameraContainer(){var e;this.updateCameraAspect(),await((e=this._viewer.controlsController())==null?void 0:e.create_controls())}};var Av=class{constructor(e){this.viewer=e}init(){let e=this.viewer.canvas();e&&(e.onwebglcontextlost=this._on_webglcontextlost.bind(this),e.onwebglcontextrestored=this._on_webglcontextrestored.bind(this))}_on_webglcontextlost(){console.warn("context lost at frame",this.viewer.scene().frame()),this.request_animation_frame_id?cancelAnimationFrame(this.request_animation_frame_id):console.warn("request_animation_frame_id not initialized"),console.warn("not canceled",this.request_animation_frame_id)}_on_webglcontextrestored(){console.log("context restored")}};var RF={ON:`<svg xmlns="http://www.w3.org/2000/svg" class="soundOn h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
	<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z" />
  </svg>`,OFF:`<svg xmlns="http://www.w3.org/2000/svg" class="soundOff h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
	<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z" clip-rule="evenodd" />
	<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2" />
  </svg>`},Cv=class{constructor(e){this._viewer=e}update(){let e=this._viewer.cameraNode().root();e.pv.displayAudioIcon?(this._showIcon(),this._updateColor(),this._updateIcon()):this._hideIcon()}unmount(){var e;this.__iconContainer&&((e=this.__iconContainer.parentElement)==null||e.removeChild(this.__iconContainer),this.__iconContainer=void 0),this._onIcon=void 0,this._offIcon=void 0}_updateColor(){if(this.__iconContainer){let e=this._viewer.cameraNode().root();this.__iconContainer.style.color=e.pv.audioIconColor.getStyle()}}_showIcon(){let e=this._iconContainer();e&&(e.style.display="block")}_hideIcon(){this.__iconContainer&&(this.__iconContainer.style.display="none")}_iconContainer(){let e=()=>{let t=this._createIconContainer(),r=this._viewer.domElement();if(!!r)return r.append(t),t};return this.__iconContainer=this.__iconContainer||e()}_createIconContainer(){let e=document.createElement("div");return e.style.position="absolute",e.style.top="10px",e.style.right="10px",e.style.width="24px",e.style.height="24px",e.style.cursor="pointer",e.addEventListener("pointerdown",()=>{this._toggleSound()}),e}offIcon(){function e(){let t=document.createElement("div");return t.innerHTML=RF.OFF,t.children[0]}return this._offIcon=this._offIcon||e()}onIcon(){function e(){let t=document.createElement("div");return t.innerHTML=RF.ON,t.children[0]}return this._onIcon=this._onIcon||e()}_toggleSound(){this._viewer.cameraNode().root().audioController.toggleSound(),this._updateIcon()}_updateIcon(){var e,t;let r=this._iconContainer();if(!r)return;let n=this.onIcon(),i=this.offIcon();this._viewer.cameraNode().root().audioController.soundOn()?(r.appendChild(n),(e=i.parentElement)==null||e.removeChild(i)):(r.appendChild(i),(t=n.parentElement)==null||t.removeChild(n))}};var IF="hovered",LF=class{constructor(o){this._cameraNode=o,this._active=!1,this._mounted=!1,this._onBeforeTickCallbacks=[],this._onAfterTickCallbacks=[],this._onBeforeRenderCallbacks=[],this._onAfterRenderCallbacks=[],this._id=LF._nextViewerId++,this._scene=this._cameraNode.scene()}mount(o){this._domElement=o,this._mounted=!0}unmount(){var o;!this._domElement||((o=this._audioController)==null||o.unmount(),this._domElement.removeChild(this.canvas()),this._mounted=!1)}_canvasIdPrefix(){return"TypedViewer"}_createCanvas(){let o=document.createElement("canvas");return o.id=`${this._canvasIdPrefix()}_${this._id}`,o.style.display="block",o.style.outline="none",o}canvas(){return this._canvas=this._canvas||this._createCanvas()}setRenderObjectOverride(o){o?this._renderObjectOverride=o:this._renderObjectOverride=void 0}active(){return this._active}activate(){this._active=!0}deactivate(){this._active=!1}camerasController(){return this._camerasController=this._camerasController||new Tv(this)}controlsController(){return this._controlsController}eventsController(){return this._eventsController=this._eventsController||new z8(this)}webglController(){return this._webGLController=this._webGLController||new Av(this)}audioController(){return this._audioController=this._audioController||new Cv(this)}domElement(){return this._domElement}scene(){return this._scene}cameraNode(){return this._cameraNode}cameraControlsController(){}id(){return this._id}dispose(){if(this._scene.viewersRegister.unregisterViewer(this),this.eventsController().dispose(),!this._domElement)return;let o;for(;o=this._domElement.children[0];)this._domElement.removeChild(o)}resetContainerClass(){var o;(o=this.domElement())==null||o.classList.remove(IF)}setContainerClassHovered(){var o;(o=this.domElement())==null||o.classList.add(IF)}markAsReady(){}registerOnBeforeTick(o,e){this._registerCallback(o,e,this.registeredBeforeTickCallbacks())}unRegisterOnBeforeTick(o){this._unregisterCallback(o,this._onBeforeTickCallbacksMap)}registeredBeforeTickCallbacks(){return this._onBeforeTickCallbacksMap=this._onBeforeTickCallbacksMap||new Map}registerOnAfterTick(o,e){this._registerCallback(o,e,this.registeredAfterTickCallbacks())}unRegisterOnAfterTick(o){this._unregisterCallback(o,this._onAfterTickCallbacksMap)}registeredAfterTickCallbacks(){return this._onAfterTickCallbacksMap=this._onAfterTickCallbacksMap||new Map}registerOnBeforeRender(o,e){this._registerCallback(o,e,this.registeredBeforeRenderCallbacks())}unRegisterOnBeforeRender(o){this._unregisterCallback(o,this._onBeforeRenderCallbacksMap)}registeredBeforeRenderCallbacks(){return this._onBeforeRenderCallbacksMap=this._onBeforeRenderCallbacksMap||new Map}registerOnAfterRender(o,e){this._registerCallback(o,e,this.registeredAfterRenderCallbacks())}unRegisterOnAfterRender(o){this._unregisterCallback(o,this._onAfterRenderCallbacksMap)}registeredAfterRenderCallbacks(){return this._onAfterRenderCallbacksMap=this._onAfterRenderCallbacksMap||new Map}_registerCallback(o,e,t){if(t.has(o)){console.warn(`callback ${o} already registered`);return}t.set(o,e),this._updateCallbacks()}_unregisterCallback(o,e){!e||(e.delete(o),this._updateCallbacks())}_updateCallbacks(){var o,e,t,r;this._onBeforeTickCallbacks=[],(o=this._onBeforeTickCallbacksMap)==null||o.forEach(n=>{this._onBeforeTickCallbacks.push(n)}),this._onAfterTickCallbacks=[],(e=this._onAfterTickCallbacksMap)==null||e.forEach(n=>{this._onAfterTickCallbacks.push(n)}),this._onBeforeRenderCallbacks=[],(t=this._onBeforeRenderCallbacksMap)==null||t.forEach(n=>{this._onBeforeRenderCallbacks.push(n)}),this._onAfterRenderCallbacks=[],(r=this._onAfterRenderCallbacksMap)==null||r.forEach(n=>{this._onAfterRenderCallbacks.push(n)})}_runCallbacks(o,e){for(let t of o)t(e)}_runOnBeforeTickCallbacks(o){this._runCallbacks(this._onBeforeTickCallbacks,o)}_runOnAfterTickCallbacks(o){this._runCallbacks(this._onAfterTickCallbacks,o)}_runOnBeforeRenderCallbacks(o){this._runCallbacks(this._onBeforeRenderCallbacks,o)}_runOnAfterRenderCallbacks(o){this._runCallbacks(this._onAfterRenderCallbacks,o)}},Ev=LF;Ev._nextViewerId=0;var Cne="CoreThreejsViewer",a2=class extends Ev{constructor(e,t){super(e);this._cameraNode=e,this._properties=t,this._doRender=!0,this._clock=new Jf,this._delta=0,this._animateMethod=this.animate.bind(this),this._onResizeBound=this.onResize.bind(this),this._doRender=!0,this._properties!=null&&this._properties.autoRender!=null&&(this._doRender=this._properties.autoRender)}_canvasIdPrefix(){return"ThreejsViewer"}mount(e){var t,r;super.mount(e),(t=this._domElement)==null||t.appendChild(this.canvas()),(r=this._domElement)==null||r.classList.add(Cne),this._build(),this._setEvents()}controlsController(){return this._controlsController=this._controlsController||new bv(this)}_build(){this._initDisplay(),this.activate()}dispose(){this.setAutoRender(!1),this.scene().viewersRegister.unregisterViewer(this),this._cancelAnimate(),this.controlsController().dispose(),this._disposeEvents(),super.dispose()}cameraControlsController(){return this._cameraNode.controlsController()}_setEvents(){this.eventsController().init(),this.webglController().init(),window.addEventListener("resize",this._onResizeBound.bind(this),!1)}_disposeEvents(){window.removeEventListener("resize",this._onResizeBound.bind(this),!1)}onResize(){let e=this._canvas;!e||(this.camerasController().computeSizeAndAspect(),this._cameraNode.renderController().setRendererSize(e,this.camerasController().size),this.camerasController().updateCameraAspect())}_initDisplay(){if(!this._canvas){console.warn("no canvas found for viewer");return}this.camerasController().computeSizeAndAspect();let e=this.camerasController().size,t=this._cameraNode.renderController();t.renderer(this._canvas)||t.createRenderer(this._canvas,e),this.audioController().update(),this.camerasController().prepareCurrentCamera(),this.animate()}setAutoRender(e=!0){this._doRender=e,this._doRender&&this.animate()}autoRenderState(){return this._doRender}animate(){var e;if(this._doRender){let t=this._clock.getDelta();this._delta=t,this._requestAnimationFrameId=requestAnimationFrame(this._animateMethod),this._runOnBeforeTickCallbacks(t),this._scene.timeController.incrementTimeIfPlaying(this._delta),this._runOnAfterTickCallbacks(t),this.render(this._delta),(e=this.controlsController())==null||e.update(this._delta)}}_cancelAnimate(){this._doRender=!1,this._requestAnimationFrameId&&cancelAnimationFrame(this._requestAnimationFrameId),this._canvas&&this._cameraNode.renderController().deleteRenderer(this._canvas)}render(e){if(this._canvas){let t=this._delta;this._runOnBeforeRenderCallbacks(t);let r=this.camerasController().size,n=this.camerasController().aspect;this._cameraNode.renderController().render(this._canvas,r,n,this._renderObjectOverride),this._runOnAfterRenderCallbacks(t)}else console.warn("no canvas to render onto")}renderer(){if(this._canvas)return this._cameraNode.renderController().renderer(this._canvas)}preCompile(){this._canvas&&this._cameraNode.renderController().preCompile(this._canvas)}markAsReady(){this.preCompile(),this.setAutoRender(!0)}};var c2=new M,Pr=new As,Sv=class extends Gr{constructor(e){let t=new Re,r=new ir({color:16777215,vertexColors:!0,toneMapped:!1}),n=[],i=[],s={},a=new de(16755200),c=new de(16711680),l=new de(43775),u=new de(16777215),p=new de(3355443);d("n1","n2",a),d("n2","n4",a),d("n4","n3",a),d("n3","n1",a),d("f1","f2",a),d("f2","f4",a),d("f4","f3",a),d("f3","f1",a),d("n1","f1",a),d("n2","f2",a),d("n3","f3",a),d("n4","f4",a),d("p","n1",c),d("p","n2",c),d("p","n3",c),d("p","n4",c),d("u1","u2",l),d("u2","u3",l),d("u3","u1",l),d("c","t",u),d("p","c",p),d("cn1","cn2",p),d("cn3","cn4",p),d("cf1","cf2",p),d("cf3","cf4",p);function d(m,f,v){h(m,v),h(f,v)}function h(m,f){n.push(0,0,0),i.push(f.r,f.g,f.b),s[m]===void 0&&(s[m]=[]),s[m].push(n.length/3-1)}t.setAttribute("position",new Ce(n,3)),t.setAttribute("color",new Ce(i,3));super(t,r);this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrixAutoUpdate=!1,this.pointMap=s,this.update()}update(){let e=this.geometry,t=this.pointMap,r=1,n=1;Pr.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),Ur("c",t,e,Pr,0,0,-1),Ur("t",t,e,Pr,0,0,1),Ur("n1",t,e,Pr,-r,-n,-1),Ur("n2",t,e,Pr,r,-n,-1),Ur("n3",t,e,Pr,-r,n,-1),Ur("n4",t,e,Pr,r,n,-1),Ur("f1",t,e,Pr,-r,-n,1),Ur("f2",t,e,Pr,r,-n,1),Ur("f3",t,e,Pr,-r,n,1),Ur("f4",t,e,Pr,r,n,1),Ur("u1",t,e,Pr,r*.7,n*1.1,-1),Ur("u2",t,e,Pr,-r*.7,n*1.1,-1),Ur("u3",t,e,Pr,0,n*2,-1),Ur("cf1",t,e,Pr,-r,0,1),Ur("cf2",t,e,Pr,r,0,1),Ur("cf3",t,e,Pr,0,-n,1),Ur("cf4",t,e,Pr,0,n,1),Ur("cn1",t,e,Pr,-r,0,-1),Ur("cn2",t,e,Pr,r,0,-1),Ur("cn3",t,e,Pr,0,-n,-1),Ur("cn4",t,e,Pr,0,n,-1),e.getAttribute("position").needsUpdate=!0}};function Ur(o,e,t,r,n,i,s){c2.set(n,i,s).unproject(r);let a=e[o];if(a!==void 0){let c=t.getAttribute("position");for(let l=0,u=a.length;l<u;l++)c.setXYZ(a[l],c2.x,c2.y,c2.z)}}var DF={type:"change"},cm={near:.1,far:100},sm=(o=>(o.ON_END="on move end",o.ALWAYS="always",o.NEVER="never",o))(sm||{}),e2=["on move end","always","never"];function l2(o){return class extends o{constructor(){super(...arguments);this.setMainCamera=y.BUTTON(null,{callback:(t,r)=>{BF.PARAM_CALLBACK_setMasterCamera(t)}})}}}function wv(o){return class extends o{constructor(){super(...arguments);this.camera=y.FOLDER(),this.controls=y.NODE_PATH("",{nodeSelection:{context:oe.EVENT}}),this.updateFromControlsMode=y.INTEGER(e2.indexOf("on move end"),{menu:{entries:e2.map((t,r)=>({name:t,value:r}))}}),this.near=y.FLOAT(cm.near,{range:[.1,100],cook:!1,computeOnDirty:!0,callback:(t,r)=>{am.PARAM_CALLBACK_update_near_far_from_param(t,r)}}),this.far=y.FLOAT(cm.far,{range:[0,100],cook:!1,computeOnDirty:!0,callback:(t,r)=>{am.PARAM_CALLBACK_update_near_far_from_param(t,r)}}),this.display=y.BOOLEAN(1),this.showHelper=y.BOOLEAN(0)}}}var lm=(o=>(o.DEFAULT="default",o.COVER="cover",o.CONTAIN="contain",o))(lm||{}),dd=["default","cover","contain"];function kF(o){return class extends o{constructor(){super(...arguments);this.fovAdjustMode=y.INTEGER(dd.indexOf("default"),{menu:{entries:dd.map((t,r)=>({name:t,value:r}))}}),this.expectedAspectRatio=y.FLOAT("16/9",{visibleIf:[{fovAdjustMode:dd.indexOf("cover")},{fovAdjustMode:dd.indexOf("contain")}],range:[0,2],rangeLocked:[!0,!1]})}}}var Ene=class extends l2(U){},Sne=class extends r2(s2(io(t2(wv(l2(U)))))){},Mv=class extends no{constructor(){super(...arguments);this.renderOrder=Cl.CAMERA,this._aspect=-1}get object(){return this._object}async cook(){this.updateCamera(),this._object.dispatchEvent(DF),this.cookController.endCook()}on_create(){}on_delete(){}prepareRaycaster(e,t){}camera(){return this._object}updateCamera(){}static PARAM_CALLBACK_setMasterCamera(e){e.set_as_master_camera()}set_as_master_camera(){this.scene().camerasController.setMainCameraNodePath(this.path())}setupForAspectRatio(e){}_updateForAspectRatio(){}update_transform_params_from_object(){Yt.setParamsFromObject(this._object,this)}static PARAM_CALLBACK_update_from_param(e,t){e.object[t.name()]=e.pv[t.name()]}},u2=class extends Mv{constructor(){super(...arguments);this.flags=new vo(this),this.hierarchyController=new so(this),this.transformController=new jo(this),this.childrenDisplayController=new tm(this),this.displayNodeController=new em(this,this.childrenDisplayController.displayNodeControllerCallbacks()),this._childrenControllerContext=oe.SOP}controlsController(){return this._controlsController=this._controlsController||new dv(this)}_layersController(){return this.__layersController__=this.__layersController__||new hv(this)}renderController(){return this._renderController=this._renderController||new Nl(this)}postProcessController(){return this._postProcessController=this._postProcessController||new fv(this)}initializeBaseNode(){super.initializeBaseNode(),this.io.outputs.setHasOneOutput(),this.hierarchyController.initializeNode(),this.transformController.initializeNode(),this.childrenDisplayController.initializeNode(),this.initHelperHook()}createNode(e,t){return super.createNode(e,t)}children(){return super.children()}nodesByType(e){return super.nodesByType(e)}prepareRaycaster(e,t){t.setFromCamera(e,this._object)}async cook(){this.transformController.update(),this._layersController().update(),this.updateNearFar(),this.renderController().update(),this.updateCamera(),this._updateHelper(),this.controlsController().update_controls(),this._object.dispatchEvent(DF),this.cookController.endCook()}static PARAM_CALLBACK_update_near_far_from_param(e,t){e.updateNearFar()}updateNearFar(){(this._object.near!=this.pv.near||this._object.far!=this.pv.far)&&(this._object.near=this.pv.near,this._object.far=this.pv.far,this._object.updateProjectionMatrix(),this._updateHelper())}setupForAspectRatio(e){K.isNaN(e)||e&&this._aspect!=e&&(this._aspect=e,this._updateForAspectRatio())}createViewer(e){let t,r;return e&&e instanceof HTMLElement?(t=new a2(this),r=e):(t=new a2(this,(e==null?void 0:e.viewerProperties)||{}),r=e==null?void 0:e.element),r&&t.mount(r),this.scene().viewersRegister.registerViewer(t),t}static PARAM_CALLBACK_reset_effects_composer(e){e.postProcessController().reset()}initHelperHook(){this.flags.display.onUpdate(()=>{this._updateHelper()})}helperVisible(){return this.flags.display.active()&&this.pv.showHelper}_createHelper(){let e=new Sv(this.object);return e.update(),e}_updateHelper(){this.helperVisible()?(this._helper||(this._helper=this._createHelper()),this._helper&&(this.object.add(this._helper),this._helper.update())):this._helper&&this.object.remove(this._helper)}},BF=class extends Mv{},am=class extends u2{PARAM_CALLBACK_update_effects_composer(e){}};var FF={fov:50};function wne(o){return class extends o{constructor(){super(...arguments);this.fov=y.FLOAT(FF.fov,{range:[0,100]})}}}var UF=class extends r2(s2(t2(l2(kF(wne(wv(io(U,{matrixAutoUpdate:!0})))))))){},Mne=new UF,Nv=class extends u2{constructor(){super(...arguments);this.paramsConfig=Mne}static type(){return E5.PERSPECTIVE}createObject(){return new sr(FF.fov,1,cm.near,cm.far)}updateCamera(){this._object.fov!=this.pv.fov&&(this._object.fov=this.pv.fov,this._object.updateProjectionMatrix()),this._updateForAspectRatio()}_updateForAspectRatio(){this._aspect&&(this._object.aspect=this._aspect,this._adjustFOVFromMode(),this._object.updateProjectionMatrix())}_adjustFOVFromMode(){let e=dd[this.pv.fovAdjustMode];switch(e){case lm.DEFAULT:return this._adjustFOVFromModeDefault();case lm.COVER:return this._adjustFOVFromModeCover();case lm.CONTAIN:return this._adjustFOVFromModeContain()}Be.unreachable(e)}_adjustFOVFromModeDefault(){this._object.fov=this.pv.fov}_adjustFOVFromModeCover(){if(this._object.aspect>this.pv.expectedAspectRatio){let e=Math.tan(Mn(this.pv.fov/2)),t=this._object.aspect/this.pv.expectedAspectRatio,r=e/t;this._object.fov=Wd(Math.atan(r))*2}else this._object.fov=this.pv.fov}_adjustFOVFromModeContain(){if(this._object.aspect>this.pv.expectedAspectRatio)this._object.fov=this.pv.fov;else{let e=Math.tan(Mn(this.pv.fov/2)),t=this._object.aspect/this.pv.expectedAspectRatio,r=e/t;this._object.fov=Wd(Math.atan(r))*2}}};var Ov=class extends Gr{constructor(e=10,t=16,r=8,n=64,i=4473924,s=8947848){i=new de(i),s=new de(s);let a=[],c=[];for(let p=0;p<=t;p++){let d=p/t*(Math.PI*2),h=Math.sin(d)*e,m=Math.cos(d)*e;a.push(0,0,0),a.push(h,0,m);let f=p&1?i:s;c.push(f.r,f.g,f.b),c.push(f.r,f.g,f.b)}for(let p=0;p<=r;p++){let d=p&1?i:s,h=e-e/r*p;for(let m=0;m<n;m++){let f=m/n*(Math.PI*2),v=Math.sin(f)*h,g=Math.cos(f)*h;a.push(v,0,g),c.push(d.r,d.g,d.b),f=(m+1)/n*(Math.PI*2),v=Math.sin(f)*h,g=Math.cos(f)*h,a.push(v,0,g),c.push(d.r,d.g,d.b)}}let l=new Re;l.setAttribute("position",new Ce(a,3)),l.setAttribute("color",new Ce(c,3));let u=new ir({vertexColors:!0,toneMapped:!1});super(l,u);this.type="PolarGridHelper"}};var GF=class extends U{constructor(){super(...arguments);this.center=y.VECTOR3([0,0,0]),this.longitude=y.FLOAT(0,{range:[0,360]}),this.latitude=y.FLOAT(0,{range:[-180,180]}),this.depth=y.FLOAT(1,{range:[0,10]})}},Nne=new GF,VF="_cook_main_without_inputs_when_dirty",One=new M(0,1,0),Pne=new M(-1,0,0),Pv=class extends no{constructor(){super(...arguments);this.paramsConfig=Nne,this.hierarchyController=new so(this),this.flags=new vo(this),this._helper=this._createHelper(),this._cook_main_without_inputs_when_dirty_bound=this._cook_main_without_inputs_when_dirty.bind(this),this._centerMatrix=new Ue,this._longitudeMatrix=new Ue,this._latitudeMatrix=new Ue,this._depthMatrix=new Ue,this._fullMatrix=new Ue,this._decomposed={t:new M,q:new It,s:new M}}static type(){return"polarTransform"}createObject(){let e=new st;return e.matrixAutoUpdate=!1,e}initializeNode(){this.hierarchyController.initializeNode(),this.dirtyController.hasHook(VF)||this.dirtyController.addPostDirtyHook(VF,this._cook_main_without_inputs_when_dirty_bound),this._updateHelperHierarchy(),this._helper.matrixAutoUpdate=!1,this.flags.display.onUpdate(()=>{this._updateHelperHierarchy()})}_updateHelperHierarchy(){this._displayedHelper()?(this.object.add(this._helper),this._updateHelper()):this.object.remove(this._helper)}_displayedHelper(){return this.flags.display.active()}_axisHelper(){return this.__axisHelper__=this.__axisHelper__||this._createAxisHelper()}_createAxisHelper(){let e=new im(1);return e.matrixAutoUpdate=!1,e}_polarGridHelper(){return this.__polarGridHelper__=this.__polarGridHelper__||this._createPolarGridHelper()}_createPolarGridHelper(){let e=this.pv.depth,t=16,r=8,n=64,i=new Ov(e,t,r,n);return i.matrixAutoUpdate=!1,i}_createHelper(){let e=new st;return e.name="PolarTransformHelper",e.matrixAutoUpdate=!1,e.add(this._axisHelper()),e.add(this._polarGridHelper()),e}async _cook_main_without_inputs_when_dirty(){await this.cookController.cookMainWithoutInputs()}cook(){let e=this.object;this._centerMatrix.identity(),this._longitudeMatrix.identity(),this._latitudeMatrix.identity(),this._depthMatrix.identity(),this._centerMatrix.makeTranslation(this.pv.center.x,this.pv.center.y,this.pv.center.z),this._longitudeMatrix.makeRotationAxis(One,Mn(this.pv.longitude)),this._latitudeMatrix.makeRotationAxis(Pne,Mn(this.pv.latitude)),this._depthMatrix.makeTranslation(0,0,this.pv.depth),this._fullMatrix.copy(this._centerMatrix).multiply(this._longitudeMatrix).multiply(this._latitudeMatrix).multiply(this._depthMatrix),this._fullMatrix.decompose(this._decomposed.t,this._decomposed.q,this._decomposed.s),e.position.copy(this._decomposed.t),e.quaternion.copy(this._decomposed.q),e.scale.copy(this._decomposed.s),e.updateMatrix(),this._updateHelper(),this.cookController.endCook()}_updateHelper(){!this._displayedHelper()||(this._helper.updateMatrix(),this._polarGridHelper().matrix.copy(this.object.matrix),this._polarGridHelper().matrix.invert(),this._polarGridHelper().matrix.multiply(this._centerMatrix))}};var hd=class extends je{constructor(){super(pe(hd.getDefaults(),arguments,["positionX","positionY","positionZ"]));this.name="Panner3D";let e=pe(hd.getDefaults(),arguments,["positionX","positionY","positionZ"]);this._panner=this.input=this.output=this.context.createPanner(),this.panningModel=e.panningModel,this.maxDistance=e.maxDistance,this.distanceModel=e.distanceModel,this.coneOuterGain=e.coneOuterGain,this.coneOuterAngle=e.coneOuterAngle,this.coneInnerAngle=e.coneInnerAngle,this.refDistance=e.refDistance,this.rolloffFactor=e.rolloffFactor,this.positionX=new ft({context:this.context,param:this._panner.positionX,value:e.positionX}),this.positionY=new ft({context:this.context,param:this._panner.positionY,value:e.positionY}),this.positionZ=new ft({context:this.context,param:this._panner.positionZ,value:e.positionZ}),this.orientationX=new ft({context:this.context,param:this._panner.orientationX,value:e.orientationX}),this.orientationY=new ft({context:this.context,param:this._panner.orientationY,value:e.orientationY}),this.orientationZ=new ft({context:this.context,param:this._panner.orientationZ,value:e.orientationZ})}static getDefaults(){return Object.assign(je.getDefaults(),{coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:0,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1})}setPosition(e,t,r){return this.positionX.value=e,this.positionY.value=t,this.positionZ.value=r,this}setOrientation(e,t,r){return this.orientationX.value=e,this.orientationY.value=t,this.orientationZ.value=r,this}get panningModel(){return this._panner.panningModel}set panningModel(e){this._panner.panningModel=e}get refDistance(){return this._panner.refDistance}set refDistance(e){this._panner.refDistance=e}get rolloffFactor(){return this._panner.rolloffFactor}set rolloffFactor(e){this._panner.rolloffFactor=e}get distanceModel(){return this._panner.distanceModel}set distanceModel(e){this._panner.distanceModel=e}get coneInnerAngle(){return this._panner.coneInnerAngle}set coneInnerAngle(e){this._panner.coneInnerAngle=e}get coneOuterAngle(){return this._panner.coneOuterAngle}set coneOuterAngle(e){this._panner.coneOuterAngle=e}get coneOuterGain(){return this._panner.coneOuterGain}set coneOuterGain(e){this._panner.coneOuterGain=e}get maxDistance(){return this._panner.maxDistance}set maxDistance(e){this._panner.maxDistance=e}dispose(){return super.dispose(),this._panner.disconnect(),this.orientationX.dispose(),this.orientationY.dispose(),this.orientationZ.dispose(),this.positionX.dispose(),this.positionY.dispose(),this.positionZ.dispose(),this}};var Ol=new M,zF=new It,Rne=new M,Pl=new M,Rv=(o=>(o.LINEAR="linear",o.INVERSE="inverse",o.EXPONENTIAL="exponential",o))(Rv||{}),p2=["linear","inverse","exponential"],Iv=class extends vt{constructor(){super();this.listenerTransformAutoUpdate=!0,this.tonePanner=new hd,this.pannerNode=this.tonePanner.input}disconnect(){this.tonePanner.disconnect()}setInput(e){this._currentAudioNode&&this._currentAudioNode.disconnect(this.tonePanner),e&&e.connect(this.tonePanner),this._currentAudioNode=e}connect(e){this.tonePanner.connect(e)}getRefDistance(){return this.pannerNode.refDistance}setRefDistance(e){return this.pannerNode.refDistance=e,this}getRolloffFactor(){return this.pannerNode.rolloffFactor}setRolloffFactor(e){return this.pannerNode.rolloffFactor=e,this}getDistanceModel(){return this.pannerNode.distanceModel}setDistanceModel(e){return this.pannerNode.distanceModel=e,this}getMaxDistance(){return this.pannerNode.maxDistance}setMaxDistance(e){return this.pannerNode.maxDistance=e,this}setDirectionalCone(e,t,r){return this.pannerNode.coneInnerAngle=e,this.pannerNode.coneOuterAngle=t,this.pannerNode.coneOuterGain=r,this}coneInnerAngle(){return this.pannerNode.coneInnerAngle}coneOuterAngle(){return this.pannerNode.coneOuterAngle}updateMatrixWorld(e){if(super.updateMatrixWorld(e),!this.listenerTransformAutoUpdate)return;this.matrixWorld.decompose(Ol,zF,Rne),Pl.set(0,0,1).applyQuaternion(zF);let t="+1",r=this.tonePanner;r.positionX?(r.positionX.linearRampToValueAtTime(Ol.x,t),r.positionY.linearRampToValueAtTime(Ol.y,t),r.positionZ.linearRampToValueAtTime(Ol.z,t),r.orientationX.linearRampToValueAtTime(Pl.x,t),r.orientationY.linearRampToValueAtTime(Pl.y,t),r.orientationZ.linearRampToValueAtTime(Pl.z,t)):(r.setPosition(Ol.x,Ol.y,Ol.z),r.setOrientation(Pl.x,Pl.y,Pl.z))}};function Ine(o,e){let t=new Re,r=o+e*2,n=new Float32Array((r*3+3)*3);return t.setAttribute("position",new Tt(n,3)),t}function Lne(){return new ir({color:65280})}function Dne(){return new ir({color:16776960})}var Lv=class extends bs{constructor(e,t=1,r=16,n=2){super(Ine(r,n),[Lne(),Dne()]);this.audio=e,this.range=t,this.divisionsInnerAngle=r,this.divisionsOuterAngle=n,this.type="PositionalAudioHelper",this.update()}update(){let e=this.audio,t=this.range,r=this.divisionsInnerAngle,n=this.divisionsOuterAngle,i=Mn(e.coneInnerAngle()),s=Mn(e.coneOuterAngle()),a=i/2,c=s/2,l=0,u=0,p,d,h=this.geometry,m=h.attributes.position;h.clearGroups();function f(v,g,_,T){let b=(g-v)/_;for(m.setXYZ(l,0,0,0),u++,p=v;p<g;p+=b)d=l+u,m.setXYZ(d,Math.sin(p)*t,0,Math.cos(p)*t),m.setXYZ(d+1,Math.sin(Math.min(p+b,g))*t,0,Math.cos(Math.min(p+b,g))*t),m.setXYZ(d+2,0,0,0),u+=3;h.addGroup(l,u,T),l+=u,u=0}if(f(-c,-a,n,0),f(-a,a,r,1),f(a,c,n,0),m.needsUpdate=!0,i===s){let v=this.material;v[0].visible=!1}}dispose(){this.geometry.dispose();let e=this.material;e[0].dispose(),e[1].dispose()}};var Xa=()=>({cook:!1,callback:o=>{d2.PARAM_CALLBACK_updatePositionalAudio(o)}}),HF=class extends io(U){constructor(){super(...arguments);this.audio=y.FOLDER(),this.audioNode=y.NODE_PATH("",{nodeSelection:{context:oe.AUDIO}}),this.refDistance=y.FLOAT(10,{range:[0,10],rangeLocked:[!0,!1],...Xa()}),this.rolloffFactor=y.FLOAT(10,{range:[0,10],rangeLocked:[!0,!1],...Xa()}),this.maxDistance=y.FLOAT(100,{range:[.001,100],rangeLocked:[!0,!1],...Xa()}),this.distanceModel=y.INTEGER(p2.indexOf(Rv.LINEAR),{menu:{entries:p2.map((e,t)=>({name:e,value:t}))},...Xa()}),this.coneInnerAngle=y.FLOAT(360,{range:[0,360],rangeLocked:[!0,!0],...Xa()}),this.coneOuterAngle=y.FLOAT(230,{range:[0,360],rangeLocked:[!0,!0],...Xa()}),this.coneOuterGain=y.FLOAT(.1,{range:[0,1],rangeLocked:[!0,!0],...Xa()}),this.listenerTransformAutoUpdate=y.BOOLEAN(1),this.showHelper=y.BOOLEAN(1),this.helperSize=y.FLOAT(1,{range:[0,10],rangeLocked:[!0,!1],visibleIf:{showHelper:!0},...Xa()})}},kne=new HF;function Bne(){let o=new Iv;return o.matrixAutoUpdate=!1,o}var d2=class extends no{constructor(){super(...arguments);this.paramsConfig=kne,this.hierarchyController=new so(this),this.transformController=new jo(this),this.flags=new vo(this),this._positionalAudio=Bne(),this._childrenControllerContext=oe.AUDIO}static type(){return F0.POSITIONAL_AUDIO}createObject(){let e=new st;return e.matrixAutoUpdate=!1,e.add(this._positionalAudio),e}initializeNode(){this.hierarchyController.initializeNode(),this.transformController.initializeNode(),this._updateHelperHierarchy(),this.flags.display.onUpdate(async()=>{await this._updateToDestination(),await this._updateHelperHierarchy()})}async _updateToDestination(){if(this.flags.display.active()){let e=this.root().audioController.audioListeners()[0];if(!e){this.states.error.set("a listener is required in the scene");return}e.object.addInput(this._positionalAudio)}else this._positionalAudio.disconnect()}_updateHelperHierarchy(){!this._helper||(this.flags.display.active()?this.object.add(this._helper):this.object.remove(this._helper))}async cook(){this.transformController.update(),await this._updateToDestination(),this._updatePositionalAudio(),this._connectAudioNode(),this.cookController.endCook()}async _updatePositionalAudio(){this._positionalAudio.setRefDistance(this.pv.refDistance),this._positionalAudio.setRolloffFactor(this.pv.rolloffFactor),this._positionalAudio.setMaxDistance(this.pv.maxDistance),this._positionalAudio.setDistanceModel(p2[this.pv.distanceModel]),this._positionalAudio.setDirectionalCone(this.pv.coneInnerAngle,this.pv.coneOuterAngle,this.pv.coneOuterGain),this._positionalAudio.listenerTransformAutoUpdate=this.pv.listenerTransformAutoUpdate,this.pv.showHelper&&(this._helper=this._helper||this._createHelper(this._positionalAudio),this.object.add(this._helper)),this._helper&&(this._helper.visible=this.pv.showHelper,this._helper.range=this.pv.helperSize,this._helper.update())}_createHelper(e){let t=new Lv(e);return t.matrixAutoUpdate=!1,t}_resetAudioNode(){this._positionalAudio.setInput(void 0)}async _connectAudioNode(){this._resetAudioNode();let e=this.pv.audioNode.nodeWithContext(oe.AUDIO);if(!e){this.states.error.set("no audio node found"),this._resetAudioNode();return}let r=(await e.compute()).coreContent();if(!r){this.states.error.set("invalid audio node"),this._resetAudioNode();return}let n=r.audioNode();if(!n){this.states.error.set("no valid audio node given"),this._resetAudioNode();return}this._positionalAudio.setInput(n)}static PARAM_CALLBACK_updatePositionalAudio(e){e._updatePositionalAudio()}createNode(e,t){return super.createNode(e,t)}children(){return super.children()}nodesByType(e){return super.nodesByType(e)}};var jF=new Ue,WF=new M,qF=new M,Rl=class{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new z(512,512),this.map=null,this.mapPass=null,this.matrix=new Ue,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new xc,this._frameExtents=new z(1,1),this._viewportCount=1,this._viewports=[new De(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){let t=this.camera,r=this.matrix;WF.setFromMatrixPosition(e.matrixWorld),t.position.copy(WF),qF.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(qF),t.updateMatrixWorld(),jF.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(jF),r.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),r.multiply(t.projectionMatrix),r.multiply(t.matrixWorldInverse)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){let e={};return this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}};var h2=class extends Rl{constructor(){super(new sr(50,1,.5,500));this.focus=1}updateMatrices(e){let t=this.camera,r=jd*2*e.angle*this.focus,n=this.mapSize.width/this.mapSize.height,i=e.distance||t.far;(r!==t.fov||n!==t.aspect||i!==t.far)&&(t.fov=r,t.aspect=n,t.far=i,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}};h2.prototype.isSpotLightShadow=!0;var Ya=class extends wo{constructor(e,t,r=0,n=Math.PI/3,i=0,s=1){super(e,t);this.type="SpotLight",this.position.copy(vt.DefaultUp),this.updateMatrix(),this.target=new vt,this.distance=r,this.angle=n,this.penumbra=i,this.decay=s,this.shadow=new h2}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}};Ya.prototype.isSpotLight=!0;var fd=class extends Re{constructor(e=1,t=1,r=1,n=8,i=1,s=!1,a=0,c=Math.PI*2){super();this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:r,radialSegments:n,heightSegments:i,openEnded:s,thetaStart:a,thetaLength:c};let l=this;n=Math.floor(n),i=Math.floor(i);let u=[],p=[],d=[],h=[],m=0,f=[],v=r/2,g=0;_(),s===!1&&(e>0&&T(!0),t>0&&T(!1)),this.setIndex(u),this.setAttribute("position",new Ce(p,3)),this.setAttribute("normal",new Ce(d,3)),this.setAttribute("uv",new Ce(h,2));function _(){let b=new M,x=new M,A=0,E=(t-e)/r;for(let S=0;S<=i;S++){let w=[],O=S/i,C=O*(t-e)+e;for(let N=0;N<=n;N++){let R=N/n,D=R*c+a,V=Math.sin(D),F=Math.cos(D);x.x=C*V,x.y=-O*r+v,x.z=C*F,p.push(x.x,x.y,x.z),b.set(V,E,F).normalize(),d.push(b.x,b.y,b.z),h.push(R,1-O),w.push(m++)}f.push(w)}for(let S=0;S<n;S++)for(let w=0;w<i;w++){let O=f[w][S],C=f[w+1][S],N=f[w+1][S+1],R=f[w][S+1];u.push(O,C,R),u.push(C,N,R),A+=6}l.addGroup(g,A,0),g+=A}function T(b){let x=m,A=new z,E=new M,S=0,w=b===!0?e:t,O=b===!0?1:-1;for(let N=1;N<=n;N++)p.push(0,v*O,0),d.push(0,O,0),h.push(.5,.5),m++;let C=m;for(let N=0;N<=n;N++){let D=N/n*c+a,V=Math.cos(D),F=Math.sin(D);E.x=w*F,E.y=v*O,E.z=w*V,p.push(E.x,E.y,E.z),d.push(0,O,0),A.x=V*.5+.5,A.y=F*.5*O+.5,h.push(A.x,A.y),m++}for(let N=0;N<n;N++){let R=x+N,D=C+N;b===!0?u.push(D,D+1,R):u.push(D+1,D,R),S+=3}l.addGroup(g,S,b===!0?1:2),g+=S}}static fromJSON(e){return new fd(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}};var md=class extends fd{constructor(e=1,t=1,r=8,n=1,i=!1,s=0,a=Math.PI*2){super(0,e,t,r,n,i,s,a);this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:r,heightSegments:n,openEnded:i,thetaStart:s,thetaLength:a}}static fromJSON(e){return new md(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}};var JF=Ni(YF()),ZF=Ni(KF());var Dv=class{constructor(e){this.container=e}update(e){let t=this.container.light();if(e.tvolumetric){let r=this.object();f2.transformObject(r,{sizeMult:1,distance:t.distance,angle:t.angle});let n=r.material.uniforms;n.lightColor.value.copy(t.color),n.attenuation.value=e.volAttenuation,n.anglePower.value=e.volAnglePower,t.add(r)}else this._mesh&&t.remove(this._mesh)}object(){return this._mesh=this._mesh||this._createMesh()}_createMesh(){let i=new md(1,1,128,32);i.applyMatrix4(new Ue().makeTranslation(0,-.5*1,0)),i.applyMatrix4(new Ue().makeRotationX(-Math.PI/2));let s=this._createMaterial(),a=new ct(i,s);return a.matrixAutoUpdate=!1,a.name="Volumetric",s.uniforms.lightColor.value.set("white"),a}_createMaterial(){return new Sr({uniforms:{attenuation:{value:5},anglePower:{value:1.2},lightColor:{value:new de("cyan")}},vertexShader:JF.default,fragmentShader:ZF.default,transparent:!0,depthWrite:!1})}};var Bv={color:new de(1,1,1),intensity:1,angle:45,penumbra:.1,decay:.1,distance:100,showHelper:!1,helperSize:1,castShadow:!1,shadowAutoUpdate:!0,shadowUpdateOnNextRender:!1,shadowRes:new z(1024,1024),shadowBias:1e-4,shadowNear:.1,shadowFar:100,shadowRadius:0,tvolumetric:!1,volAttenuation:5,volAnglePower:10},ao=Bv;function QF(o){return class extends o{constructor(){super(...arguments);this.light=y.FOLDER(),this.color=y.COLOR(ao.color.toArray(),{conversion:ko.SRGB_TO_LINEAR}),this.intensity=y.FLOAT(ao.intensity,{range:[0,10],rangeLocked:[!0,!1]}),this.angle=y.FLOAT(ao.angle,{range:[0,180]}),this.penumbra=y.FLOAT(ao.penumbra),this.decay=y.FLOAT(ao.decay,{range:[0,1]}),this.distance=y.FLOAT(ao.distance,{range:[0,100]}),this.showHelper=y.BOOLEAN(ao.showHelper),this.helperSize=y.FLOAT(ao.helperSize,{visibleIf:{showHelper:1}}),this.shadow=y.FOLDER(),this.castShadow=y.BOOLEAN(ao.castShadow),this.shadowAutoUpdate=y.BOOLEAN(ao.shadowAutoUpdate,{visibleIf:{castShadow:1}}),this.shadowUpdateOnNextRender=y.BOOLEAN(ao.shadowUpdateOnNextRender,{visibleIf:{castShadow:1,shadowAutoUpdate:0}}),this.shadowRes=y.VECTOR2(ao.shadowRes.toArray(),{visibleIf:{castShadow:1}}),this.shadowBias=y.FLOAT(ao.shadowBias,{visibleIf:{castShadow:1},range:[-.01,.01],rangeLocked:[!1,!1]}),this.shadowNear=y.FLOAT(ao.shadowNear,{visibleIf:{castShadow:1},range:[0,100],rangeLocked:[!0,!1]}),this.shadowFar=y.FLOAT(ao.shadowFar,{visibleIf:{castShadow:1},range:[0,100],rangeLocked:[!0,!1]}),this.shadowRadius=y.FLOAT(ao.shadowRadius,{visibleIf:{castShadow:1},range:[0,10],rangeLocked:[!0,!1]}),this.volumetric=y.FOLDER(),this.tvolumetric=y.BOOLEAN(ao.tvolumetric),this.volAttenuation=y.FLOAT(ao.volAttenuation,{range:[0,10],rangeLocked:[!0,!1]}),this.volAnglePower=y.FLOAT(ao.volAnglePower,{range:[0,20],rangeLocked:[!0,!1]})}}}var um=class extends st{constructor(e){super();this._light=new Ya,this._target=this._light.target,this.matrixAutoUpdate=!1,this.params={showHelper:!1,helperSize:1,tvolumetric:!1,volAnglePower:1,volAttenuation:1},e.showHelper!=null&&(this.params.showHelper=e.showHelper),e.tvolumetric!=null&&(this.params.tvolumetric=e.tvolumetric),e.volAnglePower!=null&&(this.params.volAnglePower=e.volAnglePower),e.volAttenuation!=null&&(this.params.volAttenuation=e.volAttenuation),this._light.position.set(0,0,1),this._light.updateMatrix(),this._target.updateMatrix(),this._light.matrixAutoUpdate=!1,this._target.matrixAutoUpdate=!1,this._target.name="SpotLight Default Target",this.add(this._light),this.add(this._target),this.updateHelper()}updateParams(e){e.showHelper!=null&&(this.params.showHelper=e.showHelper),e.helperSize!=null&&(this.params.helperSize=e.helperSize),e.tvolumetric!=null&&(this.params.tvolumetric=e.tvolumetric),e.volAnglePower!=null&&(this.params.volAnglePower=e.volAnglePower),e.volAttenuation!=null&&(this.params.volAttenuation=e.volAttenuation)}light(){return this._light}copy(e,t){return this._light.copy(e.light()),this.position.copy(e.position),this.rotation.copy(e.rotation),this.scale.copy(e.scale),this.quaternion.copy(e.quaternion),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.updateParams(e.params),this.updateHelper(),this.updateVolumetric(),this.add(this._light.target),this}clone(e){let t=new um(this.params);return t.copy(this),t}updateHelper(){this.params.showHelper?(this.__helper__=this.__helper__||new f2(this),this.add(this.__helper__.object),this.__helper__.update({helperSize:this.params.helperSize})):this.__helper__&&this.remove(this.__helper__.object)}updateVolumetric(){this.params.tvolumetric?(this.__volumetric__=this.__volumetric__||new Dv(this),this.__volumetric__.update(this.params)):this.__volumetric__&&this.__volumetric__.update(this.params)}},kv=class{constructor(o){this.container=o,this.object=new ct,this._cone=new Gr,this._lineMaterial=new ir({fog:!1}),this.createAndBuildObject({helperSize:1})}createAndBuildObject(o){this.buildHelper(),this.update(o)}buildHelper(){this._cone.geometry=kv._buildConeGeometry(),this._cone.material=this._lineMaterial,this._cone.matrixAutoUpdate=!1,this.object.add(this._cone)}update(o){let e=this.container.light();kv.transformObject(this._cone,{sizeMult:o.helperSize,distance:e.distance,angle:e.angle}),this._lineMaterial.color.copy(e.color)}static transformObject(o,e){let t=(e.distance?e.distance:1e3)*e.sizeMult,r=t*Math.tan(e.angle);this._matrixScale.set(r,r,t),o.matrix.identity(),o.matrix.makeRotationX(Math.PI*1),o.matrix.scale(this._matrixScale)}static _buildConeGeometry(){let o=new Re,e=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let t=0,r=1,n=32;t<n;t++,r++){let i=t/n*Math.PI*2,s=r/n*Math.PI*2;e.push(Math.cos(i),Math.sin(i),1,Math.cos(s),Math.sin(s),1)}return o.setAttribute("position",new Ce(e,3)),o}},f2=kv;f2._matrixScale=new M;var pm=class extends Ke{static type(){return"spotLight"}cook(e,t){let r=this.createLight(t);return this.updateLightParams(r,t),this.updateShadowParams(r,t),r.updateParams(t),r.updateHelper(),r.updateVolumetric(),this.createCoreGroupFromObjects([r])}createLight(e){let t=new um(e),r=t.light();return r.matrixAutoUpdate=!1,r.castShadow=!0,r.shadow.bias=-.001,r.shadow.mapSize.x=1024,r.shadow.mapSize.y=1024,r.shadow.camera.near=.1,t}updateLightParams(e,t){let r=e.light();r.color=t.color,r.intensity=t.intensity,r.angle=t.angle*(Math.PI/180),r.penumbra=t.penumbra,r.decay=t.decay,r.distance=t.distance}updateShadowParams(e,t){let r=e.light();r.castShadow=t.castShadow,r.shadow.autoUpdate=t.shadowAutoUpdate,r.shadow.needsUpdate=t.shadowUpdateOnNextRender,r.shadow.mapSize.copy(t.shadowRes);let n=r.shadow.map;n&&n.setSize(t.shadowRes.x,t.shadowRes.y),r.shadow.bias=t.shadowBias,r.shadow.radius=t.shadowRadius,r.shadow.camera.near=t.shadowNear,r.shadow.camera.far=t.shadowFar,r.shadow.camera.updateProjectionMatrix(),e.updateHelper()}};pm.DEFAULT_PARAMS=Bv;pm.INPUT_CLONED_STATE=ke.NEVER;var eU=class extends QF(io(U)){},Fne=new eU,Fv=class extends Xf{constructor(){super(...arguments);this.paramsConfig=Fne}static type(){return rm.SPOT}_operation(){return this.__operation__=this.__operation__||new pm(this._scene,this.states)}createLight(){return this._operation().createLight(this.pv)}updateLightParams(){this._operation().updateLightParams(this.light,this.pv)}updateShadowParams(){this.light.updateParams(this.pv),this.light.updateHelper(),this.light.updateVolumetric(),this._operation().updateShadowParams(this.light,this.pv)}};var tU=new M,m2=new M,us=class{constructor(e=new M,t=new M){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){tU.subVectors(e,this.start),m2.subVectors(this.end,this.start);let r=m2.dot(m2),i=m2.dot(tU)/r;return t&&(i=Li(i,0,1)),i}closestPointToPoint(e,t,r){let n=this.closestPointToPointParameter(e,t);return this.delta(r).multiplyScalar(n).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}};var yU=0,Une=1,Vne=2;var rU=2,oU=1.25,Gne=1,fm=class{constructor(){}};function Ks(o,e,t){return t.min.x=e[o],t.min.y=e[o+1],t.min.z=e[o+2],t.max.x=e[o+3],t.max.y=e[o+4],t.max.z=e[o+5],t}function nU(o){let e=-1,t=-1/0;for(let r=0;r<3;r++){let n=o[r+3]-o[r];n>t&&(t=n,e=r)}return e}function iU(o,e){e.set(o)}function sU(o,e,t){let r,n;for(let i=0;i<3;i++){let s=i+3;r=o[i],n=e[i],t[i]=r<n?r:n,r=o[s],n=e[s],t[s]=r>n?r:n}}function Uv(o){let e=o[3]-o[0],t=o[4]-o[1],r=o[5]-o[2];return 2*(e*t+t*r+r*e)}var zne=Math.pow(2,-24);function Hne(o,e){if(!o.index){let t=o.attributes.position.count,r=e.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer,n;t>65535?n=new Uint32Array(new r(4*t)):n=new Uint16Array(new r(2*t)),o.setIndex(new Tt(n,1));for(let i=0;i<t;i++)n[i]=i}}function jne(o){if(!o.groups||!o.groups.length)return[{offset:0,count:o.index.count/3}];let e=[],t=new Set;for(let n of o.groups)t.add(n.start),t.add(n.start+n.count);let r=Array.from(t.values()).sort((n,i)=>n-i);for(let n=0;n<r.length-1;n++){let i=r[n],s=r[n+1];e.push({offset:i/3,count:(s-i)/3})}return e}function Vv(o,e,t,r,n=null){let i=1/0,s=1/0,a=1/0,c=-1/0,l=-1/0,u=-1/0,p=1/0,d=1/0,h=1/0,m=-1/0,f=-1/0,v=-1/0,g=n!==null;for(let _=e*6,T=(e+t)*6;_<T;_+=6){let b=o[_+0],x=o[_+1],A=b-x,E=b+x;A<i&&(i=A),E>c&&(c=E),g&&b<p&&(p=b),g&&b>m&&(m=b);let S=o[_+2],w=o[_+3],O=S-w,C=S+w;O<s&&(s=O),C>l&&(l=C),g&&S<d&&(d=S),g&&S>f&&(f=S);let N=o[_+4],R=o[_+5],D=N-R,V=N+R;D<a&&(a=D),V>u&&(u=V),g&&N<h&&(h=N),g&&N>v&&(v=N)}r[0]=i,r[1]=s,r[2]=a,r[3]=c,r[4]=l,r[5]=u,g&&(n[0]=p,n[1]=d,n[2]=h,n[3]=m,n[4]=f,n[5]=v)}function Wne(o,e,t,r){let n=1/0,i=1/0,s=1/0,a=-1/0,c=-1/0,l=-1/0;for(let u=e*6,p=(e+t)*6;u<p;u+=6){let d=o[u+0];d<n&&(n=d),d>a&&(a=d);let h=o[u+2];h<i&&(i=h),h>c&&(c=h);let m=o[u+4];m<s&&(s=m),m>l&&(l=m)}r[0]=n,r[1]=i,r[2]=s,r[3]=a,r[4]=c,r[5]=l}function qne(o,e,t,r,n){let i=t,s=t+r-1,a=n.pos,c=n.axis*2;for(;;){for(;i<=s&&e[i*6+c]<a;)i++;for(;i<=s&&e[s*6+c]>=a;)s--;if(i<s){for(let l=0;l<3;l++){let u=o[i*3+l];o[i*3+l]=o[s*3+l],o[s*3+l]=u;let p=e[i*6+l*2+0];e[i*6+l*2+0]=e[s*6+l*2+0],e[s*6+l*2+0]=p;let d=e[i*6+l*2+1];e[i*6+l*2+1]=e[s*6+l*2+1],e[s*6+l*2+1]=d}i++,s--}else return i}}var $a=32,Il=new Array($a).fill().map(()=>({count:0,bounds:new Float32Array(6),rightCacheBounds:new Float32Array(6),candidate:0})),_2=new Float32Array(6);function Xne(o,e,t,r,n,i){let s=-1,a=0;if(i===yU)s=nU(e),s!==-1&&(a=(e[s]+e[s+3])/2);else if(i===Une)s=nU(o),s!==-1&&(a=Yne(t,r,n,s));else if(i===Vne){let c=Uv(o),l=oU*n,u=r*6,p=(r+n)*6;for(let d=0;d<3;d++){let h=e[d],v=(e[d+3]-h)/$a;for(let T=0;T<$a;T++){let b=Il[T];b.count=0,b.candidate=h+v+T*v;let x=b.bounds;for(let A=0;A<3;A++)x[A]=1/0,x[A+3]=-1/0}for(let T=u;T<p;T+=6){let A=~~((t[T+2*d]-h)/v);A>=$a&&(A=$a-1);let E=Il[A];E.count++;let S=E.bounds;for(let w=0;w<3;w++){let O=t[T+2*w],C=t[T+2*w+1],N=O-C,R=O+C;N<S[w]&&(S[w]=N),R>S[w+3]&&(S[w+3]=R)}}let g=Il[$a-1];iU(g.bounds,g.rightCacheBounds);for(let T=$a-2;T>=0;T--){let b=Il[T],x=Il[T+1];sU(b.bounds,x.rightCacheBounds,b.rightCacheBounds)}let _=0;for(let T=0;T<$a-1;T++){let b=Il[T],x=b.count,A=b.bounds,S=Il[T+1].rightCacheBounds;x!==0&&(_===0?iU(A,_2):sU(A,_2,_2)),_+=x;let w=0,O=0;_!==0&&(w=Uv(_2)/c);let C=n-_;C!==0&&(O=Uv(S)/c);let N=Gne+oU*(w*_+O*C);N<l&&(s=d,l=N,a=b.candidate)}}}return{axis:s,pos:a}}function Yne(o,e,t,r){let n=0;for(let i=e,s=e+t;i<s;i++)n+=o[i*6+r*2];return n/t}function $ne(o,e){let t=o.attributes.position,r=t.array,n=o.index.array,i=n.length/3,s=new Float32Array(i*6),a=t.offset||0,c=3;t.isInterleavedBufferAttribute&&(c=t.data.stride);for(let l=0;l<i;l++){let u=l*3,p=l*6,d=n[u+0]*c+a,h=n[u+1]*c+a,m=n[u+2]*c+a;for(let f=0;f<3;f++){let v=r[d+f],g=r[h+f],_=r[m+f],T=v;g<T&&(T=g),_<T&&(T=_);let b=v;g>b&&(b=g),_>b&&(b=_);let x=(b-T)/2,A=f*2;s[p+A+0]=T+x,s[p+A+1]=x+(Math.abs(T)+x)*zne,T<e[f]&&(e[f]=T),b>e[f+3]&&(e[f+3]=b)}}return s}function Kne(o,e){function t(m,f,v,g=null,_=0){if(!p&&_>=a&&(p=!0,c&&(console.warn(`MeshBVH: Max depth of ${a} reached when generating BVH. Consider increasing maxDepth.`),console.warn(o))),v<=l||_>=a)return m.offset=f,m.count=v,m;let T=Xne(m.boundingData,g,i,f,v,u);if(T.axis===-1)return m.offset=f,m.count=v,m;let b=qne(s,i,f,v,T);if(b===f||b===f+v)m.offset=f,m.count=v;else{m.splitAxis=T.axis;let x=new fm,A=f,E=b-f;m.left=x,x.boundingData=new Float32Array(6),Vv(i,A,E,x.boundingData,n),t(x,A,E,n,_+1);let S=new fm,w=b,O=v-E;m.right=S,S.boundingData=new Float32Array(6),Vv(i,w,O,S.boundingData,n),t(S,w,O,n,_+1)}return m}Hne(o,e);let r=new Float32Array(6),n=new Float32Array(6),i=$ne(o,r),s=o.index.array,a=e.maxDepth,c=e.verbose,l=e.maxLeafTris,u=e.strategy,p=!1,d=[],h=jne(o);if(h.length===1){let m=h[0],f=new fm;f.boundingData=r,Wne(i,m.offset,m.count,n),t(f,m.offset,m.count,n),d.push(f)}else for(let m of h){let f=new fm;f.boundingData=new Float32Array(6),Vv(i,m.offset,m.count,f.boundingData,n),t(f,m.offset,m.count,n),d.push(f)}return d}var T2=6*4+4+4,Wv=65535;function Jne(o,e){let t=Kne(o,e),r,n,i,s=[],a=e.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer;for(let u=0;u<t.length;u++){let p=t[u],d=c(p),h=new a(T2*d);r=new Float32Array(h),n=new Uint32Array(h),i=new Uint16Array(h),l(0,p),s.push(h)}return s;function c(u){return u.count?1:1+c(u.left)+c(u.right)}function l(u,p){let d=u/4,h=u/2,m=!!p.count,f=p.boundingData;for(let v=0;v<6;v++)r[d+v]=f[v];if(m){let v=p.offset,g=p.count;return n[d+6]=v,i[h+14]=g,i[h+15]=Wv,u+T2}else{let v=p.left,g=p.right,_=p.splitAxis,T;if(T=l(u+T2,v),T/4>Math.pow(2,32))throw new Error("MeshBVH: Cannot store child pointer greater than 32 bits.");return n[d+6]=T/4,T=l(T,g),n[d+7]=_,T}}}var ps=class{constructor(){this.min=1/0,this.max=-1/0}setFromPointsField(e,t){let r=1/0,n=-1/0;for(let i=0,s=e.length;i<s;i++){let c=e[i][t];r=c<r?c:r,n=c>n?c:n}this.min=r,this.max=n}setFromPoints(e,t){let r=1/0,n=-1/0;for(let i=0,s=t.length;i<s;i++){let a=t[i],c=e.dot(a);r=c<r?c:r,n=c>n?c:n}this.min=r,this.max=n}isSeparated(e){return this.min>e.max||e.min>this.max}};ps.prototype.setFromBox=function(){let o=new M;return function(t,r){let n=r.min,i=r.max,s=1/0,a=-1/0;for(let c=0;c<=1;c++)for(let l=0;l<=1;l++)for(let u=0;u<=1;u++){o.x=n.x*c+i.x*(1-c),o.y=n.y*l+i.y*(1-l),o.z=n.z*u+i.z*(1-u);let p=t.dot(o);s=Math.min(p,s),a=Math.max(p,a)}this.min=s,this.max=a}}();var r4t=function(){let o=new ps;return function(t,r){let n=t.points,i=t.satAxes,s=t.satBounds,a=r.points,c=r.satAxes,l=r.satBounds;for(let u=0;u<3;u++){let p=s[u],d=i[u];if(o.setFromPoints(d,a),p.isSeparated(o))return!1}for(let u=0;u<3;u++){let p=l[u],d=c[u];if(o.setFromPoints(d,n),p.isSeparated(o))return!1}}}(),Zne=function(){let o=new M,e=new M,t=new M;return function(n,i,s){let a=n.start,c=o,l=i.start,u=e;t.subVectors(a,l),o.subVectors(n.end,i.start),e.subVectors(i.end,i.start);let p=t.dot(u),d=u.dot(c),h=u.dot(u),m=t.dot(c),v=c.dot(c)*h-d*d,g,_;v!==0?g=(p*d-m*h)/v:g=0,_=(p+g*d)/h,s.x=g,s.y=_}}(),$v=function(){let o=new z,e=new M,t=new M;return function(n,i,s,a){Zne(n,i,o);let c=o.x,l=o.y;if(c>=0&&c<=1&&l>=0&&l<=1){n.at(c,s),i.at(l,a);return}else if(c>=0&&c<=1){l<0?i.at(0,a):i.at(1,a),n.closestPointToPoint(a,!0,s);return}else if(l>=0&&l<=1){c<0?n.at(0,s):n.at(1,s),i.closestPointToPoint(s,!0,a);return}else{let u;c<0?u=n.start:u=n.end;let p;l<0?p=i.start:p=i.end;let d=e,h=t;if(n.closestPointToPoint(p,!0,e),i.closestPointToPoint(u,!0,t),d.distanceToSquared(p)<=h.distanceToSquared(u)){s.copy(d),a.copy(p);return}else{s.copy(u),a.copy(h);return}}}}(),Qne=function(){let o=new M,e=new M,t=new Io,r=new us;return function(i,s){let{radius:a,center:c}=i,{a:l,b:u,c:p}=s;if(r.start=l,r.end=u,r.closestPointToPoint(c,!0,o).distanceTo(c)<=a||(r.start=l,r.end=p,r.closestPointToPoint(c,!0,o).distanceTo(c)<=a)||(r.start=u,r.end=p,r.closestPointToPoint(c,!0,o).distanceTo(c)<=a))return!0;let f=s.getPlane(t);if(Math.abs(f.distanceToPoint(c))<=a){let g=f.projectPoint(c,e);if(s.containsPoint(g))return!0}return!1}}(),Js=class extends mn{constructor(...e){super(...e);this.isSeparatingAxisTriangle=!0,this.satAxes=new Array(4).fill().map(()=>new M),this.satBounds=new Array(4).fill().map(()=>new ps),this.points=[this.a,this.b,this.c],this.sphere=new X0,this.plane=new Io,this.needsUpdate=!1}intersectsSphere(e){return Qne(e,this)}update(){let e=this.a,t=this.b,r=this.c,n=this.points,i=this.satAxes,s=this.satBounds,a=i[0],c=s[0];this.getNormal(a),c.setFromPoints(a,n);let l=i[1],u=s[1];l.subVectors(e,t),u.setFromPoints(l,n);let p=i[2],d=s[2];p.subVectors(t,r),d.setFromPoints(p,n);let h=i[3],m=s[3];h.subVectors(r,e),m.setFromPoints(h,n),this.sphere.setFromPoints(this.points),this.plane.setFromNormalAndCoplanarPoint(a,e),this.needsUpdate=!1}};Js.prototype.closestPointToSegment=function(){let o=new M,e=new M,t=new us;return function(n,i=null,s=null){let{start:a,end:c}=n,l=this.points,u,p=1/0;for(let d=0;d<3;d++){let h=(d+1)%3;t.start.copy(l[d]),t.end.copy(l[h]),$v(t,n,o,e),u=o.distanceToSquared(e),u<p&&(p=u,i&&i.copy(o),s&&s.copy(e))}return this.closestPointToPoint(a,o),u=a.distanceToSquared(o),u<p&&(p=u,i&&i.copy(o),s&&s.copy(a)),this.closestPointToPoint(c,o),u=c.distanceToSquared(o),u<p&&(p=u,i&&i.copy(o),s&&s.copy(c)),Math.sqrt(p)}}();Js.prototype.intersectsTriangle=function(){let o=new Js,e=new Array(3),t=new Array(3),r=new ps,n=new ps,i=new M,s=new M,a=new M,c=new M,l=new us,u=new us,p=new us;return function(h,m=null){this.needsUpdate&&this.update(),h.isSeparatingAxisTriangle?h.needsUpdate&&h.update():(o.copy(h),o.update(),h=o);let f=this.satBounds,v=this.satAxes;t[0]=h.a,t[1]=h.b,t[2]=h.c;for(let T=0;T<4;T++){let b=f[T],x=v[T];if(r.setFromPoints(x,t),b.isSeparated(r))return!1}let g=h.satBounds,_=h.satAxes;e[0]=this.a,e[1]=this.b,e[2]=this.c;for(let T=0;T<4;T++){let b=g[T],x=_[T];if(r.setFromPoints(x,e),b.isSeparated(r))return!1}for(let T=0;T<4;T++){let b=v[T];for(let x=0;x<4;x++){let A=_[x];if(i.crossVectors(b,A),r.setFromPoints(i,e),n.setFromPoints(i,t),r.isSeparated(n))return!1}}if(m){let T=this.plane,b=h.plane;if(Math.abs(T.normal.dot(b.normal))>1-1e-10)console.warn("SeparatingAxisTriangle.intersectsTriangle: Triangles are coplanar which does not support an output edge. Setting edge to 0, 0, 0."),m.start.set(0,0,0),m.end.set(0,0,0);else{let x=this.points,A=!1;for(let w=0;w<3;w++){let O=x[w],C=x[(w+1)%3];if(l.start.copy(O),l.end.copy(C),b.intersectLine(l,A?u.start:u.end)){if(A)break;A=!0}}let E=h.points,S=!1;for(let w=0;w<3;w++){let O=E[w],C=E[(w+1)%3];if(l.start.copy(O),l.end.copy(C),T.intersectLine(l,S?p.start:p.end)){if(S)break;S=!0}}if(u.delta(s),p.delta(a),s.dot(a)<0){let w=p.start;p.start=p.end,p.end=w}c.subVectors(u.start,p.start),c.dot(s)>0?m.start.copy(u.start):m.start.copy(p.start),c.subVectors(u.end,p.end),c.dot(s)<0?m.end.copy(u.end):m.end.copy(p.end)}}return!0}}();Js.prototype.distanceToPoint=function(){let o=new M;return function(t){return this.closestPointToPoint(t,o),t.distanceTo(o)}}();Js.prototype.distanceToTriangle=function(){let o=new M,e=new M,t=["a","b","c"],r=new us,n=new us;return function(s,a=null,c=null){let l=a||c?r:null;if(this.intersectsTriangle(s,l))return(a||c)&&(a&&l.getCenter(a),c&&l.getCenter(c)),0;let u=1/0;for(let p=0;p<3;p++){let d,h=t[p],m=s[h];this.closestPointToPoint(m,o),d=m.distanceToSquared(o),d<u&&(u=d,a&&a.copy(o),c&&c.copy(m));let f=this[h];s.closestPointToPoint(f,o),d=f.distanceToSquared(o),d<u&&(u=d,a&&a.copy(f),c&&c.copy(o))}for(let p=0;p<3;p++){let d=t[p],h=t[(p+1)%3];r.set(this[d],this[h]);for(let m=0;m<3;m++){let f=t[m],v=t[(m+1)%3];n.set(s[f],s[v]),$v(r,n,o,e);let g=o.distanceToSquared(e);g<u&&(u=g,a&&a.copy(o),c&&c.copy(e))}}return Math.sqrt(u)}}();var ds=class extends fn{constructor(...e){super(...e);this.isOrientedBox=!0,this.matrix=new Ue,this.invMatrix=new Ue,this.points=new Array(8).fill().map(()=>new M),this.satAxes=new Array(3).fill().map(()=>new M),this.satBounds=new Array(3).fill().map(()=>new ps),this.alignedSatBounds=new Array(3).fill().map(()=>new ps),this.needsUpdate=!1}set(e,t,r){super.set(e,t),this.matrix=r,this.needsUpdate=!0}copy(e){super.copy(e),this.matrix.copy(e.matrix),this.needsUpdate=!0}};ds.prototype.update=function(){return function(){let e=this.matrix,t=this.min,r=this.max,n=this.points;for(let l=0;l<=1;l++)for(let u=0;u<=1;u++)for(let p=0;p<=1;p++){let d=1*l|2*u|4*p,h=n[d];h.x=l?r.x:t.x,h.y=u?r.y:t.y,h.z=p?r.z:t.z,h.applyMatrix4(e)}let i=this.satBounds,s=this.satAxes,a=n[0];for(let l=0;l<3;l++){let u=s[l],p=i[l],d=1<<l,h=n[d];u.subVectors(a,h),p.setFromPoints(u,n)}let c=this.alignedSatBounds;c[0].setFromPointsField(n,"x"),c[1].setFromPointsField(n,"y"),c[2].setFromPointsField(n,"z"),this.invMatrix.copy(this.matrix).invert(),this.needsUpdate=!1}}();ds.prototype.intersectsBox=function(){let o=new ps;return function(t){this.needsUpdate&&this.update();let r=t.min,n=t.max,i=this.satBounds,s=this.satAxes,a=this.alignedSatBounds;if(o.min=r.x,o.max=n.x,a[0].isSeparated(o)||(o.min=r.y,o.max=n.y,a[1].isSeparated(o))||(o.min=r.z,o.max=n.z,a[2].isSeparated(o)))return!1;for(let c=0;c<3;c++){let l=s[c],u=i[c];if(o.setFromBox(l,t),u.isSeparated(o))return!1}return!0}}();ds.prototype.intersectsTriangle=function(){let o=new Js,e=new Array(3),t=new ps,r=new ps,n=new M;return function(s){this.needsUpdate&&this.update(),s.isSeparatingAxisTriangle?s.needsUpdate&&s.update():(o.copy(s),o.update(),s=o);let a=this.satBounds,c=this.satAxes;e[0]=s.a,e[1]=s.b,e[2]=s.c;for(let d=0;d<3;d++){let h=a[d],m=c[d];if(t.setFromPoints(m,e),h.isSeparated(t))return!1}let l=s.satBounds,u=s.satAxes,p=this.points;for(let d=0;d<3;d++){let h=l[d],m=u[d];if(t.setFromPoints(m,p),h.isSeparated(t))return!1}for(let d=0;d<3;d++){let h=c[d];for(let m=0;m<4;m++){let f=u[m];if(n.crossVectors(h,f),t.setFromPoints(n,e),r.setFromPoints(n,p),t.isSeparated(r))return!1}}return!0}}();ds.prototype.closestPointToPoint=function(){return function(e,t){return this.needsUpdate&&this.update(),t.copy(e).applyMatrix4(this.invMatrix).clamp(this.min,this.max).applyMatrix4(this.matrix),t}}();ds.prototype.distanceToPoint=function(){let o=new M;return function(t){return this.closestPointToPoint(t,o),t.distanceTo(o)}}();ds.prototype.distanceToBox=function(){let o=["x","y","z"],e=new Array(12).fill().map(()=>new us),t=new Array(12).fill().map(()=>new us),r=new M,n=new M;return function(s,a=0,c=null,l=null){if(this.needsUpdate&&this.update(),this.intersectsBox(s))return(c||l)&&(s.getCenter(n),this.closestPointToPoint(n,r),s.closestPointToPoint(r,n),c&&c.copy(r),l&&l.copy(n)),0;let u=a*a,p=s.min,d=s.max,h=this.points,m=1/0;for(let v=0;v<8;v++){let g=h[v];n.copy(g).clamp(p,d);let _=g.distanceToSquared(n);if(_<m&&(m=_,c&&c.copy(g),l&&l.copy(n),_<u))return Math.sqrt(_)}let f=0;for(let v=0;v<3;v++)for(let g=0;g<=1;g++)for(let _=0;_<=1;_++){let T=(v+1)%3,b=(v+2)%3,x=g<<T|_<<b,A=1<<v|g<<T|_<<b,E=h[x],S=h[A];e[f].set(E,S);let O=o[v],C=o[T],N=o[b],R=t[f],D=R.start,V=R.end;D[O]=p[O],D[C]=g?p[C]:d[C],D[N]=_?p[N]:d[C],V[O]=d[O],V[C]=g?p[C]:d[C],V[N]=_?p[N]:d[C],f++}for(let v=0;v<=1;v++)for(let g=0;g<=1;g++)for(let _=0;_<=1;_++){n.x=v?d.x:p.x,n.y=g?d.y:p.y,n.z=_?d.z:p.z,this.closestPointToPoint(n,r);let T=n.distanceToSquared(r);if(T<m&&(m=T,c&&c.copy(r),l&&l.copy(n),T<u))return Math.sqrt(T)}for(let v=0;v<12;v++){let g=e[v];for(let _=0;_<12;_++){let T=t[_];$v(g,T,r,n);let b=r.distanceToSquared(n);if(b<m&&(m=b,c&&c.copy(r),l&&l.copy(n),b<u))return Math.sqrt(b)}}return Math.sqrt(m)}}();var g2=new M,v2=new M,y2=new M,aU=new z,cU=new z,lU=new z,uU=new M;function eie(o,e,t,r,n,i){let s;return i===Mt?s=o.intersectTriangle(r,t,e,!0,n):s=o.intersectTriangle(e,t,r,i!==Wr,n),s===null?null:{distance:o.origin.distanceTo(n),point:n.clone()}}function tie(o,e,t,r,n,i,s){g2.fromBufferAttribute(e,r),v2.fromBufferAttribute(e,n),y2.fromBufferAttribute(e,i);let a=eie(o,g2,v2,y2,uU,s);if(a){t&&(aU.fromBufferAttribute(t,r),cU.fromBufferAttribute(t,n),lU.fromBufferAttribute(t,i),a.uv=mn.getUV(uU,g2,v2,y2,aU,cU,lU,new z));let c={a:r,b:n,c:i,normal:new M,materialIndex:0};mn.getNormal(g2,v2,y2,c.normal),a.face=c,a.faceIndex=r}return a}function xU(o,e,t,r,n){let i=r*3,s=o.index.getX(i),a=o.index.getX(i+1),c=o.index.getX(i+2),l=tie(t,o.attributes.position,o.attributes.uv,s,a,c,e);return l?(l.faceIndex=r,n&&n.push(l),l):null}function rie(o,e,t,r,n,i){for(let s=r,a=r+n;s<a;s++)xU(o,e,t,s,i)}function oie(o,e,t,r,n){let i=1/0,s=null;for(let a=r,c=r+n;a<c;a++){let l=xU(o,e,t,a);l&&l.distance<i&&(s=l,i=l.distance)}return s}function C2(o,e,t){return o===null||(o.point.applyMatrix4(e.matrixWorld),o.distance=o.point.distanceTo(t.ray.origin),o.object=e,o.distance<t.near||o.distance>t.far)?null:o}function $s(o,e,t,r){let n=o.a,i=o.b,s=o.c,a=e,c=e+1,l=e+2;t&&(a=t.getX(e),c=t.getX(e+1),l=t.getX(e+2)),n.x=r.getX(a),n.y=r.getY(a),n.z=r.getZ(a),i.x=r.getX(c),i.y=r.getY(c),i.z=r.getZ(c),s.x=r.getX(l),s.y=r.getY(l),s.z=r.getZ(l)}function pU(o,e,t,r,n,i,s){let a=t.index,c=t.attributes.position;for(let l=o,u=e+o;l<u;l++)if($s(s,l*3,a,c),s.needsUpdate=!0,r(s,l,n,i))return!0;return!1}var Kv=class{constructor(e){this._getNewPrimitive=e,this._primitives=[]}getPrimitive(){let e=this._primitives;return e.length===0?this._getNewPrimitive():e.pop()}releasePrimitive(e){this._primitives.push(e)}};function Ka(o,e){return e[o+15]===65535}function vd(o,e){return e[o+6]}function _m(o,e){return e[o+14]}function gm(o){return o+8}function vm(o,e){return e[o+6]}function nie(o,e){return e[o+7]}var gd=new fn,E2=new M,iie=["x","y","z"];function qv(o,e,t,r,n){let i=o*2,s=yd,a=Ja,c=Za;if(Ka(i,a)){let u=vd(o,c),p=_m(i,a);rie(e,t,r,u,p,n)}else{let u=gm(o);S2(u,s,r,E2)&&qv(u,e,t,r,n);let p=vm(o,c);S2(p,s,r,E2)&&qv(p,e,t,r,n)}}function Xv(o,e,t,r){let n=o*2,i=yd,s=Ja,a=Za;if(Ka(n,s)){let l=vd(o,a),u=_m(n,s);return oie(e,t,r,l,u)}else{let l=nie(o,a),u=iie[l],d=r.direction[u]>=0,h,m;d?(h=gm(o),m=vm(o,a)):(h=vm(o,a),m=gm(o));let v=S2(h,i,r,E2)?Xv(h,e,t,r):null;if(v){let T=v.point[u];if(d?T<=i[m+l]:T>=i[m+l+3])return v}let _=S2(m,i,r,E2)?Xv(m,e,t,r):null;return v&&_?v.distance<=_.distance?v:_:v||_||null}}var sie=function(){let o,e,t=[],r=new Kv(()=>new fn);return function(...s){o=r.getPrimitive(),e=r.getPrimitive(),t.push(o,e);let a=n(...s);r.releasePrimitive(o),r.releasePrimitive(e),t.pop(),t.pop();let c=t.length;return c>0&&(e=t[c-1],o=t[c-2]),a};function n(i,s,a,c,l=null,u=0,p=0){function d(T){let b=T*2,x=Ja,A=Za;for(;!Ka(b,x);)T=gm(T),b=T*2;return vd(T,A)}function h(T){let b=T*2,x=Ja,A=Za;for(;!Ka(b,x);)T=vm(T,A),b=T*2;return vd(T,A)+_m(b,x)}let m=i*2,f=yd,v=Ja,g=Za;if(Ka(m,v)){let T=vd(i,g),b=_m(m,v);return Ks(i,f,o),c(T,b,!1,p,u+i,o)}else{let T=gm(i),b=vm(i,g),x=T,A=b,E,S,w,O;if(l&&(w=o,O=e,Ks(x,f,w),Ks(A,f,O),E=l(w),S=l(O),S<E)){x=b,A=T;let j=E;E=S,S=j,w=O}w||(w=o,Ks(x,f,w));let C=Ka(x*2,v),N=a(w,C,E,p+1,u+x),R;if(N===rU){let j=d(x),Y=h(x)-j;R=c(j,Y,!0,p+1,u+x,w)}else R=N&&n(x,s,a,c,l,u,p+1);if(R)return!0;O=e,Ks(A,f,O);let D=Ka(A*2,v),V=a(O,D,S,p+1,u+A),F;if(V===rU){let j=d(A),Y=h(A)-j;F=c(j,Y,!0,p+1,u+A,O)}else F=V&&n(A,s,a,c,l,u,p+1);return!!F}}}(),aie=function(){let o=new Js,e=new Js,t=new Ue,r=new ds,n=new ds;return function i(s,a,c,l,u=null){let p=s*2,d=yd,h=Ja,m=Za;if(u===null&&(c.boundingBox||c.computeBoundingBox(),r.set(c.boundingBox.min,c.boundingBox.max,l),u=r),Ka(p,h)){let v=a,g=v.index,_=v.attributes.position,T=c.index,b=c.attributes.position,x=vd(s,m),A=_m(p,h);if(t.copy(l).invert(),c.boundsTree)return Ks(s,d,n),n.matrix.copy(t),n.needsUpdate=!0,c.boundsTree.shapecast({intersectsBounds:S=>n.intersectsBox(S),intersectsTriangle:S=>{S.a.applyMatrix4(l),S.b.applyMatrix4(l),S.c.applyMatrix4(l),S.needsUpdate=!0;for(let w=x*3,O=(A+x)*3;w<O;w+=3)if($s(e,w,g,_),e.needsUpdate=!0,S.intersectsTriangle(e))return!0;return!1}});for(let E=x*3,S=A+x*3;E<S;E+=3){$s(o,E,g,_),o.a.applyMatrix4(t),o.b.applyMatrix4(t),o.c.applyMatrix4(t),o.needsUpdate=!0;for(let w=0,O=T.count;w<O;w+=3)if($s(e,w,T,b),e.needsUpdate=!0,o.intersectsTriangle(e))return!0}}else{let v=s+8,g=m[s+6];return Ks(v,d,gd),!!(u.intersectsBox(gd)&&i(v,a,c,l,u)||(Ks(g,d,gd),u.intersectsBox(gd)&&i(g,a,c,l,u)))}}}();function S2(o,e,t,r){return Ks(o,e,gd),t.intersectBox(gd,r)}var Yv=[],A2,yd,Ja,Za;function mm(o){A2&&Yv.push(A2),A2=o,yd=new Float32Array(o),Ja=new Uint16Array(o),Za=new Uint32Array(o)}function x2(){A2=null,yd=null,Ja=null,Za=null,Yv.length&&mm(Yv.pop())}var Gv=Symbol("skip tree generation"),zv=new fn,Hv=new fn,_d=new Ue,Ll=new ds,dm=new ds,hm=new M,b2=new M,cie=new M,lie=new M,uie=new M,dU=new fn,Ys=new Kv(()=>new Js),co=class{static serialize(e,t={}){if(t.isBufferGeometry)return console.warn("MeshBVH.serialize: The arguments for the function have changed. See documentation for new signature."),co.serialize(arguments[0],{cloneBuffers:arguments[2]===void 0?!0:arguments[2]});t={cloneBuffers:!0,...t};let r=e.geometry,n=e._roots,i=r.getIndex(),s;return t.cloneBuffers?s={roots:n.map(a=>a.slice()),index:i.array.slice()}:s={roots:n,index:i.array},s}static deserialize(e,t,r={}){if(typeof r=="boolean")return console.warn("MeshBVH.deserialize: The arguments for the function have changed. See documentation for new signature."),co.deserialize(arguments[0],arguments[1],{setIndex:arguments[2]===void 0?!0:arguments[2]});r={setIndex:!0,...r};let{index:n,roots:i}=e,s=new co(t,{...r,[Gv]:!0});if(s._roots=i,r.setIndex){let a=t.getIndex();if(a===null){let c=new Tt(e.index,1,!1);t.setIndex(c)}else a.array!==n&&(a.array.set(n),a.needsUpdate=!0)}return s}constructor(e,t={}){if(e.isBufferGeometry){if(e.index&&e.index.isInterleavedBufferAttribute)throw new Error("MeshBVH: InterleavedBufferAttribute is not supported for the index attribute.")}else throw new Error("MeshBVH: Only BufferGeometries are supported.");if(t=Object.assign({strategy:yU,maxDepth:40,maxLeafTris:10,verbose:!0,useSharedArrayBuffer:!1,setBoundingBox:!0,[Gv]:!1},t),t.useSharedArrayBuffer&&typeof SharedArrayBuffer=="undefined")throw new Error("MeshBVH: SharedArrayBuffer is not available.");this._roots=null,t[Gv]||(this._roots=Jne(e,t),!e.boundingBox&&t.setBoundingBox&&(e.boundingBox=this.getBoundingBox(new fn))),this.geometry=e}refit(e=null){e&&Array.isArray(e)&&(e=new Set(e));let t=this.geometry,r=t.index.array,n=t.attributes.position,i=n.array,s=n.offset||0,a=3;n.isInterleavedBufferAttribute&&(a=n.data.stride);let c,l,u,p,d=0,h=this._roots;for(let f=0,v=h.length;f<v;f++)c=h[f],l=new Uint32Array(c),u=new Uint16Array(c),p=new Float32Array(c),m(0,d),d+=c.byteLength;function m(f,v,g=!1){let _=f*2;if(u[_+15]===Wv){let b=l[f+6],x=u[_+14],A=1/0,E=1/0,S=1/0,w=-1/0,O=-1/0,C=-1/0;for(let N=3*b,R=3*(b+x);N<R;N++){let D=r[N]*a+s,V=i[D+0],F=i[D+1],j=i[D+2];V<A&&(A=V),V>w&&(w=V),F<E&&(E=F),F>O&&(O=F),j<S&&(S=j),j>C&&(C=j)}return p[f+0]!==A||p[f+1]!==E||p[f+2]!==S||p[f+3]!==w||p[f+4]!==O||p[f+5]!==C?(p[f+0]=A,p[f+1]=E,p[f+2]=S,p[f+3]=w,p[f+4]=O,p[f+5]=C,!0):!1}else{let b=f+8,x=l[f+6],A=b+v,E=x+v,S=g,w=!1,O=!1;e?S||(w=e.has(A),O=e.has(E),S=!w&&!O):(w=!0,O=!0);let C=S||w,N=S||O,R=!1;C&&(R=m(b,v,S));let D=!1;N&&(D=m(x,v,S));let V=R||D;if(V)for(let F=0;F<3;F++){let j=b+F,$=x+F,Y=p[j],H=p[j+3],B=p[$],te=p[$+3];p[f+F]=Y<B?Y:B,p[f+F+3]=H>te?H:te}return V}}}traverse(e,t=0){let r=this._roots[t],n=new Uint32Array(r),i=new Uint16Array(r);s(0);function s(a,c=0){let l=a*2,u=i[l+15]===Wv;if(u){let p=n[a+6],d=i[l+14];e(c,u,new Float32Array(r,a*4,6),p,d)}else{let p=a+T2/4,d=n[a+6],h=n[a+7];e(c,u,new Float32Array(r,a*4,6),h)||(s(p,c+1),s(d,c+1))}}}raycast(e,t=gr){let r=this._roots,n=this.geometry,i=[],s=t.isMaterial,a=Array.isArray(t),c=n.groups,l=s?t.side:t;for(let u=0,p=r.length;u<p;u++){let d=a?t[c[u].materialIndex].side:l,h=i.length;if(mm(r[u]),qv(0,n,d,e,i),x2(),a){let m=c[u].materialIndex;for(let f=h,v=i.length;f<v;f++)i[f].face.materialIndex=m}}return i}raycastFirst(e,t=gr){let r=this._roots,n=this.geometry,i=t.isMaterial,s=Array.isArray(t),a=null,c=n.groups,l=i?t.side:t;for(let u=0,p=r.length;u<p;u++){let d=s?t[c[u].materialIndex].side:l;mm(r[u]);let h=Xv(0,n,d,e);x2(),h!=null&&(a==null||h.distance<a.distance)&&(a=h,s&&(h.face.materialIndex=c[u].materialIndex))}return a}intersectsGeometry(e,t){let r=this.geometry,n=!1;for(let i of this._roots)if(mm(i),n=aie(0,r,e,t),x2(),n)break;return n}shapecast(e,t,r){let n=this.geometry;if(e instanceof Function){if(t){let d=t;t=(h,m,f,v)=>{let g=m*3;return d(h,g,g+1,g+2,f,v)}}e={boundsTraverseOrder:r,intersectsBounds:e,intersectsTriangle:t,intersectsRange:null},console.warn("MeshBVH: Shapecast function signature has changed and now takes an object of callbacks as a second argument. See docs for new signature.")}let i=Ys.getPrimitive(),{boundsTraverseOrder:s,intersectsBounds:a,intersectsRange:c,intersectsTriangle:l}=e;if(c&&l){let d=c;c=(h,m,f,v,g)=>d(h,m,f,v,g)?!0:pU(h,m,n,l,f,v,i)}else c||(l?c=(d,h,m,f)=>pU(d,h,n,l,m,f,i):c=(d,h,m)=>m);let u=!1,p=0;for(let d of this._roots){if(mm(d),u=sie(0,n,a,c,s,p),x2(),u)break;p+=d.byteLength}return Ys.releasePrimitive(i),u}bvhcast(e,t,r){let{intersectsRanges:n,intersectsTriangles:i}=r,s=e.geometry,a=s.index,c=s.attributes.position;_d.copy(t).invert();let l=Ys.getPrimitive(),u=Ys.getPrimitive();if(i){let d=function(h,m,f,v,g,_,T,b){for(let x=f,A=f+v;x<A;x++){$s(u,x*3,a,c),u.a.applyMatrix4(t),u.b.applyMatrix4(t),u.c.applyMatrix4(t),u.needsUpdate=!0;for(let E=h,S=h+m;E<S;E++)if($s(l,E*3,a,c),l.needsUpdate=!0,i(l,u,E,x,g,_,T,b))return!0}return!1};if(n){let h=n;n=function(m,f,v,g,_,T,b,x){return h(m,f,v,g,_,T,b,x)?!0:d(m,f,v,g,_,T,b,x)}}else n=d}this.getBoundingBox(Hv),Hv.applyMatrix4(t);let p=this.shapecast({intersectsBounds:d=>Hv.intersectsBox(d),intersectsRange:(d,h,m,f,v,g)=>(zv.copy(g),zv.applyMatrix4(_d),e.shapecast({intersectsBounds:_=>zv.intersectsBox(_),intersectsRange:(_,T,b,x,A)=>n(d,h,_,T,f,v,x,A)}))});return Ys.releasePrimitive(l),Ys.releasePrimitive(u),p}intersectsBox(e,t){return Ll.set(e.min,e.max,t),Ll.needsUpdate=!0,this.shapecast({intersectsBounds:r=>Ll.intersectsBox(r),intersectsTriangle:r=>Ll.intersectsTriangle(r)})}intersectsSphere(e){return this.shapecast({intersectsBounds:t=>e.intersectsBox(t),intersectsTriangle:t=>t.intersectsSphere(e)})}closestPointToGeometry(e,t,r={},n={},i=0,s=1/0){e.boundingBox||e.computeBoundingBox(),Ll.set(e.boundingBox.min,e.boundingBox.max,t),Ll.needsUpdate=!0;let a=this.geometry,c=a.attributes.position,l=a.index,u=e.attributes.position,p=e.index,d=Ys.getPrimitive(),h=Ys.getPrimitive(),m=b2,f=cie,v=null,g=null;n&&(v=lie,g=uie);let _=1/0,T=null,b=null;return _d.copy(t).invert(),dm.matrix.copy(_d),this.shapecast({boundsTraverseOrder:x=>Ll.distanceToBox(x,Math.min(_,s)),intersectsBounds:(x,A,E)=>E<_&&E<s?(A&&(dm.min.copy(x.min),dm.max.copy(x.max),dm.needsUpdate=!0),!0):!1,intersectsRange:(x,A)=>{if(e.boundsTree)return e.boundsTree.shapecast({boundsTraverseOrder:E=>dm.distanceToBox(E,Math.min(_,s)),intersectsBounds:(E,S,w)=>w<_&&w<s,intersectsRange:(E,S)=>{for(let w=E*3,O=(E+S)*3;w<O;w+=3){$s(h,w,p,u),h.a.applyMatrix4(t),h.b.applyMatrix4(t),h.c.applyMatrix4(t),h.needsUpdate=!0;for(let C=x*3,N=(x+A)*3;C<N;C+=3){$s(d,C,l,c),d.needsUpdate=!0;let R=d.distanceToTriangle(h,m,v);if(R<_&&(f.copy(m),g&&g.copy(v),_=R,T=C/3,b=w/3),R<i)return!0}}}});{let E=p?p.count:u.count;for(let S=0,w=E;S<w;S+=3){$s(h,S,p,u),h.a.applyMatrix4(t),h.b.applyMatrix4(t),h.c.applyMatrix4(t),h.needsUpdate=!0;for(let O=x*3,C=(x+A)*3;O<C;O+=3){$s(d,O,l,c),d.needsUpdate=!0;let N=d.distanceToTriangle(h,m,v);if(N<_&&(f.copy(m),g&&g.copy(v),_=N,T=O/3,b=S/3),N<i)return!0}}}}}),Ys.releasePrimitive(d),Ys.releasePrimitive(h),_===1/0?null:(r.point?r.point.copy(f):r.point=f.clone(),r.distance=_,r.faceIndex=T,n&&(n.point?n.point.copy(g):n.point=g.clone(),n.point.applyMatrix4(_d),f.applyMatrix4(_d),n.distance=f.sub(n.point).length(),n.faceIndex=b),r)}closestPointToPoint(e,t={},r=0,n=1/0){let i=r*r,s=n*n,a=1/0,c=null;if(this.shapecast({boundsTraverseOrder:u=>(hm.copy(e).clamp(u.min,u.max),hm.distanceToSquared(e)),intersectsBounds:(u,p,d)=>d<a&&d<s,intersectsTriangle:(u,p)=>{u.closestPointToPoint(e,hm);let d=e.distanceToSquared(hm);return d<a&&(b2.copy(hm),a=d,c=p),d<i}}),a===1/0)return null;let l=Math.sqrt(a);return t.point?t.point.copy(b2):t.point=b2.clone(),t.distance=l,t.faceIndex=c,t}getBoundingBox(e){return e.makeEmpty(),this._roots.forEach(r=>{Ks(0,new Float32Array(r),dU),e.union(dU)}),e}},hU=co.prototype.raycast;co.prototype.raycast=function(...o){if(o[0].isMesh){console.warn('MeshBVH: The function signature and results frame for "raycast" has changed. See docs for new signature.');let[e,t,r,n]=o;return hU.call(this,r,e.material).forEach(s=>{s=C2(s,e,t),s&&n.push(s)}),n}else return hU.apply(this,o)};var fU=co.prototype.raycastFirst;co.prototype.raycastFirst=function(...o){if(o[0].isMesh){console.warn('MeshBVH: The function signature and results frame for "raycastFirst" has changed. See docs for new signature.');let[e,t,r]=o;return C2(fU.call(this,r,e.material),e,t)}else return fU.apply(this,o)};var mU=co.prototype.closestPointToPoint;co.prototype.closestPointToPoint=function(...o){if(o[0].isMesh){console.warn('MeshBVH: The function signature and results frame for "closestPointToPoint" has changed. See docs for new signature.'),o.unshift();let e=o[1],t={};return o[1]=t,mU.apply(this,o),e&&e.copy(t.point),t.distance}else return mU.apply(this,o)};var _U=co.prototype.closestPointToGeometry;co.prototype.closestPointToGeometry=function(...o){let e=o[2],t=o[3];if(e&&e.isVector3||t&&t.isVector3){console.warn('MeshBVH: The function signature and results frame for "closestPointToGeometry" has changed. See docs for new signature.');let r={},n={},i=o[1];return o[2]=r,o[3]=n,_U.apply(this,o),e&&e.copy(r.point),t&&t.copy(n.point).applyMatrix4(i),r.distance}else return _U.apply(this,o)};var gU=co.prototype.refit;co.prototype.refit=function(...o){let e=o[0],t=o[1];if(t&&(t instanceof Set||Array.isArray(t))){console.warn('MeshBVH: The function signature for "refit" has changed. See docs for new signature.');let r=new Set;t.forEach(n=>r.add(n)),e&&e.forEach(n=>r.add(n)),gU.call(this,r)}else gU.apply(this,o)};["intersectsGeometry","shapecast","intersectsBox","intersectsSphere"].forEach(o=>{let e=co.prototype[o];co.prototype[o]=function(...t){return(t[0]===null||t[0].isMesh)&&(t.shift(),console.warn(`MeshBVH: The function signature for "${o}" has changed and no longer takes Mesh. See docs for new signature.`)),e.apply(this,t)}});var jv=new g1,vU=new Ue,pie=ct.prototype.raycast;function bU(o,e){if(this.geometry.boundsTree){if(this.material===void 0)return;vU.copy(this.matrixWorld).invert(),jv.copy(o.ray).applyMatrix4(vU);let t=this.geometry.boundsTree;if(o.firstHitOnly===!0){let r=C2(t.raycastFirst(jv,this.material),this,o);r&&e.push(r)}else{let r=t.raycast(jv,this.material);for(let n=0,i=r.length;n<i;n++){let s=C2(r[n],this,o);s&&e.push(s)}}}else pie.call(this,o,e)}var Dl=class extends Ke{static type(){return"BVH"}cook(e,t){let r=[];for(let i of e)if(i){let s=i.objects();for(let a of s)a.traverse(c=>{let l=c;if(l.isMesh){if(t.keepOnlyPosition){let u=l.geometry;for(let p in u.attributes)p!=="position"&&u.deleteAttribute(p)}r.push(l)}})}let n=this._makeCompact(r);if(n){n.matrixAutoUpdate=!1,n.raycast=bU;let i=new co(n.geometry,{verbose:!1});return n.geometry.boundsTree=i,this.createCoreGroupFromObjects([n])}else return this.createCoreGroupFromObjects([])}_makeCompact(e){var t,r;let n=[],i;for(let s of e){i=i||s.material;let a=s.geometry;a.applyMatrix4(s.matrix),n.push(a)}try{let s=At.mergeGeometries(n);if(s)return this.createObject(s,jt.MESH,i);(t=this.states)==null||t.error.set("merge failed, check that input geometries have the same attributes")}catch(s){(r=this.states)==null||r.error.set(s.message)}}};Dl.DEFAULT_PARAMS={keepOnlyPosition:!1};Dl.INPUT_CLONED_STATE=ke.ALWAYS;var die=Dl.DEFAULT_PARAMS,TU=class extends U{constructor(){super(...arguments);this.keepOnlyPosition=y.BOOLEAN(die.keepOnlyPosition)}},hie=new TU,Jv=class extends Ye{constructor(){super(...arguments);this.paramsConfig=hie}static type(){return"BVH"}static displayedInputNames(){return["geometry to create BVH from"]}initializeNode(){this.io.inputs.setCount(1),this.io.inputs.initInputsClonedState(Dl.INPUT_CLONED_STATE)}cook(e){this._operation=this._operation||new Dl(this._scene,this.states);let t=this._operation.cook(e,this.pv);this.setCoreGroup(t)}};var AU=class extends fr{static context(){return oe.SOP}cook(){this.cookController.endCook()}},U0=class extends AU{};var Zv=class extends U0{constructor(){super(...arguments);this._childrenControllerContext=oe.ANIM}static type(){return uo.ANIM}createNode(e,t){return super.createNode(e,t)}children(){return super.children()}nodesByType(e){return super.nodesByType(e)}};var CU=class extends Ke{static type(){return"attribCreate"}cook(o,e){var t;let r=o[0],n=e.name;return n&&n.trim()!=""?this._addAttribute(Do[e.class],r,e):(t=this.states)==null||t.error.set("attribute name is not valid"),r}_addAttribute(o,e,t){let r=Et[t.type];switch(o){case xr.VERTEX:this._addPointAttribute(r,e,t);return;case xr.OBJECT:this._addObjectAttribute(r,e,t);return}Be.unreachable(o)}_addPointAttribute(o,e,t){let r=e.coreObjects();switch(o){case Ge.NUMERIC:{for(let n of r)this._addNumericAttributeToPoints(n,t);return}case Ge.STRING:{for(let n of r)this._addStringAttributeToPoints(n,t);return}}Be.unreachable(o)}_addObjectAttribute(o,e,t){let r=e.coreObjectsFromGroup(t.group),n=t.name,i=e.coreObjects(),s=CU.defaultAttribValue(t);if(s!=null)for(let a of i)a.hasAttrib(n)||a.setAttribValue(n,s);switch(o){case Ge.NUMERIC:this._addNumericAttributeToObjects(r,t);return;case Ge.STRING:this._addStringAttributeToObjects(r,t);return}Be.unreachable(o)}_addNumericAttributeToPoints(o,e){let t=o.coreGeometry();if(!t)return;let r=[e.value1,e.value2,e.value3,e.value4][e.size-1],n=Ot.remapName(e.name);if(t.hasAttrib(n)?t.markAttribAsNeedsUpdate(n):t.addNumericAttrib(n,e.size,0),e.group){let i=o.pointsFromGroup(e.group);for(let s of i)s.setAttribValue(n,r)}else o.addNumericVertexAttrib(n,e.size,r)}_addNumericAttributeToObjects(o,e){let t=[e.value1,e.value2,e.value3,e.value4][e.size-1],r=e.name;for(let n of o)n.setAttribValue(r,t)}_addStringAttributeToPoints(o,e){let t=o.coreGeometry();if(!t)return;let r=o.pointsFromGroup(e.group),n=e.name,i=e.string,s=new Array(r.length);if(this._hasGroup(e)){let c=o.points();if(s=s.length!=c.length?new Array(c.length):s,!t.hasAttrib(n)){let l=Ot.arrayToIndexedArrays([""]);t.setIndexedAttribute(n,l.values,l.indices)}for(let l of c){let u=l.stringAttribValue(n);u==null&&(u=""),s[l.index()]=u}}for(let c of r)s[c.index()]=i;let a=Ot.arrayToIndexedArrays(s);t.setIndexedAttribute(n,a.values,a.indices)}_addStringAttributeToObjects(o,e){let t=e.string;for(let r of o)r.setAttribValue(e.name,t)}_hasGroup(o){return o.group.trim()!=""}static _attribType(o){return Et[o.type]}static defaultAttribValue(o){let e=this._attribType(o);switch(e){case Ge.NUMERIC:return this._defaultNumericValue(o);case Ge.STRING:return this._defaultStringValue()}Be.unreachable(e)}static _defaultStringValue(){return""}static _defaultNumericValue(o){switch(o.size){case 1:return 0;case 2:return new z(0,0);case 3:return new M(0,0,0);case 4:return new De(0,0,0,0)}}},kl=CU;kl.DEFAULT_PARAMS={group:"",class:Do.indexOf(xr.VERTEX),type:Et.indexOf(Ge.NUMERIC),name:"new_attrib",size:1,value1:0,value2:new z(0,0),value3:new M(0,0,0),value4:new De(0,0,0,0),string:""};kl.INPUT_CLONED_STATE=ke.FROM_NODE;var fie=["x","y","z","w"],Zs=kl.DEFAULT_PARAMS,EU=class extends U{constructor(){super(...arguments);this.group=y.STRING(Zs.group),this.class=y.INTEGER(Zs.class,{menu:{entries:Fu}}),this.type=y.INTEGER(Zs.type,{menu:{entries:na}}),this.name=y.STRING(Zs.name),this.size=y.INTEGER(Zs.size,{range:[1,4],rangeLocked:[!0,!0],visibleIf:{type:Ge.NUMERIC}}),this.value1=y.FLOAT(Zs.value1,{visibleIf:{type:Ge.NUMERIC,size:1},expression:{forEntities:!0}}),this.value2=y.VECTOR2(Zs.value2,{visibleIf:{type:Ge.NUMERIC,size:2},expression:{forEntities:!0}}),this.value3=y.VECTOR3(Zs.value3,{visibleIf:{type:Ge.NUMERIC,size:3},expression:{forEntities:!0}}),this.value4=y.VECTOR4(Zs.value4,{visibleIf:{type:Ge.NUMERIC,size:4},expression:{forEntities:!0}}),this.string=y.STRING(Zs.string,{visibleIf:{type:Ge.STRING},expression:{forEntities:!0}})}},mie=new EU,Qv=class extends Ye{constructor(){super(...arguments);this.paramsConfig=mie,this._arraysByGeoUuid={X:new Map,Y:new Map,Z:new Map,W:new Map}}static type(){return"attribCreate"}initializeNode(){this.io.inputs.setCount(1),this.io.inputs.initInputsClonedState(kl.INPUT_CLONED_STATE)}cook(e){let t=this.pv.name;if(this._isUsingExpression())t&&t.trim()!=""?this._addAttribute(Do[this.pv.class],e[0]):this.states.error.set("attribute name is not valid");else{this._operation=this._operation||new kl(this.scene(),this.states);let r=this._operation.cook(e,this.pv);this.setCoreGroup(r)}}async _addAttribute(e,t){let r=Et[this.pv.type];switch(e){case xr.VERTEX:return await this._addPointAttribute(r,t),this.setCoreGroup(t);case xr.OBJECT:return await this._addObjectAttribute(r,t),this.setCoreGroup(t)}Be.unreachable(e)}async _addPointAttribute(e,t){let r=t.coreObjects();switch(e){case Ge.NUMERIC:{for(let n=0;n<r.length;n++)await this._addNumericAttributeToPoints(r[n]);return}case Ge.STRING:{for(let n=0;n<r.length;n++)await this._addStringAttributeToPoints(r[n]);return}}Be.unreachable(e)}async _addObjectAttribute(e,t){let r=t.coreObjectsFromGroup(this.pv.group),n=this.pv.name,i=t.coreObjects(),s=kl.defaultAttribValue(this.pv);if(s!=null)for(let a of i)a.hasAttrib(n)||a.setAttribValue(n,s);switch(e){case Ge.NUMERIC:await this._addNumericAttributeToObject(r);return;case Ge.STRING:await this._addStringAttributeToObject(r);return}Be.unreachable(e)}async _addNumericAttributeToPoints(e){let t=e.coreGeometry();if(!t)return;let r=e.pointsFromGroup(this.pv.group),n=Ot.remapName(this.pv.name),i=[this.p.value1,this.p.value2,this.p.value3,this.p.value4][this.pv.size-1];if(i.hasExpression()){t.hasAttrib(n)||t.addNumericAttrib(n,this.pv.size,i.value);let s=t.geometry(),a=s.getAttribute(n);a.needsUpdate=!0;let c=a.array;if(this.pv.size==1)this.p.value1.expressionController&&await this.p.value1.expressionController.computeExpressionForPoints(r,(l,u)=>{c[l.index()*this.pv.size+0]=u});else{let u=[this.p.value2,this.p.value3,this.p.value4][this.pv.size-2].components,p=new Array(u.length),d=[this._arraysByGeoUuid.X,this._arraysByGeoUuid.Y,this._arraysByGeoUuid.Z,this._arraysByGeoUuid.W];for(let h=0;h<u.length;h++){let m=u[h];if(m.hasExpression()&&m.expressionController)p[h]=this._initArrayIfRequired(s,d[h],r.length),await m.expressionController.computeExpressionForPoints(r,(f,v)=>{p[h][f.index()]=v});else{let f=m.value;for(let v of r)c[v.index()*this.pv.size+h]=f}}for(let h=0;h<p.length;h++){let m=p[h];if(m!=null)for(let f=0;f<m.length;f++){let v=m[f];v!=null&&(c[f*this.pv.size+h]=v)}}}}}async _addNumericAttributeToObject(e){let t=[this.p.value1,this.p.value2,this.p.value3,this.p.value4][this.pv.size-1],r=this.pv.name;if(t.hasExpression())if(this.pv.size==1)this.p.value1.expressionController&&await this.p.value1.expressionController.computeExpressionForObjects(e,(n,i)=>{n.setAttribValue(r,i)});else{let i=[this.p.value2,this.p.value3,this.p.value4][this.pv.size-2].components,s=new Map,a=this._vectorByAttribSize(this.pv.size);if(a){for(let c of e)s.set(c.index(),a.clone());for(let c=0;c<i.length;c++){let l=i[c],u=fie[c];if(l.hasExpression()&&l.expressionController)await l.expressionController.computeExpressionForObjects(e,(p,d)=>{let h=s.get(p.index());h[u]=d});else for(let p of e){let d=s.get(p.index());d[u]=l.value}}for(let c=0;c<e.length;c++){let l=e[c],u=s.get(l.index());u!=null&&l.setAttribValue(r,u)}}}}async _addStringAttributeToPoints(e){let t=e.coreGeometry();if(!t)return;let r=e.pointsFromGroup(this.pv.group),n=this.p.string,i=this.pv.name,s=new Array(r.length);if(n.hasExpression()&&n.expressionController){if(this._hasGroup()){if(!t.hasAttrib(i)){let u=Ot.arrayToIndexedArrays([""]);t.setIndexedAttribute(i,u.values,u.indices)}let l=e.points();s=s.length!=l.length?new Array(l.length):s;for(let u of l){let p=u.stringAttribValue(i);p==null&&(p=""),s[u.index()]=p}}await n.expressionController.computeExpressionForPoints(r,(l,u)=>{s[l.index()]=u})}let a=Ot.arrayToIndexedArrays(s),c=e.coreGeometry();c&&c.setIndexedAttribute(i,a.values,a.indices)}async _addStringAttributeToObject(e){let t=this.p.string,r=this.pv.name;t.hasExpression()&&t.expressionController&&await t.expressionController.computeExpressionForObjects(e,(n,i)=>{n.setAttribValue(r,i)})}_initArrayIfRequired(e,t,r){let n=e.uuid,i=t.get(n);return i?i.length<r&&t.set(n,new Array(r)):t.set(n,new Array(r)),t.get(n)}_isUsingExpression(){switch(Et[this.pv.type]){case Ge.NUMERIC:return[this.p.value1,this.p.value2,this.p.value3,this.p.value4][this.pv.size-1].hasExpression();case Ge.STRING:return this.p.string.hasExpression()}}setAttribClass(e){this.p.class.set(Do.indexOf(e))}attribClass(){return Do[this.pv.class]}setAttribType(e){this.p.type.set(Et.indexOf(e))}attribType(){return Et[this.pv.type]}_hasGroup(){return this.pv.group.trim()!=""}_vectorByAttribSize(e){switch(e){case 2:return new z(0,0);case 3:return new M(0,0,0);case 4:return new De(0,0,0,0)}}};var SU=class extends U{constructor(){super(...arguments);this.class=y.INTEGER(xr.VERTEX,{menu:{entries:Fu}}),this.name=y.STRING("")}},_ie=new SU,ey=class extends Ye{constructor(){super(...arguments);this.paramsConfig=_ie}static type(){return"attribDelete"}static displayedInputNames(){return["geometry to delete attributes from"]}initializeNode(){this.io.inputs.setCount(1),this.io.inputs.initInputsClonedState(ke.FROM_NODE)}cook(e){let t=e[0],r=t.attribNamesMatchingMask(this.pv.name);for(let n of r)switch(this.pv.class){case xr.VERTEX:this.delete_vertex_attribute(t,n);case xr.OBJECT:this.delete_object_attribute(t,n)}this.setCoreGroup(t)}delete_vertex_attribute(e,t){for(let r of e.objects())r.traverse(n=>{let i=n;i.geometry&&new At(i.geometry).deleteAttribute(t)})}delete_object_attribute(e,t){for(let r of e.objects()){let n=0;r.traverse(i=>{let s=i;new br(s,n).deleteAttribute(t),n++})}}};var Bl=class extends Ke{constructor(){super(...arguments);this._core_transform=new Yt}static type(){return"box"}cook(e,t){let r=e[0],n=r?this._cookWithInput(r,t):this._cookWithoutInput(t);return this.createCoreGroupFromGeometry(n)}_cookWithoutInput(e){let t=e.divisions,r=e.size,n=new Nn(r,r,r,t,t,t);return n.translate(e.center.x,e.center.y,e.center.z),n.computeVertexNormals(),n}_cookWithInput(e,t){let r=t.divisions,n=e.boundingBox(),i=n.max.clone().sub(n.min),s=n.max.clone().add(n.min).multiplyScalar(.5),a=new Nn(i.x,i.y,i.z,r,r,r),c=this._core_transform.translationMatrix(s);return a.applyMatrix4(c),a}};Bl.DEFAULT_PARAMS={size:1,divisions:1,center:new M(0,0,0)};Bl.INPUT_CLONED_STATE=ke.NEVER;var ty=Bl.DEFAULT_PARAMS,wU=class extends U{constructor(){super(...arguments);this.size=y.FLOAT(ty.size),this.divisions=y.INTEGER(ty.divisions,{range:[1,10],rangeLocked:[!0,!1]}),this.center=y.VECTOR3(ty.center)}},gie=new wU,ry=class extends Ye{constructor(){super(...arguments);this.paramsConfig=gie}static type(){return"box"}static displayedInputNames(){return["geometry to create bounding box from (optional)"]}initializeNode(){this.io.inputs.setCount(0,1),this.io.inputs.initInputsClonedState(Bl.INPUT_CLONED_STATE)}cook(e){this._operation=this._operation||new Bl(this._scene,this.states);let t=this._operation.cook(e,this.pv);this.setCoreGroup(t)}};var oy=class{static positions(e){let{radius:t,segments:r}=e,n=r,i=e.arcAngle||360,s=Mr.degrees_to_radians(i)/n,a=[];for(let c=0;c<n;c++){let l=s*c,u=t*Math.cos(l),p=t*Math.sin(l);a.push(new z(u,p))}return a}static create(e){let{segments:t}=e,r=t,n=this.positions(e),i=[],s=[],a;for(let l=0;l<n.length;l++)a=n[l],i.push(a.x),i.push(a.y),i.push(0),l>0&&(s.push(l-1),s.push(l));e.connectLastPoint&&(s.push(r-1),s.push(0));let c=new Re;return c.setAttribute("position",new Ce(i,3)),c.setIndex(s),c}};var xd=class extends Re{constructor(e=1,t=8,r=0,n=Math.PI*2){super();this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:r,thetaLength:n},t=Math.max(3,t);let i=[],s=[],a=[],c=[],l=new M,u=new z;s.push(0,0,0),a.push(0,0,1),c.push(.5,.5);for(let p=0,d=3;p<=t;p++,d+=3){let h=r+p/t*n;l.x=e*Math.cos(h),l.y=e*Math.sin(h),s.push(l.x,l.y,l.z),a.push(0,0,1),u.x=(s[d]/e+1)/2,u.y=(s[d+1]/e+1)/2,c.push(u.x,u.y)}for(let p=1;p<=t;p++)i.push(p,p+1,0);this.setIndex(i),this.setAttribute("position",new Ce(s,3)),this.setAttribute("normal",new Ce(a,3)),this.setAttribute("uv",new Ce(c,2))}static fromJSON(e){return new xd(e.radius,e.segments,e.thetaStart,e.thetaLength)}};var vie=new M(0,0,1),ym=class extends Ke{constructor(){super(...arguments);this._core_transform=new Yt}static type(){return"circle"}cook(e,t){return t.open?this._createCircle(t):this._createDisk(t)}_createCircle(e){let t=oy.create(e);return this._setCenterAndDirection(t,e),this.createCoreGroupFromGeometry(t,jt.LINE_SEGMENTS)}_createDisk(e){let t=new xd(e.radius,e.segments);return this._setCenterAndDirection(t,e),this.createCoreGroupFromGeometry(t)}_setCenterAndDirection(e,t){this._core_transform.rotateGeometry(e,vie,t.direction),e.translate(t.center.x,t.center.y,t.center.z)}};ym.DEFAULT_PARAMS={radius:1,segments:12,open:!0,arcAngle:360,direction:new M(0,1,0),center:new M(0,0,0),connectLastPoint:!0};var Fl=ym.DEFAULT_PARAMS,MU=class extends U{constructor(){super(...arguments);this.radius=y.FLOAT(Fl.radius),this.segments=y.INTEGER(Fl.segments,{range:[1,50],rangeLocked:[!0,!1]}),this.open=y.BOOLEAN(Fl.open),this.connectLastPoint=y.BOOLEAN(Fl.connectLastPoint,{visibleIf:{open:1}}),this.arcAngle=y.FLOAT(Fl.arcAngle,{range:[0,360],rangeLocked:[!1,!1],visibleIf:{open:1}}),this.direction=y.VECTOR3(Fl.direction),this.center=y.VECTOR3(Fl.center)}},yie=new MU,ny=class extends Ye{constructor(){super(...arguments);this.paramsConfig=yie}static type(){return"circle"}initializeNode(){}cook(){this._operation=this._operation||new ym(this._scene,this.states);let e=this._operation.cook([],this.pv);this.setCoreGroup(e)}};var iy=class extends U0{constructor(){super(...arguments);this._childrenControllerContext=oe.COP}static type(){return uo.COP}createNode(e,t){return super.createNode(e,t)}children(){return super.children()}nodesByType(e){return super.nodesByType(e)}};var sy=class{constructor(e){this.node=e,this.selected_state=new Map,this._entities_count=0,this._selected_entities_count=0}init(e){this.selected_state.clear();for(let t of e)this.selected_state.set(t,!1);this._entities_count=e.length,this._selected_entities_count=0}select(e){let t=this.selected_state.get(e);t!=null&&t==!1&&(this.selected_state.set(e,!0),this._selected_entities_count++)}entities_to_keep(){return this._entities_for_state(this.node.pv.invert)}entities_to_delete(){return this._entities_for_state(!this.node.pv.invert)}_entities_for_state(e){let t=!!e,r=e?this._selected_entities_count:this._entities_count-this._selected_entities_count;if(r==0)return[];{let n=new Array(r),i=0;return this.selected_state.forEach((s,a)=>{s==t&&(n[i]=a,i++)}),n}}};var ay=(o=>(o.EQUAL="==",o.LESS_THAN="<",o.EQUAL_OR_LESS_THAN="<=",o.EQUAL_OR_GREATER_THAN=">=",o.GREATER_THAN=">",o.DIFFERENT="!=",o))(ay||{}),w2=["==","<","<=",">=",">","!="],xie={["=="]:(o,e)=>o==e,["<"]:(o,e)=>o<e,["<="]:(o,e)=>o<=e,[">="]:(o,e)=>o>=e,[">"]:(o,e)=>o>e,["!="]:(o,e)=>o!=e},NU=w2.map((o,e)=>({name:o,value:e})),cy=class{constructor(e){this.node=e}evalForEntities(e){let t=Et[this.node.pv.attribType];switch(t){case Ge.NUMERIC:{this._eval_for_numeric(e);return}case Ge.STRING:{this._eval_for_string(e);return}}Be.unreachable(t)}_eval_for_string(e){let t;for(let r of e)t=r.stringAttribValue(this.node.pv.attribName),t==this.node.pv.attribString&&this.node.entitySelectionHelper.select(r)}_eval_for_numeric(e){let t=lN[this.node.pv.attribSize-1];switch(t){case Ln.FLOAT:return this._eval_for_points_numeric_float(e);case Ln.VECTOR2:return this._eval_for_points_numeric_vector2(e);case Ln.VECTOR3:return this._eval_for_points_numeric_vector3(e);case Ln.VECTOR4:return this._eval_for_points_numeric_vector4(e)}Be.unreachable(t)}_eval_for_points_numeric_float(e){let t=this.node.pv.attribName,r=this.node.pv.attribValue1,n,i=w2[this.node.pv.attribComparisonOperator],s=xie[i];for(let a of e)n=a.attribValue(t),s(n,r)&&this.node.entitySelectionHelper.select(a)}_eval_for_points_numeric_vector2(e){let t=this.node.pv.attribName,r=this.node.pv.attribValue2,n=new z;for(let i of e){let s=i.attribValue(t,n);r.equals(s)&&this.node.entitySelectionHelper.select(i)}}_eval_for_points_numeric_vector3(e){let t=this.node.pv.attribName,r=this.node.pv.attribValue3,n=new M;for(let i of e){let s=i.attribValue(t,n);r.equals(s)&&this.node.entitySelectionHelper.select(i)}}_eval_for_points_numeric_vector4(e){let t=this.node.pv.attribName,r=this.node.pv.attribValue4,n=new De;for(let i of e){let s=i.attribValue(t,n);r.equals(s)&&this.node.entitySelectionHelper.select(i)}}};var ly=class{constructor(e){this.node=e}async evalForEntities(e){let t=this.node.p.expression;this.node.p.expression.hasExpression()&&t.expressionController?await this.eval_expressions_for_points_with_expression(e):this.eval_expressions_without_expression(e)}async eval_expressions_for_points_with_expression(e){let t=this.node.p.expression;t.expressionController&&await t.expressionController.computeExpressionForEntities(e,(r,n)=>{n&&this.node.entitySelectionHelper.select(r)})}eval_expressions_without_expression(e){if(this.node.pv.expression)for(let r of e)this.node.entitySelectionHelper.select(r)}};var uy=class{constructor(e){this.node=e,this._point_position=new M}evalForPoints(e){let t=this._createBbox();for(let r of e)t.containsPoint(r.getPosition(this._point_position))&&this.node.entitySelectionHelper.select(r)}_createBbox(){return new fn(this.node.pv.bboxCenter.clone().sub(this.node.pv.bboxSize.clone().multiplyScalar(.5)),this.node.pv.bboxCenter.clone().add(this.node.pv.bboxSize.clone().multiplyScalar(.5)))}};var py=class{constructor(e){this.node=e}eval_for_objects(e){let t=oa[this.node.pv.objectType];for(let r of e){let n=r.object();si(n.constructor)==t&&this.node.entitySelectionHelper.select(r)}}};var dy=class{constructor(){this._sidePropertyByMaterial=new WeakMap,this._bound_setMat=this._setObjectMaterialDoubleSided.bind(this),this._bound_restoreMat=this._restoreObjectMaterialSide.bind(this)}setCoreGroupMaterialDoubleSided(e){let t=e.objects();for(let r of t)r.traverse(this._bound_setMat)}restoreMaterialSideProperty(e){let t=e.objects();for(let r of t)r.traverse(this._bound_restoreMat)}_setObjectMaterialDoubleSided(e){let t=e.material;if(t)if(K.isArray(t))for(let r of t)this._setMaterialDoubleSided(r);else this._setMaterialDoubleSided(t)}_restoreObjectMaterialSide(e){let t=e.material;if(t)if(K.isArray(t))for(let r of t)this._restoreMaterialDoubleSided(r);else this._restoreMaterialDoubleSided(t)}_setMaterialDoubleSided(e){this._sidePropertyByMaterial.set(e,e.side),e.side=Wr}_restoreMaterialDoubleSided(e){e.side=this._sidePropertyByMaterial.get(e)||Wr}};var bie=new M(0,1,0),Tie=new M(0,-1,0),hy=class{constructor(e){this.node=e,this._matDoubleSideTmpSetter=new dy,this._point_position=new M,this._raycaster=new Bf,this._intersections=[]}evalForPoints(e,t){if(!t)return;let r=t==null?void 0:t.objectsWithGeo()[0];if(!r)return;let n=r;if(!n.isMesh)return;this._matDoubleSideTmpSetter.setCoreGroupMaterialDoubleSided(t);let i=r.geometry;i.computeBoundingBox();let s=i.boundingBox;for(let a of e)a.getPosition(this._point_position),s.containsPoint(this._point_position)&&this._isPositionInObject(this._point_position,n,bie)&&this._isPositionInObject(this._point_position,n,Tie)&&this.node.entitySelectionHelper.select(a);this._matDoubleSideTmpSetter.restoreMaterialSideProperty(t)}_isPositionInObject(e,t,r){var n;this._raycaster.ray.direction.copy(r),this._raycaster.ray.origin.copy(e),this._intersections.length=0;let i=this._raycaster.intersectObject(t,!1,this._intersections);if(!i||i.length==0)return!1;let a=(n=i[0].face)==null?void 0:n.normal;return a?this._raycaster.ray.direction.dot(a)>=0:!1}};var OU=class extends U{constructor(){super(...arguments);this.class=y.INTEGER(Do.indexOf(xr.VERTEX),{menu:{entries:Fu}}),this.invert=y.BOOLEAN(0),this.byObjectType=y.BOOLEAN(0,{visibleIf:{class:Do.indexOf(xr.OBJECT)}}),this.objectType=y.INTEGER(oa.indexOf(jt.MESH),{menu:{entries:cN},visibleIf:{class:Do.indexOf(xr.OBJECT),byObjectType:!0},separatorAfter:!0}),this.byExpression=y.BOOLEAN(0),this.expression=y.BOOLEAN("@ptnum==0",{visibleIf:{byExpression:!0},expression:{forEntities:!0},separatorAfter:!0}),this.byAttrib=y.BOOLEAN(0),this.attribType=y.INTEGER(Et.indexOf(Ge.NUMERIC),{menu:{entries:na},visibleIf:{byAttrib:1}}),this.attribName=y.STRING("",{visibleIf:{byAttrib:1}}),this.attribSize=y.INTEGER(1,{range:uN,rangeLocked:[!0,!0],visibleIf:{byAttrib:1,attribType:Et.indexOf(Ge.NUMERIC)}}),this.attribComparisonOperator=y.INTEGER(w2.indexOf(ay.EQUAL),{menu:{entries:NU},visibleIf:{byAttrib:!0,attribType:Et.indexOf(Ge.NUMERIC),attribSize:Ln.FLOAT}}),this.attribValue1=y.FLOAT(0,{visibleIf:{byAttrib:1,attribType:Et.indexOf(Ge.NUMERIC),attribSize:1}}),this.attribValue2=y.VECTOR2([0,0],{visibleIf:{byAttrib:1,attribType:Et.indexOf(Ge.NUMERIC),attribSize:2}}),this.attribValue3=y.VECTOR3([0,0,0],{visibleIf:{byAttrib:1,attribType:Et.indexOf(Ge.NUMERIC),attribSize:3}}),this.attribValue4=y.VECTOR4([0,0,0,0],{visibleIf:{byAttrib:1,attribType:Et.indexOf(Ge.NUMERIC),attribSize:4}}),this.attribString=y.STRING("",{visibleIf:{byAttrib:1,attribType:Et.indexOf(Ge.STRING)},separatorAfter:!0}),this.byBbox=y.BOOLEAN(0,{visibleIf:{class:Do.indexOf(xr.VERTEX)}}),this.bboxSize=y.VECTOR3([1,1,1],{visibleIf:{class:Do.indexOf(xr.VERTEX),byBbox:!0}}),this.bboxCenter=y.VECTOR3([0,0,0],{visibleIf:{class:Do.indexOf(xr.VERTEX),byBbox:!0},separatorAfter:!0}),this.byBoundingObject=y.BOOLEAN(0,{visibleIf:{class:Do.indexOf(xr.VERTEX)}}),this.keepPoints=y.BOOLEAN(0,{visibleIf:{class:Do.indexOf(xr.OBJECT)}})}},Aie=new OU,fy=class extends Ye{constructor(){super(...arguments);this.paramsConfig=Aie,this._marked_for_deletion_per_object_index=new Map,this.entitySelectionHelper=new sy(this),this.byExpressionHelper=new ly(this),this.byAttributeHelper=new cy(this),this.byObjectTypeHelper=new py(this),this.byBboxHelper=new uy(this),this.byBoundingObjectHelper=new hy(this)}static type(){return"delete"}static displayedInputNames(){return["geometry to delete from","points inside this geometry will be deleted (optional)"]}initializeNode(){this.io.inputs.setCount(1,2),this.io.inputs.initInputsClonedState(ke.FROM_NODE)}async cook(e){let t=e[0],r=e[1];switch(this.pv.class){case xr.VERTEX:await this._eval_for_points(t,r);break;case xr.OBJECT:await this._eval_for_objects(t);break}}setAttribClass(e){this.p.class.set(e)}async _eval_for_objects(e){let t=e.coreObjects();this.entitySelectionHelper.init(t),this._marked_for_deletion_per_object_index=new Map;for(let i of t)this._marked_for_deletion_per_object_index.set(i.index(),!1);this.pv.byExpression&&await this.byExpressionHelper.evalForEntities(t),this.pv.byObjectType&&this.byObjectTypeHelper.eval_for_objects(t),this.pv.byAttrib&&this.pv.attribName!=""&&this.byAttributeHelper.evalForEntities(t);let n=this.entitySelectionHelper.entities_to_keep().map(i=>i.object());if(this.pv.keepPoints){let i=this.entitySelectionHelper.entities_to_delete();for(let s of i){let a=this._point_object(s);a&&n.push(a)}}this.setObjects(n)}async _eval_for_points(e,t){let r=e.coreObjects(),n,i=[];for(let s=0;s<r.length;s++){n=r[s];let a=n.coreGeometry();if(a){let c=n.object(),l=a.pointsFromGeometry();this.entitySelectionHelper.init(l);let u=l.length;this.pv.byExpression&&await this.byExpressionHelper.evalForEntities(l),this.pv.byAttrib&&this.pv.attribName!=""&&this.byAttributeHelper.evalForEntities(l),this.pv.byBbox&&this.byBboxHelper.evalForPoints(l),this.pv.byBoundingObject&&this.byBoundingObjectHelper.evalForPoints(l,t);let p=this.entitySelectionHelper.entities_to_keep();if(p.length==u)i.push(c);else if(a.geometry().dispose(),p.length>0){let d=At.geometryFromPoints(p,si(c.constructor));d&&(c.geometry=d,i.push(c))}}}this.setObjects(i)}_point_object(e){let t=e.points(),r=At.geometryFromPoints(t,jt.POINTS);if(r)return this.createObject(r,jt.POINTS)}};var my=class extends U0{constructor(){super(...arguments);this._childrenControllerContext=oe.EVENT}static type(){return uo.EVENT}createNode(e,t){return super.createNode(e,t)}children(){return super.children()}nodesByType(e){return super.nodesByType(e)}};var PU=new Ue,RU=new Ue,M2=[],xm=new ct,N2=class extends ct{constructor(e,t,r){super(e,t);this.instanceMatrix=new Kr(new Float32Array(r*16),16),this.instanceColor=null,this.count=r,this.frustumCulled=!1}copy(e){return super.copy(e),this.instanceMatrix.copy(e.instanceMatrix),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,this}getColorAt(e,t){t.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,e*16)}raycast(e,t){let r=this.matrixWorld,n=this.count;if(xm.geometry=this.geometry,xm.material=this.material,xm.material!==void 0)for(let i=0;i<n;i++){this.getMatrixAt(i,PU),RU.multiplyMatrices(r,PU),xm.matrixWorld=RU,xm.raycast(e,M2);for(let s=0,a=M2.length;s<a;s++){let c=M2[s];c.instanceId=i,c.object=this,t.push(c)}M2.length=0}}setColorAt(e,t){this.instanceColor===null&&(this.instanceColor=new Kr(new Float32Array(this.instanceMatrix.count*3),3)),t.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,e*16)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}};N2.prototype.isInstancedMesh=!0;var bd,bm=new M,Td=new M,Ad=new M,Cd=new z,Tm=new z,DU=new Ue,O2=new M,Am=new M,P2=new M,IU=new z,_y=new z,LU=new z,I2=class extends vt{constructor(e){super();if(this.type="Sprite",bd===void 0){bd=new Re;let t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),r=new h0(t,5);bd.setIndex([0,1,2,0,2,3]),bd.setAttribute("position",new Dn(r,3,0,!1)),bd.setAttribute("uv",new Dn(r,2,3,!1))}this.geometry=bd,this.material=e!==void 0?e:new ad,this.center=new z(.5,.5)}raycast(e,t){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Td.setFromMatrixScale(this.matrixWorld),DU.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),Ad.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&Td.multiplyScalar(-Ad.z);let r=this.material.rotation,n,i;r!==0&&(i=Math.cos(r),n=Math.sin(r));let s=this.center;R2(O2.set(-.5,-.5,0),Ad,s,Td,n,i),R2(Am.set(.5,-.5,0),Ad,s,Td,n,i),R2(P2.set(.5,.5,0),Ad,s,Td,n,i),IU.set(0,0),_y.set(1,0),LU.set(1,1);let a=e.ray.intersectTriangle(O2,Am,P2,!1,bm);if(a===null&&(R2(Am.set(-.5,.5,0),Ad,s,Td,n,i),_y.set(0,1),a=e.ray.intersectTriangle(O2,P2,Am,!1,bm),a===null))return;let c=e.ray.origin.distanceTo(bm);c<e.near||c>e.far||t.push({distance:c,point:bm.clone(),uv:mn.getUV(bm,O2,Am,P2,IU,_y,LU,new z),face:null,object:this})}copy(e){return super.copy(e),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}};I2.prototype.isSprite=!0;function R2(o,e,t,r,n,i){Cd.subVectors(o,t).addScalar(.5).multiply(r),n!==void 0?(Tm.x=i*Cd.x-n*Cd.y,Tm.y=n*Cd.x+i*Cd.y):Tm.copy(Cd),o.copy(e),o.x+=Tm.x,o.y+=Tm.y,o.applyMatrix4(DU)}var Ed=class extends bs{constructor(e,t){super(e,t);this.type="LineLoop"}};Ed.prototype.isLineLoop=!0;var kU=new Ue,Cie=new Ue,Ul=class{constructor(e=[],t=[]){this.uuid=ti(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){let e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),t.length===0)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let r=0,n=this.bones.length;r<n;r++)this.boneInverses.push(new Ue)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){let r=new Ue;this.bones[e]&&r.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(r)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){let r=this.bones[e];r&&r.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){let r=this.bones[e];r&&(r.parent&&r.parent.isBone?(r.matrix.copy(r.parent.matrixWorld).invert(),r.matrix.multiply(r.matrixWorld)):r.matrix.copy(r.matrixWorld),r.matrix.decompose(r.position,r.quaternion,r.scale))}}update(){let e=this.bones,t=this.boneInverses,r=this.boneMatrices,n=this.boneTexture;for(let i=0,s=e.length;i<s;i++){let a=e[i]?e[i].matrixWorld:Cie;kU.multiplyMatrices(a,t[i]),kU.toArray(r,i*16)}n!==null&&(n.needsUpdate=!0)}clone(){return new Ul(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=ib(e),e=Math.max(e,4);let t=new Float32Array(e*e*4);t.set(this.boneMatrices);let r=new Rr(t,e,e,at,qt);return r.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=r,this.boneTextureSize=e,this}getBoneByName(e){for(let t=0,r=this.bones.length;t<r;t++){let n=this.bones[t];if(n.name===e)return n}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let r=0,n=e.bones.length;r<n;r++){let i=e.bones[r],s=t[i];s===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",i),s=new ws),this.bones.push(s),this.boneInverses.push(new Ue().fromArray(e.boneInverses[r]))}return this.init(),this}toJSON(){let e={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;let t=this.bones,r=this.boneInverses;for(let n=0,i=t.length;n<i;n++){let s=t[n];e.bones.push(s.uuid);let a=r[n];e.boneInverses.push(a.toArray())}return e}};var Vr=class{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){let r=this.getUtoTmapping(e);return this.getPoint(r,t)}getPoints(e=5){let t=[];for(let r=0;r<=e;r++)t.push(this.getPoint(r/e));return t}getSpacedPoints(e=5){let t=[];for(let r=0;r<=e;r++)t.push(this.getPointAt(r/e));return t}getLength(){let e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;let t=[],r,n=this.getPoint(0),i=0;t.push(0);for(let s=1;s<=e;s++)r=this.getPoint(s/e),i+=r.distanceTo(n),t.push(i),n=r;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){let r=this.getLengths(),n=0,i=r.length,s;t?s=t:s=e*r[i-1];let a=0,c=i-1,l;for(;a<=c;)if(n=Math.floor(a+(c-a)/2),l=r[n]-s,l<0)a=n+1;else if(l>0)c=n-1;else{c=n;break}if(n=c,r[n]===s)return n/(i-1);let u=r[n],d=r[n+1]-u,h=(s-u)/d;return(n+h)/(i-1)}getTangent(e,t){let n=e-1e-4,i=e+1e-4;n<0&&(n=0),i>1&&(i=1);let s=this.getPoint(n),a=this.getPoint(i),c=t||(s.isVector2?new z:new M);return c.copy(a).sub(s).normalize(),c}getTangentAt(e,t){let r=this.getUtoTmapping(e);return this.getTangent(r,t)}computeFrenetFrames(e,t){let r=new M,n=[],i=[],s=[],a=new M,c=new Ue;for(let h=0;h<=e;h++){let m=h/e;n[h]=this.getTangentAt(m,new M)}i[0]=new M,s[0]=new M;let l=Number.MAX_VALUE,u=Math.abs(n[0].x),p=Math.abs(n[0].y),d=Math.abs(n[0].z);u<=l&&(l=u,r.set(1,0,0)),p<=l&&(l=p,r.set(0,1,0)),d<=l&&r.set(0,0,1),a.crossVectors(n[0],r).normalize(),i[0].crossVectors(n[0],a),s[0].crossVectors(n[0],i[0]);for(let h=1;h<=e;h++){if(i[h]=i[h-1].clone(),s[h]=s[h-1].clone(),a.crossVectors(n[h-1],n[h]),a.length()>Number.EPSILON){a.normalize();let m=Math.acos(Li(n[h-1].dot(n[h]),-1,1));i[h].applyMatrix4(c.makeRotationAxis(a,m))}s[h].crossVectors(n[h],i[h])}if(t===!0){let h=Math.acos(Li(i[0].dot(i[e]),-1,1));h/=e,n[0].dot(a.crossVectors(i[0],i[e]))>0&&(h=-h);for(let m=1;m<=e;m++)i[m].applyMatrix4(c.makeRotationAxis(n[m],h*m)),s[m].crossVectors(n[m],i[m])}return{tangents:n,normals:i,binormals:s}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){let e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}};var zl={};x3(zl,{ArcCurve:()=>L2,CatmullRomCurve3:()=>k2,CubicBezierCurve:()=>Sd,CubicBezierCurve3:()=>B2,EllipseCurve:()=>Qa,LineCurve:()=>ec,LineCurve3:()=>Ty,QuadraticBezierCurve:()=>wd,QuadraticBezierCurve3:()=>Md,SplineCurve:()=>Nd});var Qa=class extends Vr{constructor(e=0,t=0,r=1,n=1,i=0,s=Math.PI*2,a=!1,c=0){super();this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=r,this.yRadius=n,this.aStartAngle=i,this.aEndAngle=s,this.aClockwise=a,this.aRotation=c}getPoint(e,t){let r=t||new z,n=Math.PI*2,i=this.aEndAngle-this.aStartAngle,s=Math.abs(i)<Number.EPSILON;for(;i<0;)i+=n;for(;i>n;)i-=n;i<Number.EPSILON&&(s?i=0:i=n),this.aClockwise===!0&&!s&&(i===n?i=-n:i=i-n);let a=this.aStartAngle+e*i,c=this.aX+this.xRadius*Math.cos(a),l=this.aY+this.yRadius*Math.sin(a);if(this.aRotation!==0){let u=Math.cos(this.aRotation),p=Math.sin(this.aRotation),d=c-this.aX,h=l-this.aY;c=d*u-h*p+this.aX,l=d*p+h*u+this.aY}return r.set(c,l)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){let e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}};Qa.prototype.isEllipseCurve=!0;var L2=class extends Qa{constructor(e,t,r,n,i,s){super(e,t,r,r,n,i,s);this.type="ArcCurve"}};L2.prototype.isArcCurve=!0;function xy(){let o=0,e=0,t=0,r=0;function n(i,s,a,c){o=i,e=a,t=-3*i+3*s-2*a-c,r=2*i-2*s+a+c}return{initCatmullRom:function(i,s,a,c,l){n(s,a,l*(a-i),l*(c-s))},initNonuniformCatmullRom:function(i,s,a,c,l,u,p){let d=(s-i)/l-(a-i)/(l+u)+(a-s)/u,h=(a-s)/u-(c-s)/(u+p)+(c-a)/p;d*=u,h*=u,n(s,a,d,h)},calc:function(i){let s=i*i,a=s*i;return o+e*i+t*s+r*a}}}var D2=new M,gy=new xy,vy=new xy,yy=new xy,k2=class extends Vr{constructor(e=[],t=!1,r="centripetal",n=.5){super();this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=r,this.tension=n}getPoint(e,t=new M){let r=t,n=this.points,i=n.length,s=(i-(this.closed?0:1))*e,a=Math.floor(s),c=s-a;this.closed?a+=a>0?0:(Math.floor(Math.abs(a)/i)+1)*i:c===0&&a===i-1&&(a=i-2,c=1);let l,u;this.closed||a>0?l=n[(a-1)%i]:(D2.subVectors(n[0],n[1]).add(n[0]),l=D2);let p=n[a%i],d=n[(a+1)%i];if(this.closed||a+2<i?u=n[(a+2)%i]:(D2.subVectors(n[i-1],n[i-2]).add(n[i-1]),u=D2),this.curveType==="centripetal"||this.curveType==="chordal"){let h=this.curveType==="chordal"?.5:.25,m=Math.pow(l.distanceToSquared(p),h),f=Math.pow(p.distanceToSquared(d),h),v=Math.pow(d.distanceToSquared(u),h);f<1e-4&&(f=1),m<1e-4&&(m=f),v<1e-4&&(v=f),gy.initNonuniformCatmullRom(l.x,p.x,d.x,u.x,m,f,v),vy.initNonuniformCatmullRom(l.y,p.y,d.y,u.y,m,f,v),yy.initNonuniformCatmullRom(l.z,p.z,d.z,u.z,m,f,v)}else this.curveType==="catmullrom"&&(gy.initCatmullRom(l.x,p.x,d.x,u.x,this.tension),vy.initCatmullRom(l.y,p.y,d.y,u.y,this.tension),yy.initCatmullRom(l.z,p.z,d.z,u.z,this.tension));return r.set(gy.calc(c),vy.calc(c),yy.calc(c)),r}copy(e){super.copy(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){let n=e.points[t];this.points.push(n.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){let e=super.toJSON();e.points=[];for(let t=0,r=this.points.length;t<r;t++){let n=this.points[t];e.points.push(n.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){let n=e.points[t];this.points.push(new M().fromArray(n))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}};k2.prototype.isCatmullRomCurve3=!0;function by(o,e,t,r,n){let i=(r-e)*.5,s=(n-t)*.5,a=o*o,c=o*a;return(2*t-2*r+i+s)*c+(-3*t+3*r-2*i-s)*a+i*o+t}function Eie(o,e){let t=1-o;return t*t*e}function Sie(o,e){return 2*(1-o)*o*e}function wie(o,e){return o*o*e}function Vl(o,e,t,r){return Eie(o,e)+Sie(o,t)+wie(o,r)}function Mie(o,e){let t=1-o;return t*t*t*e}function Nie(o,e){let t=1-o;return 3*t*t*o*e}function Oie(o,e){return 3*(1-o)*o*o*e}function Pie(o,e){return o*o*o*e}function Gl(o,e,t,r,n){return Mie(o,e)+Nie(o,t)+Oie(o,r)+Pie(o,n)}var Sd=class extends Vr{constructor(e=new z,t=new z,r=new z,n=new z){super();this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=r,this.v3=n}getPoint(e,t=new z){let r=t,n=this.v0,i=this.v1,s=this.v2,a=this.v3;return r.set(Gl(e,n.x,i.x,s.x,a.x),Gl(e,n.y,i.y,s.y,a.y)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}};Sd.prototype.isCubicBezierCurve=!0;var B2=class extends Vr{constructor(e=new M,t=new M,r=new M,n=new M){super();this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=r,this.v3=n}getPoint(e,t=new M){let r=t,n=this.v0,i=this.v1,s=this.v2,a=this.v3;return r.set(Gl(e,n.x,i.x,s.x,a.x),Gl(e,n.y,i.y,s.y,a.y),Gl(e,n.z,i.z,s.z,a.z)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}};B2.prototype.isCubicBezierCurve3=!0;var ec=class extends Vr{constructor(e=new z,t=new z){super();this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new z){let r=t;return e===1?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(e).add(this.v1)),r}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t){let r=t||new z;return r.copy(this.v2).sub(this.v1).normalize(),r}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}};ec.prototype.isLineCurve=!0;var Ty=class extends Vr{constructor(e=new M,t=new M){super();this.type="LineCurve3",this.isLineCurve3=!0,this.v1=e,this.v2=t}getPoint(e,t=new M){let r=t;return e===1?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(e).add(this.v1)),r}getPointAt(e,t){return this.getPoint(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}};var wd=class extends Vr{constructor(e=new z,t=new z,r=new z){super();this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=r}getPoint(e,t=new z){let r=t,n=this.v0,i=this.v1,s=this.v2;return r.set(Vl(e,n.x,i.x,s.x),Vl(e,n.y,i.y,s.y)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}};wd.prototype.isQuadraticBezierCurve=!0;var Md=class extends Vr{constructor(e=new M,t=new M,r=new M){super();this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=r}getPoint(e,t=new M){let r=t,n=this.v0,i=this.v1,s=this.v2;return r.set(Vl(e,n.x,i.x,s.x),Vl(e,n.y,i.y,s.y),Vl(e,n.z,i.z,s.z)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}};Md.prototype.isQuadraticBezierCurve3=!0;var Nd=class extends Vr{constructor(e=[]){super();this.type="SplineCurve",this.points=e}getPoint(e,t=new z){let r=t,n=this.points,i=(n.length-1)*e,s=Math.floor(i),a=i-s,c=n[s===0?s:s-1],l=n[s],u=n[s>n.length-2?n.length-1:s+1],p=n[s>n.length-3?n.length-1:s+2];return r.set(by(a,c.x,l.x,u.x,p.x),by(a,c.y,l.y,u.y,p.y)),r}copy(e){super.copy(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){let n=e.points[t];this.points.push(n.clone())}return this}toJSON(){let e=super.toJSON();e.points=[];for(let t=0,r=this.points.length;t<r;t++){let n=this.points[t];e.points.push(n.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){let n=e.points[t];this.points.push(new z().fromArray(n))}return this}};Nd.prototype.isSplineCurve=!0;var Ay=class extends Vr{constructor(){super();this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){let e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new ec(t,e))}getPoint(e,t){let r=e*this.getLength(),n=this.getCurveLengths(),i=0;for(;i<n.length;){if(n[i]>=r){let s=n[i]-r,a=this.curves[i],c=a.getLength(),l=c===0?0:1-s/c;return a.getPointAt(l,t)}i++}return null}getLength(){let e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;let e=[],t=0;for(let r=0,n=this.curves.length;r<n;r++)t+=this.curves[r].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){let t=[];for(let r=0;r<=e;r++)t.push(this.getPoint(r/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){let t=[],r;for(let n=0,i=this.curves;n<i.length;n++){let s=i[n],a=s&&s.isEllipseCurve?e*2:s&&(s.isLineCurve||s.isLineCurve3)?1:s&&s.isSplineCurve?e*s.points.length:e,c=s.getPoints(a);for(let l=0;l<c.length;l++){let u=c[l];r&&r.equals(u)||(t.push(u),r=u)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,r=e.curves.length;t<r;t++){let n=e.curves[t];this.curves.push(n.clone())}return this.autoClose=e.autoClose,this}toJSON(){let e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,r=this.curves.length;t<r;t++){let n=this.curves[t];e.curves.push(n.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,r=e.curves.length;t<r;t++){let n=e.curves[t];this.curves.push(new zl[n.type]().fromJSON(n))}return this}};var F2=class extends Ay{constructor(e){super();this.type="Path",this.currentPoint=new z,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,r=e.length;t<r;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){let r=new ec(this.currentPoint.clone(),new z(e,t));return this.curves.push(r),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,r,n){let i=new wd(this.currentPoint.clone(),new z(e,t),new z(r,n));return this.curves.push(i),this.currentPoint.set(r,n),this}bezierCurveTo(e,t,r,n,i,s){let a=new Sd(this.currentPoint.clone(),new z(e,t),new z(r,n),new z(i,s));return this.curves.push(a),this.currentPoint.set(i,s),this}splineThru(e){let t=[this.currentPoint.clone()].concat(e),r=new Nd(t);return this.curves.push(r),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,r,n,i,s){let a=this.currentPoint.x,c=this.currentPoint.y;return this.absarc(e+a,t+c,r,n,i,s),this}absarc(e,t,r,n,i,s){return this.absellipse(e,t,r,r,n,i,s),this}ellipse(e,t,r,n,i,s,a,c){let l=this.currentPoint.x,u=this.currentPoint.y;return this.absellipse(e+l,t+u,r,n,i,s,a,c),this}absellipse(e,t,r,n,i,s,a,c){let l=new Qa(e,t,r,n,i,s,a,c);if(this.curves.length>0){let p=l.getPoint(0);p.equals(this.currentPoint)||this.lineTo(p.x,p.y)}this.curves.push(l);let u=l.getPoint(1);return this.currentPoint.copy(u),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){let e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}};var Hl=class extends F2{constructor(e){super(e);this.uuid=ti(),this.type="Shape",this.holes=[]}getPointsHoles(e){let t=[];for(let r=0,n=this.holes.length;r<n;r++)t[r]=this.holes[r].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,r=e.holes.length;t<r;t++){let n=e.holes[t];this.holes.push(n.clone())}return this}toJSON(){let e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,r=this.holes.length;t<r;t++){let n=this.holes[t];e.holes.push(n.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,r=e.holes.length;t<r;t++){let n=e.holes[t];this.holes.push(new F2().fromJSON(n))}return this}};var BU=new Ue,Cm=new M,Cy=new M,U2=class extends Rl{constructor(){super(new sr(90,1,.5,500));this._frameExtents=new z(4,2),this._viewportCount=6,this._viewports=[new De(2,1,1,1),new De(0,1,1,1),new De(3,1,1,1),new De(1,1,1,1),new De(3,0,1,1),new De(1,0,1,1)],this._cubeDirections=[new M(1,0,0),new M(-1,0,0),new M(0,0,1),new M(0,0,-1),new M(0,1,0),new M(0,-1,0)],this._cubeUps=[new M(0,1,0),new M(0,1,0),new M(0,1,0),new M(0,1,0),new M(0,0,1),new M(0,0,-1)]}updateMatrices(e,t=0){let r=this.camera,n=this.matrix,i=e.distance||r.far;i!==r.far&&(r.far=i,r.updateProjectionMatrix()),Cm.setFromMatrixPosition(e.matrixWorld),r.position.copy(Cm),Cy.copy(r.position),Cy.add(this._cubeDirections[t]),r.up.copy(this._cubeUps[t]),r.lookAt(Cy),r.updateMatrixWorld(),n.makeTranslation(-Cm.x,-Cm.y,-Cm.z),BU.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),this._frustum.setFromProjectionMatrix(BU)}};U2.prototype.isPointLightShadow=!0;var Od=class extends wo{constructor(e,t,r=0,n=1){super(e,t);this.type="PointLight",this.distance=r,this.decay=n,this.shadow=new U2}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}};Od.prototype.isPointLight=!0;var V2=class extends Rl{constructor(){super(new Cs(-5,5,5,-5,.5,500))}};V2.prototype.isDirectionalLightShadow=!0;var Pd=class extends wo{constructor(e,t){super(e,t);this.type="DirectionalLight",this.position.copy(vt.DefaultUp),this.updateMatrix(),this.target=new vt,this.shadow=new V2}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}};Pd.prototype.isDirectionalLight=!0;var G2=class extends wo{constructor(e,t){super(e,t);this.type="AmbientLight"}};G2.prototype.isAmbientLight=!0;var z2=class{constructor(){this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new M)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){let r=e.x,n=e.y,i=e.z,s=this.coefficients;return t.copy(s[0]).multiplyScalar(.282095),t.addScaledVector(s[1],.488603*n),t.addScaledVector(s[2],.488603*i),t.addScaledVector(s[3],.488603*r),t.addScaledVector(s[4],1.092548*(r*n)),t.addScaledVector(s[5],1.092548*(n*i)),t.addScaledVector(s[6],.315392*(3*i*i-1)),t.addScaledVector(s[7],1.092548*(r*i)),t.addScaledVector(s[8],.546274*(r*r-n*n)),t}getIrradianceAt(e,t){let r=e.x,n=e.y,i=e.z,s=this.coefficients;return t.copy(s[0]).multiplyScalar(.886227),t.addScaledVector(s[1],2*.511664*n),t.addScaledVector(s[2],2*.511664*i),t.addScaledVector(s[3],2*.511664*r),t.addScaledVector(s[4],2*.429043*r*n),t.addScaledVector(s[5],2*.429043*n*i),t.addScaledVector(s[6],.743125*i*i-.247708),t.addScaledVector(s[7],2*.429043*r*i),t.addScaledVector(s[8],.429043*(r*r-n*n)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let r=0;r<9;r++)this.coefficients[r].addScaledVector(e.coefficients[r],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let r=0;r<9;r++)this.coefficients[r].lerp(e.coefficients[r],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,t=0){let r=this.coefficients;for(let n=0;n<9;n++)r[n].fromArray(e,t+n*3);return this}toArray(e=[],t=0){let r=this.coefficients;for(let n=0;n<9;n++)r[n].toArray(e,t+n*3);return e}static getBasisAt(e,t){let r=e.x,n=e.y,i=e.z;t[0]=.282095,t[1]=.488603*n,t[2]=.488603*i,t[3]=.488603*r,t[4]=1.092548*r*n,t[5]=1.092548*n*i,t[6]=.315392*(3*i*i-1),t[7]=1.092548*r*i,t[8]=.546274*(r*r-n*n)}};z2.prototype.isSphericalHarmonics3=!0;var H2=class extends wo{constructor(e=new z2,t=1){super(void 0,t);this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){let t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}};H2.prototype.isLightProbe=!0;var pr={arraySlice:function(o,e,t){return pr.isTypedArray(o)?new o.constructor(o.subarray(e,t!==void 0?t:o.length)):o.slice(e,t)},convertArray:function(o,e,t){return!o||!t&&o.constructor===e?o:typeof e.BYTES_PER_ELEMENT=="number"?new e(o):Array.prototype.slice.call(o)},isTypedArray:function(o){return ArrayBuffer.isView(o)&&!(o instanceof DataView)},getKeyframeOrder:function(o){function e(n,i){return o[n]-o[i]}let t=o.length,r=new Array(t);for(let n=0;n!==t;++n)r[n]=n;return r.sort(e),r},sortedArray:function(o,e,t){let r=o.length,n=new o.constructor(r);for(let i=0,s=0;s!==r;++i){let a=t[i]*e;for(let c=0;c!==e;++c)n[s++]=o[a+c]}return n},flattenJSON:function(o,e,t,r){let n=1,i=o[0];for(;i!==void 0&&i[r]===void 0;)i=o[n++];if(i===void 0)return;let s=i[r];if(s!==void 0)if(Array.isArray(s))do s=i[r],s!==void 0&&(e.push(i.time),t.push.apply(t,s)),i=o[n++];while(i!==void 0);else if(s.toArray!==void 0)do s=i[r],s!==void 0&&(e.push(i.time),s.toArray(t,t.length)),i=o[n++];while(i!==void 0);else do s=i[r],s!==void 0&&(e.push(i.time),t.push(s)),i=o[n++];while(i!==void 0)},subclip:function(o,e,t,r,n=30){let i=o.clone();i.name=e;let s=[];for(let c=0;c<i.tracks.length;++c){let l=i.tracks[c],u=l.getValueSize(),p=[],d=[];for(let h=0;h<l.times.length;++h){let m=l.times[h]*n;if(!(m<t||m>=r)){p.push(l.times[h]);for(let f=0;f<u;++f)d.push(l.values[h*u+f])}}p.length!==0&&(l.times=pr.convertArray(p,l.times.constructor),l.values=pr.convertArray(d,l.values.constructor),s.push(l))}i.tracks=s;let a=1/0;for(let c=0;c<i.tracks.length;++c)a>i.tracks[c].times[0]&&(a=i.tracks[c].times[0]);for(let c=0;c<i.tracks.length;++c)i.tracks[c].shift(-1*a);return i.resetDuration(),i},makeClipAdditive:function(o,e=0,t=o,r=30){r<=0&&(r=30);let n=t.tracks.length,i=e/r;for(let s=0;s<n;++s){let a=t.tracks[s],c=a.ValueTypeName;if(c==="bool"||c==="string")continue;let l=o.tracks.find(function(g){return g.name===a.name&&g.ValueTypeName===c});if(l===void 0)continue;let u=0,p=a.getValueSize();a.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(u=p/3);let d=0,h=l.getValueSize();l.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(d=h/3);let m=a.times.length-1,f;if(i<=a.times[0]){let g=u,_=p-u;f=pr.arraySlice(a.values,g,_)}else if(i>=a.times[m]){let g=m*p+u,_=g+p-u;f=pr.arraySlice(a.values,g,_)}else{let g=a.createInterpolant(),_=u,T=p-u;g.evaluate(i),f=pr.arraySlice(g.resultBuffer,_,T)}c==="quaternion"&&new It().fromArray(f).normalize().conjugate().toArray(f);let v=l.times.length;for(let g=0;g<v;++g){let _=g*h+d;if(c==="quaternion")It.multiplyQuaternionsFlat(l.values,_,f,0,l.values,_);else{let T=h-d*2;for(let b=0;b<T;++b)l.values[_+b]-=f[b]}}}return o.blendMode=rb,o}};var Ey=class extends $o{constructor(e,t,r,n){super(e,t,r,n)}interpolate_(e,t,r,n){let i=this.resultBuffer,s=this.sampleValues,a=this.valueSize,c=e*a,l=c-a,u=(r-t)/(n-t),p=1-u;for(let d=0;d!==a;++d)i[d]=s[l+d]*p+s[c+d]*u;return i}};var Sy=class extends $o{constructor(e,t,r,n){super(e,t,r,n)}interpolate_(e){return this.copySampleValue_(e-1)}};var _o=class{constructor(e,t,r,n){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=pr.convertArray(t,this.TimeBufferType),this.values=pr.convertArray(r,this.ValueBufferType),this.setInterpolation(n||this.DefaultInterpolation)}static toJSON(e){let t=e.constructor,r;if(t.toJSON!==this.toJSON)r=t.toJSON(e);else{r={name:e.name,times:pr.convertArray(e.times,Array),values:pr.convertArray(e.values,Array)};let n=e.getInterpolation();n!==e.DefaultInterpolation&&(r.interpolation=n)}return r.type=e.ValueTypeName,r}InterpolantFactoryMethodDiscrete(e){return new Sy(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new Ey(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new Ch(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case s0:t=this.InterpolantFactoryMethodDiscrete;break;case a0:t=this.InterpolantFactoryMethodLinear;break;case d1:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){let r="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(r);return console.warn("THREE.KeyframeTrack:",r),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return s0;case this.InterpolantFactoryMethodLinear:return a0;case this.InterpolantFactoryMethodSmooth:return d1}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){let t=this.times;for(let r=0,n=t.length;r!==n;++r)t[r]+=e}return this}scale(e){if(e!==1){let t=this.times;for(let r=0,n=t.length;r!==n;++r)t[r]*=e}return this}trim(e,t){let r=this.times,n=r.length,i=0,s=n-1;for(;i!==n&&r[i]<e;)++i;for(;s!==-1&&r[s]>t;)--s;if(++s,i!==0||s!==n){i>=s&&(s=Math.max(s,1),i=s-1);let a=this.getValueSize();this.times=pr.arraySlice(r,i,s),this.values=pr.arraySlice(this.values,i*a,s*a)}return this}validate(){let e=!0,t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);let r=this.times,n=this.values,i=r.length;i===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let s=null;for(let a=0;a!==i;a++){let c=r[a];if(typeof c=="number"&&isNaN(c)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,c),e=!1;break}if(s!==null&&s>c){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,c,s),e=!1;break}s=c}if(n!==void 0&&pr.isTypedArray(n))for(let a=0,c=n.length;a!==c;++a){let l=n[a];if(isNaN(l)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,l),e=!1;break}}return e}optimize(){let e=pr.arraySlice(this.times),t=pr.arraySlice(this.values),r=this.getValueSize(),n=this.getInterpolation()===d1,i=e.length-1,s=1;for(let a=1;a<i;++a){let c=!1,l=e[a],u=e[a+1];if(l!==u&&(a!==1||l!==e[0]))if(n)c=!0;else{let p=a*r,d=p-r,h=p+r;for(let m=0;m!==r;++m){let f=t[p+m];if(f!==t[d+m]||f!==t[h+m]){c=!0;break}}}if(c){if(a!==s){e[s]=e[a];let p=a*r,d=s*r;for(let h=0;h!==r;++h)t[d+h]=t[p+h]}++s}}if(i>0){e[s]=e[i];for(let a=i*r,c=s*r,l=0;l!==r;++l)t[c+l]=t[a+l];++s}return s!==e.length?(this.times=pr.arraySlice(e,0,s),this.values=pr.arraySlice(t,0,s*r)):(this.times=e,this.values=t),this}clone(){let e=pr.arraySlice(this.times,0),t=pr.arraySlice(this.values,0),r=this.constructor,n=new r(this.name,e,t);return n.createInterpolant=this.createInterpolant,n}};_o.prototype.TimeBufferType=Float32Array;_o.prototype.ValueBufferType=Float32Array;_o.prototype.DefaultInterpolation=a0;var tc=class extends _o{};tc.prototype.ValueTypeName="bool";tc.prototype.ValueBufferType=Array;tc.prototype.DefaultInterpolation=s0;tc.prototype.InterpolantFactoryMethodLinear=void 0;tc.prototype.InterpolantFactoryMethodSmooth=void 0;var j2=class extends _o{};j2.prototype.ValueTypeName="color";var rc=class extends _o{};rc.prototype.ValueTypeName="number";var wy=class extends $o{constructor(e,t,r,n){super(e,t,r,n)}interpolate_(e,t,r,n){let i=this.resultBuffer,s=this.sampleValues,a=this.valueSize,c=(r-t)/(n-t),l=e*a;for(let u=l+a;l!==u;l+=4)It.slerpFlat(i,0,s,l-a,s,l,c);return i}};var Qs=class extends _o{InterpolantFactoryMethodLinear(e){return new wy(this.times,this.values,this.getValueSize(),e)}};Qs.prototype.ValueTypeName="quaternion";Qs.prototype.DefaultInterpolation=a0;Qs.prototype.InterpolantFactoryMethodSmooth=void 0;var oc=class extends _o{};oc.prototype.ValueTypeName="string";oc.prototype.ValueBufferType=Array;oc.prototype.DefaultInterpolation=s0;oc.prototype.InterpolantFactoryMethodLinear=void 0;oc.prototype.InterpolantFactoryMethodSmooth=void 0;var nc=class extends _o{};nc.prototype.ValueTypeName="vector";var Em=class{constructor(e,t=-1,r,n=tb){this.name=e,this.tracks=r,this.duration=t,this.blendMode=n,this.uuid=ti(),this.duration<0&&this.resetDuration()}static parse(e){let t=[],r=e.tracks,n=1/(e.fps||1);for(let s=0,a=r.length;s!==a;++s)t.push(Iie(r[s]).scale(n));let i=new this(e.name,e.duration,t,e.blendMode);return i.uuid=e.uuid,i}static toJSON(e){let t=[],r=e.tracks,n={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let i=0,s=r.length;i!==s;++i)t.push(_o.toJSON(r[i]));return n}static CreateFromMorphTargetSequence(e,t,r,n){let i=t.length,s=[];for(let a=0;a<i;a++){let c=[],l=[];c.push((a+i-1)%i,a,(a+1)%i),l.push(0,1,0);let u=pr.getKeyframeOrder(c);c=pr.sortedArray(c,1,u),l=pr.sortedArray(l,1,u),!n&&c[0]===0&&(c.push(i),l.push(l[0])),s.push(new rc(".morphTargetInfluences["+t[a].name+"]",c,l).scale(1/r))}return new this(e,-1,s)}static findByName(e,t){let r=e;if(!Array.isArray(e)){let n=e;r=n.geometry&&n.geometry.animations||n.animations}for(let n=0;n<r.length;n++)if(r[n].name===t)return r[n];return null}static CreateClipsFromMorphTargetSequences(e,t,r){let n={},i=/^([\w-]*?)([\d]+)$/;for(let a=0,c=e.length;a<c;a++){let l=e[a],u=l.name.match(i);if(u&&u.length>1){let p=u[1],d=n[p];d||(n[p]=d=[]),d.push(l)}}let s=[];for(let a in n)s.push(this.CreateFromMorphTargetSequence(a,n[a],t,r));return s}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;let r=function(p,d,h,m,f){if(h.length!==0){let v=[],g=[];pr.flattenJSON(h,v,g,m),v.length!==0&&f.push(new p(d,v,g))}},n=[],i=e.name||"default",s=e.fps||30,a=e.blendMode,c=e.length||-1,l=e.hierarchy||[];for(let p=0;p<l.length;p++){let d=l[p].keys;if(!(!d||d.length===0))if(d[0].morphTargets){let h={},m;for(m=0;m<d.length;m++)if(d[m].morphTargets)for(let f=0;f<d[m].morphTargets.length;f++)h[d[m].morphTargets[f]]=-1;for(let f in h){let v=[],g=[];for(let _=0;_!==d[m].morphTargets.length;++_){let T=d[m];v.push(T.time),g.push(T.morphTarget===f?1:0)}n.push(new rc(".morphTargetInfluence["+f+"]",v,g))}c=h.length*(s||1)}else{let h=".bones["+t[p].name+"]";r(nc,h+".position",d,"pos",n),r(Qs,h+".quaternion",d,"rot",n),r(nc,h+".scale",d,"scl",n)}}return n.length===0?null:new this(i,c,n,a)}resetDuration(){let e=this.tracks,t=0;for(let r=0,n=e.length;r!==n;++r){let i=this.tracks[r];t=Math.max(t,i.times[i.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){let e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}};function Rie(o){switch(o.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return rc;case"vector":case"vector2":case"vector3":case"vector4":return nc;case"color":return j2;case"quaternion":return Qs;case"bool":case"boolean":return tc;case"string":return oc}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+o)}function Iie(o){if(o.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");let e=Rie(o.type);if(o.times===void 0){let t=[],r=[];pr.flattenJSON(o.keys,t,r,"value"),o.times=t,o.values=r}return e.parse!==void 0?e.parse(o):new e(o.name,o.times,o.values,o.interpolation)}var Ei=class{static decodeText(e){if(typeof TextDecoder<"u")return new TextDecoder().decode(e);let t="";for(let r=0,n=e.length;r<n;r++)t+=String.fromCharCode(e[r]);try{return decodeURIComponent(escape(t))}catch{return t}}static extractUrlBase(e){let t=e.lastIndexOf("/");return t===-1?"./":e.substr(0,t+1)}static resolveURL(e,t){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}};var My=class extends lo{constructor(e){super(e)}load(e,t,r,n){let i=this,s=new Xo(i.manager);s.setPath(i.path),s.setRequestHeader(i.requestHeader),s.setWithCredentials(i.withCredentials),s.load(e,function(a){try{t(i.parse(JSON.parse(a)))}catch(c){n?n(c):console.error(c),i.manager.itemError(e)}},r,n)}parse(e){let t={},r={};function n(h,m){if(t[m]!==void 0)return t[m];let v=h.interleavedBuffers[m],g=i(h,v.buffer),_=Y0(v.type,g),T=new h0(_,v.stride);return T.uuid=v.uuid,t[m]=T,T}function i(h,m){if(r[m]!==void 0)return r[m];let v=h.arrayBuffers[m],g=new Uint32Array(v).buffer;return r[m]=g,g}let s=e.isInstancedBufferGeometry?new Zu:new Re,a=e.data.index;if(a!==void 0){let h=Y0(a.type,a.array);s.setIndex(new Tt(h,1))}let c=e.data.attributes;for(let h in c){let m=c[h],f;if(m.isInterleavedBufferAttribute){let v=n(e.data,m.data);f=new Dn(v,m.itemSize,m.offset,m.normalized)}else{let v=Y0(m.type,m.array),g=m.isInstancedBufferAttribute?Kr:Tt;f=new g(v,m.itemSize,m.normalized)}m.name!==void 0&&(f.name=m.name),m.usage!==void 0&&f.setUsage(m.usage),m.updateRange!==void 0&&(f.updateRange.offset=m.updateRange.offset,f.updateRange.count=m.updateRange.count),s.setAttribute(h,f)}let l=e.data.morphAttributes;if(l)for(let h in l){let m=l[h],f=[];for(let v=0,g=m.length;v<g;v++){let _=m[v],T;if(_.isInterleavedBufferAttribute){let b=n(e.data,_.data);T=new Dn(b,_.itemSize,_.offset,_.normalized)}else{let b=Y0(_.type,_.array);T=new Tt(b,_.itemSize,_.normalized)}_.name!==void 0&&(T.name=_.name),f.push(T)}s.morphAttributes[h]=f}e.data.morphTargetsRelative&&(s.morphTargetsRelative=!0);let p=e.data.groups||e.data.drawcalls||e.data.offsets;if(p!==void 0)for(let h=0,m=p.length;h!==m;++h){let f=p[h];s.addGroup(f.start,f.count,f.materialIndex)}let d=e.data.boundingSphere;if(d!==void 0){let h=new M;d.center!==void 0&&h.fromArray(d.center),s.boundingSphere=new X0(h,d.radius)}return e.name&&(s.name=e.name),e.userData&&(s.userData=e.userData),s}};var a3={};x3(a3,{BoxBufferGeometry:()=>Nn,BoxGeometry:()=>Nn,CircleBufferGeometry:()=>xd,CircleGeometry:()=>xd,ConeBufferGeometry:()=>md,ConeGeometry:()=>md,CylinderBufferGeometry:()=>fd,CylinderGeometry:()=>fd,DodecahedronBufferGeometry:()=>W2,DodecahedronGeometry:()=>W2,EdgesGeometry:()=>FU,ExtrudeBufferGeometry:()=>Z2,ExtrudeGeometry:()=>Z2,IcosahedronBufferGeometry:()=>Id,IcosahedronGeometry:()=>Id,LatheBufferGeometry:()=>Q2,LatheGeometry:()=>Q2,OctahedronBufferGeometry:()=>e3,OctahedronGeometry:()=>e3,PlaneBufferGeometry:()=>Ts,PlaneGeometry:()=>Ts,PolyhedronBufferGeometry:()=>Si,PolyhedronGeometry:()=>Si,RingBufferGeometry:()=>t3,RingGeometry:()=>t3,ShapeBufferGeometry:()=>r3,ShapeGeometry:()=>r3,SphereBufferGeometry:()=>jl,SphereGeometry:()=>jl,TetrahedronBufferGeometry:()=>o3,TetrahedronGeometry:()=>o3,TorusBufferGeometry:()=>n3,TorusGeometry:()=>n3,TorusKnotBufferGeometry:()=>i3,TorusKnotGeometry:()=>i3,TubeBufferGeometry:()=>s3,TubeGeometry:()=>s3,WireframeGeometry:()=>XU});var Si=class extends Re{constructor(e=[],t=[],r=1,n=0){super();this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:r,detail:n};let i=[],s=[];a(n),l(r),u(),this.setAttribute("position",new Ce(i,3)),this.setAttribute("normal",new Ce(i.slice(),3)),this.setAttribute("uv",new Ce(s,2)),n===0?this.computeVertexNormals():this.normalizeNormals();function a(_){let T=new M,b=new M,x=new M;for(let A=0;A<t.length;A+=3)h(t[A+0],T),h(t[A+1],b),h(t[A+2],x),c(T,b,x,_)}function c(_,T,b,x){let A=x+1,E=[];for(let S=0;S<=A;S++){E[S]=[];let w=_.clone().lerp(b,S/A),O=T.clone().lerp(b,S/A),C=A-S;for(let N=0;N<=C;N++)N===0&&S===A?E[S][N]=w:E[S][N]=w.clone().lerp(O,N/C)}for(let S=0;S<A;S++)for(let w=0;w<2*(A-S)-1;w++){let O=Math.floor(w/2);w%2===0?(d(E[S][O+1]),d(E[S+1][O]),d(E[S][O])):(d(E[S][O+1]),d(E[S+1][O+1]),d(E[S+1][O]))}}function l(_){let T=new M;for(let b=0;b<i.length;b+=3)T.x=i[b+0],T.y=i[b+1],T.z=i[b+2],T.normalize().multiplyScalar(_),i[b+0]=T.x,i[b+1]=T.y,i[b+2]=T.z}function u(){let _=new M;for(let T=0;T<i.length;T+=3){_.x=i[T+0],_.y=i[T+1],_.z=i[T+2];let b=v(_)/2/Math.PI+.5,x=g(_)/Math.PI+.5;s.push(b,1-x)}m(),p()}function p(){for(let _=0;_<s.length;_+=6){let T=s[_+0],b=s[_+2],x=s[_+4],A=Math.max(T,b,x),E=Math.min(T,b,x);A>.9&&E<.1&&(T<.2&&(s[_+0]+=1),b<.2&&(s[_+2]+=1),x<.2&&(s[_+4]+=1))}}function d(_){i.push(_.x,_.y,_.z)}function h(_,T){let b=_*3;T.x=e[b+0],T.y=e[b+1],T.z=e[b+2]}function m(){let _=new M,T=new M,b=new M,x=new M,A=new z,E=new z,S=new z;for(let w=0,O=0;w<i.length;w+=9,O+=6){_.set(i[w+0],i[w+1],i[w+2]),T.set(i[w+3],i[w+4],i[w+5]),b.set(i[w+6],i[w+7],i[w+8]),A.set(s[O+0],s[O+1]),E.set(s[O+2],s[O+3]),S.set(s[O+4],s[O+5]),x.copy(_).add(T).add(b).divideScalar(3);let C=v(x);f(A,O+0,_,C),f(E,O+2,T,C),f(S,O+4,b,C)}}function f(_,T,b,x){x<0&&_.x===1&&(s[T]=_.x-1),b.x===0&&b.z===0&&(s[T]=x/2/Math.PI+.5)}function v(_){return Math.atan2(_.z,-_.x)}function g(_){return Math.atan2(-_.y,Math.sqrt(_.x*_.x+_.z*_.z))}}static fromJSON(e){return new Si(e.vertices,e.indices,e.radius,e.details)}};var W2=class extends Si{constructor(e=1,t=0){let r=(1+Math.sqrt(5))/2,n=1/r,i=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-n,-r,0,-n,r,0,n,-r,0,n,r,-n,-r,0,-n,r,0,n,-r,0,n,r,0,-r,0,-n,r,0,-n,-r,0,n,r,0,n],s=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(i,s,e,t);this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new W2(e.radius,e.detail)}};var q2=new M,X2=new M,Ny=new M,Y2=new mn,FU=class extends Re{constructor(e=null,t=1){super();if(this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:t},e!==null){let n=Math.pow(10,4),i=Math.cos(q0*t),s=e.getIndex(),a=e.getAttribute("position"),c=s?s.count:a.count,l=[0,0,0],u=["a","b","c"],p=new Array(3),d={},h=[];for(let m=0;m<c;m+=3){s?(l[0]=s.getX(m),l[1]=s.getX(m+1),l[2]=s.getX(m+2)):(l[0]=m,l[1]=m+1,l[2]=m+2);let{a:f,b:v,c:g}=Y2;if(f.fromBufferAttribute(a,l[0]),v.fromBufferAttribute(a,l[1]),g.fromBufferAttribute(a,l[2]),Y2.getNormal(Ny),p[0]=`${Math.round(f.x*n)},${Math.round(f.y*n)},${Math.round(f.z*n)}`,p[1]=`${Math.round(v.x*n)},${Math.round(v.y*n)},${Math.round(v.z*n)}`,p[2]=`${Math.round(g.x*n)},${Math.round(g.y*n)},${Math.round(g.z*n)}`,!(p[0]===p[1]||p[1]===p[2]||p[2]===p[0]))for(let _=0;_<3;_++){let T=(_+1)%3,b=p[_],x=p[T],A=Y2[u[_]],E=Y2[u[T]],S=`${b}_${x}`,w=`${x}_${b}`;w in d&&d[w]?(Ny.dot(d[w].normal)<=i&&(h.push(A.x,A.y,A.z),h.push(E.x,E.y,E.z)),d[w]=null):S in d||(d[S]={index0:l[_],index1:l[T],normal:Ny.clone()})}}for(let m in d)if(d[m]){let{index0:f,index1:v}=d[m];q2.fromBufferAttribute(a,f),X2.fromBufferAttribute(a,v),h.push(q2.x,q2.y,q2.z),h.push(X2.x,X2.y,X2.z)}this.setAttribute("position",new Ce(h,3))}}};var VU={triangulate:function(o,e,t=2){let r=e&&e.length,n=r?e[0]*t:o.length,i=GU(o,0,n,t,!0),s=[];if(!i||i.next===i.prev)return s;let a,c,l,u,p,d,h;if(r&&(i=Fie(o,e,i,t)),o.length>80*t){a=l=o[0],c=u=o[1];for(let m=t;m<n;m+=t)p=o[m],d=o[m+1],p<a&&(a=p),d<c&&(c=d),p>l&&(l=p),d>u&&(u=d);h=Math.max(l-a,u-c),h=h!==0?1/h:0}return Sm(i,s,t,a,c,h),s}};function GU(o,e,t,r,n){let i,s;if(n===$ie(o,e,t,r)>0)for(i=e;i<t;i+=r)s=UU(i,o[i],o[i+1],s);else for(i=t-r;i>=e;i-=r)s=UU(i,o[i],o[i+1],s);return s&&J2(s,s.next)&&(Mm(s),s=s.next),s}function ic(o,e){if(!o)return o;e||(e=o);let t=o,r;do if(r=!1,!t.steiner&&(J2(t,t.next)||Ar(t.prev,t,t.next)===0)){if(Mm(t),t=e=t.prev,t===t.next)break;r=!0}else t=t.next;while(r||t!==e);return e}function Sm(o,e,t,r,n,i,s){if(!o)return;!s&&i&&Hie(o,r,n,i);let a=o,c,l;for(;o.prev!==o.next;){if(c=o.prev,l=o.next,i?Die(o,r,n,i):Lie(o)){e.push(c.i/t),e.push(o.i/t),e.push(l.i/t),Mm(o),o=l.next,a=l.next;continue}if(o=l,o===a){s?s===1?(o=kie(ic(o),e,t),Sm(o,e,t,r,n,i,2)):s===2&&Bie(o,e,t,r,n,i):Sm(ic(o),e,t,r,n,i,1);break}}}function Lie(o){let e=o.prev,t=o,r=o.next;if(Ar(e,t,r)>=0)return!1;let n=o.next.next;for(;n!==o.prev;){if(Rd(e.x,e.y,t.x,t.y,r.x,r.y,n.x,n.y)&&Ar(n.prev,n,n.next)>=0)return!1;n=n.next}return!0}function Die(o,e,t,r){let n=o.prev,i=o,s=o.next;if(Ar(n,i,s)>=0)return!1;let a=n.x<i.x?n.x<s.x?n.x:s.x:i.x<s.x?i.x:s.x,c=n.y<i.y?n.y<s.y?n.y:s.y:i.y<s.y?i.y:s.y,l=n.x>i.x?n.x>s.x?n.x:s.x:i.x>s.x?i.x:s.x,u=n.y>i.y?n.y>s.y?n.y:s.y:i.y>s.y?i.y:s.y,p=Oy(a,c,e,t,r),d=Oy(l,u,e,t,r),h=o.prevZ,m=o.nextZ;for(;h&&h.z>=p&&m&&m.z<=d;){if(h!==o.prev&&h!==o.next&&Rd(n.x,n.y,i.x,i.y,s.x,s.y,h.x,h.y)&&Ar(h.prev,h,h.next)>=0||(h=h.prevZ,m!==o.prev&&m!==o.next&&Rd(n.x,n.y,i.x,i.y,s.x,s.y,m.x,m.y)&&Ar(m.prev,m,m.next)>=0))return!1;m=m.nextZ}for(;h&&h.z>=p;){if(h!==o.prev&&h!==o.next&&Rd(n.x,n.y,i.x,i.y,s.x,s.y,h.x,h.y)&&Ar(h.prev,h,h.next)>=0)return!1;h=h.prevZ}for(;m&&m.z<=d;){if(m!==o.prev&&m!==o.next&&Rd(n.x,n.y,i.x,i.y,s.x,s.y,m.x,m.y)&&Ar(m.prev,m,m.next)>=0)return!1;m=m.nextZ}return!0}function kie(o,e,t){let r=o;do{let n=r.prev,i=r.next.next;!J2(n,i)&&zU(n,r,r.next,i)&&wm(n,i)&&wm(i,n)&&(e.push(n.i/t),e.push(r.i/t),e.push(i.i/t),Mm(r),Mm(r.next),r=o=i),r=r.next}while(r!==o);return ic(r)}function Bie(o,e,t,r,n,i){let s=o;do{let a=s.next.next;for(;a!==s.prev;){if(s.i!==a.i&&qie(s,a)){let c=HU(s,a);s=ic(s,s.next),c=ic(c,c.next),Sm(s,e,t,r,n,i),Sm(c,e,t,r,n,i);return}a=a.next}s=s.next}while(s!==o)}function Fie(o,e,t,r){let n=[],i,s,a,c,l;for(i=0,s=e.length;i<s;i++)a=e[i]*r,c=i<s-1?e[i+1]*r:o.length,l=GU(o,a,c,r,!1),l===l.next&&(l.steiner=!0),n.push(Wie(l));for(n.sort(Uie),i=0;i<n.length;i++)Vie(n[i],t),t=ic(t,t.next);return t}function Uie(o,e){return o.x-e.x}function Vie(o,e){if(e=Gie(o,e),e){let t=HU(e,o);ic(e,e.next),ic(t,t.next)}}function Gie(o,e){let t=e,r=o.x,n=o.y,i=-1/0,s;do{if(n<=t.y&&n>=t.next.y&&t.next.y!==t.y){let d=t.x+(n-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(d<=r&&d>i){if(i=d,d===r){if(n===t.y)return t;if(n===t.next.y)return t.next}s=t.x<t.next.x?t:t.next}}t=t.next}while(t!==e);if(!s)return null;if(r===i)return s;let a=s,c=s.x,l=s.y,u=1/0,p;t=s;do r>=t.x&&t.x>=c&&r!==t.x&&Rd(n<l?r:i,n,c,l,n<l?i:r,n,t.x,t.y)&&(p=Math.abs(n-t.y)/(r-t.x),wm(t,o)&&(p<u||p===u&&(t.x>s.x||t.x===s.x&&zie(s,t)))&&(s=t,u=p)),t=t.next;while(t!==a);return s}function zie(o,e){return Ar(o.prev,o,e.prev)<0&&Ar(e.next,o,o.next)<0}function Hie(o,e,t,r){let n=o;do n.z===null&&(n.z=Oy(n.x,n.y,e,t,r)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next;while(n!==o);n.prevZ.nextZ=null,n.prevZ=null,jie(n)}function jie(o){let e,t,r,n,i,s,a,c,l=1;do{for(t=o,o=null,i=null,s=0;t;){for(s++,r=t,a=0,e=0;e<l&&(a++,r=r.nextZ,!!r);e++);for(c=l;a>0||c>0&&r;)a!==0&&(c===0||!r||t.z<=r.z)?(n=t,t=t.nextZ,a--):(n=r,r=r.nextZ,c--),i?i.nextZ=n:o=n,n.prevZ=i,i=n;t=r}i.nextZ=null,l*=2}while(s>1);return o}function Oy(o,e,t,r,n){return o=32767*(o-t)*n,e=32767*(e-r)*n,o=(o|o<<8)&16711935,o=(o|o<<4)&252645135,o=(o|o<<2)&858993459,o=(o|o<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,o|e<<1}function Wie(o){let e=o,t=o;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==o);return t}function Rd(o,e,t,r,n,i,s,a){return(n-s)*(e-a)-(o-s)*(i-a)>=0&&(o-s)*(r-a)-(t-s)*(e-a)>=0&&(t-s)*(i-a)-(n-s)*(r-a)>=0}function qie(o,e){return o.next.i!==e.i&&o.prev.i!==e.i&&!Xie(o,e)&&(wm(o,e)&&wm(e,o)&&Yie(o,e)&&(Ar(o.prev,o,e.prev)||Ar(o,e.prev,e))||J2(o,e)&&Ar(o.prev,o,o.next)>0&&Ar(e.prev,e,e.next)>0)}function Ar(o,e,t){return(e.y-o.y)*(t.x-e.x)-(e.x-o.x)*(t.y-e.y)}function J2(o,e){return o.x===e.x&&o.y===e.y}function zU(o,e,t,r){let n=K2(Ar(o,e,t)),i=K2(Ar(o,e,r)),s=K2(Ar(t,r,o)),a=K2(Ar(t,r,e));return!!(n!==i&&s!==a||n===0&&$2(o,t,e)||i===0&&$2(o,r,e)||s===0&&$2(t,o,r)||a===0&&$2(t,e,r))}function $2(o,e,t){return e.x<=Math.max(o.x,t.x)&&e.x>=Math.min(o.x,t.x)&&e.y<=Math.max(o.y,t.y)&&e.y>=Math.min(o.y,t.y)}function K2(o){return o>0?1:o<0?-1:0}function Xie(o,e){let t=o;do{if(t.i!==o.i&&t.next.i!==o.i&&t.i!==e.i&&t.next.i!==e.i&&zU(t,t.next,o,e))return!0;t=t.next}while(t!==o);return!1}function wm(o,e){return Ar(o.prev,o,o.next)<0?Ar(o,e,o.next)>=0&&Ar(o,o.prev,e)>=0:Ar(o,e,o.prev)<0||Ar(o,o.next,e)<0}function Yie(o,e){let t=o,r=!1,n=(o.x+e.x)/2,i=(o.y+e.y)/2;do t.y>i!=t.next.y>i&&t.next.y!==t.y&&n<(t.next.x-t.x)*(i-t.y)/(t.next.y-t.y)+t.x&&(r=!r),t=t.next;while(t!==o);return r}function HU(o,e){let t=new Py(o.i,o.x,o.y),r=new Py(e.i,e.x,e.y),n=o.next,i=e.prev;return o.next=e,e.prev=o,t.next=n,n.prev=t,r.next=t,t.prev=r,i.next=r,r.prev=i,r}function UU(o,e,t,r){let n=new Py(o,e,t);return r?(n.next=r.next,n.prev=r,r.next.prev=n,r.next=n):(n.prev=n,n.next=n),n}function Mm(o){o.next.prev=o.prev,o.prev.next=o.next,o.prevZ&&(o.prevZ.nextZ=o.nextZ),o.nextZ&&(o.nextZ.prevZ=o.prevZ)}function Py(o,e,t){this.i=o,this.x=e,this.y=t,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function $ie(o,e,t,r){let n=0;for(let i=e,s=t-r;i<t;i+=r)n+=(o[s]-o[i])*(o[i+1]+o[s+1]),s=i;return n}var hs=class{static area(e){let t=e.length,r=0;for(let n=t-1,i=0;i<t;n=i++)r+=e[n].x*e[i].y-e[i].x*e[n].y;return r*.5}static isClockWise(e){return hs.area(e)<0}static triangulateShape(e,t){let r=[],n=[],i=[];jU(e),WU(r,e);let s=e.length;t.forEach(jU);for(let c=0;c<t.length;c++)n.push(s),s+=t[c].length,WU(r,t[c]);let a=VU.triangulate(r,n);for(let c=0;c<a.length;c+=3)i.push(a.slice(c,c+3));return i}};function jU(o){let e=o.length;e>2&&o[e-1].equals(o[0])&&o.pop()}function WU(o,e){for(let t=0;t<e.length;t++)o.push(e[t].x),o.push(e[t].y)}var Z2=class extends Re{constructor(e=new Hl([new z(.5,.5),new z(-.5,.5),new z(-.5,-.5),new z(.5,-.5)]),t={}){super();this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];let r=this,n=[],i=[];for(let a=0,c=e.length;a<c;a++){let l=e[a];s(l)}this.setAttribute("position",new Ce(n,3)),this.setAttribute("uv",new Ce(i,2)),this.computeVertexNormals();function s(a){let c=[],l=t.curveSegments!==void 0?t.curveSegments:12,u=t.steps!==void 0?t.steps:1,p=t.depth!==void 0?t.depth:1,d=t.bevelEnabled!==void 0?t.bevelEnabled:!0,h=t.bevelThickness!==void 0?t.bevelThickness:.2,m=t.bevelSize!==void 0?t.bevelSize:h-.1,f=t.bevelOffset!==void 0?t.bevelOffset:0,v=t.bevelSegments!==void 0?t.bevelSegments:3,g=t.extrudePath,_=t.UVGenerator!==void 0?t.UVGenerator:Kie;t.amount!==void 0&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),p=t.amount);let T,b=!1,x,A,E,S;g&&(T=g.getSpacedPoints(u),b=!0,d=!1,x=g.computeFrenetFrames(u,!1),A=new M,E=new M,S=new M),d||(v=0,h=0,m=0,f=0);let w=a.extractPoints(l),O=w.shape,C=w.holes;if(!hs.isClockWise(O)){O=O.reverse();for(let le=0,xe=C.length;le<xe;le++){let be=C[le];hs.isClockWise(be)&&(C[le]=be.reverse())}}let R=hs.triangulateShape(O,C),D=O;for(let le=0,xe=C.length;le<xe;le++){let be=C[le];O=O.concat(be)}function V(le,xe,be){return xe||console.error("THREE.ExtrudeGeometry: vec does not exist"),xe.clone().multiplyScalar(be).add(le)}let F=O.length,j=R.length;function $(le,xe,be){let ne,he,we,Ee=le.x-xe.x,Pe=le.y-xe.y,Xe=be.x-le.x,et=be.y-le.y,k=Ee*Ee+Pe*Pe,P=Ee*et-Pe*Xe;if(Math.abs(P)>Number.EPSILON){let fe=Math.sqrt(k),ee=Math.sqrt(Xe*Xe+et*et),me=xe.x-Pe/fe,Z=xe.y+Ee/fe,Se=be.x-et/ee,G=be.y+Xe/ee,se=((Se-me)*et-(G-Z)*Xe)/(Ee*et-Pe*Xe);ne=me+Ee*se-le.x,he=Z+Pe*se-le.y;let ve=ne*ne+he*he;if(ve<=2)return new z(ne,he);we=Math.sqrt(ve/2)}else{let fe=!1;Ee>Number.EPSILON?Xe>Number.EPSILON&&(fe=!0):Ee<-Number.EPSILON?Xe<-Number.EPSILON&&(fe=!0):Math.sign(Pe)===Math.sign(et)&&(fe=!0),fe?(ne=-Pe,he=Ee,we=Math.sqrt(k)):(ne=Ee,he=Pe,we=Math.sqrt(k/2))}return new z(ne/we,he/we)}let Y=[];for(let le=0,xe=D.length,be=xe-1,ne=le+1;le<xe;le++,be++,ne++)be===xe&&(be=0),ne===xe&&(ne=0),Y[le]=$(D[le],D[be],D[ne]);let H=[],B,te=Y.concat();for(let le=0,xe=C.length;le<xe;le++){let be=C[le];B=[];for(let ne=0,he=be.length,we=he-1,Ee=ne+1;ne<he;ne++,we++,Ee++)we===he&&(we=0),Ee===he&&(Ee=0),B[ne]=$(be[ne],be[we],be[Ee]);H.push(B),te=te.concat(B)}for(let le=0;le<v;le++){let xe=le/v,be=h*Math.cos(xe*Math.PI/2),ne=m*Math.sin(xe*Math.PI/2)+f;for(let he=0,we=D.length;he<we;he++){let Ee=V(D[he],Y[he],ne);ye(Ee.x,Ee.y,-be)}for(let he=0,we=C.length;he<we;he++){let Ee=C[he];B=H[he];for(let Pe=0,Xe=Ee.length;Pe<Xe;Pe++){let et=V(Ee[Pe],B[Pe],ne);ye(et.x,et.y,-be)}}}let X=m+f;for(let le=0;le<F;le++){let xe=d?V(O[le],te[le],X):O[le];b?(E.copy(x.normals[0]).multiplyScalar(xe.x),A.copy(x.binormals[0]).multiplyScalar(xe.y),S.copy(T[0]).add(E).add(A),ye(S.x,S.y,S.z)):ye(xe.x,xe.y,0)}for(let le=1;le<=u;le++)for(let xe=0;xe<F;xe++){let be=d?V(O[xe],te[xe],X):O[xe];b?(E.copy(x.normals[le]).multiplyScalar(be.x),A.copy(x.binormals[le]).multiplyScalar(be.y),S.copy(T[le]).add(E).add(A),ye(S.x,S.y,S.z)):ye(be.x,be.y,p/u*le)}for(let le=v-1;le>=0;le--){let xe=le/v,be=h*Math.cos(xe*Math.PI/2),ne=m*Math.sin(xe*Math.PI/2)+f;for(let he=0,we=D.length;he<we;he++){let Ee=V(D[he],Y[he],ne);ye(Ee.x,Ee.y,p+be)}for(let he=0,we=C.length;he<we;he++){let Ee=C[he];B=H[he];for(let Pe=0,Xe=Ee.length;Pe<Xe;Pe++){let et=V(Ee[Pe],B[Pe],ne);b?ye(et.x,et.y+T[u-1].y,T[u-1].x+be):ye(et.x,et.y,p+be)}}}W(),L();function W(){let le=n.length/3;if(d){let xe=0,be=F*xe;for(let ne=0;ne<j;ne++){let he=R[ne];ae(he[2]+be,he[1]+be,he[0]+be)}xe=u+v*2,be=F*xe;for(let ne=0;ne<j;ne++){let he=R[ne];ae(he[0]+be,he[1]+be,he[2]+be)}}else{for(let xe=0;xe<j;xe++){let be=R[xe];ae(be[2],be[1],be[0])}for(let xe=0;xe<j;xe++){let be=R[xe];ae(be[0]+F*u,be[1]+F*u,be[2]+F*u)}}r.addGroup(le,n.length/3-le,0)}function L(){let le=n.length/3,xe=0;Ne(D,xe),xe+=D.length;for(let be=0,ne=C.length;be<ne;be++){let he=C[be];Ne(he,xe),xe+=he.length}r.addGroup(le,n.length/3-le,1)}function Ne(le,xe){let be=le.length;for(;--be>=0;){let ne=be,he=be-1;he<0&&(he=le.length-1);for(let we=0,Ee=u+v*2;we<Ee;we++){let Pe=F*we,Xe=F*(we+1),et=xe+ne+Pe,k=xe+he+Pe,P=xe+he+Xe,fe=xe+ne+Xe;Ae(et,k,P,fe)}}}function ye(le,xe,be){c.push(le),c.push(xe),c.push(be)}function ae(le,xe,be){Ie(le),Ie(xe),Ie(be);let ne=n.length/3,he=_.generateTopUV(r,n,ne-3,ne-2,ne-1);Oe(he[0]),Oe(he[1]),Oe(he[2])}function Ae(le,xe,be,ne){Ie(le),Ie(xe),Ie(ne),Ie(xe),Ie(be),Ie(ne);let he=n.length/3,we=_.generateSideWallUV(r,n,he-6,he-3,he-2,he-1);Oe(we[0]),Oe(we[1]),Oe(we[3]),Oe(we[1]),Oe(we[2]),Oe(we[3])}function Ie(le){n.push(c[le*3+0]),n.push(c[le*3+1]),n.push(c[le*3+2])}function Oe(le){i.push(le.x),i.push(le.y)}}}toJSON(){let e=super.toJSON(),t=this.parameters.shapes,r=this.parameters.options;return Jie(t,r,e)}static fromJSON(e,t){let r=[];for(let i=0,s=e.shapes.length;i<s;i++){let a=t[e.shapes[i]];r.push(a)}let n=e.options.extrudePath;return n!==void 0&&(e.options.extrudePath=new zl[n.type]().fromJSON(n)),new Z2(r,e.options)}},Kie={generateTopUV:function(o,e,t,r,n){let i=e[t*3],s=e[t*3+1],a=e[r*3],c=e[r*3+1],l=e[n*3],u=e[n*3+1];return[new z(i,s),new z(a,c),new z(l,u)]},generateSideWallUV:function(o,e,t,r,n,i){let s=e[t*3],a=e[t*3+1],c=e[t*3+2],l=e[r*3],u=e[r*3+1],p=e[r*3+2],d=e[n*3],h=e[n*3+1],m=e[n*3+2],f=e[i*3],v=e[i*3+1],g=e[i*3+2];return Math.abs(a-u)<Math.abs(s-l)?[new z(s,1-c),new z(l,1-p),new z(d,1-m),new z(f,1-g)]:[new z(a,1-c),new z(u,1-p),new z(h,1-m),new z(v,1-g)]}};function Jie(o,e,t){if(t.shapes=[],Array.isArray(o))for(let r=0,n=o.length;r<n;r++){let i=o[r];t.shapes.push(i.uuid)}else t.shapes.push(o.uuid);return e.extrudePath!==void 0&&(t.options.extrudePath=e.extrudePath.toJSON()),t}var Id=class extends Si{constructor(e=1,t=0){let r=(1+Math.sqrt(5))/2,n=[-1,r,0,1,r,0,-1,-r,0,1,-r,0,0,-1,r,0,1,r,0,-1,-r,0,1,-r,r,0,-1,r,0,1,-r,0,-1,-r,0,1],i=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(n,i,e,t);this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Id(e.radius,e.detail)}};var Q2=class extends Re{constructor(e=[new z(0,.5),new z(.5,0),new z(0,-.5)],t=12,r=0,n=Math.PI*2){super();this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:r,phiLength:n},t=Math.floor(t),n=Li(n,0,Math.PI*2);let i=[],s=[],a=[],c=[],l=[],u=1/t,p=new M,d=new z,h=new M,m=new M,f=new M,v=0,g=0;for(let _=0;_<=e.length-1;_++)switch(_){case 0:v=e[_+1].x-e[_].x,g=e[_+1].y-e[_].y,h.x=g*1,h.y=-v,h.z=g*0,f.copy(h),h.normalize(),c.push(h.x,h.y,h.z);break;case e.length-1:c.push(f.x,f.y,f.z);break;default:v=e[_+1].x-e[_].x,g=e[_+1].y-e[_].y,h.x=g*1,h.y=-v,h.z=g*0,m.copy(h),h.x+=f.x,h.y+=f.y,h.z+=f.z,h.normalize(),c.push(h.x,h.y,h.z),f.copy(m)}for(let _=0;_<=t;_++){let T=r+_*u*n,b=Math.sin(T),x=Math.cos(T);for(let A=0;A<=e.length-1;A++){p.x=e[A].x*b,p.y=e[A].y,p.z=e[A].x*x,s.push(p.x,p.y,p.z),d.x=_/t,d.y=A/(e.length-1),a.push(d.x,d.y);let E=c[3*A+0]*b,S=c[3*A+1],w=c[3*A+0]*x;l.push(E,S,w)}}for(let _=0;_<t;_++)for(let T=0;T<e.length-1;T++){let b=T+_*e.length,x=b,A=b+e.length,E=b+e.length+1,S=b+1;i.push(x,A,S),i.push(E,S,A)}this.setIndex(i),this.setAttribute("position",new Ce(s,3)),this.setAttribute("uv",new Ce(a,2)),this.setAttribute("normal",new Ce(l,3))}static fromJSON(e){return new Q2(e.points,e.segments,e.phiStart,e.phiLength)}};var e3=class extends Si{constructor(e=1,t=0){let r=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],n=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(r,n,e,t);this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new e3(e.radius,e.detail)}};var t3=class extends Re{constructor(e=.5,t=1,r=8,n=1,i=0,s=Math.PI*2){super();this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:r,phiSegments:n,thetaStart:i,thetaLength:s},r=Math.max(3,r),n=Math.max(1,n);let a=[],c=[],l=[],u=[],p=e,d=(t-e)/n,h=new M,m=new z;for(let f=0;f<=n;f++){for(let v=0;v<=r;v++){let g=i+v/r*s;h.x=p*Math.cos(g),h.y=p*Math.sin(g),c.push(h.x,h.y,h.z),l.push(0,0,1),m.x=(h.x/t+1)/2,m.y=(h.y/t+1)/2,u.push(m.x,m.y)}p+=d}for(let f=0;f<n;f++){let v=f*(r+1);for(let g=0;g<r;g++){let _=g+v,T=_,b=_+r+1,x=_+r+2,A=_+1;a.push(T,b,A),a.push(b,x,A)}}this.setIndex(a),this.setAttribute("position",new Ce(c,3)),this.setAttribute("normal",new Ce(l,3)),this.setAttribute("uv",new Ce(u,2))}static fromJSON(e){return new t3(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}};var r3=class extends Re{constructor(e=new Hl([new z(0,.5),new z(-.5,-.5),new z(.5,-.5)]),t=12){super();this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};let r=[],n=[],i=[],s=[],a=0,c=0;if(Array.isArray(e)===!1)l(e);else for(let u=0;u<e.length;u++)l(e[u]),this.addGroup(a,c,u),a+=c,c=0;this.setIndex(r),this.setAttribute("position",new Ce(n,3)),this.setAttribute("normal",new Ce(i,3)),this.setAttribute("uv",new Ce(s,2));function l(u){let p=n.length/3,d=u.extractPoints(t),h=d.shape,m=d.holes;hs.isClockWise(h)===!1&&(h=h.reverse());for(let v=0,g=m.length;v<g;v++){let _=m[v];hs.isClockWise(_)===!0&&(m[v]=_.reverse())}let f=hs.triangulateShape(h,m);for(let v=0,g=m.length;v<g;v++){let _=m[v];h=h.concat(_)}for(let v=0,g=h.length;v<g;v++){let _=h[v];n.push(_.x,_.y,0),i.push(0,0,1),s.push(_.x,_.y)}for(let v=0,g=f.length;v<g;v++){let _=f[v],T=_[0]+p,b=_[1]+p,x=_[2]+p;r.push(T,b,x),c+=3}}}toJSON(){let e=super.toJSON(),t=this.parameters.shapes;return Zie(t,e)}static fromJSON(e,t){let r=[];for(let n=0,i=e.shapes.length;n<i;n++){let s=t[e.shapes[n]];r.push(s)}return new r3(r,e.curveSegments)}};function Zie(o,e){if(e.shapes=[],Array.isArray(o))for(let t=0,r=o.length;t<r;t++){let n=o[t];e.shapes.push(n.uuid)}else e.shapes.push(o.uuid);return e}var jl=class extends Re{constructor(e=1,t=32,r=16,n=0,i=Math.PI*2,s=0,a=Math.PI){super();this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:r,phiStart:n,phiLength:i,thetaStart:s,thetaLength:a},t=Math.max(3,Math.floor(t)),r=Math.max(2,Math.floor(r));let c=Math.min(s+a,Math.PI),l=0,u=[],p=new M,d=new M,h=[],m=[],f=[],v=[];for(let g=0;g<=r;g++){let _=[],T=g/r,b=0;g==0&&s==0?b=.5/t:g==r&&c==Math.PI&&(b=-.5/t);for(let x=0;x<=t;x++){let A=x/t;p.x=-e*Math.cos(n+A*i)*Math.sin(s+T*a),p.y=e*Math.cos(s+T*a),p.z=e*Math.sin(n+A*i)*Math.sin(s+T*a),m.push(p.x,p.y,p.z),d.copy(p).normalize(),f.push(d.x,d.y,d.z),v.push(A+b,1-T),_.push(l++)}u.push(_)}for(let g=0;g<r;g++)for(let _=0;_<t;_++){let T=u[g][_+1],b=u[g][_],x=u[g+1][_],A=u[g+1][_+1];(g!==0||s>0)&&h.push(T,b,A),(g!==r-1||c<Math.PI)&&h.push(b,x,A)}this.setIndex(h),this.setAttribute("position",new Ce(m,3)),this.setAttribute("normal",new Ce(f,3)),this.setAttribute("uv",new Ce(v,2))}static fromJSON(e){return new jl(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}};var o3=class extends Si{constructor(e=1,t=0){let r=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],n=[2,1,0,0,3,2,1,3,0,2,3,1];super(r,n,e,t);this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new o3(e.radius,e.detail)}};var n3=class extends Re{constructor(e=1,t=.4,r=8,n=6,i=Math.PI*2){super();this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:r,tubularSegments:n,arc:i},r=Math.floor(r),n=Math.floor(n);let s=[],a=[],c=[],l=[],u=new M,p=new M,d=new M;for(let h=0;h<=r;h++)for(let m=0;m<=n;m++){let f=m/n*i,v=h/r*Math.PI*2;p.x=(e+t*Math.cos(v))*Math.cos(f),p.y=(e+t*Math.cos(v))*Math.sin(f),p.z=t*Math.sin(v),a.push(p.x,p.y,p.z),u.x=e*Math.cos(f),u.y=e*Math.sin(f),d.subVectors(p,u).normalize(),c.push(d.x,d.y,d.z),l.push(m/n),l.push(h/r)}for(let h=1;h<=r;h++)for(let m=1;m<=n;m++){let f=(n+1)*h+m-1,v=(n+1)*(h-1)+m-1,g=(n+1)*(h-1)+m,_=(n+1)*h+m;s.push(f,v,_),s.push(v,g,_)}this.setIndex(s),this.setAttribute("position",new Ce(a,3)),this.setAttribute("normal",new Ce(c,3)),this.setAttribute("uv",new Ce(l,2))}static fromJSON(e){return new n3(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}};var i3=class extends Re{constructor(e=1,t=.4,r=64,n=8,i=2,s=3){super();this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:r,radialSegments:n,p:i,q:s},r=Math.floor(r),n=Math.floor(n);let a=[],c=[],l=[],u=[],p=new M,d=new M,h=new M,m=new M,f=new M,v=new M,g=new M;for(let T=0;T<=r;++T){let b=T/r*i*Math.PI*2;_(b,i,s,e,h),_(b+.01,i,s,e,m),v.subVectors(m,h),g.addVectors(m,h),f.crossVectors(v,g),g.crossVectors(f,v),f.normalize(),g.normalize();for(let x=0;x<=n;++x){let A=x/n*Math.PI*2,E=-t*Math.cos(A),S=t*Math.sin(A);p.x=h.x+(E*g.x+S*f.x),p.y=h.y+(E*g.y+S*f.y),p.z=h.z+(E*g.z+S*f.z),c.push(p.x,p.y,p.z),d.subVectors(p,h).normalize(),l.push(d.x,d.y,d.z),u.push(T/r),u.push(x/n)}}for(let T=1;T<=r;T++)for(let b=1;b<=n;b++){let x=(n+1)*(T-1)+(b-1),A=(n+1)*T+(b-1),E=(n+1)*T+b,S=(n+1)*(T-1)+b;a.push(x,A,S),a.push(A,E,S)}this.setIndex(a),this.setAttribute("position",new Ce(c,3)),this.setAttribute("normal",new Ce(l,3)),this.setAttribute("uv",new Ce(u,2));function _(T,b,x,A,E){let S=Math.cos(T),w=Math.sin(T),O=x/b*T,C=Math.cos(O);E.x=A*(2+C)*.5*S,E.y=A*(2+C)*w*.5,E.z=A*Math.sin(O)*.5}}static fromJSON(e){return new i3(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}};var s3=class extends Re{constructor(e=new Md(new M(-1,-1,0),new M(-1,1,0),new M(1,1,0)),t=64,r=1,n=8,i=!1){super();this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:r,radialSegments:n,closed:i};let s=e.computeFrenetFrames(t,i);this.tangents=s.tangents,this.normals=s.normals,this.binormals=s.binormals;let a=new M,c=new M,l=new z,u=new M,p=[],d=[],h=[],m=[];f(),this.setIndex(m),this.setAttribute("position",new Ce(p,3)),this.setAttribute("normal",new Ce(d,3)),this.setAttribute("uv",new Ce(h,2));function f(){for(let T=0;T<t;T++)v(T);v(i===!1?t:0),_(),g()}function v(T){u=e.getPointAt(T/t,u);let b=s.normals[T],x=s.binormals[T];for(let A=0;A<=n;A++){let E=A/n*Math.PI*2,S=Math.sin(E),w=-Math.cos(E);c.x=w*b.x+S*x.x,c.y=w*b.y+S*x.y,c.z=w*b.z+S*x.z,c.normalize(),d.push(c.x,c.y,c.z),a.x=u.x+r*c.x,a.y=u.y+r*c.y,a.z=u.z+r*c.z,p.push(a.x,a.y,a.z)}}function g(){for(let T=1;T<=t;T++)for(let b=1;b<=n;b++){let x=(n+1)*(T-1)+(b-1),A=(n+1)*T+(b-1),E=(n+1)*T+b,S=(n+1)*(T-1)+b;m.push(x,A,S),m.push(A,E,S)}}function _(){for(let T=0;T<=t;T++)for(let b=0;b<=n;b++)l.x=T/t,l.y=b/n,h.push(l.x,l.y)}}toJSON(){let e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new s3(new zl[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}};var XU=class extends Re{constructor(e=null){super();if(this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){let t=[],r=new Set,n=new M,i=new M;if(e.index!==null){let s=e.attributes.position,a=e.index,c=e.groups;c.length===0&&(c=[{start:0,count:a.count,materialIndex:0}]);for(let l=0,u=c.length;l<u;++l){let p=c[l],d=p.start,h=p.count;for(let m=d,f=d+h;m<f;m+=3)for(let v=0;v<3;v++){let g=a.getX(m+v),_=a.getX(m+(v+1)%3);n.fromBufferAttribute(s,g),i.fromBufferAttribute(s,_),qU(n,i,r)===!0&&(t.push(n.x,n.y,n.z),t.push(i.x,i.y,i.z))}}}else{let s=e.attributes.position;for(let a=0,c=s.count/3;a<c;a++)for(let l=0;l<3;l++){let u=3*a+l,p=3*a+(l+1)%3;n.fromBufferAttribute(s,u),i.fromBufferAttribute(s,p),qU(n,i,r)===!0&&(t.push(n.x,n.y,n.z),t.push(i.x,i.y,i.z))}}this.setAttribute("position",new Ce(t,3))}}};function qU(o,e,t){let r=`${o.x},${o.y},${o.z}-${e.x},${e.y},${e.z}`,n=`${e.x},${e.y},${e.z}-${o.x},${o.y},${o.z}`;return t.has(r)===!0||t.has(n)===!0?!1:(t.add(r,n),!0)}var Ry=class extends lo{constructor(e){super(e)}load(e,t,r,n){let i=this,s=this.path===""?Ei.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||s;let a=new Xo(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(c){let l=null;try{l=JSON.parse(c)}catch(p){n!==void 0&&n(p),console.error("THREE:ObjectLoader: Can't parse "+e+".",p.message);return}let u=l.metadata;if(u===void 0||u.type===void 0||u.type.toLowerCase()==="geometry"){console.error("THREE.ObjectLoader: Can't load "+e);return}i.parse(l,t)},r,n)}async loadAsync(e,t){let r=this,n=this.path===""?Ei.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||n;let i=new Xo(this.manager);i.setPath(this.path),i.setRequestHeader(this.requestHeader),i.setWithCredentials(this.withCredentials);let s=await i.loadAsync(e,t),a=JSON.parse(s),c=a.metadata;if(c===void 0||c.type===void 0||c.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+e);return await r.parseAsync(a)}parse(e,t){let r=this.parseAnimations(e.animations),n=this.parseShapes(e.shapes),i=this.parseGeometries(e.geometries,n),s=this.parseImages(e.images,function(){t!==void 0&&t(l)}),a=this.parseTextures(e.textures,s),c=this.parseMaterials(e.materials,a),l=this.parseObject(e.object,i,c,a,r),u=this.parseSkeletons(e.skeletons,l);if(this.bindSkeletons(l,u),t!==void 0){let p=!1;for(let d in s)if(s[d]instanceof HTMLImageElement){p=!0;break}p===!1&&t(l)}return l}async parseAsync(e){let t=this.parseAnimations(e.animations),r=this.parseShapes(e.shapes),n=this.parseGeometries(e.geometries,r),i=await this.parseImagesAsync(e.images),s=this.parseTextures(e.textures,i),a=this.parseMaterials(e.materials,s),c=this.parseObject(e.object,n,a,s,t),l=this.parseSkeletons(e.skeletons,c);return this.bindSkeletons(c,l),c}parseShapes(e){let t={};if(e!==void 0)for(let r=0,n=e.length;r<n;r++){let i=new Hl().fromJSON(e[r]);t[i.uuid]=i}return t}parseSkeletons(e,t){let r={},n={};if(t.traverse(function(i){i.isBone&&(n[i.uuid]=i)}),e!==void 0)for(let i=0,s=e.length;i<s;i++){let a=new Ul().fromJSON(e[i],n);r[a.uuid]=a}return r}parseGeometries(e,t){let r={};if(e!==void 0){let n=new My;for(let i=0,s=e.length;i<s;i++){let a,c=e[i];switch(c.type){case"BufferGeometry":case"InstancedBufferGeometry":a=n.parse(c);break;case"Geometry":console.error("THREE.ObjectLoader: The legacy Geometry type is no longer supported.");break;default:c.type in a3?a=a3[c.type].fromJSON(c,t):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${c.type}"`)}a.uuid=c.uuid,c.name!==void 0&&(a.name=c.name),a.isBufferGeometry===!0&&c.userData!==void 0&&(a.userData=c.userData),r[c.uuid]=a}}return r}parseMaterials(e,t){let r={},n={};if(e!==void 0){let i=new Vf;i.setTextures(t);for(let s=0,a=e.length;s<a;s++){let c=e[s];if(c.type==="MultiMaterial"){let l=[];for(let u=0;u<c.materials.length;u++){let p=c.materials[u];r[p.uuid]===void 0&&(r[p.uuid]=i.parse(p)),l.push(r[p.uuid])}n[c.uuid]=l}else r[c.uuid]===void 0&&(r[c.uuid]=i.parse(c)),n[c.uuid]=r[c.uuid]}}return n}parseAnimations(e){let t={};if(e!==void 0)for(let r=0;r<e.length;r++){let n=e[r],i=Em.parse(n);t[i.uuid]=i}return t}parseImages(e,t){let r=this,n={},i;function s(c){return r.manager.itemStart(c),i.load(c,function(){r.manager.itemEnd(c)},void 0,function(){r.manager.itemError(c),r.manager.itemEnd(c)})}function a(c){if(typeof c=="string"){let l=c,u=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(l)?l:r.resourcePath+l;return s(u)}else return c.data?{data:Y0(c.type,c.data),width:c.width,height:c.height}:null}if(e!==void 0&&e.length>0){let c=new v1(t);i=new nd(c),i.setCrossOrigin(this.crossOrigin);for(let l=0,u=e.length;l<u;l++){let p=e[l],d=p.url;if(Array.isArray(d)){n[p.uuid]=[];for(let h=0,m=d.length;h<m;h++){let f=d[h],v=a(f);v!==null&&(v instanceof HTMLImageElement?n[p.uuid].push(v):n[p.uuid].push(new Rr(v.data,v.width,v.height)))}}else{let h=a(p.url);h!==null&&(n[p.uuid]=h)}}}return n}async parseImagesAsync(e){let t=this,r={},n;async function i(s){if(typeof s=="string"){let a=s,c=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(a)?a:t.resourcePath+a;return await n.loadAsync(c)}else return s.data?{data:Y0(s.type,s.data),width:s.width,height:s.height}:null}if(e!==void 0&&e.length>0){n=new nd(this.manager),n.setCrossOrigin(this.crossOrigin);for(let s=0,a=e.length;s<a;s++){let c=e[s],l=c.url;if(Array.isArray(l)){r[c.uuid]=[];for(let u=0,p=l.length;u<p;u++){let d=l[u],h=await i(d);h!==null&&(h instanceof HTMLImageElement?r[c.uuid].push(h):r[c.uuid].push(new Rr(h.data,h.width,h.height)))}}else{let u=await i(c.url);u!==null&&(r[c.uuid]=u)}}}return r}parseTextures(e,t){function r(i,s){return typeof i=="number"?i:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",i),s[i])}let n={};if(e!==void 0)for(let i=0,s=e.length;i<s;i++){let a=e[i];a.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',a.uuid),t[a.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",a.image);let c,l=t[a.image];Array.isArray(l)?(c=new $0(l),l.length===6&&(c.needsUpdate=!0)):(l&&l.data?c=new Rr(l.data,l.width,l.height):c=new vr(l),l&&(c.needsUpdate=!0)),c.uuid=a.uuid,a.name!==void 0&&(c.name=a.name),a.mapping!==void 0&&(c.mapping=r(a.mapping,Qie)),a.offset!==void 0&&c.offset.fromArray(a.offset),a.repeat!==void 0&&c.repeat.fromArray(a.repeat),a.center!==void 0&&c.center.fromArray(a.center),a.rotation!==void 0&&(c.rotation=a.rotation),a.wrap!==void 0&&(c.wrapS=r(a.wrap[0],YU),c.wrapT=r(a.wrap[1],YU)),a.format!==void 0&&(c.format=a.format),a.type!==void 0&&(c.type=a.type),a.encoding!==void 0&&(c.encoding=a.encoding),a.minFilter!==void 0&&(c.minFilter=r(a.minFilter,$U)),a.magFilter!==void 0&&(c.magFilter=r(a.magFilter,$U)),a.anisotropy!==void 0&&(c.anisotropy=a.anisotropy),a.flipY!==void 0&&(c.flipY=a.flipY),a.premultiplyAlpha!==void 0&&(c.premultiplyAlpha=a.premultiplyAlpha),a.unpackAlignment!==void 0&&(c.unpackAlignment=a.unpackAlignment),a.userData!==void 0&&(c.userData=a.userData),n[a.uuid]=c}return n}parseObject(e,t,r,n,i){let s;function a(d){return t[d]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",d),t[d]}function c(d){if(d!==void 0){if(Array.isArray(d)){let h=[];for(let m=0,f=d.length;m<f;m++){let v=d[m];r[v]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",v),h.push(r[v])}return h}return r[d]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",d),r[d]}}function l(d){return n[d]===void 0&&console.warn("THREE.ObjectLoader: Undefined texture",d),n[d]}let u,p;switch(e.type){case"Scene":s=new ii,e.background!==void 0&&(Number.isInteger(e.background)?s.background=new de(e.background):s.background=l(e.background)),e.environment!==void 0&&(s.environment=l(e.environment)),e.fog!==void 0&&(e.fog.type==="Fog"?s.fog=new ca(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(s.fog=new la(e.fog.color,e.fog.density)));break;case"PerspectiveCamera":s=new sr(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(s.focus=e.focus),e.zoom!==void 0&&(s.zoom=e.zoom),e.filmGauge!==void 0&&(s.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(s.filmOffset=e.filmOffset),e.view!==void 0&&(s.view=Object.assign({},e.view));break;case"OrthographicCamera":s=new Cs(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(s.zoom=e.zoom),e.view!==void 0&&(s.view=Object.assign({},e.view));break;case"AmbientLight":s=new G2(e.color,e.intensity);break;case"DirectionalLight":s=new Pd(e.color,e.intensity);break;case"PointLight":s=new Od(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":s=new ld(e.color,e.intensity,e.width,e.height);break;case"SpotLight":s=new Ya(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":s=new ud(e.color,e.groundColor,e.intensity);break;case"LightProbe":s=new H2().fromJSON(e);break;case"SkinnedMesh":u=a(e.geometry),p=c(e.material),s=new ra(u,p),e.bindMode!==void 0&&(s.bindMode=e.bindMode),e.bindMatrix!==void 0&&s.bindMatrix.fromArray(e.bindMatrix),e.skeleton!==void 0&&(s.skeleton=e.skeleton);break;case"Mesh":u=a(e.geometry),p=c(e.material),s=new ct(u,p);break;case"InstancedMesh":u=a(e.geometry),p=c(e.material);let d=e.count,h=e.instanceMatrix,m=e.instanceColor;s=new N2(u,p,d),s.instanceMatrix=new Kr(new Float32Array(h.array),16),m!==void 0&&(s.instanceColor=new Kr(new Float32Array(m.array),m.itemSize));break;case"LOD":s=new Bu;break;case"Line":s=new bs(a(e.geometry),c(e.material));break;case"LineLoop":s=new Ed(a(e.geometry),c(e.material));break;case"LineSegments":s=new Gr(a(e.geometry),c(e.material));break;case"PointCloud":case"Points":s=new ri(a(e.geometry),c(e.material));break;case"Sprite":s=new I2(c(e.material));break;case"Group":s=new st;break;case"Bone":s=new ws;break;default:s=new vt}if(s.uuid=e.uuid,e.name!==void 0&&(s.name=e.name),e.matrix!==void 0?(s.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(s.matrixAutoUpdate=e.matrixAutoUpdate),s.matrixAutoUpdate&&s.matrix.decompose(s.position,s.quaternion,s.scale)):(e.position!==void 0&&s.position.fromArray(e.position),e.rotation!==void 0&&s.rotation.fromArray(e.rotation),e.quaternion!==void 0&&s.quaternion.fromArray(e.quaternion),e.scale!==void 0&&s.scale.fromArray(e.scale)),e.castShadow!==void 0&&(s.castShadow=e.castShadow),e.receiveShadow!==void 0&&(s.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.bias!==void 0&&(s.shadow.bias=e.shadow.bias),e.shadow.normalBias!==void 0&&(s.shadow.normalBias=e.shadow.normalBias),e.shadow.radius!==void 0&&(s.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&s.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(s.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(s.visible=e.visible),e.frustumCulled!==void 0&&(s.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(s.renderOrder=e.renderOrder),e.userData!==void 0&&(s.userData=e.userData),e.layers!==void 0&&(s.layers.mask=e.layers),e.children!==void 0){let d=e.children;for(let h=0;h<d.length;h++)s.add(this.parseObject(d[h],t,r,n,i))}if(e.animations!==void 0){let d=e.animations;for(let h=0;h<d.length;h++){let m=d[h];s.animations.push(i[m])}}if(e.type==="LOD"){e.autoUpdate!==void 0&&(s.autoUpdate=e.autoUpdate);let d=e.levels;for(let h=0;h<d.length;h++){let m=d[h],f=s.getObjectByProperty("uuid",m.object);f!==void 0&&s.addLevel(f,m.distance)}}return s}bindSkeletons(e,t){Object.keys(t).length!==0&&e.traverse(function(r){if(r.isSkinnedMesh===!0&&r.skeleton!==void 0){let n=t[r.skeleton];n===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",r.skeleton):r.bind(n,r.bindMatrix)}})}setTexturePath(e){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(e)}},Qie={UVMapping:Oi,CubeReflectionMapping:pn,CubeRefractionMapping:Sn,EquirectangularReflectionMapping:n0,EquirectangularRefractionMapping:i0,CubeUVReflectionMapping:dn,CubeUVRefractionMapping:Pi},YU={RepeatWrapping:Zn,ClampToEdgeWrapping:Ft,MirroredRepeatWrapping:j0},$U={NearestFilter:it,NearestMipmapNearestFilter:vc,NearestMipmapLinearFilter:yc,LinearFilter:lt,LinearMipmapNearestFilter:uu,LinearMipmapLinearFilter:Ri};var Iy=new WeakMap,Ly=class extends lo{constructor(e){super(e);this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,t,r,n){let i=new Xo(this.manager);i.setPath(this.path),i.setResponseType("arraybuffer"),i.setRequestHeader(this.requestHeader),i.setWithCredentials(this.withCredentials),i.load(e,s=>{let a={attributeIDs:this.defaultAttributeIDs,attributeTypes:this.defaultAttributeTypes,useUniqueIDs:!1};this.decodeGeometry(s,a).then(t).catch(n)},r,n)}decodeDracoFile(e,t,r,n){let i={attributeIDs:r||this.defaultAttributeIDs,attributeTypes:n||this.defaultAttributeTypes,useUniqueIDs:!!r};this.decodeGeometry(e,i).then(t)}decodeGeometry(e,t){for(let c in t.attributeTypes){let l=t.attributeTypes[c];l.BYTES_PER_ELEMENT!==void 0&&(t.attributeTypes[c]=l.name)}let r=JSON.stringify(t);if(Iy.has(e)){let c=Iy.get(e);if(c.key===r)return c.promise;if(e.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let n,i=this.workerNextTaskID++,s=e.byteLength,a=this._getWorker(i,s).then(c=>(n=c,new Promise((l,u)=>{n._callbacks[i]={resolve:l,reject:u},n.postMessage({type:"decode",id:i,taskConfig:t,buffer:e},[e])}))).then(c=>this._createGeometry(c.geometry));return a.catch(()=>!0).then(()=>{n&&i&&this._releaseTask(n,i)}),Iy.set(e,{key:r,promise:a}),a}_createGeometry(e){let t=new Re;e.index&&t.setIndex(new Tt(e.index.array,1));for(let r=0;r<e.attributes.length;r++){let n=e.attributes[r],i=n.name,s=n.array,a=n.itemSize;t.setAttribute(i,new Tt(s,a))}return t}_loadLibrary(e,t){let r=new Xo(this.manager);return r.setPath(this.decoderPath),r.setResponseType(t),r.setWithCredentials(this.withCredentials),new Promise((n,i)=>{r.load(e,n,void 0,i)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;let e=typeof WebAssembly!="object"||this.decoderConfig.type==="js",t=[];return e?t.push(this._loadLibrary("draco_decoder.js","text")):(t.push(this._loadLibrary("draco_wasm_wrapper.js","text")),t.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(t).then(r=>{let n=r[0];e||(this.decoderConfig.wasmBinary=r[1]);let i=ese.toString(),s=["/* draco decoder */",n,"","/* worker */",i.substring(i.indexOf("{")+1,i.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([s]))}),this.decoderPending}_getWorker(e,t){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){let n=new Worker(this.workerSourceURL);n._callbacks={},n._taskCosts={},n._taskLoad=0,n.postMessage({type:"init",decoderConfig:this.decoderConfig}),n.onmessage=function(i){let s=i.data;switch(s.type){case"decode":n._callbacks[s.id].resolve(s);break;case"error":n._callbacks[s.id].reject(s);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+s.type+'"')}},this.workerPool.push(n)}else this.workerPool.sort(function(n,i){return n._taskLoad>i._taskLoad?-1:1});let r=this.workerPool[this.workerPool.length-1];return r._taskCosts[e]=t,r._taskLoad+=t,r})}_releaseTask(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]}debug(){console.log("Task load: ",this.workerPool.map(e=>e._taskLoad))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this}};function ese(){let o,e;onmessage=function(s){let a=s.data;switch(a.type){case"init":o=a.decoderConfig,e=new Promise(function(u){o.onModuleLoaded=function(p){u({draco:p})},DracoDecoderModule(o)});break;case"decode":let c=a.buffer,l=a.taskConfig;e.then(u=>{let p=u.draco,d=new p.Decoder,h=new p.DecoderBuffer;h.Init(new Int8Array(c),c.byteLength);try{let m=t(p,d,h,l),f=m.attributes.map(v=>v.array.buffer);m.index&&f.push(m.index.array.buffer),self.postMessage({type:"decode",id:a.id,geometry:m},f)}catch(m){console.error(m),self.postMessage({type:"error",id:a.id,error:m.message})}finally{p.destroy(h),p.destroy(d)}});break}};function t(s,a,c,l){let u=l.attributeIDs,p=l.attributeTypes,d,h,m=a.GetEncodedGeometryType(c);if(m===s.TRIANGULAR_MESH)d=new s.Mesh,h=a.DecodeBufferToMesh(c,d);else if(m===s.POINT_CLOUD)d=new s.PointCloud,h=a.DecodeBufferToPointCloud(c,d);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!h.ok()||d.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+h.error_msg());let f={index:null,attributes:[]};for(let v in u){let g=self[p[v]],_,T;if(l.useUniqueIDs)T=u[v],_=a.GetAttributeByUniqueId(d,T);else{if(T=a.GetAttributeId(d,s[u[v]]),T===-1)continue;_=a.GetAttribute(d,T)}f.attributes.push(n(s,a,d,v,g,_))}return m===s.TRIANGULAR_MESH&&(f.index=r(s,a,d)),s.destroy(d),f}function r(s,a,c){let u=c.num_faces()*3,p=u*4,d=s._malloc(p);a.GetTrianglesUInt32Array(c,p,d);let h=new Uint32Array(s.HEAPF32.buffer,d,u).slice();return s._free(d),{array:h,itemSize:1}}function n(s,a,c,l,u,p){let d=p.num_components(),m=c.num_points()*d,f=m*u.BYTES_PER_ELEMENT,v=i(s,u),g=s._malloc(f);a.GetAttributeDataArrayForAllPoints(c,p,v,f,g);let _=new u(s.HEAPF32.buffer,g,m).slice();return s._free(g),{name:l,array:_,itemSize:d}}function i(s,a){switch(a){case Float32Array:return s.DT_FLOAT32;case Int8Array:return s.DT_INT8;case Int16Array:return s.DT_INT16;case Int32Array:return s.DT_INT32;case Uint8Array:return s.DT_UINT8;case Uint16Array:return s.DT_UINT16;case Uint32Array:return s.DT_UINT32}}}var c3=class extends lo{constructor(e){super(e);typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,r,n){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);let i=this,s=mu.get(e);if(s!==void 0)return i.manager.itemStart(e),setTimeout(function(){t&&t(s),i.manager.itemEnd(e)},0),s;let a={};a.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",a.headers=this.requestHeader,fetch(e,a).then(function(c){return c.blob()}).then(function(c){return createImageBitmap(c,Object.assign(i.options,{colorSpaceConversion:"none"}))}).then(function(c){mu.add(e,c),t&&t(c),i.manager.itemEnd(e)}).catch(function(c){n&&n(c),i.manager.itemError(e),i.manager.itemEnd(e)}),i.manager.itemStart(e)}};c3.prototype.isImageBitmapLoader=!0;var Dy="\\[\\]\\.:\\/",tse=new RegExp("["+Dy+"]","g"),ky="[^"+Dy+"]",rse="[^"+Dy.replace("\\.","")+"]",ose=/((?:WC+[\/:])*)/.source.replace("WC",ky),nse=/(WCOD+)?/.source.replace("WCOD",rse),ise=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",ky),sse=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",ky),ase=new RegExp("^"+ose+nse+ise+sse+"$"),cse=["material","materials","bones"],KU=class{constructor(e,t,r){let n=r||Ht.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,n)}getValue(e,t){this.bind();let r=this._targetGroup.nCachedObjects_,n=this._bindings[r];n!==void 0&&n.getValue(e,t)}setValue(e,t){let r=this._bindings;for(let n=this._targetGroup.nCachedObjects_,i=r.length;n!==i;++n)r[n].setValue(e,t)}bind(){let e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].bind()}unbind(){let e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].unbind()}},Ht=class{constructor(e,t,r){this.path=t,this.parsedPath=r||Ht.parseTrackName(t),this.node=Ht.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,r){return e&&e.isAnimationObjectGroup?new Ht.Composite(e,t,r):new Ht(e,t,r)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(tse,"")}static parseTrackName(e){let t=ase.exec(e);if(!t)throw new Error("PropertyBinding: Cannot parse trackName: "+e);let r={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},n=r.nodeName&&r.nodeName.lastIndexOf(".");if(n!==void 0&&n!==-1){let i=r.nodeName.substring(n+1);cse.indexOf(i)!==-1&&(r.nodeName=r.nodeName.substring(0,n),r.objectName=i)}if(r.propertyName===null||r.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return r}static findNode(e,t){if(!t||t===""||t==="."||t===-1||t===e.name||t===e.uuid)return e;if(e.skeleton){let r=e.skeleton.getBoneByName(t);if(r!==void 0)return r}if(e.children){let r=function(i){for(let s=0;s<i.length;s++){let a=i[s];if(a.name===t||a.uuid===t)return a;let c=r(a.children);if(c)return c}return null},n=r(e.children);if(n)return n}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){let r=this.resolvedProperty;for(let n=0,i=r.length;n!==i;++n)e[t++]=r[n]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){let r=this.resolvedProperty;for(let n=0,i=r.length;n!==i;++n)r[n]=e[t++]}_setValue_array_setNeedsUpdate(e,t){let r=this.resolvedProperty;for(let n=0,i=r.length;n!==i;++n)r[n]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){let r=this.resolvedProperty;for(let n=0,i=r.length;n!==i;++n)r[n]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node,t=this.parsedPath,r=t.objectName,n=t.propertyName,i=t.propertyIndex;if(e||(e=Ht.findNode(this.rootNode,t.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");return}if(r){let l=t.objectIndex;switch(r){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let u=0;u<e.length;u++)if(e[u].name===l){l=u;break}break;default:if(e[r]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[r]}if(l!==void 0){if(e[l]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[l]}}let s=e[n];if(s===void 0){let l=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+l+"."+n+" but it wasn't found.",e);return}let a=this.Versioning.None;this.targetObject=e,e.needsUpdate!==void 0?a=this.Versioning.NeedsUpdate:e.matrixWorldNeedsUpdate!==void 0&&(a=this.Versioning.MatrixWorldNeedsUpdate);let c=this.BindingType.Direct;if(i!==void 0){if(n==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(e.geometry.isBufferGeometry){if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[i]!==void 0&&(i=e.morphTargetDictionary[i])}else{console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);return}}c=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=i}else s.fromArray!==void 0&&s.toArray!==void 0?(c=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(c=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=n;this.getValue=this.GetterByBindingType[c],this.setValue=this.SetterByBindingTypeAndVersioning[c][a]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}};Ht.Composite=KU;Ht.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};Ht.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};Ht.prototype.GetterByBindingType=[Ht.prototype._getValue_direct,Ht.prototype._getValue_array,Ht.prototype._getValue_arrayElement,Ht.prototype._getValue_toArray];Ht.prototype.SetterByBindingTypeAndVersioning=[[Ht.prototype._setValue_direct,Ht.prototype._setValue_direct_setNeedsUpdate,Ht.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Ht.prototype._setValue_array,Ht.prototype._setValue_array_setNeedsUpdate,Ht.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Ht.prototype._setValue_arrayElement,Ht.prototype._setValue_arrayElement_setNeedsUpdate,Ht.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Ht.prototype._setValue_fromArray,Ht.prototype._setValue_fromArray_setNeedsUpdate,Ht.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];var Vy=class extends lo{constructor(e){super(e);this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new sV(t)}),this.register(function(t){return new dV(t)}),this.register(function(t){return new hV(t)}),this.register(function(t){return new aV(t)}),this.register(function(t){return new cV(t)}),this.register(function(t){return new lV(t)}),this.register(function(t){return new uV(t)}),this.register(function(t){return new pV(t)}),this.register(function(t){return new nV(t)}),this.register(function(t){return new fV(t)})}load(e,t,r,n){let i=this,s;this.resourcePath!==""?s=this.resourcePath:this.path!==""?s=this.path:s=Ei.extractUrlBase(e),this.manager.itemStart(e);let a=function(l){n?n(l):console.error(l),i.manager.itemError(e),i.manager.itemEnd(e)},c=new Xo(this.manager);c.setPath(this.path),c.setResponseType("arraybuffer"),c.setRequestHeader(this.requestHeader),c.setWithCredentials(this.withCredentials),c.load(e,function(l){try{i.parse(l,s,function(u){t(u),i.manager.itemEnd(e)},a)}catch(u){a(u)}},r,a)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e),this}unregister(e){return this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,r,n){let i,s={},a={};if(typeof e=="string")i=e;else if(Ei.decodeText(new Uint8Array(e,0,4))===mV){try{s[Ct.KHR_BINARY_GLTF]=new _V(e)}catch(p){n&&n(p);return}i=s[Ct.KHR_BINARY_GLTF].content}else i=Ei.decodeText(new Uint8Array(e));let c=JSON.parse(i);if(c.asset===void 0||c.asset.version[0]<2){n&&n(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}let l=new TV(c,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});l.fileLoader.setRequestHeader(this.requestHeader);for(let u=0;u<this.pluginCallbacks.length;u++){let p=this.pluginCallbacks[u](l);a[p.name]=p,s[p.name]=!0}if(c.extensionsUsed)for(let u=0;u<c.extensionsUsed.length;++u){let p=c.extensionsUsed[u],d=c.extensionsRequired||[];switch(p){case Ct.KHR_MATERIALS_UNLIT:s[p]=new iV;break;case Ct.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:s[p]=new yV;break;case Ct.KHR_DRACO_MESH_COMPRESSION:s[p]=new gV(c,this.dracoLoader);break;case Ct.KHR_TEXTURE_TRANSFORM:s[p]=new vV;break;case Ct.KHR_MESH_QUANTIZATION:s[p]=new xV;break;default:d.indexOf(p)>=0&&a[p]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+p+'".')}}l.setExtensions(s),l.setPlugins(a),l.parse(r,n)}parseAsync(e,t){let r=this;return new Promise(function(n,i){r.parse(e,t,n,i)})}};function lse(){let o={};return{get:function(e){return o[e]},add:function(e,t){o[e]=t},remove:function(e){delete o[e]},removeAll:function(){o={}}}}var Ct={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression"},nV=class{constructor(e){this.parser=e,this.name=Ct.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){let e=this.parser,t=this.parser.json.nodes||[];for(let r=0,n=t.length;r<n;r++){let i=t[r];i.extensions&&i.extensions[this.name]&&i.extensions[this.name].light!==void 0&&e._addNodeRef(this.cache,i.extensions[this.name].light)}}_loadLight(e){let t=this.parser,r="light:"+e,n=t.cache.get(r);if(n)return n;let i=t.json,c=((i.extensions&&i.extensions[this.name]||{}).lights||[])[e],l,u=new de(16777215);c.color!==void 0&&u.fromArray(c.color);let p=c.range!==void 0?c.range:0;switch(c.type){case"directional":l=new Pd(u),l.target.position.set(0,0,-1),l.add(l.target);break;case"point":l=new Od(u),l.distance=p;break;case"spot":l=new Ya(u),l.distance=p,c.spot=c.spot||{},c.spot.innerConeAngle=c.spot.innerConeAngle!==void 0?c.spot.innerConeAngle:0,c.spot.outerConeAngle=c.spot.outerConeAngle!==void 0?c.spot.outerConeAngle:Math.PI/4,l.angle=c.spot.outerConeAngle,l.penumbra=1-c.spot.innerConeAngle/c.spot.outerConeAngle,l.target.position.set(0,0,-1),l.add(l.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+c.type)}return l.position.set(0,0,0),l.decay=2,c.intensity!==void 0&&(l.intensity=c.intensity),l.name=t.createUniqueName(c.name||"light_"+e),n=Promise.resolve(l),t.cache.add(r,n),n}createNodeAttachment(e){let t=this,r=this.parser,i=r.json.nodes[e],a=(i.extensions&&i.extensions[this.name]||{}).light;return a===void 0?null:this._loadLight(a).then(function(c){return r._getNodeRef(t.cache,a,c)})}},iV=class{constructor(){this.name=Ct.KHR_MATERIALS_UNLIT}getMaterialType(){return _n}extendParams(e,t,r){let n=[];e.color=new de(1,1,1),e.opacity=1;let i=t.pbrMetallicRoughness;if(i){if(Array.isArray(i.baseColorFactor)){let s=i.baseColorFactor;e.color.fromArray(s),e.opacity=s[3]}i.baseColorTexture!==void 0&&n.push(r.assignTexture(e,"map",i.baseColorTexture))}return Promise.all(n)}},sV=class{constructor(e){this.parser=e,this.name=Ct.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){let r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:on}extendMaterialParams(e,t){let r=this.parser,n=r.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();let i=[],s=n.extensions[this.name];if(s.clearcoatFactor!==void 0&&(t.clearcoat=s.clearcoatFactor),s.clearcoatTexture!==void 0&&i.push(r.assignTexture(t,"clearcoatMap",s.clearcoatTexture)),s.clearcoatRoughnessFactor!==void 0&&(t.clearcoatRoughness=s.clearcoatRoughnessFactor),s.clearcoatRoughnessTexture!==void 0&&i.push(r.assignTexture(t,"clearcoatRoughnessMap",s.clearcoatRoughnessTexture)),s.clearcoatNormalTexture!==void 0&&(i.push(r.assignTexture(t,"clearcoatNormalMap",s.clearcoatNormalTexture)),s.clearcoatNormalTexture.scale!==void 0)){let a=s.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new z(a,a)}return Promise.all(i)}},aV=class{constructor(e){this.parser=e,this.name=Ct.KHR_MATERIALS_SHEEN}getMaterialType(e){let r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:on}extendMaterialParams(e,t){let r=this.parser,n=r.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();let i=[];t.sheenColor=new de(0,0,0),t.sheenRoughness=0,t.sheen=1;let s=n.extensions[this.name];return s.sheenColorFactor!==void 0&&t.sheenColor.fromArray(s.sheenColorFactor),s.sheenRoughnessFactor!==void 0&&(t.sheenRoughness=s.sheenRoughnessFactor),s.sheenColorTexture!==void 0&&i.push(r.assignTexture(t,"sheenColorMap",s.sheenColorTexture)),s.sheenRoughnessTexture!==void 0&&i.push(r.assignTexture(t,"sheenRoughnessMap",s.sheenRoughnessTexture)),Promise.all(i)}},cV=class{constructor(e){this.parser=e,this.name=Ct.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){let r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:on}extendMaterialParams(e,t){let r=this.parser,n=r.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();let i=[],s=n.extensions[this.name];return s.transmissionFactor!==void 0&&(t.transmission=s.transmissionFactor),s.transmissionTexture!==void 0&&i.push(r.assignTexture(t,"transmissionMap",s.transmissionTexture)),Promise.all(i)}},lV=class{constructor(e){this.parser=e,this.name=Ct.KHR_MATERIALS_VOLUME}getMaterialType(e){let r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:on}extendMaterialParams(e,t){let r=this.parser,n=r.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();let i=[],s=n.extensions[this.name];t.thickness=s.thicknessFactor!==void 0?s.thicknessFactor:0,s.thicknessTexture!==void 0&&i.push(r.assignTexture(t,"thicknessMap",s.thicknessTexture)),t.attenuationDistance=s.attenuationDistance||0;let a=s.attenuationColor||[1,1,1];return t.attenuationColor=new de(a[0],a[1],a[2]),Promise.all(i)}},uV=class{constructor(e){this.parser=e,this.name=Ct.KHR_MATERIALS_IOR}getMaterialType(e){let r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:on}extendMaterialParams(e,t){let n=this.parser.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();let i=n.extensions[this.name];return t.ior=i.ior!==void 0?i.ior:1.5,Promise.resolve()}},pV=class{constructor(e){this.parser=e,this.name=Ct.KHR_MATERIALS_SPECULAR}getMaterialType(e){let r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:on}extendMaterialParams(e,t){let r=this.parser,n=r.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();let i=[],s=n.extensions[this.name];t.specularIntensity=s.specularFactor!==void 0?s.specularFactor:1,s.specularTexture!==void 0&&i.push(r.assignTexture(t,"specularIntensityMap",s.specularTexture));let a=s.specularColorFactor||[1,1,1];return t.specularColor=new de(a[0],a[1],a[2]),s.specularColorTexture!==void 0&&i.push(r.assignTexture(t,"specularColorMap",s.specularColorTexture).then(function(c){c.encoding=bt})),Promise.all(i)}},dV=class{constructor(e){this.parser=e,this.name=Ct.KHR_TEXTURE_BASISU}loadTexture(e){let t=this.parser,r=t.json,n=r.textures[e];if(!n.extensions||!n.extensions[this.name])return null;let i=n.extensions[this.name],s=r.images[i.source],a=t.options.ktx2Loader;if(!a){if(r.extensionsRequired&&r.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,s,a)}},hV=class{constructor(e){this.parser=e,this.name=Ct.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){let t=this.name,r=this.parser,n=r.json,i=n.textures[e];if(!i.extensions||!i.extensions[t])return null;let s=i.extensions[t],a=n.images[s.source],c=r.textureLoader;if(a.uri){let l=r.options.manager.getHandler(a.uri);l!==null&&(c=l)}return this.detectSupport().then(function(l){if(l)return r.loadTextureImage(e,a,c);if(n.extensionsRequired&&n.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return r.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){let t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}},fV=class{constructor(e){this.name=Ct.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){let t=this.parser.json,r=t.bufferViews[e];if(r.extensions&&r.extensions[this.name]){let n=r.extensions[this.name],i=this.parser.getDependency("buffer",n.buffer),s=this.parser.options.meshoptDecoder;if(!s||!s.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return Promise.all([i,s.ready]).then(function(a){let c=n.byteOffset||0,l=n.byteLength||0,u=n.count,p=n.byteStride,d=new ArrayBuffer(u*p),h=new Uint8Array(a[0],c,l);return s.decodeGltfBuffer(new Uint8Array(d),u,p,h,n.mode,n.filter),d})}else return null}},mV="glTF",Nm=12,JU={JSON:1313821514,BIN:5130562},_V=class{constructor(e){this.name=Ct.KHR_BINARY_GLTF,this.content=null,this.body=null;let t=new DataView(e,0,Nm);if(this.header={magic:Ei.decodeText(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==mV)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");let r=this.header.length-Nm,n=new DataView(e,Nm),i=0;for(;i<r;){let s=n.getUint32(i,!0);i+=4;let a=n.getUint32(i,!0);if(i+=4,a===JU.JSON){let c=new Uint8Array(e,Nm+i,s);this.content=Ei.decodeText(c)}else if(a===JU.BIN){let c=Nm+i;this.body=e.slice(c,c+s)}i+=s}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}},gV=class{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=Ct.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){let r=this.json,n=this.dracoLoader,i=e.extensions[this.name].bufferView,s=e.extensions[this.name].attributes,a={},c={},l={};for(let u in s){let p=Fy[u]||u.toLowerCase();a[p]=s[u]}for(let u in e.attributes){let p=Fy[u]||u.toLowerCase();if(s[u]!==void 0){let d=r.accessors[e.attributes[u]],h=Pm[d.componentType];l[p]=h,c[p]=d.normalized===!0}}return t.getDependency("bufferView",i).then(function(u){return new Promise(function(p){n.decodeDracoFile(u,function(d){for(let h in d.attributes){let m=d.attributes[h],f=c[h];f!==void 0&&(m.normalized=f)}p(d)},a,l)})})}},vV=class{constructor(){this.name=Ct.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return t.texCoord!==void 0&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),t.offset===void 0&&t.rotation===void 0&&t.scale===void 0||(e=e.clone(),t.offset!==void 0&&e.offset.fromArray(t.offset),t.rotation!==void 0&&(e.rotation=t.rotation),t.scale!==void 0&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}},l3=class extends In{constructor(e){super();this.isGLTFSpecularGlossinessMaterial=!0;let t=["#ifdef USE_SPECULARMAP","	uniform sampler2D specularMap;","#endif"].join(`
`),r=["#ifdef USE_GLOSSINESSMAP","	uniform sampler2D glossinessMap;","#endif"].join(`
`),n=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","	vec4 texelSpecular = texture2D( specularMap, vUv );","	// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","	specularFactor *= texelSpecular.rgb;","#endif"].join(`
`),i=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","	vec4 texelGlossiness = texture2D( glossinessMap, vUv );","	// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","	glossinessFactor *= texelGlossiness.a;","#endif"].join(`
`),s=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb * ( 1. - max( specularFactor.r, max( specularFactor.g, specularFactor.b ) ) );","vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );","material.roughness = max( 1.0 - glossinessFactor, 0.0525 ); // 0.0525 corresponds to the base mip of a 256 cubemap.","material.roughness += geometryRoughness;","material.roughness = min( material.roughness, 1.0 );","material.specularColor = specularFactor;"].join(`
`),a={specular:{value:new de().setHex(16777215)},glossiness:{value:1},specularMap:{value:null},glossinessMap:{value:null}};this._extraUniforms=a,this.onBeforeCompile=function(c){for(let l in a)c.uniforms[l]=a[l];c.fragmentShader=c.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;").replace("uniform float metalness;","uniform float glossiness;").replace("#include <roughnessmap_pars_fragment>",t).replace("#include <metalnessmap_pars_fragment>",r).replace("#include <roughnessmap_fragment>",n).replace("#include <metalnessmap_fragment>",i).replace("#include <lights_physical_fragment>",s)},Object.defineProperties(this,{specular:{get:function(){return a.specular.value},set:function(c){a.specular.value=c}},specularMap:{get:function(){return a.specularMap.value},set:function(c){a.specularMap.value=c,c?this.defines.USE_SPECULARMAP="":delete this.defines.USE_SPECULARMAP}},glossiness:{get:function(){return a.glossiness.value},set:function(c){a.glossiness.value=c}},glossinessMap:{get:function(){return a.glossinessMap.value},set:function(c){a.glossinessMap.value=c,c?(this.defines.USE_GLOSSINESSMAP="",this.defines.USE_UV=""):(delete this.defines.USE_GLOSSINESSMAP,delete this.defines.USE_UV)}}}),delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this.setValues(e)}copy(e){return super.copy(e),this.specularMap=e.specularMap,this.specular.copy(e.specular),this.glossinessMap=e.glossinessMap,this.glossiness=e.glossiness,delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this}},yV=class{constructor(){this.name=Ct.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,this.specularGlossinessParams=["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","normalMapType","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity","refractionRatio"]}getMaterialType(){return l3}extendParams(e,t,r){let n=t.extensions[this.name];e.color=new de(1,1,1),e.opacity=1;let i=[];if(Array.isArray(n.diffuseFactor)){let s=n.diffuseFactor;e.color.fromArray(s),e.opacity=s[3]}if(n.diffuseTexture!==void 0&&i.push(r.assignTexture(e,"map",n.diffuseTexture)),e.emissive=new de(0,0,0),e.glossiness=n.glossinessFactor!==void 0?n.glossinessFactor:1,e.specular=new de(1,1,1),Array.isArray(n.specularFactor)&&e.specular.fromArray(n.specularFactor),n.specularGlossinessTexture!==void 0){let s=n.specularGlossinessTexture;i.push(r.assignTexture(e,"glossinessMap",s)),i.push(r.assignTexture(e,"specularMap",s))}return Promise.all(i)}createMaterial(e){let t=new l3(e);return t.fog=!0,t.color=e.color,t.map=e.map===void 0?null:e.map,t.lightMap=null,t.lightMapIntensity=1,t.aoMap=e.aoMap===void 0?null:e.aoMap,t.aoMapIntensity=1,t.emissive=e.emissive,t.emissiveIntensity=1,t.emissiveMap=e.emissiveMap===void 0?null:e.emissiveMap,t.bumpMap=e.bumpMap===void 0?null:e.bumpMap,t.bumpScale=1,t.normalMap=e.normalMap===void 0?null:e.normalMap,t.normalMapType=hn,e.normalScale&&(t.normalScale=e.normalScale),t.displacementMap=null,t.displacementScale=1,t.displacementBias=0,t.specularMap=e.specularMap===void 0?null:e.specularMap,t.specular=e.specular,t.glossinessMap=e.glossinessMap===void 0?null:e.glossinessMap,t.glossiness=e.glossiness,t.alphaMap=null,t.envMap=e.envMap===void 0?null:e.envMap,t.envMapIntensity=1,t.refractionRatio=.98,t}},xV=class{constructor(){this.name=Ct.KHR_MESH_QUANTIZATION}},ac=class extends $o{constructor(e,t,r,n){super(e,t,r,n)}copySampleValue_(e){let t=this.resultBuffer,r=this.sampleValues,n=this.valueSize,i=e*n*3+n;for(let s=0;s!==n;s++)t[s]=r[i+s];return t}};ac.prototype.beforeStart_=ac.prototype.copySampleValue_;ac.prototype.afterEnd_=ac.prototype.copySampleValue_;ac.prototype.interpolate_=function(o,e,t,r){let n=this.resultBuffer,i=this.sampleValues,s=this.valueSize,a=s*2,c=s*3,l=r-e,u=(t-e)/l,p=u*u,d=p*u,h=o*c,m=h-c,f=-2*d+3*p,v=d-p,g=1-f,_=v-p+u;for(let T=0;T!==s;T++){let b=i[m+T+s],x=i[m+T+a]*l,A=i[h+T+s],E=i[h+T]*l;n[T]=g*b+_*x+f*A+v*E}return n};var use=new It,bV=class extends ac{interpolate_(e,t,r,n){let i=super.interpolate_(e,t,r,n);return use.fromArray(i).normalize().toArray(i),i}},V0={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},Pm={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},ZU={9728:it,9729:lt,9984:vc,9985:uu,9986:yc,9987:Ri},QU={33071:Ft,33648:j0,10497:Zn},eV={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Fy={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},sc={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},pse={CUBICSPLINE:void 0,LINEAR:a0,STEP:s0},By={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function dse(o){return o.DefaultMaterial===void 0&&(o.DefaultMaterial=new In({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:gr})),o.DefaultMaterial}function Om(o,e,t){for(let r in t.extensions)o[r]===void 0&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[r]=t.extensions[r])}function Wl(o,e){e.extras!==void 0&&(typeof e.extras=="object"?Object.assign(o.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function hse(o,e,t){let r=!1,n=!1;for(let a=0,c=e.length;a<c;a++){let l=e[a];if(l.POSITION!==void 0&&(r=!0),l.NORMAL!==void 0&&(n=!0),r&&n)break}if(!r&&!n)return Promise.resolve(o);let i=[],s=[];for(let a=0,c=e.length;a<c;a++){let l=e[a];if(r){let u=l.POSITION!==void 0?t.getDependency("accessor",l.POSITION):o.attributes.position;i.push(u)}if(n){let u=l.NORMAL!==void 0?t.getDependency("accessor",l.NORMAL):o.attributes.normal;s.push(u)}}return Promise.all([Promise.all(i),Promise.all(s)]).then(function(a){let c=a[0],l=a[1];return r&&(o.morphAttributes.position=c),n&&(o.morphAttributes.normal=l),o.morphTargetsRelative=!0,o})}function fse(o,e){if(o.updateMorphTargets(),e.weights!==void 0)for(let t=0,r=e.weights.length;t<r;t++)o.morphTargetInfluences[t]=e.weights[t];if(e.extras&&Array.isArray(e.extras.targetNames)){let t=e.extras.targetNames;if(o.morphTargetInfluences.length===t.length){o.morphTargetDictionary={};for(let r=0,n=t.length;r<n;r++)o.morphTargetDictionary[t[r]]=r}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function mse(o){let e=o.extensions&&o.extensions[Ct.KHR_DRACO_MESH_COMPRESSION],t;return e?t="draco:"+e.bufferView+":"+e.indices+":"+tV(e.attributes):t=o.indices+":"+tV(o.attributes)+":"+o.mode,t}function tV(o){let e="",t=Object.keys(o).sort();for(let r=0,n=t.length;r<n;r++)e+=t[r]+":"+o[t[r]]+";";return e}function Uy(o){switch(o){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}var TV=class{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new lse,this.associations=new Map,this.primitiveCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.textureCache={},this.nodeNamesUsed={},typeof createImageBitmap!="undefined"&&/Firefox|^((?!chrome|android).)*safari/i.test(navigator.userAgent)===!1?this.textureLoader=new c3(this.options.manager):this.textureLoader=new Rf(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new Xo(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){let r=this,n=this.json,i=this.extensions;this.cache.removeAll(),this._invokeAll(function(s){return s._markDefs&&s._markDefs()}),Promise.all(this._invokeAll(function(s){return s.beforeRoot&&s.beforeRoot()})).then(function(){return Promise.all([r.getDependencies("scene"),r.getDependencies("animation"),r.getDependencies("camera")])}).then(function(s){let a={scene:s[0][n.scene||0],scenes:s[0],animations:s[1],cameras:s[2],asset:n.asset,parser:r,userData:{}};Om(i,a,n),Wl(a,n),Promise.all(r._invokeAll(function(c){return c.afterRoot&&c.afterRoot(a)})).then(function(){e(a)})}).catch(t)}_markDefs(){let e=this.json.nodes||[],t=this.json.skins||[],r=this.json.meshes||[];for(let n=0,i=t.length;n<i;n++){let s=t[n].joints;for(let a=0,c=s.length;a<c;a++)e[s[a]].isBone=!0}for(let n=0,i=e.length;n<i;n++){let s=e[n];s.mesh!==void 0&&(this._addNodeRef(this.meshCache,s.mesh),s.skin!==void 0&&(r[s.mesh].isSkinnedMesh=!0)),s.camera!==void 0&&this._addNodeRef(this.cameraCache,s.camera)}}_addNodeRef(e,t){t!==void 0&&(e.refs[t]===void 0&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,r){if(e.refs[t]<=1)return r;let n=r.clone(),i=(s,a)=>{let c=this.associations.get(s);c!=null&&this.associations.set(a,c);for(let[l,u]of s.children.entries())i(u,a.children[l])};return i(r,n),n.name+="_instance_"+e.uses[t]++,n}_invokeOne(e){let t=Object.values(this.plugins);t.push(this);for(let r=0;r<t.length;r++){let n=e(t[r]);if(n)return n}return null}_invokeAll(e){let t=Object.values(this.plugins);t.unshift(this);let r=[];for(let n=0;n<t.length;n++){let i=e(t[n]);i&&r.push(i)}return r}getDependency(e,t){let r=e+":"+t,n=this.cache.get(r);if(!n){switch(e){case"scene":n=this.loadScene(t);break;case"node":n=this.loadNode(t);break;case"mesh":n=this._invokeOne(function(i){return i.loadMesh&&i.loadMesh(t)});break;case"accessor":n=this.loadAccessor(t);break;case"bufferView":n=this._invokeOne(function(i){return i.loadBufferView&&i.loadBufferView(t)});break;case"buffer":n=this.loadBuffer(t);break;case"material":n=this._invokeOne(function(i){return i.loadMaterial&&i.loadMaterial(t)});break;case"texture":n=this._invokeOne(function(i){return i.loadTexture&&i.loadTexture(t)});break;case"skin":n=this.loadSkin(t);break;case"animation":n=this.loadAnimation(t);break;case"camera":n=this.loadCamera(t);break;default:throw new Error("Unknown type: "+e)}this.cache.add(r,n)}return n}getDependencies(e){let t=this.cache.get(e);if(!t){let r=this,n=this.json[e+(e==="mesh"?"es":"s")]||[];t=Promise.all(n.map(function(i,s){return r.getDependency(e,s)})),this.cache.add(e,t)}return t}loadBuffer(e){let t=this.json.buffers[e],r=this.fileLoader;if(t.type&&t.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(t.uri===void 0&&e===0)return Promise.resolve(this.extensions[Ct.KHR_BINARY_GLTF].body);let n=this.options;return new Promise(function(i,s){r.load(Ei.resolveURL(t.uri,n.path),i,void 0,function(){s(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){let t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(r){let n=t.byteLength||0,i=t.byteOffset||0;return r.slice(i,i+n)})}loadAccessor(e){let t=this,r=this.json,n=this.json.accessors[e];if(n.bufferView===void 0&&n.sparse===void 0)return Promise.resolve(null);let i=[];return n.bufferView!==void 0?i.push(this.getDependency("bufferView",n.bufferView)):i.push(null),n.sparse!==void 0&&(i.push(this.getDependency("bufferView",n.sparse.indices.bufferView)),i.push(this.getDependency("bufferView",n.sparse.values.bufferView))),Promise.all(i).then(function(s){let a=s[0],c=eV[n.type],l=Pm[n.componentType],u=l.BYTES_PER_ELEMENT,p=u*c,d=n.byteOffset||0,h=n.bufferView!==void 0?r.bufferViews[n.bufferView].byteStride:void 0,m=n.normalized===!0,f,v;if(h&&h!==p){let g=Math.floor(d/h),_="InterleavedBuffer:"+n.bufferView+":"+n.componentType+":"+g+":"+n.count,T=t.cache.get(_);T||(f=new l(a,g*h,n.count*h/u),T=new h0(f,h/u),t.cache.add(_,T)),v=new Dn(T,c,d%h/u,m)}else a===null?f=new l(n.count*c):f=new l(a,d,n.count*c),v=new Tt(f,c,m);if(n.sparse!==void 0){let g=eV.SCALAR,_=Pm[n.sparse.indices.componentType],T=n.sparse.indices.byteOffset||0,b=n.sparse.values.byteOffset||0,x=new _(s[1],T,n.sparse.count*g),A=new l(s[2],b,n.sparse.count*c);a!==null&&(v=new Tt(v.array.slice(),v.itemSize,v.normalized));for(let E=0,S=x.length;E<S;E++){let w=x[E];if(v.setX(w,A[E*c]),c>=2&&v.setY(w,A[E*c+1]),c>=3&&v.setZ(w,A[E*c+2]),c>=4&&v.setW(w,A[E*c+3]),c>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return v})}loadTexture(e){let t=this.json,r=this.options,n=t.textures[e],i=t.images[n.source],s=this.textureLoader;if(i.uri){let a=r.manager.getHandler(i.uri);a!==null&&(s=a)}return this.loadTextureImage(e,i,s)}loadTextureImage(e,t,r){let n=this,i=this.json,s=this.options,a=i.textures[e],c=(t.uri||t.bufferView)+":"+a.sampler;if(this.textureCache[c])return this.textureCache[c];let l=self.URL||self.webkitURL,u=t.uri||"",p=!1;if(t.bufferView!==void 0)u=n.getDependency("bufferView",t.bufferView).then(function(h){p=!0;let m=new Blob([h],{type:t.mimeType});return u=l.createObjectURL(m),u});else if(t.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");let d=Promise.resolve(u).then(function(h){return new Promise(function(m,f){let v=m;r.isImageBitmapLoader===!0&&(v=function(g){let _=new vr(g);_.needsUpdate=!0,m(_)}),r.load(Ei.resolveURL(h,s.path),v,void 0,f)})}).then(function(h){p===!0&&l.revokeObjectURL(u),h.flipY=!1,a.name&&(h.name=a.name);let f=(i.samplers||{})[a.sampler]||{};return h.magFilter=ZU[f.magFilter]||lt,h.minFilter=ZU[f.minFilter]||Ri,h.wrapS=QU[f.wrapS]||Zn,h.wrapT=QU[f.wrapT]||Zn,n.associations.set(h,{textures:e}),h}).catch(function(){return console.error("THREE.GLTFLoader: Couldn't load texture",u),null});return this.textureCache[c]=d,d}assignTexture(e,t,r){let n=this;return this.getDependency("texture",r.index).then(function(i){if(r.texCoord!==void 0&&r.texCoord!=0&&!(t==="aoMap"&&r.texCoord==1)&&console.warn("THREE.GLTFLoader: Custom UV set "+r.texCoord+" for texture "+t+" not yet supported."),n.extensions[Ct.KHR_TEXTURE_TRANSFORM]){let s=r.extensions!==void 0?r.extensions[Ct.KHR_TEXTURE_TRANSFORM]:void 0;if(s){let a=n.associations.get(i);i=n.extensions[Ct.KHR_TEXTURE_TRANSFORM].extendTexture(i,s),n.associations.set(i,a)}}return e[t]=i,i})}assignFinalMaterial(e){let t=e.geometry,r=e.material,n=t.attributes.tangent===void 0,i=t.attributes.color!==void 0,s=t.attributes.normal===void 0;if(e.isPoints){let a="PointsMaterial:"+r.uuid,c=this.cache.get(a);c||(c=new c0,Ut.prototype.copy.call(c,r),c.color.copy(r.color),c.map=r.map,c.sizeAttenuation=!1,this.cache.add(a,c)),r=c}else if(e.isLine){let a="LineBasicMaterial:"+r.uuid,c=this.cache.get(a);c||(c=new ir,Ut.prototype.copy.call(c,r),c.color.copy(r.color),this.cache.add(a,c)),r=c}if(n||i||s){let a="ClonedMaterial:"+r.uuid+":";r.isGLTFSpecularGlossinessMaterial&&(a+="specular-glossiness:"),n&&(a+="derivative-tangents:"),i&&(a+="vertex-colors:"),s&&(a+="flat-shading:");let c=this.cache.get(a);c||(c=r.clone(),i&&(c.vertexColors=!0),s&&(c.flatShading=!0),n&&(c.normalScale&&(c.normalScale.y*=-1),c.clearcoatNormalScale&&(c.clearcoatNormalScale.y*=-1)),this.cache.add(a,c),this.associations.set(c,this.associations.get(r))),r=c}r.aoMap&&t.attributes.uv2===void 0&&t.attributes.uv!==void 0&&t.setAttribute("uv2",t.attributes.uv),e.material=r}getMaterialType(){return In}loadMaterial(e){let t=this,r=this.json,n=this.extensions,i=r.materials[e],s,a={},c=i.extensions||{},l=[];if(c[Ct.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){let p=n[Ct.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];s=p.getMaterialType(),l.push(p.extendParams(a,i,t))}else if(c[Ct.KHR_MATERIALS_UNLIT]){let p=n[Ct.KHR_MATERIALS_UNLIT];s=p.getMaterialType(),l.push(p.extendParams(a,i,t))}else{let p=i.pbrMetallicRoughness||{};if(a.color=new de(1,1,1),a.opacity=1,Array.isArray(p.baseColorFactor)){let d=p.baseColorFactor;a.color.fromArray(d),a.opacity=d[3]}p.baseColorTexture!==void 0&&l.push(t.assignTexture(a,"map",p.baseColorTexture)),a.metalness=p.metallicFactor!==void 0?p.metallicFactor:1,a.roughness=p.roughnessFactor!==void 0?p.roughnessFactor:1,p.metallicRoughnessTexture!==void 0&&(l.push(t.assignTexture(a,"metalnessMap",p.metallicRoughnessTexture)),l.push(t.assignTexture(a,"roughnessMap",p.metallicRoughnessTexture))),s=this._invokeOne(function(d){return d.getMaterialType&&d.getMaterialType(e)}),l.push(Promise.all(this._invokeAll(function(d){return d.extendMaterialParams&&d.extendMaterialParams(e,a)})))}i.doubleSided===!0&&(a.side=Wr);let u=i.alphaMode||By.OPAQUE;if(u===By.BLEND?(a.transparent=!0,a.depthWrite=!1):(a.transparent=!1,u===By.MASK&&(a.alphaTest=i.alphaCutoff!==void 0?i.alphaCutoff:.5)),i.normalTexture!==void 0&&s!==_n&&(l.push(t.assignTexture(a,"normalMap",i.normalTexture)),a.normalScale=new z(1,1),i.normalTexture.scale!==void 0)){let p=i.normalTexture.scale;a.normalScale.set(p,p)}return i.occlusionTexture!==void 0&&s!==_n&&(l.push(t.assignTexture(a,"aoMap",i.occlusionTexture)),i.occlusionTexture.strength!==void 0&&(a.aoMapIntensity=i.occlusionTexture.strength)),i.emissiveFactor!==void 0&&s!==_n&&(a.emissive=new de().fromArray(i.emissiveFactor)),i.emissiveTexture!==void 0&&s!==_n&&l.push(t.assignTexture(a,"emissiveMap",i.emissiveTexture)),Promise.all(l).then(function(){let p;return s===l3?p=n[Ct.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(a):p=new s(a),i.name&&(p.name=i.name),p.map&&(p.map.encoding=bt),p.emissiveMap&&(p.emissiveMap.encoding=bt),Wl(p,i),t.associations.set(p,{materials:e}),i.extensions&&Om(n,p,i),p})}createUniqueName(e){let t=Ht.sanitizeNodeName(e||""),r=t;for(let n=1;this.nodeNamesUsed[r];++n)r=t+"_"+n;return this.nodeNamesUsed[r]=!0,r}loadGeometries(e){let t=this,r=this.extensions,n=this.primitiveCache;function i(a){return r[Ct.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(a,t).then(function(c){return rV(c,a,t)})}let s=[];for(let a=0,c=e.length;a<c;a++){let l=e[a],u=mse(l),p=n[u];if(p)s.push(p.promise);else{let d;l.extensions&&l.extensions[Ct.KHR_DRACO_MESH_COMPRESSION]?d=i(l):d=rV(new Re,l,t),n[u]={primitive:l,promise:d},s.push(d)}}return Promise.all(s)}loadMesh(e){let t=this,r=this.json,n=this.extensions,i=r.meshes[e],s=i.primitives,a=[];for(let c=0,l=s.length;c<l;c++){let u=s[c].material===void 0?dse(this.cache):this.getDependency("material",s[c].material);a.push(u)}return a.push(t.loadGeometries(s)),Promise.all(a).then(function(c){let l=c.slice(0,c.length-1),u=c[c.length-1],p=[];for(let h=0,m=u.length;h<m;h++){let f=u[h],v=s[h],g,_=l[h];if(v.mode===V0.TRIANGLES||v.mode===V0.TRIANGLE_STRIP||v.mode===V0.TRIANGLE_FAN||v.mode===void 0)g=i.isSkinnedMesh===!0?new ra(f,_):new ct(f,_),g.isSkinnedMesh===!0&&!g.geometry.attributes.skinWeight.normalized&&g.normalizeSkinWeights(),v.mode===V0.TRIANGLE_STRIP?g.geometry=oV(g.geometry,ob):v.mode===V0.TRIANGLE_FAN&&(g.geometry=oV(g.geometry,$3));else if(v.mode===V0.LINES)g=new Gr(f,_);else if(v.mode===V0.LINE_STRIP)g=new bs(f,_);else if(v.mode===V0.LINE_LOOP)g=new Ed(f,_);else if(v.mode===V0.POINTS)g=new ri(f,_);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+v.mode);Object.keys(g.geometry.morphAttributes).length>0&&fse(g,i),g.name=t.createUniqueName(i.name||"mesh_"+e),Wl(g,i),v.extensions&&Om(n,g,v),t.assignFinalMaterial(g),p.push(g)}for(let h=0,m=p.length;h<m;h++)t.associations.set(p[h],{meshes:e,primitives:h});if(p.length===1)return p[0];let d=new st;t.associations.set(d,{meshes:e});for(let h=0,m=p.length;h<m;h++)d.add(p[h]);return d})}loadCamera(e){let t,r=this.json.cameras[e],n=r[r.type];if(!n){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return r.type==="perspective"?t=new sr(Wd(n.yfov),n.aspectRatio||1,n.znear||1,n.zfar||2e6):r.type==="orthographic"&&(t=new Cs(-n.xmag,n.xmag,n.ymag,-n.ymag,n.znear,n.zfar)),r.name&&(t.name=this.createUniqueName(r.name)),Wl(t,r),Promise.resolve(t)}loadSkin(e){let t=this.json.skins[e],r={joints:t.joints};return t.inverseBindMatrices===void 0?Promise.resolve(r):this.getDependency("accessor",t.inverseBindMatrices).then(function(n){return r.inverseBindMatrices=n,r})}loadAnimation(e){let r=this.json.animations[e],n=[],i=[],s=[],a=[],c=[];for(let l=0,u=r.channels.length;l<u;l++){let p=r.channels[l],d=r.samplers[p.sampler],h=p.target,m=h.node!==void 0?h.node:h.id,f=r.parameters!==void 0?r.parameters[d.input]:d.input,v=r.parameters!==void 0?r.parameters[d.output]:d.output;n.push(this.getDependency("node",m)),i.push(this.getDependency("accessor",f)),s.push(this.getDependency("accessor",v)),a.push(d),c.push(h)}return Promise.all([Promise.all(n),Promise.all(i),Promise.all(s),Promise.all(a),Promise.all(c)]).then(function(l){let u=l[0],p=l[1],d=l[2],h=l[3],m=l[4],f=[];for(let g=0,_=u.length;g<_;g++){let T=u[g],b=p[g],x=d[g],A=h[g],E=m[g];if(T===void 0)continue;T.updateMatrix(),T.matrixAutoUpdate=!0;let S;switch(sc[E.path]){case sc.weights:S=rc;break;case sc.rotation:S=Qs;break;case sc.position:case sc.scale:default:S=nc;break}let w=T.name?T.name:T.uuid,O=A.interpolation!==void 0?pse[A.interpolation]:a0,C=[];sc[E.path]===sc.weights?T.traverse(function(R){R.morphTargetInfluences&&C.push(R.name?R.name:R.uuid)}):C.push(w);let N=x.array;if(x.normalized){let R=Uy(N.constructor),D=new Float32Array(N.length);for(let V=0,F=N.length;V<F;V++)D[V]=N[V]*R;N=D}for(let R=0,D=C.length;R<D;R++){let V=new S(C[R]+"."+sc[E.path],b.array,N,O);A.interpolation==="CUBICSPLINE"&&(V.createInterpolant=function(j){let $=this instanceof Qs?bV:ac;return new $(this.times,this.values,this.getValueSize()/3,j)},V.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),f.push(V)}}let v=r.name?r.name:"animation_"+e;return new Em(v,void 0,f)})}createNodeMesh(e){let t=this.json,r=this,n=t.nodes[e];return n.mesh===void 0?null:r.getDependency("mesh",n.mesh).then(function(i){let s=r._getNodeRef(r.meshCache,n.mesh,i);return n.weights!==void 0&&s.traverse(function(a){if(!!a.isMesh)for(let c=0,l=n.weights.length;c<l;c++)a.morphTargetInfluences[c]=n.weights[c]}),s})}loadNode(e){let t=this.json,r=this.extensions,n=this,i=t.nodes[e],s=i.name?n.createUniqueName(i.name):"";return function(){let a=[],c=n._invokeOne(function(l){return l.createNodeMesh&&l.createNodeMesh(e)});return c&&a.push(c),i.camera!==void 0&&a.push(n.getDependency("camera",i.camera).then(function(l){return n._getNodeRef(n.cameraCache,i.camera,l)})),n._invokeAll(function(l){return l.createNodeAttachment&&l.createNodeAttachment(e)}).forEach(function(l){a.push(l)}),Promise.all(a)}().then(function(a){let c;if(i.isBone===!0?c=new ws:a.length>1?c=new st:a.length===1?c=a[0]:c=new vt,c!==a[0])for(let l=0,u=a.length;l<u;l++)c.add(a[l]);if(i.name&&(c.userData.name=i.name,c.name=s),Wl(c,i),i.extensions&&Om(r,c,i),i.matrix!==void 0){let l=new Ue;l.fromArray(i.matrix),c.applyMatrix4(l)}else i.translation!==void 0&&c.position.fromArray(i.translation),i.rotation!==void 0&&c.quaternion.fromArray(i.rotation),i.scale!==void 0&&c.scale.fromArray(i.scale);return n.associations.has(c)||n.associations.set(c,{}),n.associations.get(c).nodes=e,c})}loadScene(e){let t=this.json,r=this.extensions,n=this.json.scenes[e],i=this,s=new st;n.name&&(s.name=i.createUniqueName(n.name)),Wl(s,n),n.extensions&&Om(r,s,n);let a=n.nodes||[],c=[];for(let l=0,u=a.length;l<u;l++)c.push(AV(a[l],s,t,i));return Promise.all(c).then(function(){let l=u=>{let p=new Map;for(let[d,h]of i.associations)(d instanceof Ut||d instanceof vr)&&p.set(d,h);return u.traverse(d=>{let h=i.associations.get(d);h!=null&&p.set(d,h)}),p};return i.associations=l(s),s})}};function AV(o,e,t,r){let n=t.nodes[o];return r.getDependency("node",o).then(function(i){if(n.skin===void 0)return i;let s;return r.getDependency("skin",n.skin).then(function(a){s=a;let c=[];for(let l=0,u=s.joints.length;l<u;l++)c.push(r.getDependency("node",s.joints[l]));return Promise.all(c)}).then(function(a){return i.traverse(function(c){if(!c.isMesh)return;let l=[],u=[];for(let p=0,d=a.length;p<d;p++){let h=a[p];if(h){l.push(h);let m=new Ue;s.inverseBindMatrices!==void 0&&m.fromArray(s.inverseBindMatrices.array,p*16),u.push(m)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',s.joints[p])}c.bind(new Ul(l,u),c.matrixWorld)}),i})}).then(function(i){e.add(i);let s=[];if(n.children){let a=n.children;for(let c=0,l=a.length;c<l;c++){let u=a[c];s.push(AV(u,i,t,r))}}return Promise.all(s)})}function _se(o,e,t){let r=e.attributes,n=new fn;if(r.POSITION!==void 0){let a=t.json.accessors[r.POSITION],c=a.min,l=a.max;if(c!==void 0&&l!==void 0){if(n.set(new M(c[0],c[1],c[2]),new M(l[0],l[1],l[2])),a.normalized){let u=Uy(Pm[a.componentType]);n.min.multiplyScalar(u),n.max.multiplyScalar(u)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;let i=e.targets;if(i!==void 0){let a=new M,c=new M;for(let l=0,u=i.length;l<u;l++){let p=i[l];if(p.POSITION!==void 0){let d=t.json.accessors[p.POSITION],h=d.min,m=d.max;if(h!==void 0&&m!==void 0){if(c.setX(Math.max(Math.abs(h[0]),Math.abs(m[0]))),c.setY(Math.max(Math.abs(h[1]),Math.abs(m[1]))),c.setZ(Math.max(Math.abs(h[2]),Math.abs(m[2]))),d.normalized){let f=Uy(Pm[d.componentType]);c.multiplyScalar(f)}a.max(c)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}n.expandByVector(a)}o.boundingBox=n;let s=new X0;n.getCenter(s.center),s.radius=n.min.distanceTo(n.max)/2,o.boundingSphere=s}function rV(o,e,t){let r=e.attributes,n=[];function i(s,a){return t.getDependency("accessor",s).then(function(c){o.setAttribute(a,c)})}for(let s in r){let a=Fy[s]||s.toLowerCase();a in o.attributes||n.push(i(r[s],a))}if(e.indices!==void 0&&!o.index){let s=t.getDependency("accessor",e.indices).then(function(a){o.setIndex(a)});n.push(s)}return Wl(o,e),_se(o,e,t),Promise.all(n).then(function(){return e.targets!==void 0?hse(o,e.targets,t):o})}function oV(o,e){let t=o.getIndex();if(t===null){let s=[],a=o.getAttribute("position");if(a!==void 0){for(let c=0;c<a.count;c++)s.push(c);o.setIndex(s),t=o.getIndex()}else return console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),o}let r=t.count-2,n=[];if(e===$3)for(let s=1;s<=r;s++)n.push(t.getX(0)),n.push(t.getX(s)),n.push(t.getX(s+1));else for(let s=0;s<r;s++)s%2===0?(n.push(t.getX(s)),n.push(t.getX(s+1)),n.push(t.getX(s+2))):(n.push(t.getX(s+2)),n.push(t.getX(s+1)),n.push(t.getX(s)));n.length/3!==r&&console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");let i=o.clone();return i.setIndex(n),i}var cc=class extends Go{static reset(){this.gltfLoader=void 0,this.gltfdracoLoader=void 0,this.dracoLoader=void 0}async load(e){let t=await(e.draco?cc.GLTFDRACOLoader(e.node):cc.GLTFLoader(e.node));if(!t)return;let r=await this._urlToLoad();return new Promise(n=>{t.load(r,i=>{let s=cc.onLoadSuccessGLTF(i);n(s)},i=>{},i=>{var s;(s=e.node)==null||s.states.error.set(i.message)})})}static onLoadSuccessGLTF(e){let t=e.scene||e.scenes[0];return t.animations=e.animations,[t]}static async GLTFLoader(e){let t=Q.modulesRegister.module(pt.GLTFLoader);if(t)return this.gltfLoader=this.gltfLoader||new t(ed)}static async GLTFDRACOLoader(e){if(Q.modulesRegister.module(pt.GLTFLoader))return this.gltfdracoLoader=this.gltfdracoLoader||await this.createGLTFLoaderWithDRACO({useJS:!1},e)}static async createGLTFLoaderWithDRACO(e,t){let r=new Vy(ed);return await this.setupDRACO(r,e,t),r}static async setupDRACO(e,t,r){Q.modulesRegister.module(pt.DRACOLoader)&&(this.dracoLoader=this.dracoLoader||await this._createDRACOLoader(t,r),e.setDRACOLoader(this.dracoLoader))}static async _createDRACOLoader(e,t){let r=new Ly(ed),n=Q.libs.root(),i=Q.libs.DRACOGLTFPath();if(n||i){let s=`${n||""}${i||""}/`,a=e.useJS?["draco_decoder.js"]:["draco_decoder.wasm","draco_wasm_wrapper.js"];await this._loadMultipleBlobGlobal({files:a.map(c=>({fullUrl:`${s}${c}`})),node:t,error:"failed to load draco libraries. Make sure to install them to load .glb files"}),r.setDecoderPath(s)}else r.setDecoderPath(void 0);return r.setDecoderConfig({type:e.useJS?"js":"wasm"}),r.preload(),r}};var Gy=(o=>(o.AUTO="auto",o.DRC="drc",o.FBX="fbx",o.JSON="json",o.GLTF="gltf",o.GLTF_WITH_DRACO="gltf_with_draco",o.LDRAW="ldraw",o.OBJ="obj",o.PDB="pdb",o.PLY="ply",o.STL="stl",o))(Gy||{}),CV=["auto","drc","fbx","json","gltf","gltf_with_draco","ldraw","obj","pdb","ply","stl"];var Mo=class extends Go{constructor(o,e,t){super(o.url,e,t);this._options=o,this._scene=e,this._node=t}load(o,e){this._load().then(t=>{o(t)}).catch(t=>{e(t)})}_load(){return this._node&&Q.blobs.clearBlobsForNode(this._node),new Promise(async(o,e)=>{let t=await this._urlToLoad(),r=this.extension();if(r=="json"&&this._options.format=="auto")Mo.incrementInProgressLoadsCount(),await Mo.waitForMaxConcurrentLoadsQueueFreed(),fetch(t).then(async n=>{let i=await n.json();new Ry(this.loadingManager).parse(i,a=>{Mo.decrementInProgressLoadsCount(),o(this._onLoadSuccess(a.children[0]))})}).catch(n=>{Mo.decrementInProgressLoadsCount(),e(n)});else{let n=await this._loaderForFormat();if(n)Mo.incrementInProgressLoadsCount(),await Mo.waitForMaxConcurrentLoadsQueueFreed(),n.load(t,i=>{this._onLoadSuccess(i).then(s=>{Mo.decrementInProgressLoadsCount(),o(s)})},void 0,i=>{Q.warn("error loading",t,i),Mo.decrementInProgressLoadsCount(),e(i)});else{let i=`format not supported (${r})`;e(i)}}})}async _onLoadSuccess(o){let e=this.extension();if(e=="json")return[o];let t=o;if(t.isObject3D)switch(e){case"pdb":return this._onLoadSuccessPDB(o);case"obj":return[t];case"mpd":return t.rotation.x=Math.PI,t.updateMatrix(),[t];default:return[t]}let r=o;if(r.isBufferGeometry)switch(e){case"drc":return this._onLoadSuccessDRC(r);default:return[new ct(r)]}let n=o;if(n.scene!=null||n.scenes!=null)switch(e){case"gltf":case"glb":return cc.onLoadSuccessGLTF(n);default:return[t]}let i=o;if(i.geometryAtoms||i.geometryBonds)switch(e){case"pdb":return this._onLoadSuccessPDB(i);default:return[]}return[]}_onLoadSuccessDRC(o){return[new ct(o,Mo._default_mat_mesh)]}_onLoadSuccessPDB(o){let e=new ri(o.geometryAtoms,Mo._default_mat_point),t=new Gr(o.geometryBonds,Mo._default_mat_line);return[e,t]}static moduleNamesFromFormat(o,e){switch(o){case"auto":return this.moduleNamesFromExt(e);case"drc":return[pt.DRACOLoader];case"fbx":return[pt.FBXLoader];case"json":return[];case"gltf":return[pt.GLTFLoader];case"gltf_with_draco":return[pt.GLTFLoader,pt.DRACOLoader];case"ldraw":return[pt.LDrawLoader];case"obj":return[pt.OBJLoader];case"pdb":return[pt.PDBLoader];case"ply":return[pt.PLYLoader];case"stl":return[pt.STLLoader]}Be.unreachable(o)}static moduleNamesFromExt(o){switch(o){case"drc":return[pt.DRACOLoader];case"fbx":return[pt.FBXLoader];case"gltf":return[pt.GLTFLoader];case"glb":return[pt.GLTFLoader,pt.DRACOLoader];case"obj":return[pt.OBJLoader];case"pdb":return[pt.PDBLoader];case"ply":return[pt.PLYLoader];case"stl":return[pt.STLLoader]}}async _loaderForFormat(){let o=this._options.format;switch(o){case"auto":return this._loaderForExt();case"drc":return this.loader_for_drc(this._node);case"fbx":return this.loader_for_fbx();case"json":return;case"gltf":return this.loader_for_gltf();case"gltf_with_draco":return this.loader_for_glb(this._node);case"ldraw":return this.loader_for_ldraw();case"obj":return this.loader_for_obj();case"pdb":return this.loader_for_pdb();case"ply":return this.loader_for_ply();case"stl":return this.loader_for_stl()}Be.unreachable(o)}async _loaderForExt(){switch(this.extension().toLowerCase()){case"drc":return this.loader_for_drc(this._node);case"fbx":return this.loader_for_fbx();case"gltf":return this.loader_for_gltf();case"glb":return this.loader_for_glb(this._node);case"mpd":return this.loader_for_ldraw();case"obj":return this.loader_for_obj();case"pdb":return this.loader_for_pdb();case"ply":return this.loader_for_ply();case"stl":return this.loader_for_stl()}}loader_for_fbx(){let o=Q.modulesRegister.module(pt.FBXLoader);if(o)return new o(this.loadingManager)}loader_for_gltf(){let o=Q.modulesRegister.module(pt.GLTFLoader);if(o)return new o(this.loadingManager)}static async loader_for_drc(o){let e=Q.modulesRegister.module(pt.DRACOLoader);if(e){let r=new e(this.loadingManager),n=Q.libs.root(),i=Q.libs.DRACOPath();if(n||i){let s=`${n||""}${i||""}/`;if(o){let a=["draco_decoder.js"];await this._loadMultipleBlobGlobal({files:a.map(c=>({storedUrl:`${s}/${c}`,fullUrl:`${s}${c}`})),node:o,error:"failed to load draco libraries. Make sure to install them to load .glb files"})}r.setDecoderPath(s)}else r.setDecoderPath(void 0);return r.setDecoderConfig({type:"js"}),r}}loader_for_drc(o){return Mo.loader_for_drc(o)}static loader_for_ldraw(o){let e=Q.modulesRegister.module(pt.LDrawLoader);if(e)return new e(this.loadingManager)}loader_for_ldraw(o){return Mo.loader_for_ldraw(o)}static async loader_for_glb(o){return await cc.GLTFDRACOLoader(o)}loader_for_glb(o){return Mo.loader_for_glb(o)}loader_for_obj(){let o=Q.modulesRegister.module(pt.OBJLoader);if(o)return new o(this.loadingManager)}loader_for_pdb(){let o=Q.modulesRegister.module(pt.PDBLoader);if(o)return new o(this.loadingManager)}loader_for_ply(){let o=Q.modulesRegister.module(pt.PLYLoader);if(o)return new o(this.loadingManager)}loader_for_stl(){let o=Q.modulesRegister.module(pt.STLLoader);if(o)return new o(this.loadingManager)}static setMaxConcurrentLoadsCount(o){this._maxConcurrentLoadsCountMethod=o}static _initMaxConcurrentLoadsCount(){return this._maxConcurrentLoadsCountMethod?this._maxConcurrentLoadsCountMethod():Un.isChrome()?4:1}static _initConcurrentLoadsDelay(){return Un.isChrome()?1:10}static incrementInProgressLoadsCount(){this._inProgressLoadsCount++}static decrementInProgressLoadsCount(){this._inProgressLoadsCount--;let o=this._queue.pop();if(o){let e=this.CONCURRENT_LOADS_DELAY;setTimeout(()=>{o()},e)}}static async waitForMaxConcurrentLoadsQueueFreed(){if(!(this._inProgressLoadsCount<=this.MAX_CONCURRENT_LOADS_COUNT))return new Promise(o=>{this._queue.push(o)})}},fs=Mo;fs._default_mat_mesh=new cd;fs._default_mat_point=new c0;fs._default_mat_line=new ir;fs.MAX_CONCURRENT_LOADS_COUNT=Mo._initMaxConcurrentLoadsCount();fs.CONCURRENT_LOADS_DELAY=Mo._initConcurrentLoadsDelay();fs._inProgressLoadsCount=0;fs._queue=[];var EV=class extends Ke{static type(){return"file"}static loader(o,e,t){return new fs({url:o.url,format:o.format},e,t)}cook(o,e){if(!this._node)return this.createCoreGroupFromObjects([]);let t=EV.loader(e,this.scene(),this._node);return new Promise(r=>{t.load(n=>{let i=this._onLoad(n,e);r(this.createCoreGroupFromObjects(i))},n=>{this._onError(n,e)})})}_onLoad(o,e){for(let t of o)t.traverse(r=>{this._ensureGeometryHasIndex(r),e.matrixAutoUpdate||r.updateMatrix(),r.matrixAutoUpdate=e.matrixAutoUpdate});return o}_onError(o,e){var t;(t=this.states)==null||t.error.set(`could not load geometry from ${e.url} (${o})`)}_ensureGeometryHasIndex(o){let t=o.geometry;t&&this.createIndexIfNone(t)}},u3=EV;u3.DEFAULT_PARAMS={url:`${If}/models/wolf.obj`,format:Gy.AUTO,matrixAutoUpdate:!1};var SV=u3.DEFAULT_PARAMS,wV=class extends U{constructor(){super(...arguments);this.url=y.STRING(SV.url,{fileBrowse:{type:[Oc.GEOMETRY]}}),this.format=y.STRING(SV.format,{menuString:{entries:CV.map(e=>({name:e,value:e}))}}),this.matrixAutoUpdate=y.BOOLEAN(0),this.reload=y.BUTTON(null,{callback:e=>{p3.PARAM_CALLBACK_reload(e)}})}},gse=new wV,p3=class extends Ye{constructor(){super(...arguments);this.paramsConfig=gse}static type(){return"file"}async requiredModules(){for(let r of[this.p.url,this.p.format])r.isDirty()&&await r.compute();let e=Go.extension(this.pv.url||""),t=this.pv.format;return fs.moduleNamesFromFormat(t,e)}dispose(){super.dispose(),Q.blobs.clearBlobsForNode(this)}operation(){return this._operation=this._operation||new u3(this.scene(),this.states,this)}async cook(e){let t=await this.operation().cook(e,this.pv);this.setCoreGroup(t)}static PARAM_CALLBACK_reload(e){e._paramCallbackReload()}_paramCallbackReload(){this.p.url.setDirty()}};var MV=class extends U{constructor(){super(...arguments);this.dist=y.FLOAT(.1,{range:[0,1],rangeLocked:[!0,!1]})}},vse=new MV,zy=class extends Ye{constructor(){super(...arguments);this.paramsConfig=vse}static type(){return"fuse"}static displayedInputNames(){return["points to fuse together"]}initializeNode(){this.io.inputs.setCount(1),this.io.inputs.initInputsClonedState(ke.FROM_NODE)}cook(e){let t=e[0],r=[],n;for(let i of t.coreObjects())n=this._fuse_core_object(i),n&&r.push(n);this.setObjects(r)}_fuse_core_object(e){let t=e.object();if(!t)return;let r=e.points(),n=this.pv.dist,i=new Map;for(let a of r){let c=a.position(),u=new M(Math.round(c.x/n),Math.round(c.y/n),Math.round(c.z/n)).toArray().join("-");Vt.pushOnArrayAtEntry(i,u,a)}let s=[];if(i.forEach((a,c)=>{s.push(a[0])}),t.geometry.dispose(),s.length>0){let a=At.geometryFromPoints(s,si(t.constructor));return a&&(t.geometry=a),t}}};var lc=(o=>(o.ADD_PARENT="add_parent",o.REMOVE_PARENT="remove_parent",o.ADD_CHILD="add_child",o))(lc||{}),ql=["add_parent","remove_parent","add_child"],Xl=class extends Ke{static type(){return"hierarchy"}cook(e,t){let r=e[0],n=ql[t.mode];switch(n){case"add_parent":{let i=this._add_parent_to_core_group(r,t);return this.createCoreGroupFromObjects(i)}case"remove_parent":{let i=this._remove_parent_from_core_group(r,t);return this.createCoreGroupFromObjects(i)}case"add_child":{let i=this._add_child_to_core_group(r,e[1],t);return this.createCoreGroupFromObjects(i)}}Be.unreachable(n)}_add_parent_to_core_group(e,t){return t.levels==0?e.objects():[this._add_parent_to_object(e.objects(),t)]}_add_parent_to_object(e,t){let r=new st;if(r.matrixAutoUpdate=!1,r.add(...e),t.levels>0)for(let n=0;n<t.levels-1;n++)r=this._add_new_parent(r,t);return r}_add_new_parent(e,t){let r=new st;return r.matrixAutoUpdate=!1,r.add(e),r}_remove_parent_from_core_group(e,t){if(t.levels==0)return e.objects();{let r=[];for(let n of e.objects()){let i=this._remove_parent_from_object(n,t);for(let s of i)r.push(s)}return r}}_remove_parent_from_object(e,t){let r=e.children;for(let n=0;n<t.levels-1;n++)r=this._get_children_from_objects(r,t);return r}_get_children_from_objects(e,t){let r,n=[];for(;r=e.pop();)if(r.children)for(let i of r.children)n.push(i);return n}_add_child_to_core_group(e,t,r){var n,i;let s=e.objects();if(!t)return(n=this.states)==null||n.error.set("input 1 is invalid"),[];let a=t.objects(),c=r.objectMask.trim(),u=c!=""?this._findObjectsByMaskFromObjects(c,s):s;r.debugObjectMask&&console.log(u);for(let p=0;p<u.length;p++){let d=u[p],h=a[p]||a[0];if(!h)return(i=this.states)==null||i.error.set("no objects found in input 1"),[];d.add(h)}return s}_findObjectsByMaskFromObjects(e,t){let r=[];for(let n of t)this.scene().objectsController.objectsByMaskInObject(e,n,r);return r}};Xl.DEFAULT_PARAMS={mode:0,levels:1,objectMask:"",debugObjectMask:!1};Xl.INPUT_CLONED_STATE=ke.FROM_NODE;var Dbt=[lc.ADD_PARENT,lc.REMOVE_PARENT],NV=Xl.DEFAULT_PARAMS,OV=class extends U{constructor(){super(...arguments);this.mode=y.INTEGER(NV.mode,{menu:{entries:ql.map((e,t)=>({name:e,value:t}))}}),this.levels=y.INTEGER(NV.levels,{range:[0,5],visibleIf:[{mode:ql.indexOf(lc.ADD_PARENT)},{mode:ql.indexOf(lc.REMOVE_PARENT)}]}),this.objectMask=y.STRING("",{visibleIf:{mode:ql.indexOf(lc.ADD_CHILD)}}),this.debugObjectMask=y.BOOLEAN(0,{visibleIf:{mode:ql.indexOf(lc.ADD_CHILD)}})}},yse=new OV,Hy=class extends Ye{constructor(){super(...arguments);this.paramsConfig=yse}static type(){return"hierarchy"}static displayedInputNames(){return["geometry to add or remove parents to/from","objects to use as parent or children (optional)"]}initializeNode(){this.io.inputs.setCount(1,2),this.io.inputs.initInputsClonedState(Xl.INPUT_CLONED_STATE)}cook(e){this._operation=this._operation||new Xl(this._scene,this.states);let t=this._operation.cook(e,this.pv);this.setCoreGroup(t)}};function xse(o){return Math.atan2(o.z,-o.x)}function bse(o){return Math.atan2(-o.y,Math.sqrt(o.x*o.x+o.z*o.z))}var jy=class extends Re{constructor(e,t,r,n,i){super();this.type="PolyhedronBufferGeometry",this.parameters={vertices:e,indices:t,radius:r,detail:n},r=r||1,n=n||0;let s=[],a=[],c=new Map;l(n),p(r),d(),this.setAttribute("position",new Ce(s,3)),this.setAttribute("uv",new Ce(a,2)),i||(this.setAttribute("normal",new Ce(s.slice(),3)),n===0?this.computeVertexNormals():this.normalizeNormals());function l(f){let v=new M,g=new M,_=new M;for(let T=0;T<t.length;T+=3)m(t[T+0],v),m(t[T+1],g),m(t[T+2],_),u(v,g,_,f)}function u(f,v,g,_){let T=_+1,b=[];for(let x=0;x<=T;x++){b[x]=[];let A=f.clone().lerp(g,x/T),E=v.clone().lerp(g,x/T),S=T-x;for(let w=0;w<=S;w++)w===0&&x===T?b[x][w]=A:b[x][w]=A.clone().lerp(E,w/S)}for(let x=0;x<T;x++)for(let A=0;A<2*(T-x)-1;A++){let E=Math.floor(A/2);A%2===0?(h(b[x][E+1]),h(b[x+1][E]),h(b[x][E])):(h(b[x][E+1]),h(b[x+1][E+1]),h(b[x+1][E]))}}function p(f){let v=new M;for(let g=0;g<s.length;g+=3)v.x=s[g+0],v.y=s[g+1],v.z=s[g+2],v.normalize().multiplyScalar(f),s[g+0]=v.x,s[g+1]=v.y,s[g+2]=v.z}function d(){let f=new M;for(let v=0;v<s.length;v+=3){f.x=s[v+0],f.y=s[v+1],f.z=s[v+2];let g=xse(f)/2/Math.PI+.5,_=bse(f)/Math.PI+.5;a.push(g,1-_)}}function h(f){if(i){let v=c.get(f.x);if(v){let _=v.get(f.y);if(_&&_.has(f.z))return}v||(v=new Map,c.set(f.x,v));let g=v.get(f.y);g||(g=new Set,v.set(f.y,g)),g.add(f.z)}s.push(f.x,f.y,f.z)}function m(f,v){let g=f*3;v.x=e[g+0],v.y=e[g+1],v.z=e[g+2]}}};var Wy=class extends jy{constructor(e,t,r){let n=(1+Math.sqrt(5))/2,i=[-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],s=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(i,s,e,t,r);this.type="IcosahedronBufferGeometry",this.parameters={radius:e,detail:t}}};var Rm=class extends Ke{static type(){return"icosahedron"}cook(e,t){let r=t.pointsOnly,n=new Wy(t.radius,t.detail,r);if(n.translate(t.center.x,t.center.y,t.center.z),r){let i=this.createObject(n,jt.POINTS);return this.createCoreGroupFromObjects([i])}else return n.computeVertexNormals(),this.createCoreGroupFromGeometry(n)}};Rm.DEFAULT_PARAMS={radius:1,detail:0,pointsOnly:!1,center:new M(0,0,0)};var d3=Rm.DEFAULT_PARAMS,PV=class extends U{constructor(){super(...arguments);this.radius=y.FLOAT(d3.radius),this.detail=y.INTEGER(d3.detail,{range:[0,10],rangeLocked:[!0,!1]}),this.pointsOnly=y.BOOLEAN(d3.pointsOnly),this.center=y.VECTOR3(d3.center)}},Tse=new PV,qy=class extends Ye{constructor(){super(...arguments);this.paramsConfig=Tse}static type(){return"icosahedron"}cook(){this._operation=this._operation||new Rm(this._scene,this.states);let e=this._operation.cook([],this.pv);this.setCoreGroup(e)}};var RV=class{constructor(){this._id=RV.__next_id++}id(){return this._id}handle_globals_node(o,e,t){}},Im=RV;Im.__next_id=0;var Xy=class{constructor(e){this.node=e,this._initialized=!1,this._checkParamsEditableStateBound=this._checkParamsEditableState.bind(this)}initializeNode(){if(this._initialized){console.warn("already initialized",this.node);return}this._initialized=!0,this.node.io.inputs.add_on_set_input_hook("_checkParamsEditableStateBound",this._checkParamsEditableStateBound)}initialized(){return this._initialized}_checkParamsEditableState(){this._paramsMatchEditableState()||this.updateParamsEditableStateIfNeeded()}_paramsMatchEditableState(){let e=0,t=this.node.params;for(let r of this.node.io.inputs.namedInputConnectionPoints()){if(r){let n=this.node.io.inputs.input(e)!=null,i=r==null?void 0:r.name();if(t.has(i)){let a=t.get(i);if(a){let c=!n,l=a.options.editable();if(c!=l)return!1}}}e++}return!0}updateParamsEditableStateIfNeeded(){let e=0,t=this.node.params;for(let r of this.node.io.inputs.namedInputConnectionPoints()){if(r){let n=this.node.io.inputs.input(e)!=null,i=r==null?void 0:r.name();if(t.has(i)){let s=t.get(i);if(s){let a=!n;s.options.setEditableState(a)}}}e++}}};var Ase=/\/+/g,G0=class extends fr{constructor(){super(...arguments);this._paramsEditableStatesController=new Xy(this)}static context(){return oe.GL}initializeBaseNode(){this.uiData.setLayoutHorizontal(),this.io.connections.initInputs(),this.io.connection_points.spare_params.initializeNode(),this._paramsEditableStatesController.initializeNode()}cook(){console.warn("gl node cooking")}_setMatToRecompile(){var e,t;(t=(e=this.materialNode())==null?void 0:e.assemblerController())==null||t.set_compilation_required_and_dirty(this)}materialNode(){let e=this.parent();if(e)return e.context()==oe.GL?e==null?void 0:e.materialNode():e}glVarName(e){return`v_POLY_${this.path(this.materialNode()).replace(Ase,"_")}_${e}`}variableForInputParam(e){return this.variableForInput(e.name())}variableForInput(e){var t;let r=this.io.inputs.getInputIndex(e),n=this.io.connections.inputConnection(r);if(n){let i=n.node_src,s=i.io.outputs.namedOutputConnectionPoints()[n.output_index];if(s){let a=s.name();return i.glVarName(a)}else throw console.warn(`no output called '${e}' for gl node ${i.path()}`),"variable_for_input ERROR"}else{if(this.params.has(e))return ja.any((t=this.params.get(e))==null?void 0:t.value);{let i=this.io.inputs.namedInputConnectionPoints()[r];return ja.any(i.init_value)}}}setLines(e){}reset_code(){var e;(e=this._param_configs_controller)==null||e.reset()}setParamConfigs(){}param_configs(){var e;return(e=this._param_configs_controller)==null?void 0:e.list()}paramsGenerating(){return!1}paramDefaultValue(e){return null}};var IV=class extends U{},sTt=new IV;var h3=[xo.FLOAT,xo.VEC2,xo.VEC3,xo.VEC4],LV=class extends U{constructor(){super(...arguments);this.name=y.STRING("attribute1"),this.type=y.INTEGER(0,{menu:{entries:h3.map((e,t)=>({name:e,value:t}))}}),this.texportWhenConnected=y.BOOLEAN(0,{hidden:!0}),this.exportWhenConnected=y.BOOLEAN(0,{visibleIf:{texportWhenConnected:1}})}},Cse=new LV,Yl=class extends G0{constructor(){super(...arguments);this.paramsConfig=Cse,this._bound_setExportWhenConnectedStatus=this._setExportWhenConnectedStatus.bind(this)}static type(){return uh.ATTRIBUTE}initializeNode(){this.addPostDirtyHook("_setMatToRecompile",this._setMatToRecompileIfIsExporting.bind(this)),this.io.connection_points.initializeNode(),this.io.connection_points.set_expected_input_types_function(()=>{var o,e;return((e=(o=this.materialNode())==null?void 0:o.assemblerController())==null?void 0:e.allow_attribute_exports())?[h3[this.pv.type]]:[]}),this.io.connection_points.set_input_name_function(o=>Yl.INPUT_NAME),this.io.connection_points.set_expected_output_types_function(()=>[h3[this.pv.type]]),this.lifecycle.onAfterAdded(this._bound_setExportWhenConnectedStatus),this.params.addOnSceneLoadHook("prepare params",this._bound_setExportWhenConnectedStatus)}_setExportWhenConnectedStatus(){var o,e;((e=(o=this.materialNode())==null?void 0:o.assemblerController())==null?void 0:e.allow_attribute_exports())&&this.p.texportWhenConnected.set(1)}setAttribSize(o){this.p.type.set(o-1)}inputName(){return Yl.INPUT_NAME}outputName(){return Yl.OUTPUT_NAME}varyingName(){return`v_POLY_attribute_${this.pv.name}`}setLines(o){o.assembler().setNodeLinesAttribute(this,o)}attributeName(){return this.pv.name.trim()}glType(){return this.io.outputs.namedOutputConnectionPoints()[0].type()}setGlType(o){this.p.type.set(h3.indexOf(o))}connected_input_node(){return this.io.inputs.named_input(Yl.INPUT_NAME)}connected_input_connection_point(){return this.io.inputs.named_input_connection_point(Yl.INPUT_NAME)}output_connection_point(){return this.io.outputs.namedOutputConnectionPointsByName(this.outputName())}isImporting(){return this.io.outputs.used_output_names().length>0}isExporting(){return this.pv.exportWhenConnected?this.io.inputs.named_input(Yl.INPUT_NAME)!=null:!1}_setMatToRecompileIfIsExporting(){this.pv.exportWhenConnected&&this._setMatToRecompile()}},ms=Yl;ms.INPUT_NAME="in";ms.OUTPUT_NAME="val";var Yy=class{constructor(e=[]){this._definitions=e,this._errored=!1}get errored(){return this._errored}get error_message(){return this._error_message}uniq(){let e=new Map,t=[];for(let n of this._definitions)if(!this._errored){let i=n.name(),s=e.get(i);s?s.data_type!=n.data_type&&(this._errored=!0,this._error_message=`attempt to create '${n.name()}' with types '${n.data_type}' by node '${n.node.path()}', when there is already an existing with type ${s.data_type} from node '${s.node.path()}'`,console.warn("emitting error message:",this._error_message)):(e.set(i,n),t.push(i))}let r=[];for(let n of t){let i=e.get(n);i&&r.push(i)}return r}};var f3=class{constructor(e,t,r,n){this._definition_type=e,this._data_type=t,this._node=r,this._name=n}get definition_type(){return this._definition_type}get data_type(){return this._data_type}get node(){return this._node}name(){return this._name}collection_instance(){return new Yy}},Lm=class extends f3{constructor(e,t,r){super("attribute",t,e,r);this._node=e,this._data_type=t,this._name=r}get line(){return`attribute ${this.data_type} ${this.name()}`}};var $y=class extends f3{constructor(e,t,r){super("uniform",t,e,r);this._node=e,this._data_type=t,this._name=r}get line(){return`uniform ${this.data_type} ${this.name()}`}},uc=class extends f3{constructor(e,t,r){super("varying",t,e,r);this._node=e,this._data_type=t,this._name=r}get line(){return`varying ${this.data_type} ${this.name()}`}};var cn=(o=>(o.VERTEX="vertex",o.FRAGMENT="fragment",o.LEAVES_FROM_NODES_SHADER="leaves_from_nodes_shader",o))(cn||{});var Ese={position:"vec3( position )"},Dm=class extends Im{handle_globals_node(o,e,t){var r,n;let i=o.io.outputs.namedOutputConnectionPointsByName(e);if(!i)return;let s=o.glVarName(e),a=i.type(),c=new uc(o,a,s);t.addDefinitions(o,[c]);let l=(n=(r=o.materialNode())==null?void 0:r.assemblerController())==null?void 0:n.assembler;if(!l)return;let u=l.shader_config(t.currentShaderName());if(!u)return;let p=u.dependencies(),d=[],h=`${s} = modelMatrix * vec4( position, 1.0 )`,m=`${s} = normalize( mat3( modelMatrix[0].xyz, modelMatrix[1].xyz, modelMatrix[2].xyz ) * normal )`;switch(e){case"worldPosition":{d.push(h);break}case"worldNormal":{d.push(m);break}default:d.push(`${s} = ${a}(${e})`)}for(let f of p)t.addDefinitions(o,[c],f),t.addBodyLines(o,d,f);p.length==0&&t.addBodyLines(o,d)}static variable_config_default(o){return Ese[o]}variable_config_default(o){return Dm.variable_config_default(o)}readAttribute(o,e,t,r){return Dm.readAttribute(o,e,t,r)}static readAttribute(o,e,t,r){var n,i;Dm.PRE_DEFINED_ATTRIBUTES.indexOf(t)<0&&r.addDefinitions(o,[new Lm(o,e,t)],cn.VERTEX);let s=r.currentShaderName();switch(s){case cn.VERTEX:return t;case cn.FRAGMENT:{if(!(o instanceof ms))return;let c=o.varyingName(),l=new uc(o,e,c),u=new Map;u.set(cn.FRAGMENT,[]);let p=new Map;p.set(cn.FRAGMENT,[]),Vt.pushOnArrayAtEntry(u,s,l);let d=`${c} = ${e}(${t})`,h=(i=(n=o.materialNode())==null?void 0:n.assemblerController())==null?void 0:i.assembler.shader_config(s);if(h){let m=h.dependencies();for(let f of m)Vt.pushOnArrayAtEntry(u,f,l),Vt.pushOnArrayAtEntry(p,f,d);u.forEach((f,v)=>{r.addDefinitions(o,f,v)}),p.forEach((f,v)=>{r.addBodyLines(o,f,v)})}return c}}}handle_attribute_node(o,e,t,r){return Dm.readAttribute(o,e,t,r)}},z0=Dm;z0.PRE_DEFINED_ATTRIBUTES=["position","color","normal","uv","uv2","morphTarget0","morphTarget1","morphTarget2","morphTarget3","skinIndex","skinWeight"];z0.IF_RULE={uv:"defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )"};var $l=class extends Ke{static type(){return"instance"}async cook(e,t){let r=e[0];this._geometry=void 0;let n=r.objectsWithGeo()[0];if(n){let i=n.geometry;if(i){let s=e[1];this._create_instance(i,s,t)}}if(this._geometry){let i=aN(n);if(i){let s=this.createObject(this._geometry,i);if(t.applyMaterial){let a=await this._get_material(t);a&&await this._applyMaterial(s,a)}return this.createCoreGroupFromObjects([s])}}return this.createCoreGroupFromObjects([])}async _get_material(e){var t;if(e.applyMaterial){let r=e.material.nodeWithContext(oe.MAT,(t=this.states)==null?void 0:t.error);if(r){this._globalsHandler=this._globalsHandler||new z0;let i=r.assemblerController();return i&&i.setAssemblerGlobalsHandler(this._globalsHandler),(await r.compute()).material()}}}async _applyMaterial(e,t){e.material=t,ai.applyCustomMaterials(e,t)}_create_instance(e,t,r){this._geometry=Vi.createInstanceBufferGeometry(e,t,r.attributesToCopy)}};$l.DEFAULT_PARAMS={attributesToCopy:"instance*",applyMaterial:!0,material:new Rn("")};$l.INPUT_CLONED_STATE=[ke.ALWAYS,ke.NEVER];var DV=$l.DEFAULT_PARAMS,kV=class extends U{constructor(){super(...arguments);this.attributesToCopy=y.STRING(DV.attributesToCopy),this.applyMaterial=y.BOOLEAN(DV.applyMaterial),this.material=y.NODE_PATH("",{visibleIf:{applyMaterial:1},nodeSelection:{context:oe.MAT},dependentOnFoundNode:!1})}},Sse=new kV,Ky=class extends Ye{constructor(){super(...arguments);this.paramsConfig=Sse}static type(){return"instance"}static displayedInputNames(){return["geometry to be instanciated","points to instance to"]}initializeNode(){super.initializeNode(),this.io.inputs.setCount(2),this.io.inputs.initInputsClonedState($l.INPUT_CLONED_STATE)}async cook(e){this._operation=this._operation||new $l(this.scene(),this.states);let t=await this._operation.cook(e,this.pv);this.setCoreGroup(t)}};var Kl=class extends Ke{static type(){return"jitter"}cook(e,t){let r=e[0],n=r.points(),i;for(let s=0;s<n.length;s++){i=n[s];let a=new M(2*(Mr.randFloat(s*75+764+t.seed)-.5),2*(Mr.randFloat(s*5678+3653+t.seed)-.5),2*(Mr.randFloat(s*657+48464+t.seed)-.5));a.normalize(),a.multiply(t.mult),a.multiplyScalar(t.amount*Mr.randFloat(s*78+54+t.seed));let c=i.position().clone().add(a);i.setPosition(c)}return r}};Kl.DEFAULT_PARAMS={amount:1,mult:new M(1,1,1),seed:1};Kl.INPUT_CLONED_STATE=ke.FROM_NODE;var Jy=Kl.DEFAULT_PARAMS,BV=class extends U{constructor(){super(...arguments);this.amount=y.FLOAT(Jy.amount),this.mult=y.VECTOR3(Jy.mult),this.seed=y.INTEGER(Jy.seed,{range:[0,100]})}},wse=new BV,Zy=class extends Ye{constructor(){super(...arguments);this.paramsConfig=wse}static type(){return"jitter"}static displayedInputNames(){return["geometry to jitter points of"]}initializeNode(){this.io.inputs.setCount(1),this.io.inputs.initInputsClonedState(Kl.INPUT_CLONED_STATE)}cook(e){this._operation=this._operation||new Kl(this.scene(),this.states);let t=this._operation.cook(e,this.pv);this.setCoreGroup(t)}};var FV=class extends U{constructor(){super(...arguments);this.length=y.FLOAT(1,{range:[0,10]}),this.pointsCount=y.INTEGER(1,{range:[2,100],rangeLocked:[!0,!1]}),this.origin=y.VECTOR3([0,0,0]),this.direction=y.VECTOR3([0,1,0])}},Mse=new FV,Qy=class extends Ye{constructor(){super(...arguments);this.paramsConfig=Mse}static type(){return"line"}initializeNode(){}cook(){let e=Math.max(2,this.pv.pointsCount),t=new Array(e*3),r=new Array(e),n=this.pv.direction.clone().normalize().multiplyScalar(this.pv.length);for(let s=0;s<e;s++){let a=s/(e-1),c=n.clone().multiplyScalar(a);c.add(this.pv.origin),c.toArray(t,s*3),s>0&&(r[(s-1)*2]=s-1,r[(s-1)*2+1]=s)}let i=new Re;i.setAttribute("position",new Ce(t,3)),i.setIndex(r),this.setGeometry(i,jt.LINE_SEGMENTS)}};var Jl=class extends Ke{constructor(){super(...arguments);this._globalsHandler=new z0,this._old_mat_by_old_new_id=new Map,this._materials_by_uuid=new Map}static type(){return"material"}async cook(e,t){let r=e[0];return this._old_mat_by_old_new_id.clear(),await this._apply_materials(r,t),this._swapTextures(r,t),r}async _apply_materials(e,t){var r,n,i,s;if(!t.assignMat)return;let a=t.material.nodeWithContext(oe.MAT,(r=this.states)==null?void 0:r.error);if(a){let c=a.material,l=a;if(l.assemblerController&&((n=l.assemblerController())==null||n.setAssemblerGlobalsHandler(this._globalsHandler)),await a.compute(),c){if(t.applyToChildren)for(let u of e.objects())u.traverse(p=>{this._apply_material(p,c,t)});else for(let u of e.objectsFromGroup(t.group))this._apply_material(u,c,t);return e}else(i=this.states)==null||i.error.set(`material invalid. (error: '${a.states.error.message()}')`)}else(s=this.states)==null||s.error.set("no material node found")}_swapTextures(e,t){if(!!t.swapCurrentTex){this._materials_by_uuid.clear();for(let r of e.objectsFromGroup(t.group))if(t.applyToChildren)r.traverse(n=>{let i=r.material;this._materials_by_uuid.set(i.uuid,i)});else{let n=r.material;this._materials_by_uuid.set(n.uuid,n)}this._materials_by_uuid.forEach((r,n)=>{this._swap_texture(r,t)})}}_apply_material(e,t,r){if(r.group&&!br.isInGroup(r.group,e))return;let n=r.cloneMat?ai.clone(this.scene(),t,{shareCustomUniforms:r.shareCustomUniforms}):t;if(t instanceof Sr&&n instanceof Sr)for(let s in t.uniforms)n.uniforms[s]=t.uniforms[s];let i=e;this._old_mat_by_old_new_id.set(n.uuid,i.material),i.material=n,ai.apply_render_hook(e,n),ai.applyCustomMaterials(e,n)}_swap_texture(e,t){if(t.texSrc0==""||t.texDest0=="")return;let r=this._old_mat_by_old_new_id.get(e.uuid);r=r||e;let n=r[t.texSrc0];if(n){e[t.texDest0]=n;let i=e.uniforms;i&&i[t.texDest0]&&(i[t.texDest0]={value:n})}}};Jl.DEFAULT_PARAMS={group:"",assignMat:!0,material:new Rn(""),applyToChildren:!0,cloneMat:!1,shareCustomUniforms:!0,swapCurrentTex:!1,texSrc0:"emissiveMap",texDest0:"map"};Jl.INPUT_CLONED_STATE=ke.FROM_NODE;var pc=Jl.DEFAULT_PARAMS,UV=class extends U{constructor(){super(...arguments);this.group=y.STRING(pc.group),this.assignMat=y.BOOLEAN(pc.assignMat),this.material=y.NODE_PATH("",{nodeSelection:{context:oe.MAT},dependentOnFoundNode:!1,visibleIf:{assignMat:1}}),this.applyToChildren=y.BOOLEAN(pc.applyToChildren,{visibleIf:{assignMat:1}}),this.cloneMat=y.BOOLEAN(pc.cloneMat,{visibleIf:{assignMat:1}}),this.shareCustomUniforms=y.BOOLEAN(pc.shareCustomUniforms,{visibleIf:{assignMat:1,cloneMat:1}}),this.swapCurrentTex=y.BOOLEAN(pc.swapCurrentTex),this.texSrc0=y.STRING(pc.texSrc0,{visibleIf:{swapCurrentTex:1}}),this.texDest0=y.STRING(pc.texDest0,{visibleIf:{swapCurrentTex:1}})}},Nse=new UV,ex=class extends Ye{constructor(){super(...arguments);this.paramsConfig=Nse}static type(){return"material"}static displayedInputNames(){return["objects to assign material to"]}initializeNode(){this.io.inputs.setCount(1),this.io.inputs.initInputsClonedState(Jl.INPUT_CLONED_STATE)}async cook(e){this._operation=this._operation||new Jl(this._scene,this.states);let t=await this._operation.cook(e,this.pv);this.setCoreGroup(t)}};var Zl=class extends Ke{static type(){return"materialProperties"}async cook(e,t){let r=e[0],n=[];for(let i of r.objects())t.applyToChildren?i.traverse(s=>{n.push(s)}):n.push(i);for(let i of n)this._updateObject(i,t);return r}_updateObject(e,t){let r=e.material;r&&this._updateMaterial(r,t)}async _updateMaterial(e,t){t.tside&&Uf(e,t)}};Zl.DEFAULT_PARAMS={applyToChildren:!1,tside:!1,doubleSided:!1,front:!0,overrideShadowSide:!1,shadowDoubleSided:!1,shadowFront:!0};Zl.INPUT_CLONED_STATE=ke.FROM_NODE;var VV=Zl.DEFAULT_PARAMS,GV=class extends U{constructor(){super(...arguments);this.applyToChildren=y.BOOLEAN(VV.applyToChildren,{separatorAfter:!0}),this.tside=y.BOOLEAN(VV.tside),this.doubleSided=y.BOOLEAN(0,{visibleIf:{tside:!0}}),this.front=y.BOOLEAN(1,{visibleIf:{tside:!0,doubleSided:!1}}),this.overrideShadowSide=y.BOOLEAN(0,{visibleIf:{tside:!0}}),this.shadowDoubleSided=y.BOOLEAN(0,{visibleIf:{tside:!0,overrideShadowSide:!0}}),this.shadowFront=y.BOOLEAN(1,{visibleIf:{tside:!0,overrideShadowSide:!0,shadowDoubleSided:!1}})}},Ose=new GV,tx=class extends Ye{constructor(){super(...arguments);this.paramsConfig=Ose}static type(){return"materialProperties"}static displayedInputNames(){return["objects with materials to change properties of"]}initializeNode(){this.io.inputs.setCount(1),this.io.inputs.initInputsClonedState(Zl.INPUT_CLONED_STATE)}async cook(e){this._operation=this._operation||new Zl(this.scene(),this.states);let t=await this._operation.cook(e,this.pv);this.setCoreGroup(t)}};var rx=class extends U0{constructor(){super(...arguments);this._childrenControllerContext=oe.MAT}static type(){return uo.MAT}createNode(e,t){return super.createNode(e,t)}children(){return super.children()}nodesByType(e){return super.nodesByType(e)}};var Ql=class extends Ke{static type(){return"merge"}cook(e,t){let r=[];for(let n of e)if(n){let i=n.objects();if(t.compact)for(let s of i)s.traverse(a=>{r.push(a)});else for(let s of n.objects())r.push(s)}return t.compact&&(r=this._makeCompact(r)),this.createCoreGroupFromObjects(r)}_makeCompact(e){let t=new Map,r=new Map,n=[];for(let s of e)s.traverse(a=>{if(a instanceof st)return;let c=a;if(c.geometry){let l=si(c.constructor);n.includes(l)||n.push(l),l&&(t.get(l)||t.set(l,c.material),Vt.pushOnArrayAtEntry(r,l,c))}});let i=[];return n.forEach(s=>{var a,c;let l=r.get(s);if(l){let u=[];for(let p of l){let d=p.geometry;d.applyMatrix4(p.matrix),u.push(d)}try{let p=At.mergeGeometries(u);if(p){let d=t.get(s),h=this.createObject(p,s,d);h.matrixAutoUpdate=!1,i.push(h)}else(a=this.states)==null||a.error.set("merge failed, check that input geometries have the same attributes")}catch(p){(c=this.states)==null||c.error.set(p.message)}}}),i}};Ql.DEFAULT_PARAMS={compact:!1,keepHierarchy:!1};Ql.INPUT_CLONED_STATE=ke.FROM_NODE;var m3="geometry to merge",Pse=Ql.DEFAULT_PARAMS,zV=4,HV=class extends U{constructor(){super(...arguments);this.compact=y.BOOLEAN(Pse.compact),this.inputsCount=y.INTEGER(zV,{range:[1,32],rangeLocked:[!0,!1],callback:e=>{_3.PARAM_CALLBACK_setInputsCount(e)}})}},Rse=new HV,_3=class extends Ye{constructor(){super(...arguments);this.paramsConfig=Rse}static type(){return"merge"}static displayedInputNames(){return[m3,m3,m3,m3]}setCompactMode(e){this.p.compact.set(e)}initializeNode(){this.io.inputs.setCount(1,zV),this.io.inputs.initInputsClonedState(Ql.INPUT_CLONED_STATE),this.scene().dispatchController.onAddListener(()=>{this.params.addOnSceneLoadHook("update inputs",()=>{this._callbackUpdateInputsCount()})})}cook(e){this._operation=this._operation||new Ql(this.scene(),this.states);let t=this._operation.cook(e,this.pv);this.setCoreGroup(t)}_callbackUpdateInputsCount(){this.io.inputs.setCount(1,this.pv.inputsCount),this.emit(Nt.INPUTS_UPDATED)}static PARAM_CALLBACK_setInputsCount(e){e._callbackUpdateInputsCount()}};var Ld=class extends Ke{static type(){return"null"}cook(e,t){let r=e[0];return r||this.createCoreGroupFromObjects([])}convertExportParamData(e){}};Ld.DEFAULT_PARAMS={};Ld.INPUT_CLONED_STATE=ke.FROM_NODE;var jV=class extends U{},Ise=new jV,ox=class extends Ye{constructor(){super(...arguments);this.paramsConfig=Ise}static type(){return"null"}initializeNode(){this.io.inputs.setCount(0,1),this.io.inputs.initInputsClonedState(Ld.INPUT_CLONED_STATE)}cook(e){this._operation=this._operation||new Ld(this.scene(),this.states);let t=this._operation.cook(e,this.pv);this.setCoreGroup(t)}};var eu=class extends Ke{static type(){return"objectProperties"}cook(e,t){let r=e[0];for(let n of r.objects())t.applyToChildren?n.traverse(i=>{this._updateObject(i,t)}):this._updateObject(n,t);return r}_updateObject(e,t){t.tname&&(e.name=t.name),t.trenderOrder&&(e.renderOrder=t.renderOrder),t.tfrustumCulled&&(e.frustumCulled=t.frustumCulled),t.tmatrixAutoUpdate&&(e.matrixAutoUpdate=t.matrixAutoUpdate),t.tvisible&&(e.visible=t.visible),t.tcastShadow&&(e.castShadow=t.castShadow),t.treceiveShadow&&(e.receiveShadow=t.receiveShadow)}};eu.DEFAULT_PARAMS={applyToChildren:!1,tname:!1,name:"",trenderOrder:!1,renderOrder:0,tfrustumCulled:!1,frustumCulled:!0,tmatrixAutoUpdate:!1,matrixAutoUpdate:!1,tvisible:!1,visible:!0,tcastShadow:!1,castShadow:!0,treceiveShadow:!1,receiveShadow:!0};eu.INPUT_CLONED_STATE=ke.FROM_NODE;var ln=eu.DEFAULT_PARAMS,WV=class extends U{constructor(){super(...arguments);this.applyToChildren=y.BOOLEAN(ln.applyToChildren,{separatorAfter:!0}),this.tname=y.BOOLEAN(ln.tname),this.name=y.STRING(ln.name,{visibleIf:{tname:!0},separatorAfter:!0,expression:{forEntities:!0}}),this.trenderOrder=y.BOOLEAN(ln.trenderOrder),this.renderOrder=y.INTEGER(ln.renderOrder,{visibleIf:{trenderOrder:!0},range:[0,10],rangeLocked:[!1,!1],separatorAfter:!0,expression:{forEntities:!0}}),this.tfrustumCulled=y.BOOLEAN(ln.tfrustumCulled),this.frustumCulled=y.BOOLEAN(ln.frustumCulled,{visibleIf:{tfrustumCulled:!0},separatorAfter:!0,expression:{forEntities:!0}}),this.tmatrixAutoUpdate=y.BOOLEAN(ln.tmatrixAutoUpdate),this.matrixAutoUpdate=y.BOOLEAN(ln.matrixAutoUpdate,{visibleIf:{tmatrixAutoUpdate:!0},separatorAfter:!0,expression:{forEntities:!0}}),this.tvisible=y.BOOLEAN(ln.tvisible),this.visible=y.BOOLEAN(ln.visible,{visibleIf:{tvisible:!0},separatorAfter:!0,expression:{forEntities:!0}}),this.tcastShadow=y.BOOLEAN(ln.tcastShadow),this.castShadow=y.BOOLEAN(ln.castShadow,{visibleIf:{tcastShadow:!0},separatorAfter:!0,expression:{forEntities:!0}}),this.treceiveShadow=y.BOOLEAN(ln.treceiveShadow),this.receiveShadow=y.BOOLEAN(ln.receiveShadow,{visibleIf:{treceiveShadow:!0},expression:{forEntities:!0}})}},Lse=new WV,nx=class extends Ye{constructor(){super(...arguments);this.paramsConfig=Lse}static type(){return"objectProperties"}static displayedInputNames(){return["objects to change properties of"]}initializeNode(){this.io.inputs.setCount(1),this.io.inputs.initInputsClonedState(eu.INPUT_CLONED_STATE)}async cook(e){if(this._operation=this._operation||new eu(this.scene(),this.states),this.params.all.find(r=>r.hasExpression())){let r=e[0];await this._cookWithExpressions(r),this.setCoreGroup(r)}else{let r=this._operation.cook(e,this.pv);this.setCoreGroup(r)}}async _cookWithExpressions(e){if(await this._cookWithExpressionsForCoreGroup(e),this.pv.applyToChildren){let t=e.objects();for(let r of t){let n=Fn._fromObjects(r.children);await this._cookWithExpressionsForCoreGroup(n)}}}async _cookWithExpressionsForCoreGroup(e){let t=e.coreObjects(),r=this.pv;r.tname&&(this.p.name.expressionController?await this.p.name.expressionController.computeExpressionForObjects(t,(n,i)=>{n.object().name=i}):t.forEach(n=>n.object().name=r.name)),r.trenderOrder&&(this.p.renderOrder.expressionController?await this.p.renderOrder.expressionController.computeExpressionForObjects(t,(n,i)=>{n.object().renderOrder=i}):t.forEach(n=>n.object().renderOrder=r.renderOrder)),r.tfrustumCulled&&(this.p.frustumCulled.expressionController?await this.p.frustumCulled.expressionController.computeExpressionForObjects(t,(n,i)=>{n.object().frustumCulled=i}):t.forEach(n=>n.object().frustumCulled=r.frustumCulled)),r.tmatrixAutoUpdate&&(this.p.matrixAutoUpdate.expressionController?await this.p.matrixAutoUpdate.expressionController.computeExpressionForObjects(t,(n,i)=>{n.object().matrixAutoUpdate=i}):t.forEach(n=>n.object().matrixAutoUpdate=r.matrixAutoUpdate)),r.tvisible&&(this.p.visible.expressionController?await this.p.visible.expressionController.computeExpressionForObjects(t,(n,i)=>{n.object().visible=i}):t.forEach(n=>n.object().visible=r.visible)),r.tcastShadow&&(this.p.castShadow.expressionController?await this.p.castShadow.expressionController.computeExpressionForObjects(t,(n,i)=>{n.object().castShadow=i}):t.forEach(n=>n.object().castShadow=r.castShadow)),r.treceiveShadow&&(this.p.receiveShadow.expressionController?await this.p.receiveShadow.expressionController.computeExpressionForObjects(t,(n,i)=>{n.object().receiveShadow=i}):t.forEach(n=>n.object().receiveShadow=r.receiveShadow))}};var Bm=(o=>(o.PARTICLES_SHADER="particles_shader",o.MATERIAL="material",o))(Bm||{}),km=class extends Im{constructor(o,e){super();this._uv_name=o,this._purpose=e}set_texture_allocations_controller(o){this._texture_allocations_controller=o}handle_globals_node(o,e,t){if(!this._texture_allocations_controller)return;let r=o.io.outputs.namedOutputConnectionPointsByName(e),n=o.glVarName(e);if(this._texture_allocations_controller.variable(e)&&r){let s=r.type(),a=this.readAttribute(o,s,e,t),c=`${s} ${n} = ${a}`;t.addBodyLines(o,[c])}else this.globals_geometry_handler=this.globals_geometry_handler||new z0,this.globals_geometry_handler.handle_globals_node(o,e,t)}_textureVariableUsable(o){switch(this._purpose){case"particles_shader":return!0;case"material":return!o.readonly()}Be.unreachable(this._purpose)}readAttribute(o,e,t,r){if(!this._texture_allocations_controller){console.warn("no texture allocation controller");return}let n=this._texture_allocations_controller.variable(t);if(n&&this._textureVariableUsable(n)){this.add_particles_sim_uv_attribute(o,r);let i=n.component(),s=n.allocation();if(s){let a=s.textureName(),c=new $y(o,xo.SAMPLER_2D,a);return r.addDefinitions(o,[c]),`texture2D( ${a}, ${this._uv_name} ).${i}`}}else return z0.readAttribute(o,e,t,r)}add_particles_sim_uv_attribute(o,e){let t=new Lm(o,xo.VEC2,km.UV_ATTRIB),r=new uc(o,xo.VEC2,km.UV_VARYING);e.addDefinitions(o,[t,r],cn.VERTEX),e.addDefinitions(o,[r],cn.FRAGMENT),e.addBodyLines(o,[`${km.UV_VARYING} = ${km.UV_ATTRIB}`],cn.VERTEX)}},_s=km;_s.UV_ATTRIB="particles_sim_uv_attrib";_s.UV_VARYING="particles_sim_uv_varying";_s.PARTICLE_SIM_UV="particleUV";var ix=class{constructor(e){this.node=e,this._particlesGroupObjects=[],this._allShaderNames=[],this._uniformByShaderName=new Map,this._allUniformNames=[],this._materialGlobalsHandler=new _s(_s.UV_VARYING,Bm.MATERIAL)}setShadersByName(e){this._allShaderNames=[],this._uniformByShaderName.clear(),this._allUniformNames=[],e.forEach((t,r)=>{this._allShaderNames.push(r),this._allUniformNames.push(`texture_${r}`)}),this.resetRenderMaterial()}assignRenderMaterial(){if(!!this._renderMaterial){for(let e of this._particlesGroupObjects){let t=e;t.geometry&&(t.material=this._renderMaterial,ai.applyCustomMaterials(t,this._renderMaterial),t.matrixAutoUpdate=!1,t.updateMatrix())}this._renderMaterial.needsUpdate=!0,this.updateRenderMaterialUniforms()}}updateRenderMaterialUniforms(){var e;if(!this._renderMaterial)return;let t,r;for(let n=0;n<this._allShaderNames.length;n++){r=this._allShaderNames[n],t=this._allUniformNames[n];let i=this._uniformByShaderName.get(r);i||(i={value:null},this._uniformByShaderName.set(r,i));let s=(e=this.node.gpuController.getCurrentRenderTarget(r))==null?void 0:e.texture;i.value=s||null,ai.assignUniforms(this._renderMaterial,t,i,this._matNodeAssembler)}}resetRenderMaterial(){this._renderMaterial=void 0,this._particlesGroupObjects=[]}material(){return this._renderMaterial}initialized(){return this._renderMaterial!=null}initCoreGroup(e){for(let t of e.objectsWithGeo())this._particlesGroupObjects.push(t)}async initRenderMaterial(){var e;let t=(e=this.node.assemblerController())==null?void 0:e.assembler;if(this._renderMaterial)return;this.node.p.material.isDirty()&&(this.node.debugMessage("renderController: this.node.p.material.compute() START"),await this.node.p.material.compute(),this.node.debugMessage("renderController: this.node.p.material.compute() END"));let r=this.node.pv.material.nodeWithContext(oe.MAT,this.node.states.error);if(r){if(t){let i=t.textureAllocationsController().toJSON(this.node.scene()),s=r.assemblerController();s&&(this._materialGlobalsHandler.set_texture_allocations_controller(t.textureAllocationsController()),s.setAssemblerGlobalsHandler(this._materialGlobalsHandler),this._matNodeAssembler=s.assembler),(!this._texture_allocations_json||JSON.stringify(this._texture_allocations_json)!=JSON.stringify(i))&&(this._texture_allocations_json=wr.cloneDeep(i),s&&s.set_compilation_required_and_dirty())}this.node.debugMessage("renderController: matNode.compute() START");let n=await r.compute();this.node.debugMessage("renderController: matNode.compute() END"),this._renderMaterial=n.material()}else this.node.states.error.set("render material not valid");this.assignRenderMaterial()}};var Dd=(o=>(o.TIME="time",o.DELTA_TIME="delta_time",o))(Dd||{});var qV=function(o,e,t){this.variables=[],this.currentTextureIndex=0;var r=qt,n=new ii;n.matrixAutoUpdate=!1;var i=new As;i.position.z=1,i.matrixAutoUpdate=!1,i.updateMatrix();var s={passThruTexture:{value:null}},a=p(h(),s);let c=new Ts(2,2);var l=new ct(c,a);l.matrixAutoUpdate=!1,l.updateMatrix(),n.add(l),this.dispose=function(){a.dispose(),c.dispose()},this.setDataType=function(m){return r=m,this},this.addVariable=function(m,f,v){var g=this.createShaderMaterial(f),_={name:m,initialValueTexture:v,material:g,dependencies:null,renderTargets:[],wrapS:null,wrapT:null,minFilter:it,magFilter:it};return this.variables.push(_),_},this.setVariableDependencies=function(m,f){m.dependencies=f},this.init=function(){if(t.capabilities.isWebGL2===!1&&t.extensions.has("OES_texture_float")===!1)return"No OES_texture_float support for float textures.";if(t.capabilities.maxVertexTextures===0)return"No support for vertex shader textures.";for(var m=0;m<this.variables.length;m++){var f=this.variables[m];f.renderTargets[0]=this.createRenderTarget(o,e,f.wrapS,f.wrapT,f.minFilter,f.magFilter),f.renderTargets[1]=this.createRenderTarget(o,e,f.wrapS,f.wrapT,f.minFilter,f.magFilter),this.renderTexture(f.initialValueTexture,f.renderTargets[0]),this.renderTexture(f.initialValueTexture,f.renderTargets[1]);var v=f.material,g=v.uniforms;if(f.dependencies!==null)for(var _=0;_<f.dependencies.length;_++){var T=f.dependencies[_];if(T.name!==f.name){for(var b=!1,x=0;x<this.variables.length;x++)if(T.name===this.variables[x].name){b=!0;break}if(!b)return"Variable dependency not found. Variable="+f.name+", dependency="+T.name}g[T.name]={value:null}}}return this.currentTextureIndex=0,null},this.compute=function(){for(var m=this.currentTextureIndex,f=this.currentTextureIndex===0?1:0,v=0,g=this.variables.length;v<g;v++){var _=this.variables[v];if(_.dependencies!==null)for(var T=_.material.uniforms,b=0,x=_.dependencies.length;b<x;b++){var A=_.dependencies[b];T[A.name].value=A.renderTargets[m].texture}this.doRenderTarget(_.material,_.renderTargets[f])}this.currentTextureIndex=f},this.getCurrentRenderTarget=function(m){return m.renderTargets[this.currentTextureIndex]},this.getAlternateRenderTarget=function(m){return m.renderTargets[this.currentTextureIndex===0?1:0]};function u(m){m.defines.resolution="vec2( "+o.toFixed(1)+", "+e.toFixed(1)+" )"}this.addResolutionDefine=u;function p(m,f){f=f||{};var v=new Sr({uniforms:f,vertexShader:d(),fragmentShader:m});return u(v),v}this.createShaderMaterial=p,this.createRenderTarget=function(m,f,v,g,_,T){m=m||o,f=f||e,v=v||Ft,g=g||Ft,_=_||it,T=T||it;var b=new yr(m,f,{wrapS:v,wrapT:g,minFilter:_,magFilter:T,format:at,type:r,depthBuffer:!1});return b},this.createTexture=function(){var m=new Float32Array(o*e*4);return new Rr(m,o,e,at,qt)},this.renderTexture=function(m,f){s.passThruTexture.value=m,this.doRenderTarget(a,f),s.passThruTexture.value=null},this.doRenderTarget=function(m,f){var v=t.getRenderTarget();l.material=m,t.setRenderTarget(f),t.render(n,i),l.material=a,t.setRenderTarget(v)};function d(){return`void main()	{

	gl_Position = vec4( position, 1.0 );

}
`}function h(){return`uniform sampler2D passThruTexture;

void main() {

	vec2 uv = gl_FragCoord.xy / resolution.xy;

	gl_FragColor = texture2D( passThruTexture, uv );

}
`}};var sx=["float","half"],Dse={float:qt,half:qr},ax=class{constructor(e){this.node=e,this._simulationRestartRequired=!1,this._points=[],this._variablesByName=new Map,this._allVariables=[],this._createdTexturesByName=new Map,this._usedTexturesSize=new z,this._callbackName=`gpuCompute-${this.node.graphNodeId()}`}dispose(){this._gpuCompute&&(this._gpuCompute.dispose(),this._gpuCompute=void 0),this._renderer&&(this._renderer.dispose(),this._renderer=void 0),this._particlesCoreGroup&&(this._particlesCoreGroup.dispose(),this._particlesCoreGroup=void 0),this._variablesByName.clear(),this._allVariables.splice(0,this._allVariables.length),this._createdTexturesByName.clear(),this._shadersByName&&(this._shadersByName.clear(),this._shadersByName=void 0),this._persistedTextureAllocationsController&&(this._persistedTextureAllocationsController.dispose(),this._persistedTextureAllocationsController=void 0),this.node.scene().unRegisterOnBeforeTick(this._callbackName)}setPersistedTextureAllocationController(e){this._persistedTextureAllocationsController=e}setShadersByName(e){this._shadersByName=e,this.resetGpuCompute()}allVariables(){return this._allVariables}async init(e){this.initParticleGroupPoints(e),this.node.debugMessage("GPUComputeController: this.createGPUCompute() START"),await this.createGPUCompute(),this.node.debugMessage("GPUComputeController: this.createGPUCompute() END")}getCurrentRenderTarget(e){var t;let r=this._variablesByName.get(e);if(r)return(t=this._gpuCompute)==null?void 0:t.getCurrentRenderTarget(r)}initParticleGroupPoints(e){this.resetGpuCompute(),!!e&&(this._particlesCoreGroup=e,this._points=this._getPoints()||[])}computeSimulationIfRequired(e){let t=this.node.scene().frame(),r=this.node.pv.startFrame;if(t>=r&&(this._lastSimulatedFrame==null&&(this._lastSimulatedFrame=r-1),t>this._lastSimulatedFrame)){let n=t-this._lastSimulatedFrame;if(this._lastSimulatedFrame=t,!this.node.pv.active)return;this._computeSimulation(e,n)}}_computeSimulation(e,t=1){if(!!this._gpuCompute){this._updateSimulationMaterialUniforms(e);for(let r=0;r<t;r++)this._gpuCompute.compute();this.node.renderController.updateRenderMaterialUniforms()}}_dataType(){let e=sx[this.node.pv.dataType];return Dse[e]}_textureNameForShaderName(e){return`texture_${e}`}async createGPUCompute(){var e,t;if(this.node.pv.autoTexturesSize){let s=Mr.nearestPower2(Math.sqrt(this._points.length));this._usedTexturesSize.x=Math.min(s,this.node.pv.maxTexturesSize.x),this._usedTexturesSize.y=Math.min(s,this.node.pv.maxTexturesSize.y)}else{if(!(du(this.node.pv.texturesSize.x)&&du(this.node.pv.texturesSize.y))){this.node.states.error.set("texture size must be a power of 2");return}let s=this.node.pv.texturesSize.x*this.node.pv.texturesSize.y;if(this._points.length>s){this.node.states.error.set(`max particles is set to (${this.node.pv.texturesSize.x}x${this.node.pv.texturesSize.y}=) ${s}`);return}this._usedTexturesSize.copy(this.node.pv.texturesSize)}this._forceTimeDependent(),this._initParticlesUVs(),this.node.renderController.resetRenderMaterial(),this.node.debugMessage("GPUComputeController: Poly.renderersController.waitForRenderer() START");let r=await Q.renderersController.waitForRenderer();if(this.node.debugMessage("GPUComputeController: Poly.renderersController.waitForRenderer() END"),r?this._renderer=r:this.node.states.error.set("no renderer found"),!this._renderer)return;let n=new qV(this._usedTexturesSize.x,this._usedTexturesSize.y,this._renderer);if(n.setDataType(this._dataType()),this._gpuCompute=n,!this._gpuCompute){this.node.states.error.set("failed to create the GPUComputationRenderer");return}this._lastSimulatedFrame=void 0,this._variablesByName.forEach((s,a)=>{s.renderTargets[0].dispose(),s.renderTargets[1].dispose(),this._variablesByName.delete(a)}),this._allVariables=[],(e=this._shadersByName)==null||e.forEach((s,a)=>{if(this._gpuCompute){let c=this._gpuCompute.addVariable(this._textureNameForShaderName(a),s,this._createdTexturesByName.get(a));this._variablesByName.set(a,c),this._allVariables.push(c)}}),(t=this._variablesByName)==null||t.forEach((s,a)=>{this._gpuCompute&&this._gpuCompute.setVariableDependencies(s,this._allVariables)}),this._createTextureRenderTargets(),this._fillTextures(),this._createSimulationMaterialUniforms();var i=this._gpuCompute.init();i!==null&&(console.error(i),this.node.states.error.set(i))}_forceTimeDependent(){let e=this._onTimeUpdate.bind(this);this.node.scene().registeredBeforeTickCallbacks().has(this._callbackName)||this.node.scene().registerOnBeforeTick(this._callbackName,e)}_onTimeUpdate(e){if(this.node.isOnStartFrame()){this.node.setDirty();return}else this.computeSimulationIfRequired(e)}materials(){let e=[];return this._variablesByName.forEach((t,r)=>{e.push(t.material)}),e}_createSimulationMaterialUniforms(){let e=this.node.assemblerController(),t=e==null?void 0:e.assembler;if(!t&&!this._persistedTextureAllocationsController)return;let r=[];this._variablesByName.forEach((i,s)=>{r.push(i.material)});let n=this._readonlyAllocations();for(let i of r)i.uniforms[Dd.TIME]={value:this.node.scene().time()},i.uniforms[Dd.DELTA_TIME]={value:this.node.scene().time()},n&&this._assignReadonlyTextures(i,n);if(t)for(let i of r)for(let s of t.param_configs())i.uniforms[s.uniformName()]=s.uniform();else{let i=this.node.persisted_config.loaded_data();if(i){let s=this.node.persisted_config.uniforms();if(s){let a=i.param_uniform_pairs;for(let c of a){let l=c[0],u=c[1],p=this.node.params.get(l),d=s[u];for(let h of r)h.uniforms[u]=d,n&&this._assignReadonlyTextures(h,n);if(p&&d){let h=()=>{for(let m of r)Ms.callback(p,m.uniforms[u])};p.options.setOption("callback",h),h()}}}}}}_assignReadonlyTextures(e,t){for(let r of t){let n=r.shaderName(),i=this._createdTexturesByName.get(n);if(i){let s=this._textureNameForShaderName(n);e.uniforms[s]={value:i}}}}_updateSimulationMaterialUniforms(e){for(let t of this._allVariables)t.material.uniforms[Dd.TIME].value+=e,t.material.uniforms[Dd.DELTA_TIME].value=e}_initParticlesUVs(){var e=new Float32Array(this._points.length*2);let t=0;for(var r=0,n=0;n<this._usedTexturesSize.x;n++)for(var i=0;i<this._usedTexturesSize.y&&(e[t++]=i/(this._usedTexturesSize.x-1),e[t++]=n/(this._usedTexturesSize.y-1),r+=2,!(r>=e.length));i++);let s=_s.UV_ATTRIB;if(this._particlesCoreGroup)for(let a of this._particlesCoreGroup.coreGeometries()){let c=a.geometry(),l=a.markedAsInstance()?Kr:Tt;c.setAttribute(s,new l(e,2))}}createdTexturesByName(){return this._createdTexturesByName}_fillTextures(){let e=this._textureAllocationsController();!e||this._createdTexturesByName.forEach((t,r)=>{let n=e.allocationForShaderName(r);if(!n){console.warn(`no allocation found for shader ${r}`);return}let i=n.variables();if(!i){console.warn("allocation has no variables");return}let s=t.image.data;for(let a of i){let c=a.position(),l=a.name(),u=this._points[0];if(u&&u.hasAttrib(l)){let d=u.attribSize(l),h=c;for(let m of this._points){if(d==1){let f=m.attribValue(l);s[h]=f}else m.attribValue(l).toArray(s,h);h+=4}}}t.needsUpdate=!0})}resetGpuCompute(){this._gpuCompute=void 0,this._simulationRestartRequired=!0}setRestartNotRequired(){this._simulationRestartRequired=!1}resetGpuComputeAndSetDirty(){this.resetGpuCompute(),this.node.setDirty()}resetParticleGroups(){this._particlesCoreGroup=void 0}initialized(){return this._particlesCoreGroup!=null&&this._gpuCompute!=null}_createTextureRenderTargets(){this._createdTexturesByName.forEach((t,r)=>{t.dispose()}),this._createdTexturesByName.clear(),this._variablesByName.forEach((t,r)=>{this._gpuCompute&&this._createdTexturesByName.set(r,this._gpuCompute.createTexture())});let e=this._readonlyAllocations();if(e&&this._gpuCompute)for(let t of e)this._createdTexturesByName.set(t.shaderName(),this._gpuCompute.createTexture())}_textureAllocationsController(){var e;return((e=this.node.assemblerController())==null?void 0:e.assembler.textureAllocationsController())||this._persistedTextureAllocationsController}_readonlyAllocations(){var e;return(e=this._textureAllocationsController())==null?void 0:e.readonlyAllocations()}restartSimulationIfRequired(){this._simulationRestartRequired&&this._restartSimulation()}_restartSimulation(){this._createTextureRenderTargets(),!!this._getPoints()&&(this._fillTextures(),this._variablesByName.forEach((t,r)=>{let n=this._createdTexturesByName.get(r);this._gpuCompute&&n&&(this._gpuCompute.renderTexture(n,t.renderTargets[0]),this._gpuCompute.renderTexture(n,t.renderTargets[1]))}))}_getPoints(){if(!this._particlesCoreGroup)return;let e=this._particlesCoreGroup.coreGeometries(),t=e[0];if(t){let r=t.markedAsInstance(),n=[];for(let s of e)s.markedAsInstance()==r&&n.push(s);let i=[];for(let s of n)for(let a of s.points())i.push(a);return i}else return[]}};var cx=[xo.FLOAT,xo.VEC2,xo.VEC3,xo.VEC4],XV=class extends U{constructor(){super(...arguments);this.name=y.STRING(""),this.type=y.INTEGER(0,{menu:{entries:cx.map((e,t)=>({name:e,value:t}))}})}},kse=new XV,lx=class extends G0{constructor(){super(...arguments);this.paramsConfig=kse}static type(){return"varyingWrite"}initializeNode(){this.addPostDirtyHook("_setMatToRecompile",this._setMatToRecompile.bind(this)),this.io.connection_points.initializeNode(),this.io.connection_points.set_input_name_function(()=>this.inputName()),this.io.connection_points.set_expected_input_types_function(()=>[cx[this.pv.type]]),this.io.connection_points.set_expected_output_types_function(()=>[])}inputName(){return lx.INPUT_NAME}setLines(o){if(o.currentShaderName()==cn.VERTEX){let e=this.glType();if(!e)return;let t=this.pv.name,r=new uc(this,e,t),n=ja.any(this.variableForInput(lx.INPUT_NAME)),i=`${t} = ${n}`;o.addDefinitions(this,[r],cn.VERTEX),o.addBodyLines(this,[i],cn.VERTEX)}}attributeName(){return this.pv.name.trim()}glType(){let o=this.io.inputs.namedInputConnectionPoints()[0];if(o)return o.type()}setGlType(o){this.p.type.set(cx.indexOf(o))}},ux=lx;ux.INPUT_NAME="vertex";var g3=class{static findOutputNodes(e){return e.nodesByType("output")}static findParamGeneratingNodes(e){var t;let r=[];return(t=e.childrenController)==null||t.traverseChildren(n=>{let i=n;i.paramsGenerating()&&r.push(i)}),r}static findVaryingNodes(e){return e.nodesByType(ux.type())}static findAttributeExportNodes(e){return e.nodesByType(ms.type()).filter(r=>r.isExporting())}};var e0=class{constructor(e,t){if(this._name=e,this._size=t,this._position=-1,this._readonly=!1,!e)throw"TextureVariable requires a name"}merge(e){var t;e.readonly()||this.setReadonly(!1),(t=e.graphNodeIds())==null||t.forEach(r=>{this.addGraphNodeId(r)})}setReadonly(e){this._readonly=e}readonly(){return this._readonly}setAllocation(e){this._allocation=e}allocation(){return this._allocation}graphNodeIds(){return this._graphNodeIds}addGraphNodeId(e){this._graphNodeIds=this._graphNodeIds||new Set,this._graphNodeIds.add(e)}name(){return this._name}size(){return this._size}setPosition(e){this._position=e}position(){return this._position}component(){return"xyzw".split("").splice(this._position,this._size).join("")}static fromJSON(e){return new e0(e.name,e.size)}toJSON(e){let t=[];return this._graphNodeIds&&this._graphNodeIds.forEach(r=>{let n=e.graph.nodeFromId(r);if(n){let i=n.path();i&&t.push(i)}}),{name:this.name(),size:this.size(),nodes:t}}};var Bse="texture_",tu=class{constructor(){this._size=0}addVariable(e){this._variables=this._variables||[],this._variables.push(e),e.setPosition(this._size),e.setAllocation(this),this._size+=e.size()}hasSpaceForVariable(e){return this._size+e.size()<=4}shaderName(){var e;return(((e=this.variables())==null?void 0:e.map(r=>r.name()))||["no_variables_allocated"]).join("_SEPARATOR_")}textureName(){return`${Bse}${this.shaderName()}`}variables(){return this._variables}variablesForInputNode(e){var t;return(t=this._variables)==null?void 0:t.filter(r=>{var n;return((n=r.graphNodeIds())==null?void 0:n.has(e.graphNodeId()))||!1})}inputNamesForNode(e){let t=this.variablesForInputNode(e);if(t)return e.type()==uh.ATTRIBUTE?[ms.INPUT_NAME]:t.map(r=>r.name())}variable(e){if(this._variables){for(let t of this._variables)if(t.name()==e)return t}}static fromJSON(e){let t=new tu;for(let r of e){let n=e0.fromJSON(r);t.addVariable(n)}return t}toJSON(e){return this._variables?this._variables.map(t=>t.toJSON(e)):[]}};var YV=class extends U{},Fse=new YV,px=class extends G0{constructor(){super(...arguments);this.paramsConfig=Fse}static type(){return"globals"}initializeNode(){super.initializeNode(),this.lifecycle.onAfterAdded(()=>{var e,t;(t=(e=this.materialNode())==null?void 0:e.assemblerController())==null||t.add_globals_outputs(this)})}setLines(e){e.assembler().set_node_lines_globals(this,e)}};var $V=class extends U{},Use=new $V,Fm=class extends G0{constructor(){super(...arguments);this.paramsConfig=Use}static type(){return"output"}initializeNode(){super.initializeNode(),this.addPostDirtyHook("_setMatToRecompile",this._setMatToRecompile.bind(this)),this.lifecycle.onAfterAdded(()=>{var e,t;(t=(e=this.materialNode())==null?void 0:e.assemblerController())==null||t.add_output_inputs(this),this._setMatToRecompile()})}setLines(e){e.assembler().set_node_lines_output(this,e)}};var Vse=["position","normal","color","uv"],ru=class{constructor(){this._writableAllocations=[],this._readonlyAllocations=[]}dispose(){this._writableAllocations.splice(0,this._writableAllocations.length),this._readonlyAllocations.splice(0,this._readonlyAllocations.length)}static _sortNodes(e){let r=e.filter(a=>a.type()==Fm.type()),n=e.filter(a=>a.type()!=Fm.type()),i=n.map(a=>a.path()).sort(),s=new Map;for(let a of n)s.set(a.path(),a);for(let a of i){let c=s.get(a);c&&r.push(c)}return r}allocateConnectionsFromRootNodes(e,t){let r=[];e=ru._sortNodes(e),t=ru._sortNodes(t);for(let n of e){let i=n.graphNodeId();switch(n.type()){case Fm.type():{for(let s of n.io.inputs.namedInputConnectionPoints())if(n.io.inputs.named_input(s.name())){let c=new e0(s.name(),Sh[s.type()]);c.addGraphNodeId(i),r.push(c)}break}case ms.type():{let s=n,a=s.connected_input_node(),c=s.connected_input_connection_point();if(a&&c){let l=new e0(s.attributeName(),Sh[c.type()]);l.addGraphNodeId(i),r.push(l)}break}}}for(let n of t){let i=n.graphNodeId();switch(n.type()){case px.type():{let s=n;for(let a of s.io.outputs.used_output_names())if(Vse.includes(a)){let l=s.io.outputs.namedOutputConnectionPointsByName(a);if(l){let u=l.type(),p=new e0(a,Sh[u]);p.addGraphNodeId(i),r.push(p)}}break}case ms.type():{let s=n,a=s.output_connection_point();if(a){let c=new e0(s.attributeName(),Sh[a.type()]);s.isExporting()||c.setReadonly(!0),c.addGraphNodeId(i),r.push(c)}break}}}this._allocateVariables(r)}_allocateVariables(e){let r=this._ensureVariablesAreUnique(e).sort((n,i)=>n.size()<i.size()?1:-1);for(let n of r)n.readonly()?this._allocateVariable(n,this._readonlyAllocations):this._allocateVariable(n,this._writableAllocations)}_ensureVariablesAreUnique(e){let t=new Map;for(let n of e)Vt.pushOnArrayAtEntry(t,n.name(),n);let r=[];return t.forEach((n,i)=>{let s=n[0];r.push(s);for(let a=1;a<n.length;a++){let c=n[a];s.merge(c)}}),r}_allocateVariable(e,t){let r=this.hasVariable(e.name());if(r)throw"no variable should be allocated since they have been made unique before";for(let n of t)!r&&n.hasSpaceForVariable(e)&&(n.addVariable(e),r=!0);if(!r){let n=new tu;t.push(n),n.addVariable(e)}}_addWritableAllocation(e){this._writableAllocations.push(e)}_addReadonlyAllocation(e){this._readonlyAllocations.push(e)}readonlyAllocations(){return this._readonlyAllocations}shaderNames(){let e=this._writableAllocations.map(t=>t.shaderName());return Qe.uniq(e)}createShaderConfigs(){return[]}allocationForShaderName(e){let t=this._writableAllocations.filter(r=>r.shaderName()==e)[0];return t||this._readonlyAllocations.filter(r=>r.shaderName()==e)[0]}inputNamesForShaderName(e,t){let r=this.allocationForShaderName(t);if(r)return r.inputNamesForNode(e)}variable(e){for(let t of this._writableAllocations){let r=t.variable(e);if(r)return r}for(let t of this._readonlyAllocations){let r=t.variable(e);if(r)return r}}variables(){let e=this._writableAllocations.map(r=>r.variables()||[]).flat(),t=this._writableAllocations.map(r=>r.variables()||[]).flat();return e.concat(t)}hasVariable(e){return this.variables().map(r=>r.name()).includes(e)}static fromJSON(e){let t=new ru;for(let r of e.writable){let n=Object.keys(r)[0],i=r[n],s=tu.fromJSON(i);t._addWritableAllocation(s)}for(let r of e.readonly){let n=Object.keys(r)[0],i=r[n],s=tu.fromJSON(i);t._addReadonlyAllocation(s)}return t}toJSON(e){let t=this._writableAllocations.map(n=>({[n.shaderName()]:n.toJSON(e)})),r=this._readonlyAllocations.map(n=>({[n.shaderName()]:n.toJSON(e)}));return{writable:t,readonly:r}}print(e){console.warn(JSON.stringify(this.toJSON(e),[""],2))}};var dx=class extends Gf{constructor(e){super(e);this.node=e}toJSON(){let e=this.node.assemblerController();if(!e)return;let t={};this.node.shaders_by_name().forEach((u,p)=>{t[p]=u});let n=e.assembler.textureAllocationsController().toJSON(this.node.scene()),i=[],s=new Sr,a=e.assembler.param_configs();for(let u of a)i.push([u.name(),u.uniformName()]),s.uniforms[u.uniformName()]=u.uniform();let c=this._materialToJson(s,{node:this.node,suffix:"main"});return{shaders_by_name:t,texture_allocations:n,param_uniform_pairs:i,uniforms_owner:c||{}}}load(e){this.node.assemblerController()||(this._loaded_data=e,this.node.init_with_persisted_config())}loaded_data(){return this._loaded_data}shaders_by_name(){if(this._loaded_data){let e=new Map,t=Object.keys(this._loaded_data.shaders_by_name);for(let r of t)e.set(r,this._loaded_data.shaders_by_name[r]);return e}}texture_allocations_controller(){if(this._loaded_data)return ru.fromJSON(this._loaded_data.texture_allocations)}uniforms(){if(this._loaded_data){let e=this._loadMaterial(this._loaded_data.uniforms_owner);return(e==null?void 0:e.uniforms)||{}}}};var KV=class extends U{constructor(){super(...arguments);this.startFrame=y.FLOAT(u0.START_FRAME,{range:[0,1e3],rangeLocked:[!0,!1]}),this.active=y.BOOLEAN(1,{cook:!1}),this.autoTexturesSize=y.BOOLEAN(1),this.maxTexturesSize=y.VECTOR2([1024,1024],{visibleIf:{autoTexturesSize:1}}),this.texturesSize=y.VECTOR2([64,64],{visibleIf:{autoTexturesSize:0}}),this.dataType=y.INTEGER(0,{menu:{entries:sx.map((e,t)=>({value:t,name:e}))}}),this.reset=y.BUTTON(null,{callback:(e,t)=>{v3.PARAM_CALLBACK_reset(e)}}),this.material=y.NODE_PATH("",{nodeSelection:{context:oe.MAT},dependentOnFoundNode:!1})}},Gse=new KV,v3=class extends Ye{constructor(){super(...arguments);this.paramsConfig=Gse,this._debugCook=!1,this._assemblerController=this._createAssemblerController(),this.persisted_config=new dx(this),this._particlesGlobalsHandler=new _s(_s.PARTICLE_SIM_UV,Bm.PARTICLES_SHADER),this._shaders_by_name=new Map,this.gpuController=new ax(this),this.renderController=new ix(this),this._resetMaterialIfDirtyBound=this._resetMaterialIfDirty.bind(this),this._childrenControllerContext=oe.GL}static type(){return"particlesSystemGpu"}dispose(){super.dispose(),this.gpuController.dispose()}debugMessage(e){!this._debugCook||console.log(e)}assemblerController(){return this._assemblerController}usedAssembler(){return Pn.GL_PARTICLES}_createAssemblerController(){return Q.assemblersRegister.assembler(this,this.usedAssembler())}shaders_by_name(){return this._shaders_by_name}static require_webgl2(){return!0}static PARAM_CALLBACK_reset(e){e.PARAM_CALLBACK_reset()}PARAM_CALLBACK_reset(){this.gpuController.resetGpuComputeAndSetDirty()}static displayedInputNames(){return["points to emit particles from"]}initializeNode(){this.io.inputs.setCount(1),this.io.inputs.initInputsClonedState(ke.NEVER),this.addPostDirtyHook("_resetMaterialIfDirty",this._resetMaterialIfDirtyBound)}createNode(e,t){return super.createNode(e,t)}children(){return super.children()}nodesByType(e){return super.nodesByType(e)}childrenAllowed(){return this.assemblerController()?super.childrenAllowed():(this.scene().markAsReadOnly(this),!1)}async _resetMaterialIfDirty(){this.p.material.isDirty()&&(this.renderController.resetRenderMaterial(),this.isOnStartFrame()||(this.debugMessage("particles:this.renderController.initRenderMaterial START"),await this.renderController.initRenderMaterial(),this.debugMessage("particles:this.renderController.initRenderMaterial END")))}isOnStartFrame(){return this.scene().frame()==this.pv.startFrame}async cook(e){this.gpuController.setRestartNotRequired();let t=e[0];this.compileIfRequired();let r=this.isOnStartFrame();r&&this.gpuController.resetParticleGroups(),this.gpuController.initialized()||(this.debugMessage("particles:this.gpuController.init(coreGroup) START"),await this.gpuController.init(t),this.debugMessage("particles:this.gpuController.init(coreGroup) END")),this.renderController.initialized()||(this.renderController.initCoreGroup(t),this.debugMessage("particles:this.renderController.initRenderMaterial() START"),await this.renderController.initRenderMaterial(),this.debugMessage("particles:this.renderController.initRenderMaterial() END")),this.gpuController.restartSimulationIfRequired(),this.gpuController.computeSimulationIfRequired(0),r?this.setCoreGroup(t):this.cookController.endCook()}async compileIfRequired(){var e;if((e=this.assemblerController())==null?void 0:e.compileRequired()){this.debugMessage("particles:this.run_assembler() START");try{await this.run_assembler()}catch(t){let r=t.message||"failed to compile";this.states.error.set(r)}this.debugMessage("particles:this.run_assembler() END")}}async run_assembler(){let e=this.assemblerController();if(!e)return;let t=this._findExportNodes();if(t.length>0){let n=t;e.setAssemblerGlobalsHandler(this._particlesGlobalsHandler),e.assembler.set_root_nodes(n),e.assembler.compile(),e.post_compile()}let r=e.assembler.shaders_by_name();this._setShaderNames(r)}_setShaderNames(e){this._shaders_by_name=e,this.gpuController.setShadersByName(this._shaders_by_name),this.renderController.setShadersByName(this._shaders_by_name),this.gpuController.resetGpuCompute(),this.gpuController.resetParticleGroups()}init_with_persisted_config(){let e=this.persisted_config.shaders_by_name(),t=this.persisted_config.texture_allocations_controller();e&&t&&(this._setShaderNames(e),this.gpuController.setPersistedTextureAllocationController(t))}_findExportNodes(){let e=g3.findAttributeExportNodes(this),t=g3.findOutputNodes(this);if(t.length==0&&this.states.error.set("one output node is required"),t.length>1)return this.states.error.set("only one output node is allowed"),[];let r=t[0];return r&&e.push(r),e}};var zse=new M(0,0,1),Hse=new M(0,0,1),jse=new M(0,1,0),ou=class extends Ke{constructor(){super(...arguments);this._coreTransform=new Yt,this._size=new M,this._center=new M,this._segmentsCount=new z(1,1)}static type(){return"plane"}cook(e,t){let r=e[0];return r?this._cook_with_input(r,t):this._cook_without_input(t)}_cook_without_input(e){let t=this._create_plane(e.size,e);this._coreTransform.rotateGeometry(t,zse,e.direction);let r=this._coreTransform.translationMatrix(e.center);return t.applyMatrix4(r),this.createCoreGroupFromGeometry(t)}_cook_with_input(e,t){let r=e.boundingBox();r.getSize(this._size),r.getCenter(this._center);let n=new z(this._size.x,this._size.z),i=this._create_plane(n,t);this._coreTransform.rotateGeometry(i,Hse,jse);let s=this._coreTransform.translationMatrix(this._center);return i.applyMatrix4(s),this.createCoreGroupFromGeometry(i)}_create_plane(e,t){return e=e.clone(),t.useSegmentsCount?(this._segmentsCount.x=Math.floor(t.segments.x),this._segmentsCount.y=Math.floor(t.segments.y)):t.stepSize>0&&(this._segmentsCount.x=Math.floor(e.x/t.stepSize),this._segmentsCount.y=Math.floor(e.y/t.stepSize),e.x=this._segmentsCount.x*t.stepSize,e.y=this._segmentsCount.y*t.stepSize),new Ts(e.x,e.y,this._segmentsCount.x,this._segmentsCount.y)}};ou.DEFAULT_PARAMS={size:new z(1,1),useSegmentsCount:!1,stepSize:1,segments:new z(1,1),direction:new M(0,1,0),center:new M(0,0,0)};ou.INPUT_CLONED_STATE=ke.NEVER;var kd=ou.DEFAULT_PARAMS,JV=class extends U{constructor(){super(...arguments);this.size=y.VECTOR2(kd.size),this.useSegmentsCount=y.BOOLEAN(kd.useSegmentsCount),this.stepSize=y.FLOAT(kd.stepSize,{range:[.001,1],rangeLocked:[!1,!1],visibleIf:{useSegmentsCount:0}}),this.segments=y.VECTOR2(kd.segments,{visibleIf:{useSegmentsCount:1}}),this.direction=y.VECTOR3(kd.direction),this.center=y.VECTOR3(kd.center)}},Wse=new JV,hx=class extends Ye{constructor(){super(...arguments);this.paramsConfig=Wse}static type(){return"plane"}static displayedInputNames(){return["geometry to create plane from (optional)"]}initializeNode(){this.io.inputs.setCount(0,1),this.io.inputs.initInputsClonedState(ou.INPUT_CLONED_STATE)}cook(e){this._operation=this._operation||new ou(this.scene(),this.states);let t=this._operation.cook(e,this.pv);this.setCoreGroup(t)}};var Um=class extends Ke{static type(){return"restAttributes"}cook(e,t){let n=e[0].objectsWithGeo();return t.tposition&&this._create_rest_attribute(n,t.position,t.restP),t.tnormal&&this._create_rest_attribute(n,t.normal,t.restN),this.createCoreGroupFromObjects(n)}_create_rest_attribute(e,t,r){for(let n of e){let i=n.geometry;if(i){let s=i.getAttribute(t);s&&i.setAttribute(r,s.clone())}}}};Um.DEFAULT_PARAMS={tposition:!0,position:"position",restP:"restP",tnormal:!0,normal:"normal",restN:"restN"};var Bd=Um.DEFAULT_PARAMS,ZV=class extends U{constructor(){super(...arguments);this.tposition=y.BOOLEAN(Bd.tposition),this.position=y.STRING(Bd.position,{visibleIf:{tposition:!0}}),this.restP=y.STRING(Bd.restP,{visibleIf:{tposition:!0}}),this.tnormal=y.BOOLEAN(Bd.tnormal),this.normal=y.STRING(Bd.normal,{visibleIf:{tnormal:!0}}),this.restN=y.STRING(Bd.restN,{visibleIf:{tnormal:!0}})}},qse=new ZV,fx=class extends Ye{constructor(){super(...arguments);this.paramsConfig=qse}static type(){return"restAttributes"}initializeNode(){this.io.inputs.setCount(1),this.io.inputs.initInputsClonedState([ke.FROM_NODE])}cook(e){this._operation=this._operation||new Um(this.scene(),this.states);let t=this._operation.cook(e,this.pv);this.setCoreGroup(t)}};var No=new mn,mx=class{constructor(e,t){this.additionalAttributeNames=t,this.randomFunction=Math.random,this.additionalAttributes=new Map,this.weightAttribute=null,this.distribution=null;let r=e.geometry;if(!r.isBufferGeometry||r.attributes.position.itemSize!==3)throw new Error("THREE.MeshSurfaceSampler: Requires BufferGeometry triangle mesh.");r.index&&(console.warn("THREE.MeshSurfaceSampler: Converting geometry to non-indexed BufferGeometry."),r=r.toNonIndexed()),this.geometry=r,this.positionAttribute=this.geometry.getAttribute("position");for(let n of t){let i=this.geometry.getAttribute(n);i&&this.additionalAttributes.set(n,i)}}setWeightAttribute(e){return this.weightAttribute=e?this.geometry.getAttribute(e):null,this}build(){let e=this.positionAttribute,t=this.weightAttribute,r=new Float32Array(e.count/3);for(let i=0;i<e.count;i+=3){let s=1;t&&(s=t.getX(i)+t.getX(i+1)+t.getX(i+2)),No.a.fromBufferAttribute(e,i),No.b.fromBufferAttribute(e,i+1),No.c.fromBufferAttribute(e,i+2),s*=No.getArea(),r[i/3]=s}this.distribution=new Float32Array(e.count/3);let n=0;for(let i=0;i<r.length;i++)n+=r[i],this.distribution[i]=n;return this}setRandomGenerator(e){return this.randomFunction=e,this}sample(e,t,r,n){let i=this.distribution[this.distribution.length-1],s=this.binarySearch(this.randomFunction(e)*i);return this.sampleFace(e,s,t,r,n)}binarySearch(e){let t=this.distribution,r=0,n=t.length-1,i=-1;for(;r<=n;){let s=Math.ceil((r+n)/2);if(s===0||t[s-1]<=e&&t[s]>e){i=s;break}else e<t[s]?n=s-1:r=s+1}return i}sampleFace(e,t,r,n,i){let s=this.randomFunction(e*(t+1456)),a=this.randomFunction((e+9851)*(t+7646));if(s+a>1&&(s=1-s,a=1-a),No.a.fromBufferAttribute(this.positionAttribute,t*3),No.b.fromBufferAttribute(this.positionAttribute,t*3+1),No.c.fromBufferAttribute(this.positionAttribute,t*3+2),r.set(0,0,0).addScaledVector(No.a,s).addScaledVector(No.b,a).addScaledVector(No.c,1-(s+a)),n!==void 0&&No.getNormal(n),i){let c=0;for(let l of this.additionalAttributeNames){let u=this.additionalAttributes.get(l);u&&(No.a.fromBufferAttribute(u,t*3),No.b.fromBufferAttribute(u,t*3+1),No.c.fromBufferAttribute(u,t*3+2),i[c].set(0,0,0).addScaledVector(No.a,s).addScaledVector(No.b,a).addScaledVector(No.c,1-(s+a))),c++}}return this}};var Fd=class extends Ke{constructor(){super(...arguments);this._position=new M,this._normal=new M}static type(){return"scatter"}async cook(e,t){let r=e[0],n=r.objectsWithGeo()[0],i=n,s=n.geometry;s.index&&(s=s.toNonIndexed(),n=new ct(s));let a=t.transferAttributes,c=[];a&&(c=r.attribNamesMatchingMask(t.attributesToTransfer));let l=new mx(n,c);if(t.useWeightAttribute){let w=t.weightAttribute.trim();w!=""&&l.setWeightAttribute(w)}let u=2454*t.seed%Number.MAX_SAFE_INTEGER;l.setRandomGenerator(w=>Mr.randFloat(u,w)),l.build();let p=t.pointsCount,d=new Array(p*3),h=new Array(p*3),m=new Array(c.length),f=new Array(c.length),v=new Map,g=new Array(c.length),_=new Map;for(let w=0;w<c.length;w++){let O=c[w];m[w]=new M;let C=n.geometry.getAttribute(c[w]).itemSize;v.set(O,C),f[w]=C,g[w]=new Array(p*C),_.set(O,g[w])}let T=c.length>0,b=this._position,x=this._normal,A=0;for(let w=0;w<p;w++)if(l.sample(w,b,x,m),A=w*3,b.toArray(d,A),x.toArray(h,A),T){let O=0;for(let C of m)C.toArray(g[O],w*f[O]),O++}let E=new Re;E.setAttribute(mr.POSITION,new Tt(new Float32Array(d),3)),E.setAttribute(mr.NORMAL,new Tt(new Float32Array(h),3));for(let w of c){let O=v.get(w),C=_.get(w);O!=null&&C!=null&&E.setAttribute(w,new Tt(new Float32Array(C),O))}if(t.addIdAttribute||t.addIdnAttribute){let w=t.pointsCount,O=Qe.range(w);t.addIdAttribute&&E.setAttribute("id",new Tt(new Float32Array(O),1));let C=O.map(N=>N/(w-1));t.addIdnAttribute&&E.setAttribute("idn",new Tt(new Float32Array(C),1))}let S=this.createObject(E,jt.POINTS);return S.position.copy(i.position),S.rotation.copy(i.rotation),S.scale.copy(i.scale),S.matrix.copy(i.matrix),this.createCoreGroupFromObjects([S])}};Fd.DEFAULT_PARAMS={pointsCount:100,seed:0,useWeightAttribute:!1,weightAttribute:"",transferAttributes:!1,attributesToTransfer:"",addIdAttribute:!0,addIdnAttribute:!0};Fd.INPUT_CLONED_STATE=ke.FROM_NODE;var dc=Fd.DEFAULT_PARAMS,QV=class extends U{constructor(){super(...arguments);this.pointsCount=y.INTEGER(dc.pointsCount,{range:[0,1e3],rangeLocked:[!0,!1]}),this.seed=y.INTEGER(dc.seed,{range:[0,100],rangeLocked:[!0,!1]}),this.useWeightAttribute=y.BOOLEAN(dc.useWeightAttribute),this.weightAttribute=y.STRING(dc.weightAttribute,{visibleIf:{useWeightAttribute:1}}),this.transferAttributes=y.BOOLEAN(dc.transferAttributes),this.attributesToTransfer=y.STRING(dc.attributesToTransfer,{visibleIf:{transferAttributes:1}}),this.addIdAttribute=y.BOOLEAN(dc.addIdAttribute),this.addIdnAttribute=y.BOOLEAN(dc.addIdnAttribute)}},Xse=new QV,_x=class extends Ye{constructor(){super(...arguments);this.paramsConfig=Xse}static type(){return"scatter"}static displayedInputNames(){return["geometry to scatter points onto"]}initializeNode(){this.io.inputs.setCount(1),this.io.inputs.initInputsClonedState(ke.NEVER)}async cook(e){this._operation=this._operation||new Fd(this.scene(),this.states);let t=await this._operation.cook(e,this.pv);this.setCoreGroup(t)}};var wi={default:0,isocahedron:1},eG=["default","isocahedron"],nu=class extends Ke{static type(){return"sphere"}cook(e,t){let r=e[0];return r?this._cook_with_input(r,t):this._cook_without_input(t)}_cook_without_input(e){let t=this._create_required_geometry(e);return t.translate(e.center.x,e.center.y,e.center.z),this.createCoreGroupFromGeometry(t)}_cook_with_input(e,t){let r=e.boundingBox(),n=r.max.clone().sub(r.min),i=r.max.clone().add(r.min).multiplyScalar(.5),s=this._create_required_geometry(t);return s.translate(t.center.x,t.center.y,t.center.z),s.translate(i.x,i.y,i.z),s.scale(n.x,n.y,n.z),this.createCoreGroupFromGeometry(s)}_create_required_geometry(e){return e.type==wi.default?this._create_default_sphere(e):this._create_default_isocahedron(e)}_create_default_sphere(e){return e.open?new jl(e.radius,e.resolution.x,e.resolution.y,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength):new jl(e.radius,e.resolution.x,e.resolution.y)}_create_default_isocahedron(e){return new Id(e.radius,e.detail)}};nu.DEFAULT_PARAMS={type:wi.default,radius:1,resolution:new z(30,30),open:!1,phiStart:0,phiLength:Math.PI*2,thetaStart:0,thetaLength:Math.PI,detail:1,center:new M(0,0,0)};nu.INPUT_CLONED_STATE=ke.FROM_NODE;var hc=nu.DEFAULT_PARAMS,tG=class extends U{constructor(){super(...arguments);this.type=y.INTEGER(hc.type,{menu:{entries:eG.map(e=>({name:e,value:wi[e]}))}}),this.radius=y.FLOAT(hc.radius,{visibleIf:{type:wi.default}}),this.resolution=y.VECTOR2(hc.resolution,{visibleIf:{type:wi.default}}),this.open=y.BOOLEAN(hc.open,{visibleIf:{type:wi.default}}),this.phiStart=y.FLOAT(hc.phiStart,{range:[0,Math.PI*2],visibleIf:{type:wi.default,open:!0}}),this.phiLength=y.FLOAT("$PI*2",{range:[0,Math.PI*2],visibleIf:{type:wi.default,open:!0}}),this.thetaStart=y.FLOAT(hc.thetaStart,{range:[0,Math.PI],visibleIf:{type:wi.default,open:!0}}),this.thetaLength=y.FLOAT("$PI",{range:[0,Math.PI],visibleIf:{type:wi.default,open:!0}}),this.detail=y.INTEGER(hc.detail,{range:[0,5],rangeLocked:[!0,!1],visibleIf:{type:wi.isocahedron}}),this.center=y.VECTOR3(hc.center)}},Yse=new tG,gx=class extends Ye{constructor(){super(...arguments);this.paramsConfig=Yse}static type(){return"sphere"}initializeNode(){this.io.inputs.setCount(0,1),this.io.inputs.initInputsClonedState(nu.INPUT_CLONED_STATE)}cook(e){this._operation=this._operation||new nu(this.scene(),this.states);let t=this._operation.cook(e,this.pv);this.setCoreGroup(t)}};var Vm=["set params","update matrix"],iu=class extends Ke{constructor(){super(...arguments);this._coreTransform=new Yt,this._point_pos=new M,this._object_scale=new M,this._r=new M,this._object_position=new M}static type(){return"transform"}cook(e,t){let r=e[0].objects();return this._applyTransform(r,t),e[0]}_applyTransform(e,t){let r=_0[t.applyOn];switch(r){case m0.GEOMETRIES:return this._updateGeometries(e,t);case m0.OBJECTS:return this._updateObjects(e,t)}Be.unreachable(r)}_updateGeometries(e,t){let r=this._matrix(t);if(t.group.trim()==="")for(let n of e){let i=n.geometry;i&&(i.translate(-t.pivot.x,-t.pivot.y,-t.pivot.z),i.applyMatrix4(r),i.translate(t.pivot.x,t.pivot.y,t.pivot.z))}else{let i=Fn._fromObjects(e).pointsFromGroup(t.group);for(let s of i){let a=s.getPosition(this._point_pos).sub(t.pivot);a.applyMatrix4(r),s.setPosition(a.add(t.pivot))}}}_updateObjects(e,t){let r=Vm[t.objectMode];switch(r){case"set params":return this._update_objects_params(e,t);case"update matrix":return this._update_objects_matrix(e,t)}Be.unreachable(r)}_update_objects_params(e,t){for(let r of e){r.position.copy(t.t);let n=Rs[t.rotationOrder];this._r.copy(t.r).multiplyScalar(q0),r.rotation.set(this._r.x,this._r.y,this._r.z,n),this._object_scale.copy(t.s).multiplyScalar(t.scale),r.scale.copy(this._object_scale),r.updateMatrix()}}_update_objects_matrix(e,t){let r=this._matrix(t);for(let n of e)this._object_position.copy(n.position),n.position.multiplyScalar(0),n.updateMatrix(),n.applyMatrix4(r),n.position.add(this._object_position),n.updateMatrix()}_matrix(e){return this._coreTransform.matrix(e.t,e.r,e.s,e.scale,Rs[e.rotationOrder])}};iu.DEFAULT_PARAMS={applyOn:_0.indexOf(m0.GEOMETRIES),objectMode:Vm.indexOf("set params"),group:"",rotationOrder:Rs.indexOf(Bc.XYZ),t:new M(0,0,0),r:new M(0,0,0),s:new M(1,1,1),scale:1,pivot:new M(0,0,0)};iu.INPUT_CLONED_STATE=ke.FROM_NODE;var vx=(o=>(o.SHEAR="shear",o.TRANSFORM="transform",o.UV_LAYOUT="uvLayout",o.UV_TRANSFORM="uvTransform",o.UV_UNWRAP="uvUnwrap",o))(vx||{});var H0=iu.DEFAULT_PARAMS,rG=class extends U{constructor(){super(...arguments);this.applyOn=y.INTEGER(H0.applyOn,{menu:{entries:_0.map((e,t)=>({name:e,value:t}))}}),this.objectMode=y.INTEGER(H0.objectMode,{visibleIf:{applyOn:_0.indexOf(m0.OBJECTS)},menu:{entries:Vm.map((e,t)=>({name:e,value:t}))}}),this.group=y.STRING(H0.group,{visibleIf:{applyOn:_0.indexOf(m0.GEOMETRIES)}}),this.rotationOrder=y.INTEGER(H0.rotationOrder,{menu:{entries:Rs.map((e,t)=>({name:e,value:t}))}}),this.t=y.VECTOR3(H0.t),this.r=y.VECTOR3(H0.r),this.s=y.VECTOR3(H0.s),this.scale=y.FLOAT(H0.scale,{range:[0,10]}),this.pivot=y.VECTOR3(H0.pivot,{visibleIf:{applyOn:_0.indexOf(m0.GEOMETRIES)}})}},$se=new rG,yx=class extends Ye{constructor(){super(...arguments);this.paramsConfig=$se}static type(){return vx.TRANSFORM}static displayedInputNames(){return["geometries or objects to transform"]}initializeNode(){this.io.inputs.setCount(1),this.io.inputs.initInputsClonedState(iu.INPUT_CLONED_STATE)}setApplyOn(e){this.p.applyOn.set(_0.indexOf(e))}setObjectMode(e){this.p.objectMode.set(Vm.indexOf(e))}cook(e){this._operation=this._operation||new iu(this.scene(),this.states);let t=this._operation.cook(e,this.pv);this.setCoreGroup(t)}};var xx={nodes:[y7,Xh,W_,Yh,Wc,x7,X_,Y_,ag,Qp,cg,sg,lg,xi,rd,ug,pg,hg,Nf,w9,Of,_g,xg,B9,kf,U9,Og,N0,Ju,Ha,ul,H9,j9,Gg,jg,qg,Xg,Yg,Kg,Zg,Qg,rv,nv,Qf,av,cv,lv,uv,Nv,Pv,d2,Fv,Jv,Zv,Qv,ey,ry,ny,iy,Rh,fy,my,p3,zy,Hy,qy,Ky,Zy,Qy,ex,tx,rx,_3,ox,nx,v3,hx,fx,_x,gx,yx],operations:[]};var hMt=async function(o){let{domElement:e,sceneData:t,onProgress:r,autoPlay:n}=o;if(o.runRegister!=null?o.runRegister:!0){for(let l of xx.nodes)Q.registerNode(l);for(let l of xx.operations)Q.registerOperation(l);R6.run(Q),Q}Q.libs.setRoot("./three/js/libs");let s="scene_01",{scene:a,viewer:c}=await Ph.loadSceneData({domElement:e,sceneName:s,configureScene:eO,sceneData:t,onProgress:r,assetsRoot:"",autoPlay:n});return{scene:a,viewer:c}};export{Q as Poly,hMt as loadSceneFromSceneData_scene_01};
/*!
 * CSSPlugin 3.8.0
 * https://greensock.com
 *
 * Copyright 2008-2021, GreenSock. All rights reserved.
 * Subject to the terms at https://greensock.com/standard-license or for
 * Club GreenSock members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/
/*!
 * GSAP 3.8.0
 * https://greensock.com
 *
 * @license Copyright 2008-2021, GreenSock. All rights reserved.
 * Subject to the terms at https://greensock.com/standard-license or for
 * Club GreenSock members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
/**
 * Tone.js
 * @author Yotam Mann
 * @license http://opensource.org/licenses/MIT MIT License
 * @copyright 2014-2019 Yotam Mann
 */
