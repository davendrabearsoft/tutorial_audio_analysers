import{a as lx}from"./chunk-4EIDCPOJ.js";import{a as Qx,b as gr,c as Mr,d as i3}from"./chunk-UWFHNPCD.js";import{A as ey,a as Nt,b as w,c as Bl,d as Fl,e as Ve,f as Ie,g as Ot,h as Yx,i as $x,j as Kx,k as Ce,l as o3,m as km,n as vt,o as De,p as Bt,q as Zx,r as as,s as si,t as lt,u as ut,v as Xs,w as Xi,x as ur,y as cs,z as Br}from"./chunk-EF7P6KSQ.js";import{$ as Tn,$a as B2,$b as Gl,A as vx,Aa as zr,Ab as Lm,B as xx,Ba as xm,Bb as Im,C as yx,Ca as ym,Cb as ni,D as bx,Da as ji,Db as Dm,E as Tx,Ea as bm,F as Ax,Fa as Vx,G as Cx,Ga as st,Gb as Wx,H as Ex,Ha as Dl,Hb as r3,I as Sx,Ia as Tm,Ib as lh,J as wx,Ja as xi,Jb as L0,K as Mx,Ka as Wi,Kb as uh,L as Nx,La as Am,Lb as qi,M as Ox,Ma as Cm,Mb as qs,N as O2,Na as Em,Nb as yi,O as Px,Oa as Sm,Ob as ph,P as Rx,Pa as wm,Pb as kl,Q as Lx,Qa as Mm,Qb as qx,R as Ix,Ra as Nm,Rb as Xx,S as Ll,Sa as Om,Sb as zo,T as um,Ta as Pm,Tb as G,U as pm,Ua as P2,Ub as Ul,V as Oo,Va as R2,W as hm,Wa as L2,Wb as he,X as dm,Xa as I2,Xb as Jx,Y as fm,Ya as Gx,Yb as I0,Z as mm,Za as D2,Zb as Vl,_ as Dx,_a as k2,_b as Bm,a as ux,aa as oi,ab as F2,ac as io,b as Ka,ba as vi,bb as U2,bc as Ho,c as Ja,ca as zs,cb as V2,d as px,da as Hs,db as G2,e as w2,ea as ii,eb as z2,f as hx,fa as An,fb as H2,g as dx,ga as Hi,gb as j2,h as Pl,ha as kt,hb as W2,i as lm,ia as P0,ib as q2,j as Gs,ja as nt,jb as X2,k as oo,ka as Qa,kb as Y2,l as Dt,la as kx,lb as $2,m as uo,ma as ec,mb as K2,na as Bx,nb as J2,o as ri,oa as at,ob as js,p as Za,pa as Il,pb as Ws,q as sh,qa as Fx,qb as Rm,r as ah,ra as Cn,rb as Z2,s as ch,sa as Ux,sb as Q2,t as fx,ta as Go,tb as e3,u as Rl,ua as _m,ub as zx,v as mx,va as gm,vb as Hx,w as _x,wa as En,wb as jx,x as M2,xa as vm,xb as t3,y as N2,ya as R0,yb as Hr,z as gx,za as Wt,zb as bt}from"./chunk-CQ5QUQVH.js";import{a as ce,b as S2,c as bn}from"./chunk-KBNISIIW.js";var VA=ce((Hhe,UA)=>{function tG(){this.__data__=[],this.size=0}UA.exports=tG});var k3=ce((jhe,GA)=>{function rG(i,e){return i===e||i!==i&&e!==e}GA.exports=rG});var gh=ce((Whe,zA)=>{var oG=k3();function iG(i,e){for(var t=i.length;t--;)if(oG(i[t][0],e))return t;return-1}zA.exports=iG});var jA=ce((qhe,HA)=>{var nG=gh(),sG=Array.prototype,aG=sG.splice;function cG(i){var e=this.__data__,t=nG(e,i);if(t<0)return!1;var r=e.length-1;return t==r?e.pop():aG.call(e,t,1),--this.size,!0}HA.exports=cG});var qA=ce((Xhe,WA)=>{var lG=gh();function uG(i){var e=this.__data__,t=lG(e,i);return t<0?void 0:e[t][1]}WA.exports=uG});var YA=ce((Yhe,XA)=>{var pG=gh();function hG(i){return pG(this.__data__,i)>-1}XA.exports=hG});var KA=ce(($he,$A)=>{var dG=gh();function fG(i,e){var t=this.__data__,r=dG(t,i);return r<0?(++this.size,t.push([i,e])):t[r][1]=e,this}$A.exports=fG});var vh=ce((Khe,JA)=>{var mG=VA(),_G=jA(),gG=qA(),vG=YA(),xG=KA();function eu(i){var e=-1,t=i==null?0:i.length;for(this.clear();++e<t;){var r=i[e];this.set(r[0],r[1])}}eu.prototype.clear=mG;eu.prototype.delete=_G;eu.prototype.get=gG;eu.prototype.has=vG;eu.prototype.set=xG;JA.exports=eu});var QA=ce((Jhe,ZA)=>{var yG=vh();function bG(){this.__data__=new yG,this.size=0}ZA.exports=bG});var tC=ce((Zhe,eC)=>{function TG(i){var e=this.__data__,t=e.delete(i);return this.size=e.size,t}eC.exports=TG});var oC=ce((Qhe,rC)=>{function AG(i){return this.__data__.get(i)}rC.exports=AG});var nC=ce((ede,iC)=>{function CG(i){return this.__data__.has(i)}iC.exports=CG});var B3=ce((tde,sC)=>{var EG=typeof global=="object"&&global&&global.Object===Object&&global;sC.exports=EG});var Ki=ce((rde,aC)=>{var SG=B3(),wG=typeof self=="object"&&self&&self.Object===Object&&self,MG=SG||wG||Function("return this")();aC.exports=MG});var Km=ce((ode,cC)=>{var NG=Ki(),OG=NG.Symbol;cC.exports=OG});var hC=ce((ide,pC)=>{var lC=Km(),uC=Object.prototype,PG=uC.hasOwnProperty,RG=uC.toString,xh=lC?lC.toStringTag:void 0;function LG(i){var e=PG.call(i,xh),t=i[xh];try{i[xh]=void 0;var r=!0}catch{}var o=RG.call(i);return r&&(e?i[xh]=t:delete i[xh]),o}pC.exports=LG});var fC=ce((nde,dC)=>{var IG=Object.prototype,DG=IG.toString;function kG(i){return DG.call(i)}dC.exports=kG});var tu=ce((sde,gC)=>{var mC=Km(),BG=hC(),FG=fC(),UG="[object Null]",VG="[object Undefined]",_C=mC?mC.toStringTag:void 0;function GG(i){return i==null?i===void 0?VG:UG:_C&&_C in Object(i)?BG(i):FG(i)}gC.exports=GG});var Ks=ce((ade,vC)=>{function zG(i){var e=typeof i;return i!=null&&(e=="object"||e=="function")}vC.exports=zG});var F3=ce((cde,xC)=>{var HG=tu(),jG=Ks(),WG="[object AsyncFunction]",qG="[object Function]",XG="[object GeneratorFunction]",YG="[object Proxy]";function $G(i){if(!jG(i))return!1;var e=HG(i);return e==qG||e==XG||e==WG||e==YG}xC.exports=$G});var bC=ce((lde,yC)=>{var KG=Ki(),JG=KG["__core-js_shared__"];yC.exports=JG});var CC=ce((ude,AC)=>{var U3=bC(),TC=function(){var i=/[^.]+$/.exec(U3&&U3.keys&&U3.keys.IE_PROTO||"");return i?"Symbol(src)_1."+i:""}();function ZG(i){return!!TC&&TC in i}AC.exports=ZG});var V3=ce((pde,EC)=>{var QG=Function.prototype,ez=QG.toString;function tz(i){if(i!=null){try{return ez.call(i)}catch{}try{return i+""}catch{}}return""}EC.exports=tz});var wC=ce((hde,SC)=>{var rz=F3(),oz=CC(),iz=Ks(),nz=V3(),sz=/[\\^$.*+?()[\]{}|]/g,az=/^\[object .+?Constructor\]$/,cz=Function.prototype,lz=Object.prototype,uz=cz.toString,pz=lz.hasOwnProperty,hz=RegExp("^"+uz.call(pz).replace(sz,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function dz(i){if(!iz(i)||oz(i))return!1;var e=rz(i)?hz:az;return e.test(nz(i))}SC.exports=dz});var NC=ce((dde,MC)=>{function fz(i,e){return i==null?void 0:i[e]}MC.exports=fz});var V0=ce((fde,OC)=>{var mz=wC(),_z=NC();function gz(i,e){var t=_z(i,e);return mz(t)?t:void 0}OC.exports=gz});var Jm=ce((mde,PC)=>{var vz=V0(),xz=Ki(),yz=vz(xz,"Map");PC.exports=yz});var yh=ce((_de,RC)=>{var bz=V0(),Tz=bz(Object,"create");RC.exports=Tz});var DC=ce((gde,IC)=>{var LC=yh();function Az(){this.__data__=LC?LC(null):{},this.size=0}IC.exports=Az});var BC=ce((vde,kC)=>{function Cz(i){var e=this.has(i)&&delete this.__data__[i];return this.size-=e?1:0,e}kC.exports=Cz});var UC=ce((xde,FC)=>{var Ez=yh(),Sz="__lodash_hash_undefined__",wz=Object.prototype,Mz=wz.hasOwnProperty;function Nz(i){var e=this.__data__;if(Ez){var t=e[i];return t===Sz?void 0:t}return Mz.call(e,i)?e[i]:void 0}FC.exports=Nz});var GC=ce((yde,VC)=>{var Oz=yh(),Pz=Object.prototype,Rz=Pz.hasOwnProperty;function Lz(i){var e=this.__data__;return Oz?e[i]!==void 0:Rz.call(e,i)}VC.exports=Lz});var HC=ce((bde,zC)=>{var Iz=yh(),Dz="__lodash_hash_undefined__";function kz(i,e){var t=this.__data__;return this.size+=this.has(i)?0:1,t[i]=Iz&&e===void 0?Dz:e,this}zC.exports=kz});var WC=ce((Tde,jC)=>{var Bz=DC(),Fz=BC(),Uz=UC(),Vz=GC(),Gz=HC();function ru(i){var e=-1,t=i==null?0:i.length;for(this.clear();++e<t;){var r=i[e];this.set(r[0],r[1])}}ru.prototype.clear=Bz;ru.prototype.delete=Fz;ru.prototype.get=Uz;ru.prototype.has=Vz;ru.prototype.set=Gz;jC.exports=ru});var YC=ce((Ade,XC)=>{var qC=WC(),zz=vh(),Hz=Jm();function jz(){this.size=0,this.__data__={hash:new qC,map:new(Hz||zz),string:new qC}}XC.exports=jz});var KC=ce((Cde,$C)=>{function Wz(i){var e=typeof i;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?i!=="__proto__":i===null}$C.exports=Wz});var bh=ce((Ede,JC)=>{var qz=KC();function Xz(i,e){var t=i.__data__;return qz(e)?t[typeof e=="string"?"string":"hash"]:t.map}JC.exports=Xz});var QC=ce((Sde,ZC)=>{var Yz=bh();function $z(i){var e=Yz(this,i).delete(i);return this.size-=e?1:0,e}ZC.exports=$z});var tE=ce((wde,eE)=>{var Kz=bh();function Jz(i){return Kz(this,i).get(i)}eE.exports=Jz});var oE=ce((Mde,rE)=>{var Zz=bh();function Qz(i){return Zz(this,i).has(i)}rE.exports=Qz});var nE=ce((Nde,iE)=>{var eH=bh();function tH(i,e){var t=eH(this,i),r=t.size;return t.set(i,e),this.size+=t.size==r?0:1,this}iE.exports=tH});var aE=ce((Ode,sE)=>{var rH=YC(),oH=QC(),iH=tE(),nH=oE(),sH=nE();function ou(i){var e=-1,t=i==null?0:i.length;for(this.clear();++e<t;){var r=i[e];this.set(r[0],r[1])}}ou.prototype.clear=rH;ou.prototype.delete=oH;ou.prototype.get=iH;ou.prototype.has=nH;ou.prototype.set=sH;sE.exports=ou});var lE=ce((Pde,cE)=>{var aH=vh(),cH=Jm(),lH=aE(),uH=200;function pH(i,e){var t=this.__data__;if(t instanceof aH){var r=t.__data__;if(!cH||r.length<uH-1)return r.push([i,e]),this.size=++t.size,this;t=this.__data__=new lH(r)}return t.set(i,e),this.size=t.size,this}cE.exports=pH});var pE=ce((Rde,uE)=>{var hH=vh(),dH=QA(),fH=tC(),mH=oC(),_H=nC(),gH=lE();function iu(i){var e=this.__data__=new hH(i);this.size=e.size}iu.prototype.clear=dH;iu.prototype.delete=fH;iu.prototype.get=mH;iu.prototype.has=_H;iu.prototype.set=gH;uE.exports=iu});var dE=ce((Lde,hE)=>{function vH(i,e){for(var t=-1,r=i==null?0:i.length;++t<r&&e(i[t],t,i)!==!1;);return i}hE.exports=vH});var mE=ce((Ide,fE)=>{var xH=V0(),yH=function(){try{var i=xH(Object,"defineProperty");return i({},"",{}),i}catch{}}();fE.exports=yH});var G3=ce((Dde,gE)=>{var _E=mE();function bH(i,e,t){e=="__proto__"&&_E?_E(i,e,{configurable:!0,enumerable:!0,value:t,writable:!0}):i[e]=t}gE.exports=bH});var z3=ce((kde,vE)=>{var TH=G3(),AH=k3(),CH=Object.prototype,EH=CH.hasOwnProperty;function SH(i,e,t){var r=i[e];(!(EH.call(i,e)&&AH(r,t))||t===void 0&&!(e in i))&&TH(i,e,t)}vE.exports=SH});var Th=ce((Bde,xE)=>{var wH=z3(),MH=G3();function NH(i,e,t,r){var o=!t;t||(t={});for(var n=-1,s=e.length;++n<s;){var a=e[n],c=r?r(t[a],i[a],a,t,i):void 0;c===void 0&&(c=i[a]),o?MH(t,a,c):wH(t,a,c)}return t}xE.exports=NH});var bE=ce((Fde,yE)=>{function OH(i,e){for(var t=-1,r=Array(i);++t<i;)r[t]=e(t);return r}yE.exports=OH});var ic=ce((Ude,TE)=>{function PH(i){return i!=null&&typeof i=="object"}TE.exports=PH});var CE=ce((Vde,AE)=>{var RH=tu(),LH=ic(),IH="[object Arguments]";function DH(i){return LH(i)&&RH(i)==IH}AE.exports=DH});var ME=ce((Gde,wE)=>{var EE=CE(),kH=ic(),SE=Object.prototype,BH=SE.hasOwnProperty,FH=SE.propertyIsEnumerable,UH=EE(function(){return arguments}())?EE:function(i){return kH(i)&&BH.call(i,"callee")&&!FH.call(i,"callee")};wE.exports=UH});var Zm=ce((zde,NE)=>{var VH=Array.isArray;NE.exports=VH});var PE=ce((Hde,OE)=>{function GH(){return!1}OE.exports=GH});var H3=ce((Ah,nu)=>{var zH=Ki(),HH=PE(),IE=typeof Ah=="object"&&Ah&&!Ah.nodeType&&Ah,RE=IE&&typeof nu=="object"&&nu&&!nu.nodeType&&nu,jH=RE&&RE.exports===IE,LE=jH?zH.Buffer:void 0,WH=LE?LE.isBuffer:void 0,qH=WH||HH;nu.exports=qH});var kE=ce((jde,DE)=>{var XH=9007199254740991,YH=/^(?:0|[1-9]\d*)$/;function $H(i,e){var t=typeof i;return e=e??XH,!!e&&(t=="number"||t!="symbol"&&YH.test(i))&&i>-1&&i%1==0&&i<e}DE.exports=$H});var j3=ce((Wde,BE)=>{var KH=9007199254740991;function JH(i){return typeof i=="number"&&i>-1&&i%1==0&&i<=KH}BE.exports=JH});var UE=ce((qde,FE)=>{var ZH=tu(),QH=j3(),ej=ic(),tj="[object Arguments]",rj="[object Array]",oj="[object Boolean]",ij="[object Date]",nj="[object Error]",sj="[object Function]",aj="[object Map]",cj="[object Number]",lj="[object Object]",uj="[object RegExp]",pj="[object Set]",hj="[object String]",dj="[object WeakMap]",fj="[object ArrayBuffer]",mj="[object DataView]",_j="[object Float32Array]",gj="[object Float64Array]",vj="[object Int8Array]",xj="[object Int16Array]",yj="[object Int32Array]",bj="[object Uint8Array]",Tj="[object Uint8ClampedArray]",Aj="[object Uint16Array]",Cj="[object Uint32Array]",pr={};pr[_j]=pr[gj]=pr[vj]=pr[xj]=pr[yj]=pr[bj]=pr[Tj]=pr[Aj]=pr[Cj]=!0;pr[tj]=pr[rj]=pr[fj]=pr[oj]=pr[mj]=pr[ij]=pr[nj]=pr[sj]=pr[aj]=pr[cj]=pr[lj]=pr[uj]=pr[pj]=pr[hj]=pr[dj]=!1;function Ej(i){return ej(i)&&QH(i.length)&&!!pr[ZH(i)]}FE.exports=Ej});var Qm=ce((Xde,VE)=>{function Sj(i){return function(e){return i(e)}}VE.exports=Sj});var e1=ce((Ch,su)=>{var wj=B3(),GE=typeof Ch=="object"&&Ch&&!Ch.nodeType&&Ch,Eh=GE&&typeof su=="object"&&su&&!su.nodeType&&su,Mj=Eh&&Eh.exports===GE,W3=Mj&&wj.process,Nj=function(){try{var i=Eh&&Eh.require&&Eh.require("util").types;return i||W3&&W3.binding&&W3.binding("util")}catch{}}();su.exports=Nj});var WE=ce((Yde,jE)=>{var Oj=UE(),Pj=Qm(),zE=e1(),HE=zE&&zE.isTypedArray,Rj=HE?Pj(HE):Oj;jE.exports=Rj});var q3=ce(($de,qE)=>{var Lj=bE(),Ij=ME(),Dj=Zm(),kj=H3(),Bj=kE(),Fj=WE(),Uj=Object.prototype,Vj=Uj.hasOwnProperty;function Gj(i,e){var t=Dj(i),r=!t&&Ij(i),o=!t&&!r&&kj(i),n=!t&&!r&&!o&&Fj(i),s=t||r||o||n,a=s?Lj(i.length,String):[],c=a.length;for(var l in i)(e||Vj.call(i,l))&&!(s&&(l=="length"||o&&(l=="offset"||l=="parent")||n&&(l=="buffer"||l=="byteLength"||l=="byteOffset")||Bj(l,c)))&&a.push(l);return a}qE.exports=Gj});var t1=ce((Kde,XE)=>{var zj=Object.prototype;function Hj(i){var e=i&&i.constructor,t=typeof e=="function"&&e.prototype||zj;return i===t}XE.exports=Hj});var X3=ce((Jde,YE)=>{function jj(i,e){return function(t){return i(e(t))}}YE.exports=jj});var KE=ce((Zde,$E)=>{var Wj=X3(),qj=Wj(Object.keys,Object);$E.exports=qj});var ZE=ce((Qde,JE)=>{var Xj=t1(),Yj=KE(),$j=Object.prototype,Kj=$j.hasOwnProperty;function Jj(i){if(!Xj(i))return Yj(i);var e=[];for(var t in Object(i))Kj.call(i,t)&&t!="constructor"&&e.push(t);return e}JE.exports=Jj});var Y3=ce((efe,QE)=>{var Zj=F3(),Qj=j3();function eW(i){return i!=null&&Qj(i.length)&&!Zj(i)}QE.exports=eW});var r1=ce((tfe,eS)=>{var tW=q3(),rW=ZE(),oW=Y3();function iW(i){return oW(i)?tW(i):rW(i)}eS.exports=iW});var rS=ce((rfe,tS)=>{var nW=Th(),sW=r1();function aW(i,e){return i&&nW(e,sW(e),i)}tS.exports=aW});var iS=ce((ofe,oS)=>{function cW(i){var e=[];if(i!=null)for(var t in Object(i))e.push(t);return e}oS.exports=cW});var sS=ce((ife,nS)=>{var lW=Ks(),uW=t1(),pW=iS(),hW=Object.prototype,dW=hW.hasOwnProperty;function fW(i){if(!lW(i))return pW(i);var e=uW(i),t=[];for(var r in i)r=="constructor"&&(e||!dW.call(i,r))||t.push(r);return t}nS.exports=fW});var o1=ce((nfe,aS)=>{var mW=q3(),_W=sS(),gW=Y3();function vW(i){return gW(i)?mW(i,!0):_W(i)}aS.exports=vW});var lS=ce((sfe,cS)=>{var xW=Th(),yW=o1();function bW(i,e){return i&&xW(e,yW(e),i)}cS.exports=bW});var fS=ce((Sh,au)=>{var TW=Ki(),dS=typeof Sh=="object"&&Sh&&!Sh.nodeType&&Sh,uS=dS&&typeof au=="object"&&au&&!au.nodeType&&au,AW=uS&&uS.exports===dS,pS=AW?TW.Buffer:void 0,hS=pS?pS.allocUnsafe:void 0;function CW(i,e){if(e)return i.slice();var t=i.length,r=hS?hS(t):new i.constructor(t);return i.copy(r),r}au.exports=CW});var _S=ce((afe,mS)=>{function EW(i,e){var t=-1,r=i.length;for(e||(e=Array(r));++t<r;)e[t]=i[t];return e}mS.exports=EW});var vS=ce((cfe,gS)=>{function SW(i,e){for(var t=-1,r=i==null?0:i.length,o=0,n=[];++t<r;){var s=i[t];e(s,t,i)&&(n[o++]=s)}return n}gS.exports=SW});var $3=ce((lfe,xS)=>{function wW(){return[]}xS.exports=wW});var i1=ce((ufe,bS)=>{var MW=vS(),NW=$3(),OW=Object.prototype,PW=OW.propertyIsEnumerable,yS=Object.getOwnPropertySymbols,RW=yS?function(i){return i==null?[]:(i=Object(i),MW(yS(i),function(e){return PW.call(i,e)}))}:NW;bS.exports=RW});var AS=ce((pfe,TS)=>{var LW=Th(),IW=i1();function DW(i,e){return LW(i,IW(i),e)}TS.exports=DW});var K3=ce((hfe,CS)=>{function kW(i,e){for(var t=-1,r=e.length,o=i.length;++t<r;)i[o+t]=e[t];return i}CS.exports=kW});var J3=ce((dfe,ES)=>{var BW=X3(),FW=BW(Object.getPrototypeOf,Object);ES.exports=FW});var Z3=ce((ffe,SS)=>{var UW=K3(),VW=J3(),GW=i1(),zW=$3(),HW=Object.getOwnPropertySymbols,jW=HW?function(i){for(var e=[];i;)UW(e,GW(i)),i=VW(i);return e}:zW;SS.exports=jW});var MS=ce((mfe,wS)=>{var WW=Th(),qW=Z3();function XW(i,e){return WW(i,qW(i),e)}wS.exports=XW});var Q3=ce((_fe,NS)=>{var YW=K3(),$W=Zm();function KW(i,e,t){var r=e(i);return $W(i)?r:YW(r,t(i))}NS.exports=KW});var PS=ce((gfe,OS)=>{var JW=Q3(),ZW=i1(),QW=r1();function eq(i){return JW(i,QW,ZW)}OS.exports=eq});var LS=ce((vfe,RS)=>{var tq=Q3(),rq=Z3(),oq=o1();function iq(i){return tq(i,oq,rq)}RS.exports=iq});var DS=ce((xfe,IS)=>{var nq=V0(),sq=Ki(),aq=nq(sq,"DataView");IS.exports=aq});var BS=ce((yfe,kS)=>{var cq=V0(),lq=Ki(),uq=cq(lq,"Promise");kS.exports=uq});var US=ce((bfe,FS)=>{var pq=V0(),hq=Ki(),dq=pq(hq,"Set");FS.exports=dq});var GS=ce((Tfe,VS)=>{var fq=V0(),mq=Ki(),_q=fq(mq,"WeakMap");VS.exports=_q});var n1=ce((Afe,YS)=>{var e4=DS(),t4=Jm(),r4=BS(),o4=US(),i4=GS(),XS=tu(),cu=V3(),zS="[object Map]",gq="[object Object]",HS="[object Promise]",jS="[object Set]",WS="[object WeakMap]",qS="[object DataView]",vq=cu(e4),xq=cu(t4),yq=cu(r4),bq=cu(o4),Tq=cu(i4),nc=XS;(e4&&nc(new e4(new ArrayBuffer(1)))!=qS||t4&&nc(new t4)!=zS||r4&&nc(r4.resolve())!=HS||o4&&nc(new o4)!=jS||i4&&nc(new i4)!=WS)&&(nc=function(i){var e=XS(i),t=e==gq?i.constructor:void 0,r=t?cu(t):"";if(r)switch(r){case vq:return qS;case xq:return zS;case yq:return HS;case bq:return jS;case Tq:return WS}return e});YS.exports=nc});var KS=ce((Cfe,$S)=>{var Aq=Object.prototype,Cq=Aq.hasOwnProperty;function Eq(i){var e=i.length,t=new i.constructor(e);return e&&typeof i[0]=="string"&&Cq.call(i,"index")&&(t.index=i.index,t.input=i.input),t}$S.exports=Eq});var ZS=ce((Efe,JS)=>{var Sq=Ki(),wq=Sq.Uint8Array;JS.exports=wq});var s1=ce((Sfe,ew)=>{var QS=ZS();function Mq(i){var e=new i.constructor(i.byteLength);return new QS(e).set(new QS(i)),e}ew.exports=Mq});var rw=ce((wfe,tw)=>{var Nq=s1();function Oq(i,e){var t=e?Nq(i.buffer):i.buffer;return new i.constructor(t,i.byteOffset,i.byteLength)}tw.exports=Oq});var iw=ce((Mfe,ow)=>{var Pq=/\w*$/;function Rq(i){var e=new i.constructor(i.source,Pq.exec(i));return e.lastIndex=i.lastIndex,e}ow.exports=Rq});var lw=ce((Nfe,cw)=>{var nw=Km(),sw=nw?nw.prototype:void 0,aw=sw?sw.valueOf:void 0;function Lq(i){return aw?Object(aw.call(i)):{}}cw.exports=Lq});var pw=ce((Ofe,uw)=>{var Iq=s1();function Dq(i,e){var t=e?Iq(i.buffer):i.buffer;return new i.constructor(t,i.byteOffset,i.length)}uw.exports=Dq});var dw=ce((Pfe,hw)=>{var kq=s1(),Bq=rw(),Fq=iw(),Uq=lw(),Vq=pw(),Gq="[object Boolean]",zq="[object Date]",Hq="[object Map]",jq="[object Number]",Wq="[object RegExp]",qq="[object Set]",Xq="[object String]",Yq="[object Symbol]",$q="[object ArrayBuffer]",Kq="[object DataView]",Jq="[object Float32Array]",Zq="[object Float64Array]",Qq="[object Int8Array]",eX="[object Int16Array]",tX="[object Int32Array]",rX="[object Uint8Array]",oX="[object Uint8ClampedArray]",iX="[object Uint16Array]",nX="[object Uint32Array]";function sX(i,e,t){var r=i.constructor;switch(e){case $q:return kq(i);case Gq:case zq:return new r(+i);case Kq:return Bq(i,t);case Jq:case Zq:case Qq:case eX:case tX:case rX:case oX:case iX:case nX:return Vq(i,t);case Hq:return new r;case jq:case Xq:return new r(i);case Wq:return Fq(i);case qq:return new r;case Yq:return Uq(i)}}hw.exports=sX});var _w=ce((Rfe,mw)=>{var aX=Ks(),fw=Object.create,cX=function(){function i(){}return function(e){if(!aX(e))return{};if(fw)return fw(e);i.prototype=e;var t=new i;return i.prototype=void 0,t}}();mw.exports=cX});var vw=ce((Lfe,gw)=>{var lX=_w(),uX=J3(),pX=t1();function hX(i){return typeof i.constructor=="function"&&!pX(i)?lX(uX(i)):{}}gw.exports=hX});var yw=ce((Ife,xw)=>{var dX=n1(),fX=ic(),mX="[object Map]";function _X(i){return fX(i)&&dX(i)==mX}xw.exports=_X});var Cw=ce((Dfe,Aw)=>{var gX=yw(),vX=Qm(),bw=e1(),Tw=bw&&bw.isMap,xX=Tw?vX(Tw):gX;Aw.exports=xX});var Sw=ce((kfe,Ew)=>{var yX=n1(),bX=ic(),TX="[object Set]";function AX(i){return bX(i)&&yX(i)==TX}Ew.exports=AX});var Ow=ce((Bfe,Nw)=>{var CX=Sw(),EX=Qm(),ww=e1(),Mw=ww&&ww.isSet,SX=Mw?EX(Mw):CX;Nw.exports=SX});var n4=ce((Ffe,Iw)=>{var wX=pE(),MX=dE(),NX=z3(),OX=rS(),PX=lS(),RX=fS(),LX=_S(),IX=AS(),DX=MS(),kX=PS(),BX=LS(),FX=n1(),UX=KS(),VX=dw(),GX=vw(),zX=Zm(),HX=H3(),jX=Cw(),WX=Ks(),qX=Ow(),XX=r1(),YX=o1(),$X=1,KX=2,JX=4,Pw="[object Arguments]",ZX="[object Array]",QX="[object Boolean]",eY="[object Date]",tY="[object Error]",Rw="[object Function]",rY="[object GeneratorFunction]",oY="[object Map]",iY="[object Number]",Lw="[object Object]",nY="[object RegExp]",sY="[object Set]",aY="[object String]",cY="[object Symbol]",lY="[object WeakMap]",uY="[object ArrayBuffer]",pY="[object DataView]",hY="[object Float32Array]",dY="[object Float64Array]",fY="[object Int8Array]",mY="[object Int16Array]",_Y="[object Int32Array]",gY="[object Uint8Array]",vY="[object Uint8ClampedArray]",xY="[object Uint16Array]",yY="[object Uint32Array]",nr={};nr[Pw]=nr[ZX]=nr[uY]=nr[pY]=nr[QX]=nr[eY]=nr[hY]=nr[dY]=nr[fY]=nr[mY]=nr[_Y]=nr[oY]=nr[iY]=nr[Lw]=nr[nY]=nr[sY]=nr[aY]=nr[cY]=nr[gY]=nr[vY]=nr[xY]=nr[yY]=!0;nr[tY]=nr[Rw]=nr[lY]=!1;function a1(i,e,t,r,o,n){var s,a=e&$X,c=e&KX,l=e&JX;if(t&&(s=o?t(i,r,o,n):t(i)),s!==void 0)return s;if(!WX(i))return i;var u=zX(i);if(u){if(s=UX(i),!a)return LX(i,s)}else{var p=FX(i),h=p==Rw||p==rY;if(HX(i))return RX(i,a);if(p==Lw||p==Pw||h&&!o){if(s=c||h?{}:GX(i),!a)return c?DX(i,PX(s,i)):IX(i,OX(s,i))}else{if(!nr[p])return o?i:{};s=VX(i,p,a)}}n||(n=new wX);var d=n.get(i);if(d)return d;n.set(i,s),qX(i)?i.forEach(function(x){s.add(a1(x,e,t,x,i,n))}):jX(i)&&i.forEach(function(x,_){s.set(_,a1(x,e,t,_,i,n))});var m=l?c?BX:kX:c?YX:XX,f=u?void 0:m(i);return MX(f||i,function(x,_){f&&(_=x,x=i[_]),NX(s,_,a1(x,e,t,_,i,n))}),s}Iw.exports=a1});var kw=ce((Ufe,Dw)=>{var bY=n4(),TY=1,AY=4;function CY(i){return bY(i,TY|AY)}Dw.exports=CY});var Fw=ce((Vfe,Bw)=>{var EY=n4(),SY=4;function wY(i){return EY(i,SY)}Bw.exports=wY});var pM=ce((Bh,T1)=>{(function(i){"use strict";var e="Compound",t="Identifier",r="MemberExpression",o="Literal",n="ThisExpression",s="CallExpression",a="UnaryExpression",c="BinaryExpression",l="LogicalExpression",u="ConditionalExpression",p="ArrayExpression",h=46,d=44,m=39,f=34,x=40,_=41,g=91,T=93,b=63,y=59,A=58,E=function(q,j){var R=new Error(q+" at character "+j);throw R.index=j,R.description=q,R},S=!0,M={"-":S,"!":S,"~":S,"+":S},L={"||":1,"&&":2,"|":3,"^":4,"&":5,"==":6,"!=":6,"===":6,"!==":6,"<":7,">":7,"<=":7,">=":7,"<<":8,">>":8,">>>":8,"+":9,"-":9,"*":10,"/":10,"%":10},C=function(q){var j=0,R;for(var Ne in q)(R=Ne.length)>j&&q.hasOwnProperty(Ne)&&(j=R);return j},N=C(M),D=C(L),k={true:!0,false:!1,null:null},z="this",F=function(q){return L[q]||0},X=function(q,j,R){var Ne=q==="||"||q==="&&"?l:c;return{type:Ne,operator:q,left:j,right:R}},$=function(q){return q>=48&&q<=57},Y=function(q){return q===36||q===95||q>=65&&q<=90||q>=97&&q<=122||q>=128&&!L[String.fromCharCode(q)]},H=function(q){return q===36||q===95||q>=65&&q<=90||q>=97&&q<=122||q>=48&&q<=57||q>=128&&!L[String.fromCharCode(q)]},B=function(q){for(var j=0,R=q.charAt,Ne=q.charCodeAt,xe=function(ee){return R.call(q,ee)},ae=function(ee){return Ne.call(q,ee)},Ae=q.length,Re=function(){for(var ee=ae(j);ee===32||ee===9||ee===10||ee===13;)ee=ae(++j)},Oe=function(){var ee=ye(),me,Z;if(Re(),ae(j)===b){if(j++,me=Oe(),me||E("Expected expression",j),Re(),ae(j)===A)return j++,Z=Oe(),Z||E("Expected expression",j),{type:u,test:ee,consequent:me,alternate:Z};E("Expected :",j)}else return ee},le=function(){Re();for(var ee,me=q.substr(j,D),Z=me.length;Z>0;){if(L.hasOwnProperty(me)&&(!Y(ae(j))||j+me.length<q.length&&!H(ae(j+me.length))))return j+=Z,me;me=me.substr(0,--Z)}return!1},ye=function(){var ee,me,Z,Se,U,se,ve,ke,W,Le;if(ve=be(),Z=le(),!Z)return ve;for(se={value:Z,prec:F(Z)},ke=be(),ke||E("Expected expression after "+Z,j),U=[ve,se,ke];(Z=le())&&(Se=F(Z),Se!==0);){for(se={value:Z,prec:Se},Le=Z;U.length>2&&Se<=U[U.length-2].prec;)ke=U.pop(),Z=U.pop().value,ve=U.pop(),me=X(Z,ve,ke),U.push(me);me=be(),me||E("Expected expression after "+Le,j),U.push(se,me)}for(W=U.length-1,me=U[W];W>1;)me=X(U[W-1].value,U[W-2],me),W-=2;return me},be=function(){var ee,me,Z;if(Re(),ee=ae(j),$(ee)||ee===h)return ie();if(ee===m||ee===f)return de();if(ee===g)return Ze();for(me=q.substr(j,N),Z=me.length;Z>0;){if(M.hasOwnProperty(me)&&(!Y(ae(j))||j+me.length<q.length&&!H(ae(j+me.length))))return j+=Z,{type:a,operator:me,argument:be(),prefix:!0};me=me.substr(0,--Z)}return Y(ee)||ee===x?Pe():!1},ie=function(){for(var ee="",me,Z;$(ae(j));)ee+=xe(j++);if(ae(j)===h)for(ee+=xe(j++);$(ae(j));)ee+=xe(j++);if(me=xe(j),me==="e"||me==="E"){for(ee+=xe(j++),me=xe(j),(me==="+"||me==="-")&&(ee+=xe(j++));$(ae(j));)ee+=xe(j++);$(ae(j-1))||E("Expected exponent ("+ee+xe(j)+")",j)}return Z=ae(j),Y(Z)?E("Variable names cannot start with a number ("+ee+xe(j)+")",j):Z===h&&E("Unexpected period",j),{type:o,value:parseFloat(ee),raw:ee}},de=function(){for(var ee="",me=xe(j++),Z=!1,Se;j<Ae;)if(Se=xe(j++),Se===me){Z=!0;break}else if(Se==="\\")switch(Se=xe(j++),Se){case"n":ee+=`
`;break;case"r":ee+="\r";break;case"t":ee+="	";break;case"b":ee+="\b";break;case"f":ee+="\f";break;case"v":ee+="\v";break;default:ee+=Se}else ee+=Se;return Z||E('Unclosed quote after "'+ee+'"',j),{type:o,value:ee,raw:me+ee+me}},we=function(){var ee=ae(j),me=j,Z;for(Y(ee)?j++:E("Unexpected "+xe(j),j);j<Ae&&(ee=ae(j),H(ee));)j++;return Z=q.slice(me,j),k.hasOwnProperty(Z)?{type:o,value:k[Z],raw:Z}:Z===z?{type:n}:{type:t,name:Z}},Ee=function(ee){for(var me,Z=[],Se,U=!1,se=0;j<Ae;)if(Re(),me=ae(j),me===ee){U=!0,j++,ee===_&&se&&se>=Z.length&&E("Unexpected token "+String.fromCharCode(ee),j);break}else if(me===d){if(j++,se++,se!==Z.length){if(ee===_)E("Unexpected token ,",j);else if(ee===T)for(var ve=Z.length;ve<se;ve++)Z.push(null)}}else Se=Oe(),(!Se||Se.type===e)&&E("Expected comma",j),Z.push(Se);return U||E("Expected "+String.fromCharCode(ee),j),Z},Pe=function(){var ee,me;for(ee=ae(j),ee===x?me=We():me=we(),Re(),ee=ae(j);ee===h||ee===g||ee===x;)j++,ee===h?(Re(),me={type:r,computed:!1,object:me,property:we()}):ee===g?(me={type:r,computed:!0,object:me,property:Oe()},Re(),ee=ae(j),ee!==T&&E("Unclosed [",j),j++):ee===x&&(me={type:s,arguments:Ee(_),callee:me}),Re(),ee=ae(j);return me},We=function(){j++;var ee=Oe();if(Re(),ae(j)===_)return j++,ee;E("Unclosed (",j)},Ze=function(){return j++,{type:p,elements:Ee(T)}},I=[],O,fe;j<Ae;)O=ae(j),O===y||O===d?j++:(fe=Oe())?I.push(fe):j<Ae&&E('Unexpected "'+xe(j)+'"',j);return I.length===1?I[0]:{type:e,body:I}};if(B.version="0.3.5",B.toString=function(){return"JavaScript Expression Parser (JSEP) v"+B.version},B.addUnaryOp=function(q){return N=Math.max(q.length,N),M[q]=S,this},B.addBinaryOp=function(q,j){return D=Math.max(q.length,D),L[q]=j,this},B.addLiteral=function(q,j){return k[q]=j,this},B.removeUnaryOp=function(q){return delete M[q],q.length===N&&(N=C(M)),this},B.removeAllUnaryOps=function(){return M={},N=0,this},B.removeBinaryOp=function(q){return delete L[q],q.length===D&&(D=C(L)),this},B.removeAllBinaryOps=function(){return L={},D=0,this},B.removeLiteral=function(q){return delete k[q],this},B.removeAllLiterals=function(){return k={},this},typeof Bh>"u"){var te=i.jsep;i.jsep=B,B.noConflict=function(){return i.jsep===B&&(i.jsep=te),B}}else typeof T1<"u"&&T1.exports?Bh=T1.exports=B:Bh.parse=B})(Bh)});var _O=ce((eCe,md)=>{function sZ(i){if(Array.isArray(i))return i}md.exports=sZ,md.exports.__esModule=!0,md.exports.default=md.exports});var gO=ce((tCe,_d)=>{function aZ(i,e){var t=i==null?null:typeof Symbol<"u"&&i[Symbol.iterator]||i["@@iterator"];if(t!=null){var r=[],o=!0,n=!1,s,a;try{for(t=t.call(i);!(o=(s=t.next()).done)&&(r.push(s.value),!(e&&r.length===e));o=!0);}catch(c){n=!0,a=c}finally{try{!o&&t.return!=null&&t.return()}finally{if(n)throw a}}return r}}_d.exports=aZ,_d.exports.__esModule=!0,_d.exports.default=_d.exports});var vO=ce((rCe,gd)=>{function cZ(i,e){(e==null||e>i.length)&&(e=i.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=i[t];return r}gd.exports=cZ,gd.exports.__esModule=!0,gd.exports.default=gd.exports});var yO=ce((oCe,vd)=>{var xO=vO();function lZ(i,e){if(!!i){if(typeof i=="string")return xO(i,e);var t=Object.prototype.toString.call(i).slice(8,-1);if(t==="Object"&&i.constructor&&(t=i.constructor.name),t==="Map"||t==="Set")return Array.from(i);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return xO(i,e)}}vd.exports=lZ,vd.exports.__esModule=!0,vd.exports.default=vd.exports});var bO=ce((iCe,xd)=>{function uZ(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}xd.exports=uZ,xd.exports.__esModule=!0,xd.exports.default=xd.exports});var TO=ce((nCe,yd)=>{var pZ=_O(),hZ=gO(),dZ=yO(),fZ=bO();function mZ(i,e){return pZ(i)||hZ(i,e)||dZ(i,e)||fZ()}yd.exports=mZ,yd.exports.__esModule=!0,yd.exports.default=yd.exports});var AO=ce((sCe,bd)=>{function _Z(i,e){if(!(i instanceof e))throw new TypeError("Cannot call a class as a function")}bd.exports=_Z,bd.exports.__esModule=!0,bd.exports.default=bd.exports});var EO=ce((aCe,Td)=>{function CO(i,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(i,r.key,r)}}function gZ(i,e,t){return e&&CO(i.prototype,e),t&&CO(i,t),Object.defineProperty(i,"prototype",{writable:!1}),i}Td.exports=gZ,Td.exports.__esModule=!0,Td.exports.default=Td.exports});var O6=ce((m_,SO)=>{(function(i,e){typeof m_=="object"&&typeof SO<"u"?e(m_,TO(),AO(),EO()):typeof define=="function"&&define.amd?define(["exports","@babel/runtime/helpers/slicedToArray","@babel/runtime/helpers/classCallCheck","@babel/runtime/helpers/createClass"],e):(i=typeof globalThis<"u"?globalThis:i||self,e(i.automationEvents={},i._slicedToArray,i._classCallCheck,i._createClass))})(m_,function(i,e,t,r){"use strict";function o($){return $&&typeof $=="object"&&"default"in $?$:{default:$}}var n=o(e),s=o(t),a=o(r),c=function(Y,H,B){return{endTime:H,insertTime:B,type:"exponentialRampToValue",value:Y}},l=function(Y,H,B){return{endTime:H,insertTime:B,type:"linearRampToValue",value:Y}},u=function(Y,H){return{startTime:H,type:"setValue",value:Y}},p=function(Y,H,B){return{duration:B,startTime:H,type:"setValueCurve",values:Y}},h=function(Y,H,B){var te=B.startTime,q=B.target,j=B.timeConstant;return q+(H-q)*Math.exp((te-Y)/j)},d=function(Y){return Y.type==="exponentialRampToValue"},m=function(Y){return Y.type==="linearRampToValue"},f=function(Y){return d(Y)||m(Y)},x=function(Y){return Y.type==="setValue"},_=function(Y){return Y.type==="setValueCurve"},g=function $(Y,H,B,te){var q=Y[H];return q===void 0?te:f(q)||x(q)?q.value:_(q)?q.values[q.values.length-1]:h(B,$(Y,H-1,q.startTime,te),q)},T=function(Y,H,B,te,q){return B===void 0?[te.insertTime,q]:f(B)?[B.endTime,B.value]:x(B)?[B.startTime,B.value]:_(B)?[B.startTime+B.duration,B.values[B.values.length-1]]:[B.startTime,g(Y,H-1,B.startTime,q)]},b=function(Y){return Y.type==="cancelAndHold"},y=function(Y){return Y.type==="cancelScheduledValues"},A=function(Y){return b(Y)||y(Y)?Y.cancelTime:d(Y)||m(Y)?Y.endTime:Y.startTime},E=function(Y,H,B,te){var q=te.endTime,j=te.value;return B===j?j:0<B&&0<j||B<0&&j<0?B*Math.pow(j/B,(Y-H)/(q-H)):0},S=function(Y,H,B,te){var q=te.endTime,j=te.value;return B+(Y-H)/(q-H)*(j-B)},M=function(Y,H){var B=Math.floor(H),te=Math.ceil(H);return B===te?Y[B]:(1-(H-B))*Y[B]+(1-(te-H))*Y[te]},L=function(Y,H){var B=H.duration,te=H.startTime,q=H.values,j=(Y-te)/B*(q.length-1);return M(q,j)},C=function(Y){return Y.type==="setTarget"},N=function($){function Y(H){s.default(this,Y),this._automationEvents=[],this._currenTime=0,this._defaultValue=H}return a.default(Y,[{key:$,value:function(){return this._automationEvents[Symbol.iterator]()}},{key:"add",value:function(B){var te=A(B);if(b(B)||y(B)){var q=this._automationEvents.findIndex(function(ye){return y(B)&&_(ye)?ye.startTime+ye.duration>=te:A(ye)>=te}),j=this._automationEvents[q];if(q!==-1&&(this._automationEvents=this._automationEvents.slice(0,q)),b(B)){var R=this._automationEvents[this._automationEvents.length-1];if(j!==void 0&&f(j)){if(C(R))throw new Error("The internal list is malformed.");var Ne=_(R)?R.startTime+R.duration:A(R),xe=_(R)?R.values[R.values.length-1]:R.value,ae=d(j)?E(te,Ne,xe,j):S(te,Ne,xe,j),Ae=d(j)?c(ae,te,this._currenTime):l(ae,te,this._currenTime);this._automationEvents.push(Ae)}R!==void 0&&C(R)&&this._automationEvents.push(u(this.getValue(te),te)),R!==void 0&&_(R)&&R.startTime+R.duration>te&&(this._automationEvents[this._automationEvents.length-1]=p(new Float32Array([6,7]),R.startTime,te-R.startTime))}}else{var Re=this._automationEvents.findIndex(function(ye){return A(ye)>te}),Oe=Re===-1?this._automationEvents[this._automationEvents.length-1]:this._automationEvents[Re-1];if(Oe!==void 0&&_(Oe)&&A(Oe)+Oe.duration>te)return!1;var le=d(B)?c(B.value,B.endTime,this._currenTime):m(B)?l(B.value,te,this._currenTime):B;if(Re===-1)this._automationEvents.push(le);else{if(_(B)&&te+B.duration>A(this._automationEvents[Re]))return!1;this._automationEvents.splice(Re,0,le)}}return!0}},{key:"flush",value:function(B){var te=this._automationEvents.findIndex(function(R){return A(R)>B});if(te>1){var q=this._automationEvents.slice(te-1),j=q[0];C(j)&&q.unshift(u(g(this._automationEvents,te-2,j.startTime,this._defaultValue),j.startTime)),this._automationEvents=q}}},{key:"getValue",value:function(B){if(this._automationEvents.length===0)return this._defaultValue;var te=this._automationEvents.findIndex(function(be){return A(be)>B}),q=this._automationEvents[te],j=(te===-1?this._automationEvents.length:te)-1,R=this._automationEvents[j];if(R!==void 0&&C(R)&&(q===void 0||!f(q)||q.insertTime>B))return h(B,g(this._automationEvents,j-1,R.startTime,this._defaultValue),R);if(R!==void 0&&x(R)&&(q===void 0||!f(q)))return R.value;if(R!==void 0&&_(R)&&(q===void 0||!f(q)||R.startTime+R.duration>B))return B<R.startTime+R.duration?L(B,R):R.values[R.values.length-1];if(R!==void 0&&f(R)&&(q===void 0||!f(q)))return R.value;if(q!==void 0&&d(q)){var Ne=T(this._automationEvents,j,R,q,this._defaultValue),xe=n.default(Ne,2),ae=xe[0],Ae=xe[1];return E(B,ae,Ae,q)}if(q!==void 0&&m(q)){var Re=T(this._automationEvents,j,R,q,this._defaultValue),Oe=n.default(Re,2),le=Oe[0],ye=Oe[1];return S(B,le,ye,q)}return this._defaultValue}}]),Y}(Symbol.iterator),D=function(Y){return{cancelTime:Y,type:"cancelAndHold"}},k=function(Y){return{cancelTime:Y,type:"cancelScheduledValues"}},z=function(Y,H){return{endTime:H,type:"exponentialRampToValue",value:Y}},F=function(Y,H){return{endTime:H,type:"linearRampToValue",value:Y}},X=function(Y,H,B){return{startTime:H,target:Y,timeConstant:B,type:"setTarget"}};i.AutomationEventList=N,i.createCancelAndHoldAutomationEvent=D,i.createCancelScheduledValuesAutomationEvent=k,i.createExponentialRampToValueAutomationEvent=z,i.createLinearRampToValueAutomationEvent=F,i.createSetTargetAutomationEvent=X,i.createSetValueAutomationEvent=u,i.createSetValueCurveAutomationEvent=p,Object.defineProperty(i,"__esModule",{value:!0})})});var $I=ce((Gqe,G_)=>{var NI,OI,PI,RI,LI,II,DI,kI,BI,U_,a7,FI,UI,VI,up,GI,zI,HI,jI,WI,qI,XI,YI,V_;(function(i){var e=typeof global=="object"?global:typeof self=="object"?self:typeof this=="object"?this:{};typeof define=="function"&&define.amd?define("tslib",["exports"],function(r){i(t(e,t(r)))}):typeof G_=="object"&&typeof G_.exports=="object"?i(t(e,t(G_.exports))):i(t(e));function t(r,o){return r!==e&&(typeof Object.create=="function"?Object.defineProperty(r,"__esModule",{value:!0}):r.__esModule=!0),function(n,s){return r[n]=o?o(n,s):s}}})(function(i){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(r[n]=o[n])};NI=function(r,o){if(typeof o!="function"&&o!==null)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");e(r,o);function n(){this.constructor=r}r.prototype=o===null?Object.create(o):(n.prototype=o.prototype,new n)},OI=Object.assign||function(r){for(var o,n=1,s=arguments.length;n<s;n++){o=arguments[n];for(var a in o)Object.prototype.hasOwnProperty.call(o,a)&&(r[a]=o[a])}return r},PI=function(r,o){var n={};for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&o.indexOf(s)<0&&(n[s]=r[s]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,s=Object.getOwnPropertySymbols(r);a<s.length;a++)o.indexOf(s[a])<0&&Object.prototype.propertyIsEnumerable.call(r,s[a])&&(n[s[a]]=r[s[a]]);return n},RI=function(r,o,n,s){var a=arguments.length,c=a<3?o:s===null?s=Object.getOwnPropertyDescriptor(o,n):s,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(r,o,n,s);else for(var u=r.length-1;u>=0;u--)(l=r[u])&&(c=(a<3?l(c):a>3?l(o,n,c):l(o,n))||c);return a>3&&c&&Object.defineProperty(o,n,c),c},LI=function(r,o){return function(n,s){o(n,s,r)}},II=function(r,o){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,o)},DI=function(r,o,n,s){function a(c){return c instanceof n?c:new n(function(l){l(c)})}return new(n||(n=Promise))(function(c,l){function u(d){try{h(s.next(d))}catch(m){l(m)}}function p(d){try{h(s.throw(d))}catch(m){l(m)}}function h(d){d.done?c(d.value):a(d.value).then(u,p)}h((s=s.apply(r,o||[])).next())})},kI=function(r,o){var n={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},s,a,c,l;return l={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function u(h){return function(d){return p([h,d])}}function p(h){if(s)throw new TypeError("Generator is already executing.");for(;n;)try{if(s=1,a&&(c=h[0]&2?a.return:h[0]?a.throw||((c=a.return)&&c.call(a),0):a.next)&&!(c=c.call(a,h[1])).done)return c;switch(a=0,c&&(h=[h[0]&2,c.value]),h[0]){case 0:case 1:c=h;break;case 4:return n.label++,{value:h[1],done:!1};case 5:n.label++,a=h[1],h=[0];continue;case 7:h=n.ops.pop(),n.trys.pop();continue;default:if(c=n.trys,!(c=c.length>0&&c[c.length-1])&&(h[0]===6||h[0]===2)){n=0;continue}if(h[0]===3&&(!c||h[1]>c[0]&&h[1]<c[3])){n.label=h[1];break}if(h[0]===6&&n.label<c[1]){n.label=c[1],c=h;break}if(c&&n.label<c[2]){n.label=c[2],n.ops.push(h);break}c[2]&&n.ops.pop(),n.trys.pop();continue}h=o.call(r,n)}catch(d){h=[6,d],a=0}finally{s=c=0}if(h[0]&5)throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}},BI=function(r,o){for(var n in r)n!=="default"&&!Object.prototype.hasOwnProperty.call(o,n)&&V_(o,r,n)},V_=Object.create?function(r,o,n,s){s===void 0&&(s=n),Object.defineProperty(r,s,{enumerable:!0,get:function(){return o[n]}})}:function(r,o,n,s){s===void 0&&(s=n),r[s]=o[n]},U_=function(r){var o=typeof Symbol=="function"&&Symbol.iterator,n=o&&r[o],s=0;if(n)return n.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&s>=r.length&&(r=void 0),{value:r&&r[s++],done:!r}}};throw new TypeError(o?"Object is not iterable.":"Symbol.iterator is not defined.")},a7=function(r,o){var n=typeof Symbol=="function"&&r[Symbol.iterator];if(!n)return r;var s=n.call(r),a,c=[],l;try{for(;(o===void 0||o-- >0)&&!(a=s.next()).done;)c.push(a.value)}catch(u){l={error:u}}finally{try{a&&!a.done&&(n=s.return)&&n.call(s)}finally{if(l)throw l.error}}return c},FI=function(){for(var r=[],o=0;o<arguments.length;o++)r=r.concat(a7(arguments[o]));return r},UI=function(){for(var r=0,o=0,n=arguments.length;o<n;o++)r+=arguments[o].length;for(var s=Array(r),a=0,o=0;o<n;o++)for(var c=arguments[o],l=0,u=c.length;l<u;l++,a++)s[a]=c[l];return s},VI=function(r,o,n){if(n||arguments.length===2)for(var s=0,a=o.length,c;s<a;s++)(c||!(s in o))&&(c||(c=Array.prototype.slice.call(o,0,s)),c[s]=o[s]);return r.concat(c||Array.prototype.slice.call(o))},up=function(r){return this instanceof up?(this.v=r,this):new up(r)},GI=function(r,o,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=n.apply(r,o||[]),a,c=[];return a={},l("next"),l("throw"),l("return"),a[Symbol.asyncIterator]=function(){return this},a;function l(f){s[f]&&(a[f]=function(x){return new Promise(function(_,g){c.push([f,x,_,g])>1||u(f,x)})})}function u(f,x){try{p(s[f](x))}catch(_){m(c[0][3],_)}}function p(f){f.value instanceof up?Promise.resolve(f.value.v).then(h,d):m(c[0][2],f)}function h(f){u("next",f)}function d(f){u("throw",f)}function m(f,x){f(x),c.shift(),c.length&&u(c[0][0],c[0][1])}},zI=function(r){var o,n;return o={},s("next"),s("throw",function(a){throw a}),s("return"),o[Symbol.iterator]=function(){return this},o;function s(a,c){o[a]=r[a]?function(l){return(n=!n)?{value:up(r[a](l)),done:a==="return"}:c?c(l):l}:c}},HI=function(r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var o=r[Symbol.asyncIterator],n;return o?o.call(r):(r=typeof U_=="function"?U_(r):r[Symbol.iterator](),n={},s("next"),s("throw"),s("return"),n[Symbol.asyncIterator]=function(){return this},n);function s(c){n[c]=r[c]&&function(l){return new Promise(function(u,p){l=r[c](l),a(u,p,l.done,l.value)})}}function a(c,l,u,p){Promise.resolve(p).then(function(h){c({value:h,done:u})},l)}},jI=function(r,o){return Object.defineProperty?Object.defineProperty(r,"raw",{value:o}):r.raw=o,r};var t=Object.create?function(r,o){Object.defineProperty(r,"default",{enumerable:!0,value:o})}:function(r,o){r.default=o};WI=function(r){if(r&&r.__esModule)return r;var o={};if(r!=null)for(var n in r)n!=="default"&&Object.prototype.hasOwnProperty.call(r,n)&&V_(o,r,n);return t(o,r),o},qI=function(r){return r&&r.__esModule?r:{default:r}},XI=function(r,o,n,s){if(n==="a"&&!s)throw new TypeError("Private accessor was defined without a getter");if(typeof o=="function"?r!==o||!s:!o.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?s:n==="a"?s.call(r):s?s.value:o.get(r)},YI=function(r,o,n,s,a){if(s==="m")throw new TypeError("Private method is not writable");if(s==="a"&&!a)throw new TypeError("Private accessor was defined without a setter");if(typeof o=="function"?r!==o||!a:!o.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return s==="a"?a.call(r,n):a?a.value=n:o.set(r,n),n},i("__extends",NI),i("__assign",OI),i("__rest",PI),i("__decorate",RI),i("__param",LI),i("__metadata",II),i("__awaiter",DI),i("__generator",kI),i("__exportStar",BI),i("__createBinding",V_),i("__values",U_),i("__read",a7),i("__spread",FI),i("__spreadArrays",UI),i("__spreadArray",VI),i("__await",up),i("__asyncGenerator",GI),i("__asyncDelegator",zI),i("__asyncValues",HI),i("__makeTemplateObject",jI),i("__importStar",WI),i("__importDefault",qI),i("__classPrivateFieldGet",XI),i("__classPrivateFieldSet",YI)})});var _k=ce((Znt,mk)=>{var tte=Ki(),rte=function(){return tte.Date.now()};mk.exports=rte});var vk=ce((Qnt,gk)=>{var ote=/\s/;function ite(i){for(var e=i.length;e--&&ote.test(i.charAt(e)););return e}gk.exports=ite});var yk=ce((est,xk)=>{var nte=vk(),ste=/^\s+/;function ate(i){return i&&i.slice(0,nte(i)+1).replace(ste,"")}xk.exports=ate});var Tk=ce((tst,bk)=>{var cte=tu(),lte=ic(),ute="[object Symbol]";function pte(i){return typeof i=="symbol"||lte(i)&&cte(i)==ute}bk.exports=pte});var Sk=ce((rst,Ek)=>{var hte=yk(),Ak=Ks(),dte=Tk(),Ck=0/0,fte=/^[-+]0x[0-9a-f]+$/i,mte=/^0b[01]+$/i,_te=/^0o[0-7]+$/i,gte=parseInt;function vte(i){if(typeof i=="number")return i;if(dte(i))return Ck;if(Ak(i)){var e=typeof i.valueOf=="function"?i.valueOf():i;i=Ak(e)?e+"":e}if(typeof i!="string")return i===0?i:+i;i=hte(i);var t=mte.test(i);return t||_te.test(i)?gte(i.slice(2),t?2:8):fte.test(i)?Ck:+i}Ek.exports=vte});var Nk=ce((ost,Mk)=>{var xte=Ks(),j7=_k(),wk=Sk(),yte="Expected a function",bte=Math.max,Tte=Math.min;function Ate(i,e,t){var r,o,n,s,a,c,l=0,u=!1,p=!1,h=!0;if(typeof i!="function")throw new TypeError(yte);e=wk(e)||0,xte(t)&&(u=!!t.leading,p="maxWait"in t,n=p?bte(wk(t.maxWait)||0,e):n,h="trailing"in t?!!t.trailing:h);function d(A){var E=r,S=o;return r=o=void 0,l=A,s=i.apply(S,E),s}function m(A){return l=A,a=setTimeout(_,e),u?d(A):s}function f(A){var E=A-c,S=A-l,M=e-E;return p?Tte(M,n-S):M}function x(A){var E=A-c,S=A-l;return c===void 0||E>=e||E<0||p&&S>=n}function _(){var A=j7();if(x(A))return g(A);a=setTimeout(_,f(A))}function g(A){return a=void 0,h&&r?d(A):(r=o=void 0,s)}function T(){a!==void 0&&clearTimeout(a),l=0,r=c=o=a=void 0}function b(){return a===void 0?s:g(j7())}function y(){var A=j7(),E=x(A);if(r=arguments,o=this,c=A,E){if(a===void 0)return m(c);if(p)return clearTimeout(a),a=setTimeout(_,e),d(c)}return a===void 0&&(a=setTimeout(_,e)),s}return y.cancel=T,y.flush=b,y}Mk.exports=Ate});var Pk=ce((ist,Ok)=>{var Cte=Nk(),Ete=Ks(),Ste="Expected a function";function wte(i,e,t){var r=!0,o=!0;if(typeof i!="function")throw new TypeError(Ste);return Ete(t)&&(r="leading"in t?!!t.leading:r,o="trailing"in t?!!t.trailing:o),Cte(i,e,{leading:r,maxWait:e,trailing:o})}Ok.exports=wte});var Hk=ce((Xct,zk)=>{zk.exports=`#define LIGHT_WORLD_SIZE 0.005
// #define LIGHT_FRUSTUM_WIDTH 1.0
// #define PCSS_FILTER_SIZE 1.0
#define LIGHT_SIZE_UV (PCSS_FILTER_SIZE * LIGHT_WORLD_SIZE)
#define NEAR_PLANE 9.5

#define NUM_SAMPLES 17
#define NUM_RINGS 11
#define BLOCKER_SEARCH_NUM_SAMPLES NUM_SAMPLES

vec2 poissonDisk[NUM_SAMPLES];

void initPoissonSamples( const in vec2 randomSeed ) {
	float ANGLE_STEP = PI2 * float( NUM_RINGS ) / float( NUM_SAMPLES );
	float INV_NUM_SAMPLES = 1.0 / float( NUM_SAMPLES );

	// jsfiddle that shows sample pattern: https://jsfiddle.net/a16ff1p7/
	float angle = rand( randomSeed ) * PI2;
	float radius = INV_NUM_SAMPLES;
	float radiusStep = radius;

	for( int i = 0; i < NUM_SAMPLES; i ++ ) {
		poissonDisk[i] = vec2( cos( angle ), sin( angle ) ) * pow( radius, 0.75 );
		radius += radiusStep;
		angle += ANGLE_STEP;
	}
}

float penumbraSize( const in float zReceiver, const in float zBlocker ) { // Parallel plane estimation
	return (zReceiver - zBlocker) / zBlocker;
}

float findBlocker( sampler2D shadowMap, const in vec2 uv, const in float zReceiver ) {
	// This uses similar triangles to compute what
	// area of the shadow map we should search
	float searchRadius = LIGHT_SIZE_UV * ( zReceiver - NEAR_PLANE ) / zReceiver;
	float blockerDepthSum = 0.0;
	int numBlockers = 0;

	for( int i = 0; i < BLOCKER_SEARCH_NUM_SAMPLES; i++ ) {
		float shadowMapDepth = unpackRGBAToDepth(texture2D(shadowMap, uv + poissonDisk[i] * searchRadius));
		if ( shadowMapDepth < zReceiver ) {
			blockerDepthSum += shadowMapDepth;
			numBlockers ++;
		}
	}

	if( numBlockers == 0 ) return -1.0;

	return blockerDepthSum / float( numBlockers );
}

float PCF_Filter(sampler2D shadowMap, vec2 uv, float zReceiver, float filterRadius ) {
	float sum = 0.0;
	float depth;
	#pragma unroll_loop_start
	for( int i = 0; i < 17; i ++ ) {
		depth = unpackRGBAToDepth( texture2D( shadowMap, uv + poissonDisk[ i ] * filterRadius ) );
		if( zReceiver <= depth ) sum += 1.0;
	}
	#pragma unroll_loop_end
	#pragma unroll_loop_start
	for( int i = 0; i < 17; i ++ ) {
		depth = unpackRGBAToDepth( texture2D( shadowMap, uv + -poissonDisk[ i ].yx * filterRadius ) );
		if( zReceiver <= depth ) sum += 1.0;
	}
	#pragma unroll_loop_end
	return sum / ( 2.0 * float( 17 ) );
}

float PCSS ( sampler2D shadowMap, vec4 coords ) {
	vec2 uv = coords.xy;
	float zReceiver = coords.z; // Assumed to be eye-space z in this code

	initPoissonSamples( uv );
	// STEP 1: blocker search
	float avgBlockerDepth = findBlocker( shadowMap, uv, zReceiver );

	//There are no occluders so early out (this saves filtering)
	if( avgBlockerDepth == -1.0 ) return 1.0;

	// STEP 2: penumbra size
	float penumbraRatio = penumbraSize( zReceiver, avgBlockerDepth );
	float filterRadius = penumbraRatio * LIGHT_SIZE_UV * NEAR_PLANE / zReceiver;

	// STEP 3: filtering
	//return avgBlockerDepth;
	return PCF_Filter( shadowMap, uv, zReceiver, filterRadius );
}`});var Wk=ce((Yct,jk)=>{jk.exports="return PCSS( shadowMap, shadowCoord );"});var RB=ce((W1t,PB)=>{PB.exports=`varying vec3 vNormal;
varying vec3 vWorldPosition;
varying vec3 vWorldOrigin;

void main(){
	// compute intensity
	vNormal		= normalize( normalMatrix * normal );

	vec4 worldPosition	= modelMatrix * vec4( position, 1.0 );
	vWorldPosition		= worldPosition.xyz;

	vec4 worldOrigin	= modelMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vWorldOrigin		= worldOrigin.xyz;

	// set gl_Position
	gl_Position	= projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`});var IB=ce((q1t,LB)=>{LB.exports=`varying vec3 vNormal;
varying vec3 vWorldPosition;
varying vec3 vWorldOrigin;

uniform vec3 lightColor;

// uniform vec3 spotPosition;

uniform float attenuation;
uniform float anglePower;

void main(){

	//////////////////////////////////////////////////////////
	// distance attenuation   //
	//////////////////////////////////////////////////////////
	float intensity = distance(vWorldPosition, vWorldOrigin) / attenuation;
	intensity = 1.0 - clamp(intensity, 0.0, 1.0);

	//////////////////////////////////////////////////////////
	// intensity on angle   //
	//////////////////////////////////////////////////////////
	vec3 normal = vec3(vNormal.x, vNormal.y, abs(vNormal.z));
	float angleIntensity = pow( dot(normal, vec3(0.0, 0.0, 1.0)), anglePower );
	intensity = intensity * angleIntensity;
	// 'gl_FragColor = vec4( lightColor, intensity );

	//////////////////////////////////////////////////////////
	// final color   //
	//////////////////////////////////////////////////////////

	// set the final color
	gl_FragColor = vec4( lightColor, intensity);
}`});var n3=new w,xU=new w,yU=new zo,bi=class{constructor(e=new w(1,0,0),t=0){this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,r,o){return this.normal.set(e,t,r),this.constant=o,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,r){let o=n3.subVectors(r,t).cross(xU.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(o,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){let e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)}intersectLine(e,t){let r=e.delta(n3),o=this.normal.dot(r);if(o===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;let n=-(e.start.dot(this.normal)+this.constant)/o;return n<0||n>1?null:t.copy(r).multiplyScalar(n).add(e.start)}intersectsLine(e){let t=this.distanceToPoint(e.start),r=this.distanceToPoint(e.end);return t<0&&r>0||r<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){let r=t||yU.getNormalMatrix(e),o=this.coplanarPoint(n3).applyMatrix4(e),n=this.normal.applyMatrix3(r).normalize();return this.constant=-o.dot(n),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}};bi.prototype.isPlane=!0;var zl=new Fl,Fm=new w,tc=class{constructor(e=new bi,t=new bi,r=new bi,o=new bi,n=new bi,s=new bi){this.planes=[e,t,r,o,n,s]}set(e,t,r,o,n,s){let a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(r),a[3].copy(o),a[4].copy(n),a[5].copy(s),this}copy(e){let t=this.planes;for(let r=0;r<6;r++)t[r].copy(e.planes[r]);return this}setFromProjectionMatrix(e){let t=this.planes,r=e.elements,o=r[0],n=r[1],s=r[2],a=r[3],c=r[4],l=r[5],u=r[6],p=r[7],h=r[8],d=r[9],m=r[10],f=r[11],x=r[12],_=r[13],g=r[14],T=r[15];return t[0].setComponents(a-o,p-c,f-h,T-x).normalize(),t[1].setComponents(a+o,p+c,f+h,T+x).normalize(),t[2].setComponents(a+n,p+l,f+d,T+_).normalize(),t[3].setComponents(a-n,p-l,f-d,T-_).normalize(),t[4].setComponents(a-s,p-u,f-m,T-g).normalize(),t[5].setComponents(a+s,p+u,f+m,T+g).normalize(),this}intersectsObject(e){let t=e.geometry;return t.boundingSphere===null&&t.computeBoundingSphere(),zl.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(zl)}intersectsSprite(e){return zl.center.set(0,0,0),zl.radius=.7071067811865476,zl.applyMatrix4(e.matrixWorld),this.intersectsSphere(zl)}intersectsSphere(e){let t=this.planes,r=e.center,o=-e.radius;for(let n=0;n<6;n++)if(t[n].distanceToPoint(r)<o)return!1;return!0}intersectsBox(e){let t=this.planes;for(let r=0;r<6;r++){let o=t[r];if(Fm.x=o.normal.x>0?e.max.x:e.min.x,Fm.y=o.normal.y>0?e.max.y:e.min.y,Fm.z=o.normal.z>0?e.max.z:e.min.z,o.distanceToPoint(Fm)<0)return!1}return!0}containsPoint(e){let t=this.planes;for(let r=0;r<6;r++)if(t[r].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}};function Um(){let i=null,e=!1,t=null,r=null;function o(n,s){t(n,s),r=i.requestAnimationFrame(o)}return{start:function(){e!==!0&&t!==null&&(r=i.requestAnimationFrame(o),e=!0)},stop:function(){i.cancelAnimationFrame(r),e=!1},setAnimationLoop:function(n){t=n},setContext:function(n){i=n}}}function ty(i,e){let t=e.isWebGL2,r=new WeakMap;function o(l,u){let p=l.array,h=l.usage,d=i.createBuffer();i.bindBuffer(u,d),i.bufferData(u,p,h),l.onUploadCallback();let m=i.FLOAT;return p instanceof Float32Array?m=i.FLOAT:p instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):p instanceof Uint16Array?l.isFloat16BufferAttribute?t?m=i.HALF_FLOAT:console.warn("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2."):m=i.UNSIGNED_SHORT:p instanceof Int16Array?m=i.SHORT:p instanceof Uint32Array?m=i.UNSIGNED_INT:p instanceof Int32Array?m=i.INT:p instanceof Int8Array?m=i.BYTE:(p instanceof Uint8Array||p instanceof Uint8ClampedArray)&&(m=i.UNSIGNED_BYTE),{buffer:d,type:m,bytesPerElement:p.BYTES_PER_ELEMENT,version:l.version}}function n(l,u,p){let h=u.array,d=u.updateRange;i.bindBuffer(p,l),d.count===-1?i.bufferSubData(p,0,h):(t?i.bufferSubData(p,d.offset*h.BYTES_PER_ELEMENT,h,d.offset,d.count):i.bufferSubData(p,d.offset*h.BYTES_PER_ELEMENT,h.subarray(d.offset,d.offset+d.count)),d.count=-1)}function s(l){return l.isInterleavedBufferAttribute&&(l=l.data),r.get(l)}function a(l){l.isInterleavedBufferAttribute&&(l=l.data);let u=r.get(l);u&&(i.deleteBuffer(u.buffer),r.delete(l))}function c(l,u){if(l.isGLBufferAttribute){let h=r.get(l);(!h||h.version<l.version)&&r.set(l,{buffer:l.buffer,type:l.type,bytesPerElement:l.elementSize,version:l.version});return}l.isInterleavedBufferAttribute&&(l=l.data);let p=r.get(l);p===void 0?r.set(l,o(l,u)):p.version<l.version&&(n(p.buffer,l,u),p.version=l.version)}return{get:s,remove:a,update:c}}var Ti=class extends De{constructor(e=1,t=1,r=1,o=1,n=1,s=1){super();this.type="BoxGeometry",this.parameters={width:e,height:t,depth:r,widthSegments:o,heightSegments:n,depthSegments:s};let a=this;o=Math.floor(o),n=Math.floor(n),s=Math.floor(s);let c=[],l=[],u=[],p=[],h=0,d=0;m("z","y","x",-1,-1,r,t,e,s,n,0),m("z","y","x",1,-1,r,t,-e,s,n,1),m("x","z","y",1,1,e,r,t,o,s,2),m("x","z","y",1,-1,e,r,-t,o,s,3),m("x","y","z",1,-1,e,t,r,o,n,4),m("x","y","z",-1,-1,e,t,-r,o,n,5),this.setIndex(c),this.setAttribute("position",new Ce(l,3)),this.setAttribute("normal",new Ce(u,3)),this.setAttribute("uv",new Ce(p,2));function m(f,x,_,g,T,b,y,A,E,S,M){let L=b/E,C=y/S,N=b/2,D=y/2,k=A/2,z=E+1,F=S+1,X=0,$=0,Y=new w;for(let H=0;H<F;H++){let B=H*C-D;for(let te=0;te<z;te++){let q=te*L-N;Y[f]=q*g,Y[x]=B*T,Y[_]=k,l.push(Y.x,Y.y,Y.z),Y[f]=0,Y[x]=0,Y[_]=A>0?1:-1,u.push(Y.x,Y.y,Y.z),p.push(te/E),p.push(1-H/S),X+=1}}for(let H=0;H<S;H++)for(let B=0;B<E;B++){let te=h+B+z*H,q=h+B+z*(H+1),j=h+(B+1)+z*(H+1),R=h+(B+1)+z*H;c.push(te,q,R),c.push(q,j,R),$+=6}a.addGroup(d,$,M),d+=$,h+=X}}static fromJSON(e){return new Ti(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}};var ls=class extends De{constructor(e=1,t=1,r=1,o=1){super();this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:r,heightSegments:o};let n=e/2,s=t/2,a=Math.floor(r),c=Math.floor(o),l=a+1,u=c+1,p=e/a,h=t/c,d=[],m=[],f=[],x=[];for(let _=0;_<u;_++){let g=_*h-s;for(let T=0;T<l;T++){let b=T*p-n;m.push(b,-g,0),f.push(0,0,1),x.push(T/a),x.push(1-_/c)}}for(let _=0;_<c;_++)for(let g=0;g<a;g++){let T=g+l*_,b=g+l*(_+1),y=g+1+l*(_+1),A=g+1+l*_;d.push(T,b,A),d.push(b,y,A)}this.setIndex(d),this.setAttribute("position",new Ce(m,3)),this.setAttribute("normal",new Ce(f,3)),this.setAttribute("uv",new Ce(x,2))}static fromJSON(e){return new ls(e.width,e.height,e.widthSegments,e.heightSegments)}};function Ys(i){let e={};for(let t in i){e[t]={};for(let r in i[t]){let o=i[t][r];o&&(o.isColor||o.isMatrix3||o.isMatrix4||o.isVector2||o.isVector3||o.isVector4||o.isTexture||o.isQuaternion)?e[t][r]=o.clone():Array.isArray(o)?e[t][r]=o.slice():e[t][r]=o}}return e}function po(i){let e={};for(let t=0;t<i.length;t++){let r=Ys(i[t]);for(let o in r)e[o]=r[o]}return e}var Vm={clone:Ys,merge:po};var ry=`
void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}
`;var oy=`
void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}
`;var Ar=class extends Bt{constructor(e){super();this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader=ry,this.fragmentShader=oy,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&(e.attributes!==void 0&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Ys(e.uniforms),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){let t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(let o in this.uniforms){let s=this.uniforms[o].value;s&&s.isTexture?t.uniforms[o]={type:"t",value:s.toJSON(e).uuid}:s&&s.isColor?t.uniforms[o]={type:"c",value:s.getHex()}:s&&s.isVector2?t.uniforms[o]={type:"v2",value:s.toArray()}:s&&s.isVector3?t.uniforms[o]={type:"v3",value:s.toArray()}:s&&s.isVector4?t.uniforms[o]={type:"v4",value:s.toArray()}:s&&s.isMatrix3?t.uniforms[o]={type:"m3",value:s.toArray()}:s&&s.isMatrix4?t.uniforms[o]={type:"m4",value:s.toArray()}:t.uniforms[o]={value:s}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;let r={};for(let o in this.extensions)this.extensions[o]===!0&&(r[o]=!0);return Object.keys(r).length>0&&(t.extensions=r),t}};Ar.prototype.isShaderMaterial=!0;var iy=`
#ifdef USE_ALPHAMAP

	diffuseColor.a *= texture2D( alphaMap, vUv ).g;

#endif
`;var ny=`
#ifdef USE_ALPHAMAP

	uniform sampler2D alphaMap;

#endif
`;var sy=`
#ifdef USE_ALPHATEST

	if ( diffuseColor.a < alphaTest ) discard;

#endif
`;var ay=`
#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif
`;var cy=`
#ifdef USE_AOMAP

	// reads channel R, compatible with a combined OcclusionRoughnessMetallic (RGB) texture
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;

	reflectedLight.indirectDiffuse *= ambientOcclusion;

	#if defined( USE_ENVMAP ) && defined( STANDARD )

		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );

		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );

	#endif

#endif
`;var ly=`
#ifdef USE_AOMAP

	uniform sampler2D aoMap;
	uniform float aoMapIntensity;

#endif
`;var uy=`
vec3 transformed = vec3( position );
`;var py=`
vec3 objectNormal = vec3( normal );

#ifdef USE_TANGENT

	vec3 objectTangent = vec3( tangent.xyz );

#endif
`;var hy=`

vec3 BRDF_Lambert( const in vec3 diffuseColor ) {

	return RECIPROCAL_PI * diffuseColor;

} // validated

vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {

	// Original approximation by Christophe Schlick '94
	// float fresnel = pow( 1.0 - dotVH, 5.0 );

	// Optimized variant (presented by Epic at SIGGRAPH '13)
	// https://cdn2.unrealengine.com/Resources/files/2013SiggraphPresentationsNotes-26915738.pdf
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );

	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );

} // validated

// Moving Frostbite to Physically Based Rendering 3.0 - page 12, listing 2
// https://seblagarde.files.wordpress.com/2015/07/course_notes_moving_frostbite_to_pbr_v32.pdf
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {

	float a2 = pow2( alpha );

	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );

	return 0.5 / max( gv + gl, EPSILON );

}

// Microfacet Models for Refraction through Rough Surfaces - equation (33)
// http://graphicrants.blogspot.com/2013/08/specular-brdf-reference.html
// alpha is "roughness squared" in Disney\u2019s reparameterization
float D_GGX( const in float alpha, const in float dotNH ) {

	float a2 = pow2( alpha );

	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0; // avoid alpha = 0 with dotNH = 1

	return RECIPROCAL_PI * a2 / pow2( denom );

}

// GGX Distribution, Schlick Fresnel, GGX_SmithCorrelated Visibility
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {

	float alpha = pow2( roughness ); // UE4's roughness

	vec3 halfDir = normalize( lightDir + viewDir );

	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );

	vec3 F = F_Schlick( f0, f90, dotVH );

	float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );

	float D = D_GGX( alpha, dotNH );

	return F * ( V * D );

}

// Rect Area Light

// Real-Time Polygonal-Light Shading with Linearly Transformed Cosines
// by Eric Heitz, Jonathan Dupuy, Stephen Hill and David Neubelt
// code: https://github.com/selfshadow/ltc_code/

vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {

	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;

	float dotNV = saturate( dot( N, V ) );

	// texture parameterized by sqrt( GGX alpha ) and sqrt( 1 - cos( theta ) )
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );

	uv = uv * LUT_SCALE + LUT_BIAS;

	return uv;

}

float LTC_ClippedSphereFormFactor( const in vec3 f ) {

	// Real-Time Area Lighting: a Journey from Research to Production (p.102)
	// An approximation of the form factor of a horizon-clipped rectangle.

	float l = length( f );

	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );

}

vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {

	float x = dot( v1, v2 );

	float y = abs( x );

	// rational polynomial approximation to theta / sin( theta ) / 2PI
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;

	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;

	return cross( v1, v2 ) * theta_sintheta;

}

vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {

	// bail if point is on back side of plane of light
	// assumes ccw winding order of light vertices
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );

	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );

	// construct orthonormal basis around N
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 ); // negated from paper; possibly due to a different handedness of world coordinate system

	// compute transform
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );

	// transform rect
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );

	// project rect onto sphere
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );

	// calculate vector form factor
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );

	// adjust for horizon clipping
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );

/*
	// alternate method of adjusting for horizon clipping (see referece)
	// refactoring required
	float len = length( vectorFormFactor );
	float z = vectorFormFactor.z / len;

	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;

	// tabulated horizon-clipped sphere, apparently...
	vec2 uv = vec2( z * 0.5 + 0.5, len );
	uv = uv * LUT_SCALE + LUT_BIAS;

	float scale = texture2D( ltc_2, uv ).w;

	float result = len * scale;
*/

	return vec3( result );

}

// End Rect Area Light


float G_BlinnPhong_Implicit( /* const in float dotNL, const in float dotNV */ ) {

	// geometry term is (n dot l)(n dot v) / 4(n dot l)(n dot v)
	return 0.25;

}

float D_BlinnPhong( const in float shininess, const in float dotNH ) {

	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );

}

vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {

	vec3 halfDir = normalize( lightDir + viewDir );

	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );

	vec3 F = F_Schlick( specularColor, 1.0, dotVH );

	float G = G_BlinnPhong_Implicit( /* dotNL, dotNV */ );

	float D = D_BlinnPhong( shininess, dotNH );

	return F * ( G * D );

} // validated

#if defined( USE_SHEEN )

// https://github.com/google/filament/blob/master/shaders/src/brdf.fs
float D_Charlie( float roughness, float dotNH ) {

	float alpha = pow2( roughness );

	// Estevez and Kulla 2017, "Production Friendly Microfacet Sheen BRDF"
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 ); // 2^(-14/2), so sin2h^2 > 0 in fp16

	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );

}

// https://github.com/google/filament/blob/master/shaders/src/brdf.fs
float V_Neubelt( float dotNV, float dotNL ) {

	// Neubelt and Pettineo 2013, "Crafting a Next-gen Material Pipeline for The Order: 1886"
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );

}

vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {

	vec3 halfDir = normalize( lightDir + viewDir );

	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );

	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );

	return sheenColor * ( D * V );

}

#endif
`;var dy=`
#ifdef USE_BUMPMAP

	uniform sampler2D bumpMap;
	uniform float bumpScale;

	// Bump Mapping Unparametrized Surfaces on the GPU by Morten S. Mikkelsen
	// https://mmikk.github.io/papers3d/mm_sfgrad_bump.pdf

	// Evaluate the derivative of the height w.r.t. screen-space using forward differencing (listing 2)

	vec2 dHdxy_fwd() {

		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );

		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;

		return vec2( dBx, dBy );

	}

	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {

		// Workaround for Adreno 3XX dFd*( vec3 ) bug. See #9988

		vec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );
		vec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );
		vec3 vN = surf_norm;		// normalized

		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );

		float fDet = dot( vSigmaX, R1 ) * faceDirection;

		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );

	}

#endif
`;var fy=`
#if NUM_CLIPPING_PLANES > 0

	vec4 plane;

	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {

		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;

	}
	#pragma unroll_loop_end

	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES

		bool clipped = true;

		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {

			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;

		}
		#pragma unroll_loop_end

		if ( clipped ) discard;

	#endif

#endif
`;var my=`
#if NUM_CLIPPING_PLANES > 0

	varying vec3 vClipPosition;

	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];

#endif
`;var _y=`
#if NUM_CLIPPING_PLANES > 0

	varying vec3 vClipPosition;

#endif
`;var gy=`
#if NUM_CLIPPING_PLANES > 0

	vClipPosition = - mvPosition.xyz;

#endif
`;var vy=`
#if defined( USE_COLOR_ALPHA )

	diffuseColor *= vColor;

#elif defined( USE_COLOR )

	diffuseColor.rgb *= vColor;

#endif
`;var xy=`
#if defined( USE_COLOR_ALPHA )

	varying vec4 vColor;

#elif defined( USE_COLOR )

	varying vec3 vColor;

#endif
`;var yy=`
#if defined( USE_COLOR_ALPHA )

	varying vec4 vColor;

#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )

	varying vec3 vColor;

#endif
`;var by=`
#if defined( USE_COLOR_ALPHA )

	vColor = vec4( 1.0 );

#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )

	vColor = vec3( 1.0 );

#endif

#ifdef USE_COLOR

	vColor *= color;

#endif

#ifdef USE_INSTANCING_COLOR

	vColor.xyz *= instanceColor.xyz;

#endif
`;var Ty=`
#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6

#ifndef saturate
// <tonemapping_pars_fragment> may have defined saturate() already
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )

float pow2( const in float x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }

// expects values in the range of [0,1]x[0,1], returns values in the [0,1] range.
// do not collapse into a single function per: http://byteblacksmith.com/improvements-to-the-canonical-one-liner-glsl-rand-for-opengl-es-2-0/
highp float rand( const in vec2 uv ) {

	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );

	return fract( sin( sn ) * c );

}

#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif

struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};

struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};

struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal;
#endif
};

vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

}

vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {

	// dir can be either a direction vector or a normal vector
	// upper-left 3x3 of matrix is assumed to be orthogonal

	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );

}

mat3 transposeMat3( const in mat3 m ) {

	mat3 tmp;

	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );

	return tmp;

}

// https://en.wikipedia.org/wiki/Relative_luminance
float linearToRelativeLuminance( const in vec3 color ) {

	vec3 weights = vec3( 0.2126, 0.7152, 0.0722 );

	return dot( weights, color.rgb );

}

bool isPerspectiveMatrix( mat4 m ) {

	return m[ 2 ][ 3 ] == - 1.0;

}

vec2 equirectUv( in vec3 dir ) {

	// dir is assumed to be unit length

	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;

	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;

	return vec2( u, v );

}
`;var Ay=`
#ifdef ENVMAP_TYPE_CUBE_UV

	#define cubeUV_maxMipLevel 8.0
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_maxTileSize 256.0
	#define cubeUV_minTileSize 16.0

	// These shader functions convert between the UV coordinates of a single face of
	// a cubemap, the 0-5 integer index of a cube face, and the direction vector for
	// sampling a textureCube (not generally normalized ).

	float getFace( vec3 direction ) {

		vec3 absDirection = abs( direction );

		float face = - 1.0;

		if ( absDirection.x > absDirection.z ) {

			if ( absDirection.x > absDirection.y )

				face = direction.x > 0.0 ? 0.0 : 3.0;

			else

				face = direction.y > 0.0 ? 1.0 : 4.0;

		} else {

			if ( absDirection.z > absDirection.y )

				face = direction.z > 0.0 ? 2.0 : 5.0;

			else

				face = direction.y > 0.0 ? 1.0 : 4.0;

		}

		return face;

	}

	// RH coordinate system; PMREM face-indexing convention
	vec2 getUV( vec3 direction, float face ) {

		vec2 uv;

		if ( face == 0.0 ) {

			uv = vec2( direction.z, direction.y ) / abs( direction.x ); // pos x

		} else if ( face == 1.0 ) {

			uv = vec2( - direction.x, - direction.z ) / abs( direction.y ); // pos y

		} else if ( face == 2.0 ) {

			uv = vec2( - direction.x, direction.y ) / abs( direction.z ); // pos z

		} else if ( face == 3.0 ) {

			uv = vec2( - direction.z, direction.y ) / abs( direction.x ); // neg x

		} else if ( face == 4.0 ) {

			uv = vec2( - direction.x, direction.z ) / abs( direction.y ); // neg y

		} else {

			uv = vec2( direction.x, direction.y ) / abs( direction.z ); // neg z

		}

		return 0.5 * ( uv + 1.0 );

	}

	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {

		float face = getFace( direction );

		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );

		mipInt = max( mipInt, cubeUV_minMipLevel );

		float faceSize = exp2( mipInt );

		float texelSize = 1.0 / ( 3.0 * cubeUV_maxTileSize );

		vec2 uv = getUV( direction, face ) * ( faceSize - 1.0 ) + 0.5;

		if ( face > 2.0 ) {

			uv.y += faceSize;

			face -= 3.0;

		}

		uv.x += face * faceSize;

		if ( mipInt < cubeUV_maxMipLevel ) {

			uv.y += 2.0 * cubeUV_maxTileSize;

		}

		uv.y += filterInt * 2.0 * cubeUV_minTileSize;

		uv.x += 3.0 * max( 0.0, cubeUV_maxTileSize - 2.0 * faceSize );

		uv *= texelSize;

		return texture2D( envMap, uv ).rgb;

	}

	// These defines must match with PMREMGenerator

	#define r0 1.0
	#define v0 0.339
	#define m0 - 2.0
	#define r1 0.8
	#define v1 0.276
	#define m1 - 1.0
	#define r4 0.4
	#define v4 0.046
	#define m4 2.0
	#define r5 0.305
	#define v5 0.016
	#define m5 3.0
	#define r6 0.21
	#define v6 0.0038
	#define m6 4.0

	float roughnessToMip( float roughness ) {

		float mip = 0.0;

		if ( roughness >= r1 ) {

			mip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;

		} else if ( roughness >= r4 ) {

			mip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;

		} else if ( roughness >= r5 ) {

			mip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;

		} else if ( roughness >= r6 ) {

			mip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;

		} else {

			mip = - 2.0 * log2( 1.16 * roughness ); // 1.16 = 1.79^0.25
		}

		return mip;

	}

	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {

		float mip = clamp( roughnessToMip( roughness ), m0, cubeUV_maxMipLevel );

		float mipF = fract( mip );

		float mipInt = floor( mip );

		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );

		if ( mipF == 0.0 ) {

			return vec4( color0, 1.0 );

		} else {

			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );

			return vec4( mix( color0, color1, mipF ), 1.0 );

		}

	}

#endif
`;var Cy=`
vec3 transformedNormal = objectNormal;

#ifdef USE_INSTANCING

	// this is in lieu of a per-instance normal-matrix
	// shear transforms in the instance matrix are not supported

	mat3 m = mat3( instanceMatrix );

	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );

	transformedNormal = m * transformedNormal;

#endif

transformedNormal = normalMatrix * transformedNormal;

#ifdef FLIP_SIDED

	transformedNormal = - transformedNormal;

#endif

#ifdef USE_TANGENT

	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;

	#ifdef FLIP_SIDED

		transformedTangent = - transformedTangent;

	#endif

#endif
`;var Ey=`
#ifdef USE_DISPLACEMENTMAP

	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;

#endif
`;var Sy=`
#ifdef USE_DISPLACEMENTMAP

	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );

#endif
`;var wy=`
#ifdef USE_EMISSIVEMAP

	vec4 emissiveColor = texture2D( emissiveMap, vUv );

	totalEmissiveRadiance *= emissiveColor.rgb;

#endif
`;var My=`
#ifdef USE_EMISSIVEMAP

	uniform sampler2D emissiveMap;

#endif
`;var Ny=`
gl_FragColor = linearToOutputTexel( gl_FragColor );
`;var Oy=`

vec4 LinearToLinear( in vec4 value ) {
	return value;
}

vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}

`;var Py=`
#ifdef USE_ENVMAP

	#ifdef ENV_WORLDPOS

		vec3 cameraToFrag;

		if ( isOrthographic ) {

			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );

		} else {

			cameraToFrag = normalize( vWorldPosition - cameraPosition );

		}

		// Transforming Normal Vectors with the Inverse Transformation
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );

		#ifdef ENVMAP_MODE_REFLECTION

			vec3 reflectVec = reflect( cameraToFrag, worldNormal );

		#else

			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );

		#endif

	#else

		vec3 reflectVec = vReflect;

	#endif

	#ifdef ENVMAP_TYPE_CUBE

		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );

	#elif defined( ENVMAP_TYPE_CUBE_UV )

		vec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );

	#else

		vec4 envColor = vec4( 0.0 );

	#endif

	#ifdef ENVMAP_BLENDING_MULTIPLY

		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );

	#elif defined( ENVMAP_BLENDING_MIX )

		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );

	#elif defined( ENVMAP_BLENDING_ADD )

		outgoingLight += envColor.xyz * specularStrength * reflectivity;

	#endif

#endif
`;var Ry=`
#ifdef USE_ENVMAP

	uniform float envMapIntensity;
	uniform float flipEnvMap;

	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif
`;var Ly=`
#ifdef USE_ENVMAP

	uniform float reflectivity;

	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )

		#define ENV_WORLDPOS

	#endif

	#ifdef ENV_WORLDPOS

		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif

#endif
`;var Iy=`
#ifdef USE_ENVMAP

	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )

		#define ENV_WORLDPOS

	#endif

	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;

	#else

		varying vec3 vReflect;
		uniform float refractionRatio;

	#endif

#endif
`;var Dy=`
#ifdef USE_ENVMAP

	#ifdef ENV_WORLDPOS

		vWorldPosition = worldPosition.xyz;

	#else

		vec3 cameraToVertex;

		if ( isOrthographic ) {

			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );

		} else {

			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );

		}

		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );

		#ifdef ENVMAP_MODE_REFLECTION

			vReflect = reflect( cameraToVertex, worldNormal );

		#else

			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );

		#endif

	#endif

#endif
`;var ky=`
#ifdef USE_FOG

	vFogDepth = - mvPosition.z;

#endif
`;var By=`
#ifdef USE_FOG

	varying float vFogDepth;

#endif
`;var Fy=`
#ifdef USE_FOG

	#ifdef FOG_EXP2

		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );

	#else

		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );

	#endif

	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );

#endif
`;var Uy=`
#ifdef USE_FOG

	uniform vec3 fogColor;
	varying float vFogDepth;

	#ifdef FOG_EXP2

		uniform float fogDensity;

	#else

		uniform float fogNear;
		uniform float fogFar;

	#endif

#endif
`;var Vy=`

#ifdef USE_GRADIENTMAP

	uniform sampler2D gradientMap;

#endif

vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {

	// dotNL will be from -1.0 to 1.0
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );

	#ifdef USE_GRADIENTMAP

		return vec3( texture2D( gradientMap, coord ).r );

	#else

		return ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );

	#endif

}
`;var Gy=`
#ifdef USE_LIGHTMAP

	vec4 lightMapTexel = texture2D( lightMap, vUv2 );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;

	#ifndef PHYSICALLY_CORRECT_LIGHTS

		lightMapIrradiance *= PI;

	#endif

	reflectedLight.indirectDiffuse += lightMapIrradiance;

#endif
`;var zy=`
#ifdef USE_LIGHTMAP

	uniform sampler2D lightMap;
	uniform float lightMapIntensity;

#endif
`;var Hy=`
vec3 diffuse = vec3( 1.0 );

GeometricContext geometry;
geometry.position = mvPosition.xyz;
geometry.normal = normalize( transformedNormal );
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );

GeometricContext backGeometry;
backGeometry.position = geometry.position;
backGeometry.normal = -geometry.normal;
backGeometry.viewDir = geometry.viewDir;

vLightFront = vec3( 0.0 );
vIndirectFront = vec3( 0.0 );
#ifdef DOUBLE_SIDED
	vLightBack = vec3( 0.0 );
	vIndirectBack = vec3( 0.0 );
#endif

IncidentLight directLight;
float dotNL;
vec3 directLightColor_Diffuse;

vIndirectFront += getAmbientLightIrradiance( ambientLightColor );

vIndirectFront += getLightProbeIrradiance( lightProbe, geometry.normal );

#ifdef DOUBLE_SIDED

	vIndirectBack += getAmbientLightIrradiance( ambientLightColor );

	vIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry.normal );

#endif

#if NUM_POINT_LIGHTS > 0

	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {

		getPointLightInfo( pointLights[ i ], geometry, directLight );

		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = directLight.color;

		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;

		#ifdef DOUBLE_SIDED

			vLightBack += saturate( - dotNL ) * directLightColor_Diffuse;

		#endif

	}
	#pragma unroll_loop_end

#endif

#if NUM_SPOT_LIGHTS > 0

	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {

		getSpotLightInfo( spotLights[ i ], geometry, directLight );

		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = directLight.color;

		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;

		#ifdef DOUBLE_SIDED

			vLightBack += saturate( - dotNL ) * directLightColor_Diffuse;

		#endif
	}
	#pragma unroll_loop_end

#endif

#if NUM_DIR_LIGHTS > 0

	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {

		getDirectionalLightInfo( directionalLights[ i ], geometry, directLight );

		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = directLight.color;

		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;

		#ifdef DOUBLE_SIDED

			vLightBack += saturate( - dotNL ) * directLightColor_Diffuse;

		#endif

	}
	#pragma unroll_loop_end

#endif

#if NUM_HEMI_LIGHTS > 0

	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {

		vIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );

		#ifdef DOUBLE_SIDED

			vIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry.normal );

		#endif

	}
	#pragma unroll_loop_end

#endif
`;var jy=`
uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];

// get the irradiance (radiance convolved with cosine lobe) at the point 'normal' on the unit sphere
// source: https://graphics.stanford.edu/papers/envmap/envmap.pdf
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {

	// normal is assumed to have unit length

	float x = normal.x, y = normal.y, z = normal.z;

	// band 0
	vec3 result = shCoefficients[ 0 ] * 0.886227;

	// band 1
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;

	// band 2
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );

	return result;

}

vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {

	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );

	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );

	return irradiance;

}

vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {

	vec3 irradiance = ambientLightColor;

	return irradiance;

}

float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {

	#if defined ( PHYSICALLY_CORRECT_LIGHTS )

		// based upon Frostbite 3 Moving to Physically-based Rendering
		// page 32, equation 26: E[window1]
		// https://seblagarde.files.wordpress.com/2015/07/course_notes_moving_frostbite_to_pbr_v32.pdf
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );

		if ( cutoffDistance > 0.0 ) {

			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );

		}

		return distanceFalloff;

	#else

		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {

			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );

		}

		return 1.0;

	#endif

}

float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {

	return smoothstep( coneCosine, penumbraCosine, angleCosine );

}

#if NUM_DIR_LIGHTS > 0

	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};

	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];

	void getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {

		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;

	}

#endif


#if NUM_POINT_LIGHTS > 0

	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};

	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];

	// light is an out parameter as having it as a return value caused compiler errors on some devices
	void getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {

		vec3 lVector = pointLight.position - geometry.position;

		light.direction = normalize( lVector );

		float lightDistance = length( lVector );

		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );

	}

#endif


#if NUM_SPOT_LIGHTS > 0

	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};

	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];

	// light is an out parameter as having it as a return value caused compiler errors on some devices
	void getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {

		vec3 lVector = spotLight.position - geometry.position;

		light.direction = normalize( lVector );

		float angleCos = dot( light.direction, spotLight.direction );

		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );

		if ( spotAttenuation > 0.0 ) {

			float lightDistance = length( lVector );

			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );

		} else {

			light.color = vec3( 0.0 );
			light.visible = false;

		}

	}

#endif


#if NUM_RECT_AREA_LIGHTS > 0

	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};

	// Pre-computed values of LinearTransformedCosine approximation of BRDF
	// BRDF approximation Texture is 64x64
	uniform sampler2D ltc_1; // RGBA Float
	uniform sampler2D ltc_2; // RGBA Float

	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];

#endif


#if NUM_HEMI_LIGHTS > 0

	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};

	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];

	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {

		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;

		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );

		return irradiance;

	}

#endif
`;var Wy=`
#if defined( USE_ENVMAP )

	#ifdef ENVMAP_MODE_REFRACTION

		uniform float refractionRatio;

	#endif

	vec3 getIBLIrradiance( const in vec3 normal ) {

		#if defined( ENVMAP_TYPE_CUBE_UV )

			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );

			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );

			return PI * envMapColor.rgb * envMapIntensity;

		#else

			return vec3( 0.0 );

		#endif

	}

	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {

		#if defined( ENVMAP_TYPE_CUBE_UV )

			vec3 reflectVec;

			#ifdef ENVMAP_MODE_REFLECTION

				reflectVec = reflect( - viewDir, normal );

				// Mixing the reflection with the normal is more accurate and keeps rough objects from gathering light from behind their tangent plane.
				reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );

			#else

				reflectVec = refract( - viewDir, normal, refractionRatio );

			#endif

			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );

			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );

			return envMapColor.rgb * envMapIntensity;

		#else

			return vec3( 0.0 );

		#endif

	}

#endif
`;var qy=`
ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;
`;var Xy=`
varying vec3 vViewPosition;

struct ToonMaterial {

	vec3 diffuseColor;

};

void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {

	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;

	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );

}

void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {

	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );

}

#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon

#define Material_LightProbeLOD( material )	(0)
`;var Yy=`
BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;
`;var $y=`
varying vec3 vViewPosition;

struct BlinnPhongMaterial {

	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;

};

void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {

	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;

	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );

	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;

}

void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {

	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );

}

#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong

#define Material_LightProbeLOD( material )	(0)
`;var Ky=`
PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );

vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );

material.roughness = max( roughnessFactor, 0.0525 );// 0.0525 corresponds to the base mip of a 256 cubemap.
material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );

#ifdef IOR

	#ifdef SPECULAR

		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;

		#ifdef USE_SPECULARINTENSITYMAP

			specularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;

		#endif

		#ifdef USE_SPECULARCOLORMAP

			specularColorFactor *= texture2D( specularColorMap, vUv ).rgb;

		#endif

		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );

	#else

		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;

	#endif

	material.specularColor = mix( min( pow2( ( ior - 1.0 ) / ( ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );

#else

	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;

#endif

#ifdef USE_CLEARCOAT

	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;

	#ifdef USE_CLEARCOATMAP

		material.clearcoat *= texture2D( clearcoatMap, vUv ).x;

	#endif

	#ifdef USE_CLEARCOAT_ROUGHNESSMAP

		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;

	#endif

	material.clearcoat = saturate( material.clearcoat ); // Burley clearcoat model
	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );

#endif

#ifdef USE_SHEEN

	material.sheenColor = sheenColor;

	#ifdef USE_SHEENCOLORMAP

		material.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;

	#endif

	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );

	#ifdef USE_SHEENROUGHNESSMAP

		material.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;

	#endif

#endif
`;var Jy=`
struct PhysicalMaterial {

	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;

	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif

	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif

};

// temporary
vec3 clearcoatSpecular = vec3( 0.0 );
vec3 sheenSpecular = vec3( 0.0 );

// This is a curve-fit approxmation to the "Charlie sheen" BRDF integrated over the hemisphere from 
// Estevez and Kulla 2017, "Production Friendly Microfacet Sheen BRDF". The analysis can be found
// in the Sheen section of https://drive.google.com/file/d/1T0D1VSyR4AllqIJTQAraEIzjlb5h4FKH/view?usp=sharing
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness) {

	float dotNV = saturate( dot( normal, viewDir ) );

	float r2 = roughness * roughness;

	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;

	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;

	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );

	return saturate( DG * RECIPROCAL_PI );

}

// Analytical approximation of the DFG LUT, one half of the
// split-sum approximation used in indirect specular lighting.
// via 'environmentBRDF' from "Physically Based Shading on Mobile"
// https://www.unrealengine.com/blog/physically-based-shading-on-mobile
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {

	float dotNV = saturate( dot( normal, viewDir ) );

	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );

	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );

	vec4 r = roughness * c0 + c1;

	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;

	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;

	return fab;

}

vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {

	vec2 fab = DFGApprox( normal, viewDir, roughness );

	return specularColor * fab.x + specularF90 * fab.y;

}

// Fdez-Ag\xFCera's "Multiple-Scattering Microfacet Model for Real-Time Image Based Lighting"
// Approximates multiscattering in order to preserve energy.
// http://www.jcgt.org/published/0008/01/03/
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {

	vec2 fab = DFGApprox( normal, viewDir, roughness );

	vec3 FssEss = specularColor * fab.x + specularF90 * fab.y;

	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;

	vec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619; // 1/21
	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );

	singleScatter += FssEss;
	multiScatter += Fms * Ems;

}

#if NUM_RECT_AREA_LIGHTS > 0

	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {

		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;

		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight; // counterclockwise; light shines in local neg z direction
		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;

		vec2 uv = LTC_Uv( normal, viewDir, roughness );

		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );

		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);

		// LTC Fresnel Approximation by Stephen Hill
		// http://blog.selfshadow.com/publications/s2016-advances/s2016_ltc_fresnel.pdf
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );

		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );

		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );

	}

#endif

void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {

	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );

	vec3 irradiance = dotNL * directLight.color;

	#ifdef USE_CLEARCOAT

		float dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );

		vec3 ccIrradiance = dotNLcc * directLight.color;

		clearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );

	#endif

	#ifdef USE_SHEEN

		sheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );

	#endif

	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );


	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}

void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {

	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );

}

void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {

	#ifdef USE_CLEARCOAT

		clearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );

	#endif

	#ifdef USE_SHEEN

		sheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );

	#endif

	// Both indirect specular and indirect diffuse light accumulate here

	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;

	computeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );

	vec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );

	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;

	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;

}

#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical

// ref: https://seblagarde.files.wordpress.com/2015/07/course_notes_moving_frostbite_to_pbr_v32.pdf
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {

	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );

}
`;var Zy=`
/**
 * This is a template that can be used to light a material, it uses pluggable
 * RenderEquations (RE)for specific lighting scenarios.
 *
 * Instructions for use:
 * - Ensure that both RE_Direct, RE_IndirectDiffuse and RE_IndirectSpecular are defined
 * - If you have defined an RE_IndirectSpecular, you need to also provide a Material_LightProbeLOD. <---- ???
 * - Create a material parameter that is to be passed as the third parameter to your lighting functions.
 *
 * TODO:
 * - Add area light support.
 * - Add sphere light support.
 * - Add diffuse light probe (irradiance cubemap) support.
 */

GeometricContext geometry;

geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );

#ifdef USE_CLEARCOAT

	geometry.clearcoatNormal = clearcoatNormal;

#endif

IncidentLight directLight;

#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )

	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif

	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {

		pointLight = pointLights[ i ];

		getPointLightInfo( pointLight, geometry, directLight );

		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif

		RE_Direct( directLight, geometry, material, reflectedLight );

	}
	#pragma unroll_loop_end

#endif

#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )

	SpotLight spotLight;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif

	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {

		spotLight = spotLights[ i ];

		getSpotLightInfo( spotLight, geometry, directLight );

		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
		#endif

		RE_Direct( directLight, geometry, material, reflectedLight );

	}
	#pragma unroll_loop_end

#endif

#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )

	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif

	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {

		directionalLight = directionalLights[ i ];

		getDirectionalLightInfo( directionalLight, geometry, directLight );

		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif

		RE_Direct( directLight, geometry, material, reflectedLight );

	}
	#pragma unroll_loop_end

#endif

#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )

	RectAreaLight rectAreaLight;

	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {

		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );

	}
	#pragma unroll_loop_end

#endif

#if defined( RE_IndirectDiffuse )

	vec3 iblIrradiance = vec3( 0.0 );

	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );

	irradiance += getLightProbeIrradiance( lightProbe, geometry.normal );

	#if ( NUM_HEMI_LIGHTS > 0 )

		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {

			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );

		}
		#pragma unroll_loop_end

	#endif

#endif

#if defined( RE_IndirectSpecular )

	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );

#endif
`;var Qy=`
#if defined( RE_IndirectDiffuse )

	#ifdef USE_LIGHTMAP

		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;

		#ifndef PHYSICALLY_CORRECT_LIGHTS

			lightMapIrradiance *= PI;

		#endif

		irradiance += lightMapIrradiance;

	#endif

	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )

		iblIrradiance += getIBLIrradiance( geometry.normal );

	#endif

#endif

#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )

	radiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );

	#ifdef USE_CLEARCOAT

		clearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );

	#endif

#endif
`;var eb=`
#if defined( RE_IndirectDiffuse )

	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );

#endif

#if defined( RE_IndirectSpecular )

	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );

#endif
`;var tb=`
#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )

	// Doing a strict comparison with == 1.0 can cause noise artifacts
	// on some platforms. See issue #17623.
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;

#endif
`;var rb=`
#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )

	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;

#endif
`;var ob=`
#ifdef USE_LOGDEPTHBUF

	#ifdef USE_LOGDEPTHBUF_EXT

		varying float vFragDepth;
		varying float vIsPerspective;

	#else

		uniform float logDepthBufFC;

	#endif

#endif
`;var ib=`
#ifdef USE_LOGDEPTHBUF

	#ifdef USE_LOGDEPTHBUF_EXT

		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );

	#else

		if ( isPerspectiveMatrix( projectionMatrix ) ) {

			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;

			gl_Position.z *= gl_Position.w;

		}

	#endif

#endif
`;var nb=`
#ifdef USE_MAP

	vec4 sampledDiffuseColor = texture2D( map, vUv );

	#ifdef DECODE_VIDEO_TEXTURE

		// inline sRGB decode (TODO: Remove this code when https://crbug.com/1256340 is solved)

		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );

	#endif

	diffuseColor *= sampledDiffuseColor;

#endif
`;var sb=`
#ifdef USE_MAP

	uniform sampler2D map;

#endif
`;var ab=`
#if defined( USE_MAP ) || defined( USE_ALPHAMAP )

	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;

#endif

#ifdef USE_MAP

	diffuseColor *= texture2D( map, uv );

#endif

#ifdef USE_ALPHAMAP

	diffuseColor.a *= texture2D( alphaMap, uv ).g;

#endif
`;var cb=`
#if defined( USE_MAP ) || defined( USE_ALPHAMAP )

	uniform mat3 uvTransform;

#endif

#ifdef USE_MAP

	uniform sampler2D map;

#endif

#ifdef USE_ALPHAMAP

	uniform sampler2D alphaMap;

#endif
`;var lb=`
float metalnessFactor = metalness;

#ifdef USE_METALNESSMAP

	vec4 texelMetalness = texture2D( metalnessMap, vUv );

	// reads channel B, compatible with a combined OcclusionRoughnessMetallic (RGB) texture
	metalnessFactor *= texelMetalness.b;

#endif
`;var ub=`
#ifdef USE_METALNESSMAP

	uniform sampler2D metalnessMap;

#endif
`;var pb=`
#ifdef USE_MORPHNORMALS

	// morphTargetBaseInfluence is set based on BufferGeometry.morphTargetsRelative value:
	// When morphTargetsRelative is false, this is set to 1 - sum(influences); this results in normal = sum((target - base) * influence)
	// When morphTargetsRelative is true, this is set to 1; as a result, all morph targets are simply added to the base after weighting
	objectNormal *= morphTargetBaseInfluence;

	#ifdef MORPHTARGETS_TEXTURE

		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {

			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1, 2 ) * morphTargetInfluences[ i ];

		}

	#else

		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];

	#endif

#endif
`;var hb=`
#ifdef USE_MORPHTARGETS

	uniform float morphTargetBaseInfluence;

	#ifdef MORPHTARGETS_TEXTURE

		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform vec2 morphTargetsTextureSize;

		vec3 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset, const in int stride ) {

			float texelIndex = float( vertexIndex * stride + offset );
			float y = floor( texelIndex / morphTargetsTextureSize.x );
			float x = texelIndex - y * morphTargetsTextureSize.x;

			vec3 morphUV = vec3( ( x + 0.5 ) / morphTargetsTextureSize.x, y / morphTargetsTextureSize.y, morphTargetIndex );
			return texture( morphTargetsTexture, morphUV ).xyz;

		}

	#else

		#ifndef USE_MORPHNORMALS

			uniform float morphTargetInfluences[ 8 ];

		#else

			uniform float morphTargetInfluences[ 4 ];

		#endif

	#endif

#endif
`;var db=`
#ifdef USE_MORPHTARGETS

	// morphTargetBaseInfluence is set based on BufferGeometry.morphTargetsRelative value:
	// When morphTargetsRelative is false, this is set to 1 - sum(influences); this results in position = sum((target - base) * influence)
	// When morphTargetsRelative is true, this is set to 1; as a result, all morph targets are simply added to the base after weighting
	transformed *= morphTargetBaseInfluence;

	#ifdef MORPHTARGETS_TEXTURE

		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {

			#ifndef USE_MORPHNORMALS

				if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0, 1 ) * morphTargetInfluences[ i ];

			#else

				if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0, 2 ) * morphTargetInfluences[ i ];

			#endif

		}

	#else

		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];

		#ifndef USE_MORPHNORMALS

			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];

		#endif

	#endif

#endif
`;var fb=`
float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;

#ifdef FLAT_SHADED

	// Workaround for Adreno GPUs not able to do dFdx( vViewPosition )

	vec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );
	vec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );
	vec3 normal = normalize( cross( fdx, fdy ) );

#else

	vec3 normal = normalize( vNormal );

	#ifdef DOUBLE_SIDED

		normal = normal * faceDirection;

	#endif

	#ifdef USE_TANGENT

		vec3 tangent = normalize( vTangent );
		vec3 bitangent = normalize( vBitangent );

		#ifdef DOUBLE_SIDED

			tangent = tangent * faceDirection;
			bitangent = bitangent * faceDirection;

		#endif

		#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )

			mat3 vTBN = mat3( tangent, bitangent, normal );

		#endif

	#endif

#endif

// non perturbed normal for clearcoat among others

vec3 geometryNormal = normal;

`;var mb=`

#ifdef OBJECTSPACE_NORMALMAP

	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0; // overrides both flatShading and attribute normals

	#ifdef FLIP_SIDED

		normal = - normal;

	#endif

	#ifdef DOUBLE_SIDED

		normal = normal * faceDirection;

	#endif

	normal = normalize( normalMatrix * normal );

#elif defined( TANGENTSPACE_NORMALMAP )

	vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;

	#ifdef USE_TANGENT

		normal = normalize( vTBN * mapN );

	#else

		normal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );

	#endif

#elif defined( USE_BUMPMAP )

	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );

#endif
`;var _b=`
#ifndef FLAT_SHADED

	varying vec3 vNormal;

	#ifdef USE_TANGENT

		varying vec3 vTangent;
		varying vec3 vBitangent;

	#endif

#endif
`;var gb=`
#ifndef FLAT_SHADED

	varying vec3 vNormal;

	#ifdef USE_TANGENT

		varying vec3 vTangent;
		varying vec3 vBitangent;

	#endif

#endif
`;var vb=`
#ifndef FLAT_SHADED // normal is computed with derivatives when FLAT_SHADED

	vNormal = normalize( transformedNormal );

	#ifdef USE_TANGENT

		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );

	#endif

#endif
`;var xb=`
#ifdef USE_NORMALMAP

	uniform sampler2D normalMap;
	uniform vec2 normalScale;

#endif

#ifdef OBJECTSPACE_NORMALMAP

	uniform mat3 normalMatrix;

#endif

#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )

	// Normal Mapping Without Precomputed Tangents
	// http://www.thetenthplanet.de/archives/1180

	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {

		// Workaround for Adreno 3XX dFd*( vec3 ) bug. See #9988

		vec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );
		vec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );

		vec3 N = surf_norm; // normalized

		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );

		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;

		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );

		return normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );

	}

#endif
`;var yb=`
#ifdef USE_CLEARCOAT

	vec3 clearcoatNormal = geometryNormal;

#endif
`;var bb=`
#ifdef USE_CLEARCOAT_NORMALMAP

	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;

	#ifdef USE_TANGENT

		clearcoatNormal = normalize( vTBN * clearcoatMapN );

	#else

		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );

	#endif

#endif
`;var Tb=`

#ifdef USE_CLEARCOATMAP

	uniform sampler2D clearcoatMap;

#endif

#ifdef USE_CLEARCOAT_ROUGHNESSMAP

	uniform sampler2D clearcoatRoughnessMap;

#endif

#ifdef USE_CLEARCOAT_NORMALMAP

	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;

#endif
`;var Ab=`
#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif

// https://github.com/mrdoob/three.js/pull/22425
#ifdef USE_TRANSMISSION
diffuseColor.a *= transmissionAlpha + 0.1;
#endif

gl_FragColor = vec4( outgoingLight, diffuseColor.a );
`;var Cb=`
vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}

vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}

const float PackUpscale = 256. / 255.; // fraction -> 0..1 (including 1)
const float UnpackDownscale = 255. / 256.; // 0..1 -> fraction (excluding 1)

const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );

const float ShiftRight8 = 1. / 256.;

vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8; // tidy overflow
	return r * PackUpscale;
}

float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}

vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}

vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}

// NOTE: viewZ/eyeZ is < 0 when in front of the camera per OpenGL conventions

float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}

// NOTE: https://twitter.com/gonnavis/status/1377183786949959682

float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}
`;var Eb=`
#ifdef PREMULTIPLIED_ALPHA

	// Get get normal blending with premultipled, use with CustomBlending, OneFactor, OneMinusSrcAlphaFactor, AddEquation.
	gl_FragColor.rgb *= gl_FragColor.a;

#endif
`;var Sb=`
vec4 mvPosition = vec4( transformed, 1.0 );

#ifdef USE_INSTANCING

	mvPosition = instanceMatrix * mvPosition;

#endif

mvPosition = modelViewMatrix * mvPosition;

gl_Position = projectionMatrix * mvPosition;
`;var wb=`
#ifdef DITHERING

	gl_FragColor.rgb = dithering( gl_FragColor.rgb );

#endif
`;var Mb=`
#ifdef DITHERING

	// based on https://www.shadertoy.com/view/MslGR8
	vec3 dithering( vec3 color ) {
		//Calculate grid position
		float grid_position = rand( gl_FragCoord.xy );

		//Shift the individual colors differently, thus making it even harder to see the dithering pattern
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );

		//modify shift acording to grid position.
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );

		//shift the color by dither_shift
		return color + dither_shift_RGB;
	}

#endif
`;var Nb=`
float roughnessFactor = roughness;

#ifdef USE_ROUGHNESSMAP

	vec4 texelRoughness = texture2D( roughnessMap, vUv );

	// reads channel G, compatible with a combined OcclusionRoughnessMetallic (RGB) texture
	roughnessFactor *= texelRoughness.g;

#endif
`;var Ob=`
#ifdef USE_ROUGHNESSMAP

	uniform sampler2D roughnessMap;

#endif
`;var Gm=`
#ifdef USE_SHADOWMAP

	#if NUM_DIR_LIGHT_SHADOWS > 0

		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];

		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};

		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];

	#endif

	#if NUM_SPOT_LIGHT_SHADOWS > 0

		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];

		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};

		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];

	#endif

	#if NUM_POINT_LIGHT_SHADOWS > 0

		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];

		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};

		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];

	#endif

	/*
	#if NUM_RECT_AREA_LIGHTS > 0

		// TODO (abelnation): create uniforms for area light shadows

	#endif
	*/

	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {

		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );

	}

	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {

		return unpackRGBATo2Half( texture2D( shadow, uv ) );

	}

	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){

		float occlusion = 1.0;

		vec2 distribution = texture2DDistribution( shadow, uv );

		float hard_shadow = step( compare , distribution.x ); // Hard Shadow

		if (hard_shadow != 1.0 ) {

			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance ); // Chebeyshevs inequality
			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 ); // 0.3 reduces light bleed
			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );

		}
		return occlusion;

	}

	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {

		float shadow = 1.0;

		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;

		// if ( something && something ) breaks ATI OpenGL shader compiler
		// if ( all( something, something ) ) using this instead

		bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );
		bool inFrustum = all( inFrustumVec );

		bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );

		bool frustumTest = all( frustumTestVec );

		if ( frustumTest ) {

		#if defined( SHADOWMAP_TYPE_PCF )

			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;

			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;

			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );

		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )

			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;

			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;

			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), 
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), 
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );

		#elif defined( SHADOWMAP_TYPE_VSM )

			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );

		#else // no percentage-closer filtering:

			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );

		#endif

		}

		return shadow;

	}

	// cubeToUV() maps a 3D direction vector suitable for cube texture mapping to a 2D
	// vector suitable for 2D texture mapping. This code uses the following layout for the
	// 2D texture:
	//
	// xzXZ
	//  y Y
	//
	// Y - Positive y direction
	// y - Negative y direction
	// X - Positive x direction
	// x - Negative x direction
	// Z - Positive z direction
	// z - Negative z direction
	//
	// Source and test bed:
	// https://gist.github.com/tschw/da10c43c467ce8afd0c4

	vec2 cubeToUV( vec3 v, float texelSizeY ) {

		// Number of texels to avoid at the edge of each square

		vec3 absV = abs( v );

		// Intersect unit cube

		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;

		// Apply scale to avoid seams

		// two texels less per square (one texel will do for NEAREST)
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );

		// Unwrap

		// space: -1 ... 1 range for each square
		//
		// #X##		dim    := ( 4 , 2 )
		//  # #		center := ( 1 , 1 )

		vec2 planar = v.xy;

		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;

		if ( absV.z >= almostOne ) {

			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;

		} else if ( absV.x >= almostOne ) {

			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;

		} else if ( absV.y >= almostOne ) {

			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;

		}

		// Transform to UV space

		// scale := 0.5 / dim
		// translate := ( center + 0.5 ) / dim
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );

	}

	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {

		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );

		// for point lights, the uniform @vShadowCoord is re-purposed to hold
		// the vector from the light to the world-space position of the fragment.
		vec3 lightToPosition = shadowCoord.xyz;

		// dp = normalized distance from light to fragment position
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear ); // need to clamp?
		dp += shadowBias;

		// bd3D = base direction 3D
		vec3 bd3D = normalize( lightToPosition );

		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )

			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;

			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );

		#else // no percentage-closer filtering

			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );

		#endif

	}

#endif
`;var Pb=`
#ifdef USE_SHADOWMAP

	#if NUM_DIR_LIGHT_SHADOWS > 0

		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];

		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};

		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];

	#endif

	#if NUM_SPOT_LIGHT_SHADOWS > 0

		uniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];

		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};

		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];

	#endif

	#if NUM_POINT_LIGHT_SHADOWS > 0

		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];

		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};

		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];

	#endif

	/*
	#if NUM_RECT_AREA_LIGHTS > 0

		// TODO (abelnation): uniforms for area light shadows

	#endif
	*/

#endif
`;var Rb=`
#ifdef USE_SHADOWMAP

	#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0

		// Offsetting the position used for querying occlusion along the world normal can be used to reduce shadow acne.
		vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		vec4 shadowWorldPosition;

	#endif

	#if NUM_DIR_LIGHT_SHADOWS > 0

	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {

		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
		vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;

	}
	#pragma unroll_loop_end

	#endif

	#if NUM_SPOT_LIGHT_SHADOWS > 0

	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {

		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );
		vSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;

	}
	#pragma unroll_loop_end

	#endif

	#if NUM_POINT_LIGHT_SHADOWS > 0

	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {

		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
		vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;

	}
	#pragma unroll_loop_end

	#endif

	/*
	#if NUM_RECT_AREA_LIGHTS > 0

		// TODO (abelnation): update vAreaShadowCoord with area light info

	#endif
	*/

#endif
`;var Lb=`
float getShadowMask() {

	float shadow = 1.0;

	#ifdef USE_SHADOWMAP

	#if NUM_DIR_LIGHT_SHADOWS > 0

	DirectionalLightShadow directionalLight;

	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {

		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;

	}
	#pragma unroll_loop_end

	#endif

	#if NUM_SPOT_LIGHT_SHADOWS > 0

	SpotLightShadow spotLight;

	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {

		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;

	}
	#pragma unroll_loop_end

	#endif

	#if NUM_POINT_LIGHT_SHADOWS > 0

	PointLightShadow pointLight;

	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {

		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;

	}
	#pragma unroll_loop_end

	#endif

	/*
	#if NUM_RECT_AREA_LIGHTS > 0

		// TODO (abelnation): update shadow for Area light

	#endif
	*/

	#endif

	return shadow;

}
`;var Ib=`
#ifdef USE_SKINNING

	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );

#endif
`;var Db=`
#ifdef USE_SKINNING

	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;

	#ifdef BONE_TEXTURE

		uniform highp sampler2D boneTexture;
		uniform int boneTextureSize;

		mat4 getBoneMatrix( const in float i ) {

			float j = i * 4.0;
			float x = mod( j, float( boneTextureSize ) );
			float y = floor( j / float( boneTextureSize ) );

			float dx = 1.0 / float( boneTextureSize );
			float dy = 1.0 / float( boneTextureSize );

			y = dy * ( y + 0.5 );

			vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
			vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
			vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
			vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );

			mat4 bone = mat4( v1, v2, v3, v4 );

			return bone;

		}

	#else

		uniform mat4 boneMatrices[ MAX_BONES ];

		mat4 getBoneMatrix( const in float i ) {

			mat4 bone = boneMatrices[ int(i) ];
			return bone;

		}

	#endif

#endif
`;var kb=`
#ifdef USE_SKINNING

	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );

	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;

	transformed = ( bindMatrixInverse * skinned ).xyz;

#endif
`;var Bb=`
#ifdef USE_SKINNING

	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;

	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;

	#ifdef USE_TANGENT

		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;

	#endif

#endif
`;var Fb=`
float specularStrength;

#ifdef USE_SPECULARMAP

	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;

#else

	specularStrength = 1.0;

#endif
`;var Ub=`
#ifdef USE_SPECULARMAP

	uniform sampler2D specularMap;

#endif
`;var Vb=`
#if defined( TONE_MAPPING )

	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );

#endif
`;var Gb=`
#ifndef saturate
// <common> may have defined saturate() already
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif

uniform float toneMappingExposure;

// exposure only
vec3 LinearToneMapping( vec3 color ) {

	return toneMappingExposure * color;

}

// source: https://www.cs.utah.edu/docs/techreports/2002/pdf/UUCS-02-001.pdf
vec3 ReinhardToneMapping( vec3 color ) {

	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );

}

// source: http://filmicworlds.com/blog/filmic-tonemapping-operators/
vec3 OptimizedCineonToneMapping( vec3 color ) {

	// optimized filmic operator by Jim Hejl and Richard Burgess-Dawson
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );

}

// source: https://github.com/selfshadow/ltc_code/blob/master/webgl/shaders/ltc/ltc_blit.fs
vec3 RRTAndODTFit( vec3 v ) {

	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;

}

// this implementation of ACES is modified to accommodate a brighter viewing environment.
// the scale factor of 1/0.6 is subjective. see discussion in #19621.

vec3 ACESFilmicToneMapping( vec3 color ) {

	// sRGB => XYZ => D65_2_D60 => AP1 => RRT_SAT
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ), // transposed from source
		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);

	// ODT_SAT => XYZ => D60_2_D65 => sRGB
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ), // transposed from source
		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);

	color *= toneMappingExposure / 0.6;

	color = ACESInputMat * color;

	// Apply RRT and ODT
	color = RRTAndODTFit( color );

	color = ACESOutputMat * color;

	// Clamp to [0, 1]
	return saturate( color );

}

vec3 CustomToneMapping( vec3 color ) { return color; }
`;var zb=`
#ifdef USE_TRANSMISSION

	float transmissionAlpha = 1.0;
	float transmissionFactor = transmission;
	float thicknessFactor = thickness;

	#ifdef USE_TRANSMISSIONMAP

		transmissionFactor *= texture2D( transmissionMap, vUv ).r;

	#endif

	#ifdef USE_THICKNESSMAP

		thicknessFactor *= texture2D( thicknessMap, vUv ).g;

	#endif

	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );

	vec4 transmission = getIBLVolumeRefraction(
		n, v, roughnessFactor, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, ior, thicknessFactor,
		attenuationColor, attenuationDistance );

	totalDiffuse = mix( totalDiffuse, transmission.rgb, transmissionFactor );
	transmissionAlpha = mix( transmissionAlpha, transmission.a, transmissionFactor );
#endif
`;var Hb=`
#ifdef USE_TRANSMISSION

	// Transmission code is based on glTF-Sampler-Viewer
	// https://github.com/KhronosGroup/glTF-Sample-Viewer

	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;

	#ifdef USE_TRANSMISSIONMAP

		uniform sampler2D transmissionMap;

	#endif

	#ifdef USE_THICKNESSMAP

		uniform sampler2D thicknessMap;

	#endif

	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;

	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;

	varying vec3 vWorldPosition;

	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {

		// Direction of refracted light.
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );

		// Compute rotation-independant scaling of the model matrix.
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );

		// The thickness is specified in local space.
		return normalize( refractionVector ) * thickness * modelScale;

	}

	float applyIorToRoughness( const in float roughness, const in float ior ) {

		// Scale roughness with IOR so that an IOR of 1.0 results in no microfacet refraction and
		// an IOR of 1.5 results in the default amount of microfacet refraction.
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );

	}

	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {

		float framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );

		#ifdef TEXTURE_LOD_EXT

			return texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );

		#else

			return texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );

		#endif

	}

	vec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {

		if ( attenuationDistance == 0.0 ) {

			// Attenuation distance is +\u221E (which we indicate by zero), i.e. the transmitted color is not attenuated at all.
			return radiance;

		} else {

			// Compute light attenuation using Beer's law.
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance ); // Beer's law
			return transmittance * radiance;

		}

	}

	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {

		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;

		// Project refracted vector on the framebuffer, while mapping to normalized device coordinates.
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;

		// Sample framebuffer to get pixel the refracted ray hits.
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );

		vec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );

		// Get the specular component.
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );

		return vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );

	}
#endif
`;var jb=`
#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )

	varying vec2 vUv;

#endif
`;var Wb=`
#ifdef USE_UV

	#ifdef UVS_VERTEX_ONLY

		vec2 vUv;

	#else

		varying vec2 vUv;

	#endif

	uniform mat3 uvTransform;

#endif
`;var qb=`
#ifdef USE_UV

	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;

#endif
`;var Xb=`
#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )

	varying vec2 vUv2;

#endif
`;var Yb=`
#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )

	attribute vec2 uv2;
	varying vec2 vUv2;

	uniform mat3 uv2Transform;

#endif
`;var $b=`
#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )

	vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;

#endif
`;var Kb=`
#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION )

	vec4 worldPosition = vec4( transformed, 1.0 );

	#ifdef USE_INSTANCING

		worldPosition = instanceMatrix * worldPosition;

	#endif

	worldPosition = modelMatrix * worldPosition;

#endif
`;var Jb=`
varying vec2 vUv;
uniform mat3 uvTransform;

void main() {

	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;

	gl_Position = vec4( position.xy, 1.0, 1.0 );

}
`,Zb=`
uniform sampler2D t2D;

varying vec2 vUv;

void main() {

	gl_FragColor = texture2D( t2D, vUv );

	#include <tonemapping_fragment>
	#include <encodings_fragment>

}
`;var Qb=`
varying vec3 vWorldDirection;

#include <common>

void main() {

	vWorldDirection = transformDirection( position, modelMatrix );

	#include <begin_vertex>
	#include <project_vertex>

	gl_Position.z = gl_Position.w; // set z to camera.far

}
`,eT=`
#include <envmap_common_pars_fragment>
uniform float opacity;

varying vec3 vWorldDirection;

#include <cube_uv_reflection_fragment>

void main() {

	vec3 vReflect = vWorldDirection;
	#include <envmap_fragment>

	gl_FragColor = envColor;
	gl_FragColor.a *= opacity;

	#include <tonemapping_fragment>
	#include <encodings_fragment>

}
`;var tT=`
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

// This is used for computing an equivalent of gl_FragCoord.z that is as high precision as possible.
// Some platforms compute gl_FragCoord at a lower precision which makes the manually computed value better for
// depth-based postprocessing effects. Reproduced on iPad with A10 processor / iPadOS 13.3.1.
varying vec2 vHighPrecisionZW;

void main() {

	#include <uv_vertex>

	#include <skinbase_vertex>

	#ifdef USE_DISPLACEMENTMAP

		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>

	#endif

	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>

	vHighPrecisionZW = gl_Position.zw;

}
`,rT=`
#if DEPTH_PACKING == 3200

	uniform float opacity;

#endif

#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

varying vec2 vHighPrecisionZW;

void main() {

	#include <clipping_planes_fragment>

	vec4 diffuseColor = vec4( 1.0 );

	#if DEPTH_PACKING == 3200

		diffuseColor.a = opacity;

	#endif

	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>

	#include <logdepthbuf_fragment>

	// Higher precision equivalent of gl_FragCoord.z. This assumes depthRange has been left to its default values.
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;

	#if DEPTH_PACKING == 3200

		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );

	#elif DEPTH_PACKING == 3201

		gl_FragColor = packDepthToRGBA( fragCoordZ );

	#endif

}
`;var oT=`
#define DISTANCE

varying vec3 vWorldPosition;

#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {

	#include <uv_vertex>

	#include <skinbase_vertex>

	#ifdef USE_DISPLACEMENTMAP

		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>

	#endif

	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>

	vWorldPosition = worldPosition.xyz;

}
`,iT=`
#define DISTANCE

uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;

#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <clipping_planes_pars_fragment>

void main () {

	#include <clipping_planes_fragment>

	vec4 diffuseColor = vec4( 1.0 );

	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>

	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist ); // clamp to [ 0, 1 ]

	gl_FragColor = packDepthToRGBA( dist );

}
`;var nT=`
varying vec3 vWorldDirection;

#include <common>

void main() {

	vWorldDirection = transformDirection( position, modelMatrix );

	#include <begin_vertex>
	#include <project_vertex>

}
`,sT=`
uniform sampler2D tEquirect;

varying vec3 vWorldDirection;

#include <common>

void main() {

	vec3 direction = normalize( vWorldDirection );

	vec2 sampleUV = equirectUv( direction );

	gl_FragColor = texture2D( tEquirect, sampleUV );

	#include <tonemapping_fragment>
	#include <encodings_fragment>

}
`;var aT=`
uniform float scale;
attribute float lineDistance;

varying float vLineDistance;

#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {

	vLineDistance = scale * lineDistance;

	#include <color_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>

}
`,cT=`
uniform vec3 diffuse;
uniform float opacity;

uniform float dashSize;
uniform float totalSize;

varying float vLineDistance;

#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

void main() {

	#include <clipping_planes_fragment>

	if ( mod( vLineDistance, totalSize ) > dashSize ) {

		discard;

	}

	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );

	#include <logdepthbuf_fragment>
	#include <color_fragment>

	outgoingLight = diffuseColor.rgb; // simple shader

	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>

}
`;var lT=`
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {

	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>

	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )

		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>

	#endif

	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>

	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>

}
`,uT=`
uniform vec3 diffuse;
uniform float opacity;

#ifndef FLAT_SHADED

	varying vec3 vNormal;

#endif

#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

void main() {

	#include <clipping_planes_fragment>

	vec4 diffuseColor = vec4( diffuse, opacity );

	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>

	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );

	// accumulation (baked indirect lighting only)
	#ifdef USE_LIGHTMAP

		vec4 lightMapTexel= texture2D( lightMap, vUv2 );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity;

	#else

		reflectedLight.indirectDiffuse += vec3( 1.0 );

	#endif

	// modulation
	#include <aomap_fragment>

	reflectedLight.indirectDiffuse *= diffuseColor.rgb;

	vec3 outgoingLight = reflectedLight.indirectDiffuse;

	#include <envmap_fragment>

	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>

}
`;var pT=`
#define LAMBERT

varying vec3 vLightFront;
varying vec3 vIndirectFront;

#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif

#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <bsdfs>
#include <lights_pars_begin>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {

	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>

	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>

	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>

	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <lights_lambert_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}
`,hT=`
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;

varying vec3 vLightFront;
varying vec3 vIndirectFront;

#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif


#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <fog_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

void main() {

	#include <clipping_planes_fragment>

	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;

	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <emissivemap_fragment>

	// accumulation

	#ifdef DOUBLE_SIDED

		reflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;

	#else

		reflectedLight.indirectDiffuse += vIndirectFront;

	#endif

	#include <lightmap_fragment>

	reflectedLight.indirectDiffuse *= BRDF_Lambert( diffuseColor.rgb );

	#ifdef DOUBLE_SIDED

		reflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;

	#else

		reflectedLight.directDiffuse = vLightFront;

	#endif

	reflectedLight.directDiffuse *= BRDF_Lambert( diffuseColor.rgb ) * getShadowMask();

	// modulation

	#include <aomap_fragment>

	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;

	#include <envmap_fragment>

	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}
`;var dT=`
#define MATCAP

varying vec3 vViewPosition;

#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>

#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {

	#include <uv_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>

	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>

	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>

	vViewPosition = - mvPosition.xyz;

}
`,fT=`
#define MATCAP

uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;

varying vec3 vViewPosition;

#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

void main() {

	#include <clipping_planes_fragment>

	vec4 diffuseColor = vec4( diffuse, opacity );

	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>

	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5; // 0.495 to remove artifacts caused by undersized matcap disks

	#ifdef USE_MATCAP

		vec4 matcapColor = texture2D( matcap, uv );

	#else

		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 ); // default if matcap is missing

	#endif

	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;

	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>

}
`;var mT=`
#define NORMAL

#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )

	varying vec3 vViewPosition;

#endif

#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {

	#include <uv_vertex>

	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>

	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>

#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )

	vViewPosition = - mvPosition.xyz;

#endif

}
`,_T=`
#define NORMAL

uniform float opacity;

#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )

	varying vec3 vViewPosition;

#endif

#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

void main() {

	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>

	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );

	#ifdef OPAQUE

		gl_FragColor.a = 1.0;

	#endif

}
`;var gT=`
#define PHONG

varying vec3 vViewPosition;

#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {

	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>

	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>

	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>

	vViewPosition = - mvPosition.xyz;

	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>

}
`,vT=`
#define PHONG

uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;

#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

void main() {

	#include <clipping_planes_fragment>

	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;

	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>

	// accumulation
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>

	// modulation
	#include <aomap_fragment>

	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;

	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>

}
`;var xT=`
#define STANDARD

varying vec3 vViewPosition;

#ifdef USE_TRANSMISSION

	varying vec3 vWorldPosition;

#endif

#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {

	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>

	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>

	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>

	vViewPosition = - mvPosition.xyz;

	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>

#ifdef USE_TRANSMISSION

	vWorldPosition = worldPosition.xyz;

#endif
}
`,yT=`
#define STANDARD

#ifdef PHYSICAL
	#define IOR
	#define SPECULAR
#endif

uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;

#ifdef IOR
	uniform float ior;
#endif

#ifdef SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;

	#ifdef USE_SPECULARINTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif

	#ifdef USE_SPECULARCOLORMAP
		uniform sampler2D specularColorMap;
	#endif
#endif

#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif

#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;

	#ifdef USE_SHEENCOLORMAP
		uniform sampler2D sheenColorMap;
	#endif

	#ifdef USE_SHEENROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif

varying vec3 vViewPosition;

#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <bsdfs>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

void main() {

	#include <clipping_planes_fragment>

	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;

	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>

	// accumulation
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>

	// modulation
	#include <aomap_fragment>

	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;

	#include <transmission_fragment>

	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;

	#ifdef USE_SHEEN

		// Sheen energy compensation approximation calculation can be found at the end of
		// https://drive.google.com/file/d/1T0D1VSyR4AllqIJTQAraEIzjlb5h4FKH/view?usp=sharing
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );

		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;

	#endif

	#ifdef USE_CLEARCOAT

		float dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );

		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );

		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;

	#endif

	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>

}
`;var bT=`
#define TOON

varying vec3 vViewPosition;

#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {

	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>

	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>

	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>

	vViewPosition = - mvPosition.xyz;

	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>

}
`,TT=`
#define TOON

uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;

#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

void main() {

	#include <clipping_planes_fragment>

	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;

	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>

	// accumulation
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>

	// modulation
	#include <aomap_fragment>

	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;

	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>

}
`;var AT=`
uniform float size;
uniform float scale;

#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {

	#include <color_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>

	gl_PointSize = size;

	#ifdef USE_SIZEATTENUATION

		bool isPerspective = isPerspectiveMatrix( projectionMatrix );

		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );

	#endif

	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>

}
`,CT=`
uniform vec3 diffuse;
uniform float opacity;

#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

void main() {

	#include <clipping_planes_fragment>

	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );

	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>

	outgoingLight = diffuseColor.rgb;

	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>

}
`;var ET=`
#include <common>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>

void main() {

	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>

	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>

	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>

}
`,ST=`
uniform vec3 color;
uniform float opacity;

#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>

void main() {

	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );

	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>

}
`;var wT=`
uniform float rotation;
uniform vec2 center;

#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {

	#include <uv_vertex>

	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );

	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );

	#ifndef USE_SIZEATTENUATION

		bool isPerspective = isPerspectiveMatrix( projectionMatrix );

		if ( isPerspective ) scale *= - mvPosition.z;

	#endif

	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;

	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;

	mvPosition.xy += rotatedPosition;

	gl_Position = projectionMatrix * mvPosition;

	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>

}
`,MT=`
uniform vec3 diffuse;
uniform float opacity;

#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

void main() {

	#include <clipping_planes_fragment>

	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );

	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>

	outgoingLight = diffuseColor.rgb;

	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>

}
`;var dt={alphamap_fragment:iy,alphamap_pars_fragment:ny,alphatest_fragment:sy,alphatest_pars_fragment:ay,aomap_fragment:cy,aomap_pars_fragment:ly,begin_vertex:uy,beginnormal_vertex:py,bsdfs:hy,bumpmap_pars_fragment:dy,clipping_planes_fragment:fy,clipping_planes_pars_fragment:my,clipping_planes_pars_vertex:_y,clipping_planes_vertex:gy,color_fragment:vy,color_pars_fragment:xy,color_pars_vertex:yy,color_vertex:by,common:Ty,cube_uv_reflection_fragment:Ay,defaultnormal_vertex:Cy,displacementmap_pars_vertex:Ey,displacementmap_vertex:Sy,emissivemap_fragment:wy,emissivemap_pars_fragment:My,encodings_fragment:Ny,encodings_pars_fragment:Oy,envmap_fragment:Py,envmap_common_pars_fragment:Ry,envmap_pars_fragment:Ly,envmap_pars_vertex:Iy,envmap_physical_pars_fragment:Wy,envmap_vertex:Dy,fog_vertex:ky,fog_pars_vertex:By,fog_fragment:Fy,fog_pars_fragment:Uy,gradientmap_pars_fragment:Vy,lightmap_fragment:Gy,lightmap_pars_fragment:zy,lights_lambert_vertex:Hy,lights_pars_begin:jy,lights_toon_fragment:qy,lights_toon_pars_fragment:Xy,lights_phong_fragment:Yy,lights_phong_pars_fragment:$y,lights_physical_fragment:Ky,lights_physical_pars_fragment:Jy,lights_fragment_begin:Zy,lights_fragment_maps:Qy,lights_fragment_end:eb,logdepthbuf_fragment:tb,logdepthbuf_pars_fragment:rb,logdepthbuf_pars_vertex:ob,logdepthbuf_vertex:ib,map_fragment:nb,map_pars_fragment:sb,map_particle_fragment:ab,map_particle_pars_fragment:cb,metalnessmap_fragment:lb,metalnessmap_pars_fragment:ub,morphnormal_vertex:pb,morphtarget_pars_vertex:hb,morphtarget_vertex:db,normal_fragment_begin:fb,normal_fragment_maps:mb,normal_pars_fragment:_b,normal_pars_vertex:gb,normal_vertex:vb,normalmap_pars_fragment:xb,clearcoat_normal_fragment_begin:yb,clearcoat_normal_fragment_maps:bb,clearcoat_pars_fragment:Tb,output_fragment:Ab,packing:Cb,premultiplied_alpha_fragment:Eb,project_vertex:Sb,dithering_fragment:wb,dithering_pars_fragment:Mb,roughnessmap_fragment:Nb,roughnessmap_pars_fragment:Ob,shadowmap_pars_fragment:Gm,shadowmap_pars_vertex:Pb,shadowmap_vertex:Rb,shadowmask_pars_fragment:Lb,skinbase_vertex:Ib,skinning_pars_vertex:Db,skinning_vertex:kb,skinnormal_vertex:Bb,specularmap_fragment:Fb,specularmap_pars_fragment:Ub,tonemapping_fragment:Vb,tonemapping_pars_fragment:Gb,transmission_fragment:zb,transmission_pars_fragment:Hb,uv_pars_fragment:jb,uv_pars_vertex:Wb,uv_vertex:qb,uv2_pars_fragment:Xb,uv2_pars_vertex:Yb,uv2_vertex:$b,worldpos_vertex:Kb,background_vert:Jb,background_frag:Zb,cube_vert:Qb,cube_frag:eT,depth_vert:tT,depth_frag:rT,distanceRGBA_vert:oT,distanceRGBA_frag:iT,equirect_vert:nT,equirect_frag:sT,linedashed_vert:aT,linedashed_frag:cT,meshbasic_vert:lT,meshbasic_frag:uT,meshlambert_vert:pT,meshlambert_frag:hT,meshmatcap_vert:dT,meshmatcap_frag:fT,meshnormal_vert:mT,meshnormal_frag:_T,meshphong_vert:gT,meshphong_frag:vT,meshphysical_vert:xT,meshphysical_frag:yT,meshtoon_vert:bT,meshtoon_frag:TT,points_vert:AT,points_frag:CT,shadow_vert:ET,shadow_frag:ST,sprite_vert:wT,sprite_frag:MT};var Te={common:{diffuse:{value:new he(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new zo},uv2Transform:{value:new zo},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new G(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new he(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new he(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new zo}},sprite:{diffuse:{value:new he(16777215)},opacity:{value:1},center:{value:new G(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new zo}}};var Yi={basic:{uniforms:po([Te.common,Te.specularmap,Te.envmap,Te.aomap,Te.lightmap,Te.fog]),vertexShader:dt.meshbasic_vert,fragmentShader:dt.meshbasic_frag},lambert:{uniforms:po([Te.common,Te.specularmap,Te.envmap,Te.aomap,Te.lightmap,Te.emissivemap,Te.fog,Te.lights,{emissive:{value:new he(0)}}]),vertexShader:dt.meshlambert_vert,fragmentShader:dt.meshlambert_frag},phong:{uniforms:po([Te.common,Te.specularmap,Te.envmap,Te.aomap,Te.lightmap,Te.emissivemap,Te.bumpmap,Te.normalmap,Te.displacementmap,Te.fog,Te.lights,{emissive:{value:new he(0)},specular:{value:new he(1118481)},shininess:{value:30}}]),vertexShader:dt.meshphong_vert,fragmentShader:dt.meshphong_frag},standard:{uniforms:po([Te.common,Te.envmap,Te.aomap,Te.lightmap,Te.emissivemap,Te.bumpmap,Te.normalmap,Te.displacementmap,Te.roughnessmap,Te.metalnessmap,Te.fog,Te.lights,{emissive:{value:new he(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:dt.meshphysical_vert,fragmentShader:dt.meshphysical_frag},toon:{uniforms:po([Te.common,Te.aomap,Te.lightmap,Te.emissivemap,Te.bumpmap,Te.normalmap,Te.displacementmap,Te.gradientmap,Te.fog,Te.lights,{emissive:{value:new he(0)}}]),vertexShader:dt.meshtoon_vert,fragmentShader:dt.meshtoon_frag},matcap:{uniforms:po([Te.common,Te.bumpmap,Te.normalmap,Te.displacementmap,Te.fog,{matcap:{value:null}}]),vertexShader:dt.meshmatcap_vert,fragmentShader:dt.meshmatcap_frag},points:{uniforms:po([Te.points,Te.fog]),vertexShader:dt.points_vert,fragmentShader:dt.points_frag},dashed:{uniforms:po([Te.common,Te.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:dt.linedashed_vert,fragmentShader:dt.linedashed_frag},depth:{uniforms:po([Te.common,Te.displacementmap]),vertexShader:dt.depth_vert,fragmentShader:dt.depth_frag},normal:{uniforms:po([Te.common,Te.bumpmap,Te.normalmap,Te.displacementmap,{opacity:{value:1}}]),vertexShader:dt.meshnormal_vert,fragmentShader:dt.meshnormal_frag},sprite:{uniforms:po([Te.sprite,Te.fog]),vertexShader:dt.sprite_vert,fragmentShader:dt.sprite_frag},background:{uniforms:{uvTransform:{value:new zo},t2D:{value:null}},vertexShader:dt.background_vert,fragmentShader:dt.background_frag},cube:{uniforms:po([Te.envmap,{opacity:{value:1}}]),vertexShader:dt.cube_vert,fragmentShader:dt.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:dt.equirect_vert,fragmentShader:dt.equirect_frag},distanceRGBA:{uniforms:po([Te.common,Te.displacementmap,{referencePosition:{value:new w},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:dt.distanceRGBA_vert,fragmentShader:dt.distanceRGBA_frag},shadow:{uniforms:po([Te.lights,Te.fog,{color:{value:new he(0)},opacity:{value:1}}]),vertexShader:dt.shadow_vert,fragmentShader:dt.shadow_frag}};Yi.physical={uniforms:po([Yi.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new G(1,1)},clearcoatNormalMap:{value:null},sheen:{value:0},sheenColor:{value:new he(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new G},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new he(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new he(1,1,1)},specularColorMap:{value:null}}]),vertexShader:dt.meshphysical_vert,fragmentShader:dt.meshphysical_frag};function NT(i,e,t,r,o,n){let s=new he(0),a=o===!0?0:1,c,l,u=null,p=0,h=null;function d(f,x){let _=!1,g=x.isScene===!0?x.background:null;g&&g.isTexture&&(g=e.get(g));let T=i.xr,b=T.getSession&&T.getSession();b&&b.environmentBlendMode==="additive"&&(g=null),g===null?m(s,a):g&&g.isColor&&(m(g,1),_=!0),(i.autoClear||_)&&i.clear(i.autoClearColor,i.autoClearDepth,i.autoClearStencil),g&&(g.isCubeTexture||g.mapping===ii)?(l===void 0&&(l=new lt(new Ti(1,1,1),new Ar({name:"BackgroundCubeMaterial",uniforms:Ys(Yi.cube.uniforms),vertexShader:Yi.cube.vertexShader,fragmentShader:Yi.cube.fragmentShader,side:Dt,depthTest:!1,depthWrite:!1,fog:!1})),l.geometry.deleteAttribute("normal"),l.geometry.deleteAttribute("uv"),l.onBeforeRender=function(y,A,E){this.matrixWorld.copyPosition(E.matrixWorld)},Object.defineProperty(l.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(l)),l.material.uniforms.envMap.value=g,l.material.uniforms.flipEnvMap.value=g.isCubeTexture&&g.isRenderTargetTexture===!1?-1:1,(u!==g||p!==g.version||h!==i.toneMapping)&&(l.material.needsUpdate=!0,u=g,p=g.version,h=i.toneMapping),f.unshift(l,l.geometry,l.material,0,0,null)):g&&g.isTexture&&(c===void 0&&(c=new lt(new ls(2,2),new Ar({name:"BackgroundMaterial",uniforms:Ys(Yi.background.uniforms),vertexShader:Yi.background.vertexShader,fragmentShader:Yi.background.fragmentShader,side:oo,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),Object.defineProperty(c.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(c)),c.material.uniforms.t2D.value=g,g.matrixAutoUpdate===!0&&g.updateMatrix(),c.material.uniforms.uvTransform.value.copy(g.matrix),(u!==g||p!==g.version||h!==i.toneMapping)&&(c.material.needsUpdate=!0,u=g,p=g.version,h=i.toneMapping),f.unshift(c,c.geometry,c.material,0,0,null))}function m(f,x){t.buffers.color.setClear(f.r,f.g,f.b,x,n)}return{getClearColor:function(){return s},setClearColor:function(f,x=1){s.set(f),a=x,m(s,a)},getClearAlpha:function(){return a},setClearAlpha:function(f){a=f,m(s,a)},render:d}}function OT(i,e,t,r){let o=i.getParameter(i.MAX_VERTEX_ATTRIBS),n=r.isWebGL2?null:e.get("OES_vertex_array_object"),s=r.isWebGL2||n!==null,a={},c=f(null),l=c;function u(D,k,z,F,X){let $=!1;if(s){let Y=m(F,z,k);l!==Y&&(l=Y,h(l.object)),$=x(F,X),$&&_(F,X)}else{let Y=k.wireframe===!0;(l.geometry!==F.id||l.program!==z.id||l.wireframe!==Y)&&(l.geometry=F.id,l.program=z.id,l.wireframe=Y,$=!0)}D.isInstancedMesh===!0&&($=!0),X!==null&&t.update(X,i.ELEMENT_ARRAY_BUFFER),$&&(E(D,k,z,F),X!==null&&i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,t.get(X).buffer))}function p(){return r.isWebGL2?i.createVertexArray():n.createVertexArrayOES()}function h(D){return r.isWebGL2?i.bindVertexArray(D):n.bindVertexArrayOES(D)}function d(D){return r.isWebGL2?i.deleteVertexArray(D):n.deleteVertexArrayOES(D)}function m(D,k,z){let F=z.wireframe===!0,X=a[D.id];X===void 0&&(X={},a[D.id]=X);let $=X[k.id];$===void 0&&($={},X[k.id]=$);let Y=$[F];return Y===void 0&&(Y=f(p()),$[F]=Y),Y}function f(D){let k=[],z=[],F=[];for(let X=0;X<o;X++)k[X]=0,z[X]=0,F[X]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:k,enabledAttributes:z,attributeDivisors:F,object:D,attributes:{},index:null}}function x(D,k){let z=l.attributes,F=D.attributes,X=0;for(let $ in F){let Y=z[$],H=F[$];if(Y===void 0||Y.attribute!==H||Y.data!==H.data)return!0;X++}return l.attributesNum!==X||l.index!==k}function _(D,k){let z={},F=D.attributes,X=0;for(let $ in F){let Y=F[$],H={};H.attribute=Y,Y.data&&(H.data=Y.data),z[$]=H,X++}l.attributes=z,l.attributesNum=X,l.index=k}function g(){let D=l.newAttributes;for(let k=0,z=D.length;k<z;k++)D[k]=0}function T(D){b(D,0)}function b(D,k){let z=l.newAttributes,F=l.enabledAttributes,X=l.attributeDivisors;z[D]=1,F[D]===0&&(i.enableVertexAttribArray(D),F[D]=1),X[D]!==k&&((r.isWebGL2?i:e.get("ANGLE_instanced_arrays"))[r.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](D,k),X[D]=k)}function y(){let D=l.newAttributes,k=l.enabledAttributes;for(let z=0,F=k.length;z<F;z++)k[z]!==D[z]&&(i.disableVertexAttribArray(z),k[z]=0)}function A(D,k,z,F,X,$){r.isWebGL2===!0&&(z===i.INT||z===i.UNSIGNED_INT)?i.vertexAttribIPointer(D,k,z,X,$):i.vertexAttribPointer(D,k,z,F,X,$)}function E(D,k,z,F){if(r.isWebGL2===!1&&(D.isInstancedMesh||F.isInstancedBufferGeometry)&&e.get("ANGLE_instanced_arrays")===null)return;g();let X=F.attributes,$=z.getAttributes(),Y=k.defaultAttributeValues;for(let H in $){let B=$[H];if(B.location>=0){let te=X[H];if(te===void 0&&(H==="instanceMatrix"&&D.instanceMatrix&&(te=D.instanceMatrix),H==="instanceColor"&&D.instanceColor&&(te=D.instanceColor)),te!==void 0){let q=te.normalized,j=te.itemSize,R=t.get(te);if(R===void 0)continue;let Ne=R.buffer,xe=R.type,ae=R.bytesPerElement;if(te.isInterleavedBufferAttribute){let Ae=te.data,Re=Ae.stride,Oe=te.offset;if(Ae&&Ae.isInstancedInterleavedBuffer){for(let le=0;le<B.locationSize;le++)b(B.location+le,Ae.meshPerAttribute);D.isInstancedMesh!==!0&&F._maxInstanceCount===void 0&&(F._maxInstanceCount=Ae.meshPerAttribute*Ae.count)}else for(let le=0;le<B.locationSize;le++)T(B.location+le);i.bindBuffer(i.ARRAY_BUFFER,Ne);for(let le=0;le<B.locationSize;le++)A(B.location+le,j/B.locationSize,xe,q,Re*ae,(Oe+j/B.locationSize*le)*ae)}else{if(te.isInstancedBufferAttribute){for(let Ae=0;Ae<B.locationSize;Ae++)b(B.location+Ae,te.meshPerAttribute);D.isInstancedMesh!==!0&&F._maxInstanceCount===void 0&&(F._maxInstanceCount=te.meshPerAttribute*te.count)}else for(let Ae=0;Ae<B.locationSize;Ae++)T(B.location+Ae);i.bindBuffer(i.ARRAY_BUFFER,Ne);for(let Ae=0;Ae<B.locationSize;Ae++)A(B.location+Ae,j/B.locationSize,xe,q,j*ae,j/B.locationSize*Ae*ae)}}else if(Y!==void 0){let q=Y[H];if(q!==void 0)switch(q.length){case 2:i.vertexAttrib2fv(B.location,q);break;case 3:i.vertexAttrib3fv(B.location,q);break;case 4:i.vertexAttrib4fv(B.location,q);break;default:i.vertexAttrib1fv(B.location,q)}}}}y()}function S(){C();for(let D in a){let k=a[D];for(let z in k){let F=k[z];for(let X in F)d(F[X].object),delete F[X];delete k[z]}delete a[D]}}function M(D){if(a[D.id]===void 0)return;let k=a[D.id];for(let z in k){let F=k[z];for(let X in F)d(F[X].object),delete F[X];delete k[z]}delete a[D.id]}function L(D){for(let k in a){let z=a[k];if(z[D.id]===void 0)continue;let F=z[D.id];for(let X in F)d(F[X].object),delete F[X];delete z[D.id]}}function C(){N(),l!==c&&(l=c,h(l.object))}function N(){c.geometry=null,c.program=null,c.wireframe=!1}return{setup:u,reset:C,resetDefaultState:N,dispose:S,releaseStatesOfGeometry:M,releaseStatesOfProgram:L,initAttributes:g,enableAttribute:T,disableUnusedAttributes:y}}function PT(i,e,t,r){let o=r.isWebGL2,n;function s(l){n=l}function a(l,u){i.drawArrays(n,l,u),t.update(u,n,1)}function c(l,u,p){if(p===0)return;let h,d;if(o)h=i,d="drawArraysInstanced";else if(h=e.get("ANGLE_instanced_arrays"),d="drawArraysInstancedANGLE",h===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}h[d](n,l,u,p),t.update(u,n,p)}this.setMode=s,this.render=a,this.renderInstances=c}function RT(i,e,t){let r;function o(){if(r!==void 0)return r;if(e.has("EXT_texture_filter_anisotropic")===!0){let E=e.get("EXT_texture_filter_anisotropic");r=i.getParameter(E.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r}function n(E){if(E==="highp"){if(i.getShaderPrecisionFormat(i.VERTEX_SHADER,i.HIGH_FLOAT).precision>0&&i.getShaderPrecisionFormat(i.FRAGMENT_SHADER,i.HIGH_FLOAT).precision>0)return"highp";E="mediump"}return E==="mediump"&&i.getShaderPrecisionFormat(i.VERTEX_SHADER,i.MEDIUM_FLOAT).precision>0&&i.getShaderPrecisionFormat(i.FRAGMENT_SHADER,i.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let s=typeof WebGL2RenderingContext<"u"&&i instanceof WebGL2RenderingContext||typeof WebGL2ComputeRenderingContext<"u"&&i instanceof WebGL2ComputeRenderingContext,a=t.precision!==void 0?t.precision:"highp",c=n(a);c!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",c,"instead."),a=c);let l=s||e.has("WEBGL_draw_buffers"),u=t.logarithmicDepthBuffer===!0,p=i.getParameter(i.MAX_TEXTURE_IMAGE_UNITS),h=i.getParameter(i.MAX_VERTEX_TEXTURE_IMAGE_UNITS),d=i.getParameter(i.MAX_TEXTURE_SIZE),m=i.getParameter(i.MAX_CUBE_MAP_TEXTURE_SIZE),f=i.getParameter(i.MAX_VERTEX_ATTRIBS),x=i.getParameter(i.MAX_VERTEX_UNIFORM_VECTORS),_=i.getParameter(i.MAX_VARYING_VECTORS),g=i.getParameter(i.MAX_FRAGMENT_UNIFORM_VECTORS),T=h>0,b=s||e.has("OES_texture_float"),y=T&&b,A=s?i.getParameter(i.MAX_SAMPLES):0;return{isWebGL2:s,drawBuffers:l,getMaxAnisotropy:o,getMaxPrecision:n,precision:a,logarithmicDepthBuffer:u,maxTextures:p,maxVertexTextures:h,maxTextureSize:d,maxCubemapSize:m,maxAttributes:f,maxVertexUniforms:x,maxVaryings:_,maxFragmentUniforms:g,vertexTextures:T,floatFragmentTextures:b,floatVertexTextures:y,maxSamples:A}}function LT(i){let e=this,t=null,r=0,o=!1,n=!1,s=new bi,a=new zo,c={value:null,needsUpdate:!1};this.uniform=c,this.numPlanes=0,this.numIntersection=0,this.init=function(p,h,d){let m=p.length!==0||h||r!==0||o;return o=h,t=u(p,d,0),r=p.length,m},this.beginShadows=function(){n=!0,u(null)},this.endShadows=function(){n=!1,l()},this.setState=function(p,h,d){let m=p.clippingPlanes,f=p.clipIntersection,x=p.clipShadows,_=i.get(p);if(!o||m===null||m.length===0||n&&!x)n?u(null):l();else{let g=n?0:r,T=g*4,b=_.clippingState||null;c.value=b,b=u(m,h,T,d);for(let y=0;y!==T;++y)b[y]=t[y];_.clippingState=b,this.numIntersection=f?this.numPlanes:0,this.numPlanes+=g}};function l(){c.value!==t&&(c.value=t,c.needsUpdate=r>0),e.numPlanes=r,e.numIntersection=0}function u(p,h,d,m){let f=p!==null?p.length:0,x=null;if(f!==0){if(x=c.value,m!==!0||x===null){let _=d+f*4,g=h.matrixWorldInverse;a.getNormalMatrix(g),(x===null||x.length<_)&&(x=new Float32Array(_));for(let T=0,b=d;T!==f;++T,b+=4)s.copy(p[T]).applyMatrix4(g,a),s.normal.toArray(x,b),x[b+3]=s.constant}c.value=x,c.needsUpdate=!0}return e.numPlanes=f,e.numIntersection=0,x}}var vr=class extends Ul{constructor(e,t,r={}){super();this.width=e,this.height=t,this.depth=1,this.scissor=new Ie(0,0,e,t),this.scissorTest=!1,this.viewport=new Ie(0,0,e,t),this.texture=new gr(void 0,r.mapping,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.encoding),this.texture.isRenderTargetTexture=!0,this.texture.image={width:e,height:t,depth:1},this.texture.generateMipmaps=r.generateMipmaps!==void 0?r.generateMipmaps:!1,this.texture.internalFormat=r.internalFormat!==void 0?r.internalFormat:null,this.texture.minFilter=r.minFilter!==void 0?r.minFilter:at,this.depthBuffer=r.depthBuffer!==void 0?r.depthBuffer:!0,this.stencilBuffer=r.stencilBuffer!==void 0?r.stencilBuffer:!1,this.depthTexture=r.depthTexture!==void 0?r.depthTexture:null}setTexture(e){e.image={width:this.width,height:this.height,depth:this.depth},this.texture=e}setSize(e,t,r=1){(this.width!==e||this.height!==t||this.depth!==r)&&(this.width=e,this.height=t,this.depth=r,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=r,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.image=Object.assign({},e.texture.image),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this}dispose(){this.dispatchEvent({type:"dispose"})}};vr.prototype.isWebGLRenderTarget=!0;var us=class extends vt{constructor(){super();this.type="Camera",this.matrixWorldInverse=new Ve,this.projectionMatrix=new Ve,this.projectionMatrixInverse=new Ve}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);let t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}};us.prototype.isCamera=!0;var ir=class extends us{constructor(e=50,t=1,r=.1,o=2e3){super();this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=r,this.far=o,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){let t=.5*this.getFilmHeight()/e;this.fov=uh*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){let e=Math.tan(L0*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return uh*2*Math.atan(Math.tan(L0*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,r,o,n,s){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=o,this.view.width=n,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=this.near,t=e*Math.tan(L0*.5*this.fov)/this.zoom,r=2*t,o=this.aspect*r,n=-.5*o,s=this.view;if(this.view!==null&&this.view.enabled){let c=s.fullWidth,l=s.fullHeight;n+=s.offsetX*o/c,t-=s.offsetY*r/l,o*=s.width/c,r*=s.height/l}let a=this.filmOffset;a!==0&&(n+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(n,n+o,t,t-r,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){let t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}};ir.prototype.isPerspectiveCamera=!0;var Hl=90,jl=1,s3=class extends vt{constructor(e,t,r){super();if(this.type="CubeCamera",r.isWebGLCubeRenderTarget!==!0){console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");return}this.renderTarget=r;let o=new ir(Hl,jl,e,t);o.layers=this.layers,o.up.set(0,-1,0),o.lookAt(new w(1,0,0)),this.add(o);let n=new ir(Hl,jl,e,t);n.layers=this.layers,n.up.set(0,-1,0),n.lookAt(new w(-1,0,0)),this.add(n);let s=new ir(Hl,jl,e,t);s.layers=this.layers,s.up.set(0,0,1),s.lookAt(new w(0,1,0)),this.add(s);let a=new ir(Hl,jl,e,t);a.layers=this.layers,a.up.set(0,0,-1),a.lookAt(new w(0,-1,0)),this.add(a);let c=new ir(Hl,jl,e,t);c.layers=this.layers,c.up.set(0,-1,0),c.lookAt(new w(0,0,1)),this.add(c);let l=new ir(Hl,jl,e,t);l.layers=this.layers,l.up.set(0,-1,0),l.lookAt(new w(0,0,-1)),this.add(l)}update(e,t){this.parent===null&&this.updateMatrixWorld();let r=this.renderTarget,[o,n,s,a,c,l]=this.children,u=e.xr.enabled,p=e.getRenderTarget();e.xr.enabled=!1;let h=r.texture.generateMipmaps;r.texture.generateMipmaps=!1,e.setRenderTarget(r,0),e.render(t,o),e.setRenderTarget(r,1),e.render(t,n),e.setRenderTarget(r,2),e.render(t,s),e.setRenderTarget(r,3),e.render(t,a),e.setRenderTarget(r,4),e.render(t,c),r.texture.generateMipmaps=h,e.setRenderTarget(r,5),e.render(t,l),e.setRenderTarget(p),e.xr.enabled=u,r.texture.needsPMREMUpdate=!0}};var D0=class extends gr{constructor(e,t,r,o,n,s,a,c,l,u){e=e!==void 0?e:[],t=t!==void 0?t:oi;super(e,t,r,o,n,s,a,c,l,u);this.flipY=!1}get images(){return this.image}set images(e){this.image=e}};D0.prototype.isCubeTexture=!0;var zm=class extends vr{constructor(e,t,r){Number.isInteger(t)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),t=r);super(e,e,t);t=t||{},this.texture=new D0(void 0,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=t.generateMipmaps!==void 0?t.generateMipmaps:!1,this.texture.minFilter=t.minFilter!==void 0?t.minFilter:at}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.format=st,this.texture.encoding=t.encoding,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;let r={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},o=new Ti(5,5,5),n=new Ar({name:"CubemapFromEquirect",uniforms:Ys(r.uniforms),vertexShader:r.vertexShader,fragmentShader:r.fragmentShader,side:Dt,blending:ri});n.uniforms.tEquirect.value=t;let s=new lt(o,n),a=t.minFilter;return t.minFilter===Cn&&(t.minFilter=at),new s3(1,10,this).update(e,s),t.minFilter=a,s.geometry.dispose(),s.material.dispose(),this}clear(e,t,r,o){let n=e.getRenderTarget();for(let s=0;s<6;s++)e.setRenderTarget(this,s),e.clear(t,r,o);e.setRenderTarget(n)}};zm.prototype.isWebGLCubeRenderTarget=!0;function IT(i){let e=new WeakMap;function t(s,a){return a===zs?s.mapping=oi:a===Hs&&(s.mapping=vi),s}function r(s){if(s&&s.isTexture&&s.isRenderTargetTexture===!1){let a=s.mapping;if(a===zs||a===Hs)if(e.has(s)){let c=e.get(s).texture;return t(c,s.mapping)}else{let c=s.image;if(c&&c.height>0){let l=new zm(c.height/2);return l.fromEquirectangularTexture(i,s),e.set(s,l),s.addEventListener("dispose",o),t(l.texture,s.mapping)}else return null}}return s}function o(s){let a=s.target;a.removeEventListener("dispose",o);let c=e.get(a);c!==void 0&&(e.delete(a),c.dispose())}function n(){e=new WeakMap}return{get:r,dispose:n}}var ps=class extends us{constructor(e=-1,t=1,r=1,o=-1,n=.1,s=2e3){super();this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=r,this.bottom=o,this.near=n,this.far=s,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,r,o,n,s){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=o,this.view.width=n,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),r=(this.right+this.left)/2,o=(this.top+this.bottom)/2,n=r-e,s=r+e,a=o+t,c=o-t;if(this.view!==null&&this.view.enabled){let l=(this.right-this.left)/this.view.fullWidth/this.zoom,u=(this.top-this.bottom)/this.view.fullHeight/this.zoom;n+=l*this.view.offsetX,s=n+l*this.view.width,a-=u*this.view.offsetY,c=a-u*this.view.height}this.projectionMatrix.makeOrthographic(n,s,a,c,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){let t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}};ps.prototype.isOrthographicCamera=!0;var k0=class extends Ar{constructor(e){super(e);this.type="RawShaderMaterial"}};k0.prototype.isRawShaderMaterial=!0;var Xl=4,B0=8,hs=Math.pow(2,B0),GT=[.125,.215,.35,.446,.526,.582],zT=B0-Xl+1+GT.length,Wl=20,a3=new ps,{_lodPlanes:hh,_sizeLods:DT,_sigmas:Hm}=BU(),kT=new he,c3=null,rc=(1+Math.sqrt(5))/2,ql=1/rc,BT=[new w(1,1,1),new w(-1,1,1),new w(1,1,-1),new w(-1,1,-1),new w(0,rc,ql),new w(0,rc,-ql),new w(ql,0,rc),new w(-ql,0,rc),new w(rc,ql,0),new w(-rc,ql,0)],Yl=class{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._blurMaterial=FU(Wl),this._equirectShader=null,this._cubemapShader=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,r=.1,o=100){c3=this._renderer.getRenderTarget();let n=this._allocateTargets();return this._sceneToCubeUV(e,r,o,n),t>0&&this._blur(n,0,0,t),this._applyPMREM(n),this._cleanup(n),n}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapShader===null&&(this._cubemapShader=VT(),this._compileMaterial(this._cubemapShader))}compileEquirectangularShader(){this._equirectShader===null&&(this._equirectShader=UT(),this._compileMaterial(this._equirectShader))}dispose(){this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose(),this._cubemapShader!==null&&this._cubemapShader.dispose(),this._equirectShader!==null&&this._equirectShader.dispose();for(let e=0;e<hh.length;e++)hh[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(c3),e.scissorTest=!1,jm(e,0,0,e.width,e.height)}_fromTexture(e,t){c3=this._renderer.getRenderTarget();let r=t||this._allocateTargets(e);return this._textureToCubeUV(e,r),this._applyPMREM(r),this._cleanup(r),r}_allocateTargets(e){let t={magFilter:at,minFilter:at,generateMipmaps:!1,type:zr,format:st,encoding:Hr,depthBuffer:!1},r=FT(t);return r.depthBuffer=!e,this._pingPongRenderTarget===null&&(this._pingPongRenderTarget=FT(t)),r}_compileMaterial(e){let t=new lt(hh[0],e);this._renderer.compile(t,a3)}_sceneToCubeUV(e,t,r,o){let a=new ir(90,1,t,r),c=[1,-1,1,1,1,1],l=[1,1,1,-1,-1,-1],u=this._renderer,p=u.autoClear,h=u.toneMapping;u.getClearColor(kT),u.toneMapping=Oo,u.autoClear=!1;let d=new si({name:"PMREM.Background",side:Dt,depthWrite:!1,depthTest:!1}),m=new lt(new Ti,d),f=!1,x=e.background;x?x.isColor&&(d.color.copy(x),e.background=null,f=!0):(d.color.copy(kT),f=!0);for(let _=0;_<6;_++){let g=_%3;g===0?(a.up.set(0,c[_],0),a.lookAt(l[_],0,0)):g===1?(a.up.set(0,0,c[_]),a.lookAt(0,l[_],0)):(a.up.set(0,c[_],0),a.lookAt(0,0,l[_])),jm(o,g*hs,_>2?hs:0,hs,hs),u.setRenderTarget(o),f&&u.render(m,a),u.render(e,a)}m.geometry.dispose(),m.material.dispose(),u.toneMapping=h,u.autoClear=p,e.background=x}_textureToCubeUV(e,t){let r=this._renderer,o=e.mapping===oi||e.mapping===vi;o?(this._cubemapShader===null&&(this._cubemapShader=VT()),this._cubemapShader.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectShader===null&&(this._equirectShader=UT());let n=o?this._cubemapShader:this._equirectShader,s=new lt(hh[0],n),a=n.uniforms;a.envMap.value=e,o||a.texelSize.value.set(1/e.image.width,1/e.image.height),jm(t,0,0,3*hs,2*hs),r.setRenderTarget(t),r.render(s,a3)}_applyPMREM(e){let t=this._renderer,r=t.autoClear;t.autoClear=!1;for(let o=1;o<zT;o++){let n=Math.sqrt(Hm[o]*Hm[o]-Hm[o-1]*Hm[o-1]),s=BT[(o-1)%BT.length];this._blur(e,o-1,o,n,s)}t.autoClear=r}_blur(e,t,r,o,n){let s=this._pingPongRenderTarget;this._halfBlur(e,s,t,r,o,"latitudinal",n),this._halfBlur(s,e,r,r,o,"longitudinal",n)}_halfBlur(e,t,r,o,n,s,a){let c=this._renderer,l=this._blurMaterial;s!=="latitudinal"&&s!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");let u=3,p=new lt(hh[o],l),h=l.uniforms,d=DT[r]-1,m=isFinite(n)?Math.PI/(2*d):2*Math.PI/(2*Wl-1),f=n/m,x=isFinite(n)?1+Math.floor(u*f):Wl;x>Wl&&console.warn(`sigmaRadians, ${n}, is too large and will clip, as it requested ${x} samples when the maximum is set to ${Wl}`);let _=[],g=0;for(let A=0;A<Wl;++A){let E=A/f,S=Math.exp(-E*E/2);_.push(S),A===0?g+=S:A<x&&(g+=2*S)}for(let A=0;A<_.length;A++)_[A]=_[A]/g;h.envMap.value=e.texture,h.samples.value=x,h.weights.value=_,h.latitudinal.value=s==="latitudinal",a&&(h.poleAxis.value=a),h.dTheta.value=m,h.mipInt.value=B0-r;let T=DT[o],b=3*Math.max(0,hs-2*T),y=(o===0?0:2*hs)+2*T*(o>B0-Xl?o-B0+Xl:0);jm(t,b,y,3*T,2*T),c.setRenderTarget(t),c.render(p,a3)}};function BU(){let i=[],e=[],t=[],r=B0;for(let o=0;o<zT;o++){let n=Math.pow(2,r);e.push(n);let s=1/n;o>B0-Xl?s=GT[o-B0+Xl-1]:o===0&&(s=0),t.push(s);let a=1/(n-1),c=-a/2,l=1+a/2,u=[c,c,l,c,l,l,c,c,l,l,c,l],p=6,h=6,d=3,m=2,f=1,x=new Float32Array(d*h*p),_=new Float32Array(m*h*p),g=new Float32Array(f*h*p);for(let b=0;b<p;b++){let y=b%3*2/3-1,A=b>2?0:-1,E=[y,A,0,y+2/3,A,0,y+2/3,A+1,0,y,A,0,y+2/3,A+1,0,y,A+1,0];x.set(E,d*h*b),_.set(u,m*h*b);let S=[b,b,b,b,b,b];g.set(S,f*h*b)}let T=new De;T.setAttribute("position",new Ot(x,d)),T.setAttribute("uv",new Ot(_,m)),T.setAttribute("faceIndex",new Ot(g,f)),i.push(T),r>Xl&&r--}return{_lodPlanes:i,_sizeLods:e,_sigmas:t}}function FT(i){let e=new vr(3*hs,3*hs,i);return e.texture.mapping=ii,e.texture.name="PMREM.cubeUv",e.scissorTest=!0,e}function jm(i,e,t,r,o){i.viewport.set(e,t,r,o),i.scissor.set(e,t,r,o)}function FU(i){let e=new Float32Array(i),t=new w(0,1,0);return new k0({name:"SphericalGaussianBlur",defines:{n:i},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:e},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:t}},vertexShader:l3(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:ri,depthTest:!1,depthWrite:!1})}function UT(){let i=new G(1,1);return new k0({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null},texelSize:{value:i}},vertexShader:l3(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform vec2 texelSize;

			#include <common>

			void main() {

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				vec2 f = fract( uv / texelSize - 0.5 );
				uv -= f * texelSize;
				vec3 tl = texture2D ( envMap, uv ).rgb;
				uv.x += texelSize.x;
				vec3 tr = texture2D ( envMap, uv ).rgb;
				uv.y += texelSize.y;
				vec3 br = texture2D ( envMap, uv ).rgb;
				uv.x -= texelSize.x;
				vec3 bl = texture2D ( envMap, uv ).rgb;

				vec3 tm = mix( tl, tr, f.x );
				vec3 bm = mix( bl, br, f.x );
				gl_FragColor.rgb = mix( tm, bm, f.y );

			}
		`,blending:ri,depthTest:!1,depthWrite:!1})}function VT(){return new k0({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:l3(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:ri,depthTest:!1,depthWrite:!1})}function l3(){return`

		precision mediump float;
		precision mediump int;

		attribute vec3 position;
		attribute vec2 uv;
		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function HT(i){let e=new WeakMap,t=null;function r(a){if(a&&a.isTexture){let c=a.mapping,l=c===zs||c===Hs,u=c===oi||c===vi;if(l||u)if(a.isRenderTargetTexture&&a.needsPMREMUpdate===!0){a.needsPMREMUpdate=!1;let p=e.get(a);return t===null&&(t=new Yl(i)),p=l?t.fromEquirectangular(a,p):t.fromCubemap(a,p),e.set(a,p),p.texture}else{if(e.has(a))return e.get(a).texture;{let p=a.image;if(l&&p&&p.height>0||u&&p&&o(p)){t===null&&(t=new Yl(i));let h=l?t.fromEquirectangular(a):t.fromCubemap(a);return e.set(a,h),a.addEventListener("dispose",n),h.texture}else return null}}}return a}function o(a){let c=0,l=6;for(let u=0;u<l;u++)a[u]!==void 0&&c++;return c===l}function n(a){let c=a.target;c.removeEventListener("dispose",n);let l=e.get(c);l!==void 0&&(e.delete(c),l.dispose())}function s(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return{get:r,dispose:s}}function jT(i){let e={};function t(r){if(e[r]!==void 0)return e[r];let o;switch(r){case"WEBGL_depth_texture":o=i.getExtension("WEBGL_depth_texture")||i.getExtension("MOZ_WEBGL_depth_texture")||i.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":o=i.getExtension("EXT_texture_filter_anisotropic")||i.getExtension("MOZ_EXT_texture_filter_anisotropic")||i.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":o=i.getExtension("WEBGL_compressed_texture_s3tc")||i.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||i.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":o=i.getExtension("WEBGL_compressed_texture_pvrtc")||i.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:o=i.getExtension(r)}return e[r]=o,o}return{has:function(r){return t(r)!==null},init:function(r){r.isWebGL2?t("EXT_color_buffer_float"):(t("WEBGL_depth_texture"),t("OES_texture_float"),t("OES_texture_half_float"),t("OES_texture_half_float_linear"),t("OES_standard_derivatives"),t("OES_element_index_uint"),t("OES_vertex_array_object"),t("ANGLE_instanced_arrays")),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture")},get:function(r){let o=t(r);return o===null&&console.warn("THREE.WebGLRenderer: "+r+" extension not supported."),o}}}function WT(i,e,t,r){let o={},n=new WeakMap;function s(p){let h=p.target;h.index!==null&&e.remove(h.index);for(let m in h.attributes)e.remove(h.attributes[m]);h.removeEventListener("dispose",s),delete o[h.id];let d=n.get(h);d&&(e.remove(d),n.delete(h)),r.releaseStatesOfGeometry(h),h.isInstancedBufferGeometry===!0&&delete h._maxInstanceCount,t.memory.geometries--}function a(p,h){return o[h.id]===!0||(h.addEventListener("dispose",s),o[h.id]=!0,t.memory.geometries++),h}function c(p){let h=p.attributes;for(let m in h)e.update(h[m],i.ARRAY_BUFFER);let d=p.morphAttributes;for(let m in d){let f=d[m];for(let x=0,_=f.length;x<_;x++)e.update(f[x],i.ARRAY_BUFFER)}}function l(p){let h=[],d=p.index,m=p.attributes.position,f=0;if(d!==null){let g=d.array;f=d.version;for(let T=0,b=g.length;T<b;T+=3){let y=g[T+0],A=g[T+1],E=g[T+2];h.push(y,A,A,E,E,y)}}else{let g=m.array;f=m.version;for(let T=0,b=g.length/3-1;T<b;T+=3){let y=T+0,A=T+1,E=T+2;h.push(y,A,A,E,E,y)}}let x=new(Jx(h)?Kx:Yx)(h,1);x.version=f;let _=n.get(p);_&&e.remove(_),n.set(p,x)}function u(p){let h=n.get(p);if(h){let d=p.index;d!==null&&h.version<d.version&&l(p)}else l(p);return n.get(p)}return{get:a,update:c,getWireframeAttribute:u}}function qT(i,e,t,r){let o=r.isWebGL2,n;function s(h){n=h}let a,c;function l(h){a=h.type,c=h.bytesPerElement}function u(h,d){i.drawElements(n,d,a,h*c),t.update(d,n,1)}function p(h,d,m){if(m===0)return;let f,x;if(o)f=i,x="drawElementsInstanced";else if(f=e.get("ANGLE_instanced_arrays"),x="drawElementsInstancedANGLE",f===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}f[x](n,d,a,h*c,m),t.update(d,n,m)}this.setMode=s,this.setIndex=l,this.render=u,this.renderInstances=p}function XT(i){let e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function r(n,s,a){switch(t.calls++,s){case i.TRIANGLES:t.triangles+=a*(n/3);break;case i.LINES:t.lines+=a*(n/2);break;case i.LINE_STRIP:t.lines+=a*(n-1);break;case i.LINE_LOOP:t.lines+=a*n;break;case i.POINTS:t.points+=a*n;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",s);break}}function o(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:e,render:t,programs:null,autoReset:!0,reset:o,update:r}}var $l=class extends gr{constructor(e=null,t=1,r=1,o=1){super(null);this.image={data:e,width:t,height:r,depth:o},this.magFilter=nt,this.minFilter=nt,this.wrapR=kt,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}};$l.prototype.isDataTexture2DArray=!0;function UU(i,e){return i[0]-e[0]}function VU(i,e){return Math.abs(e[1])-Math.abs(i[1])}function YT(i,e){let t=1,r=e.isInterleavedBufferAttribute?e.data.array:e.array;r instanceof Int8Array?t=127:r instanceof Int16Array?t=32767:r instanceof Int32Array?t=2147483647:console.error("THREE.WebGLMorphtargets: Unsupported morph attribute data type: ",r),i.divideScalar(t)}function $T(i,e,t){let r={},o=new Float32Array(8),n=new WeakMap,s=new w,a=[];for(let l=0;l<8;l++)a[l]=[l,0];function c(l,u,p,h){let d=l.morphTargetInfluences;if(e.isWebGL2===!0){let m=u.morphAttributes.position.length,f=n.get(u);if(f===void 0||f.count!==m){let N=function(){L.dispose(),n.delete(u),u.removeEventListener("dispose",N)};f!==void 0&&f.texture.dispose();let g=u.morphAttributes.normal!==void 0,T=u.morphAttributes.position,b=u.morphAttributes.normal||[],y=u.attributes.position.count,A=g===!0?2:1,E=y*A,S=1;E>e.maxTextureSize&&(S=Math.ceil(E/e.maxTextureSize),E=e.maxTextureSize);let M=new Float32Array(E*S*4*m),L=new $l(M,E,S,m);L.format=st,L.type=Wt,L.needsUpdate=!0;let C=A*4;for(let D=0;D<m;D++){let k=T[D],z=b[D],F=E*S*4*D;for(let X=0;X<k.count;X++){s.fromBufferAttribute(k,X),k.normalized===!0&&YT(s,k);let $=X*C;M[F+$+0]=s.x,M[F+$+1]=s.y,M[F+$+2]=s.z,M[F+$+3]=0,g===!0&&(s.fromBufferAttribute(z,X),z.normalized===!0&&YT(s,z),M[F+$+4]=s.x,M[F+$+5]=s.y,M[F+$+6]=s.z,M[F+$+7]=0)}}f={count:m,texture:L,size:new G(E,S)},n.set(u,f),u.addEventListener("dispose",N)}let x=0;for(let g=0;g<d.length;g++)x+=d[g];let _=u.morphTargetsRelative?1:1-x;h.getUniforms().setValue(i,"morphTargetBaseInfluence",_),h.getUniforms().setValue(i,"morphTargetInfluences",d),h.getUniforms().setValue(i,"morphTargetsTexture",f.texture,t),h.getUniforms().setValue(i,"morphTargetsTextureSize",f.size)}else{let m=d===void 0?0:d.length,f=r[u.id];if(f===void 0||f.length!==m){f=[];for(let b=0;b<m;b++)f[b]=[b,0];r[u.id]=f}for(let b=0;b<m;b++){let y=f[b];y[0]=b,y[1]=d[b]}f.sort(VU);for(let b=0;b<8;b++)b<m&&f[b][1]?(a[b][0]=f[b][0],a[b][1]=f[b][1]):(a[b][0]=Number.MAX_SAFE_INTEGER,a[b][1]=0);a.sort(UU);let x=u.morphAttributes.position,_=u.morphAttributes.normal,g=0;for(let b=0;b<8;b++){let y=a[b],A=y[0],E=y[1];A!==Number.MAX_SAFE_INTEGER&&E?(x&&u.getAttribute("morphTarget"+b)!==x[A]&&u.setAttribute("morphTarget"+b,x[A]),_&&u.getAttribute("morphNormal"+b)!==_[A]&&u.setAttribute("morphNormal"+b,_[A]),o[b]=E,g+=E):(x&&u.hasAttribute("morphTarget"+b)===!0&&u.deleteAttribute("morphTarget"+b),_&&u.hasAttribute("morphNormal"+b)===!0&&u.deleteAttribute("morphNormal"+b),o[b]=0)}let T=u.morphTargetsRelative?1:1-g;h.getUniforms().setValue(i,"morphTargetBaseInfluence",T),h.getUniforms().setValue(i,"morphTargetInfluences",o)}}return{update:c}}var F0=class extends vr{constructor(e,t,r={}){super(e,t,r);this.samples=4,this.ignoreDepthForMultisampleCopy=r.ignoreDepth!==void 0?r.ignoreDepth:!0,this.useRenderToTexture=r.useRenderToTexture!==void 0?r.useRenderToTexture:!1,this.useRenderbuffer=this.useRenderToTexture===!1}copy(e){return super.copy.call(this,e),this.samples=e.samples,this.useRenderToTexture=e.useRenderToTexture,this.useRenderbuffer=e.useRenderbuffer,this}};F0.prototype.isWebGLMultisampleRenderTarget=!0;function KT(i,e,t,r){let o=new WeakMap;function n(c){let l=r.render.frame,u=c.geometry,p=e.get(c,u);return o.get(p)!==l&&(e.update(p),o.set(p,l)),c.isInstancedMesh&&(c.hasEventListener("dispose",a)===!1&&c.addEventListener("dispose",a),t.update(c.instanceMatrix,i.ARRAY_BUFFER),c.instanceColor!==null&&t.update(c.instanceColor,i.ARRAY_BUFFER)),p}function s(){o=new WeakMap}function a(c){let l=c.target;l.removeEventListener("dispose",a),t.remove(l.instanceMatrix),l.instanceColor!==null&&t.remove(l.instanceColor)}return{update:n,dispose:s}}var Wm=class extends gr{constructor(e=null,t=1,r=1,o=1){super(null);this.image={data:e,width:t,height:r,depth:o},this.magFilter=nt,this.minFilter=nt,this.wrapR=kt,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}};Wm.prototype.isDataTexture3D=!0;var oA=new gr,iA=new $l,nA=new Wm,sA=new D0,JT=[],ZT=[],QT=new Float32Array(16),eA=new Float32Array(9),tA=new Float32Array(4);function Kl(i,e,t){let r=i[0];if(r<=0||r>0)return i;let o=e*t,n=JT[o];if(n===void 0&&(n=new Float32Array(o),JT[o]=n),e!==0){r.toArray(n,0);for(let s=1,a=0;s!==e;++s)a+=t,i[s].toArray(n,a)}return n}function jo(i,e){if(i.length!==e.length)return!1;for(let t=0,r=i.length;t<r;t++)if(i[t]!==e[t])return!1;return!0}function Po(i,e){for(let t=0,r=e.length;t<r;t++)i[t]=e[t]}function qm(i,e){let t=ZT[e];t===void 0&&(t=new Int32Array(e),ZT[e]=t);for(let r=0;r!==e;++r)t[r]=i.allocateTextureUnit();return t}function GU(i,e){let t=this.cache;t[0]!==e&&(i.uniform1f(this.addr,e),t[0]=e)}function zU(i,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(jo(t,e))return;i.uniform2fv(this.addr,e),Po(t,e)}}function HU(i,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(i.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(jo(t,e))return;i.uniform3fv(this.addr,e),Po(t,e)}}function jU(i,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(jo(t,e))return;i.uniform4fv(this.addr,e),Po(t,e)}}function WU(i,e){let t=this.cache,r=e.elements;if(r===void 0){if(jo(t,e))return;i.uniformMatrix2fv(this.addr,!1,e),Po(t,e)}else{if(jo(t,r))return;tA.set(r),i.uniformMatrix2fv(this.addr,!1,tA),Po(t,r)}}function qU(i,e){let t=this.cache,r=e.elements;if(r===void 0){if(jo(t,e))return;i.uniformMatrix3fv(this.addr,!1,e),Po(t,e)}else{if(jo(t,r))return;eA.set(r),i.uniformMatrix3fv(this.addr,!1,eA),Po(t,r)}}function XU(i,e){let t=this.cache,r=e.elements;if(r===void 0){if(jo(t,e))return;i.uniformMatrix4fv(this.addr,!1,e),Po(t,e)}else{if(jo(t,r))return;QT.set(r),i.uniformMatrix4fv(this.addr,!1,QT),Po(t,r)}}function YU(i,e){let t=this.cache;t[0]!==e&&(i.uniform1i(this.addr,e),t[0]=e)}function $U(i,e){let t=this.cache;jo(t,e)||(i.uniform2iv(this.addr,e),Po(t,e))}function KU(i,e){let t=this.cache;jo(t,e)||(i.uniform3iv(this.addr,e),Po(t,e))}function JU(i,e){let t=this.cache;jo(t,e)||(i.uniform4iv(this.addr,e),Po(t,e))}function ZU(i,e){let t=this.cache;t[0]!==e&&(i.uniform1ui(this.addr,e),t[0]=e)}function QU(i,e){let t=this.cache;jo(t,e)||(i.uniform2uiv(this.addr,e),Po(t,e))}function eV(i,e){let t=this.cache;jo(t,e)||(i.uniform3uiv(this.addr,e),Po(t,e))}function tV(i,e){let t=this.cache;jo(t,e)||(i.uniform4uiv(this.addr,e),Po(t,e))}function rV(i,e,t){let r=this.cache,o=t.allocateTextureUnit();r[0]!==o&&(i.uniform1i(this.addr,o),r[0]=o),t.safeSetTexture2D(e||oA,o)}function oV(i,e,t){let r=this.cache,o=t.allocateTextureUnit();r[0]!==o&&(i.uniform1i(this.addr,o),r[0]=o),t.setTexture3D(e||nA,o)}function iV(i,e,t){let r=this.cache,o=t.allocateTextureUnit();r[0]!==o&&(i.uniform1i(this.addr,o),r[0]=o),t.safeSetTextureCube(e||sA,o)}function nV(i,e,t){let r=this.cache,o=t.allocateTextureUnit();r[0]!==o&&(i.uniform1i(this.addr,o),r[0]=o),t.setTexture2DArray(e||iA,o)}function sV(i){switch(i){case 5126:return GU;case 35664:return zU;case 35665:return HU;case 35666:return jU;case 35674:return WU;case 35675:return qU;case 35676:return XU;case 5124:case 35670:return YU;case 35667:case 35671:return $U;case 35668:case 35672:return KU;case 35669:case 35673:return JU;case 5125:return ZU;case 36294:return QU;case 36295:return eV;case 36296:return tV;case 35678:case 36198:case 36298:case 36306:case 35682:return rV;case 35679:case 36299:case 36307:return oV;case 35680:case 36300:case 36308:case 36293:return iV;case 36289:case 36303:case 36311:case 36292:return nV}}function aV(i,e){i.uniform1fv(this.addr,e)}function cV(i,e){let t=Kl(e,this.size,2);i.uniform2fv(this.addr,t)}function lV(i,e){let t=Kl(e,this.size,3);i.uniform3fv(this.addr,t)}function uV(i,e){let t=Kl(e,this.size,4);i.uniform4fv(this.addr,t)}function pV(i,e){let t=Kl(e,this.size,4);i.uniformMatrix2fv(this.addr,!1,t)}function hV(i,e){let t=Kl(e,this.size,9);i.uniformMatrix3fv(this.addr,!1,t)}function dV(i,e){let t=Kl(e,this.size,16);i.uniformMatrix4fv(this.addr,!1,t)}function fV(i,e){i.uniform1iv(this.addr,e)}function mV(i,e){i.uniform2iv(this.addr,e)}function _V(i,e){i.uniform3iv(this.addr,e)}function gV(i,e){i.uniform4iv(this.addr,e)}function vV(i,e){i.uniform1uiv(this.addr,e)}function xV(i,e){i.uniform2uiv(this.addr,e)}function yV(i,e){i.uniform3uiv(this.addr,e)}function bV(i,e){i.uniform4uiv(this.addr,e)}function TV(i,e,t){let r=e.length,o=qm(t,r);i.uniform1iv(this.addr,o);for(let n=0;n!==r;++n)t.safeSetTexture2D(e[n]||oA,o[n])}function AV(i,e,t){let r=e.length,o=qm(t,r);i.uniform1iv(this.addr,o);for(let n=0;n!==r;++n)t.setTexture3D(e[n]||nA,o[n])}function CV(i,e,t){let r=e.length,o=qm(t,r);i.uniform1iv(this.addr,o);for(let n=0;n!==r;++n)t.safeSetTextureCube(e[n]||sA,o[n])}function EV(i,e,t){let r=e.length,o=qm(t,r);i.uniform1iv(this.addr,o);for(let n=0;n!==r;++n)t.setTexture2DArray(e[n]||iA,o[n])}function SV(i){switch(i){case 5126:return aV;case 35664:return cV;case 35665:return lV;case 35666:return uV;case 35674:return pV;case 35675:return hV;case 35676:return dV;case 5124:case 35670:return fV;case 35667:case 35671:return mV;case 35668:case 35672:return _V;case 35669:case 35673:return gV;case 5125:return vV;case 36294:return xV;case 36295:return yV;case 36296:return bV;case 35678:case 36198:case 36298:case 36306:case 35682:return TV;case 35679:case 36299:case 36307:return AV;case 35680:case 36300:case 36308:case 36293:return CV;case 36289:case 36303:case 36311:case 36292:return EV}}function wV(i,e,t){this.id=i,this.addr=t,this.cache=[],this.setValue=sV(e.type)}function aA(i,e,t){this.id=i,this.addr=t,this.cache=[],this.size=e.size,this.setValue=SV(e.type)}aA.prototype.updateCache=function(i){let e=this.cache;i instanceof Float32Array&&e.length!==i.length&&(this.cache=new Float32Array(i.length)),Po(e,i)};function cA(i){this.id=i,this.seq=[],this.map={}}cA.prototype.setValue=function(i,e,t){let r=this.seq;for(let o=0,n=r.length;o!==n;++o){let s=r[o];s.setValue(i,e[s.id],t)}};var u3=/(\w+)(\])?(\[|\.)?/g;function rA(i,e){i.seq.push(e),i.map[e.id]=e}function MV(i,e,t){let r=i.name,o=r.length;for(u3.lastIndex=0;;){let n=u3.exec(r),s=u3.lastIndex,a=n[1],c=n[2]==="]",l=n[3];if(c&&(a=a|0),l===void 0||l==="["&&s+2===o){rA(t,l===void 0?new wV(a,i,e):new aA(a,i,e));break}else{let p=t.map[a];p===void 0&&(p=new cA(a),rA(t,p)),t=p}}}function ds(i,e){this.seq=[],this.map={};let t=i.getProgramParameter(e,i.ACTIVE_UNIFORMS);for(let r=0;r<t;++r){let o=i.getActiveUniform(e,r),n=i.getUniformLocation(e,o.name);MV(o,n,this)}}ds.prototype.setValue=function(i,e,t,r){let o=this.map[e];o!==void 0&&o.setValue(i,t,r)};ds.prototype.setOptional=function(i,e,t){let r=e[t];r!==void 0&&this.setValue(i,t,r)};ds.upload=function(i,e,t,r){for(let o=0,n=e.length;o!==n;++o){let s=e[o],a=t[s.id];a.needsUpdate!==!1&&s.setValue(i,a.value,r)}};ds.seqWithValue=function(i,e){let t=[];for(let r=0,o=i.length;r!==o;++r){let n=i[r];n.id in e&&t.push(n)}return t};function p3(i,e,t){let r=i.createShader(e);return i.shaderSource(r,t),i.compileShader(r),r}var NV=0;function OV(i){let e=i.split(`
`);for(let t=0;t<e.length;t++)e[t]=t+1+": "+e[t];return e.join(`
`)}function PV(i){switch(i){case Hr:return["Linear","( value )"];case bt:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",i),["Linear","( value )"]}}function lA(i,e,t){let r=i.getShaderParameter(e,i.COMPILE_STATUS),o=i.getShaderInfoLog(e).trim();return r&&o===""?"":t.toUpperCase()+`

`+o+`

`+OV(i.getShaderSource(e))}function RV(i,e){let t=PV(e);return"vec4 "+i+"( vec4 value ) { return LinearTo"+t[0]+t[1]+"; }"}function LV(i,e){let t;switch(e){case hm:t="Linear";break;case dm:t="Reinhard";break;case fm:t="OptimizedCineon";break;case mm:t="ACESFilmic";break;case Dx:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+i+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function IV(i){return[i.extensionDerivatives||i.envMapCubeUV||i.bumpMap||i.tangentSpaceNormalMap||i.clearcoatNormalMap||i.flatShading||i.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(i.extensionFragDepth||i.logarithmicDepthBuffer)&&i.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",i.extensionDrawBuffers&&i.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(i.extensionShaderTextureLOD||i.envMap||i.transmission)&&i.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(dh).join(`
`)}function DV(i){let e=[];for(let t in i){let r=i[t];r!==!1&&e.push("#define "+t+" "+r)}return e.join(`
`)}function kV(i,e){let t={},r=i.getProgramParameter(e,i.ACTIVE_ATTRIBUTES);for(let o=0;o<r;o++){let n=i.getActiveAttrib(e,o),s=n.name,a=1;n.type===i.FLOAT_MAT2&&(a=2),n.type===i.FLOAT_MAT3&&(a=3),n.type===i.FLOAT_MAT4&&(a=4),t[s]={type:n.type,location:i.getAttribLocation(e,s),locationSize:a}}return t}function dh(i){return i!==""}function uA(i,e){return i.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function pA(i,e){return i.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}var BV=/^[ \t]*#include +<([\w\d./]+)>/gm;function h3(i){return i.replace(BV,FV)}function FV(i,e){let t=dt[e];if(t===void 0)throw new Error("Can not resolve #include <"+e+">");return h3(t)}var UV=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,VV=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function hA(i){return i.replace(VV,fA).replace(UV,GV)}function GV(i,e,t,r){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),fA(i,e,t,r)}function fA(i,e,t,r){let o="";for(let n=parseInt(e);n<parseInt(t);n++)o+=r.replace(/\[\s*i\s*\]/g,"[ "+n+" ]").replace(/UNROLLED_LOOP_INDEX/g,n);return o}function dA(i){let e="precision "+i.precision+` float;
precision `+i.precision+" int;";return i.precision==="highp"?e+=`
#define HIGH_PRECISION`:i.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:i.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function zV(i){let e="SHADOWMAP_TYPE_BASIC";return i.shadowMapType===Pl?e="SHADOWMAP_TYPE_PCF":i.shadowMapType===lm?e="SHADOWMAP_TYPE_PCF_SOFT":i.shadowMapType===Gs&&(e="SHADOWMAP_TYPE_VSM"),e}function HV(i){let e="ENVMAP_TYPE_CUBE";if(i.envMap)switch(i.envMapMode){case oi:case vi:e="ENVMAP_TYPE_CUBE";break;case ii:case An:e="ENVMAP_TYPE_CUBE_UV";break}return e}function jV(i){let e="ENVMAP_MODE_REFLECTION";if(i.envMap)switch(i.envMapMode){case vi:case An:e="ENVMAP_MODE_REFRACTION";break}return e}function WV(i){let e="ENVMAP_BLENDING_NONE";if(i.envMap)switch(i.combine){case Ll:e="ENVMAP_BLENDING_MULTIPLY";break;case um:e="ENVMAP_BLENDING_MIX";break;case pm:e="ENVMAP_BLENDING_ADD";break}return e}function mA(i,e,t,r){let o=i.getContext(),n=t.defines,s=t.vertexShader,a=t.fragmentShader,c=zV(t),l=HV(t),u=jV(t),p=WV(t),h=t.isWebGL2?"":IV(t),d=DV(n),m=o.createProgram(),f,x,_=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(f=[d].filter(dh).join(`
`),f.length>0&&(f+=`
`),x=[h,d].filter(dh).join(`
`),x.length>0&&(x+=`
`)):(f=[dA(t),"#define SHADER_NAME "+t.shaderName,d,t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define MAX_BONES "+t.maxBones,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+u:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.displacementMap&&t.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",t.specularColorMap?"#define USE_SPECULARCOLORMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEENCOLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.useVertexTexture?"#define BONE_TEXTURE":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphTargets&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",t.morphTargets&&t.isWebGL2?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+c:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(dh).join(`
`),x=[h,dA(t),"#define SHADER_NAME "+t.shaderName,d,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+l:"",t.envMap?"#define "+u:"",t.envMap?"#define "+p:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",t.specularColorMap?"#define USE_SPECULARCOLORMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEENCOLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+c:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(t.extensionShaderTextureLOD||t.envMap)&&t.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==Oo?"#define TONE_MAPPING":"",t.toneMapping!==Oo?dt.tonemapping_pars_fragment:"",t.toneMapping!==Oo?LV("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.transparent?"":"#define OPAQUE",dt.encodings_pars_fragment,RV("linearToOutputTexel",t.outputEncoding),t.depthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(dh).join(`
`)),s=h3(s),s=uA(s,t),s=pA(s,t),a=h3(a),a=uA(a,t),a=pA(a,t),s=hA(s),a=hA(a),t.isWebGL2&&t.isRawShaderMaterial!==!0&&(_=`#version 300 es
`,f=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+f,x=["#define varying in",t.glslVersion===r3?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===r3?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+x);let g=_+f+s,T=_+x+a,b=p3(o,o.VERTEX_SHADER,g),y=p3(o,o.FRAGMENT_SHADER,T);if(o.attachShader(m,b),o.attachShader(m,y),t.index0AttributeName!==void 0?o.bindAttribLocation(m,0,t.index0AttributeName):t.morphTargets===!0&&o.bindAttribLocation(m,0,"position"),o.linkProgram(m),i.debug.checkShaderErrors){let S=o.getProgramInfoLog(m).trim(),M=o.getShaderInfoLog(b).trim(),L=o.getShaderInfoLog(y).trim(),C=!0,N=!0;if(o.getProgramParameter(m,o.LINK_STATUS)===!1){C=!1;let D=lA(o,b,"vertex"),k=lA(o,y,"fragment");console.error("THREE.WebGLProgram: Shader Error "+o.getError()+" - VALIDATE_STATUS "+o.getProgramParameter(m,o.VALIDATE_STATUS)+`

Program Info Log: `+S+`
`+D+`
`+k)}else S!==""?console.warn("THREE.WebGLProgram: Program Info Log:",S):(M===""||L==="")&&(N=!1);N&&(this.diagnostics={runnable:C,programLog:S,vertexShader:{log:M,prefix:f},fragmentShader:{log:L,prefix:x}})}o.deleteShader(b),o.deleteShader(y);let A;this.getUniforms=function(){return A===void 0&&(A=new ds(o,m)),A};let E;return this.getAttributes=function(){return E===void 0&&(E=kV(o,m)),E},this.destroy=function(){r.releaseStatesOfProgram(this),o.deleteProgram(m),this.program=void 0},this.name=t.shaderName,this.id=NV++,this.cacheKey=e,this.usedTimes=1,this.program=m,this.vertexShader=b,this.fragmentShader=y,this}var qV=0,d3=class{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){let t=e.vertexShader,r=e.fragmentShader,o=this._getShaderStage(t),n=this._getShaderStage(r),s=this._getShaderCacheForMaterial(e);return s.has(o)===!1&&(s.add(o),o.usedTimes++),s.has(n)===!1&&(s.add(n),n.usedTimes++),this}remove(e){let t=this.materialCache.get(e);for(let r of t)r.usedTimes--,r.usedTimes===0&&this.shaderCache.delete(r);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){let t=this.materialCache;return t.has(e)===!1&&t.set(e,new Set),t.get(e)}_getShaderStage(e){let t=this.shaderCache;if(t.has(e)===!1){let r=new _A;t.set(e,r)}return t.get(e)}},_A=class{constructor(){this.id=qV++,this.usedTimes=0}};function gA(i,e,t,r,o,n,s){let a=new km,c=new d3,l=[],u=o.isWebGL2,p=o.logarithmicDepthBuffer,h=o.floatVertexTextures,d=o.maxVertexUniforms,m=o.vertexTextures,f=o.precision,x={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function _(C){let D=C.skeleton.bones;if(h)return 1024;{let z=Math.floor((d-20)/4),F=Math.min(z,D.length);return F<D.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+D.length+" bones. This GPU supports "+F+"."),0):F}}function g(C,N,D,k,z){let F=k.fog,X=C.isMeshStandardMaterial?k.environment:null,$=(C.isMeshStandardMaterial?t:e).get(C.envMap||X),Y=x[C.type],H=z.isSkinnedMesh?_(z):0;C.precision!==null&&(f=o.getMaxPrecision(C.precision),f!==C.precision&&console.warn("THREE.WebGLProgram.getParameters:",C.precision,"not supported, using",f,"instead."));let B,te,q,j;if(Y){let Ae=Yi[Y];B=Ae.vertexShader,te=Ae.fragmentShader}else B=C.vertexShader,te=C.fragmentShader,c.update(C),q=c.getVertexShaderID(C),j=c.getFragmentShaderID(C);let R=i.getRenderTarget(),Ne=C.alphaTest>0,xe=C.clearcoat>0;return{isWebGL2:u,shaderID:Y,shaderName:C.type,vertexShader:B,fragmentShader:te,defines:C.defines,customVertexShaderID:q,customFragmentShaderID:j,isRawShaderMaterial:C.isRawShaderMaterial===!0,glslVersion:C.glslVersion,precision:f,instancing:z.isInstancedMesh===!0,instancingColor:z.isInstancedMesh===!0&&z.instanceColor!==null,supportsVertexTextures:m,outputEncoding:R===null?i.outputEncoding:R.isXRRenderTarget===!0?R.texture.encoding:Hr,map:!!C.map,matcap:!!C.matcap,envMap:!!$,envMapMode:$&&$.mapping,envMapCubeUV:!!$&&($.mapping===ii||$.mapping===An),lightMap:!!C.lightMap,aoMap:!!C.aoMap,emissiveMap:!!C.emissiveMap,bumpMap:!!C.bumpMap,normalMap:!!C.normalMap,objectSpaceNormalMap:C.normalMapType===Dm,tangentSpaceNormalMap:C.normalMapType===ni,decodeVideoTexture:!!C.map&&C.map.isVideoTexture===!0&&C.map.encoding===bt,clearcoat:xe,clearcoatMap:xe&&!!C.clearcoatMap,clearcoatRoughnessMap:xe&&!!C.clearcoatRoughnessMap,clearcoatNormalMap:xe&&!!C.clearcoatNormalMap,displacementMap:!!C.displacementMap,roughnessMap:!!C.roughnessMap,metalnessMap:!!C.metalnessMap,specularMap:!!C.specularMap,specularIntensityMap:!!C.specularIntensityMap,specularColorMap:!!C.specularColorMap,transparent:C.transparent,alphaMap:!!C.alphaMap,alphaTest:Ne,gradientMap:!!C.gradientMap,sheen:C.sheen>0,sheenColorMap:!!C.sheenColorMap,sheenRoughnessMap:!!C.sheenRoughnessMap,transmission:C.transmission>0,transmissionMap:!!C.transmissionMap,thicknessMap:!!C.thicknessMap,combine:C.combine,vertexTangents:!!C.normalMap&&!!z.geometry&&!!z.geometry.attributes.tangent,vertexColors:C.vertexColors,vertexAlphas:C.vertexColors===!0&&!!z.geometry&&!!z.geometry.attributes.color&&z.geometry.attributes.color.itemSize===4,vertexUvs:!!C.map||!!C.bumpMap||!!C.normalMap||!!C.specularMap||!!C.alphaMap||!!C.emissiveMap||!!C.roughnessMap||!!C.metalnessMap||!!C.clearcoatMap||!!C.clearcoatRoughnessMap||!!C.clearcoatNormalMap||!!C.displacementMap||!!C.transmissionMap||!!C.thicknessMap||!!C.specularIntensityMap||!!C.specularColorMap||!!C.sheenColorMap||!!C.sheenRoughnessMap,uvsVertexOnly:!(!!C.map||!!C.bumpMap||!!C.normalMap||!!C.specularMap||!!C.alphaMap||!!C.emissiveMap||!!C.roughnessMap||!!C.metalnessMap||!!C.clearcoatNormalMap||C.transmission>0||!!C.transmissionMap||!!C.thicknessMap||!!C.specularIntensityMap||!!C.specularColorMap||C.sheen>0||!!C.sheenColorMap||!!C.sheenRoughnessMap)&&!!C.displacementMap,fog:!!F,useFog:C.fog,fogExp2:F&&F.isFogExp2,flatShading:!!C.flatShading,sizeAttenuation:C.sizeAttenuation,logarithmicDepthBuffer:p,skinning:z.isSkinnedMesh===!0&&H>0,maxBones:H,useVertexTexture:h,morphTargets:!!z.geometry&&!!z.geometry.morphAttributes.position,morphNormals:!!z.geometry&&!!z.geometry.morphAttributes.normal,morphTargetsCount:!!z.geometry&&!!z.geometry.morphAttributes.position?z.geometry.morphAttributes.position.length:0,numDirLights:N.directional.length,numPointLights:N.point.length,numSpotLights:N.spot.length,numRectAreaLights:N.rectArea.length,numHemiLights:N.hemi.length,numDirLightShadows:N.directionalShadowMap.length,numPointLightShadows:N.pointShadowMap.length,numSpotLightShadows:N.spotShadowMap.length,numClippingPlanes:s.numPlanes,numClipIntersection:s.numIntersection,dithering:C.dithering,shadowMapEnabled:i.shadowMap.enabled&&D.length>0,shadowMapType:i.shadowMap.type,toneMapping:C.toneMapped?i.toneMapping:Oo,physicallyCorrectLights:i.physicallyCorrectLights,premultipliedAlpha:C.premultipliedAlpha,doubleSided:C.side===uo,flipSided:C.side===Dt,depthPacking:C.depthPacking!==void 0?C.depthPacking:!1,index0AttributeName:C.index0AttributeName,extensionDerivatives:C.extensions&&C.extensions.derivatives,extensionFragDepth:C.extensions&&C.extensions.fragDepth,extensionDrawBuffers:C.extensions&&C.extensions.drawBuffers,extensionShaderTextureLOD:C.extensions&&C.extensions.shaderTextureLOD,rendererExtensionFragDepth:u||r.has("EXT_frag_depth"),rendererExtensionDrawBuffers:u||r.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:u||r.has("EXT_shader_texture_lod"),customProgramCacheKey:C.customProgramCacheKey()}}function T(C){let N=[];if(C.shaderID?N.push(C.shaderID):(N.push(C.customVertexShaderID),N.push(C.customFragmentShaderID)),C.defines!==void 0)for(let D in C.defines)N.push(D),N.push(C.defines[D]);return C.isRawShaderMaterial===!1&&(b(N,C),y(N,C),N.push(i.outputEncoding)),N.push(C.customProgramCacheKey),N.join()}function b(C,N){C.push(N.precision),C.push(N.outputEncoding),C.push(N.envMapMode),C.push(N.combine),C.push(N.vertexUvs),C.push(N.fogExp2),C.push(N.sizeAttenuation),C.push(N.maxBones),C.push(N.morphTargetsCount),C.push(N.numDirLights),C.push(N.numPointLights),C.push(N.numSpotLights),C.push(N.numHemiLights),C.push(N.numRectAreaLights),C.push(N.numDirLightShadows),C.push(N.numPointLightShadows),C.push(N.numSpotLightShadows),C.push(N.shadowMapType),C.push(N.toneMapping),C.push(N.numClippingPlanes),C.push(N.numClipIntersection)}function y(C,N){a.disableAll(),N.isWebGL2&&a.enable(0),N.supportsVertexTextures&&a.enable(1),N.instancing&&a.enable(2),N.instancingColor&&a.enable(3),N.map&&a.enable(4),N.matcap&&a.enable(5),N.envMap&&a.enable(6),N.envMapCubeUV&&a.enable(7),N.lightMap&&a.enable(8),N.aoMap&&a.enable(9),N.emissiveMap&&a.enable(10),N.bumpMap&&a.enable(11),N.normalMap&&a.enable(12),N.objectSpaceNormalMap&&a.enable(13),N.tangentSpaceNormalMap&&a.enable(14),N.clearcoat&&a.enable(15),N.clearcoatMap&&a.enable(16),N.clearcoatRoughnessMap&&a.enable(17),N.clearcoatNormalMap&&a.enable(18),N.displacementMap&&a.enable(19),N.specularMap&&a.enable(20),N.roughnessMap&&a.enable(21),N.metalnessMap&&a.enable(22),N.gradientMap&&a.enable(23),N.alphaMap&&a.enable(24),N.alphaTest&&a.enable(25),N.vertexColors&&a.enable(26),N.vertexAlphas&&a.enable(27),N.vertexUvs&&a.enable(28),N.vertexTangents&&a.enable(29),N.uvsVertexOnly&&a.enable(30),N.fog&&a.enable(31),C.push(a.mask),a.disableAll(),N.useFog&&a.enable(0),N.flatShading&&a.enable(1),N.logarithmicDepthBuffer&&a.enable(2),N.skinning&&a.enable(3),N.useVertexTexture&&a.enable(4),N.morphTargets&&a.enable(5),N.morphNormals&&a.enable(6),N.premultipliedAlpha&&a.enable(7),N.shadowMapEnabled&&a.enable(8),N.physicallyCorrectLights&&a.enable(9),N.doubleSided&&a.enable(10),N.flipSided&&a.enable(11),N.depthPacking&&a.enable(12),N.dithering&&a.enable(13),N.specularIntensityMap&&a.enable(14),N.specularColorMap&&a.enable(15),N.transmission&&a.enable(16),N.transmissionMap&&a.enable(17),N.thicknessMap&&a.enable(18),N.sheen&&a.enable(19),N.sheenColorMap&&a.enable(20),N.sheenRoughnessMap&&a.enable(21),N.decodeVideoTexture&&a.enable(22),N.transparent&&a.enable(23),C.push(a.mask)}function A(C){let N=x[C.type],D;if(N){let k=Yi[N];D=Vm.clone(k.uniforms)}else D=C.uniforms;return D}function E(C,N){let D;for(let k=0,z=l.length;k<z;k++){let F=l[k];if(F.cacheKey===N){D=F,++D.usedTimes;break}}return D===void 0&&(D=new mA(i,N,C,n),l.push(D)),D}function S(C){if(--C.usedTimes===0){let N=l.indexOf(C);l[N]=l[l.length-1],l.pop(),C.destroy()}}function M(C){c.remove(C)}function L(){c.dispose()}return{getParameters:g,getProgramCacheKey:T,getUniforms:A,acquireProgram:E,releaseProgram:S,releaseShaderCache:M,programs:l,dispose:L}}function vA(){let i=new WeakMap;function e(n){let s=i.get(n);return s===void 0&&(s={},i.set(n,s)),s}function t(n){i.delete(n)}function r(n,s,a){i.get(n)[s]=a}function o(){i=new WeakMap}return{get:e,remove:t,update:r,dispose:o}}function XV(i,e){return i.groupOrder!==e.groupOrder?i.groupOrder-e.groupOrder:i.renderOrder!==e.renderOrder?i.renderOrder-e.renderOrder:i.material.id!==e.material.id?i.material.id-e.material.id:i.z!==e.z?i.z-e.z:i.id-e.id}function xA(i,e){return i.groupOrder!==e.groupOrder?i.groupOrder-e.groupOrder:i.renderOrder!==e.renderOrder?i.renderOrder-e.renderOrder:i.z!==e.z?e.z-i.z:i.id-e.id}function yA(){let i=[],e=0,t=[],r=[],o=[];function n(){e=0,t.length=0,r.length=0,o.length=0}function s(p,h,d,m,f,x){let _=i[e];return _===void 0?(_={id:p.id,object:p,geometry:h,material:d,groupOrder:m,renderOrder:p.renderOrder,z:f,group:x},i[e]=_):(_.id=p.id,_.object=p,_.geometry=h,_.material=d,_.groupOrder=m,_.renderOrder=p.renderOrder,_.z=f,_.group=x),e++,_}function a(p,h,d,m,f,x){let _=s(p,h,d,m,f,x);d.transmission>0?r.push(_):d.transparent===!0?o.push(_):t.push(_)}function c(p,h,d,m,f,x){let _=s(p,h,d,m,f,x);d.transmission>0?r.unshift(_):d.transparent===!0?o.unshift(_):t.unshift(_)}function l(p,h){t.length>1&&t.sort(p||XV),r.length>1&&r.sort(h||xA),o.length>1&&o.sort(h||xA)}function u(){for(let p=e,h=i.length;p<h;p++){let d=i[p];if(d.id===null)break;d.id=null,d.object=null,d.geometry=null,d.material=null,d.group=null}}return{opaque:t,transmissive:r,transparent:o,init:n,push:a,unshift:c,finish:u,sort:l}}function bA(){let i=new WeakMap;function e(r,o){let n;return i.has(r)===!1?(n=new yA,i.set(r,[n])):o>=i.get(r).length?(n=new yA,i.get(r).push(n)):n=i.get(r)[o],n}function t(){i=new WeakMap}return{get:e,dispose:t}}function YV(){let i={};return{get:function(e){if(i[e.id]!==void 0)return i[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new w,color:new he};break;case"SpotLight":t={position:new w,direction:new w,color:new he,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new w,color:new he,distance:0,decay:0};break;case"HemisphereLight":t={direction:new w,skyColor:new he,groundColor:new he};break;case"RectAreaLight":t={color:new he,position:new w,halfWidth:new w,halfHeight:new w};break}return i[e.id]=t,t}}}function $V(){let i={};return{get:function(e){if(i[e.id]!==void 0)return i[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new G};break;case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new G};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new G,shadowCameraNear:1,shadowCameraFar:1e3};break}return i[e.id]=t,t}}}var KV=0;function JV(i,e){return(e.castShadow?1:0)-(i.castShadow?1:0)}function TA(i,e){let t=new YV,r=$V(),o={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]};for(let u=0;u<9;u++)o.probe.push(new w);let n=new w,s=new Ve,a=new Ve;function c(u,p){let h=0,d=0,m=0;for(let M=0;M<9;M++)o.probe[M].set(0,0,0);let f=0,x=0,_=0,g=0,T=0,b=0,y=0,A=0;u.sort(JV);let E=p!==!0?Math.PI:1;for(let M=0,L=u.length;M<L;M++){let C=u[M],N=C.color,D=C.intensity,k=C.distance,z=C.shadow&&C.shadow.map?C.shadow.map.texture:null;if(C.isAmbientLight)h+=N.r*D*E,d+=N.g*D*E,m+=N.b*D*E;else if(C.isLightProbe)for(let F=0;F<9;F++)o.probe[F].addScaledVector(C.sh.coefficients[F],D);else if(C.isDirectionalLight){let F=t.get(C);if(F.color.copy(C.color).multiplyScalar(C.intensity*E),C.castShadow){let X=C.shadow,$=r.get(C);$.shadowBias=X.bias,$.shadowNormalBias=X.normalBias,$.shadowRadius=X.radius,$.shadowMapSize=X.mapSize,o.directionalShadow[f]=$,o.directionalShadowMap[f]=z,o.directionalShadowMatrix[f]=C.shadow.matrix,b++}o.directional[f]=F,f++}else if(C.isSpotLight){let F=t.get(C);if(F.position.setFromMatrixPosition(C.matrixWorld),F.color.copy(N).multiplyScalar(D*E),F.distance=k,F.coneCos=Math.cos(C.angle),F.penumbraCos=Math.cos(C.angle*(1-C.penumbra)),F.decay=C.decay,C.castShadow){let X=C.shadow,$=r.get(C);$.shadowBias=X.bias,$.shadowNormalBias=X.normalBias,$.shadowRadius=X.radius,$.shadowMapSize=X.mapSize,o.spotShadow[_]=$,o.spotShadowMap[_]=z,o.spotShadowMatrix[_]=C.shadow.matrix,A++}o.spot[_]=F,_++}else if(C.isRectAreaLight){let F=t.get(C);F.color.copy(N).multiplyScalar(D),F.halfWidth.set(C.width*.5,0,0),F.halfHeight.set(0,C.height*.5,0),o.rectArea[g]=F,g++}else if(C.isPointLight){let F=t.get(C);if(F.color.copy(C.color).multiplyScalar(C.intensity*E),F.distance=C.distance,F.decay=C.decay,C.castShadow){let X=C.shadow,$=r.get(C);$.shadowBias=X.bias,$.shadowNormalBias=X.normalBias,$.shadowRadius=X.radius,$.shadowMapSize=X.mapSize,$.shadowCameraNear=X.camera.near,$.shadowCameraFar=X.camera.far,o.pointShadow[x]=$,o.pointShadowMap[x]=z,o.pointShadowMatrix[x]=C.shadow.matrix,y++}o.point[x]=F,x++}else if(C.isHemisphereLight){let F=t.get(C);F.skyColor.copy(C.color).multiplyScalar(D*E),F.groundColor.copy(C.groundColor).multiplyScalar(D*E),o.hemi[T]=F,T++}}g>0&&(e.isWebGL2?(o.rectAreaLTC1=Te.LTC_FLOAT_1,o.rectAreaLTC2=Te.LTC_FLOAT_2):i.has("OES_texture_float_linear")===!0?(o.rectAreaLTC1=Te.LTC_FLOAT_1,o.rectAreaLTC2=Te.LTC_FLOAT_2):i.has("OES_texture_half_float_linear")===!0?(o.rectAreaLTC1=Te.LTC_HALF_1,o.rectAreaLTC2=Te.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),o.ambient[0]=h,o.ambient[1]=d,o.ambient[2]=m;let S=o.hash;(S.directionalLength!==f||S.pointLength!==x||S.spotLength!==_||S.rectAreaLength!==g||S.hemiLength!==T||S.numDirectionalShadows!==b||S.numPointShadows!==y||S.numSpotShadows!==A)&&(o.directional.length=f,o.spot.length=_,o.rectArea.length=g,o.point.length=x,o.hemi.length=T,o.directionalShadow.length=b,o.directionalShadowMap.length=b,o.pointShadow.length=y,o.pointShadowMap.length=y,o.spotShadow.length=A,o.spotShadowMap.length=A,o.directionalShadowMatrix.length=b,o.pointShadowMatrix.length=y,o.spotShadowMatrix.length=A,S.directionalLength=f,S.pointLength=x,S.spotLength=_,S.rectAreaLength=g,S.hemiLength=T,S.numDirectionalShadows=b,S.numPointShadows=y,S.numSpotShadows=A,o.version=KV++)}function l(u,p){let h=0,d=0,m=0,f=0,x=0,_=p.matrixWorldInverse;for(let g=0,T=u.length;g<T;g++){let b=u[g];if(b.isDirectionalLight){let y=o.directional[h];y.direction.setFromMatrixPosition(b.matrixWorld),n.setFromMatrixPosition(b.target.matrixWorld),y.direction.sub(n),y.direction.transformDirection(_),h++}else if(b.isSpotLight){let y=o.spot[m];y.position.setFromMatrixPosition(b.matrixWorld),y.position.applyMatrix4(_),y.direction.setFromMatrixPosition(b.matrixWorld),n.setFromMatrixPosition(b.target.matrixWorld),y.direction.sub(n),y.direction.transformDirection(_),m++}else if(b.isRectAreaLight){let y=o.rectArea[f];y.position.setFromMatrixPosition(b.matrixWorld),y.position.applyMatrix4(_),a.identity(),s.copy(b.matrixWorld),s.premultiply(_),a.extractRotation(s),y.halfWidth.set(b.width*.5,0,0),y.halfHeight.set(0,b.height*.5,0),y.halfWidth.applyMatrix4(a),y.halfHeight.applyMatrix4(a),f++}else if(b.isPointLight){let y=o.point[d];y.position.setFromMatrixPosition(b.matrixWorld),y.position.applyMatrix4(_),d++}else if(b.isHemisphereLight){let y=o.hemi[x];y.direction.setFromMatrixPosition(b.matrixWorld),y.direction.transformDirection(_),y.direction.normalize(),x++}}}return{setup:c,setupView:l,state:o}}function AA(i,e){let t=new TA(i,e),r=[],o=[];function n(){r.length=0,o.length=0}function s(p){r.push(p)}function a(p){o.push(p)}function c(p){t.setup(r,p)}function l(p){t.setupView(r,p)}return{init:n,state:{lightsArray:r,shadowsArray:o,lights:t},setupLights:c,setupLightsView:l,pushLight:s,pushShadow:a}}function CA(i,e){let t=new WeakMap;function r(n,s=0){let a;return t.has(n)===!1?(a=new AA(i,e),t.set(n,[a])):s>=t.get(n).length?(a=new AA(i,e),t.get(n).push(a)):a=t.get(n)[s],a}function o(){t=new WeakMap}return{get:r,dispose:o}}var Jl=class extends Bt{constructor(e){super();this.type="MeshDepthMaterial",this.depthPacking=Lm,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}};Jl.prototype.isMeshDepthMaterial=!0;var Zl=class extends Bt{constructor(e){super();this.type="MeshDistanceMaterial",this.referencePosition=new w,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(e)}copy(e){return super.copy(e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}};Zl.prototype.isMeshDistanceMaterial=!0;var EA=`
void main() {

	gl_Position = vec4( position, 1.0 );

}
`,SA=`
uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;

#include <packing>

void main() {

	const float samples = float( VSM_SAMPLES );

	float mean = 0.0;
	float squared_mean = 0.0;

	// This seems totally useless but it's a crazy work around for a Adreno compiler bug
	// float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy ) / resolution ) );

	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {

		float uvOffset = uvStart + i * uvStride;

		#ifdef HORIZONTAL_PASS

			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;

		#else

			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;

		#endif

	}

	mean = mean / samples;
	squared_mean = squared_mean / samples;

	float std_dev = sqrt( squared_mean - mean * mean );

	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );

}
`;function wA(i,e,t){let r=new tc,o=new G,n=new G,s=new Ie,a=new Jl({depthPacking:Im}),c=new Zl,l={},u=t.maxTextureSize,p={0:Dt,1:oo,2:uo},h=new Ar({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new G},radius:{value:4}},vertexShader:EA,fragmentShader:SA}),d=h.clone();d.defines.HORIZONTAL_PASS=1;let m=new De;m.setAttribute("position",new Ot(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));let f=new lt(m,h),x=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=Pl,this.render=function(b,y,A){if(x.enabled===!1||x.autoUpdate===!1&&x.needsUpdate===!1||b.length===0)return;let E=i.getRenderTarget(),S=i.getActiveCubeFace(),M=i.getActiveMipmapLevel(),L=i.state;L.setBlending(ri),L.buffers.color.setClear(1,1,1,1),L.buffers.depth.setTest(!0),L.setScissorTest(!1);for(let C=0,N=b.length;C<N;C++){let D=b[C],k=D.shadow;if(k===void 0){console.warn("THREE.WebGLShadowMap:",D,"has no shadow.");continue}if(k.autoUpdate===!1&&k.needsUpdate===!1)continue;o.copy(k.mapSize);let z=k.getFrameExtents();if(o.multiply(z),n.copy(k.mapSize),(o.x>u||o.y>u)&&(o.x>u&&(n.x=Math.floor(u/z.x),o.x=n.x*z.x,k.mapSize.x=n.x),o.y>u&&(n.y=Math.floor(u/z.y),o.y=n.y*z.y,k.mapSize.y=n.y)),k.map===null&&!k.isPointLightShadow&&this.type===Gs){let X={minFilter:at,magFilter:at,format:st};k.map=new vr(o.x,o.y,X),k.map.texture.name=D.name+".shadowMap",k.mapPass=new vr(o.x,o.y,X),k.camera.updateProjectionMatrix()}if(k.map===null){let X={minFilter:nt,magFilter:nt,format:st};k.map=new vr(o.x,o.y,X),k.map.texture.name=D.name+".shadowMap",k.camera.updateProjectionMatrix()}i.setRenderTarget(k.map),i.clear();let F=k.getViewportCount();for(let X=0;X<F;X++){let $=k.getViewport(X);s.set(n.x*$.x,n.y*$.y,n.x*$.z,n.y*$.w),L.viewport(s),k.updateMatrices(D,X),r=k.getFrustum(),T(y,A,k.camera,D,this.type)}!k.isPointLightShadow&&this.type===Gs&&_(k,A),k.needsUpdate=!1}x.needsUpdate=!1,i.setRenderTarget(E,S,M)};function _(b,y){let A=e.update(f);h.defines.VSM_SAMPLES!==b.blurSamples&&(h.defines.VSM_SAMPLES=b.blurSamples,d.defines.VSM_SAMPLES=b.blurSamples,h.needsUpdate=!0,d.needsUpdate=!0),h.uniforms.shadow_pass.value=b.map.texture,h.uniforms.resolution.value=b.mapSize,h.uniforms.radius.value=b.radius,i.setRenderTarget(b.mapPass),i.clear(),i.renderBufferDirect(y,null,A,h,f,null),d.uniforms.shadow_pass.value=b.mapPass.texture,d.uniforms.resolution.value=b.mapSize,d.uniforms.radius.value=b.radius,i.setRenderTarget(b.map),i.clear(),i.renderBufferDirect(y,null,A,d,f,null)}function g(b,y,A,E,S,M,L){let C=null,N=E.isPointLight===!0?b.customDistanceMaterial:b.customDepthMaterial;if(N!==void 0?C=N:C=E.isPointLight===!0?c:a,i.localClippingEnabled&&A.clipShadows===!0&&A.clippingPlanes.length!==0||A.displacementMap&&A.displacementScale!==0||A.alphaMap&&A.alphaTest>0){let D=C.uuid,k=A.uuid,z=l[D];z===void 0&&(z={},l[D]=z);let F=z[k];F===void 0&&(F=C.clone(),z[k]=F),C=F}return C.visible=A.visible,C.wireframe=A.wireframe,L===Gs?C.side=A.shadowSide!==null?A.shadowSide:A.side:C.side=A.shadowSide!==null?A.shadowSide:p[A.side],C.alphaMap=A.alphaMap,C.alphaTest=A.alphaTest,C.clipShadows=A.clipShadows,C.clippingPlanes=A.clippingPlanes,C.clipIntersection=A.clipIntersection,C.displacementMap=A.displacementMap,C.displacementScale=A.displacementScale,C.displacementBias=A.displacementBias,C.wireframeLinewidth=A.wireframeLinewidth,C.linewidth=A.linewidth,E.isPointLight===!0&&C.isMeshDistanceMaterial===!0&&(C.referencePosition.setFromMatrixPosition(E.matrixWorld),C.nearDistance=S,C.farDistance=M),C}function T(b,y,A,E,S){if(b.visible===!1)return;if(b.layers.test(y.layers)&&(b.isMesh||b.isLine||b.isPoints)&&(b.castShadow||b.receiveShadow&&S===Gs)&&(!b.frustumCulled||r.intersectsObject(b))){b.modelViewMatrix.multiplyMatrices(A.matrixWorldInverse,b.matrixWorld);let C=e.update(b),N=b.material;if(Array.isArray(N)){let D=C.groups;for(let k=0,z=D.length;k<z;k++){let F=D[k],X=N[F.materialIndex];if(X&&X.visible){let $=g(b,C,X,E,A.near,A.far,S);i.renderBufferDirect(A,null,C,$,b,F)}}}else if(N.visible){let D=g(b,C,N,E,A.near,A.far,S);i.renderBufferDirect(A,null,C,D,b,null)}}let L=b.children;for(let C=0,N=L.length;C<N;C++)T(L[C],y,A,E,S)}}function MA(i,e,t){let r=t.isWebGL2;function o(){let W=!1,Le=new Ie,Me=null,Ye=new Ie(0,0,0,0);return{setMask:function(_e){Me!==_e&&!W&&(i.colorMask(_e,_e,_e,_e),Me=_e)},setLocked:function(_e){W=_e},setClear:function(_e,He,tt,or,Mo){Mo===!0&&(_e*=or,He*=or,tt*=or),Le.set(_e,He,tt,or),Ye.equals(Le)===!1&&(i.clearColor(_e,He,tt,or),Ye.copy(Le))},reset:function(){W=!1,Me=null,Ye.set(-1,0,0,0)}}}function n(){let W=!1,Le=null,Me=null,Ye=null;return{setTest:function(_e){_e?R(i.DEPTH_TEST):Ne(i.DEPTH_TEST)},setMask:function(_e){Le!==_e&&!W&&(i.depthMask(_e),Le=_e)},setFunc:function(_e){if(Me!==_e){if(_e)switch(_e){case Mx:i.depthFunc(i.NEVER);break;case Nx:i.depthFunc(i.ALWAYS);break;case Ox:i.depthFunc(i.LESS);break;case O2:i.depthFunc(i.LEQUAL);break;case Px:i.depthFunc(i.EQUAL);break;case Rx:i.depthFunc(i.GEQUAL);break;case Lx:i.depthFunc(i.GREATER);break;case Ix:i.depthFunc(i.NOTEQUAL);break;default:i.depthFunc(i.LEQUAL)}else i.depthFunc(i.LEQUAL);Me=_e}},setLocked:function(_e){W=_e},setClear:function(_e){Ye!==_e&&(i.clearDepth(_e),Ye=_e)},reset:function(){W=!1,Le=null,Me=null,Ye=null}}}function s(){let W=!1,Le=null,Me=null,Ye=null,_e=null,He=null,tt=null,or=null,Mo=null;return{setTest:function(br){W||(br?R(i.STENCIL_TEST):Ne(i.STENCIL_TEST))},setMask:function(br){Le!==br&&!W&&(i.stencilMask(br),Le=br)},setFunc:function(br,os,Us){(Me!==br||Ye!==os||_e!==Us)&&(i.stencilFunc(br,os,Us),Me=br,Ye=os,_e=Us)},setOp:function(br,os,Us){(He!==br||tt!==os||or!==Us)&&(i.stencilOp(br,os,Us),He=br,tt=os,or=Us)},setLocked:function(br){W=br},setClear:function(br){Mo!==br&&(i.clearStencil(br),Mo=br)},reset:function(){W=!1,Le=null,Me=null,Ye=null,_e=null,He=null,tt=null,or=null,Mo=null}}}let a=new o,c=new n,l=new s,u={},p={},h=new WeakMap,d=[],m=null,f=!1,x=null,_=null,g=null,T=null,b=null,y=null,A=null,E=!1,S=null,M=null,L=null,C=null,N=null,D=i.getParameter(i.MAX_COMBINED_TEXTURE_IMAGE_UNITS),k=!1,z=0,F=i.getParameter(i.VERSION);F.indexOf("WebGL")!==-1?(z=parseFloat(/^WebGL (\d)/.exec(F)[1]),k=z>=1):F.indexOf("OpenGL ES")!==-1&&(z=parseFloat(/^OpenGL ES (\d)/.exec(F)[1]),k=z>=2);let X=null,$={},Y=i.getParameter(i.SCISSOR_BOX),H=i.getParameter(i.VIEWPORT),B=new Ie().fromArray(Y),te=new Ie().fromArray(H);function q(W,Le,Me){let Ye=new Uint8Array(4),_e=i.createTexture();i.bindTexture(W,_e),i.texParameteri(W,i.TEXTURE_MIN_FILTER,i.NEAREST),i.texParameteri(W,i.TEXTURE_MAG_FILTER,i.NEAREST);for(let He=0;He<Me;He++)i.texImage2D(Le+He,0,i.RGBA,1,1,0,i.RGBA,i.UNSIGNED_BYTE,Ye);return _e}let j={};j[i.TEXTURE_2D]=q(i.TEXTURE_2D,i.TEXTURE_2D,1),j[i.TEXTURE_CUBE_MAP]=q(i.TEXTURE_CUBE_MAP,i.TEXTURE_CUBE_MAP_POSITIVE_X,6),a.setClear(0,0,0,1),c.setClear(1),l.setClear(0),R(i.DEPTH_TEST),c.setFunc(O2),be(!1),ie(w2),R(i.CULL_FACE),le(ri);function R(W){u[W]!==!0&&(i.enable(W),u[W]=!0)}function Ne(W){u[W]!==!1&&(i.disable(W),u[W]=!1)}function xe(W,Le){return p[W]!==Le?(i.bindFramebuffer(W,Le),p[W]=Le,r&&(W===i.DRAW_FRAMEBUFFER&&(p[i.FRAMEBUFFER]=Le),W===i.FRAMEBUFFER&&(p[i.DRAW_FRAMEBUFFER]=Le)),!0):!1}function ae(W,Le){let Me=d,Ye=!1;if(W)if(Me=h.get(Le),Me===void 0&&(Me=[],h.set(Le,Me)),W.isWebGLMultipleRenderTargets){let _e=W.texture;if(Me.length!==_e.length||Me[0]!==i.COLOR_ATTACHMENT0){for(let He=0,tt=_e.length;He<tt;He++)Me[He]=i.COLOR_ATTACHMENT0+He;Me.length=_e.length,Ye=!0}}else Me[0]!==i.COLOR_ATTACHMENT0&&(Me[0]=i.COLOR_ATTACHMENT0,Ye=!0);else Me[0]!==i.BACK&&(Me[0]=i.BACK,Ye=!0);Ye&&(t.isWebGL2?i.drawBuffers(Me):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(Me))}function Ae(W){return m!==W?(i.useProgram(W),m=W,!0):!1}let Re={[Rl]:i.FUNC_ADD,[mx]:i.FUNC_SUBTRACT,[_x]:i.FUNC_REVERSE_SUBTRACT};if(r)Re[M2]=i.MIN,Re[N2]=i.MAX;else{let W=e.get("EXT_blend_minmax");W!==null&&(Re[M2]=W.MIN_EXT,Re[N2]=W.MAX_EXT)}let Oe={[gx]:i.ZERO,[vx]:i.ONE,[xx]:i.SRC_COLOR,[bx]:i.SRC_ALPHA,[wx]:i.SRC_ALPHA_SATURATE,[Ex]:i.DST_COLOR,[Ax]:i.DST_ALPHA,[yx]:i.ONE_MINUS_SRC_COLOR,[Tx]:i.ONE_MINUS_SRC_ALPHA,[Sx]:i.ONE_MINUS_DST_COLOR,[Cx]:i.ONE_MINUS_DST_ALPHA};function le(W,Le,Me,Ye,_e,He,tt,or){if(W===ri){f===!0&&(Ne(i.BLEND),f=!1);return}if(f===!1&&(R(i.BLEND),f=!0),W!==fx){if(W!==x||or!==E){if((_!==Rl||b!==Rl)&&(i.blendEquation(i.FUNC_ADD),_=Rl,b=Rl),or)switch(W){case Za:i.blendFuncSeparate(i.ONE,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA);break;case sh:i.blendFunc(i.ONE,i.ONE);break;case ah:i.blendFuncSeparate(i.ZERO,i.ONE_MINUS_SRC_COLOR,i.ZERO,i.ONE);break;case ch:i.blendFuncSeparate(i.ZERO,i.SRC_COLOR,i.ZERO,i.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",W);break}else switch(W){case Za:i.blendFuncSeparate(i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA);break;case sh:i.blendFunc(i.SRC_ALPHA,i.ONE);break;case ah:i.blendFuncSeparate(i.ZERO,i.ONE_MINUS_SRC_COLOR,i.ZERO,i.ONE);break;case ch:i.blendFunc(i.ZERO,i.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",W);break}g=null,T=null,y=null,A=null,x=W,E=or}return}_e=_e||Le,He=He||Me,tt=tt||Ye,(Le!==_||_e!==b)&&(i.blendEquationSeparate(Re[Le],Re[_e]),_=Le,b=_e),(Me!==g||Ye!==T||He!==y||tt!==A)&&(i.blendFuncSeparate(Oe[Me],Oe[Ye],Oe[He],Oe[tt]),g=Me,T=Ye,y=He,A=tt),x=W,E=null}function ye(W,Le){W.side===uo?Ne(i.CULL_FACE):R(i.CULL_FACE);let Me=W.side===Dt;Le&&(Me=!Me),be(Me),W.blending===Za&&W.transparent===!1?le(ri):le(W.blending,W.blendEquation,W.blendSrc,W.blendDst,W.blendEquationAlpha,W.blendSrcAlpha,W.blendDstAlpha,W.premultipliedAlpha),c.setFunc(W.depthFunc),c.setTest(W.depthTest),c.setMask(W.depthWrite),a.setMask(W.colorWrite);let Ye=W.stencilWrite;l.setTest(Ye),Ye&&(l.setMask(W.stencilWriteMask),l.setFunc(W.stencilFunc,W.stencilRef,W.stencilFuncMask),l.setOp(W.stencilFail,W.stencilZFail,W.stencilZPass)),we(W.polygonOffset,W.polygonOffsetFactor,W.polygonOffsetUnits),W.alphaToCoverage===!0?R(i.SAMPLE_ALPHA_TO_COVERAGE):Ne(i.SAMPLE_ALPHA_TO_COVERAGE)}function be(W){S!==W&&(W?i.frontFace(i.CW):i.frontFace(i.CCW),S=W)}function ie(W){W!==px?(R(i.CULL_FACE),W!==M&&(W===w2?i.cullFace(i.BACK):W===hx?i.cullFace(i.FRONT):i.cullFace(i.FRONT_AND_BACK))):Ne(i.CULL_FACE),M=W}function de(W){W!==L&&(k&&i.lineWidth(W),L=W)}function we(W,Le,Me){W?(R(i.POLYGON_OFFSET_FILL),(C!==Le||N!==Me)&&(i.polygonOffset(Le,Me),C=Le,N=Me)):Ne(i.POLYGON_OFFSET_FILL)}function Ee(W){W?R(i.SCISSOR_TEST):Ne(i.SCISSOR_TEST)}function Pe(W){W===void 0&&(W=i.TEXTURE0+D-1),X!==W&&(i.activeTexture(W),X=W)}function We(W,Le){X===null&&Pe();let Me=$[X];Me===void 0&&(Me={type:void 0,texture:void 0},$[X]=Me),(Me.type!==W||Me.texture!==Le)&&(i.bindTexture(W,Le||j[W]),Me.type=W,Me.texture=Le)}function Ze(){let W=$[X];W!==void 0&&W.type!==void 0&&(i.bindTexture(W.type,null),W.type=void 0,W.texture=void 0)}function I(){try{i.compressedTexImage2D.apply(i,arguments)}catch(W){console.error("THREE.WebGLState:",W)}}function O(){try{i.texSubImage2D.apply(i,arguments)}catch(W){console.error("THREE.WebGLState:",W)}}function fe(){try{i.texSubImage3D.apply(i,arguments)}catch(W){console.error("THREE.WebGLState:",W)}}function ee(){try{i.compressedTexSubImage2D.apply(i,arguments)}catch(W){console.error("THREE.WebGLState:",W)}}function me(){try{i.texStorage2D.apply(i,arguments)}catch(W){console.error("THREE.WebGLState:",W)}}function Z(){try{i.texStorage3D.apply(i,arguments)}catch(W){console.error("THREE.WebGLState:",W)}}function Se(){try{i.texImage2D.apply(i,arguments)}catch(W){console.error("THREE.WebGLState:",W)}}function U(){try{i.texImage3D.apply(i,arguments)}catch(W){console.error("THREE.WebGLState:",W)}}function se(W){B.equals(W)===!1&&(i.scissor(W.x,W.y,W.z,W.w),B.copy(W))}function ve(W){te.equals(W)===!1&&(i.viewport(W.x,W.y,W.z,W.w),te.copy(W))}function ke(){i.disable(i.BLEND),i.disable(i.CULL_FACE),i.disable(i.DEPTH_TEST),i.disable(i.POLYGON_OFFSET_FILL),i.disable(i.SCISSOR_TEST),i.disable(i.STENCIL_TEST),i.disable(i.SAMPLE_ALPHA_TO_COVERAGE),i.blendEquation(i.FUNC_ADD),i.blendFunc(i.ONE,i.ZERO),i.blendFuncSeparate(i.ONE,i.ZERO,i.ONE,i.ZERO),i.colorMask(!0,!0,!0,!0),i.clearColor(0,0,0,0),i.depthMask(!0),i.depthFunc(i.LESS),i.clearDepth(1),i.stencilMask(4294967295),i.stencilFunc(i.ALWAYS,0,4294967295),i.stencilOp(i.KEEP,i.KEEP,i.KEEP),i.clearStencil(0),i.cullFace(i.BACK),i.frontFace(i.CCW),i.polygonOffset(0,0),i.activeTexture(i.TEXTURE0),i.bindFramebuffer(i.FRAMEBUFFER,null),r===!0&&(i.bindFramebuffer(i.DRAW_FRAMEBUFFER,null),i.bindFramebuffer(i.READ_FRAMEBUFFER,null)),i.useProgram(null),i.lineWidth(1),i.scissor(0,0,i.canvas.width,i.canvas.height),i.viewport(0,0,i.canvas.width,i.canvas.height),u={},X=null,$={},p={},h=new WeakMap,d=[],m=null,f=!1,x=null,_=null,g=null,T=null,b=null,y=null,A=null,E=!1,S=null,M=null,L=null,C=null,N=null,B.set(0,0,i.canvas.width,i.canvas.height),te.set(0,0,i.canvas.width,i.canvas.height),a.reset(),c.reset(),l.reset()}return{buffers:{color:a,depth:c,stencil:l},enable:R,disable:Ne,bindFramebuffer:xe,drawBuffers:ae,useProgram:Ae,setBlending:le,setMaterial:ye,setFlipSided:be,setCullFace:ie,setLineWidth:de,setPolygonOffset:we,setScissorTest:Ee,activeTexture:Pe,bindTexture:We,unbindTexture:Ze,compressedTexImage2D:I,texImage2D:Se,texImage3D:U,texStorage2D:me,texStorage3D:Z,texSubImage2D:O,texSubImage3D:fe,compressedTexSubImage2D:ee,scissor:se,viewport:ve,reset:ke}}function NA(i,e,t,r,o,n,s){let a=o.isWebGL2,c=o.maxTextures,l=o.maxCubemapSize,u=o.maxTextureSize,p=o.maxSamples,d=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):void 0,m=new WeakMap,f,x=!1;try{x=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function _(I,O){return x?new OffscreenCanvas(I,O):Vl("canvas")}function g(I,O,fe,ee){let me=1;if((I.width>ee||I.height>ee)&&(me=ee/Math.max(I.width,I.height)),me<1||O===!0)if(typeof HTMLImageElement<"u"&&I instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&I instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&I instanceof ImageBitmap){let Z=O?Xx:Math.floor,Se=Z(me*I.width),U=Z(me*I.height);f===void 0&&(f=_(Se,U));let se=fe?_(Se,U):f;return se.width=Se,se.height=U,se.getContext("2d").drawImage(I,0,0,Se,U),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+I.width+"x"+I.height+") to ("+Se+"x"+U+")."),se}else return"data"in I&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+I.width+"x"+I.height+")."),I;return I}function T(I){return kl(I.width)&&kl(I.height)}function b(I){return a?!1:I.wrapS!==kt||I.wrapT!==kt||I.minFilter!==nt&&I.minFilter!==at}function y(I,O){return I.generateMipmaps&&O&&I.minFilter!==nt&&I.minFilter!==at}function A(I){i.generateMipmap(I)}function E(I,O,fe,ee,me=!1){if(a===!1)return O;if(I!==null){if(i[I]!==void 0)return i[I];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+I+"'")}let Z=O;return O===i.RED&&(fe===i.FLOAT&&(Z=i.R32F),fe===i.HALF_FLOAT&&(Z=i.R16F),fe===i.UNSIGNED_BYTE&&(Z=i.R8)),O===i.RG&&(fe===i.FLOAT&&(Z=i.RG32F),fe===i.HALF_FLOAT&&(Z=i.RG16F),fe===i.UNSIGNED_BYTE&&(Z=i.RG8)),O===i.RGBA&&(fe===i.FLOAT&&(Z=i.RGBA32F),fe===i.HALF_FLOAT&&(Z=i.RGBA16F),fe===i.UNSIGNED_BYTE&&(Z=ee===bt&&me===!1?i.SRGB8_ALPHA8:i.RGBA8),fe===i.UNSIGNED_SHORT_4_4_4_4&&(Z=i.RGBA4),fe===i.UNSIGNED_SHORT_5_5_5_1&&(Z=i.RGB5_A1)),(Z===i.R16F||Z===i.R32F||Z===i.RG16F||Z===i.RG32F||Z===i.RGBA16F||Z===i.RGBA32F)&&e.get("EXT_color_buffer_float"),Z}function S(I,O,fe){return y(I,fe)===!0||I.isFramebufferTexture&&I.minFilter!==nt&&I.minFilter!==at?Math.log2(Math.max(O.width,O.height))+1:I.mipmaps!==void 0&&I.mipmaps.length>0?I.mipmaps.length:I.isCompressedTexture&&Array.isArray(I.image)?O.mipmaps.length:1}function M(I){return I===nt||I===Qa||I===ec?i.NEAREST:i.LINEAR}function L(I){let O=I.target;O.removeEventListener("dispose",L),N(O),O.isVideoTexture&&m.delete(O),s.memory.textures--}function C(I){let O=I.target;O.removeEventListener("dispose",C),D(O)}function N(I){let O=r.get(I);O.__webglInit!==void 0&&(i.deleteTexture(O.__webglTexture),r.remove(I))}function D(I){let O=I.texture,fe=r.get(I),ee=r.get(O);if(!!I){if(ee.__webglTexture!==void 0&&(i.deleteTexture(ee.__webglTexture),s.memory.textures--),I.depthTexture&&I.depthTexture.dispose(),I.isWebGLCubeRenderTarget)for(let me=0;me<6;me++)i.deleteFramebuffer(fe.__webglFramebuffer[me]),fe.__webglDepthbuffer&&i.deleteRenderbuffer(fe.__webglDepthbuffer[me]);else i.deleteFramebuffer(fe.__webglFramebuffer),fe.__webglDepthbuffer&&i.deleteRenderbuffer(fe.__webglDepthbuffer),fe.__webglMultisampledFramebuffer&&i.deleteFramebuffer(fe.__webglMultisampledFramebuffer),fe.__webglColorRenderbuffer&&i.deleteRenderbuffer(fe.__webglColorRenderbuffer),fe.__webglDepthRenderbuffer&&i.deleteRenderbuffer(fe.__webglDepthRenderbuffer);if(I.isWebGLMultipleRenderTargets)for(let me=0,Z=O.length;me<Z;me++){let Se=r.get(O[me]);Se.__webglTexture&&(i.deleteTexture(Se.__webglTexture),s.memory.textures--),r.remove(O[me])}r.remove(O),r.remove(I)}}let k=0;function z(){k=0}function F(){let I=k;return I>=c&&console.warn("THREE.WebGLTextures: Trying to use "+I+" texture units while this GPU supports only "+c),k+=1,I}function X(I,O){let fe=r.get(I);if(I.isVideoTexture&&de(I),I.version>0&&fe.__version!==I.version){let ee=I.image;if(ee===void 0)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else if(ee.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{R(fe,I,O);return}}t.activeTexture(i.TEXTURE0+O),t.bindTexture(i.TEXTURE_2D,fe.__webglTexture)}function $(I,O){let fe=r.get(I);if(I.version>0&&fe.__version!==I.version){R(fe,I,O);return}t.activeTexture(i.TEXTURE0+O),t.bindTexture(i.TEXTURE_2D_ARRAY,fe.__webglTexture)}function Y(I,O){let fe=r.get(I);if(I.version>0&&fe.__version!==I.version){R(fe,I,O);return}t.activeTexture(i.TEXTURE0+O),t.bindTexture(i.TEXTURE_3D,fe.__webglTexture)}function H(I,O){let fe=r.get(I);if(I.version>0&&fe.__version!==I.version){Ne(fe,I,O);return}t.activeTexture(i.TEXTURE0+O),t.bindTexture(i.TEXTURE_CUBE_MAP,fe.__webglTexture)}let B={[Hi]:i.REPEAT,[kt]:i.CLAMP_TO_EDGE,[P0]:i.MIRRORED_REPEAT},te={[nt]:i.NEAREST,[Qa]:i.NEAREST_MIPMAP_NEAREST,[ec]:i.NEAREST_MIPMAP_LINEAR,[at]:i.LINEAR,[Il]:i.LINEAR_MIPMAP_NEAREST,[Cn]:i.LINEAR_MIPMAP_LINEAR};function q(I,O,fe){if(fe?(i.texParameteri(I,i.TEXTURE_WRAP_S,B[O.wrapS]),i.texParameteri(I,i.TEXTURE_WRAP_T,B[O.wrapT]),(I===i.TEXTURE_3D||I===i.TEXTURE_2D_ARRAY)&&i.texParameteri(I,i.TEXTURE_WRAP_R,B[O.wrapR]),i.texParameteri(I,i.TEXTURE_MAG_FILTER,te[O.magFilter]),i.texParameteri(I,i.TEXTURE_MIN_FILTER,te[O.minFilter])):(i.texParameteri(I,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(I,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),(I===i.TEXTURE_3D||I===i.TEXTURE_2D_ARRAY)&&i.texParameteri(I,i.TEXTURE_WRAP_R,i.CLAMP_TO_EDGE),(O.wrapS!==kt||O.wrapT!==kt)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),i.texParameteri(I,i.TEXTURE_MAG_FILTER,M(O.magFilter)),i.texParameteri(I,i.TEXTURE_MIN_FILTER,M(O.minFilter)),O.minFilter!==nt&&O.minFilter!==at&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),e.has("EXT_texture_filter_anisotropic")===!0){let ee=e.get("EXT_texture_filter_anisotropic");if(O.type===Wt&&e.has("OES_texture_float_linear")===!1||a===!1&&O.type===zr&&e.has("OES_texture_half_float_linear")===!1)return;(O.anisotropy>1||r.get(O).__currentAnisotropy)&&(i.texParameterf(I,ee.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(O.anisotropy,o.getMaxAnisotropy())),r.get(O).__currentAnisotropy=O.anisotropy)}}function j(I,O){I.__webglInit===void 0&&(I.__webglInit=!0,O.addEventListener("dispose",L),I.__webglTexture=i.createTexture(),s.memory.textures++)}function R(I,O,fe){let ee=i.TEXTURE_2D;O.isDataTexture2DArray&&(ee=i.TEXTURE_2D_ARRAY),O.isDataTexture3D&&(ee=i.TEXTURE_3D),j(I,O),t.activeTexture(i.TEXTURE0+fe),t.bindTexture(ee,I.__webglTexture),i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,O.flipY),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,O.premultiplyAlpha),i.pixelStorei(i.UNPACK_ALIGNMENT,O.unpackAlignment),i.pixelStorei(i.UNPACK_COLORSPACE_CONVERSION_WEBGL,i.NONE);let me=b(O)&&T(O.image)===!1,Z=g(O.image,me,!1,u);Z=we(O,Z);let Se=T(Z)||a,U=n.convert(O.format,O.encoding),se=n.convert(O.type),ve=E(O.internalFormat,U,se,O.encoding,O.isVideoTexture);q(ee,O,Se);let ke,W=O.mipmaps,Le=a&&O.isVideoTexture!==!0,Me=I.__version===void 0,Ye=S(O,Z,Se);if(O.isDepthTexture)ve=i.DEPTH_COMPONENT,a?O.type===Wt?ve=i.DEPTH_COMPONENT32F:O.type===R0?ve=i.DEPTH_COMPONENT24:O.type===ji?ve=i.DEPTH24_STENCIL8:ve=i.DEPTH_COMPONENT16:O.type===Wt&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),O.format===xi&&ve===i.DEPTH_COMPONENT&&O.type!==En&&O.type!==R0&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),O.type=En,se=n.convert(O.type)),O.format===Wi&&ve===i.DEPTH_COMPONENT&&(ve=i.DEPTH_STENCIL,O.type!==ji&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),O.type=ji,se=n.convert(O.type))),Le&&Me?t.texStorage2D(i.TEXTURE_2D,1,ve,Z.width,Z.height):t.texImage2D(i.TEXTURE_2D,0,ve,Z.width,Z.height,0,U,se,null);else if(O.isDataTexture)if(W.length>0&&Se){Le&&Me&&t.texStorage2D(i.TEXTURE_2D,Ye,ve,W[0].width,W[0].height);for(let _e=0,He=W.length;_e<He;_e++)ke=W[_e],Le?t.texSubImage2D(i.TEXTURE_2D,0,0,0,ke.width,ke.height,U,se,ke.data):t.texImage2D(i.TEXTURE_2D,_e,ve,ke.width,ke.height,0,U,se,ke.data);O.generateMipmaps=!1}else Le?(Me&&t.texStorage2D(i.TEXTURE_2D,Ye,ve,Z.width,Z.height),t.texSubImage2D(i.TEXTURE_2D,0,0,0,Z.width,Z.height,U,se,Z.data)):t.texImage2D(i.TEXTURE_2D,0,ve,Z.width,Z.height,0,U,se,Z.data);else if(O.isCompressedTexture){Le&&Me&&t.texStorage2D(i.TEXTURE_2D,Ye,ve,W[0].width,W[0].height);for(let _e=0,He=W.length;_e<He;_e++)ke=W[_e],O.format!==st?U!==null?Le?t.compressedTexSubImage2D(i.TEXTURE_2D,_e,0,0,ke.width,ke.height,U,ke.data):t.compressedTexImage2D(i.TEXTURE_2D,_e,ve,ke.width,ke.height,0,ke.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Le?t.texSubImage2D(i.TEXTURE_2D,_e,0,0,ke.width,ke.height,U,se,ke.data):t.texImage2D(i.TEXTURE_2D,_e,ve,ke.width,ke.height,0,U,se,ke.data)}else if(O.isDataTexture2DArray)Le?(Me&&t.texStorage3D(i.TEXTURE_2D_ARRAY,Ye,ve,Z.width,Z.height,Z.depth),t.texSubImage3D(i.TEXTURE_2D_ARRAY,0,0,0,0,Z.width,Z.height,Z.depth,U,se,Z.data)):t.texImage3D(i.TEXTURE_2D_ARRAY,0,ve,Z.width,Z.height,Z.depth,0,U,se,Z.data);else if(O.isDataTexture3D)Le?(Me&&t.texStorage3D(i.TEXTURE_3D,Ye,ve,Z.width,Z.height,Z.depth),t.texSubImage3D(i.TEXTURE_3D,0,0,0,0,Z.width,Z.height,Z.depth,U,se,Z.data)):t.texImage3D(i.TEXTURE_3D,0,ve,Z.width,Z.height,Z.depth,0,U,se,Z.data);else if(O.isFramebufferTexture)Le&&Me?t.texStorage2D(i.TEXTURE_2D,Ye,ve,Z.width,Z.height):t.texImage2D(i.TEXTURE_2D,0,ve,Z.width,Z.height,0,U,se,null);else if(W.length>0&&Se){Le&&Me&&t.texStorage2D(i.TEXTURE_2D,Ye,ve,W[0].width,W[0].height);for(let _e=0,He=W.length;_e<He;_e++)ke=W[_e],Le?t.texSubImage2D(i.TEXTURE_2D,_e,0,0,U,se,ke):t.texImage2D(i.TEXTURE_2D,_e,ve,U,se,ke);O.generateMipmaps=!1}else Le?(Me&&t.texStorage2D(i.TEXTURE_2D,Ye,ve,Z.width,Z.height),t.texSubImage2D(i.TEXTURE_2D,0,0,0,U,se,Z)):t.texImage2D(i.TEXTURE_2D,0,ve,U,se,Z);y(O,Se)&&A(ee),I.__version=O.version,O.onUpdate&&O.onUpdate(O)}function Ne(I,O,fe){if(O.image.length!==6)return;j(I,O),t.activeTexture(i.TEXTURE0+fe),t.bindTexture(i.TEXTURE_CUBE_MAP,I.__webglTexture),i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,O.flipY),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,O.premultiplyAlpha),i.pixelStorei(i.UNPACK_ALIGNMENT,O.unpackAlignment),i.pixelStorei(i.UNPACK_COLORSPACE_CONVERSION_WEBGL,i.NONE);let ee=O&&(O.isCompressedTexture||O.image[0].isCompressedTexture),me=O.image[0]&&O.image[0].isDataTexture,Z=[];for(let _e=0;_e<6;_e++)!ee&&!me?Z[_e]=g(O.image[_e],!1,!0,l):Z[_e]=me?O.image[_e].image:O.image[_e],Z[_e]=we(O,Z[_e]);let Se=Z[0],U=T(Se)||a,se=n.convert(O.format,O.encoding),ve=n.convert(O.type),ke=E(O.internalFormat,se,ve,O.encoding),W=a&&O.isVideoTexture!==!0,Le=I.__version===void 0,Me=S(O,Se,U);q(i.TEXTURE_CUBE_MAP,O,U);let Ye;if(ee){W&&Le&&t.texStorage2D(i.TEXTURE_CUBE_MAP,Me,ke,Se.width,Se.height);for(let _e=0;_e<6;_e++){Ye=Z[_e].mipmaps;for(let He=0;He<Ye.length;He++){let tt=Ye[He];O.format!==st?se!==null?W?t.compressedTexSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+_e,He,0,0,tt.width,tt.height,se,tt.data):t.compressedTexImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+_e,He,ke,tt.width,tt.height,0,tt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):W?t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+_e,He,0,0,tt.width,tt.height,se,ve,tt.data):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+_e,He,ke,tt.width,tt.height,0,se,ve,tt.data)}}}else{Ye=O.mipmaps,W&&Le&&(Ye.length>0&&Me++,t.texStorage2D(i.TEXTURE_CUBE_MAP,Me,ke,Z[0].width,Z[0].height));for(let _e=0;_e<6;_e++)if(me){W?t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+_e,0,0,0,Z[_e].width,Z[_e].height,se,ve,Z[_e].data):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+_e,0,ke,Z[_e].width,Z[_e].height,0,se,ve,Z[_e].data);for(let He=0;He<Ye.length;He++){let or=Ye[He].image[_e].image;W?t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+_e,He+1,0,0,or.width,or.height,se,ve,or.data):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+_e,He+1,ke,or.width,or.height,0,se,ve,or.data)}}else{W?t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+_e,0,0,0,se,ve,Z[_e]):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+_e,0,ke,se,ve,Z[_e]);for(let He=0;He<Ye.length;He++){let tt=Ye[He];W?t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+_e,He+1,0,0,se,ve,tt.image[_e]):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+_e,He+1,ke,se,ve,tt.image[_e])}}}y(O,U)&&A(i.TEXTURE_CUBE_MAP),I.__version=O.version,O.onUpdate&&O.onUpdate(O)}function xe(I,O,fe,ee,me){let Z=n.convert(fe.format,fe.encoding),Se=n.convert(fe.type),U=E(fe.internalFormat,Z,Se,fe.encoding);r.get(O).__hasExternalTextures||(me===i.TEXTURE_3D||me===i.TEXTURE_2D_ARRAY?t.texImage3D(me,0,U,O.width,O.height,O.depth,0,Z,Se,null):t.texImage2D(me,0,U,O.width,O.height,0,Z,Se,null)),t.bindFramebuffer(i.FRAMEBUFFER,I),O.useRenderToTexture?d.framebufferTexture2DMultisampleEXT(i.FRAMEBUFFER,ee,me,r.get(fe).__webglTexture,0,ie(O)):i.framebufferTexture2D(i.FRAMEBUFFER,ee,me,r.get(fe).__webglTexture,0),t.bindFramebuffer(i.FRAMEBUFFER,null)}function ae(I,O,fe){if(i.bindRenderbuffer(i.RENDERBUFFER,I),O.depthBuffer&&!O.stencilBuffer){let ee=i.DEPTH_COMPONENT16;if(fe||O.useRenderToTexture){let me=O.depthTexture;me&&me.isDepthTexture&&(me.type===Wt?ee=i.DEPTH_COMPONENT32F:me.type===R0&&(ee=i.DEPTH_COMPONENT24));let Z=ie(O);O.useRenderToTexture?d.renderbufferStorageMultisampleEXT(i.RENDERBUFFER,Z,ee,O.width,O.height):i.renderbufferStorageMultisample(i.RENDERBUFFER,Z,ee,O.width,O.height)}else i.renderbufferStorage(i.RENDERBUFFER,ee,O.width,O.height);i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.RENDERBUFFER,I)}else if(O.depthBuffer&&O.stencilBuffer){let ee=ie(O);fe&&O.useRenderbuffer?i.renderbufferStorageMultisample(i.RENDERBUFFER,ee,i.DEPTH24_STENCIL8,O.width,O.height):O.useRenderToTexture?d.renderbufferStorageMultisampleEXT(i.RENDERBUFFER,ee,i.DEPTH24_STENCIL8,O.width,O.height):i.renderbufferStorage(i.RENDERBUFFER,i.DEPTH_STENCIL,O.width,O.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.RENDERBUFFER,I)}else{let ee=O.isWebGLMultipleRenderTargets===!0?O.texture[0]:O.texture,me=n.convert(ee.format,ee.encoding),Z=n.convert(ee.type),Se=E(ee.internalFormat,me,Z,ee.encoding),U=ie(O);fe&&O.useRenderbuffer?i.renderbufferStorageMultisample(i.RENDERBUFFER,U,Se,O.width,O.height):O.useRenderToTexture?d.renderbufferStorageMultisampleEXT(i.RENDERBUFFER,U,Se,O.width,O.height):i.renderbufferStorage(i.RENDERBUFFER,Se,O.width,O.height)}i.bindRenderbuffer(i.RENDERBUFFER,null)}function Ae(I,O){if(O&&O.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(i.FRAMEBUFFER,I),!(O.depthTexture&&O.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!r.get(O.depthTexture).__webglTexture||O.depthTexture.image.width!==O.width||O.depthTexture.image.height!==O.height)&&(O.depthTexture.image.width=O.width,O.depthTexture.image.height=O.height,O.depthTexture.needsUpdate=!0),X(O.depthTexture,0);let ee=r.get(O.depthTexture).__webglTexture,me=ie(O);if(O.depthTexture.format===xi)O.useRenderToTexture?d.framebufferTexture2DMultisampleEXT(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.TEXTURE_2D,ee,0,me):i.framebufferTexture2D(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.TEXTURE_2D,ee,0);else if(O.depthTexture.format===Wi)O.useRenderToTexture?d.framebufferTexture2DMultisampleEXT(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.TEXTURE_2D,ee,0,me):i.framebufferTexture2D(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.TEXTURE_2D,ee,0);else throw new Error("Unknown depthTexture format")}function Re(I){let O=r.get(I),fe=I.isWebGLCubeRenderTarget===!0;if(I.depthTexture&&!O.__autoAllocateDepthBuffer){if(fe)throw new Error("target.depthTexture not supported in Cube render targets");Ae(O.__webglFramebuffer,I)}else if(fe){O.__webglDepthbuffer=[];for(let ee=0;ee<6;ee++)t.bindFramebuffer(i.FRAMEBUFFER,O.__webglFramebuffer[ee]),O.__webglDepthbuffer[ee]=i.createRenderbuffer(),ae(O.__webglDepthbuffer[ee],I,!1)}else t.bindFramebuffer(i.FRAMEBUFFER,O.__webglFramebuffer),O.__webglDepthbuffer=i.createRenderbuffer(),ae(O.__webglDepthbuffer,I,!1);t.bindFramebuffer(i.FRAMEBUFFER,null)}function Oe(I,O,fe){let ee=r.get(I);O!==void 0&&xe(ee.__webglFramebuffer,I,I.texture,i.COLOR_ATTACHMENT0,i.TEXTURE_2D),fe!==void 0&&Re(I)}function le(I){let O=I.texture,fe=r.get(I),ee=r.get(O);I.addEventListener("dispose",C),I.isWebGLMultipleRenderTargets!==!0&&(ee.__webglTexture===void 0&&(ee.__webglTexture=i.createTexture()),ee.__version=O.version,s.memory.textures++);let me=I.isWebGLCubeRenderTarget===!0,Z=I.isWebGLMultipleRenderTargets===!0,Se=O.isDataTexture3D||O.isDataTexture2DArray,U=T(I)||a;if(me){fe.__webglFramebuffer=[];for(let se=0;se<6;se++)fe.__webglFramebuffer[se]=i.createFramebuffer()}else if(fe.__webglFramebuffer=i.createFramebuffer(),Z)if(o.drawBuffers){let se=I.texture;for(let ve=0,ke=se.length;ve<ke;ve++){let W=r.get(se[ve]);W.__webglTexture===void 0&&(W.__webglTexture=i.createTexture(),s.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");else if(I.useRenderbuffer)if(a){fe.__webglMultisampledFramebuffer=i.createFramebuffer(),fe.__webglColorRenderbuffer=i.createRenderbuffer(),i.bindRenderbuffer(i.RENDERBUFFER,fe.__webglColorRenderbuffer);let se=n.convert(O.format,O.encoding),ve=n.convert(O.type),ke=E(O.internalFormat,se,ve,O.encoding),W=ie(I);i.renderbufferStorageMultisample(i.RENDERBUFFER,W,ke,I.width,I.height),t.bindFramebuffer(i.FRAMEBUFFER,fe.__webglMultisampledFramebuffer),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.RENDERBUFFER,fe.__webglColorRenderbuffer),i.bindRenderbuffer(i.RENDERBUFFER,null),I.depthBuffer&&(fe.__webglDepthRenderbuffer=i.createRenderbuffer(),ae(fe.__webglDepthRenderbuffer,I,!0)),t.bindFramebuffer(i.FRAMEBUFFER,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(me){t.bindTexture(i.TEXTURE_CUBE_MAP,ee.__webglTexture),q(i.TEXTURE_CUBE_MAP,O,U);for(let se=0;se<6;se++)xe(fe.__webglFramebuffer[se],I,O,i.COLOR_ATTACHMENT0,i.TEXTURE_CUBE_MAP_POSITIVE_X+se);y(O,U)&&A(i.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(Z){let se=I.texture;for(let ve=0,ke=se.length;ve<ke;ve++){let W=se[ve],Le=r.get(W);t.bindTexture(i.TEXTURE_2D,Le.__webglTexture),q(i.TEXTURE_2D,W,U),xe(fe.__webglFramebuffer,I,W,i.COLOR_ATTACHMENT0+ve,i.TEXTURE_2D),y(W,U)&&A(i.TEXTURE_2D)}t.unbindTexture()}else{let se=i.TEXTURE_2D;Se&&(a?se=O.isDataTexture3D?i.TEXTURE_3D:i.TEXTURE_2D_ARRAY:console.warn("THREE.DataTexture3D and THREE.DataTexture2DArray only supported with WebGL2.")),t.bindTexture(se,ee.__webglTexture),q(se,O,U),xe(fe.__webglFramebuffer,I,O,i.COLOR_ATTACHMENT0,se),y(O,U)&&A(se),t.unbindTexture()}I.depthBuffer&&Re(I)}function ye(I){let O=T(I)||a,fe=I.isWebGLMultipleRenderTargets===!0?I.texture:[I.texture];for(let ee=0,me=fe.length;ee<me;ee++){let Z=fe[ee];if(y(Z,O)){let Se=I.isWebGLCubeRenderTarget?i.TEXTURE_CUBE_MAP:i.TEXTURE_2D,U=r.get(Z).__webglTexture;t.bindTexture(Se,U),A(Se),t.unbindTexture()}}}function be(I){if(I.useRenderbuffer)if(a){let O=I.width,fe=I.height,ee=i.COLOR_BUFFER_BIT,me=[i.COLOR_ATTACHMENT0],Z=I.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT;I.depthBuffer&&me.push(Z),I.ignoreDepthForMultisampleCopy||(I.depthBuffer&&(ee|=i.DEPTH_BUFFER_BIT),I.stencilBuffer&&(ee|=i.STENCIL_BUFFER_BIT));let Se=r.get(I);t.bindFramebuffer(i.READ_FRAMEBUFFER,Se.__webglMultisampledFramebuffer),t.bindFramebuffer(i.DRAW_FRAMEBUFFER,Se.__webglFramebuffer),I.ignoreDepthForMultisampleCopy&&(i.invalidateFramebuffer(i.READ_FRAMEBUFFER,[Z]),i.invalidateFramebuffer(i.DRAW_FRAMEBUFFER,[Z])),i.blitFramebuffer(0,0,O,fe,0,0,O,fe,ee,i.NEAREST),i.invalidateFramebuffer(i.READ_FRAMEBUFFER,me),t.bindFramebuffer(i.READ_FRAMEBUFFER,null),t.bindFramebuffer(i.DRAW_FRAMEBUFFER,Se.__webglMultisampledFramebuffer)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")}function ie(I){return a&&(I.useRenderbuffer||I.useRenderToTexture)?Math.min(p,I.samples):0}function de(I){let O=s.render.frame;m.get(I)!==O&&(m.set(I,O),I.update())}function we(I,O){let fe=I.encoding,ee=I.format,me=I.type;return I.isCompressedTexture===!0||I.isVideoTexture===!0||I.format===lh||fe!==Hr&&(fe===bt?a===!1?e.has("EXT_sRGB")===!0&&ee===st?(I.format=lh,I.minFilter=at,I.generateMipmaps=!1):O=Qx.sRGBToLinear(O):(ee!==st||me!==Go)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",fe)),O}let Ee=!1,Pe=!1;function We(I,O){I&&I.isWebGLRenderTarget&&(Ee===!1&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),Ee=!0),I=I.texture),X(I,O)}function Ze(I,O){I&&I.isWebGLCubeRenderTarget&&(Pe===!1&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),Pe=!0),I=I.texture),H(I,O)}this.allocateTextureUnit=F,this.resetTextureUnits=z,this.setTexture2D=X,this.setTexture2DArray=$,this.setTexture3D=Y,this.setTextureCube=H,this.rebindTextures=Oe,this.setupRenderTarget=le,this.updateRenderTargetMipmap=ye,this.updateMultisampleRenderTarget=be,this.setupDepthRenderbuffer=Re,this.setupFrameBufferTexture=xe,this.safeSetTexture2D=We,this.safeSetTextureCube=Ze}function OA(i,e,t){let r=t.isWebGL2;function o(n,s=null){let a;if(n===Go)return i.UNSIGNED_BYTE;if(n===xm)return i.UNSIGNED_SHORT_4_4_4_4;if(n===ym)return i.UNSIGNED_SHORT_5_5_5_1;if(n===_m)return i.BYTE;if(n===gm)return i.SHORT;if(n===En)return i.UNSIGNED_SHORT;if(n===vm)return i.INT;if(n===R0)return i.UNSIGNED_INT;if(n===Wt)return i.FLOAT;if(n===zr)return r?i.HALF_FLOAT:(a=e.get("OES_texture_half_float"),a!==null?a.HALF_FLOAT_OES:null);if(n===bm)return i.ALPHA;if(n===st)return i.RGBA;if(n===Dl)return i.LUMINANCE;if(n===Tm)return i.LUMINANCE_ALPHA;if(n===xi)return i.DEPTH_COMPONENT;if(n===Wi)return i.DEPTH_STENCIL;if(n===Am)return i.RED;if(n===Vx)return console.warn("THREE.WebGLRenderer: THREE.RGBFormat has been removed. Use THREE.RGBAFormat instead. https://github.com/mrdoob/three.js/pull/23228"),i.RGBA;if(n===lh)return a=e.get("EXT_sRGB"),a!==null?a.SRGB_ALPHA_EXT:null;if(n===Cm)return i.RED_INTEGER;if(n===Em)return i.RG;if(n===Sm)return i.RG_INTEGER;if(n===wm)return i.RGBA_INTEGER;if(n===Mm||n===Nm||n===Om||n===Pm)if(s===bt)if(a=e.get("WEBGL_compressed_texture_s3tc_srgb"),a!==null){if(n===Mm)return a.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(n===Nm)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(n===Om)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(n===Pm)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(a=e.get("WEBGL_compressed_texture_s3tc"),a!==null){if(n===Mm)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(n===Nm)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(n===Om)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(n===Pm)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(n===P2||n===R2||n===L2||n===I2)if(a=e.get("WEBGL_compressed_texture_pvrtc"),a!==null){if(n===P2)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(n===R2)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(n===L2)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(n===I2)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(n===Gx)return a=e.get("WEBGL_compressed_texture_etc1"),a!==null?a.COMPRESSED_RGB_ETC1_WEBGL:null;if(n===D2||n===k2)if(a=e.get("WEBGL_compressed_texture_etc"),a!==null){if(n===D2)return s===bt?a.COMPRESSED_SRGB8_ETC2:a.COMPRESSED_RGB8_ETC2;if(n===k2)return s===bt?a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(n===B2||n===F2||n===U2||n===V2||n===G2||n===z2||n===H2||n===j2||n===W2||n===q2||n===X2||n===Y2||n===$2||n===K2)if(a=e.get("WEBGL_compressed_texture_astc"),a!==null){if(n===B2)return s===bt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:a.COMPRESSED_RGBA_ASTC_4x4_KHR;if(n===F2)return s===bt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:a.COMPRESSED_RGBA_ASTC_5x4_KHR;if(n===U2)return s===bt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:a.COMPRESSED_RGBA_ASTC_5x5_KHR;if(n===V2)return s===bt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:a.COMPRESSED_RGBA_ASTC_6x5_KHR;if(n===G2)return s===bt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:a.COMPRESSED_RGBA_ASTC_6x6_KHR;if(n===z2)return s===bt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:a.COMPRESSED_RGBA_ASTC_8x5_KHR;if(n===H2)return s===bt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:a.COMPRESSED_RGBA_ASTC_8x6_KHR;if(n===j2)return s===bt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:a.COMPRESSED_RGBA_ASTC_8x8_KHR;if(n===W2)return s===bt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:a.COMPRESSED_RGBA_ASTC_10x5_KHR;if(n===q2)return s===bt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:a.COMPRESSED_RGBA_ASTC_10x6_KHR;if(n===X2)return s===bt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:a.COMPRESSED_RGBA_ASTC_10x8_KHR;if(n===Y2)return s===bt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:a.COMPRESSED_RGBA_ASTC_10x10_KHR;if(n===$2)return s===bt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:a.COMPRESSED_RGBA_ASTC_12x10_KHR;if(n===K2)return s===bt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:a.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(n===J2)if(a=e.get("EXT_texture_compression_bptc"),a!==null){if(n===J2)return s===bt?a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:a.COMPRESSED_RGBA_BPTC_UNORM_EXT}else return null;if(n===ji)return r?i.UNSIGNED_INT_24_8:(a=e.get("WEBGL_depth_texture"),a!==null?a.UNSIGNED_INT_24_8_WEBGL:null)}return{convert:o}}var Xm=class extends ir{constructor(e=[]){super();this.cameras=e}};Xm.prototype.isArrayCamera=!0;var QV={type:"move"},fh=class{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new ut,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new ut,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new w,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new w),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new ut,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new w,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new w),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,r){let o=null,n=null,s=null,a=this._targetRay,c=this._grip,l=this._hand;if(e&&t.session.visibilityState!=="visible-blurred")if(a!==null&&(o=t.getPose(e.targetRaySpace,r),o!==null&&(a.matrix.fromArray(o.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),o.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(o.linearVelocity)):a.hasLinearVelocity=!1,o.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(o.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(QV))),l&&e.hand){s=!0;for(let f of e.hand.values()){let x=t.getJointPose(f,r);if(l.joints[f.jointName]===void 0){let g=new ut;g.matrixAutoUpdate=!1,g.visible=!1,l.joints[f.jointName]=g,l.add(g)}let _=l.joints[f.jointName];x!==null&&(_.matrix.fromArray(x.transform.matrix),_.matrix.decompose(_.position,_.rotation,_.scale),_.jointRadius=x.radius),_.visible=x!==null}let u=l.joints["index-finger-tip"],p=l.joints["thumb-tip"],h=u.position.distanceTo(p.position),d=.02,m=.005;l.inputState.pinching&&h>d+m?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!l.inputState.pinching&&h<=d-m&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else c!==null&&e.gripSpace&&(n=t.getPose(e.gripSpace,r),n!==null&&(c.matrix.fromArray(n.transform.matrix),c.matrix.decompose(c.position,c.rotation,c.scale),n.linearVelocity?(c.hasLinearVelocity=!0,c.linearVelocity.copy(n.linearVelocity)):c.hasLinearVelocity=!1,n.angularVelocity?(c.hasAngularVelocity=!0,c.angularVelocity.copy(n.angularVelocity)):c.hasAngularVelocity=!1));return a!==null&&(a.visible=o!==null),c!==null&&(c.visible=n!==null),l!==null&&(l.visible=s!==null),this}};var mh=class extends gr{constructor(e,t,r,o,n,s,a,c,l,u){if(u=u!==void 0?u:xi,u!==xi&&u!==Wi)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");r===void 0&&u===xi&&(r=En),r===void 0&&u===Wi&&(r=ji);super(null,o,n,s,a,c,u,r,l);this.image={width:e,height:t},this.magFilter=a!==void 0?a:nt,this.minFilter=c!==void 0?c:nt,this.flipY=!1,this.generateMipmaps=!1}};mh.prototype.isDepthTexture=!0;var f3=class extends Ul{constructor(e,t){super();let r=this,o=null,n=1,s=null,a="local-floor",c=e.extensions.has("WEBGL_multisampled_render_to_texture"),l=null,u=null,p=null,h=null,d=!1,m=null,f=t.getContextAttributes(),x=null,_=null,g=[],T=new Map,b=new ir;b.layers.enable(1),b.viewport=new Ie;let y=new ir;y.layers.enable(2),y.viewport=new Ie;let A=[b,y],E=new Xm;E.layers.enable(1),E.layers.enable(2);let S=null,M=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(H){let B=g[H];return B===void 0&&(B=new fh,g[H]=B),B.getTargetRaySpace()},this.getControllerGrip=function(H){let B=g[H];return B===void 0&&(B=new fh,g[H]=B),B.getGripSpace()},this.getHand=function(H){let B=g[H];return B===void 0&&(B=new fh,g[H]=B),B.getHandSpace()};function L(H){let B=T.get(H.inputSource);B&&B.dispatchEvent({type:H.type,data:H.inputSource})}function C(){T.forEach(function(H,B){H.disconnect(B)}),T.clear(),S=null,M=null,e.setRenderTarget(x),h=null,p=null,u=null,o=null,_=null,Y.stop(),r.isPresenting=!1,r.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(H){n=H,r.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(H){a=H,r.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return s},this.getBaseLayer=function(){return p!==null?p:h},this.getBinding=function(){return u},this.getFrame=function(){return m},this.getSession=function(){return o},this.setSession=async function(H){if(o=H,o!==null){if(x=e.getRenderTarget(),o.addEventListener("select",L),o.addEventListener("selectstart",L),o.addEventListener("selectend",L),o.addEventListener("squeeze",L),o.addEventListener("squeezestart",L),o.addEventListener("squeezeend",L),o.addEventListener("end",C),o.addEventListener("inputsourceschange",N),f.xrCompatible!==!0&&await t.makeXRCompatible(),o.renderState.layers===void 0||e.capabilities.isWebGL2===!1){let B={antialias:o.renderState.layers===void 0?f.antialias:!0,alpha:f.alpha,depth:f.depth,stencil:f.stencil,framebufferScaleFactor:n};h=new XRWebGLLayer(o,t,B),o.updateRenderState({baseLayer:h}),_=new vr(h.framebufferWidth,h.framebufferHeight,{format:st,type:Go,encoding:e.outputEncoding})}else{d=f.antialias;let B=null,te=null,q=null;f.depth&&(q=f.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,B=f.stencil?Wi:xi,te=f.stencil?ji:En);let j={colorFormat:e.outputEncoding===bt?t.SRGB8_ALPHA8:t.RGBA8,depthFormat:q,scaleFactor:n};u=new XRWebGLBinding(o,t),p=u.createProjectionLayer(j),o.updateRenderState({layers:[p]}),d?_=new F0(p.textureWidth,p.textureHeight,{format:st,type:Go,depthTexture:new mh(p.textureWidth,p.textureHeight,te,void 0,void 0,void 0,void 0,void 0,void 0,B),stencilBuffer:f.stencil,ignoreDepth:p.ignoreDepthValues,useRenderToTexture:c,encoding:e.outputEncoding}):_=new vr(p.textureWidth,p.textureHeight,{format:st,type:Go,depthTexture:new mh(p.textureWidth,p.textureHeight,te,void 0,void 0,void 0,void 0,void 0,void 0,B),stencilBuffer:f.stencil,ignoreDepth:p.ignoreDepthValues,encoding:e.outputEncoding})}_.isXRRenderTarget=!0,this.setFoveation(1),s=await o.requestReferenceSpace(a),Y.setContext(o),Y.start(),r.isPresenting=!0,r.dispatchEvent({type:"sessionstart"})}};function N(H){let B=o.inputSources;for(let te=0;te<g.length;te++)T.set(B[te],g[te]);for(let te=0;te<H.removed.length;te++){let q=H.removed[te],j=T.get(q);j&&(j.dispatchEvent({type:"disconnected",data:q}),T.delete(q))}for(let te=0;te<H.added.length;te++){let q=H.added[te],j=T.get(q);j&&j.dispatchEvent({type:"connected",data:q})}}let D=new w,k=new w;function z(H,B,te){D.setFromMatrixPosition(B.matrixWorld),k.setFromMatrixPosition(te.matrixWorld);let q=D.distanceTo(k),j=B.projectionMatrix.elements,R=te.projectionMatrix.elements,Ne=j[14]/(j[10]-1),xe=j[14]/(j[10]+1),ae=(j[9]+1)/j[5],Ae=(j[9]-1)/j[5],Re=(j[8]-1)/j[0],Oe=(R[8]+1)/R[0],le=Ne*Re,ye=Ne*Oe,be=q/(-Re+Oe),ie=be*-Re;B.matrixWorld.decompose(H.position,H.quaternion,H.scale),H.translateX(ie),H.translateZ(be),H.matrixWorld.compose(H.position,H.quaternion,H.scale),H.matrixWorldInverse.copy(H.matrixWorld).invert();let de=Ne+be,we=xe+be,Ee=le-ie,Pe=ye+(q-ie),We=ae*xe/we*de,Ze=Ae*xe/we*de;H.projectionMatrix.makePerspective(Ee,Pe,We,Ze,de,we)}function F(H,B){B===null?H.matrixWorld.copy(H.matrix):H.matrixWorld.multiplyMatrices(B.matrixWorld,H.matrix),H.matrixWorldInverse.copy(H.matrixWorld).invert()}this.updateCamera=function(H){if(o===null)return;E.near=y.near=b.near=H.near,E.far=y.far=b.far=H.far,(S!==E.near||M!==E.far)&&(o.updateRenderState({depthNear:E.near,depthFar:E.far}),S=E.near,M=E.far);let B=H.parent,te=E.cameras;F(E,B);for(let j=0;j<te.length;j++)F(te[j],B);E.matrixWorld.decompose(E.position,E.quaternion,E.scale),H.position.copy(E.position),H.quaternion.copy(E.quaternion),H.scale.copy(E.scale),H.matrix.copy(E.matrix),H.matrixWorld.copy(E.matrixWorld);let q=H.children;for(let j=0,R=q.length;j<R;j++)q[j].updateMatrixWorld(!0);te.length===2?z(E,b,y):E.projectionMatrix.copy(b.projectionMatrix)},this.getCamera=function(){return E},this.getFoveation=function(){if(p!==null)return p.fixedFoveation;if(h!==null)return h.fixedFoveation},this.setFoveation=function(H){p!==null&&(p.fixedFoveation=H),h!==null&&h.fixedFoveation!==void 0&&(h.fixedFoveation=H)};let X=null;function $(H,B){if(l=B.getViewerPose(s),m=B,l!==null){let q=l.views;h!==null&&(e.setRenderTargetFramebuffer(_,h.framebuffer),e.setRenderTarget(_));let j=!1;q.length!==E.cameras.length&&(E.cameras.length=0,j=!0);for(let R=0;R<q.length;R++){let Ne=q[R],xe=null;if(h!==null)xe=h.getViewport(Ne);else{let Ae=u.getViewSubImage(p,Ne);xe=Ae.viewport,R===0&&(e.setRenderTargetTextures(_,Ae.colorTexture,p.ignoreDepthValues?void 0:Ae.depthStencilTexture),e.setRenderTarget(_))}let ae=A[R];ae.matrix.fromArray(Ne.transform.matrix),ae.projectionMatrix.fromArray(Ne.projectionMatrix),ae.viewport.set(xe.x,xe.y,xe.width,xe.height),R===0&&E.matrix.copy(ae.matrix),j===!0&&E.cameras.push(ae)}}let te=o.inputSources;for(let q=0;q<g.length;q++){let j=g[q],R=te[q];j.update(R,B,s)}X&&X(H,B),m=null}let Y=new Um;Y.setAnimationLoop($),this.setAnimationLoop=function(H){X=H},this.dispose=function(){}}};function PA(i){function e(_,g){_.fogColor.value.copy(g.color),g.isFog?(_.fogNear.value=g.near,_.fogFar.value=g.far):g.isFogExp2&&(_.fogDensity.value=g.density)}function t(_,g,T,b,y){g.isMeshBasicMaterial?r(_,g):g.isMeshLambertMaterial?(r(_,g),c(_,g)):g.isMeshToonMaterial?(r(_,g),u(_,g)):g.isMeshPhongMaterial?(r(_,g),l(_,g)):g.isMeshStandardMaterial?(r(_,g),g.isMeshPhysicalMaterial?h(_,g,y):p(_,g)):g.isMeshMatcapMaterial?(r(_,g),d(_,g)):g.isMeshDepthMaterial?(r(_,g),m(_,g)):g.isMeshDistanceMaterial?(r(_,g),f(_,g)):g.isMeshNormalMaterial?(r(_,g),x(_,g)):g.isLineBasicMaterial?(o(_,g),g.isLineDashedMaterial&&n(_,g)):g.isPointsMaterial?s(_,g,T,b):g.isSpriteMaterial?a(_,g):g.isShadowMaterial?(_.color.value.copy(g.color),_.opacity.value=g.opacity):g.isShaderMaterial&&(g.uniformsNeedUpdate=!1)}function r(_,g){_.opacity.value=g.opacity,g.color&&_.diffuse.value.copy(g.color),g.emissive&&_.emissive.value.copy(g.emissive).multiplyScalar(g.emissiveIntensity),g.map&&(_.map.value=g.map),g.alphaMap&&(_.alphaMap.value=g.alphaMap),g.specularMap&&(_.specularMap.value=g.specularMap),g.alphaTest>0&&(_.alphaTest.value=g.alphaTest);let T=i.get(g).envMap;T&&(_.envMap.value=T,_.flipEnvMap.value=T.isCubeTexture&&T.isRenderTargetTexture===!1?-1:1,_.reflectivity.value=g.reflectivity,_.ior.value=g.ior,_.refractionRatio.value=g.refractionRatio),g.lightMap&&(_.lightMap.value=g.lightMap,_.lightMapIntensity.value=g.lightMapIntensity),g.aoMap&&(_.aoMap.value=g.aoMap,_.aoMapIntensity.value=g.aoMapIntensity);let b;g.map?b=g.map:g.specularMap?b=g.specularMap:g.displacementMap?b=g.displacementMap:g.normalMap?b=g.normalMap:g.bumpMap?b=g.bumpMap:g.roughnessMap?b=g.roughnessMap:g.metalnessMap?b=g.metalnessMap:g.alphaMap?b=g.alphaMap:g.emissiveMap?b=g.emissiveMap:g.clearcoatMap?b=g.clearcoatMap:g.clearcoatNormalMap?b=g.clearcoatNormalMap:g.clearcoatRoughnessMap?b=g.clearcoatRoughnessMap:g.specularIntensityMap?b=g.specularIntensityMap:g.specularColorMap?b=g.specularColorMap:g.transmissionMap?b=g.transmissionMap:g.thicknessMap?b=g.thicknessMap:g.sheenColorMap?b=g.sheenColorMap:g.sheenRoughnessMap&&(b=g.sheenRoughnessMap),b!==void 0&&(b.isWebGLRenderTarget&&(b=b.texture),b.matrixAutoUpdate===!0&&b.updateMatrix(),_.uvTransform.value.copy(b.matrix));let y;g.aoMap?y=g.aoMap:g.lightMap&&(y=g.lightMap),y!==void 0&&(y.isWebGLRenderTarget&&(y=y.texture),y.matrixAutoUpdate===!0&&y.updateMatrix(),_.uv2Transform.value.copy(y.matrix))}function o(_,g){_.diffuse.value.copy(g.color),_.opacity.value=g.opacity}function n(_,g){_.dashSize.value=g.dashSize,_.totalSize.value=g.dashSize+g.gapSize,_.scale.value=g.scale}function s(_,g,T,b){_.diffuse.value.copy(g.color),_.opacity.value=g.opacity,_.size.value=g.size*T,_.scale.value=b*.5,g.map&&(_.map.value=g.map),g.alphaMap&&(_.alphaMap.value=g.alphaMap),g.alphaTest>0&&(_.alphaTest.value=g.alphaTest);let y;g.map?y=g.map:g.alphaMap&&(y=g.alphaMap),y!==void 0&&(y.matrixAutoUpdate===!0&&y.updateMatrix(),_.uvTransform.value.copy(y.matrix))}function a(_,g){_.diffuse.value.copy(g.color),_.opacity.value=g.opacity,_.rotation.value=g.rotation,g.map&&(_.map.value=g.map),g.alphaMap&&(_.alphaMap.value=g.alphaMap),g.alphaTest>0&&(_.alphaTest.value=g.alphaTest);let T;g.map?T=g.map:g.alphaMap&&(T=g.alphaMap),T!==void 0&&(T.matrixAutoUpdate===!0&&T.updateMatrix(),_.uvTransform.value.copy(T.matrix))}function c(_,g){g.emissiveMap&&(_.emissiveMap.value=g.emissiveMap)}function l(_,g){_.specular.value.copy(g.specular),_.shininess.value=Math.max(g.shininess,1e-4),g.emissiveMap&&(_.emissiveMap.value=g.emissiveMap),g.bumpMap&&(_.bumpMap.value=g.bumpMap,_.bumpScale.value=g.bumpScale,g.side===Dt&&(_.bumpScale.value*=-1)),g.normalMap&&(_.normalMap.value=g.normalMap,_.normalScale.value.copy(g.normalScale),g.side===Dt&&_.normalScale.value.negate()),g.displacementMap&&(_.displacementMap.value=g.displacementMap,_.displacementScale.value=g.displacementScale,_.displacementBias.value=g.displacementBias)}function u(_,g){g.gradientMap&&(_.gradientMap.value=g.gradientMap),g.emissiveMap&&(_.emissiveMap.value=g.emissiveMap),g.bumpMap&&(_.bumpMap.value=g.bumpMap,_.bumpScale.value=g.bumpScale,g.side===Dt&&(_.bumpScale.value*=-1)),g.normalMap&&(_.normalMap.value=g.normalMap,_.normalScale.value.copy(g.normalScale),g.side===Dt&&_.normalScale.value.negate()),g.displacementMap&&(_.displacementMap.value=g.displacementMap,_.displacementScale.value=g.displacementScale,_.displacementBias.value=g.displacementBias)}function p(_,g){_.roughness.value=g.roughness,_.metalness.value=g.metalness,g.roughnessMap&&(_.roughnessMap.value=g.roughnessMap),g.metalnessMap&&(_.metalnessMap.value=g.metalnessMap),g.emissiveMap&&(_.emissiveMap.value=g.emissiveMap),g.bumpMap&&(_.bumpMap.value=g.bumpMap,_.bumpScale.value=g.bumpScale,g.side===Dt&&(_.bumpScale.value*=-1)),g.normalMap&&(_.normalMap.value=g.normalMap,_.normalScale.value.copy(g.normalScale),g.side===Dt&&_.normalScale.value.negate()),g.displacementMap&&(_.displacementMap.value=g.displacementMap,_.displacementScale.value=g.displacementScale,_.displacementBias.value=g.displacementBias),i.get(g).envMap&&(_.envMapIntensity.value=g.envMapIntensity)}function h(_,g,T){p(_,g),_.ior.value=g.ior,g.sheen>0&&(_.sheenColor.value.copy(g.sheenColor).multiplyScalar(g.sheen),_.sheenRoughness.value=g.sheenRoughness,g.sheenColorMap&&(_.sheenColorMap.value=g.sheenColorMap),g.sheenRoughnessMap&&(_.sheenRoughnessMap.value=g.sheenRoughnessMap)),g.clearcoat>0&&(_.clearcoat.value=g.clearcoat,_.clearcoatRoughness.value=g.clearcoatRoughness,g.clearcoatMap&&(_.clearcoatMap.value=g.clearcoatMap),g.clearcoatRoughnessMap&&(_.clearcoatRoughnessMap.value=g.clearcoatRoughnessMap),g.clearcoatNormalMap&&(_.clearcoatNormalScale.value.copy(g.clearcoatNormalScale),_.clearcoatNormalMap.value=g.clearcoatNormalMap,g.side===Dt&&_.clearcoatNormalScale.value.negate())),g.transmission>0&&(_.transmission.value=g.transmission,_.transmissionSamplerMap.value=T.texture,_.transmissionSamplerSize.value.set(T.width,T.height),g.transmissionMap&&(_.transmissionMap.value=g.transmissionMap),_.thickness.value=g.thickness,g.thicknessMap&&(_.thicknessMap.value=g.thicknessMap),_.attenuationDistance.value=g.attenuationDistance,_.attenuationColor.value.copy(g.attenuationColor)),_.specularIntensity.value=g.specularIntensity,_.specularColor.value.copy(g.specularColor),g.specularIntensityMap&&(_.specularIntensityMap.value=g.specularIntensityMap),g.specularColorMap&&(_.specularColorMap.value=g.specularColorMap)}function d(_,g){g.matcap&&(_.matcap.value=g.matcap),g.bumpMap&&(_.bumpMap.value=g.bumpMap,_.bumpScale.value=g.bumpScale,g.side===Dt&&(_.bumpScale.value*=-1)),g.normalMap&&(_.normalMap.value=g.normalMap,_.normalScale.value.copy(g.normalScale),g.side===Dt&&_.normalScale.value.negate()),g.displacementMap&&(_.displacementMap.value=g.displacementMap,_.displacementScale.value=g.displacementScale,_.displacementBias.value=g.displacementBias)}function m(_,g){g.displacementMap&&(_.displacementMap.value=g.displacementMap,_.displacementScale.value=g.displacementScale,_.displacementBias.value=g.displacementBias)}function f(_,g){g.displacementMap&&(_.displacementMap.value=g.displacementMap,_.displacementScale.value=g.displacementScale,_.displacementBias.value=g.displacementBias),_.referencePosition.value.copy(g.referencePosition),_.nearDistance.value=g.nearDistance,_.farDistance.value=g.farDistance}function x(_,g){g.bumpMap&&(_.bumpMap.value=g.bumpMap,_.bumpScale.value=g.bumpScale,g.side===Dt&&(_.bumpScale.value*=-1)),g.normalMap&&(_.normalMap.value=g.normalMap,_.normalScale.value.copy(g.normalScale),g.side===Dt&&_.normalScale.value.negate()),g.displacementMap&&(_.displacementMap.value=g.displacementMap,_.displacementScale.value=g.displacementScale,_.displacementBias.value=g.displacementBias)}return{refreshFogUniforms:e,refreshMaterialUniforms:t}}function eG(){let i=Vl("canvas");return i.style.display="block",i}function m3(i={}){let e=i.canvas!==void 0?i.canvas:eG(),t=i.context!==void 0?i.context:null,r=i.alpha!==void 0?i.alpha:!1,o=i.depth!==void 0?i.depth:!0,n=i.stencil!==void 0?i.stencil:!0,s=i.antialias!==void 0?i.antialias:!1,a=i.premultipliedAlpha!==void 0?i.premultipliedAlpha:!0,c=i.preserveDrawingBuffer!==void 0?i.preserveDrawingBuffer:!1,l=i.powerPreference!==void 0?i.powerPreference:"default",u=i.failIfMajorPerformanceCaveat!==void 0?i.failIfMajorPerformanceCaveat:!1,p=null,h=null,d=[],m=[];this.domElement=e,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=Hr,this.physicallyCorrectLights=!1,this.toneMapping=Oo,this.toneMappingExposure=1;let f=this,x=!1,_=0,g=0,T=null,b=-1,y=null,A=new Ie,E=new Ie,S=null,M=e.width,L=e.height,C=1,N=null,D=null,k=new Ie(0,0,M,L),z=new Ie(0,0,M,L),F=!1,X=new tc,$=!1,Y=!1,H=null,B=new Ve,te=new w,q={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function j(){return T===null?C:1}let R=t;function Ne(P,re){for(let ue=0;ue<P.length;ue++){let ne=P[ue],ge=e.getContext(ne,re);if(ge!==null)return ge}return null}try{let P={alpha:!0,depth:o,stencil:n,antialias:s,premultipliedAlpha:a,preserveDrawingBuffer:c,powerPreference:l,failIfMajorPerformanceCaveat:u};if("setAttribute"in e&&e.setAttribute("data-engine",`three.js r${ux}`),e.addEventListener("webglcontextlost",ke,!1),e.addEventListener("webglcontextrestored",W,!1),R===null){let re=["webgl2","webgl","experimental-webgl"];if(f.isWebGL1Renderer===!0&&re.shift(),R=Ne(re,P),R===null)throw Ne(re)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}R.getShaderPrecisionFormat===void 0&&(R.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(P){throw console.error("THREE.WebGLRenderer: "+P.message),P}let xe,ae,Ae,Re,Oe,le,ye,be,ie,de,we,Ee,Pe,We,Ze,I,O,fe,ee,me,Z,Se,U;function se(){xe=new jT(R),ae=new RT(R,xe,i),xe.init(ae),Se=new OA(R,xe,ae),Ae=new MA(R,xe,ae),Re=new XT(R),Oe=new vA,le=new NA(R,xe,Ae,Oe,ae,Se,Re),ye=new IT(f),be=new HT(f),ie=new ty(R,ae),U=new OT(R,xe,ie,ae),de=new WT(R,ie,Re,U),we=new KT(R,de,ie,Re),ee=new $T(R,ae,le),I=new LT(Oe),Ee=new gA(f,ye,be,xe,ae,U,I),Pe=new PA(Oe),We=new bA,Ze=new CA(xe,ae),fe=new NT(f,ye,Ae,we,r,a),O=new wA(f,we,ae),me=new PT(R,xe,Re,ae),Z=new qT(R,xe,Re,ae),Re.programs=Ee.programs,f.capabilities=ae,f.extensions=xe,f.properties=Oe,f.renderLists=We,f.shadowMap=O,f.state=Ae,f.info=Re}se();let ve=new f3(f,R);this.xr=ve,this.getContext=function(){return R},this.getContextAttributes=function(){return R.getContextAttributes()},this.forceContextLoss=function(){let P=xe.get("WEBGL_lose_context");P&&P.loseContext()},this.forceContextRestore=function(){let P=xe.get("WEBGL_lose_context");P&&P.restoreContext()},this.getPixelRatio=function(){return C},this.setPixelRatio=function(P){P!==void 0&&(C=P,this.setSize(M,L,!1))},this.getSize=function(P){return P.set(M,L)},this.setSize=function(P,re,ue){if(ve.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}M=P,L=re,e.width=Math.floor(P*C),e.height=Math.floor(re*C),ue!==!1&&(e.style.width=P+"px",e.style.height=re+"px"),this.setViewport(0,0,P,re)},this.getDrawingBufferSize=function(P){return P.set(M*C,L*C).floor()},this.setDrawingBufferSize=function(P,re,ue){M=P,L=re,C=ue,e.width=Math.floor(P*ue),e.height=Math.floor(re*ue),this.setViewport(0,0,P,re)},this.getCurrentViewport=function(P){return P.copy(A)},this.getViewport=function(P){return P.copy(k)},this.setViewport=function(P,re,ue,ne){P.isVector4?k.set(P.x,P.y,P.z,P.w):k.set(P,re,ue,ne),Ae.viewport(A.copy(k).multiplyScalar(C).floor())},this.getScissor=function(P){return P.copy(z)},this.setScissor=function(P,re,ue,ne){P.isVector4?z.set(P.x,P.y,P.z,P.w):z.set(P,re,ue,ne),Ae.scissor(E.copy(z).multiplyScalar(C).floor())},this.getScissorTest=function(){return F},this.setScissorTest=function(P){Ae.setScissorTest(F=P)},this.setOpaqueSort=function(P){N=P},this.setTransparentSort=function(P){D=P},this.getClearColor=function(P){return P.copy(fe.getClearColor())},this.setClearColor=function(){fe.setClearColor.apply(fe,arguments)},this.getClearAlpha=function(){return fe.getClearAlpha()},this.setClearAlpha=function(){fe.setClearAlpha.apply(fe,arguments)},this.clear=function(P,re,ue){let ne=0;(P===void 0||P)&&(ne|=R.COLOR_BUFFER_BIT),(re===void 0||re)&&(ne|=R.DEPTH_BUFFER_BIT),(ue===void 0||ue)&&(ne|=R.STENCIL_BUFFER_BIT),R.clear(ne)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",ke,!1),e.removeEventListener("webglcontextrestored",W,!1),We.dispose(),Ze.dispose(),Oe.dispose(),ye.dispose(),be.dispose(),we.dispose(),U.dispose(),Ee.dispose(),ve.dispose(),ve.removeEventListener("sessionstart",tt),ve.removeEventListener("sessionend",or),H&&(H.dispose(),H=null),Mo.stop()};function ke(P){P.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),x=!0}function W(){console.log("THREE.WebGLRenderer: Context Restored."),x=!1;let P=Re.autoReset,re=O.enabled,ue=O.autoUpdate,ne=O.needsUpdate,ge=O.type;se(),Re.autoReset=P,O.enabled=re,O.autoUpdate=ue,O.needsUpdate=ne,O.type=ge}function Le(P){let re=P.target;re.removeEventListener("dispose",Le),Me(re)}function Me(P){Ye(P),Oe.remove(P)}function Ye(P){let re=Oe.get(P).programs;re!==void 0&&(re.forEach(function(ue){Ee.releaseProgram(ue)}),P.isShaderMaterial&&Ee.releaseShaderCache(P))}this.renderBufferDirect=function(P,re,ue,ne,ge,ot){re===null&&(re=q);let it=ge.isMesh&&ge.matrixWorld.determinant()<0,mt=_U(P,re,ue,ne,ge);Ae.setMaterial(ne,it);let ht=ue.index,jt=ue.attributes.position;if(ht===null){if(jt===void 0||jt.count===0)return}else if(ht.count===0)return;let Et=1;ne.wireframe===!0&&(ht=de.getWireframeAttribute(ue),Et=2),U.setup(ge,ne,mt,ue,ht);let Mt,Tr=me;ht!==null&&(Mt=ie.get(ht),Tr=Z,Tr.setIndex(Mt));let $a=ht!==null?ht.count:jt.count,Ol=ue.drawRange.start*Et,It=ue.drawRange.count*Et,is=ot!==null?ot.start*Et:0,Gr=ot!==null?ot.count*Et:1/0,ns=Math.max(Ol,is),cm=Math.min($a,Ol+It,is+Gr)-1,ss=Math.max(0,cm-ns+1);if(ss!==0){if(ge.isMesh)ne.wireframe===!0?(Ae.setLineWidth(ne.wireframeLinewidth*j()),Tr.setMode(R.LINES)):Tr.setMode(R.TRIANGLES);else if(ge.isLine){let Vs=ne.linewidth;Vs===void 0&&(Vs=1),Ae.setLineWidth(Vs*j()),ge.isLineSegments?Tr.setMode(R.LINES):ge.isLineLoop?Tr.setMode(R.LINE_LOOP):Tr.setMode(R.LINE_STRIP)}else ge.isPoints?Tr.setMode(R.POINTS):ge.isSprite&&Tr.setMode(R.TRIANGLES);if(ge.isInstancedMesh)Tr.renderInstances(ns,ss,ge.count);else if(ue.isInstancedBufferGeometry){let Vs=Math.min(ue.instanceCount,ue._maxInstanceCount);Tr.renderInstances(ns,ss,Vs)}else Tr.render(ns,ss)}},this.compile=function(P,re){h=Ze.get(P),h.init(),m.push(h),P.traverseVisible(function(ue){ue.isLight&&ue.layers.test(re.layers)&&(h.pushLight(ue),ue.castShadow&&h.pushShadow(ue))}),h.setupLights(f.physicallyCorrectLights),P.traverse(function(ue){let ne=ue.material;if(ne)if(Array.isArray(ne))for(let ge=0;ge<ne.length;ge++){let ot=ne[ge];E2(ot,P,ue)}else E2(ne,P,ue)}),m.pop(),h=null};let _e=null;function He(P){_e&&_e(P)}function tt(){Mo.stop()}function or(){Mo.start()}let Mo=new Um;Mo.setAnimationLoop(He),typeof window<"u"&&Mo.setContext(window),this.setAnimationLoop=function(P){_e=P,ve.setAnimationLoop(P),P===null?Mo.stop():Mo.start()},ve.addEventListener("sessionstart",tt),ve.addEventListener("sessionend",or),this.render=function(P,re){if(re!==void 0&&re.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(x===!0)return;P.autoUpdate===!0&&P.updateMatrixWorld(),re.parent===null&&re.updateMatrixWorld(),ve.enabled===!0&&ve.isPresenting===!0&&(ve.cameraAutoUpdate===!0&&ve.updateCamera(re),re=ve.getCamera()),P.isScene===!0&&P.onBeforeRender(f,P,re,T),h=Ze.get(P,m.length),h.init(),m.push(h),B.multiplyMatrices(re.projectionMatrix,re.matrixWorldInverse),X.setFromProjectionMatrix(B),Y=this.localClippingEnabled,$=I.init(this.clippingPlanes,Y,re),p=We.get(P,d.length),p.init(),d.push(p),br(P,re,0,f.sortObjects),p.finish(),f.sortObjects===!0&&p.sort(N,D),$===!0&&I.beginShadows();let ue=h.state.shadowsArray;if(O.render(ue,P,re),$===!0&&I.endShadows(),this.info.autoReset===!0&&this.info.reset(),fe.render(p,P),h.setupLights(f.physicallyCorrectLights),re.isArrayCamera){let ne=re.cameras;for(let ge=0,ot=ne.length;ge<ot;ge++){let it=ne[ge];os(p,P,it,it.viewport)}}else os(p,P,re);T!==null&&(le.updateMultisampleRenderTarget(T),le.updateRenderTargetMipmap(T)),P.isScene===!0&&P.onAfterRender(f,P,re),Ae.buffers.depth.setTest(!0),Ae.buffers.depth.setMask(!0),Ae.buffers.color.setMask(!0),Ae.setPolygonOffset(!1),U.resetDefaultState(),b=-1,y=null,m.pop(),m.length>0?h=m[m.length-1]:h=null,d.pop(),d.length>0?p=d[d.length-1]:p=null};function br(P,re,ue,ne){if(P.visible===!1)return;if(P.layers.test(re.layers)){if(P.isGroup)ue=P.renderOrder;else if(P.isLOD)P.autoUpdate===!0&&P.update(re);else if(P.isLight)h.pushLight(P),P.castShadow&&h.pushShadow(P);else if(P.isSprite){if(!P.frustumCulled||X.intersectsSprite(P)){ne&&te.setFromMatrixPosition(P.matrixWorld).applyMatrix4(B);let it=we.update(P),mt=P.material;mt.visible&&p.push(P,it,mt,ue,te.z,null)}}else if((P.isMesh||P.isLine||P.isPoints)&&(P.isSkinnedMesh&&P.skeleton.frame!==Re.render.frame&&(P.skeleton.update(),P.skeleton.frame=Re.render.frame),!P.frustumCulled||X.intersectsObject(P))){ne&&te.setFromMatrixPosition(P.matrixWorld).applyMatrix4(B);let it=we.update(P),mt=P.material;if(Array.isArray(mt)){let ht=it.groups;for(let jt=0,Et=ht.length;jt<Et;jt++){let Mt=ht[jt],Tr=mt[Mt.materialIndex];Tr&&Tr.visible&&p.push(P,it,Tr,ue,te.z,Mt)}}else mt.visible&&p.push(P,it,mt,ue,te.z,null)}}let ot=P.children;for(let it=0,mt=ot.length;it<mt;it++)br(ot[it],re,ue,ne)}function os(P,re,ue,ne){let ge=P.opaque,ot=P.transmissive,it=P.transparent;h.setupLightsView(ue),ot.length>0&&Us(ge,re,ue),ne&&Ae.viewport(A.copy(ne)),ge.length>0&&am(ge,re,ue),ot.length>0&&am(ot,re,ue),it.length>0&&am(it,re,ue)}function Us(P,re,ue){if(H===null){let it=s===!0&&ae.isWebGL2===!0?F0:vr;H=new it(1024,1024,{generateMipmaps:!0,type:Se.convert(zr)!==null?zr:Go,minFilter:Cn,magFilter:nt,wrapS:kt,wrapT:kt,useRenderToTexture:xe.has("WEBGL_multisampled_render_to_texture")})}let ne=f.getRenderTarget();f.setRenderTarget(H),f.clear();let ge=f.toneMapping;f.toneMapping=Oo,am(P,re,ue),f.toneMapping=ge,le.updateMultisampleRenderTarget(H),le.updateRenderTargetMipmap(H),f.setRenderTarget(ne)}function am(P,re,ue){let ne=re.isScene===!0?re.overrideMaterial:null;for(let ge=0,ot=P.length;ge<ot;ge++){let it=P[ge],mt=it.object,ht=it.geometry,jt=ne===null?it.material:ne,Et=it.group;mt.layers.test(ue.layers)&&mU(mt,re,ue,ht,jt,Et)}}function mU(P,re,ue,ne,ge,ot){P.onBeforeRender(f,re,ue,ne,ge,ot),P.modelViewMatrix.multiplyMatrices(ue.matrixWorldInverse,P.matrixWorld),P.normalMatrix.getNormalMatrix(P.modelViewMatrix),ge.onBeforeRender(f,re,ue,ne,P,ot),ge.transparent===!0&&ge.side===uo?(ge.side=Dt,ge.needsUpdate=!0,f.renderBufferDirect(ue,re,ne,ge,P,ot),ge.side=oo,ge.needsUpdate=!0,f.renderBufferDirect(ue,re,ne,ge,P,ot),ge.side=uo):f.renderBufferDirect(ue,re,ne,ge,P,ot),P.onAfterRender(f,re,ue,ne,ge,ot)}function E2(P,re,ue){re.isScene!==!0&&(re=q);let ne=Oe.get(P),ge=h.state.lights,ot=h.state.shadowsArray,it=ge.state.version,mt=Ee.getParameters(P,ge.state,ot,re,ue),ht=Ee.getProgramCacheKey(mt),jt=ne.programs;ne.environment=P.isMeshStandardMaterial?re.environment:null,ne.fog=re.fog,ne.envMap=(P.isMeshStandardMaterial?be:ye).get(P.envMap||ne.environment),jt===void 0&&(P.addEventListener("dispose",Le),jt=new Map,ne.programs=jt);let Et=jt.get(ht);if(Et!==void 0){if(ne.currentProgram===Et&&ne.lightsStateVersion===it)return cx(P,mt),Et}else mt.uniforms=Ee.getUniforms(P),P.onBuild(ue,mt,f),P.onBeforeCompile(mt,f),Et=Ee.acquireProgram(mt,ht),jt.set(ht,Et),ne.uniforms=mt.uniforms;let Mt=ne.uniforms;(!P.isShaderMaterial&&!P.isRawShaderMaterial||P.clipping===!0)&&(Mt.clippingPlanes=I.uniform),cx(P,mt),ne.needsLights=vU(P),ne.lightsStateVersion=it,ne.needsLights&&(Mt.ambientLightColor.value=ge.state.ambient,Mt.lightProbe.value=ge.state.probe,Mt.directionalLights.value=ge.state.directional,Mt.directionalLightShadows.value=ge.state.directionalShadow,Mt.spotLights.value=ge.state.spot,Mt.spotLightShadows.value=ge.state.spotShadow,Mt.rectAreaLights.value=ge.state.rectArea,Mt.ltc_1.value=ge.state.rectAreaLTC1,Mt.ltc_2.value=ge.state.rectAreaLTC2,Mt.pointLights.value=ge.state.point,Mt.pointLightShadows.value=ge.state.pointShadow,Mt.hemisphereLights.value=ge.state.hemi,Mt.directionalShadowMap.value=ge.state.directionalShadowMap,Mt.directionalShadowMatrix.value=ge.state.directionalShadowMatrix,Mt.spotShadowMap.value=ge.state.spotShadowMap,Mt.spotShadowMatrix.value=ge.state.spotShadowMatrix,Mt.pointShadowMap.value=ge.state.pointShadowMap,Mt.pointShadowMatrix.value=ge.state.pointShadowMatrix);let Tr=Et.getUniforms(),$a=ds.seqWithValue(Tr.seq,Mt);return ne.currentProgram=Et,ne.uniformsList=$a,Et}function cx(P,re){let ue=Oe.get(P);ue.outputEncoding=re.outputEncoding,ue.instancing=re.instancing,ue.skinning=re.skinning,ue.morphTargets=re.morphTargets,ue.morphNormals=re.morphNormals,ue.morphTargetsCount=re.morphTargetsCount,ue.numClippingPlanes=re.numClippingPlanes,ue.numIntersection=re.numClipIntersection,ue.vertexAlphas=re.vertexAlphas,ue.vertexTangents=re.vertexTangents,ue.toneMapping=re.toneMapping}function _U(P,re,ue,ne,ge){re.isScene!==!0&&(re=q),le.resetTextureUnits();let ot=re.fog,it=ne.isMeshStandardMaterial?re.environment:null,mt=T===null?f.outputEncoding:T.isXRRenderTarget===!0?T.texture.encoding:Hr,ht=(ne.isMeshStandardMaterial?be:ye).get(ne.envMap||it),jt=ne.vertexColors===!0&&!!ue.attributes.color&&ue.attributes.color.itemSize===4,Et=!!ne.normalMap&&!!ue.attributes.tangent,Mt=!!ue.morphAttributes.position,Tr=!!ue.morphAttributes.normal,$a=ue.morphAttributes.position?ue.morphAttributes.position.length:0,Ol=ne.toneMapped?f.toneMapping:Oo,It=Oe.get(ne),is=h.state.lights;if($===!0&&(Y===!0||P!==y)){let yn=P===y&&ne.id===b;I.setState(ne,P,yn)}let Gr=!1;ne.version===It.__version?(It.needsLights&&It.lightsStateVersion!==is.state.version||It.outputEncoding!==mt||ge.isInstancedMesh&&It.instancing===!1||!ge.isInstancedMesh&&It.instancing===!0||ge.isSkinnedMesh&&It.skinning===!1||!ge.isSkinnedMesh&&It.skinning===!0||It.envMap!==ht||ne.fog&&It.fog!==ot||It.numClippingPlanes!==void 0&&(It.numClippingPlanes!==I.numPlanes||It.numIntersection!==I.numIntersection)||It.vertexAlphas!==jt||It.vertexTangents!==Et||It.morphTargets!==Mt||It.morphNormals!==Tr||It.toneMapping!==Ol||ae.isWebGL2===!0&&It.morphTargetsCount!==$a)&&(Gr=!0):(Gr=!0,It.__version=ne.version);let ns=It.currentProgram;Gr===!0&&(ns=E2(ne,re,ge));let cm=!1,ss=!1,Vs=!1,No=ns.getUniforms(),nh=It.uniforms;if(Ae.useProgram(ns.program)&&(cm=!0,ss=!0,Vs=!0),ne.id!==b&&(b=ne.id,ss=!0),cm||y!==P){if(No.setValue(R,"projectionMatrix",P.projectionMatrix),ae.logarithmicDepthBuffer&&No.setValue(R,"logDepthBufFC",2/(Math.log(P.far+1)/Math.LN2)),y!==P&&(y=P,ss=!0,Vs=!0),ne.isShaderMaterial||ne.isMeshPhongMaterial||ne.isMeshToonMaterial||ne.isMeshStandardMaterial||ne.envMap){let yn=No.map.cameraPosition;yn!==void 0&&yn.setValue(R,te.setFromMatrixPosition(P.matrixWorld))}(ne.isMeshPhongMaterial||ne.isMeshToonMaterial||ne.isMeshLambertMaterial||ne.isMeshBasicMaterial||ne.isMeshStandardMaterial||ne.isShaderMaterial)&&No.setValue(R,"isOrthographic",P.isOrthographicCamera===!0),(ne.isMeshPhongMaterial||ne.isMeshToonMaterial||ne.isMeshLambertMaterial||ne.isMeshBasicMaterial||ne.isMeshStandardMaterial||ne.isShaderMaterial||ne.isShadowMaterial||ge.isSkinnedMesh)&&No.setValue(R,"viewMatrix",P.matrixWorldInverse)}if(ge.isSkinnedMesh){No.setOptional(R,ge,"bindMatrix"),No.setOptional(R,ge,"bindMatrixInverse");let yn=ge.skeleton;yn&&(ae.floatVertexTextures?(yn.boneTexture===null&&yn.computeBoneTexture(),No.setValue(R,"boneTexture",yn.boneTexture,le),No.setValue(R,"boneTextureSize",yn.boneTextureSize)):No.setOptional(R,yn,"boneMatrices"))}return!!ue&&(ue.morphAttributes.position!==void 0||ue.morphAttributes.normal!==void 0)&&ee.update(ge,ue,ne,ns),(ss||It.receiveShadow!==ge.receiveShadow)&&(It.receiveShadow=ge.receiveShadow,No.setValue(R,"receiveShadow",ge.receiveShadow)),ss&&(No.setValue(R,"toneMappingExposure",f.toneMappingExposure),It.needsLights&&gU(nh,Vs),ot&&ne.fog&&Pe.refreshFogUniforms(nh,ot),Pe.refreshMaterialUniforms(nh,ne,C,L,H),ds.upload(R,It.uniformsList,nh,le)),ne.isShaderMaterial&&ne.uniformsNeedUpdate===!0&&(ds.upload(R,It.uniformsList,nh,le),ne.uniformsNeedUpdate=!1),ne.isSpriteMaterial&&No.setValue(R,"center",ge.center),No.setValue(R,"modelViewMatrix",ge.modelViewMatrix),No.setValue(R,"normalMatrix",ge.normalMatrix),No.setValue(R,"modelMatrix",ge.matrixWorld),ns}function gU(P,re){P.ambientLightColor.needsUpdate=re,P.lightProbe.needsUpdate=re,P.directionalLights.needsUpdate=re,P.directionalLightShadows.needsUpdate=re,P.pointLights.needsUpdate=re,P.pointLightShadows.needsUpdate=re,P.spotLights.needsUpdate=re,P.spotLightShadows.needsUpdate=re,P.rectAreaLights.needsUpdate=re,P.hemisphereLights.needsUpdate=re}function vU(P){return P.isMeshLambertMaterial||P.isMeshToonMaterial||P.isMeshPhongMaterial||P.isMeshStandardMaterial||P.isShadowMaterial||P.isShaderMaterial&&P.lights===!0}this.getActiveCubeFace=function(){return _},this.getActiveMipmapLevel=function(){return g},this.getRenderTarget=function(){return T},this.setRenderTargetTextures=function(P,re,ue){Oe.get(P.texture).__webglTexture=re,Oe.get(P.depthTexture).__webglTexture=ue;let ne=Oe.get(P);ne.__hasExternalTextures=!0,ne.__hasExternalTextures&&(ne.__autoAllocateDepthBuffer=ue===void 0,ne.__autoAllocateDepthBuffer||P.useRenderToTexture&&(console.warn("render-to-texture extension was disabled because an external texture was provided"),P.useRenderToTexture=!1,P.useRenderbuffer=!0))},this.setRenderTargetFramebuffer=function(P,re){let ue=Oe.get(P);ue.__webglFramebuffer=re,ue.__useDefaultFramebuffer=re===void 0},this.setRenderTarget=function(P,re=0,ue=0){T=P,_=re,g=ue;let ne=!0;if(P){let ht=Oe.get(P);ht.__useDefaultFramebuffer!==void 0?(Ae.bindFramebuffer(R.FRAMEBUFFER,null),ne=!1):ht.__webglFramebuffer===void 0?le.setupRenderTarget(P):ht.__hasExternalTextures&&le.rebindTextures(P,Oe.get(P.texture).__webglTexture,Oe.get(P.depthTexture).__webglTexture)}let ge=null,ot=!1,it=!1;if(P){let ht=P.texture;(ht.isDataTexture3D||ht.isDataTexture2DArray)&&(it=!0);let jt=Oe.get(P).__webglFramebuffer;P.isWebGLCubeRenderTarget?(ge=jt[re],ot=!0):P.useRenderbuffer?ge=Oe.get(P).__webglMultisampledFramebuffer:ge=jt,A.copy(P.viewport),E.copy(P.scissor),S=P.scissorTest}else A.copy(k).multiplyScalar(C).floor(),E.copy(z).multiplyScalar(C).floor(),S=F;if(Ae.bindFramebuffer(R.FRAMEBUFFER,ge)&&ae.drawBuffers&&ne&&Ae.drawBuffers(P,ge),Ae.viewport(A),Ae.scissor(E),Ae.setScissorTest(S),ot){let ht=Oe.get(P.texture);R.framebufferTexture2D(R.FRAMEBUFFER,R.COLOR_ATTACHMENT0,R.TEXTURE_CUBE_MAP_POSITIVE_X+re,ht.__webglTexture,ue)}else if(it){let ht=Oe.get(P.texture),jt=re||0;R.framebufferTextureLayer(R.FRAMEBUFFER,R.COLOR_ATTACHMENT0,ht.__webglTexture,ue||0,jt)}b=-1},this.readRenderTargetPixels=function(P,re,ue,ne,ge,ot,it){if(!(P&&P.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let mt=Oe.get(P).__webglFramebuffer;if(P.isWebGLCubeRenderTarget&&it!==void 0&&(mt=mt[it]),mt){Ae.bindFramebuffer(R.FRAMEBUFFER,mt);try{let ht=P.texture,jt=ht.format,Et=ht.type;if(jt!==st&&Se.convert(jt)!==R.getParameter(R.IMPLEMENTATION_COLOR_READ_FORMAT)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}let Mt=Et===zr&&(xe.has("EXT_color_buffer_half_float")||ae.isWebGL2&&xe.has("EXT_color_buffer_float"));if(Et!==Go&&Se.convert(Et)!==R.getParameter(R.IMPLEMENTATION_COLOR_READ_TYPE)&&!(Et===Wt&&(ae.isWebGL2||xe.has("OES_texture_float")||xe.has("WEBGL_color_buffer_float")))&&!Mt){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}R.checkFramebufferStatus(R.FRAMEBUFFER)===R.FRAMEBUFFER_COMPLETE?re>=0&&re<=P.width-ne&&ue>=0&&ue<=P.height-ge&&R.readPixels(re,ue,ne,ge,Se.convert(jt),Se.convert(Et),ot):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{let ht=T!==null?Oe.get(T).__webglFramebuffer:null;Ae.bindFramebuffer(R.FRAMEBUFFER,ht)}}},this.copyFramebufferToTexture=function(P,re,ue=0){if(re.isFramebufferTexture!==!0){console.error("THREE.WebGLRenderer: copyFramebufferToTexture() can only be used with FramebufferTexture.");return}let ne=Math.pow(2,-ue),ge=Math.floor(re.image.width*ne),ot=Math.floor(re.image.height*ne);le.setTexture2D(re,0),R.copyTexSubImage2D(R.TEXTURE_2D,ue,0,0,P.x,P.y,ge,ot),Ae.unbindTexture()},this.copyTextureToTexture=function(P,re,ue,ne=0){let ge=re.image.width,ot=re.image.height,it=Se.convert(ue.format),mt=Se.convert(ue.type);le.setTexture2D(ue,0),R.pixelStorei(R.UNPACK_FLIP_Y_WEBGL,ue.flipY),R.pixelStorei(R.UNPACK_PREMULTIPLY_ALPHA_WEBGL,ue.premultiplyAlpha),R.pixelStorei(R.UNPACK_ALIGNMENT,ue.unpackAlignment),re.isDataTexture?R.texSubImage2D(R.TEXTURE_2D,ne,P.x,P.y,ge,ot,it,mt,re.image.data):re.isCompressedTexture?R.compressedTexSubImage2D(R.TEXTURE_2D,ne,P.x,P.y,re.mipmaps[0].width,re.mipmaps[0].height,it,re.mipmaps[0].data):R.texSubImage2D(R.TEXTURE_2D,ne,P.x,P.y,it,mt,re.image),ne===0&&ue.generateMipmaps&&R.generateMipmap(R.TEXTURE_2D),Ae.unbindTexture()},this.copyTextureToTexture3D=function(P,re,ue,ne,ge=0){if(f.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}let ot=P.max.x-P.min.x+1,it=P.max.y-P.min.y+1,mt=P.max.z-P.min.z+1,ht=Se.convert(ne.format),jt=Se.convert(ne.type),Et;if(ne.isDataTexture3D)le.setTexture3D(ne,0),Et=R.TEXTURE_3D;else if(ne.isDataTexture2DArray)le.setTexture2DArray(ne,0),Et=R.TEXTURE_2D_ARRAY;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}R.pixelStorei(R.UNPACK_FLIP_Y_WEBGL,ne.flipY),R.pixelStorei(R.UNPACK_PREMULTIPLY_ALPHA_WEBGL,ne.premultiplyAlpha),R.pixelStorei(R.UNPACK_ALIGNMENT,ne.unpackAlignment);let Mt=R.getParameter(R.UNPACK_ROW_LENGTH),Tr=R.getParameter(R.UNPACK_IMAGE_HEIGHT),$a=R.getParameter(R.UNPACK_SKIP_PIXELS),Ol=R.getParameter(R.UNPACK_SKIP_ROWS),It=R.getParameter(R.UNPACK_SKIP_IMAGES),is=ue.isCompressedTexture?ue.mipmaps[0]:ue.image;R.pixelStorei(R.UNPACK_ROW_LENGTH,is.width),R.pixelStorei(R.UNPACK_IMAGE_HEIGHT,is.height),R.pixelStorei(R.UNPACK_SKIP_PIXELS,P.min.x),R.pixelStorei(R.UNPACK_SKIP_ROWS,P.min.y),R.pixelStorei(R.UNPACK_SKIP_IMAGES,P.min.z),ue.isDataTexture||ue.isDataTexture3D?R.texSubImage3D(Et,ge,re.x,re.y,re.z,ot,it,mt,ht,jt,is.data):ue.isCompressedTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),R.compressedTexSubImage3D(Et,ge,re.x,re.y,re.z,ot,it,mt,ht,is.data)):R.texSubImage3D(Et,ge,re.x,re.y,re.z,ot,it,mt,ht,jt,is),R.pixelStorei(R.UNPACK_ROW_LENGTH,Mt),R.pixelStorei(R.UNPACK_IMAGE_HEIGHT,Tr),R.pixelStorei(R.UNPACK_SKIP_PIXELS,$a),R.pixelStorei(R.UNPACK_SKIP_ROWS,Ol),R.pixelStorei(R.UNPACK_SKIP_IMAGES,It),ge===0&&ne.generateMipmaps&&R.generateMipmap(Et),Ae.unbindTexture()},this.initTexture=function(P){le.setTexture2D(P,0),Ae.unbindTexture()},this.resetState=function(){_=0,g=0,T=null,Ae.reset(),U.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}m3.prototype.isWebGLRenderer=!0;var RA={};var _3=class{constructor(){this._next_renderer_id=0,this._renderers=new Map,this._firstRenderer=null,this._printDebug=!1,this._require_webgl2=!1,this._resolves=[]}setPrintDebug(e=!0){this._printDebug=e}printDebug(){return this._printDebug}printDebugMessage(e){!this._printDebug||console.warn("[Poly debug]",e)}setRequireWebGL2(){this._require_webgl2||(this._require_webgl2=!0)}webgl2Available(){return this._webgl2_available===void 0&&(this._webgl2_available=this._set_webgl2_available()),this._webgl2_available}_set_webgl2_available(){let e=document.createElement("canvas");return(window.WebGL2RenderingContext&&e.getContext("webgl2"))!=null}createWebGLRenderer(e){let t=new m3(e);return this.printDebugMessage(["create renderer:",e]),t}getRenderingContext(e){let t=null;return this._require_webgl2&&(t=this._getRenderingContextWebgl(e,!0),t||console.warn("failed to create webgl2 context")),t||(t=this._getRenderingContextWebgl(e,!1)),t}_getRenderingContextWebgl(e,t){let r;this.webgl2Available()?r="webgl2":r=t?"webgl2":"webgl";let o=e.getContext(r,RA);return o?this.printDebugMessage(`create gl context: ${r}.`):(r=t?"experimental-webgl2":"experimental-webgl",this.printDebugMessage(`create gl context: ${r}.`),o=e.getContext(r,RA)),o}registerRenderer(e){if(e._polygonId)throw new Error("render already registered");let t=this._next_renderer_id+=1;e._polygonId=t,this._renderers.set(t,e),this._renderers.size==1&&this._flushCallbacksWithRenderer(e),this._updateCache()}deregisterRenderer(e){let t=e._polygonId;this._renderers.delete(t),e.dispose(),this._updateCache()}deregisterAllRenderers(){let e=[];this._renderers.forEach((t,r)=>{e.push(t)});for(let t of e)this.deregisterRenderer(t)}_updateCache(){this._firstRenderer=null,this._renderers.forEach(e=>{this._firstRenderer=this._firstRenderer||e})}firstRenderer(){return this._firstRenderer}renderers(){return Object.values(this._renderers)}_flushCallbacksWithRenderer(e){let t=[];for(let r of this._resolves)t.push(r);this._resolves=[];for(let r of t)r(e)}async waitForRenderer(){let e=this.firstRenderer();return e||new Promise((t,r)=>{this._resolves.push(t)})}renderTarget(e,t,r){return this.webgl2Available()?new F0(e,t,r):new vr(e,t,r)}};var g3=class{constructor(){this._root="/three/js/libs",this._KTX2Path="/ktx2",this._DRACOPath="/draco",this._DRACOGLTFPath="/draco/gltf"}root(){return this._root}setRoot(e){this._root=e}KTX2Path(){return this._KTX2Path}DRACOPath(){return this._DRACOPath}DRACOGLTFPath(){return this._DRACOGLTFPath}};var Sn=class{constructor(e){this.poly=e,this._node_register=new Map,this._node_register_categories=new Map,this._node_register_options=new Map}static type(e){return this.filterType(e.type())}static filterType(e){return e.toLowerCase()}register(e,t,r){let o=e.context(),n=Sn.type(e),s=this._node_register.get(o);if(s||(s=new Map,this._node_register.set(o,s)),s.get(n)){console.error(`node ${o}/${n} already registered`);return}if(s.set(n,e),t){let c=this._node_register_categories.get(o);c||(c=new Map,this._node_register_categories.set(o,c)),c.set(n,t)}if(r){let c=this._node_register_options.get(o);c||(c=new Map,this._node_register_options.set(o,c)),c.set(n,r)}this.poly.pluginsRegister.registerNode(e)}deregister(e,t){var r,o,n;t=Sn.filterType(t),(r=this._node_register.get(e))==null||r.delete(t),(o=this._node_register_categories.get(e))==null||o.delete(t),(n=this._node_register_options.get(e))==null||n.delete(t)}isRegistered(e,t){let r=this._node_register.get(e);return r?(t=Sn.filterType(t),r.get(t)!=null):!1}nodeOptions(e,t){var r;return t=Sn.filterType(t),(r=this._node_register_options.get(e))==null?void 0:r.get(t)}registeredNodesForContextAndParentType(e,t){var r;if(this._node_register.get(e)){let n=[];return(r=this._node_register.get(e))==null||r.forEach((s,a)=>{n.push(s)}),n.filter(s=>{var a;let c=Sn.type(s),l=(a=this._node_register_options.get(e))==null?void 0:a.get(c);if(l){let u=l.only,p=l.except,h=`${e}/${t}`;return u?u.includes(h):p?!p.includes(h):!0}else return!0})}else return[]}registeredNodes(e,t){let r={},o=this.registeredNodesForContextAndParentType(e,t);for(let n of o){let s=Sn.type(n);r[s]=n}return r}registeredCategory(e,t){var r;return t=Sn.filterType(t),(r=this._node_register_categories.get(e))==null?void 0:r.get(t)}map(){return this._node_register}},Ql=class{constructor(e){this.poly=e,this._operation_register=new Map}static type(e){return this.filterType(e.type())}static filterType(e){return e.toLowerCase()}register(e){let t=e.context(),r=this._operation_register.get(t);r||(r=new Map,this._operation_register.set(t,r));let o=Ql.type(e);if(r.get(o)){let s=`operation ${t}/${o} already registered`;console.error(s);return}r.set(o,e),this.poly.pluginsRegister.registerOperation(e)}registeredOperationsForContextAndParentType(e,t){var r;if(this._operation_register.get(e)){let n=[];return(r=this._operation_register.get(e))==null||r.forEach((s,a)=>{n.push(s)}),n}else return[]}registeredOperation(e,t){let r=this._operation_register.get(e);if(r)return t=Ql.filterType(t),r.get(t)}};var v3=class{constructor(){this._methods_names=[],this._methods_by_name=new Map}register(e,t){this._methods_names.push(t),this._methods_by_name.set(t,e)}getMethod(e){return this._methods_by_name.get(e)}availableMethods(){return this._methods_names}};var x3=class extends v3{getMethod(e){return super.getMethod(e)}};var y3=class{constructor(){this._module_by_name=new Map}register(e,t){this._module_by_name.set(e,t)}moduleNames(){let e=[];return this._module_by_name.forEach((t,r)=>{e.push(r)}),e}module(e){return this._module_by_name.get(e)}};var b3=class extends y3{};var Ai=(i=>(i.GL_MESH_BASIC="GL_MESH_BASIC",i.GL_MESH_LAMBERT="GL_MESH_LAMBERT",i.GL_MESH_STANDARD="GL_MESH_STANDARD",i.GL_MESH_PHONG="GL_MESH_PHONG",i.GL_MESH_PHYSICAL="GL_MESH_PHYSICAL",i.GL_MESH_DEPTH="GL_MESH_DEPTH",i.GL_MESH_DISTANCE="GL_MESH_DISTANCE",i.GL_PARTICLES="GL_PARTICLES",i.GL_POINTS="GL_POINTS",i.GL_LINE="GL_LINE",i.GL_TEXTURE="GL_TEXTURE",i.GL_VOLUME="GL_VOLUME",i))(Ai||{}),T3=class{constructor(){this._controllerAssemblerByName=new Map}register(e,t,r){this._controllerAssemblerByName.set(e,{controller:t,assembler:r})}unregister(e){this._controllerAssemblerByName.delete(e)}traverse(e){this._controllerAssemblerByName.forEach(e)}};var A3=class extends T3{assembler(e,t){let r=this._controllerAssemblerByName.get(t);if(r){let o=r.controller,n=r.assembler;return new o(e,n)}return r}unregister(e){let t=this._controllerAssemblerByName.get(e);return super.unregister(e),t}};var C3=class{constructor(e){this.poly=e,this._plugins_by_name=new Map,this._plugin_name_by_node_context_by_type=new Map,this._plugin_name_by_operation_context_by_type=new Map}register(e){this._current_plugin=e,this._plugins_by_name.set(e.name(),e),e.init(this.poly),this._current_plugin=void 0}pluginByName(e){return this._plugins_by_name.get(e)}registerNode(e){if(!this._current_plugin)return;let t=e.context(),r=e.type(),o=this._plugin_name_by_node_context_by_type.get(t);o||(o=new Map,this._plugin_name_by_node_context_by_type.set(t,o)),o.set(r,this._current_plugin.name())}registerOperation(e){if(!this._current_plugin)return;let t=e.context(),r=e.type(),o=this._plugin_name_by_operation_context_by_type.get(t);o||(o=new Map,this._plugin_name_by_operation_context_by_type.set(t,o)),o.set(r,this._current_plugin.name())}toJson(){let e={plugins:{},nodes:{},operations:{}};return this._plugins_by_name.forEach((t,r)=>{e.plugins[r]=t.toJSON()}),this._plugin_name_by_node_context_by_type.forEach((t,r)=>{e.nodes[r]={},t.forEach((o,n)=>{e.nodes[r][n]=o})}),this._plugin_name_by_operation_context_by_type.forEach((t,r)=>{e.operations[r]={},t.forEach((o,n)=>{e.operations[r][n]=o})}),e}};var E3=class{constructor(e){this._camera_types=[]}register(e){let t=e.type();this._camera_types.includes(t)||this._camera_types.push(t)}registeredTypes(){return this._camera_types}};function LA(i){return(window.URL||window.webkitURL).createObjectURL(i)}var S3=class{constructor(){this._blobWrappersByUrl=new Map}recording(){return!Q.playerMode()}blobUrl(e){var t;return(t=this._blobWrappersByUrl.get(e))==null?void 0:t.blobUrl}clear(){this._blobWrappersByUrl.clear()}clearBlobsForNode(e){let t=[],r=e.graphNodeId();this._blobWrappersByUrl.forEach((o,n)=>{o.referringNodeIds.has(r)&&t.push(n)});for(let o of t){let n=this._blobWrappersByUrl.get(o);n&&(n.referringNodeIds.size==1?this._blobWrappersByUrl.delete(o):n.referringNodeIds.delete(r))}}_assignBlobToNode(e,t,r,o={}){o.multiAssetsForNode!=!0&&this.clearBlobsForNode(t);let n=this._blobWrappersByUrl.get(e);n?n.referringNodeIds.add(t.graphNodeId()):this._blobWrappersByUrl.set(e,r)}async fetchBlobGlobal(e){if(!this.recording())return{};try{let t=this._blobWrappersByUrl.get(e);if(t)return{blobWrapper:t};let r=Q.assetUrls.remapedUrl(e)||e,o=await fetch(r);if(o.ok){let n=await o.blob(),s={blob:n,blobUrl:this._createBlobUrl(n),referringNodeIds:new Set};return this._blobWrappersByUrl.set(e,s),{blobWrapper:s}}else return{error:`failed to fetch ${r}`}}catch{return{error:`failed to fetch ${e}`}}}async fetchBlobForNode(e){if(!this.recording())return{};try{let t=e.node.graphNodeId(),r=this._blobWrappersByUrl.get(e.fullUrl);if(r)return r.referringNodeIds.add(t),{blobWrapper:r};let o=Q.assetUrls.remapedUrl(e.fullUrl)||e.fullUrl,n=await fetch(o);if(n.ok){let s=await n.blob(),a=new Set;a.add(t);let c={blob:s,blobUrl:this._createBlobUrl(s),referringNodeIds:a};return this._assignBlobToNode(e.fullUrl,e.node,c,{multiAssetsForNode:e.multiAssetsForNode}),{blobWrapper:c}}else return{error:`failed to fetch ${e.fullUrl}`}}catch{return{error:`failed to fetch ${e.fullUrl}`}}}traverse(e){let t=(r,o)=>{let n=[];this._blobWrappersByUrl.forEach((s,a)=>{s.referringNodeIds.size==0==r&&n.push(a)}),n.sort();for(let s of n){let a=this._blobWrappersByUrl.get(s);a&&o({url:s,blobWrapper:a})}};t(!0,e),t(!1,e)}_createBlobUrl(e){return LA(e)}assetsManifestWithBlobsMap(){let e={},t=new Map,r=[],o=[];this.traverse(n=>{r.push(n.blobWrapper.blob);let s=n.url;o.push(s)});for(let n=0;n<r.length;n++){let s=o[n],a=r[n],c=s.split("?")[0],l=s.split("."),u=l[l.length-1],p=`${n}.${u}`,h=`assets/${p}`;t.set(h,a),e[c]=p}return{manifest:e,blobsMap:t}}};var w3=class{setMap(e){this._map=e}remapedUrl(e){if(!this._map)return;let t=e.split("?"),r=t[0],o=t[1],n=this._map[r];if(n)return o?`${n}?${o}`:n}};var M3=class{setPerformanceManager(e){this._performanceManager=e}performanceManager(){return this._performanceManager||window.performance}};var Ym=class{constructor(){this.renderersController=new _3,this.nodesRegister=new Sn(this),this.operationsRegister=new Ql(this),this.expressionsRegister=new x3,this.modulesRegister=new b3,this.assemblersRegister=new A3,this.pluginsRegister=new C3(this),this.camerasRegister=new E3(this),this.blobs=new S3,this.assetUrls=new w3,this.performance=new M3,this.scenesByUuid={},this._player_mode=!0,this._logger=null}static _instance_(){if(window.__POLYGONJS_POLY_INSTANCE__)return window.__POLYGONJS_POLY_INSTANCE__;{let e=new Ym;return window.__POLYGONJS_POLY_INSTANCE__=e,window.__POLYGONJS_POLY_INSTANCE__}}setPlayerMode(e){this._player_mode=e}playerMode(){return this._player_mode}registerNode(e,t,r){this.nodesRegister.register(e,t,r)}registerOperation(e){this.operationsRegister.register(e)}registerCamera(e){this.camerasRegister.register(e)}registerPlugin(e){this.pluginsRegister.register(e)}registeredNodes(e,t){return this.nodesRegister.registeredNodes(e,t)}registeredOperation(e,t){return this.operationsRegister.registeredOperation(e,t)}registeredCameraTypes(){return this.camerasRegister.registeredTypes()}registerModule(e){this.modulesRegister.register(e.moduleName,e.module)}inWorkerThread(){return!1}get libs(){return this._libs_controller=this._libs_controller||new g3}setEnv(e){this._env=e}env(){return this._env}setLogger(e){this._logger=e}log(e,...t){var r;(r=this._logger)==null||r.log(e,...t)}warn(e,...t){var r;(r=this._logger)==null||r.warn(e,...t)}error(e,...t){var r;(r=this._logger)==null||r.error(e,...t)}},Q=Ym._instance_();var N3=class{constructor(e){this.node=e,this._dirtyCount=0,this._dirty=!0}dispose(){this._cachedSuccessors=void 0,this._postDirtyHooks=void 0,this._postDirtyHookNames=void 0}isDirty(){return this._dirty===!0}dirtyTimestamp(){return this._dirtyTimestamp}dirtyCount(){return this._dirtyCount}addPostDirtyHook(e,t){this._postDirtyHookNames=this._postDirtyHookNames||[],this._postDirtyHooks=this._postDirtyHooks||[],this._postDirtyHookNames.includes(e)?console.warn(`hook with name ${e} already exists`,this.node):(this._postDirtyHookNames.push(e),this._postDirtyHooks.push(t))}removePostDirtyHook(e){if(this._postDirtyHookNames&&this._postDirtyHooks){let t=this._postDirtyHookNames.indexOf(e);t>=0&&(this._postDirtyHookNames.splice(t,1),this._postDirtyHooks.splice(t,1))}}hasHook(e){return this._postDirtyHookNames?this._postDirtyHookNames.includes(e):!1}removeDirtyState(){this._dirty=!1}setForbiddenTriggerNodes(e){this._forbiddenTriggerNodeIds?this._forbiddenTriggerNodeIds.clear():this._forbiddenTriggerNodeIds=new Set;for(let t of e)this._forbiddenTriggerNodeIds.add(t.graphNodeId()),t.dirtyController.clearSuccessorsCacheWithPredecessors()}isForbiddenTriggerNodeId(e){return this._forbiddenTriggerNodeIds!=null&&this._forbiddenTriggerNodeIds.has(e)}setDirty(e,t){t==null&&(t=!0),!(e&&this.isForbiddenTriggerNodeId(e.graphNodeId()))&&(e==null&&(e=this.node),this._dirty=!0,this._dirtyTimestamp=Q.performance.performanceManager().now(),this._dirtyCount+=1,this.runPostDirtyHooks(e),t===!0&&this.setSuccessorsDirty(e))}runPostDirtyHooks(e){if(!this._postDirtyHooks)return;let t=this.node.scene().cooker;if(t.blocked())t.enqueue(this.node,e);else for(let r of this._postDirtyHooks)r(e)}setSuccessorsDirty(e){this._cachedSuccessors=this._cachedSuccessors||this.node.graphAllSuccessors();for(let r of this._cachedSuccessors)r.dirtyController.setDirty(e,!1)}clearSuccessorsCache(){this._cachedSuccessors=void 0}clearSuccessorsCacheWithPredecessors(){this.clearSuccessorsCache();for(let e of this.node.graphAllPredecessors())e.dirtyController.clearSuccessorsCache()}};var Yt=class{constructor(e,t){this._scene=e,this._name=t,this._dirtyController=new N3(this),this._graphNodeId=e.graph.nextId(),e.graph.addNode(this),this._graph=e.graph}dispose(){this._dirtyController.dispose(),this.graphRemove()}name(){return this._name}setName(e){this._name=e}scene(){return this._scene}graphNodeId(){return this._graphNodeId}get dirtyController(){return this._dirtyController}setDirty(e){e=e||this,this._dirtyController.setDirty(e)}setSuccessorsDirty(e){this._dirtyController.setSuccessorsDirty(e)}removeDirtyState(){this._dirtyController.removeDirtyState()}isDirty(){return this._dirtyController.isDirty()}addPostDirtyHook(e,t){this._dirtyController.addPostDirtyHook(e,t)}removePostDirtyHook(e){this._dirtyController.removePostDirtyHook(e)}graphRemove(){this._graph.removeNode(this)}addGraphInput(e,t=!0){return this._graph.connect(e,this,t)}removeGraphInput(e){this._graph.disconnect(e,this)}graphDisconnectPredecessors(){this._graph.disconnectPredecessors(this)}graphDisconnectSuccessors(){this._graph.disconnectSuccessors(this)}graphPredecessorIds(){return this._graph.predecessorIds(this._graphNodeId)||[]}graphPredecessors(){return this._graph.predecessors(this)}graphSuccessors(){return this._graph.successors(this)}graphAllPredecessors(){return this._graph.allPredecessors(this)}graphAllSuccessors(){return this._graph.allSuccessors(this)}};var U0=(i=>(i.MAX_FRAME_UPDATED="scene_maxFrameUpdated",i.REALTIME_STATUS_UPDATED="scene_realtime_status_updated",i.FRAME_UPDATED="scene_frame_updated",i.PLAY_STATE_UPDATED="scene_play_state_updated",i))(U0||{});var Ft=class{static arrayFromValues(e){let t=[];return e.forEach(r=>{t.push(r)}),t}static pushOnArrayAtEntry(e,t,r){e.has(t)?e.get(t).push(r):e.set(t,[r])}static addToSetAtEntry(e,t,r){if(e.has(t))e.get(t).add(r);else{let n=new Set;n.add(r),e.set(t,n)}}static popFromArrayAtEntry(e,t,r){if(e.has(t)){let n=e.get(t),s=n.indexOf(r);s>=0&&n.splice(s,1)}}static removeFromSetAtEntry(e,t,r){if(e.has(t)){let n=e.get(t);n.delete(r),n.size==0&&e.delete(t)}}static unshiftOnArrayAtEntry(e,t,r){e.has(t)?e.get(t).unshift(r):e.set(t,[r])}static concatOnArrayAtEntry(e,t,r){if(e.has(t)){let n=e.get(t);for(let s of r)n.push(s)}else e.set(t,r)}static async forEachSync(e,t){let r=[],o=[];e.forEach((n,s)=>{r.push(n),o.push(s)});for(let n=0;n<r.length;n++){let s=o[n],a=r[n];await t(a,s)}}static groupBy(e,t){let r=new Map;return e.forEach(o=>{let n=t(o);this.pushOnArrayAtEntry(r,n,o)}),r}};var oc=(i=>(i.LOADED="sceneLoaded",i.PLAY="play",i.PAUSE="pause",i))(oc||{}),IA=["sceneLoaded","play","pause"],$m=class extends Event{constructor(e){super(e)}get type(){return super.type}},DA={event:new $m("sceneLoaded")},kA={event:new $m("play")},BA={event:new $m("pause")},O3=class{constructor(){this._observersByEventType=new Map}dispatch(e){let t=e.event;if(!t)return;let r=this._observersByEventType.get(t.type);!r||r.forEach(o=>{o.processEvent(e)})}removeObserverFromAllEventTypes(e){this._observersByEventType.forEach((t,r)=>{t.delete(e)})}addObserver(e,t){Ft.addToSetAtEntry(this._observersByEventType,t,e)}};var FA=60,_h=class{constructor(i){this.scene=i,this._frame=0,this._timeUniform={value:0},this._realtimeState=!0,this._maxFrame=600,this._maxFrameLocked=!1,this._playing=!1,this._delta=0,this._onBeforeTickCallbacks=[],this._onAfterTickCallbacks=[],this._graphNode=new Yt(i,"timeController")}get graphNode(){return this._graphNode}frame(){return this._frame}timeUniform(){return this._timeUniform}time(){return this._timeUniform.value}maxFrame(){return this._maxFrame}maxFrameLocked(){return this._maxFrameLocked}realtimeState(){return this._realtimeState}setMaxFrame(i){this._maxFrame=Math.floor(i),this.scene.dispatchController.dispatch(this._graphNode,U0.MAX_FRAME_UPDATED)}setMaxFrameLocked(i){this._maxFrameLocked=i,this.scene.dispatchController.dispatch(this._graphNode,U0.MAX_FRAME_UPDATED)}setRealtimeState(i){this._realtimeState=i,this.scene.dispatchController.dispatch(this._graphNode,U0.REALTIME_STATUS_UPDATED)}setTime(i,e=!0){if(i==this._timeUniform.value)return;this._timeUniform.value=i,this.scene.cooker.block();let t=this._delta;for(let r of this._onBeforeTickCallbacks)r(t);if(e){let r=Math.floor(this._timeUniform.value*FA),o=this._ensureFrameWithinBounds(r);r!=o?this.setFrame(o,!0):this._frame=r}this.scene.dispatchController.dispatch(this._graphNode,U0.FRAME_UPDATED),this.graphNode.setSuccessorsDirty(),this.scene.cooker.unblock();for(let r of this._onAfterTickCallbacks)r(t)}setFrame(i,e=!0){i!=this._frame&&(i=this._ensureFrameWithinBounds(i),i!=this._frame&&(this._frame=i,e&&this.setTime(this._frame/FA,!1)))}setFrameToStart(){this.setFrame(_h.START_FRAME,!0)}incrementTimeIfPlaying(i){this._playing&&(this.scene.root().areChildrenCooking()||this.incrementTime(i))}incrementTime(i){if(this._realtimeState){this._delta=i;let e=this._timeUniform.value+this._delta;this.setTime(e,!1),this.setFrame(this._frame+1,!1)}else this.setFrame(this.frame()+1)}_ensureFrameWithinBounds(i){if(this._playing){if(this._maxFrameLocked&&i>this._maxFrame)return _h.START_FRAME}else{if(this._maxFrameLocked&&i>this._maxFrame)return this._maxFrame;if(i<_h.START_FRAME)return _h.START_FRAME}return i}playing(){return this._playing===!0}pause(){this._playing!=!1&&(this._playing=!1,this.scene.dispatchController.dispatch(this._graphNode,U0.PLAY_STATE_UPDATED),this.scene.eventsDispatcher.sceneEventsController.dispatch(BA))}play(){this._playing!=!0&&(this._playing=!0,this.scene.dispatchController.dispatch(this._graphNode,U0.PLAY_STATE_UPDATED),this.scene.eventsDispatcher.sceneEventsController.dispatch(kA))}togglePlayPause(){this.playing()?this.pause():this.play()}registerOnBeforeTick(i,e){this._registerCallback(i,e,this.registeredBeforeTickCallbacks())}unRegisterOnBeforeTick(i){this._unregisterCallback(i,this._onBeforeTickCallbacksMap)}registeredBeforeTickCallbacks(){return this._onBeforeTickCallbacksMap=this._onBeforeTickCallbacksMap||new Map}registerOnAfterTick(i,e){this._registerCallback(i,e,this.registeredAfterTickCallbacks())}unRegisterOnAfterTick(i){this._unregisterCallback(i,this._onAfterTickCallbacksMap)}registeredAfterTickCallbacks(){return this._onAfterTickCallbacksMap=this._onAfterTickCallbacksMap||new Map}_registerCallback(i,e,t){if(t.has(i)){console.warn(`callback ${i} already registered`);return}t.set(i,e),this._updateCallbacks()}_unregisterCallback(i,e){!e||(e.delete(i),this._updateCallbacks())}_updateCallbacks(){var i,e;this._onBeforeTickCallbacks=[],(i=this._onBeforeTickCallbacksMap)==null||i.forEach(t=>{this._onBeforeTickCallbacks.push(t)}),this._onAfterTickCallbacks=[],(e=this._onAfterTickCallbacksMap)==null||e.forEach(t=>{this._onAfterTickCallbacks.push(t)})}},$s=_h;$s.START_FRAME=0;var P3=class{constructor(e){this.scene=e,this._mainCameraNodePath=null}setMainCameraNodePath(e){this._mainCameraNodePath=e}mainCameraNodePath(){return this._mainCameraNodePath}mainCameraNode(){if(this.mainCameraNodePath){let e=this.mainCameraNodePath();return e?this.scene.node(e):this._findAnyCamera()}else return console.warn("main cameraNode not found"),this._findAnyCamera()}_findAnyCamera(){let e=this.scene.root();return e.nodesByType("perspectiveCamera")[0]||e.nodesByType("orthographicCamera")[0]}};var R3=class{constructor(e){this._scene=e,this._queue=new Map,this._blockLevel=0,this._blockLevel=0}block(){this._blockLevel+=1}unblock(){this._blockLevel-=1,this._blockLevel<0&&(this._blockLevel=0),this._processQueue()}blocked(){return this._blockLevel>0}enqueue(e,t){this._queue.set(e.graphNodeId(),t)}_processQueue(){if(this.blocked())return;let e=[],t=[];this._queue.forEach((r,o)=>{e.push(r),t.push(o)}),this._queue.clear();for(let r=0;r<e.length;r++){let o=e[r],n=t[r];this._processItem(o,n)}}_processItem(e,t){let r=this._scene.graph.nodeFromId(t);r&&r.dirtyController.runPostDirtyHooks(e)}};var L3=class{constructor(){this._cooking_nodes_by_id=new Map,this._resolves=[]}addNode(e){this._cooking_nodes_by_id.set(e.graphNodeId(),e)}removeNode(e){this._cooking_nodes_by_id.delete(e.graphNodeId()),this._cooking_nodes_by_id.size==0&&this.flush()}cookingNodes(){let e=[];return this._cooking_nodes_by_id.forEach((t,r)=>{e.push(t)}),e}flush(){let e;for(;e=this._resolves.pop();)e()}async waitForCooksCompleted(){if(this._cooking_nodes_by_id.size!=0)return new Promise((e,t)=>{this._resolves.push(e)})}};var wn=class{static toArray(e){let t=[];return e.forEach(r=>{t.push(r)}),t}static fromArray(e){let t=new Set;return e.forEach(r=>t.add(r)),t}static union(e,t){let r=new Set;return e.forEach(o=>r.add(o)),t.forEach(o=>r.add(o)),r}static intersection(e,t){let r=new Set;return e.forEach(o=>{t.has(o)&&r.add(o)}),t.forEach(o=>{e.has(o)&&r.add(o)}),r}static difference(e,t){let r=new Set;return e.forEach(o=>{t.has(o)||r.add(o)}),t.forEach(o=>{e.has(o)||r.add(o)}),r}};var I3=class{constructor(){this._next_id=0,this._successors=new Map,this._predecessors=new Map,this._nodes_by_id=new Map,this._nodesCount=0,this._debugging=!1,this._addedNodesDuringDebugging=new Map,this._boundPredecessorIds=this.predecessorIds.bind(this),this._boundSuccessorIds=this.successorIds.bind(this)}startDebugging(){this._debugging=!0}stopDebugging(){this._debugging=!1}printDebug(){this._addedNodesDuringDebugging.forEach((e,t)=>{console.log(t,e,e.graphPredecessors(),e.graphSuccessors())})}setScene(e){this._scene=e}scene(){return this._scene}nextId(){return this._next_id+=1,this._next_id}nodesFromIds(e){let t=[];for(let r of e){let o=this.nodeFromId(r);o&&t.push(o)}return t}nodeFromId(e){return this._nodes_by_id.get(e)}hasNode(e){return this._nodes_by_id.get(e.graphNodeId())!=null}addNode(e){this._nodes_by_id.set(e.graphNodeId(),e),this._nodesCount+=1,this._debugging&&this._addedNodesDuringDebugging.set(e.graphNodeId(),e)}removeNode(e){this._nodes_by_id.delete(e.graphNodeId()),this._successors.delete(e.graphNodeId()),this._predecessors.delete(e.graphNodeId()),this._nodesCount-=1,this._debugging&&this._addedNodesDuringDebugging.delete(e.graphNodeId())}nodesCount(){return this._nodesCount}connect(e,t,r=!0){let o=e.graphNodeId(),n=t.graphNodeId();if(this.hasNode(e)&&this.hasNode(t)){r&&(r=!(this._scene?this._scene.loadingController.isLoading():!0));let s=!1;return r&&(s=this._hasPredecessor(o,n)),s?!1:(this._createConnection(o,n),e.dirtyController.clearSuccessorsCacheWithPredecessors(),!0)}else return console.warn(`attempt to connect non existing node ${o} or ${n}`),!1}disconnect(e,t){this._remove_connection(e.graphNodeId(),t.graphNodeId()),e.dirtyController.clearSuccessorsCacheWithPredecessors()}disconnectPredecessors(e){let t=this.predecessors(e);for(let r of t)this.disconnect(r,e)}disconnectSuccessors(e){let t=this.successors(e);for(let r of t)this.disconnect(e,r)}predecessorIds(e){let t=this._predecessors.get(e);if(t){let r=[];return t.forEach((o,n)=>{r.push(n)}),r}return[]}predecessors(e){let t=this.predecessorIds(e.graphNodeId());return this.nodesFromIds(t)}successorIds(e){let t=this._successors.get(e);if(t){let r=[];return t.forEach((o,n)=>{r.push(n)}),r}return[]}successors(e){let t=this.successorIds(e.graphNodeId())||[];return this.nodesFromIds(t)}allPredecessorIds(e){let t=this._boundPredecessorIds,r=new Set,o=t(e.graphNodeId());for(;o.length>0;){let n=[];for(let s of o){r.add(s);for(let a of t(s))n.push(a)}o=n}return wn.toArray(r)}allSuccessorIds(e){let t=this._boundSuccessorIds,r=new Set,o=t(e.graphNodeId());for(;o.length>0;){let n=[];for(let s of o){let a=this.nodeFromId(s);if(a&&!a.dirtyController.isForbiddenTriggerNodeId(e.graphNodeId())){r.add(s);for(let c of t(s))n.push(c)}}o=n}return wn.toArray(r)}allPredecessors(e){let t=this.allPredecessorIds(e);return this.nodesFromIds(t)}allSuccessors(e){let t=this.allSuccessorIds(e);return this.nodesFromIds(t)}_createConnection(e,t){let r=this._successors.get(e);if(r||(r=new Set,this._successors.set(e,r)),r.has(t))return;r.add(t);let o=this._predecessors.get(t);o||(o=new Set,this._predecessors.set(t,o)),o.add(e)}_remove_connection(e,t){let r=this._successors.get(e);r&&(r.delete(t),r.size==0&&this._successors.delete(e));let o=this._predecessors.get(t);o&&(o.delete(e),o.size==0&&this._predecessors.delete(t))}_hasPredecessor(e,t){let r=this.predecessorIds(e);if(r){if(r.includes(t))return!0;for(let o of r)return this._hasPredecessor(o,t)}return!1}};var D3=class{constructor(e){this._node=e,this._cooks_count=0,this._total_cook_time=0,this._total_inputs_time=0,this._total_params_time=0}update_cook_data(e){this._cooks_count+=1,this._total_cook_time+=e.cookTime,this._total_inputs_time+=e.inputsTime,this._total_params_time+=e.paramsTime}total_time(){return this._total_cook_time+this._total_inputs_time+this._total_params_time}total_cook_time(){return this._total_cook_time}cook_time_per_iteration(){return this._cooks_count>0?this._total_cook_time/this._cooks_count:0}total_inputs_time(){return this._total_inputs_time}inputs_time_per_iteration(){return this._cooks_count>0?this._total_inputs_time/this._cooks_count:0}total_params_time2(){return this._total_params_time}params_time_per_iteration2(){return this._cooks_count>0?this._total_params_time/this._cooks_count:0}cooks_count(){return this._cooks_count}print_object(){return{fullPath:this._node.path(),cooks_count:this.cooks_count(),total_time:this.total_time(),total_cook_time:this.total_cook_time(),cook_time_per_iteration:this.cook_time_per_iteration(),inputs_time_per_iteration:this.inputs_time_per_iteration(),params_time_per_iteration:this.params_time_per_iteration2()}}};var K=class{static isNumber(e){return typeof e=="number"}static isVector(e){return e instanceof G||e instanceof w||e instanceof Ie}static isColor(e){return e instanceof he}static isQuaternion(e){return e instanceof Nt}static isString(e){return typeof e=="string"}static isBoolean(e){return e===!0||e===!1}static isNaN(e){return isNaN(e)}static isArray(e){return Array.isArray(e)}static isObject(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}};var $e=class{static shallowClone(e){return[...e]}static min(e){let t=e[0];for(let r of e)r<t&&(t=r);return t}static max(e){let t=e[0];for(let r of e)r>t&&(t=r);return t}static sum(e){let t=0;for(let r of e)t+=r;return t}static compact(e){let t=[];for(let r of e)r!=null&&t.push(r);return t}static uniq(e){let t=new Set;for(let n of e)t.add(n);let r=new Array(t.size),o=0;return t.forEach(n=>{r[o]=n,o++}),r}static chunk(e,t){let r=[],o=[];r.push(o);for(let n=0;n<e.length;n++)o.length==t&&(o=[],r.push(o)),o.push(e[n]);return r}static union(e,t){let r=[];return wn.union(this.toSet(e),this.toSet(t)).forEach(n=>r.push(n)),r}static intersection(e,t){let r=[];return wn.intersection(this.toSet(e),this.toSet(t)).forEach(n=>r.push(n)),r}static difference(e,t){let r=[];return wn.difference(this.toSet(e),this.toSet(t)).forEach(n=>r.push(n)),r}static toSet(e){let t=new Set;for(let r of e)t.add(r);return t}static isEqual(e,t){if(e.length!=t.length)return!1;let r=e.length;for(let o=0;o<r;o++)if(e[o]!=t[o])return!1;return!0}static sortBy(e,t){if(e.length==0)return[];let r=new Map,o=new Set;for(let c of e){let l=t(c);o.add(l),Ft.pushOnArrayAtEntry(r,l,c)}let n=new Array(o.size),s=0;o.forEach(c=>{n[s]=c,s++}),K.isString(n[0])?n.sort():n.sort((c,l)=>c-l);let a=new Array(e.length);s=0;for(let c of n){let l=r.get(c);if(l)for(let u of l)a[s]=u,s++}return a}static range(e,t,r=1){t==null&&(t=e,e=0);let o=Math.floor((t-e)/r),n=new Array(o);for(let s=0;s<n.length;s++)n[s]=e+s*r;return n}};var Uw=bn(kw()),Vw=bn(Fw()),Cr=class{static isEqual(e,t){if(K.isObject(e)&&K.isObject(t)){let r=Object.keys(e),o=Object.keys(t);return $e.isEqual(r,o)?JSON.stringify(e)==JSON.stringify(t):!1}return!1}static merge(e,t){return Object.assign(e,t)}static clone(e){return(0,Vw.default)(e)}static cloneDeep(e){return(0,Uw.default)(e)}};var s4=class{constructor(){this._started=!1,this._start_time=0,this._previous_timestamp=0,this._nodes_cook_data={},this._durations_by_name={},this._durations_count_by_name={}}profile(e,t){let r=Q.performance.performanceManager(),o=r.now();t();let n=r.now()-o;console.log(`${e}: ${n}`)}start(){if(!this._started){this.reset(),this._started=!0;let e=Q.performance.performanceManager();this._start_time=e.now(),this._nodes_cook_data={},this._previous_timestamp=this._start_time}}stop(){this.reset()}reset(){this._started=!1,this._start_time=null,this._durations_by_name={},this._durations_count_by_name={},this._nodes_cook_data={}}started(){return this._started}recordNodeCookData(e,t){let r=e.graphNodeId();this._nodes_cook_data[r]==null&&(this._nodes_cook_data[r]=new D3(e)),this._nodes_cook_data[r].update_cook_data(t)}record(e){this.started()||this.start();let t=performance.now();return this._durations_by_name[e]==null&&(this._durations_by_name[e]=0),this._durations_by_name[e]+=t-this._previous_timestamp,this._durations_count_by_name[e]==null&&(this._durations_count_by_name[e]=0),this._durations_count_by_name[e]+=1,this._previous_timestamp=t}print(){this.print_node_cook_data(),this.print_recordings()}print_node_cook_data(){let e=Object.values(this._nodes_cook_data);e=$e.sortBy(e,n=>n.total_cook_time());let t=e.map(n=>n.print_object());console.log("--------------- NODES COOK TIME -----------");let r=[],o=$e.sortBy(t,n=>-n.total_cook_time);for(let n of o)r.push(n);return console.table(r),t}print_recordings(){let e=Cr.clone(this._durations_by_name),t=Cr.clone(this._durations_count_by_name),r=[],o={};for(let a of Object.keys(e)){let c=e[a];r.push(c),o[c]==null&&(o[c]=[]),o[c].push(a)}r.sort((a,c)=>a-c);let n=$e.uniq(r);console.log("--------------- PERF RECORDINGS -----------");let s=[];for(let a of n){let c=o[a];for(let l of c){let u=t[l],p=a/u,h={duration:a,name:l,count:u,duration_per_iteration:p};s.push(h)}}return console.table(s),s}};var a4=class{constructor(e){this.scene=e}setListener(e){this._eventsListener?console.warn("scene already has a listener"):(this._eventsListener=e,this._runOnAddListenerCallbacks())}onAddListener(e){this._eventsListener?e():(this._onAddListenerCallbacks=this._onAddListenerCallbacks||[],this._onAddListenerCallbacks.push(e))}_runOnAddListenerCallbacks(){if(this._onAddListenerCallbacks){let e;for(;e=this._onAddListenerCallbacks.pop();)e();this._onAddListenerCallbacks=void 0}}dispatch(e,t,r){var o;(o=this._eventsListener)==null||o.process_events(e,t,r)}emitAllowed(){return this._eventsListener!=null&&this.scene.loadingController.loaded()&&this.scene.loadingController.autoUpdating()}};var c4=class{constructor(){this._params_by_id=new Map}registerParam(e){this._params_by_id.set(e.graphNodeId(),e)}deregisterParam(e){this._params_by_id.delete(e.graphNodeId())}regenerateReferringExpressions(e){e.nameController.graph_node.setSuccessorsDirty(e)}};var l4=class{constructor(e){this.scene=e,this._lifecycleOnAfterCreatedAllowed=!0}onAfterCreatedCallbackAllowed(){return this.scene.loadingController.loaded()&&this._lifecycleOnAfterCreatedAllowed}onAfterCreatedPrevent(e){this._lifecycleOnAfterCreatedAllowed=!1,e(),this._lifecycleOnAfterCreatedAllowed=!0}};var u4=class{constructor(e){this.scene=e,this._loadingState=!1,this._autoUpdating=!0}markAsLoading(){this._setLoadingState(!0)}async markAsLoaded(){this.scene.missingExpressionReferencesController.resolveMissingReferences(),await this._setLoadingState(!1),this._triggerLoadedEvent()}_triggerLoadedEvent(){globalThis.Event&&this.scene.eventsDispatcher.sceneEventsController.dispatch(DA)}async _setLoadingState(e){this._loadingState=e,await this.setAutoUpdate(!this._loadingState)}isLoading(){return this._loadingState}loaded(){return!this._loadingState}autoUpdating(){return this._autoUpdating}async setAutoUpdate(e){if(this._autoUpdating!==e&&(this._autoUpdating=e,this._autoUpdating)){let t=this.scene.root();t&&await t.processQueue()}}};var Ci=class{constructor(e=""){this._path=e,this._node=null}setPath(e){this._path=e}setNode(e){this._node=e}path(){return this._path}node(){return this._node}resolve(e){this._node=ct.findNode(e,this._path)}clone(){let e=new Ci(this._path);return e.setNode(this._node),e}nodeWithContext(e,t){let r=this.node();if(!r){t==null||t.set(`no node found at ${this.path()}`);return}let o=r.context();if(o==e)return r;t==null||t.set(`expected ${e} node, but got a ${o}`)}},sc=class{constructor(e=""){this._path=e,this._param=null}setPath(e){this._path=e}setParam(e){this._param=e}path(){return this._path}param(){return this._param}resolve(e){this._param=ct.findParam(e,this._path)}clone(){let e=new sc(this._path);return e.setParam(this._param),e}paramWithType(e,t){let r=this.param();if(!r){t==null||t.set(`no param found at ${this.path()}`);return}if(r.type()==e)return r;t==null||t.set(`expected ${e} node, but got a ${r.type()}`)}},qt=class{static splitParentChild(i){let e=i.split(qt.SEPARATOR).filter(o=>o.length>0),t=e.pop();return{parent:e.join(qt.SEPARATOR),child:t}}static findNode(i,e,t){if(!i)return null;let r=e.split(qt.SEPARATOR).filter(s=>s.length>0),o=r[0],n=null;if(e[0]===qt.SEPARATOR){let s=e.substring(1);n=this.findNode(i.root(),s,t)}else{switch(o){case qt.PARENT:t==null||t.add_path_element(o),n=i.parent();break;case qt.CURRENT:t==null||t.add_path_element(o),n=i;break;default:n=i.node(o),n&&(t==null||t.add_node(o,n))}if(n!=null&&r.length>1){let s=r.slice(1).join(qt.SEPARATOR);n=this.findNode(n,s,t)}return n}return n}static findParam(i,e,t){if(!i)return null;let r=e.split(qt.SEPARATOR);if(r.length===1)return i.params.get(r[0]);{let o=null;if(e[0]===qt.SEPARATOR&&r.length==2)o=i.root();else{let n=r.slice(0,+(r.length-2)+1||void 0).join(qt.SEPARATOR);o=this.findNode(i,n,t)}if(o!=null){let n=r[r.length-1],s=o.params.get(n);return t&&s&&t.add_node(n,s),s}else return null}}static relativePath(i,e){let t=this.closestCommonParent(i,e);if(t){let r=this.distanceToParent(i,t),o="";if(r>0){let u=0,p=[];for(;u++<r;)p.push(qt.PARENT);o=p.join(qt.SEPARATOR)+qt.SEPARATOR}let n=t.path().split(qt.SEPARATOR).filter(u=>u.length>0),s=e.path().split(qt.SEPARATOR).filter(u=>u.length>0),a=[],c=0;for(let u of s)n[c]||a.push(u),c++;let l=a.join(qt.SEPARATOR);return this.sanitizePath(`${o}${l}`)}else return e.path()}static sanitizePath(i){return i.replace(/\/\//g,"/")}static closestCommonParent(i,e){let t=this.parents(i).reverse().concat([i]),r=this.parents(e).reverse().concat([e]),o=Math.min(t.length,r.length),n=null;for(let s=0;s<o;s++)t[s].graphNodeId()==r[s].graphNodeId()&&(n=t[s]);return n}static parents(i){let e=[],t=i.parent();for(;t;)e.push(t),t=t.parent();return e}static distanceToParent(i,e){let t=0,r=i,o=e.graphNodeId();for(;r&&r.graphNodeId()!=o;)t+=1,r=r.parent();return r&&r.graphNodeId()==o?t:-1}static makeAbsolutePath(i,e){if(e[0]==qt.SEPARATOR)return e;let t=e.split(qt.SEPARATOR),r=t.shift();if(r)switch(r){case"..":{let o=i.parent();return o?o==i.scene().root()?qt.SEPARATOR+t.join(qt.SEPARATOR):this.makeAbsolutePath(o,t.join(qt.SEPARATOR)):null}case".":return this.makeAbsolutePath(i,t.join(qt.SEPARATOR));default:return[i.path(),e].join(qt.SEPARATOR)}else return i.path()}},ct=qt;ct.SEPARATOR="/";ct.DOT=".";ct.CURRENT=qt.DOT;ct.PARENT="..";ct.CURRENT_WITH_SLASH=`${qt.CURRENT}/`;ct.PARENT_WITH_SLASH=`${qt.PARENT}/`;ct.NON_LETTER_PREFIXES=[qt.SEPARATOR,qt.DOT];var p4=class{constructor(e,t){this.param=e,this.path=t}absolutePath(){return ct.makeAbsolutePath(this.param.node,this.path)}matchesPath(e){return this.absolutePath()==e}resolveMissingDependencies(){let e=this.param.rawInputSerialized();this.param.set(this.param.defaultValue()),this.param.set(e)}};var h4=class{constructor(e){this.scene=e,this.references=new Map}register(e,t){let r=new p4(e,t);return Ft.addToSetAtEntry(this.references,e.graphNodeId(),r),r}deregisterParam(e){this.references.delete(e.graphNodeId())}resolveMissingReferences(){let e=[];this.references.forEach(t=>{for(let r of t)this._isReferenceResolvable(r)&&e.push(r)});for(let t of e)t.resolveMissingDependencies()}_isReferenceResolvable(e){let t=e.absolutePath();if(t){if(this.scene.node(t))return!0;{let o=ct.splitParentChild(t);if(o.child){let n=this.scene.node(o.parent);if(n&&n.params.get(o.child))return!0}}}}checkForMissingNodeReferences(e){if(!!e.scene().loadingController.loaded()){this._checkForMissingReferencesForNode(e);for(let t of e.params.all)this._checkForMissingReferencesForParam(t)}}checkForMissingParamReferences(e){!e.scene().loadingController.loaded()||this._checkForMissingReferencesForParam(e)}_checkForMissingReferencesForNode(e){let t=e.graphNodeId(),r=Ft.arrayFromValues(this.references);for(let o of r){let n=!1,s=wn.toArray(o);for(let a of s)a.matchesPath(e.path())&&(n=!0,a.resolveMissingDependencies());n&&this.references.delete(t)}}_checkForMissingReferencesForParam(e){let t=e.graphNodeId(),r=Ft.arrayFromValues(this.references);for(let o of r){let n=!1,s=wn.toArray(o);for(let a of s)a.matchesPath(e.path())&&(n=!0,a.resolveMissingDependencies());n&&this.references.delete(t)}}};var St=(i=>(i.CREATED="node_created",i.DELETED="node_deleted",i.NAME_UPDATED="node_name_update",i.OVERRIDE_CLONABLE_STATE_UPDATE="node_override_clonable_state_update",i.NAMED_OUTPUTS_UPDATED="node_named_outputs_updated",i.NAMED_INPUTS_UPDATED="node_named_inputs_updated",i.INPUTS_UPDATED="node_inputs_updated",i.PARAMS_UPDATED="node_params_updated",i.UI_DATA_POSITION_UPDATED="node_ui_data_position_updated",i.UI_DATA_COMMENT_UPDATED="node_ui_data_comment_updated",i.ERROR_UPDATED="node_error_updated",i.FLAG_BYPASS_UPDATED="bypass_flag_updated",i.FLAG_DISPLAY_UPDATED="display_flag_updated",i.FLAG_OPTIMIZE_UPDATED="optimize_flag_updated",i.SELECTION_UPDATED="selection_updated",i))(St||{});var d4=class{constructor(e,t=0,r=0){this.node=e,this._position=new G,this._width=50,this._color=new he(.75,.75,.75),this._layoutVertical=!0,this._json={x:0,y:0},this._position.x=t,this._position.y=r}dispose(){this._comment=void 0}setComment(e){this._comment=e,this.node.emit(St.UI_DATA_COMMENT_UPDATED)}comment(){return this._comment}setColor(e){this._color=e}color(){return this._color}setLayoutHorizontal(){this._layoutVertical=!1}isLayoutVertical(){return this._layoutVertical}copy(e){this._position.copy(e.position()),this._color.copy(e.color())}position(){return this._position}setPosition(e,t=0){if(K.isNumber(e)){let r=e;this._position.set(r,t)}else this._position.copy(e);this.node.emit(St.UI_DATA_POSITION_UPDATED)}translate(e,t=!1){this._position.add(e),t&&(this._position.x=Math.round(this._position.x),this._position.y=Math.round(this._position.y)),this.node.emit(St.UI_DATA_POSITION_UPDATED)}toJSON(){return this._json.x=this._position.x,this._json.y=this._position.y,this._json.comment=this._comment,this._json}};var ac=class{constructor(e){this.node=e,this._state=!0,this._hooks=null}onUpdate(e){this._hooks=this._hooks||[],this._hooks.push(e)}_on_update(){}set(e){this._state!=e&&(this._state=e,this._on_update(),this.runHooks())}active(){return this._state}toggle(){this.set(!this._state)}runHooks(){if(this._hooks)for(let e of this._hooks)e()}};var f4=class extends ac{constructor(){super(...arguments);this._state=!1}_on_update(){this.node.emit(St.FLAG_BYPASS_UPDATED),this.node.setDirty()}};var m4=class extends ac{_on_update(){this.node.emit(St.FLAG_DISPLAY_UPDATED)}};var _4=class extends ac{constructor(){super(...arguments);this._state=!1}_on_update(){this.node.emit(St.FLAG_OPTIMIZE_UPDATED)}};var G0=class{constructor(e){this.node=e}hasDisplay(){return!1}hasBypass(){return!1}hasOptimize(){return!1}};function g4(i){return class extends i{constructor(){super(...arguments);this.display=new m4(this.node)}hasDisplay(){return!0}}}function c1(i){return class extends i{constructor(){super(...arguments);this.bypass=new f4(this.node)}hasBypass(){return!0}}}function Gw(i){return class extends i{constructor(){super(...arguments);this.optimize=new _4(this.node)}hasOptimize(){return!0}}}var ho=class extends g4(G0){},wh=class extends c1(G0){},MY=class extends c1(g4(G0)){},v4=class extends Gw(c1(G0)){},x4=class extends Gw(c1(g4(G0))){};var Mh=class{constructor(e){this.node=e}};var y4=class extends Mh{active(){return this.paramsTimeDependent()||this.inputsTimeDependent()}paramsTimeDependent(){let e=this.node.params.names;for(let t of e){let r=this.node.params.get(t);if(r&&r.states.timeDependent.active())return!0}return!1}inputsTimeDependent(){let e=this.node.io.inputs.inputs();for(let t of e)if(t&&t.states.timeDependent.active())return!0;return!1}forceTimeDependent(){let e=this.node.graphPredecessors().map(r=>r.graphNodeId()),t=this.node.scene().timeController.graphNode;e.includes(t.graphNodeId())||this.node.addGraphInput(t,!1)}unforceTimeDependent(){let e=this.node.scene().timeController.graphNode;this.node.removeGraphInput(e)}};var b4=class extends Mh{set(e){this._message!=e&&(e?Q.error(`[${this.node.path()}] error: '${e}'`):Q.warn(`[${this.node.path()}] clear error`),this._message=e,this.onUpdate())}message(){return this._message}clear(){this.set(void 0)}active(){return this._message!=null}onUpdate(){this._message!=null&&this.node._setContainer(null,`from error '${this._message}'`),this.node.emit(St.ERROR_UPDATED)}};var T4=class{constructor(e){this.node=e,this.timeDependent=new y4(this.node),this.error=new b4(this.node)}};var A4=class{constructor(e){this.node=e,this._parent=null}parent(){return this._parent}setParent(e){e!=this.node.parentController.parent()&&(this._parent=e,this._parent&&this.node.nameController.requestNameToParent(this.node.name()))}firstAncestorWithContext(e){return this._parent?this._parent.context()==e?this._parent:this._parent.parentController.firstAncestorWithContext(e):null}path(e){let t=ct.SEPARATOR;if(this._parent!=null){if(this._parent==e)return this.node.name();{let r=this._parent.path(e);return r===t?r+this.node.name():r+t+this.node.name()}}else return t}onSetParent(){if(this._on_set_parent_hooks)for(let e of this._on_set_parent_hooks)e()}findNode(e){if(e==null)return null;if(e==ct.CURRENT||e==ct.CURRENT_WITH_SLASH)return this.node;if(e==ct.PARENT||e==ct.PARENT_WITH_SLASH)return this.node.parent();let t=ct.SEPARATOR;if(e===t)return this.node.scene().root();if(e[0]===t)return e=e.substring(1,e.length),this.node.scene().root().node(e);if(e.split){let r=e.split(t);if(r.length===1){let o=r[0];return this.node.childrenController?this.node.childrenController.childByName(o):null}else return ct.findNode(this.node,e)}else return console.error("unexpected path given:",e),null}};var NY=/[, ]/,zw=/\d+$/,OY=/^0+/,PY=/,| /,RY="0",LY=" ",IY=/^-?\d+\.?\d*$/;var Fe=class{static isBoolean(e){return e=="true"||e=="false"}static toBoolean(e){return e=="true"}static isNumber(e){return IY.test(e)}static tailDigits(e){let t=e.match(zw);return t?parseInt(t[0]):0}static increment(e){let t=e.match(zw);if(t){let r=t[0],o="",n=r.match(OY);n&&(o=n[0]);let s=parseInt(r);return s==0&&o.length>0&&o[o.length-1]==RY&&(o=o.slice(0,-1)),`${e.substring(0,e.length-t[0].length)}${o}${s+1}`}else return`${e}1`}static pluralize(e){return e[e.length-1]!=="s"?`${e}s`:e}static camelCase(e){let t=e.replace(/_/g," ").split(" "),r="";for(let o=0;o<t.length;o++){let n=t[o].toLowerCase();o>0&&(n=this.upperFirst(n)),r+=n}return r}static upperFirst(e){return e[0].toUpperCase()+e.substring(1)}static titleize(e){return e.split(/\s|_/g).map(o=>this.upperFirst(o)).join(" ")}static precision(e,t=2){t=Math.max(t,0);let r=`${e}`.split(".");if(t<=0)return r[0];let o=r[1];if(o!==void 0)return o.length>t&&(o=o.substring(0,t)),o=o.padEnd(t,"0"),`${r[0]}.${o}`;{let n=`${e}.`,s=n.length+t;return n.padEnd(s,"0")}}static ensureFloat(e){let t=`${e}`;return t.indexOf(".")>=0?t:`${t}.0`}static ensureInteger(e){let t=`${e}`;return t.indexOf(".")>=0?t.split(".")[0]:t}static matchMask(e,t){if(t==="*"||e==t)return!0;let r=t.split(LY);if(r.length>1){for(let n of r)if(this.matchMask(e,n))return!0;return!1}return t=t.split("*").join(".*"),t=`^${t}$`,new RegExp(t).test(e)}static matchesOneMask(e,t){let r=!1;for(let o of t)Fe.matchMask(e,o)&&(r=!0);return r}static attribNames(e){let t=e.split(NY),r=new Set;for(let s of t)s=s.trim(),s.length>0&&r.add(s);let o=new Array(r.size),n=0;return r.forEach(s=>{o[n]=s,n++}),o}static indices(e){let t=e.split(PY);if(t.length>1){let r=t.flatMap(o=>this.indices(o));return $e.uniq(r).sort((o,n)=>o-n)}else{let r=t[0];if(r){let o="-";if(r.indexOf(o)>0){let n=r.split(o);return $e.range(parseInt(n[0]),parseInt(n[1])+1)}else{let n=parseInt(r);return K.isNumber(n)?[n]:[]}}else return[]}}static escapeLineBreaks(e){return e.replace(/(\r\n|\n|\r)/gm,"\\n")}static sanitizeName(e){return e=e.replace(/[^A-Za-z0-9]/g,"_"),e=e.replace(/^[0-9]/,"_"),e}};var C4=class{constructor(e){this._node=e,this._node_ids=[],this._json=[]}node(){return this._node}nodes(){return this._node.scene().graph.nodesFromIds(this._node_ids)}contains(e){return this._node_ids.includes(e.graphNodeId())}equals(e){let t=e.map(r=>r.graphNodeId()).sort();return $e.isEqual(t,this._node_ids)}clear(){this._node_ids=[],this.send_update_event()}set(e){this._node_ids=[],this.add(e)}add(e){let t=e.map(r=>r.graphNodeId());this._node_ids=$e.union(this._node_ids,t),this.send_update_event()}remove(e){let t=e.map(r=>r.graphNodeId());this._node_ids=$e.difference(this._node_ids,t),this.send_update_event()}send_update_event(){this._node.emit(St.SELECTION_UPDATED)}toJSON(){return this._json=this._json||[],this._json=this._node_ids.map(e=>e),this._json}};var Ge=(i=>(i.ALWAYS="always",i.NEVER="never",i.FROM_NODE="from_node",i))(Ge||{});var Be=class{static unreachable(e){throw new Error("Didn't expect to get here")}};var E4=class{constructor(e){this.inputs_controller=e,this._clone_required_states=[],this._overridden=!1}initInputsClonedState(e){K.isArray(e)?this._cloned_states=e:this._cloned_state=e,this._update_clone_required_state()}override_cloned_state_allowed(){if(this._cloned_states){for(let e of this._cloned_states)if(e==Ge.FROM_NODE)return!0}return this._cloned_state?this._cloned_state==Ge.FROM_NODE:!1}clone_required_state(e){return this._clone_required_states[e]}clone_required_states(){return this._clone_required_states}_get_clone_required_state(e){let t=this._cloned_states;if(t){let r=t[e];if(r!=null)return this.clone_required_from_state(r)}return this._cloned_state?this.clone_required_from_state(this._cloned_state):!0}clone_required_from_state(e){switch(e){case Ge.ALWAYS:return!0;case Ge.NEVER:return!1;case Ge.FROM_NODE:return!this._overridden}return Be.unreachable(e)}override_cloned_state(e){this._overridden=e,this._update_clone_required_state()}overriden(){return this._overridden}_update_clone_required_state(){if(this._cloned_states){let e=[];for(let t=0;t<this._cloned_states.length;t++)e[t]=this._get_clone_required_state(t);this._clone_required_states=e;return}if(this._cloned_state){let e=this.inputs_controller.inputsCount(),t=[];for(let r=0;r<e;r++)t[r]=this._get_clone_required_state(r);this._clone_required_states=t;return}}};var S4=class{constructor(e){this.operationContainer=e}inputsCount(){return this.operationContainer.inputsCount()}initInputsClonedState(e){this._clonedStatesController||(this._clonedStatesController=new E4(this),this._clonedStatesController.initInputsClonedState(e))}cloneRequired(e){var t;let r=(t=this._clonedStatesController)==null?void 0:t.clone_required_state(e);return r??!0}override_cloned_state(e){var t;(t=this._clonedStatesController)==null||t.override_cloned_state(e)}};var w4=class{constructor(e,t,r){this.operation=e,this.name=t,this.params={},this._applyDefaultParams(),this._applyInitParams(r),this._initClonedStates()}pathParamResolveRequired(){return this._path_params!=null}resolvePathParams(e){if(!!this._path_params)for(let t of this._path_params)t.resolve(e)}_applyDefaultParams(){let e=this.operation.constructor.DEFAULT_PARAMS,t=Object.keys(e);for(let r of t){let o=e[r],n=this._convertParamData(r,o);n!=null&&(this.params[r]=n)}}_applyInitParams(e){let t=Object.keys(e);for(let r of t){let o=e[r];if(o.simple_data!=null){let n=o.simple_data,s=this.operation.convertExportParamData({paramName:r,paramData:n,params:this.params});s!=null&&(this.params[r]=s)}}}_convertParamData(e,t){if(K.isNumber(t)||K.isBoolean(t)||K.isString(t))return t;if(t instanceof Ci){let r=t.clone();return this._path_params||(this._path_params=[]),this._path_params.push(r),r}if(t instanceof he||t instanceof G||t instanceof w||t instanceof Ie)return t.clone()}setInput(e,t){this._inputs=this._inputs||[],this._inputs[e]=t}inputsCount(){return this._inputs?this._inputs.length:0}inputsController(){return this._inputsController=this._inputsController||new S4(this)}_initClonedStates(){let e=this.operation.constructor.INPUT_CLONED_STATE;this.inputsController().initInputsClonedState(e)}inputCloneRequired(e){return this._inputsController?this._inputsController.cloneRequired(e):!0}overrideInputCloneState(e){this.inputsController().override_cloned_state(e)}cook(e){return this.operation.cook(e,this.params)}};var M4=class extends w4{constructor(e,t,r){super(e,t,r);this.operation=e,this.name=t,this.init_params=r,this._inputs=[],this._currentInputIndex=0,this._dirty=!0}operationType(){return this.operation.type()}addInput(e){super.setInput(this._currentInputIndex,e),this.incrementInputIndex()}incrementInputIndex(){this._currentInputIndex++}currentInputIndex(){return this._currentInputIndex}setDirty(){if(!this._dirty){this._computeResult=void 0;for(let e=0;e<this._inputs.length;e++)this._inputs[e].setDirty()}}async compute(e,t){if(this._computeResult)return this._computeResult;let r=[],o=t.get(this);o&&o.forEach((s,a)=>{r[a]=e[s]});for(let s=0;s<this._inputs.length;s++){let c=await this._inputs[s].compute(e,t);c&&(this.inputCloneRequired(s)&&(c=c.clone()),r[s]=c)}let n=this.operation.cook(r,this.params);return n?n instanceof Promise?this._computeResult=await n:this._computeResult=n:this._computeResult=void 0,this._dirty=!1,this._computeResult}};var Nh=class{constructor(e){this.node=e,this._graph_node=new Yt(e.scene(),"nodeNameController")}dispose(){this._graph_node.dispose(),this._on_set_name_hooks=void 0,this._on_set_fullPath_hooks=void 0}get graph_node(){return this._graph_node}static baseName(e){let t=e.type(),r=t[t.length-1];return K.isNaN(parseInt(r))||(t+="_"),`${t}1`}requestNameToParent(e){let t=this.node.parent();t&&t.childrenAllowed()&&t.childrenController?t.childrenController.setChildName(this.node,e):console.warn("requestNameToParent failed, no parent found")}setName(e){e!=this.node.name()&&this.requestNameToParent(e)}updateNameFromParent(e){var t;if(this.node._setCoreName(e),this._postSetName(),this.runPostSetFullPathHooks(),this.node.childrenAllowed()){let r=(t=this.node.childrenController)==null?void 0:t.children();if(r)for(let o of r)o.nameController.runPostSetFullPathHooks()}this.node.lifecycle.creationCompleted()&&this.node.scene().loadingController.loaded()&&(this.node.scene().missingExpressionReferencesController.checkForMissingNodeReferences(this.node),this.node.scene().expressionsController.regenerateReferringExpressions(this.node)),this.node.scene().referencesController.notifyNameUpdated(this.node),this.node.emit(St.NAME_UPDATED)}add_post_set_name_hook(e){this._on_set_name_hooks=this._on_set_name_hooks||[],this._on_set_name_hooks.push(e)}add_post_set_fullPath_hook(e){this._on_set_fullPath_hooks=this._on_set_fullPath_hooks||[],this._on_set_fullPath_hooks.push(e)}_postSetName(){if(this._on_set_name_hooks)for(let e of this._on_set_name_hooks)e()}runPostSetFullPathHooks(){if(this._on_set_fullPath_hooks)for(let e of this._on_set_fullPath_hooks)e()}};var N4=class{constructor(e,t){this.node=e,this._context=t,this._childrenByName=new Map,this._childrenByType=new Map,this._childrenAndGrandchildrenByContext=new Map}get selection(){return this._selection=this._selection||new C4(this.node)}dispose(){let e=this.children();for(let t of e)this.node.removeNode(t);this._selection=void 0}get context(){return this._context}setOutputNodeFindMethod(e){this._output_node_find_method=e}outputNode(){if(this._output_node_find_method)return this._output_node_find_method()}setChildName(e,t){let r;if(t=Fe.sanitizeName(t),(r=this._childrenByName.get(t))!=null)return e.name()===t&&r.graphNodeId()===e.graphNodeId()?void 0:(t=Fe.increment(t),this.setChildName(e,t));{let o=e.name();this._childrenByName.get(o)&&this._childrenByName.delete(o),this._childrenByName.set(t,e),e.nameController.updateNameFromParent(t),this._addToNodesByType(e),this.node.scene().nodesController.addToInstanciatedNode(e)}}_nextAvailableChildName(e){return e=Fe.sanitizeName(e),this._childrenByName.get(e)?this._nextAvailableChildName(Fe.increment(e)):e}node_context_signature(){return`${this.node.context()}/${this.node.type()}`}availableChildrenClasses(){return Q.registeredNodes(this._context,this.node.type())}isValidChildType(e){return this.availableChildrenClasses()[e]!=null}createNode(e,t){if(typeof e=="string"){let r=this._findNodeClass(e);return this._createAndInitNode(r,t)}else return this._createAndInitNode(e,t)}_createAndInitNode(e,t){let r=(t==null?void 0:t.nodeName)||Nh.baseName(e),o=this._nextAvailableChildName(r),n=new e(this.node.scene(),o,t);return n.initializeBaseAndNode(),this._addNode(n),n.lifecycle.setCreationCompleted(),n}_findNodeClass(e){let t=this.availableChildrenClasses()[e.toLowerCase()];if(t==null){let r=`child node type '${e}' not found for node '${this.node.path()}'. Available types are: ${Object.keys(this.availableChildrenClasses()).join(", ")}, ${this._context}, ${this.node.type()}`;throw console.error(r),r}return t}createOperationContainer(e,t,r){let o=Q.registeredOperation(this._context,e);if(o==null){let n=`no operation found with context ${this._context}/${e}`;throw console.error(n),n}else{let n=new o(this.node.scene());return new M4(n,t,(r==null?void 0:r.paramsInitValueOverrides)||{})}}_addNode(e){if(e.setParent(this.node),e.params.init(),e.parentController.onSetParent(),e.nameController.runPostSetFullPathHooks(),e.childrenAllowed()&&e.childrenController)for(let t of e.childrenController.children())t.nameController.runPostSetFullPathHooks();return this.node.emit(St.CREATED,{child_node_json:e.toJSON()}),this.node.scene().lifecycleController.onAfterCreatedCallbackAllowed()&&e.lifecycle.runOnAfterCreatedCallbacks(),e.lifecycle.runOnAfterAddedCallbacks(),this.node.lifecycle.runOnChildAddCallbacks(e),e.require_webgl2()&&this.node.scene().webgl_controller.set_require_webgl2(),this.node.scene().missingExpressionReferencesController.checkForMissingNodeReferences(e),e}removeNode(e){if(e.parent()!=this.node)return console.warn(`node ${e.name()} not under parent ${this.node.path()}`);{e.lifecycle.runOnBeforeDeleteCallbacks(),this.selection.contains(e)&&this.selection.remove([e]);let t=e.io.connections.firstInputConnection(),r=e.io.connections.inputConnections(),o=e.io.connections.outputConnections();if(r)for(let n of r)n&&n.disconnect({setInput:!0});if(o){for(let n of o)if(n&&(n.disconnect({setInput:!0}),t)){let s=t.node_src,a=n.output_index,c=n.node_dest,l=n.input_index;c.io.inputs.setInput(l,s,a)}}e.setParent(null),this._childrenByName.delete(e.name()),this._removeFromNodesByType(e),this.node.scene().nodesController.removeFromInstanciatedNode(e),e.setSuccessorsDirty(this.node),e.graphDisconnectSuccessors(),this.node.lifecycle.runOnChildRemoveCallbacks(e),e.lifecycle.runOnDeleteCallbacks(),e.dispose(),e.emit(St.DELETED,{parent_id:this.node.graphNodeId()})}}_addToNodesByType(e){let t=e.graphNodeId(),r=e.type();Ft.addToSetAtEntry(this._childrenByType,r,t),this._addToChildrenAndGrandchildrenByContext(e)}_removeFromNodesByType(e){let t=e.graphNodeId(),r=e.type();Ft.removeFromSetAtEntry(this._childrenByType,r,t),this._removeFromChildrenAndGrandchildrenByContext(e)}_addToChildrenAndGrandchildrenByContext(e){var t;let r=e.graphNodeId(),o=e.context();Ft.addToSetAtEntry(this._childrenAndGrandchildrenByContext,o,r);let n=this.node.parent();n&&n.childrenAllowed()&&((t=n.childrenController)==null||t._addToChildrenAndGrandchildrenByContext(e))}_removeFromChildrenAndGrandchildrenByContext(e){var t;let r=e.graphNodeId(),o=e.context();Ft.removeFromSetAtEntry(this._childrenAndGrandchildrenByContext,o,r);let n=this.node.parent();n&&n.childrenAllowed()&&((t=n.childrenController)==null||t._removeFromChildrenAndGrandchildrenByContext(e))}nodesByType(e){let t=this._childrenByType.get(e);if(!t)return[];let r=this.node.scene().graph,o=[];for(let n of t){let s=r.nodeFromId(n);s&&o.push(s)}return o}childByName(e){return this._childrenByName.get(e)||null}hasChildrenAndGrandchildrenWithContext(e){return this._childrenAndGrandchildrenByContext.get(e)!=null}children(){let e=[];return this._childrenByName.forEach(t=>{e.push(t)}),e}childrenNames(){let e=[];return this._childrenByName.forEach((t,r)=>{e.push(r)}),e}traverseChildren(e){this._childrenByName.forEach(t=>{var r;e(t),(r=t.childrenController)==null||r.traverseChildren(e)})}};var O4=class{constructor(e){this.node=e,this._creationCompleted=!1}dispose(){this._onChildAddCallbacks=void 0,this._onChildRemoveCallbacks=void 0,this._onAfterCreatedCallbacks=void 0,this._onAfterAddedCallbacks=void 0,this._onBeforeDeletedCallbacks=void 0,this._onAfterDeletedCallbacks=void 0}setCreationCompleted(){this._creationCompleted||(this._creationCompleted=!0)}creationCompleted(){return this.node.scene().loadingController.loaded()&&this._creationCompleted}onChildAdd(e){this._onChildAddCallbacks=this._onChildAddCallbacks||[],this._onChildAddCallbacks.push(e)}runOnChildAddCallbacks(e){this._runCallbacksWithChildNode(this._onChildAddCallbacks,e)}onChildRemove(e){this._onChildRemoveCallbacks=this._onChildRemoveCallbacks||[],this._onChildRemoveCallbacks.push(e)}runOnChildRemoveCallbacks(e){this._runCallbacksWithChildNode(this._onChildRemoveCallbacks,e)}onAfterCreated(e){this._onAfterCreatedCallbacks=this._onAfterCreatedCallbacks||[],this._onAfterCreatedCallbacks.push(e)}runOnAfterCreatedCallbacks(){this._runCallbacks(this._onAfterCreatedCallbacks)}onAfterAdded(e){this._onAfterAddedCallbacks=this._onAfterAddedCallbacks||[],this._onAfterAddedCallbacks.push(e)}runOnAfterAddedCallbacks(){this._runCallbacks(this._onAfterAddedCallbacks)}onBeforeDeleted(e){this._onBeforeDeletedCallbacks=this._onBeforeDeletedCallbacks||[],this._onBeforeDeletedCallbacks.push(e)}runOnBeforeDeleteCallbacks(){this._runCallbacks(this._onBeforeDeletedCallbacks)}onAfterDeleted(e){this._onAfterDeletedCallbacks=this._onAfterDeletedCallbacks||[],this._onAfterDeletedCallbacks.push(e)}runOnDeleteCallbacks(){this._runCallbacks(this._onAfterDeletedCallbacks)}_runCallbacks(e){if(!e)return;let t;for(t of e)t()}_runCallbacksWithChildNode(e,t){if(!e)return;let r;for(r of e)r(t)}};var oe=(i=>(i.ANIM="anim",i.AUDIO="audio",i.COP="cop",i.EVENT="event",i.GL="gl",i.JS="js",i.MANAGER="manager",i.MAT="mat",i.OBJ="obj",i.POST="post",i.ROP="rop",i.SOP="sop",i))(oe||{}),Ro=(i=>(i.ANIM="animationsNetwork",i.AUDIO="audioNetwork",i.COP="copNetwork",i.EVENT="eventsNetwork",i.MAT="materialsNetwork",i.POST="postProcessNetwork",i.ROP="renderersNetwork",i.SUBNET="subnet",i))(Ro||{}),l1=(i=>(i.INPUT="subnetInput",i.OUTPUT="subnetOutput",i))(l1||{}),P4=(i=>(i.PERSPECTIVE="perspectiveCamera",i.ORTHOGRAPHIC="orthographicCamera",i))(P4||{}),u1=["orthographicCamera","perspectiveCamera"],Oh=(i=>(i.ATTRIBUTE="attribute",i))(Oh||{}),R4=(i=>(i.DEVICE_ORIENTATION="cameraDeviceOrientationControls",i.MAP="cameraMapControls",i.ORBIT="cameraOrbitControls",i.FIRST_PERSON="firstPersonControls",i.PLAYER="playerControls",i.MOBILE_JOYSTICK="mobileJoystickControls",i))(R4||{}),Hw=["cameraDeviceOrientationControls","cameraMapControls","cameraOrbitControls","firstPersonControls","mobileJoystickControls"],cc=(i=>(i.FFT="FFT",i.METER="meter",i.WAVEFORM="waveform",i))(cc||{}),Ph=["FFT","meter","waveform"];var hr=class{constructor(e){this._node=e}set_node(e){this._node=e}node(){return this._node}set_content(e){this._content=e,this._post_set_content()}has_content(){return this._content!=null}content(){return this._content}_post_set_content(){}coreContent(){return this._content}coreContentCloned(){return this._content}infos(){return[]}};var L4=class extends hr{set_content(e){super.set_content(e)}setTimelineBuilder(e){return this.set_content(e)}timelineBuilder(){return this.content()}coreContentCloned(){if(this._content)return this._content.clone()}};var I4=class extends hr{setContent(e){super.set_content(e)}setAudioBuilder(e){return this.set_content(e)}audioBuilder(){return this.content()}coreContentCloned(){if(this._content)return this._content.clone()}};var D4=class extends hr{set_content(e){super.set_content(e)}};var jw=new w,Ww=new Ie,qw=new Ie,DY=new w,Xw=new Ve,z0=class extends lt{constructor(e,t){super(e,t);this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Ve,this.bindMatrixInverse=new Ve}copy(e){return super.copy(e),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,this}bind(e,t){this.skeleton=e,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){let e=new Ie,t=this.geometry.attributes.skinWeight;for(let r=0,o=t.count;r<o;r++){e.x=t.getX(r),e.y=t.getY(r),e.z=t.getZ(r),e.w=t.getW(r);let n=1/e.manhattanLength();n!==1/0?e.multiplyScalar(n):e.set(1,0,0,0),t.setXYZW(r,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode==="attached"?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode==="detached"?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}boneTransform(e,t){let r=this.skeleton,o=this.geometry;Ww.fromBufferAttribute(o.attributes.skinIndex,e),qw.fromBufferAttribute(o.attributes.skinWeight,e),jw.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let n=0;n<4;n++){let s=qw.getComponent(n);if(s!==0){let a=Ww.getComponent(n);Xw.multiplyMatrices(r.bones[a].matrixWorld,r.boneInverses[a]),t.addScaledVector(DY.copy(jw).applyMatrix4(Xw),s)}}return t.applyMatrix4(this.bindMatrixInverse)}};z0.prototype.isSkinnedMesh=!0;var Ji=class extends vt{constructor(){super();this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){let t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),t}};Ji.prototype.isScene=!0;var fs=class extends vt{constructor(){super();this.type="Bone"}};fs.prototype.isBone=!0;var Ei=class extends Bt{constructor(e){super();this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new he(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new he(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ni,this.normalScale=new G(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this}};Ei.prototype.isMeshStandardMaterial=!0;var p1=new w,Yw=new w,lu=class extends vt{constructor(){super();this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);let t=e.levels;for(let r=0,o=t.length;r<o;r++){let n=t[r];this.addLevel(n.object.clone(),n.distance)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,t=0){t=Math.abs(t);let r=this.levels,o;for(o=0;o<r.length&&!(t<r[o].distance);o++);return r.splice(o,0,{distance:t,object:e}),this.add(e),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){let t=this.levels;if(t.length>0){let r,o;for(r=1,o=t.length;r<o&&!(e<t[r].distance);r++);return t[r-1].object}return null}raycast(e,t){if(this.levels.length>0){p1.setFromMatrixPosition(this.matrixWorld);let o=e.ray.origin.distanceTo(p1);this.getObjectForDistance(o).raycast(e,t)}}update(e){let t=this.levels;if(t.length>1){p1.setFromMatrixPosition(e.matrixWorld),Yw.setFromMatrixPosition(this.matrixWorld);let r=p1.distanceTo(Yw)/e.zoom;t[0].object.visible=!0;let o,n;for(o=1,n=t.length;o<n&&r>=t[o].distance;o++)t[o-1].object.visible=!1,t[o].object.visible=!0;for(this._currentLevel=o-1;o<n;o++)t[o].object.visible=!1}}toJSON(e){let t=super.toJSON(e);this.autoUpdate===!1&&(t.object.autoUpdate=!1),t.object.levels=[];let r=this.levels;for(let o=0,n=r.length;o<n;o++){let s=r[o];t.object.levels.push({object:s.object.uuid,distance:s.distance})}return t}};var $t=(i=>(i.OBJECT3D="Object3D",i.GROUP="Group",i.MESH="Mesh",i.POINTS="Points",i.LINE_SEGMENTS="LineSegments",i.LOD="LOD",i))($t||{}),$w={Mesh:lt,Group:ut,Points:Xi,LineSegments:Br,Object3D:vt,LOD:lu};function Zi(i){switch(i){case vt:return"Object3D";case ut:return"Group";case lt:return"Mesh";case Xi:return"Points";case Br:return"LineSegments";case lu:return"LOD";default:return Q.warn("object type not supported",i),"Mesh"}}function Kw(i){if(i instanceof lt)return"Mesh";if(i instanceof ut)return"Group";if(i instanceof Br)return"LineSegments";if(i instanceof Xi)return"Points";if(i instanceof vt)return"Object3D";Q.warn("ObjectTypeByObject received an unknown object type",i)}var H0=["Mesh","Points","LineSegments"],Jw=[{name:"Mesh",value:H0.indexOf("Mesh")},{name:"Points",value:H0.indexOf("Points")},{name:"LineSegments",value:H0.indexOf("LineSegments")}],kY={MeshStandard:new Ei({color:16777215,side:oo,metalness:.5,roughness:.9}),Mesh:new Ei({color:16777215,side:oo,metalness:0,roughness:.9}),Points:new Xs({color:16777215,size:.1,depthTest:!0}),LineSegments:new ur({color:16777215,linewidth:1})},jr=(i=>(i[i.VERTEX=0]="VERTEX",i[i.OBJECT=1]="OBJECT",i))(jr||{}),Lo=[0,1],h1=[{name:"vertex",value:0},{name:"object",value:1}],Ue=(i=>(i[i.NUMERIC=0]="NUMERIC",i[i.STRING=1]="STRING",i))(Ue||{}),At=[0,1],j0=[{name:"numeric",value:0},{name:"string",value:1}],Si=(i=>(i[i.FLOAT=1]="FLOAT",i[i.VECTOR2=2]="VECTOR2",i[i.VECTOR3=3]="VECTOR3",i[i.VECTOR4=4]="VECTOR4",i))(Si||{}),Zw=[1,2,3,4],Qw=[1,4],lc={ATTRIB_CLASS:{VERTEX:0,OBJECT:1},OBJECT_TYPES:H0,CONSTRUCTOR_NAMES_BY_CONSTRUCTOR_NAME:{[Ji.name]:"Scene",[ut.name]:"Group",[vt.name]:"Object3D",[lt.name]:"Mesh",[Xi.name]:"Points",[Br.name]:"LineSegments",[fs.name]:"Bone",[z0.name]:"SkinnedMesh"},CONSTRUCTORS_BY_NAME:{Mesh:lt,Points:Xi,LineSegments:Br},MATERIALS:kY};var mr=(i=>(i.POINT_INDEX="ptnum",i.OBJECT_INDEX="objnum",i.COLOR="color",i.NORMAL="normal",i.POSITION="position",i.PSCALE="pscale",i.UP="up",i.UV="uv",i.SCALE="scale",i.TANGENT="tangent",i))(mr||{}),BY={P:"position",N:"normal",Cd:"color"},wt=class{static remapName(e){return BY[e]||e}static arrayToIndexedArrays(e){let t={},r=0,o=[],n=[],s=0;for(;s<e.length;){let a=e[s],c=t[a];c!=null?o.push(c):(n.push(a),o.push(r),t[a]=r,r+=1),s++}return{indices:o,values:n}}static default_value(e){switch(e){case 1:return 0;case 2:return new G(0,0);case 3:return new w(0,0,0);default:throw`size ${e} not yet implemented`}}static copy(e,t,r=!0){let o=e==null?void 0:e.array,n=t==null?void 0:t.array;if(o&&n){let s=Math.min(o.length,n.length);for(let a=0;a<s;a++)n[a]=o[a];r&&(t.needsUpdate=!0)}}static attribSizeFromValue(e){if(K.isString(e)||K.isNumber(e))return Si.FLOAT;if(K.isArray(e))return e.length;switch(e.constructor){case G:return Si.VECTOR2;case w:return Si.VECTOR3;case Ie:return Si.VECTOR4}return 0}};var Rh=class{constructor(e){this._index=e}index(){return this._index}};var d1={POSITION:"position",NORMAL:"normal"};var FY={x:0,y:1,z:2,w:3,r:0,g:1,b:2},UY=".",Js=class extends Rh{constructor(e,t){super(t);this._coreGeometry=e,this._geometry=this._coreGeometry.geometry()}applyMatrix4(e){this.position().applyMatrix4(e)}coreGeometry(){return this._coreGeometry}geometry(){return this._geometry=this._geometry||this._coreGeometry.geometry()}attribSize(e){return e=wt.remapName(e),this._geometry.getAttribute(e).itemSize}hasAttrib(e){let t=wt.remapName(e);return this._coreGeometry.hasAttrib(t)}attribValue(e,t){if(e===mr.POINT_INDEX)return this.index();{let r=null,o=null;e[e.length-2]===UY&&(r=e[e.length-1],o=FY[r],e=e.substring(0,e.length-2));let n=wt.remapName(e),s=this._geometry.getAttribute(n);if(s){let{array:a}=s;if(this._coreGeometry.isAttribIndexed(n))return this.indexedAttribValue(n);{let c=s.itemSize,l=this._index*c;if(o==null)switch(c){case 1:return a[l];case 2:return t=t||new G,t.fromArray(a,l),t;break;case 3:return t=t||new w,t.fromArray(a,l),t;break;case 4:return t=t||new Ie,t.fromArray(a,l),t;break;default:throw`size not valid (${c})`}else switch(c){case 1:return a[l];default:return a[l+o]}}}else{let a=`attrib ${e} not found. availables are: ${Object.keys(this._geometry.attributes||{}).join(",")}`;throw console.warn(a),a}}}attribValueNumber(e){let t=wt.remapName(e);return this._geometry.getAttribute(t).array[this._index]}attribValueVector2(e,t){let r=wt.remapName(e),o=this._geometry.getAttribute(r);return t.fromArray(o.array,this._index*2),t}attribValueVector3(e,t){let r=wt.remapName(e),o=this._geometry.getAttribute(r);return t.fromArray(o.array,this._index*3),t}attribValueVector4(e,t){let r=wt.remapName(e),o=this._geometry.getAttribute(r);return t.fromArray(o.array,this._index*4),t}indexedAttribValue(e){let t=this.attribValueIndex(e);return this._coreGeometry.userDataAttrib(e)[t]}stringAttribValue(e){return this.indexedAttribValue(e)}attribValueIndex(e){return this._coreGeometry.isAttribIndexed(e)?this._geometry.getAttribute(e).array[this._index]:-1}isAttribIndexed(e){return this._coreGeometry.isAttribIndexed(e)}position(){return this._position||(this._position=this.getPosition(new w))}getPosition(e){let{array:t}=this._geometry.getAttribute(d1.POSITION);return e.fromArray(t,this._index*3)}setPosition(e){this.setAttribValueVector3(d1.POSITION,e)}normal(){return this._normal=this._normal||this.getNormal(new w)}getNormal(e){let{array:t}=this._geometry.getAttribute(d1.NORMAL);return e.fromArray(t,this._index*3)}setNormal(e){return this.setAttribValueVector3(d1.NORMAL,e)}setAttribValue(e,t){let r=this._geometry.getAttribute(e),o=r.array,n=r.itemSize;if(K.isArray(t)){for(let s=0;s<n;s++)o[this._index*n+s]=t[s];return}switch(n){case 1:o[this._index]=t;break;case 2:let s=t,a=this._index*2;o[a+0]=s.x,o[a+1]=s.y;break;case 3:let c=t.r!=null,l=this._index*3;if(c){let h=t;o[l+0]=h.r,o[l+1]=h.g,o[l+2]=h.b}else{let h=t;o[l+0]=h.x,o[l+1]=h.y,o[l+2]=h.z}break;case 4:let u=t,p=this._index*4;o[p+0]=u.x,o[p+1]=u.y,o[p+2]=u.z,o[p+3]=u.w;break;default:throw console.warn(`Point.set_attrib_value does not yet allow attrib size ${n}`),`attrib size ${n} not implemented`}}setAttribValueFromNumber(e,t){let o=this._geometry.getAttribute(e).array;o[this._index]=t}setAttribValueFromVector2(e,t){let r=this._geometry.getAttribute(e);t.toArray(r.array,this._index*2)}setAttribValueFromVector3(e,t){let r=this._geometry.getAttribute(e);t.toArray(r.array,this._index*3)}setAttribValueFromVector4(e,t){let r=this._geometry.getAttribute(e);t.toArray(r.array,this._index*4)}setAttribValueVector3(e,t){if(t==null)return;if(e==null)throw"Point.set_attrib_value requires a name";let o=this._geometry.getAttribute(e).array,n=this._index*3;o[n]=t.x,o[n+1]=t.y,o[n+2]=t.z}setAttribIndex(e,t){let r=this._geometry.getAttribute(e).array;return r[this._index]=t}};var f1=function(i){return function(e){return Math.pow(e,i)}},m1=function(i){return function(e){return 1-Math.abs(Math.pow(e-1,i))}},k4=function(i){return function(e){return e<.5?f1(i)(e*2)/2:m1(i)(e*2-1)/2+.5}},_1={ease_i2:f1(2),ease_o2:m1(2),ease_io2:k4(2),ease_i3:f1(3),ease_o3:m1(3),ease_io3:k4(3),ease_i4:f1(4),ease_o4:m1(4),ease_io4:k4(4),ease_i_sin:function(i){return 1+Math.sin(Math.PI/2*i-Math.PI/2)},ease_o_sin:function(i){return Math.sin(Math.PI/2*i)},ease_io_sin:function(i){return(1+Math.sin(Math.PI*i-Math.PI/2))/2},ease_i_elastic:function(i){return i==0?0:(.04-.04/i)*Math.sin(25*i)+1},ease_o_elastic:function(i){return i==1?1:.04*i/--i*Math.sin(25*i)},ease_io_elastic:function(i){return i==.5?0:(i-=.5)<0?(.02+.01/i)*Math.sin(50*i):(.02-.01/i)*Math.sin(50*i)+1}};var eM=Math.PI/180,VY=12.9898,GY=78.233,zY=43758.5453,Er=class{static clamp(e,t,r){return e<t?t:e>r?r:e}static fit01(e,t,r){return this.fit(e,0,1,t,r)}static fit(e,t,r,o,n){let s=r-t,a=n-o;return(e-t)/s*a+o}static blend(e,t,r){return(1-r)*e+r*t}static degrees_to_radians(e){return e*eM}static radians_to_degrees(e){return e/eM}static deg2rad(e){return this.degrees_to_radians(e)}static rad2deg(e){return this.radians_to_degrees(e)}static rand(e){return K.isNumber(e)?this.randFloat(e):this.randVec2(e)}static round(e,t){let r=e/t;return(e<0?Math.ceil(r):Math.floor(r))*t}static highest_even(e){return 2*Math.ceil(e*.5)}static randFloat(e,t=136574){return this._vec.x=e,this._vec.y=t,this.randVec2(this._vec)}static randVec2(e){let r=(e.x*VY+e.y*GY)%Math.PI;return this.fract(Math.sin(r)*zY)}static geodesic_distance(e,t){var r=6371e3,o=this.deg2rad(e.lat),n=this.deg2rad(t.lat),s=this.deg2rad(t.lat-e.lat),a=this.deg2rad(t.lng-e.lng),c=Math.sin(s/2)*Math.sin(s/2)+Math.cos(o)*Math.cos(n)*Math.sin(a/2)*Math.sin(a/2),l=2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c)),u=r*l;return u}static expand_triangle(e,t){e.getMidpoint(this._triangle_mid),this._triangle_mid_to_corner.copy(e.a).sub(this._triangle_mid),this._triangle_mid_to_corner.normalize().multiplyScalar(t),e.a.add(this._triangle_mid_to_corner),this._triangle_mid_to_corner.copy(e.b).sub(this._triangle_mid),this._triangle_mid_to_corner.normalize().multiplyScalar(t),e.b.add(this._triangle_mid_to_corner),this._triangle_mid_to_corner.copy(e.c).sub(this._triangle_mid),this._triangle_mid_to_corner.normalize().multiplyScalar(t),e.c.add(this._triangle_mid_to_corner)}static nearestPower2(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.log(2)))}static pow2Inverse(e){return Math.log(e)/Math.log(2)}};Er.Easing=_1;Er.fract=i=>i-Math.floor(i);Er._vec={x:0,y:136574};Er._triangle_mid=new w;Er._triangle_mid_to_corner=new w;var B4=class{constructor(e,t){this._coreGeometry=e,this._index=t,this._geometry=this._coreGeometry.geometry()}index(){return this._index}points(){return this._points=this._points||this._get_points()}applyMatrix4(e){for(let t of this.points())t.applyMatrix4(e)}_get_points(){var e;let t=((e=this._geometry.index)==null?void 0:e.array)||[],r=this._index*3;return[new Js(this._coreGeometry,t[r+0]),new Js(this._coreGeometry,t[r+1]),new Js(this._coreGeometry,t[r+2])]}positions(){return this._positions=this._positions||this._getPositions()}_getPositions(){let e=this.points();return[e[0].position(),e[1].position(),e[2].position()]}triangle(){return this._triangle=this._triangle||this._get_triangle()}_get_triangle(){let e=this.positions();return new as(e[0],e[1],e[2])}deltas(){return this._deltas=this._deltas||this._getDeltas()}_getDeltas(){let e=this.positions();return[e[1].clone().sub(e[0]),e[2].clone().sub(e[0])]}area(){return this.triangle().getArea()}center(e){let t=this.positions();return e.x=(t[0].x+t[1].x+t[2].x)/3,e.y=(t[0].y+t[1].y+t[2].y)/3,e.z=(t[0].z+t[1].z+t[2].z)/3,e}randomPosition(e){let t=[Er.randFloat(e),Er.randFloat(e*6541)];return t[0]+t[1]>1&&(t[0]=1-t[0],t[1]=1-t[1]),this.positions()[0].clone().add(this.deltas()[0].clone().multiplyScalar(t[0])).add(this.deltas()[1].clone().multiplyScalar(t[1]))}attribValueAtPosition(e,t){let r=new w;this.triangle().getBarycoord(t,r);let o=r.toArray(),s=this._geometry.attributes[e].itemSize,a=this.points().map(p=>p.attribValue(e)),c,l,u=0;switch(s){case 1:{l=0;for(let p of a)l+=p*o[u],u++;c=l;break}default:{for(let p of a){let h=p.multiplyScalar(o[u]);l?l.add(h):l=h,u++}c=l}}return c}static interpolatedValue(e,t,r,o){let n=[t.a,t.b,t.c],a=e.getAttribute("position").array,c=n.map(_=>new w(a[_*3+0],a[_*3+1],a[_*3+2])),l=o.itemSize,u=o.array,p=[];switch(l){case 1:p=n.map(_=>u[_]);break;case 2:p=n.map(_=>new G(u[_*2+0],u[_*2+1]));break;case 3:p=n.map(_=>new w(u[_*3+0],u[_*3+1],u[_*3+2]));break}let h=n.map((_,g)=>r.distanceTo(c[g])),d=$e.sum([h[0]*h[1],h[0]*h[2],h[1]*h[2]]),m=[h[1]*h[2]/d,h[0]*h[2]/d,h[0]*h[1]/d],f;switch(l){case 1:f=$e.sum(n.map((_,g)=>m[g]*p[g]));break;default:var x=n.map((_,g)=>p[g].multiplyScalar(m[g]));f=null;for(let _ of x)f?f.add(_):f=_}return f}};var uc=class{from_points(e){e=this._filter_points(e);let t=new De,r=new Ut(t),o=e[0];if(o!=null){let n=o.geometry(),s=o.coreGeometry(),a={};for(let u=0;u<e.length;u++)a[e[u].index()]=u;let c=this._indices_from_points(a,n);c&&t.setIndex(c);let{attributes:l}=n;for(let u of Object.keys(l))if(s.userDataAttribs()[u]!=null){let d=$e.uniq(e.map(x=>x.indexedAttribValue(u))),m={};d.forEach((x,_)=>m[x]=_),r.userDataAttribs()[u]=d;let f=[];for(let x of e){let _=m[x.indexedAttribValue(u)];f.push(_)}t.setAttribute(u,new Ce(f,1))}else{let d=l[u].itemSize,m=new Array(e.length*d);switch(d){case 1:for(let x=0;x<e.length;x++)m[x]=e[x].attribValue(u);break;default:let f;for(let x=0;x<e.length;x++)f=e[x].attribValue(u),f.toArray(m,x*d);break}t.setAttribute(u,new Ce(m,d))}}return t}};var F4=class extends uc{_filter_points(e){return e}_indices_from_points(e,t){let r=t.index;if(r!=null){let o=r.array,n=[],s,a;for(let c=0;c<o.length;c++)s=o[c],a=e[s],a!=null&&n.push(a);return n}}};var Zs=class{constructor(e,t){this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=Wx,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=qi()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,r){e*=this.stride,r*=t.stride;for(let o=0,n=this.stride;o<n;o++)this.array[e+o]=t.array[r+o];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=qi()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);let t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),r=new this.constructor(t,this.stride);return r.setUsage(this.usage),r}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=qi()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}};Zs.prototype.isInterleavedBuffer=!0;var Nr=new w,wi=class{constructor(e,t,r,o=!1){this.name="",this.data=e,this.itemSize=t,this.offset=r,this.normalized=o===!0}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,r=this.data.count;t<r;t++)Nr.x=this.getX(t),Nr.y=this.getY(t),Nr.z=this.getZ(t),Nr.applyMatrix4(e),this.setXYZ(t,Nr.x,Nr.y,Nr.z);return this}applyNormalMatrix(e){for(let t=0,r=this.count;t<r;t++)Nr.x=this.getX(t),Nr.y=this.getY(t),Nr.z=this.getZ(t),Nr.applyNormalMatrix(e),this.setXYZ(t,Nr.x,Nr.y,Nr.z);return this}transformDirection(e){for(let t=0,r=this.count;t<r;t++)Nr.x=this.getX(t),Nr.y=this.getY(t),Nr.z=this.getZ(t),Nr.transformDirection(e),this.setXYZ(t,Nr.x,Nr.y,Nr.z);return this}setX(e,t){return this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){return this.data.array[e*this.data.stride+this.offset]}getY(e){return this.data.array[e*this.data.stride+this.offset+1]}getZ(e){return this.data.array[e*this.data.stride+this.offset+2]}getW(e){return this.data.array[e*this.data.stride+this.offset+3]}setXY(e,t,r){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=r,this}setXYZ(e,t,r,o){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=o,this}setXYZW(e,t,r,o,n){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=o,this.data.array[e+3]=n,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");let t=[];for(let r=0;r<this.count;r++){let o=r*this.data.stride+this.offset;for(let n=0;n<this.itemSize;n++)t.push(this.data.array[o+n])}return new Ot(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new wi(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");let t=[];for(let r=0;r<this.count;r++){let o=r*this.data.stride+this.offset;for(let n=0;n<this.itemSize;n++)t.push(this.data.array[o+n])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}};wi.prototype.isInterleavedBufferAttribute=!0;function rM(i,e=!1){let t=i[0].index!==null,r=new Set(Object.keys(i[0].attributes)),o=new Set(Object.keys(i[0].morphAttributes)),n={},s={},a=i[0].morphTargetsRelative,c=new De,l=0;for(let u=0;u<i.length;++u){let p=i[u],h=0;if(t!==(p.index!==null))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(let d in p.attributes){if(!r.has(d))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+'. All geometries must have compatible attributes; make sure "'+d+'" attribute exists among all geometries, or in none of them.'),null;n[d]===void 0&&(n[d]=[]),n[d].push(p.attributes[d]),h++}if(h!==r.size)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+". Make sure all geometries have the same number of attributes."),null;if(a!==p.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(let d in p.morphAttributes){if(!o.has(d))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+".  .morphAttributes must be consistent throughout all geometries."),null;s[d]===void 0&&(s[d]=[]),s[d].push(p.morphAttributes[d])}if(c.userData.mergedUserData=c.userData.mergedUserData||[],c.userData.mergedUserData.push(p.userData),e){let d;if(t)d=p.index.count;else if(p.attributes.position!==void 0)d=p.attributes.position.count;else return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+". The geometry must have either an index or a position attribute"),null;c.addGroup(l,d,u),l+=d}}if(t){let u=0,p=[];for(let h=0;h<i.length;++h){let d=i[h].index;for(let m=0;m<d.count;++m)p.push(d.getX(m)+u);u+=i[h].attributes.position.count}c.setIndex(p)}for(let u in n){let p=tM(n[u]);if(!p)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+u+" attribute."),null;c.setAttribute(u,p)}for(let u in s){let p=s[u][0].length;if(p===0)break;c.morphAttributes=c.morphAttributes||{},c.morphAttributes[u]=[];for(let h=0;h<p;++h){let d=[];for(let f=0;f<s[u].length;++f)d.push(s[u][f][h]);let m=tM(d);if(!m)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+u+" morphAttribute."),null;c.morphAttributes[u].push(m)}}return c}function tM(i){let e,t,r,o=0;for(let a=0;a<i.length;++a){let c=i[a];if(c.isInterleavedBufferAttribute)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. InterleavedBufferAttributes are not supported."),null;if(e===void 0&&(e=c.array.constructor),e!==c.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(t===void 0&&(t=c.itemSize),t!==c.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(r===void 0&&(r=c.normalized),r!==c.normalized)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;o+=c.array.length}let n=new e(o),s=0;for(let a=0;a<i.length;++a)n.set(i[a].array,s),s+=i[a].array.length;return new Ot(n,t,r)}var HY="position",Lh=class{static createIndexIfNone(e){if(!e.index){let t=e.getAttribute(HY);if(t){let r=t.array;e.setIndex($e.range(r.length/3))}}}};var g1=class{static merge(e){if(e.length===0)return;for(let a of e)Lh.createIndexIfNone(a);let t=e.map(a=>new Ut(a)),r=t[0].indexedAttributeNames(),o={};for(let a of r){let c={},l=[];for(let p of t){let h=p.points();for(let d of h){l.push(d);let m=d.indexedAttribValue(a);c[m]!=null?c[m]:c[m]=Object.keys(c).length}}let u=Object.keys(c);for(let p of l){let h=p.indexedAttribValue(a),d=c[h];p.setAttribIndex(a,d)}o[a]=u}let n=rM(e),s=new Ut(n);return Object.keys(o).forEach(a=>{let c=o[a];s.setIndexedAttributeValues(a,c)}),n&&delete n.userData.mergedUserData,n}};var U4=class extends uc{_filter_points(e){var t;let r=e[0];if(r){let n=(t=r.geometry().getIndex())==null?void 0:t.array;if(n){let s={};for(let h of e)s[h.index()]=h;let a=[],c=n.length,l,u,p;for(let h=0;h<c;h+=3)l=s[n[h+0]],u=s[n[h+1]],p=s[n[h+2]],l&&u&&p&&(a.push(l),a.push(u),a.push(p));return a}}return[]}_indices_from_points(e,t){let r=t.index;if(r!=null){let o=r.array,n=[],s,a,c,l,u,p;for(let h=0;h<o.length;h+=3)s=o[h+0],a=o[h+1],c=o[h+2],l=e[s],u=e[a],p=e[c],l!=null&&u!=null&&p!=null&&(n.push(l),n.push(u),n.push(p));return n}}};var V4=class extends uc{_filter_points(e){var t;let r=e[0];if(r){let n=(t=r.geometry().getIndex())==null?void 0:t.array;if(n){let s={};for(let p of e)s[p.index()]=p;let a=[],c=n.length,l,u;for(let p=0;p<c;p+=2)l=s[n[p+0]],u=s[n[p+1]],l&&u&&(a.push(l),a.push(u));return a}}return[]}_indices_from_points(e,t){let r=t.index;if(r!=null){let o=r.array,n=[],s,a,c,l;for(let u=0;u<o.length;u+=2)s=o[u],a=o[u+1],c=e[s],l=e[a],c!=null&&l!=null&&(n.push(c),n.push(l));return n}}};var oM="isInstance",iM="indexed_attrib_values",Ih=class{constructor(i){this._geometry=i}dispose(){}geometry(){return this._geometry}uuid(){return this._geometry.uuid}boundingBox(){return this._bounding_box=this._bounding_box||this._create_bounding_box()}_create_bounding_box(){if(this._geometry.computeBoundingBox(),this._geometry.boundingBox)return this._geometry.boundingBox}markAsInstance(){this._geometry.userData[oM]=!0}static markedAsInstance(i){return i.userData[oM]===!0}markedAsInstance(){return Ih.markedAsInstance(this._geometry)}positionAttribName(){let i="position";return this.markedAsInstance()&&(i="instancePosition"),i}computeVertexNormals(){this._geometry.computeVertexNormals()}userDataAttribs(){return this._geometry.userData[iM]=this._geometry.userData[iM]||{}}indexedAttributeNames(){return Object.keys(this.userDataAttribs()||{})}userDataAttrib(i){return i=wt.remapName(i),this.userDataAttribs()[i]}isAttribIndexed(i){return i=wt.remapName(i),this.userDataAttrib(i)!=null}hasAttrib(i){return i===mr.POINT_INDEX?!0:(i=wt.remapName(i),this._geometry.attributes[i]!=null)}markAttribAsNeedsUpdate(i){i=wt.remapName(i);let e=this._geometry.attributes[i];e&&(e.needsUpdate=!0)}attribType(i){return this.isAttribIndexed(i)?Ue.STRING:Ue.NUMERIC}static attribNames(i){return Object.keys(i.attributes)}attribNames(){return Ih.attribNames(this._geometry)}static attribNamesMatchingMask(i,e){let t=Fe.attribNames(e),r=[];for(let o of this.attribNames(i))for(let n of t)Fe.matchMask(o,n)&&r.push(o);return $e.uniq(r)}attribSizes(){let i={};for(let e of this.attribNames())i[e]=this._geometry.attributes[e].itemSize;return i}attribSize(i){let e;return i=wt.remapName(i),(e=this._geometry.attributes[i])!=null?e.itemSize:i===mr.POINT_INDEX?1:0}setIndexedAttributeValues(i,e){this.userDataAttribs()[i]=e}setIndexedAttribute(i,e,t){this.setIndexedAttributeValues(i,e),this._geometry.setAttribute(i,new $x(t,1)),this._geometry.getAttribute(i).needsUpdate=!0}addNumericAttrib(i,e=1,t=0){let r=[],o=!1;if(K.isNumber(t)){for(let n=0;n<this.pointsCount();n++)for(let s=0;s<e;s++)r.push(t);o=!0}else if(e>1)if(K.isArray(t)){for(let n=0;n<this.pointsCount();n++)for(let s=0;s<e;s++)r.push(t[s]);o=!0}else{let n=t;if(e==2&&n.x!=null&&n.y!=null){for(let l=0;l<this.pointsCount();l++)r.push(n.x),r.push(n.y);o=!0}let s=t;if(e==3&&s.x!=null&&s.y!=null&&s.z!=null){for(let l=0;l<this.pointsCount();l++)r.push(s.x),r.push(s.y),r.push(s.z);o=!0}let a=t;if(e==3&&a.r!=null&&a.g!=null&&a.b!=null){for(let l=0;l<this.pointsCount();l++)r.push(a.r),r.push(a.g),r.push(a.b);o=!0}let c=t;if(e==4&&c.x!=null&&c.y!=null&&c.z!=null&&c.w!=null){for(let l=0;l<this.pointsCount();l++)r.push(c.x),r.push(c.y),r.push(c.z),r.push(c.w);o=!0}}if(o)this._geometry.setAttribute(i.trim(),new Ce(r,e));else throw console.warn(t),`CoreGeometry.add_numeric_attrib error: no other default value allowed for now in add_numeric_attrib (default given: ${t})`}initPositionAttribute(i,e){let t=[];e==null&&(e=new w);for(let r=0;r<i;r++)t.push(e.x),t.push(e.y),t.push(e.z);return this._geometry.setAttribute("position",new Ce(t,3))}addAttribute(i,e){switch(e.type()){case Ue.STRING:return console.log("TODO: to implement");case Ue.NUMERIC:return this.addNumericAttrib(i,e.size())}}renameAttrib(i,e){this.isAttribIndexed(i)&&(this.userDataAttribs()[e]=Cr.clone(this.userDataAttribs()[i]),delete this.userDataAttribs()[i]);let t=this._geometry.getAttribute(i);return this._geometry.setAttribute(e.trim(),new Ce(t.array,t.itemSize)),this._geometry.deleteAttribute(i)}deleteAttribute(i){return this.isAttribIndexed(i)&&delete this.userDataAttribs()[i],this._geometry.deleteAttribute(i)}clone(){return Ih.clone(this._geometry)}static clone(i){let e,t=i.clone();return(e=i.userData)!=null&&(t.userData=Cr.cloneDeep(e)),t}pointsCount(){return Ih.pointsCount(this._geometry)}static pointsCount(i){let e,t=0,r=new this(i),o="position";if(r.markedAsInstance()&&(o="instancePosition"),(e=i.getAttribute(o))!=null){let n;(n=e.array)!=null&&(t=n.length/3)}return t}points(){return this.pointsFromGeometry()}pointsFromGeometry(){let i=[],e=this._geometry.getAttribute(this.positionAttribName());if(e!=null){let t=e.array.length/3;for(let r=0;r<t;r++){let o=new Js(this,r);i.push(o)}}return i}static geometryFromPoints(i,e){switch(e){case $t.MESH:return this._mesh_builder.from_points(i);case $t.POINTS:return this._points_builder.from_points(i);case $t.LINE_SEGMENTS:return this._lines_segment_builder.from_points(i);case $t.OBJECT3D:return null;case $t.GROUP:return null;case $t.LOD:return null}Be.unreachable(e)}static mergeGeometries(i){return g1.merge(i)}static merge_geometries(i){return g1.merge(i)}segments(){var i;let e=((i=this.geometry().index)==null?void 0:i.array)||[];return $e.chunk(e,2)}faces(){return this.facesFromGeometry()}facesFromGeometry(){var i;let t=(((i=this.geometry().index)==null?void 0:i.array)||[]).length/3;return $e.range(t).map(r=>new B4(this,r))}},Ut=Ih;Ut._mesh_builder=new U4;Ut._points_builder=new F4;Ut._lines_segment_builder=new V4;var J=(i=>(i.BOOLEAN="boolean",i.BUTTON="button",i.COLOR="color",i.FLOAT="float",i.FOLDER="folder",i.INTEGER="integer",i.PARAM_PATH="param_path",i.NODE_PATH="node_path",i.RAMP="ramp",i.STRING="string",i.VECTOR2="vector2",i.VECTOR3="vector3",i.VECTOR4="vector4",i))(J||{});var Dh=class{constructor(e,t,r){if(this._type=e,this._name=t,this._defaultValue=r,t==""||t==null)throw new Error("name must not be an empty string")}static fromParam(e){return new Dh(e.type(),e.name(),e.defaultValue())}type(){return this._type}name(){return this._name}defaultValue(){return this._defaultValue}paramOptions(){let e=this._callback.bind(this);switch(this._type){case J.NODE_PATH:return{callback:e,nodeSelection:{context:oe.COP}};default:return{callback:e}}}applyToNode(e){if(!e.params.has(this._name))return;let t=e.params.get(this._name);if(!t)return;let r=this.paramOptions(),o=Object.keys(r);for(let n of o)t.options.setOption(n,r[n]);this.executeCallback(e,t),t.type()==J.NODE_PATH&&setTimeout(async()=>{t.isDirty()&&await t.compute(),t.options.executeCallback()},200)}executeCallback(e,t){this._callback(e,t)}_callback(e,t){}};var ms=class extends Dh{constructor(e,t,r,o){super(e,t,r);this._uniformName=o}toJSON(){return{type:this._type,name:this._name,defaultValue:this._defaultValue,uniformName:this._uniformName}}static fromJSON(e){return new ms(e.type,e.name,e.defaultValue,e.uniformName)}uniformName(){return this._uniformName}uniform(){return this._uniform=this._uniform||this._createUniform()}_createUniform(){return ms.uniformByType(this._type)}_callback(e,t){ms.callback(t,this.uniform())}static callback(e,t){switch(e.type()){case J.RAMP:t.value=e.rampTexture();return;case J.NODE_PATH:ms.set_uniform_value_from_texture_from_node_path_param(e,t);return;default:t.value=e.value}}static uniformByType(e){switch(e){case J.BOOLEAN:return{value:0};case J.BUTTON:return{value:0};case J.COLOR:return{value:new he(0,0,0)};case J.FLOAT:return{value:0};case J.FOLDER:return{value:0};case J.INTEGER:return{value:0};case J.NODE_PATH:return{value:0};case J.PARAM_PATH:return{value:0};case J.RAMP:return{value:null};case J.STRING:return{value:null};case J.VECTOR2:return{value:new G(0,0)};case J.VECTOR3:return{value:new w(0,0,0)};case J.VECTOR4:return{value:new Ie(0,0,0,0)}}Be.unreachable(e)}static async set_uniform_value_from_texture_from_node_path_param(e,t){e.isDirty()&&await e.compute();let r=e.value.nodeWithContext(oe.COP);if(r)if(r.isDirty())r.compute().then(o=>{let n=o.texture();t.value=n});else{let n=r.containerController.container().texture();t.value=n}else t.value=null}set_uniform_value_from_ramp(e,t){t.value=e.rampTexture()}};function nM(i,e,t){let r=uu.getUniforms(i);if(r){let o=r[e];o?o.value=t.value:r[e]=t}else q0.addAdditionalTexture(i,e,t)}var uu=class{static getUniforms(e){var t;return(t=e.userData)==null?void 0:t.uniforms}static setUniforms(e,t){e.userData.uniforms=t}static removeUniforms(e){let t=this.getUniforms(e);if(t){let r=e.userData;delete r.uniforms}return t}};function v1(i,e,t){q0.setData(e,t),e.onBeforeCompile=jY(i,e);let r=`${e.uuid}:${performance.now()}`;e.customProgramCacheKey=()=>r}function sM(i,e){let{src:t,dest:r,shareCustomUniforms:o}=e,n=q0.getData(t);if(n){let a=o?n:function(c){let l=W0.toJSON(c);return W0.fromJSON(l)}(n);v1(i,r,a)}}function jY(i,e){return r=>{let o=q0.getData(e);if(!o)return;let{vertexShader:n,fragmentShader:s,paramConfigs:a,additionalTextureUniforms:c,timeDependent:l,resolutionDependent:u}=o;r.vertexShader=n,r.fragmentShader=s,i.uniformsController.addUniforms(r.uniforms,{paramConfigs:a,additionalTextureUniforms:c,timeDependent:l,resolutionDependent:u});let p=e;p.vertexShader=r.vertexShader,p.fragmentShader=r.fragmentShader,uu.setUniforms(e,r.uniforms)}}var q0=class{static setData(e,t){e.userData.onBeforeCompileData=t}static addAdditionalTexture(e,t,r){let o=this.getData(e);o?o.additionalTextureUniforms[t]==null&&(o.additionalTextureUniforms[t]=r):console.warn("no data found on material",e)}static getData(e){return e.userData.onBeforeCompileData}static removeData(e){let t=this.getData(e);if(t){let r=e.userData;delete r.onBeforeCompileData}return t}},W0=class{static toJSON(e){return{vertexShader:e.vertexShader,fragmentShader:e.fragmentShader,timeDependent:e.timeDependent,resolutionDependent:e.resolutionDependent,paramConfigs:e.paramConfigs.map(r=>r.toJSON())}}static fromJSON(e){return{...e,additionalTextureUniforms:{},paramConfigs:e.paramConfigs.map(r=>ms.fromJSON(r))}}};var aM="POLY_render_hook",WY=(i,e,t,r,o,n)=>{},Qi=class{static node(e,t){return e.node(t.name)}static clone(e,t,r){let o=t.clone(),n=t.uniforms;return n&&(o.uniforms=Vm.clone(n)),sM(e,{src:t,dest:o,shareCustomUniforms:r.shareCustomUniforms}),o}static add_user_data_render_hook(e,t){e.userData[aM]=t}static apply_render_hook(e,t){if(t.userData){let r=t.userData[aM];if(r){e.onBeforeRender=(o,n,s,a,c,l)=>{r(o,n,s,a,c,l,e)};return}}e.onBeforeRender=WY}static applyCustomMaterials(e,t){let r=t;if(r.customMaterials)for(let o of Object.keys(r.customMaterials)){let n=o,s=r.customMaterials[n];s&&(e[n]=s,s.needsUpdate=!0)}}static assignUniforms(e,t,r,o){nM(e,t,r),o&&this.assignUniformForOnBeforeCompile(e,t,r,o)}static assignUniformForOnBeforeCompile(e,t,r,o){o.addAdditionalTextureUniforms(t,r)}};var G4="name",Qs="attributes",Or=class extends Rh{constructor(e,t){super(t);this._object=e,this._object.userData[Qs]==null&&(this._object.userData[Qs]={})}dispose(){}object(){return this._object}geometry(){return this._object.geometry}coreGeometry(){let e=this.geometry();return e?new Ut(e):null}points(){var e;return((e=this.coreGeometry())==null?void 0:e.points())||[]}pointsFromGroup(e){if(e){let t=Fe.indices(e);if(t){let r=this.points();return $e.compact(t.map(o=>r[o]))}else return[]}else return this.points()}static isInGroup(e,t){let r=e.trim();if(r.length==0)return!0;let o=r.split("="),n=o[0];if(n[0]=="@"){let s=n.substring(1),a=o[1],c=this.attribValue(t,s);return a==c}return!1}computeVertexNormals(){var e;(e=this.coreGeometry())==null||e.computeVertexNormals()}static _convert_array_to_vector(e){switch(e.length){case 1:return e[0];case 2:return new G(e[0],e[1]);case 3:return new w(e[0],e[1],e[2]);case 4:return new Ie(e[0],e[1],e[2],e[3])}}static addAttribute(e,t,r){if(K.isArray(r)&&!this._convert_array_to_vector(r)){let a="attribute_value invalid";throw console.error(a,r),new Error(a)}let o=r,n=e.userData;n[Qs]=n[Qs]||{},n[Qs][t]=o}addAttribute(e,t){Or.addAttribute(this._object,e,t)}addNumericAttrib(e,t){this.addAttribute(e,t)}setAttribValue(e,t){this.addAttribute(e,t)}addNumericVertexAttrib(e,t,r){var o;r==null&&(r=wt.default_value(t)),(o=this.coreGeometry())==null||o.addNumericAttrib(e,t,r)}attributeNames(){return Object.keys(this._object.userData[Qs])}attribNames(){return this.attributeNames()}hasAttrib(e){return this.attributeNames().includes(e)}renameAttrib(e,t){let r=this.attribValue(e);r!=null?(this.addAttribute(t,r),this.deleteAttribute(e)):console.warn(`attribute ${e} not found`)}deleteAttribute(e){delete this._object.userData[Qs][e]}static attribValue(e,t,r=0,o){if(t===mr.OBJECT_INDEX)return r;if(e.userData&&e.userData[Qs]){let n=e.userData[Qs][t];if(n==null){if(t==G4)return e.name}else if(K.isArray(n)&&o)return o.fromArray(n),o;return n}if(t==G4)return e.name}static stringAttribValue(e,t,r=0){let o=this.attribValue(e,t,r);if(o!=null)return K.isString(o)?o:`${o}`}attribValue(e,t){return Or.attribValue(this._object,e,this._index,t)}stringAttribValue(e){return Or.stringAttribValue(this._object,e,this._index)}name(){return this.attribValue(G4)}humanType(){return lc.CONSTRUCTOR_NAMES_BY_CONSTRUCTOR_NAME[this._object.constructor.name]}attribTypes(){let e={};for(let t of this.attribNames()){let r=this.attribType(t);r!=null&&(e[t]=r)}return e}attribType(e){let t=this.attribValue(e);return K.isString(t)?Ue.STRING:Ue.NUMERIC}attribSizes(){let e={};for(let t of this.attribNames()){let r=this.attribSize(t);r!=null&&(e[t]=r)}return e}attribSize(e){let t=this.attribValue(e);return t==null?null:wt.attribSizeFromValue(t)}clone(){return Or.clone(this._object)}static clone(e){let t=e.clone();var r=new Map,o=new Map;return Or.parallelTraverse(e,t,function(n,s){r.set(s,n),o.set(n,s)}),t.traverse(function(n){let s=r.get(n),a=n;if(a.geometry&&s&&s.geometry){let p=s.geometry;a.geometry=Ut.clone(p);let h=a.geometry;h.userData&&(h.userData=Cr.cloneDeep(p.userData))}if(a.material){Qi.applyCustomMaterials(n,a.material);let p=a.material;p.color==null&&(p.color=new he(1,1,1))}if(s){s.userData&&(n.userData=Cr.cloneDeep(s.userData));let p=s;p.animations&&(n.animations=p.animations.map(d=>d.clone()));let h=n;if(h.isSkinnedMesh){var c=h,l=s,u=l.skeleton.bones;c.skeleton=l.skeleton.clone(),c.bindMatrix.copy(l.bindMatrix);let d=u.map(function(m){return o.get(m)});c.skeleton.bones=d,c.bind(c.skeleton,c.bindMatrix)}}}),t}static parallelTraverse(e,t,r){r(e,t);for(var o=0;o<e.children.length;o++)this.parallelTraverse(e.children[o],t.children[o],r)}};var z4=class extends hr{coreContentCloned(){if(this._content)return this._content.clone()}set_content(e){super.set_content(e)}firstObject(){if(this._content)return this._content.objects()[0]}firstCoreObject(){let e=this.firstObject();if(e)return new Or(e,0)}firstGeometry(){let e=this.firstObject();return e?e.geometry:null}objectsCount(){return this._content?this._content.objects().length:0}objectsVisibleCount(){let e=0;if(this._content){let t=this._content.objects();for(let r of t)r.visible&&e++}return e}objectsCountByType(){let e={},t=this._content;if(this._content&&t)for(let r of t.coreObjects()){let o=r.humanType();e[o]==null&&(e[o]=0),e[o]+=1}return e}objectsNamesByType(){let e={},t=this._content;if(this._content&&t)for(let r of t.coreObjects()){let o=r.humanType();e[o]=e[o]||[],e[o].push(r.name())}return e}pointAttributeNames(){let e=[],t=this.firstGeometry();return t&&(e=Object.keys(t.attributes)),e}pointAttributeSizesByName(){let e={},t=this.firstGeometry();return t&&Object.keys(t.attributes).forEach(r=>{let o=t.attributes[r];e[r]=o.itemSize}),e}objectAttributeSizesByName(){let e={},t=this.firstCoreObject();if(t){let r=t.attribNames();for(let o of r){let n=t.attribSize(o);n!=null&&(e[o]=n)}}return e}pointAttributeTypesByName(){let e={},t=this.firstGeometry();if(t){let r=new Ut(t);Object.keys(t.attributes).forEach(o=>{e[o]=r.attribType(o)})}return e}objectAttributeTypesByName(){let e={},t=this.firstCoreObject();if(t)for(let r of t.attribNames())e[r]=t.attribType(r);return e}objectAttributeNames(){let e=[],t=this.firstObject();return t&&(e=Object.keys(t.userData.attributes||{})),e}pointsCount(){return this._content?this._content.pointsCount():0}totalPointsCount(){return this._content?this._content.totalPointsCount():0}objectsData(){return this._content?this._content.objectsData():[]}boundingBox(e=!1){return this._content.boundingBox(e)}center(){return this._content.center()}size(){return this._content.size()}};var H4=class extends hr{object(){return this._content}};var j4=class extends hr{object(){return this._content}};var W4=class extends hr{set_content(e){super.set_content(e)}};var q4=class extends hr{set_content(e){super.set_content(e)}set_material(e){this._content!=null&&this._content.dispose(),this.set_content(e)}has_material(){return this.has_content()}material(){return this.content()}};var X4=class extends hr{set_content(e){super.set_content(e)}set_object(e){return this.set_content(e)}has_object(){return this.has_content()}object(){return this.content()}};var Y4=class extends hr{set_content(e){super.set_content(e)}texture(){return this._content}coreContent(){return this._content}coreContentCloned(){var e;let t=(e=this._content)==null?void 0:e.clone();return t&&(t.needsUpdate=!0),t}object(){return this.texture()}infos(){if(this._content!=null)return[this._content]}resolution(){if(this._content){let e=this._content.image;if(e){if(e instanceof HTMLImageElement||e instanceof Image||e instanceof ImageData||e instanceof HTMLCanvasElement)return[e.width,e.height];if(e.data&&e.width!=null&&e.height!=null)return[e.width,e.height];let t=e;return[t.videoWidth,t.videoHeight]}}return[-1,-1]}};var $4=class extends hr{set_content(e){super.set_content(e)}render_pass(){return this._content}object(e={}){return this.render_pass()}};var K4=class extends hr{set_content(e){super.set_content(e)}renderer(){return this._content}};var cM={[oe.ANIM]:L4,[oe.AUDIO]:I4,[oe.COP]:Y4,[oe.EVENT]:D4,[oe.GL]:H4,[oe.JS]:j4,[oe.MANAGER]:W4,[oe.MAT]:q4,[oe.OBJ]:X4,[oe.POST]:$4,[oe.ROP]:K4,[oe.SOP]:z4};var J4=class{constructor(e){this.node=e,this._callbacks=[],this._callbacks_tmp=[];let t=cM[e.context()];this._container=new t(this.node)}container(){return this._container}containerUnlessBypassed(){var e,t;if((t=(e=this.node.flags)==null?void 0:e.bypass)==null?void 0:t.active()){let r=this.node.io.inputs.input(0);if(r)return r.containerController.containerUnlessBypassed()}else return this.container()}async compute(){var e,t;if((t=(e=this.node.flags)==null?void 0:e.bypass)==null?void 0:t.active()){let r=await this.requestInputContainer(0)||this._container;return this.node.cookController.endCook(),r}return this.node.isDirty()?new Promise((r,o)=>{var n,s;if(this._callbacks.push(r),(s=(n=this.node.flags)==null?void 0:n.bypass)==null?void 0:s.active())throw"we should not be here";this.node.cookController.cookMain()}):this._container}async requestInputContainer(e){let t=this.node.io.inputs.input(e);return t?await t.compute():(this.node.states.error.set(`input ${e} required`),this.notifyRequesters(),null)}notifyRequesters(e){this._callbacks_tmp=this._callbacks.slice(),this._callbacks.splice(0,this._callbacks.length),e||(e=this.node.containerController.container());let t;for(;t=this._callbacks_tmp.pop();)t(e);this.node.scene().cookController.removeNode(this.node)}};var pu=Q.performance.performanceManager(),Z4=class{constructor(e){this.cookController=e,this._inputsStart=0,this._inputsTime=0,this._paramsStart=0,this._paramsTime=0,this._cookStart=0,this._cookTime=0,this._cooksCount=0,this._data={inputsTime:0,paramsTime:0,cookTime:0}}cooksCount(){return this._cooksCount}data(){return this._data.inputsTime=this._inputsTime,this._data.paramsTime=this._paramsTime,this._data.cookTime=this._cookTime,this._data}active(){return this.cookController.performanceRecordStarted()}recordInputsStart(){this.active()&&(this._inputsStart=pu.now())}recordInputsEnd(){this.active()&&(this._inputsTime=pu.now()-this._inputsStart)}recordParamsStart(){this.active()&&(this._paramsStart=pu.now())}recordParamsEnd(){this.active()&&(this._paramsTime=pu.now()-this._paramsStart)}recordCookStart(){this.active()&&(this._cookStart=pu.now())}recordCookEnd(){this.active()&&(this._cookTime=pu.now()-this._cookStart,this._cooksCount+=1)}};var Q4=class{constructor(e){this.node=e,this._cooking=!1,this._performanceController=new Z4(this),this._inputsEvaluationRequired=!0,this._corePerformance=this.node.scene().performance}performanceRecordStarted(){return this._corePerformance.started()}dispose(){this._clearHooks()}disallowInputsEvaluation(){this._inputsEvaluationRequired=!1}isCooking(){return this._cooking===!0}_startCookIfNoErrors(e){if(this.node.states.error.active())this.endCook();else try{this._performanceController.recordCookStart(),this.node.cook(e||[])}catch(t){this.node.states.error.set(`node internal error: '${t}'.`),Q.warn(t),this.endCook()}}async cookMain(){if(this.isCooking())return;this._initCookingState(),this.node.states.error.clear(),this.node.scene().cookController.addNode(this.node);let e=this._inputsEvaluationRequired?await this._evaluateInputs():void 0;this.node.params.paramsEvalRequired()&&await this._evaluateParams(),this._startCookIfNoErrors(e)}async cookMainWithoutInputs(){if(this.node.scene().cookController.addNode(this.node),this.isCooking()){Q.warn("cook_main_without_inputs already cooking",this.node.path());return}this._initCookingState(),this.node.states.error.clear(),this.node.params.paramsEvalRequired()&&await this._evaluateParams(),this._startCookIfNoErrors(void 0)}endCook(e){var t,r;this._finalizeCookPerformance();let o=this.node.dirtyController.dirtyTimestamp();if(o==null||o===this._cookingDirtyTimestamp)this.node.removeDirtyState(),this._terminateCookProcess();else{if((r=(t=this.node.flags)==null?void 0:t.bypass)==null?void 0:r.active())return;Q.log("COOK AGAIN",o,this._cookingDirtyTimestamp,this.node.path()),this._cooking=!1,this.cookMain()}}_initCookingState(){this._cooking=!0,this._cookingDirtyTimestamp=this.node.dirtyController.dirtyTimestamp()}_terminateCookProcess(){this.isCooking()&&(this._cooking=!1,this.node.containerController.notifyRequesters(),this._run_on_cook_complete_hooks())}async _evaluateInputs(){this._performanceController.recordInputsStart();let e=this.node.io.inputs,t=this._inputsEvaluationRequired?e.isAnyInputDirty()?await e.evalRequiredInputs():e.containersWithoutEvaluation():[],r=e.inputs(),o=[],n;for(let s=0;s<r.length;s++)n=t[s],n&&(e.cloneRequired(s)?o[s]=n.coreContentCloned():o[s]=n.coreContent());return this._performanceController.recordInputsEnd(),o}async _evaluateParams(){this._performanceController.recordParamsStart(),await this.node.params.evalAll(),this._performanceController.recordParamsEnd()}cooksCount(){return this._performanceController.cooksCount()}cookTime(){return this._performanceController.data().cookTime}_finalizeCookPerformance(){!this._corePerformance.started()||(this._performanceController.recordCookEnd(),this._corePerformance.recordNodeCookData(this.node,this._performanceController.data()))}registerOnCookEnd(e,t){this._on_cook_complete_hook_names=this._on_cook_complete_hook_names||[],this._on_cook_complete_hooks=this._on_cook_complete_hooks||[],this._on_cook_complete_hook_names.push(e),this._on_cook_complete_hooks.push(t)}_clearHooks(){if(!(!this._on_cook_complete_hook_names||!this._on_cook_complete_hooks))for(let e of this._on_cook_complete_hook_names)this.deregisterOnCookEnd(e)}deregisterOnCookEnd(e){var t;if(!this._on_cook_complete_hook_names||!this._on_cook_complete_hooks)return;let r=(t=this._on_cook_complete_hook_names)==null?void 0:t.indexOf(e);this._on_cook_complete_hook_names.splice(r,1),this._on_cook_complete_hooks.splice(r,1),this._on_cook_complete_hook_names.length==0&&(this._on_cook_complete_hook_names=void 0),this._on_cook_complete_hooks.length==0&&(this._on_cook_complete_hooks=void 0)}_run_on_cook_complete_hooks(){if(this._on_cook_complete_hooks)for(let e of this._on_cook_complete_hooks)e()}onCookEndCallbackNames(){return this._on_cook_complete_hook_names}};var kh=class{constructor(e){this.node=e}dispose(){}toJSON(e=!1){var t,r,o,n,s,a;let c={name:this.node.name(),type:this.node.type(),graph_node_id:this.node.graphNodeId(),is_dirty:this.node.isDirty(),ui_data_json:this.node.uiData.toJSON(),error_message:this.node.states.error.message(),children:this.childrenIds(),maxInputsCount:this.maxInputsCount(),inputs:this.inputIds(),input_connection_output_indices:this.inputConnectionOutputIndices(),named_input_connection_points:this.namedInputConnectionPoints(),named_output_connection_points:this.namedOutputConnectionPoints(),param_ids:this.to_json_params(e),override_cloned_state_allowed:this.node.io.inputs.overrideClonedStateAllowed(),inputs_clone_required_states:this.node.io.inputs.cloneRequiredStates(),flags:{display:(r=(t=this.node.flags)==null?void 0:t.display)==null?void 0:r.active(),bypass:(n=(o=this.node.flags)==null?void 0:o.bypass)==null?void 0:n.active(),optimize:(a=(s=this.node.flags)==null?void 0:s.optimize)==null?void 0:a.active()},selection:void 0};return this.node.childrenAllowed()&&this.node.childrenController&&(c.selection=this.node.childrenController.selection.toJSON()),c}childrenIds(){return this.node.children().map(e=>e.graphNodeId())}maxInputsCount(){return this.node.io.inputs.maxInputsCount()}inputIds(){return this.node.io.inputs.inputs().map(e=>e!=null?e.graphNodeId():void 0)}inputConnectionOutputIndices(){var e;return(e=this.node.io.connections.inputConnections())==null?void 0:e.map(t=>t!=null?t.output_index:void 0)}namedInputConnectionPoints(){return this.node.io.inputs.namedInputConnectionPoints().map(e=>e.toJSON())}namedOutputConnectionPoints(){return this.node.io.outputs.namedOutputConnectionPoints().map(e=>e.toJSON())}to_json_params_from_names(e,t=!1){return e.map(r=>this.node.params.get(r).graphNodeId())}to_json_params(e=!1){return this.to_json_params_from_names(this.node.params.names,e)}};var sr=(i=>(i.VISIBLE_UPDATED="param_visible_updated",i.EDITABLE_UPDATED="param_editable_updated",i.RAW_INPUT_UPDATED="raw_input_updated",i.VALUE_UPDATED="param_value_updated",i.EXPRESSION_UPDATED="param_expression_update",i.ERROR_UPDATED="param_error_updated",i.DELETED="param_deleted",i))(sr||{});var x1="callback",e5="callbackString",qY="computeOnDirty",XY="cook",YY="fileBrowse",$Y="type",KY="expression",JY="forEntities",ZY="label",QY="hideLabel",e$="level",t$="menu",r$="menuString",o$="entries",i$="multiline",n$="language",s$="nodeSelection",a$="context",c$="types",lM="dependentOnFoundNode",l$="range",u$="rangeLocked",p$="step",h$="spare",d$="texture",f$="env",uM="hidden",m$="field",t5="visibleIf",_$="conversion",g$="separatorBefore",v$="separatorAfter",x$="joinToPreviousParam",r5="editable",o5=(i=>(i.TYPESCRIPT="typescript",i.JSON="json",i))(o5||{}),pc=(i=>(i.AUDIO="audio",i.TEXTURE_IMAGE="texture_image",i.TEXTURE_VIDEO="texture_video",i.GEOMETRY="geometry",i.FONT="font",i.SVG="svg",i.JSON="json",i))(pc||{}),y1=class{constructor(e){this._param=e,this._programatic_visible_state=!0,this._callbackAllowed=!1,this._updateVisibilityAndRemoveDirtyBound=this.updateVisibilityAndRemoveDirty.bind(this),this._ui_data_dependency_set=!1}dispose(){var e;try{this._options[x1]=void 0,this._options[e5]=void 0}catch{}(e=this._visibility_graph_node)==null||e.dispose()}set(e){K.isString(e)&&console.warn("options input invalid",e,typeof e),this._default_options=e,this._options=Cr.cloneDeep(this._default_options),this.post_set_options()}copy(e){this._default_options=Cr.cloneDeep(e.default()),this._options=Cr.cloneDeep(e.current()),this.post_set_options()}setOption(e,t){if(this._options[e]=t,this._param.components)for(let r of this._param.components)r.options.setOption(e,t)}post_set_options(){this._handleComputeOnDirty()}param(){return this._param}node(){return this._param.node}default(){return this._default_options}current(){return this._options}hasOptionsOverridden(){return!Cr.isEqual(this._options,this._default_options)}overriddenOptions(){let e={},t=Object.keys(this._options);for(let r of t)if(!Cr.isEqual(this._options[r],this._default_options[r])){let o=Cr.cloneDeep(this._options[r]);Object.assign(e,{[r]:o})}return e}overriddenOptionNames(){return Object.keys(this.overriddenOptions())}computeOnDirty(){return this._options[qY]||!1}_handleComputeOnDirty(){this.computeOnDirty()&&(this._computeOnDirty_callback_added||(this.param().addPostDirtyHook("computeOnDirty",this._computeParam.bind(this)),this._computeOnDirty_callback_added=!0))}async _computeParam(){await this.param().compute()}hasCallback(){return this._options[x1]!=null||this._options[e5]!=null}allowCallback(){this._callbackAllowed=!0}executeCallback(){if(!this._callbackAllowed||!this.node())return;let e=this.getCallback();if(!e||!this.node().scene().loadingController.loaded())return;let t=this.param().parentParam();t?t.options.executeCallback():e(this.node(),this.param())}getCallback(){if(this.hasCallback())return this._options[x1]=this._options[x1]||this.createCallbackFromString()}createCallbackFromString(){let e=this._options[e5];if(e){let t=new Function("node","scene","window","location",e);return()=>{t(this.node(),this.node().scene(),null,null)}}}colorConversion(){return this._options[_$]}makesNodeDirtyWhenDirty(){if(this.param().parentParam()!=null)return!1;let e=this._options[XY];return e??!0}fileBrowseOption(){return this._options[YY]}fileBrowseAllowed(){return this.fileBrowseOption()!=null}fileBrowseType(){let e=this.fileBrowseOption();return e?e[$Y]:null}separatorBefore(){return this._options[g$]}separatorAfter(){return this._options[v$]}joinToPreviousParam(){return this._options[x$]}setEditableState(e){let t=this._options[r5],r=this.param();if(t!=e&&(this._options[r5]=e,r.emit(sr.EDITABLE_UPDATED)),r.components)for(let o of r.components)o.options.setEditableState(e)}editable(){let e=this._options[r5];return e??!0}isExpressionForEntities(){let e=this._options[KY];return e&&e[JY]||!1}level(){return this._options[e$]||0}hasMenu(){return this.menuOptions()!=null||this.menuStringOptions()!=null}menuOptions(){return this._options[t$]}menuStringOptions(){return this._options[r$]}menuEntries(){let e=this.menuOptions()||this.menuStringOptions();return e?e[o$]:[]}isMultiline(){return this._options[i$]===!0}language(){return this._options[n$]}isCode(){return this.language()!=null}nodeSelectionOptions(){return this._options[s$]}nodeSelectionContext(){let e=this.nodeSelectionOptions();if(e)return e[a$]}nodeSelectionTypes(){let e=this.nodeSelectionOptions();if(e)return e[c$]}dependentOnFoundNode(){return lM in this._options?this._options[lM]:!0}isSelectingParam(){return this.param().type()==J.PARAM_PATH}range(){return this._options[l$]||[0,1]}step(){return this._options[p$]}rangeLocked(){return this._options[u$]||[!1,!1]}ensureInRange(e){let t=this.range();return e>=t[0]&&e<=t[1]?e:e<t[0]?this.rangeLocked()[0]===!0?t[0]:e:this.rangeLocked()[1]===!0?t[1]:e}isSpare(){return this._options[h$]||!1}textureOptions(){return this._options[d$]}textureAsEnv(){let e=this.textureOptions();return e!=null?e[f$]===!0:!1}isHidden(){return this._options[uM]===!0||this._programatic_visible_state===!1}isVisible(){return!this.isHidden()}setVisibleState(e){this._options[uM]=!e,this.param().emit(sr.VISIBLE_UPDATED)}label(){return this._options[ZY]}isLabelHidden(){let e=this.param().type();return e===J.BUTTON?!0:e===J.BOOLEAN?this.isFieldHidden():e==J.RAMP&&this._options[QY]||!1}isFieldHidden(){return this._options[m$]===!1}uiDataDependsOnOtherParams(){return t5 in this._options}visibilityPredecessors(){let e=this._options[t5];if(!e)return[];let t=[];K.isArray(e)?t=$e.uniq(e.map(o=>Object.keys(o)).flat()):t=Object.keys(e);let r=this.param().node;return $e.compact(t.map(o=>{let n=r.params.get(o);if(n)return n;console.error(`param ${o} not found as visibility condition for ${this.param().name()} in node ${this.param().node.type()}`)}))}setUiDataDependency(){if(this._ui_data_dependency_set)return;this._ui_data_dependency_set=!0;let e=this.visibilityPredecessors();if(e.length>0){this._visibility_graph_node=new Yt(this.param().scene(),"param_visibility");for(let t of e)this._visibility_graph_node.addGraphInput(t);this._visibility_graph_node.addPostDirtyHook("_update_visibility_and_remove_dirty",this._updateVisibilityAndRemoveDirtyBound)}}updateVisibilityAndRemoveDirty(){this.updateVisibility(),this.param().removeDirtyState()}async updateVisibility(){let e=this._options[t5];if(e){let t=this.visibilityPredecessors(),r=t.map(o=>{if(o.isDirty())return o.compute()});if(this._programatic_visible_state=!1,await Promise.all(r),K.isArray(e))for(let o of e)t.filter(s=>s.value==o[s.name()]).length==t.length&&(this._programatic_visible_state=!0);else{let o=t.filter(n=>n.value==e[n.name()]);this._programatic_visible_state=o.length==t.length}this.param().emit(sr.VISIBLE_UPDATED)}}};var b1=class{constructor(e){this.param=e,this._blockedEmit=!1,this._blockedParentEmit=!1,this._countByEventName=new Map}emitAllowed(){return this._blockedEmit===!0||this.param.scene().loadingController.isLoading()?!1:this.param.scene().dispatchController.emitAllowed()}blockEmit(){if(this._blockedEmit=!0,this.param.isMultiple()&&this.param.components)for(let e of this.param.components)e.emitController.blockEmit();return!0}unblockEmit(){if(this._blockedEmit=!1,this.param.isMultiple()&&this.param.components)for(let e of this.param.components)e.emitController.unblockEmit();return!0}blockParentEmit(){return this._blockedParentEmit=!0,!0}unblockParentEmit(){return this._blockedParentEmit=!1,!0}incrementCount(e){let t=(this._countByEventName.get(e)||0)+1;this._countByEventName.set(e,t)}eventsCount(e){return this._countByEventName.get(e)||0}emit(e){if(this.emitAllowed()){this.param.emit(e);let t=this.param.parentParam();t!=null&&this._blockedParentEmit!==!0&&t.emit(e)}}};var i5=class{constructor(e){this.param=e}toJSON(){let e={name:this.param.name(),type:this.param.type(),raw_input:this.rawInput(),value:this.value(),value_pre_conversion:this.value_pre_conversion(),expression:this.expression(),graph_node_id:this.param.graphNodeId(),error_message:this.error_message(),is_visible:this.is_visible(),editable:this.editable(),components:void 0};return this.param.isMultiple()&&this.param.components&&(e.components=this.param.components.map(t=>t.graphNodeId())),e}rawInput(){return this.param.rawInputSerialized()}value(){return this.param.valueSerialized()}value_pre_conversion(){return this.param.valuePreConversionSerialized()}expression(){var e;return this.param.hasExpression()?(e=this.param.expressionController)==null?void 0:e.expression():void 0}error_message(){return this.param.states.error.message()}is_visible(){return this.param.options.isVisible()}editable(){return this.param.options.editable()}};var n5=class{constructor(e){this.param=e}active(){let e=this.param.scene().timeController.graphNode.graphNodeId();return this.param.graphPredecessorIds().includes(e)}};var s5=class{constructor(e){this.param=e}set(e){this._message!=e&&(this._message=e,this._message&&Q.warn(this.param.path(),this._message),this.param.emitController.emit(sr.ERROR_UPDATED))}message(){return this._message}clear(){this.set(void 0)}active(){return this._message!=null}};var a5=class{constructor(e){this.param=e,this.timeDependent=new n5(this.param),this.error=new s5(this.param)}};var hc=class extends Yt{constructor(e,t,r){super(e.scene(),"MethodDependency");this.param=e,this.path_argument=t,this.decomposed_path=r,this._update_from_name_change_bound=this._update_from_name_change.bind(this);var o;(o=e.expressionController)==null||o.registerMethodDependency(this),this.addPostDirtyHook("_update_from_name_change",this._update_from_name_change_bound)}_update_from_name_change(e){if(e&&this.decomposed_path){let t=e;this.decomposed_path.update_from_name_change(t);let r=this.decomposed_path.to_path(),o=this.jsep_node;o&&(o.value=`${o.value}`.replace(`${this.path_argument}`,r),o.raw=o.raw.replace(`${this.path_argument}`,r)),this.param.expressionController&&this.param.expressionController.updateFromMethodDependencyNameChange()}}reset(){this.graphDisconnectPredecessors()}listen_for_name_changes(){if(this.jsep_node&&this.decomposed_path){for(let e of this.decomposed_path.named_nodes())if(e){let t=e;t.nameController&&this.addGraphInput(t.nameController.graph_node)}}}set_jsep_node(e){this.jsep_node=e}set_resolved_graph_node(e){this.resolved_graph_node=e}set_unresolved_path(e){this.unresolved_path=e}static create(e,t,r,o){let n=K.isNumber(t),s=new hc(e,t,o);if(r)s.set_resolved_graph_node(r);else if(!n){let a=t;s.set_unresolved_path(a)}return s}};var y$=[],fo=class extends Yt{constructor(e,t){super(e,"BaseParam");this._options=new y1(this),this._emitController=new b1(this),this._isComputing=!1,this._node=t,this._initializeParam()}get options(){return this._options=this._options||new y1(this)}get emitController(){return this._emitController=this._emitController||new b1(this)}get expressionController(){return this._expression_controller}get serializer(){return this._serializer=this._serializer||new i5(this)}get states(){return this._states=this._states||new a5(this)}dispose(){var e,t;let r=this.graphPredecessors();for(let n of r)n instanceof hc&&n.dispose();let o=this.graphSuccessors();for(let n of o)if(n instanceof fo){let s=n.rawInputSerialized();n.set(n.defaultValue()),n.set(s)}else n.setDirty();this.scene().missingExpressionReferencesController.deregisterParam(this),(e=this._expression_controller)==null||e.dispose(),super.dispose(),(t=this._options)==null||t.dispose(),this._node=void 0,this._parent_param=void 0}_initializeParam(){}static type(){return J.FLOAT}type(){return this.constructor.type()}isNumeric(){return!1}setName(e){super.setName(e)}get value(){return this._value}copyValue(e){e.type()==this.type()?this._copyValue(e):console.warn(`cannot copy value from ${e.type()} to ${this.type()}`)}_copyValue(e){throw"abstract method param._copy_value"}valuePreConversionSerialized(){}convert(e){return null}static areRawInputEqual(e,t){return!1}isRawInputEqual(e){return this.constructor.areRawInputEqual(this._raw_input,e)}static areValuesEqual(e,t){return!1}isValueEqual(e){return this.constructor.areValuesEqual(this.value,e)}_cloneRawInput(e){return e}set(e){this._raw_input=this._cloneRawInput(this._prefilterInvalidRawInput(e)),this.emitController.emit(sr.RAW_INPUT_UPDATED),this.processRawInput()}_prefilterInvalidRawInput(e){return e}defaultValue(){return this._default_value}isDefault(){return this._raw_input==this._default_value}rawInput(){return this._raw_input}processRawInput(){}async compute(){if(this.scene().loadingController.isLoading()&&Q.warn(`param attempt to compute ${this.path()} while scene is loading`),this.isDirty()){if(this._isComputing)return new Promise((e,t)=>{this._computeResolves=this._computeResolves||[],this._computeResolves.push(e)});if(this._isComputing=!0,await this.processComputation(),this._isComputing=!1,this._computeResolves){let e=[...this._computeResolves];this._computeResolves=[];for(let t of e)t()}}}async processComputation(){}setInitValue(e){this._default_value=this._cloneRawInput(this._prefilterInvalidRawInput(e))}_setupNodeDependencies(e){var t,r;if(e?(this.options.allowCallback(),this.parentParam()||(this.options.makesNodeDirtyWhenDirty()?(r=e.params.params_node)==null||r.addGraphInput(this,!1):this.dirtyController.addPostDirtyHook("run callback",async()=>{await this.compute(),this.options.executeCallback()}))):this._node&&((t=this._node.params.params_node)==null||t.removeGraphInput(this)),this.components)for(let o of this.components)o._setupNodeDependencies(e)}get node(){return this._node}parent(){return this.node}set_parent_param(e){e.addGraphInput(this,!1),this._parent_param=e}parentParam(){return this._parent_param}has_parent_param(){return this._parent_param!=null}path(){var e;return((e=this.node)==null?void 0:e.path())+"/"+this.name()}pathRelativeTo(e){if(!this._node)return this.name();let t=ct.relativePath(e,this._node);return t.length>0?ct.sanitizePath(`${t}${ct.SEPARATOR}${this.name()}`):this.name()}emit(e){this.emitController.emitAllowed()&&(this.emitController.incrementCount(e),this.scene().dispatchController.dispatch(this,e))}get components(){return this._components}componentNames(){return y$}isMultiple(){return this.componentNames().length>0}initComponents(){}hasExpression(){return this.expressionController!=null&&this.expressionController.active()}toJSON(){return this.serializer.toJSON()}};var Fh=bn(pM());Fh.default.addUnaryOp("@");var b$=10;Fh.default.addBinaryOp("**",b$);var T$="Identifier",A$="Literal",C$="CallExpression",E$="`",X0=class{constructor(){}parse_expression(e){try{this.reset(),this.node=(0,Fh.default)(e)}catch(t){let r=`could not parse the expression '${e}' (error: ${t})`;this.error_message=r}}parse_expression_for_string_param(e){try{this.reset();let t=X0.string_value_elements(e),r=[];for(let o=0;o<t.length;o++){let n=t[o],s;if(o%2==1)s=(0,Fh.default)(n);else{let a=n.replace(/\'/g,"\\'");s={type:A$,value:`'${a}'`,raw:`'${a}'`}}r.push(s)}this.node={type:C$,arguments:r,callee:{type:T$,name:"strConcat"}}}catch(t){let r=`could not parse the expression '${e}' (error: ${t})`;this.error_message=r}}static string_value_elements(e){return e!=null?K.isString(e)?e.split(E$):[]:[]}reset(){this.node=void 0,this.error_message=void 0}};var c5=class{static if(e){let t=e[0],r=e[1],o=e[2];return`(${t}) ? (${r}) : (${o})`}};var l5="$",Uh=class{constructor(e){this.param=e,this._set_error_from_error_bound=this._set_error_from_error.bind(this)}clear_error(){this._error_message=void 0}set_error(e){this._error_message=this._error_message||e}_set_error_from_error(e){K.isString(e)?this._error_message=e:this._error_message=e.message}is_errored(){return this._error_message!=null}error_message(){return this._error_message}reset(){this._error_message=void 0}traverse_node(e){let t=`traverse_${e.type}`;if(this[t])return this[t](e);this.set_error(`expression unknown node type: ${e.type}`)}traverse_BinaryExpression(e){return`${this.traverse_node(e.left)} ${e.operator} ${this.traverse_node(e.right)}`}traverse_LogicalExpression(e){return`${this.traverse_node(e.left)} ${e.operator} ${this.traverse_node(e.right)}`}traverse_MemberExpression(e){return`${this.traverse_node(e.object)}.${this.traverse_node(e.property)}`}traverse_ConditionalExpression(e){return`(${this.traverse_node(e.test)}) ? (${this.traverse_node(e.consequent)}) : (${this.traverse_node(e.alternate)})`}traverse_Compound(e){let t=e.body,r=[];for(let o=0;o<t.length;o++){let n=t[o];n.type=="Identifier"?n.name[0]==l5?r.push("`${"+this.traverse_node(n)+"}`"):r.push(`'${n.name}'`):r.push("`${"+this.traverse_node(n)+"}`")}return r.join(" + ")}traverse_Literal(e){return`${e.raw}`}};var hM="coreGeometry",Mn=class{constructor(){}reset(){this._attributeNames&&this._attributeNames.clear()}assignAttributesLines(){if(this._attributeNames){let e=[];for(let t of this._attributeNames)e.push(Mn.assignAttributeLine(t));return e.join(`;
`)}else return""}assignArraysLines(){if(this._attributeNames){let e=[];if(this._attributeNames.size>0){let t=`const ${hM} = entities[0].coreGeometry();`;e.push(t)}for(let t of this._attributeNames)e.push(Mn.assignItemSizeLine(t)),e.push(Mn.assignArrayLine(t));return e.join(`;
`)}else return""}attributePresenceCheckLine(){if(this._attributeNames){let e=[];for(let t of this._attributeNames){let r=Mn._varAttribute(t);e.push(r)}if(e.length>0)return e.join(" && ")}return"true"}add(e){this._attributeNames=this._attributeNames||new Set,this._attributeNames.add(e)}static assignAttributeLine(e){return`const ${this._varAttribute(e)} = getEntitiesAttribute(entities,'${e}')`}static assignItemSizeLine(e){let t=this._varAttribute(e);return`const ${this._varAttribSize(e)} = ${t}.itemSize`}static assignArrayLine(e){let t=this._varAttribute(e),r=this._varArray(e),o=`${hM}.isAttribIndexed('${e}')`,n=`entities.map(e=>e.indexedAttribValue('${e}'))`,s=`${t}.array`;return`const ${r} = ${o} ? ${n} : ${s}`}static _varAttribute(e){return`attrib_${e}`}static _varAttribSize(e){return`attrib_size_${e}`}static _varArray(e){return`array_${e}`}varAttributeSize(e){return Mn._varAttribSize(e)}varArray(e){return Mn._varArray(e)}};var S$=["abs","acos","acosh","asin","asinh","atan","atan2","atanh","ceil","cos","cosh","exp","expm1","floor","log","log1p","log2","log10","max","min","pow","round","sign","sin","sinh","sqrt","tan","tanh"],w$=["cbrt","hypot","log10","trunc"],dM={math_random:"random"},M$=["fit","fit01","fract","deg2rad","rad2deg","rand","clamp"],N$=Object.keys(_1),O$=["precision"],P$=["E","LN2","LN10","LOG10E","LOG2E","PI","SQRT1_2","SQRT2"],dc={};S$.forEach(i=>{dc[i]=`Math.${i}`});w$.forEach(i=>{dc[i]=`Math.${i}`});Object.keys(dM).forEach(i=>{let e=dM[i];dc[i]=`Math.${e}`});M$.forEach(i=>{dc[i]=`Core.Math.${i}`});N$.forEach(i=>{dc[i]=`Core.Math.Easing.${i}`});O$.forEach(i=>{dc[i]=`Core.String.${i}`});var R$={if:c5.if},mM={};P$.forEach(i=>{mM[i]=`Math.${i}`});var hu="'",fM=", ",L$="@",I$={x:0,y:1,z:2,w:3,r:0,g:1,b:2},D$={Math:Er,String:Fe},u5=class extends Uh{constructor(e){super(e);this.param=e,this._attribute_requirements_controller=new Mn,this.methods=[],this.method_index=-1,this.methodDependencies=[],this.immutableDependencies=[]}parse_tree(e){if(this.reset(),e.error_message==null){try{if(this._attribute_requirements_controller=new Mn,e.node){let t=this.traverse_node(e.node);t&&!this.is_errored()&&(this.function_main_string=t)}else console.warn("no parsed_tree.node")}catch(t){console.warn(`error in expression for param ${this.param.path()}`),console.warn(t)}if(this.function_main_string)try{let t=this._functionBody();this.function=new Function("CorePoint","Core","param","methods","_set_error_from_error",`
					try {
						${t}
					} catch(e) {
						_set_error_from_error(e)
						return null;
					}`)}catch(t){console.warn(t),this.set_error("cannot generate function")}else this.set_error("cannot generate function body")}else this.set_error("cannot parse expression")}reset(){super.reset(),this.function_main_string=void 0,this.methods=[],this.method_index=-1,this.function=void 0,this.methodDependencies=[],this.immutableDependencies=[]}_functionBody(){return this.param.options.isExpressionForEntities()?`
			const entities = param.expressionController.entities();
			function getEntitiesAttribute(entities, attribName){
				const firstEntity = entities[0];
				if(firstEntity instanceof CorePoint){
					return firstEntity.geometry().attributes[attribName];
				} else {
					return entities.map(e=>e.attribValue(attribName));
				}
			}
			function getCorePointAttribValue(entity, attribName, array, attributeSize, propertyOffset){
				return array[entity.index()*attributeSize+propertyOffset];
			}
			function getCoreObjectAttribValue(entity, attribName, array, attributeSize, propertyOffset){
				return entity.attribValue(attribName)
			}
			if(entities){
				return new Promise( async (resolve, reject)=>{
					let entity;
					const entityCallback = param.expressionController.entityCallback();
					// assign_attributes_lines
					${this._attribute_requirements_controller.assignAttributesLines()}
					// check if attributes are present
					if( ${this._attribute_requirements_controller.attributePresenceCheckLine()} ){
						// assign function
						const getEntityAttribValue = (entities[0] instanceof CorePoint) ? getCorePointAttribValue : getCoreObjectAttribValue;
						// assign_arrays_lines
						${this._attribute_requirements_controller.assignArraysLines()}
						for(let index=0; index < entities.length; index++){
							entity = entities[index];
							result = ${this.function_main_string};
							entityCallback(entity, result);
						}
						resolve()
					} else {
						const error = new Error('attribute not found')
						_set_error_from_error(error)
						reject(error)
					}
				})
			}
			return []`:`
			return new Promise( async (resolve, reject)=>{
				try {
					const value = ${this.function_main_string}
					resolve(value)
				} catch(e) {
					_set_error_from_error(e)
					reject()
				}
			})
			`}evalAllowed(){return this.function!=null}evalFunction(){if(this.function)return this.clear_error(),this.function(Js,D$,this.param,this.methods,this._set_error_from_error_bound)}traverse_CallExpression(e){let t=e.arguments.map(n=>this.traverse_node(n)),o=e.callee.name;if(o){let n=R$[o];if(n)return n(t);let s=`${t.join(fM)}`,a=dc[o];if(a)return`${a}(${s})`;let c=Q.expressionsRegister;if(c.getMethod(o)){let u=e.arguments[0],p=`return ${t[0]}`,h,d;try{h=new Function(p),d=h()}catch{}return this._createMethodAndDependencies(o,d,u),`(await methods[${this.method_index}].processArguments([${s}]))`}else{let u=c.availableMethods().join(", "),p=`method not found (${o}), available methods are: ${u}`;Q.warn(p)}}this.set_error(`unknown method: ${o}`)}traverse_BinaryExpression(e){return`(${this.traverse_node(e.left)} ${e.operator} ${this.traverse_node(e.right)})`}traverse_LogicalExpression(e){return`(${this.traverse_node(e.left)} ${e.operator} ${this.traverse_node(e.right)})`}traverse_MemberExpression(e){return`${this.traverse_node(e.object)}.${this.traverse_node(e.property)}`}traverse_UnaryExpression(e){if(e.operator===L$){let t=e.argument,r,o;switch(t.type){case"Identifier":{r=t.name;break}case"MemberExpression":{let n=t,s=n.object,a=n.property;r=s.name,o=a.name;break}}if(r){if(r=wt.remapName(r),r==mr.POINT_INDEX||r==mr.OBJECT_INDEX)return"((entity != null) ? entity.index() : 0)";{let n=this._attribute_requirements_controller.varAttributeSize(r),s=this._attribute_requirements_controller.varArray(r);this._attribute_requirements_controller.add(r);let a=o?I$[o]:0;return a==null&&(a=0),`getEntityAttribValue(entity, '${r}', ${s}, ${n}, ${a})`}}else return console.warn("attribute not found"),""}else return`${e.operator}${this.traverse_node(e.argument)}`}traverse_Literal(e){return`${e.raw}`}traverse_Identifier(e){if(e.name[0]==l5){let r=e.name.substring(1),o=mM[r];if(o)return o;let n=`traverse_Identifier_${r}`;if(this[n])return this[n]();this.set_error(`identifier unknown: ${e.name}`)}else return e.name}traverse_Identifier_F(){return this.immutableDependencies.push(this.param.scene().timeController.graphNode),"param.scene().timeController.frame()"}traverse_Identifier_T(){return this.immutableDependencies.push(this.param.scene().timeController.graphNode),"param.scene().timeController.time()"}traverse_Identifier_OS(){return`${hu}${this.param.node.name()}${hu}`}traverse_Identifier_CH(){return`${hu}${this.param.name()}${hu}`}traverse_Identifier_CEX(){return this._method_centroid("x")}traverse_Identifier_CEY(){return this._method_centroid("y")}traverse_Identifier_CEZ(){return this._method_centroid("z")}_method_centroid(e){let r=[0,`${hu}${e}${hu}`].join(fM);return this._createMethodAndDependencies("centroid",0),`(await methods[${this.method_index}].processArguments([${r}]))`}_createMethodAndDependencies(e,t,r){let o=Q.expressionsRegister,n=o.getMethod(e);if(!n){let a=o.availableMethods(),c=`method not found (${e}), available methods are: ${a.join(", ")}`;this.set_error(c),Q.warn(c);return}let s=new n(this.param);if(this.method_index+=1,this.methods[this.method_index]=s,s.requireDependency()&&t!=null){let a=s.findDependency(t);a?(r&&a.set_jsep_node(r),this.methodDependencies.push(a)):r&&K.isString(t)&&this.param.scene().missingExpressionReferencesController.register(this.param,t)}}};var k$=", ",p5=class extends Uh{constructor(e){super(e);this.param=e}parse_tree(e){if(e.error_message==null&&e.node)try{return this.traverse_node(e.node)}catch{this.set_error("could not traverse tree")}else this.set_error("cannot parse tree")}traverse_CallExpression(e){let r=`${e.arguments.map(n=>this.traverse_node(n)).join(k$)}`;return`${e.callee.name}(${r})`}traverse_UnaryExpression(e){return`${e.operator}${this.traverse_node(e.argument)}`}traverse_Identifier(e){return`${e.name}`}};var h5=class{constructor(e){this.param=e,this._cyclicGraphDetected=!1,this.methodDependencies=[]}set_error(e){this.error_message=this.error_message||e}reset(){this.param.graphDisconnectPredecessors(),this.methodDependencies.forEach(e=>{e.reset()}),this.methodDependencies=[]}update(e){this._cyclicGraphDetected=!1,this._connectImmutableDependencies(e),this.methodDependencies=e.methodDependencies,this._handleMethodDependencies(),this._listenForNameChanges()}_connectImmutableDependencies(e){e.immutableDependencies.forEach(t=>{if(this._cyclicGraphDetected==!1&&this.param.addGraphInput(t)==!1){this._cyclicGraphDetected=!0,this.set_error("cannot create expression, infinite graph detected"),this.reset();return}})}_handleMethodDependencies(){this.methodDependencies.forEach(e=>{this._cyclicGraphDetected==!1&&this._handleMethodDependency(e)})}_handleMethodDependency(e){let t=e.resolved_graph_node;if(t&&!this.param.addGraphInput(t)){this._cyclicGraphDetected=!0,this.set_error("cannot create expression, infinite graph detected"),this.reset();return}}_listenForNameChanges(){this.methodDependencies.forEach(e=>{e.listen_for_name_changes()})}};var d5=class{constructor(e){this.param=e,this.parse_completed=!1,this.parse_started=!1,this.parsed_tree=new X0,this._functionGenerator=new u5(this.param),this.dependencies_controller=new h5(this.param)}parseExpression(e){if(this.parse_started)throw new Error(`parse in progress for param ${this.param.path()}`);this.parse_started=!0,this.parse_completed=!1,this.parsed_tree=this.parsed_tree||new X0,this.reset(),this.param.type()==J.STRING?this.parsed_tree.parse_expression_for_string_param(e):this.parsed_tree.parse_expression(e),this._functionGenerator.parse_tree(this.parsed_tree),this._functionGenerator.error_message()==null&&(this.dependencies_controller.update(this._functionGenerator),this.dependencies_controller.error_message?this.param.states.error.set(this.dependencies_controller.error_message):(this.parse_completed=!0,this.parse_started=!1))}async computeFunction(){if(this._computeAllowed())try{return await this._functionGenerator.evalFunction()}catch{}}reset(){this.parse_completed=!1,this.parse_started=!1,this.dependencies_controller.reset(),this._functionGenerator.reset()}is_errored(){return this._functionGenerator.is_errored()}error_message(){return this._functionGenerator.error_message()}_computeAllowed(){return this._functionGenerator.evalAllowed()}updateFromMethodDependencyNameChange(){this.expression_string_generator=this.expression_string_generator||new p5(this.param);let e=this.expression_string_generator.parse_tree(this.parsed_tree);e?this.param.set(e):console.warn("failed to regenerate expression")}};var Vh=class{constructor(e){this.param=e}dispose(){this.param.scene().expressionsController.deregisterParam(this.param),this._resetMethodDependencies()}_resetMethodDependencies(){var e,t;(e=this._method_dependencies_by_graph_node_id)==null||e.forEach(r=>{r.dispose()}),(t=this._method_dependencies_by_graph_node_id)==null||t.clear()}registerMethodDependency(e){this._method_dependencies_by_graph_node_id=this._method_dependencies_by_graph_node_id||new Map,this._method_dependencies_by_graph_node_id.set(e.graphNodeId(),e)}active(){return this._expression!=null}expression(){return this._expression}is_errored(){return this._manager?this._manager.is_errored():!1}error_message(){return this._manager?this._manager.error_message():null}requires_entities(){return this.param.options.isExpressionForEntities()}set_expression(e,t=!0){var r;this.param.scene().missingExpressionReferencesController.deregisterParam(this.param),this.param.scene().expressionsController.deregisterParam(this.param),this._expression!=e&&(this._resetMethodDependencies(),this._expression=e,this._expression?(this._manager=this._manager||new d5(this.param),this._manager.parseExpression(this._expression)):(r=this._manager)==null||r.reset(),t&&this.param.setDirty())}updateFromMethodDependencyNameChange(){this._manager&&this.active()&&this._manager.updateFromMethodDependencyNameChange()}computeExpression(){if(this._manager&&this.active())return this._manager.computeFunction()}async computeExpressionForEntities(e,t){var r,o;this._setEntities(e,t),await this.computeExpression(),((r=this._manager)==null?void 0:r.error_message())&&this.param.node.states.error.set(`expression evalution error: ${(o=this._manager)==null?void 0:o.error_message()}`),this._resetEntities()}computeExpressionForPoints(e,t){return this.computeExpressionForEntities(e,t)}computeExpressionForObjects(e,t){return this.computeExpressionForEntities(e,t)}entities(){return this._entities}entityCallback(){return this._entityCallback}_setEntities(e,t){this._entities=e,this._entityCallback=t}_resetEntities(){this._entities=void 0,this._entityCallback=void 0}};var fc=class extends fo{isNumeric(){return!0}isDefault(){return this._raw_input==this._default_value}_prefilterInvalidRawInput(e){return K.isArray(e)?e[0]:e}processRawInput(){this.states.error.clear();let e=this.convert(this._raw_input);e!=null?(this._expression_controller&&(this._expression_controller.set_expression(void 0,!1),this.emitController.emit(sr.EXPRESSION_UPDATED)),e!=this._value&&(this._update_value(e),this.setSuccessorsDirty(this))):K.isString(this._raw_input)?(this._expression_controller=this._expression_controller||new Vh(this),this._raw_input!=this._expression_controller.expression()&&(this._expression_controller.set_expression(this._raw_input),this.emitController.emit(sr.EXPRESSION_UPDATED))):this.states.error.set(`param input is invalid (${this.path()})`)}async processComputation(){var e;if(((e=this.expressionController)==null?void 0:e.active())&&!this.expressionController.requires_entities()){let t=await this.expressionController.computeExpression();if(this.expressionController.is_errored())this.states.error.set(`expression error: "${this.expressionController.expression()}" (${this.expressionController.error_message()})`);else{let r=this.convert(t);r!=null?(this.states.error.active()&&this.states.error.clear(),this._update_value(r)):this.states.error.set(`expression returns an invalid type (${t}) (${this.expressionController.expression()})`)}}}_update_value(e){this._value=e;let t=this.parentParam();t&&t.set_value_from_components(),this.options.executeCallback(),this.emitController.emit(sr.VALUE_UPDATED),this.removeDirtyState()}};var f5=class extends fc{static type(){return J.BOOLEAN}defaultValueSerialized(){return K.isString(this._default_value)?this._default_value:this.convert(this._default_value)||!1}rawInputSerialized(){return this._raw_input}valueSerialized(){return this.value}_copyValue(e){this.set(e.value)}static areRawInputEqual(e,t){return e==t}static areValuesEqual(e,t){return e==t}convert(e){if(K.isBoolean(e))return e;if(K.isNumber(e))return e>=1;if(K.isString(e)){if(Fe.isBoolean(e))return Fe.toBoolean(e);if(Fe.isNumber(e))return parseFloat(e)>=1}return null}};var m5=class extends fo{static type(){return J.BUTTON}defaultValueSerialized(){return this._default_value}rawInputSerialized(){return this._raw_input}valueSerialized(){return this.value}_copyValue(e){}static areRawInputEqual(e,t){return!0}static areValuesEqual(e,t){return!0}async pressButton(){(this.node.isDirty()||this.node.cookController.isCooking())&&await this.node.compute(),this.options.executeCallback()}};var mc=class extends fc{static type(){return J.FLOAT}defaultValueSerialized(){return this._default_value}rawInputSerialized(){return this._raw_input}valueSerialized(){return this.value}_copyValue(e){this.set(e.valueSerialized())}_prefilterInvalidRawInput(e){return K.isArray(e)?e[0]:K.isString(e)&&Fe.isNumber(e)?parseFloat(e):e}static areRawInputEqual(e,t){return e==t}static areValuesEqual(e,t){return e==t}static convert(e){if(K.isNumber(e))return e;if(K.isBoolean(e))return e?1:0;if(Fe.isNumber(e)){let t=parseFloat(e);if(K.isNumber(t))return t}return null}convert(e){let t=mc.convert(e);return t&&this.options.ensureInRange(t)}};var Nn=class extends fo{constructor(){super(...arguments);this._components_contructor=mc}get components(){return this._components}isNumeric(){return!0}isDefault(){for(let e of this.components)if(!e.isDefault())return!1;return!0}rawInput(){return this._components.map(e=>e.rawInput())}rawInputSerialized(){return this._components.map(e=>e.rawInputSerialized())}_copyValue(e){for(let t=0;t<this.components.length;t++){let r=this.components[t],o=e.components[t];r.copyValue(o)}}initComponents(){if(this._components!=null)return;let e=0;this._components=new Array(this.componentNames().length);for(let t of this.componentNames()){let r=new this._components_contructor(this.scene(),this.node),o;K.isArray(this._default_value)?o=this._default_value[e]:o=this._default_value[t],r.options.copy(this.options),r.setInitValue(o),r.setName(`${this.name()}${t}`),r.set_parent_param(this),this._components[e]=r,e++}}async processComputation(){await this.compute_components(),this.set_value_from_components()}set_value_from_components(){}hasExpression(){var e;for(let t of this.components)if((e=t.expressionController)==null?void 0:e.active())return!0;return!1}async compute_components(){let e=this.components,t=[];for(let r of e)r.isDirty()&&t.push(r.compute());await Promise.all(t),this.removeDirtyState()}_prefilterInvalidRawInput(e){if(K.isArray(e))return e;{let t=e;return this.componentNames().map(()=>t)}}processRawInput(){let e=this.scene().cooker;e.block();let t=this.components;for(let n of t)n.emitController.blockParentEmit();let r=this._raw_input,o=0;if(K.isArray(r))for(let n=0;n<t.length;n++){let s=r[n];s==null&&(s=o),t[n].set(s),o=s}else for(let n=0;n<t.length;n++){let s=this.componentNames()[n],a=r[s];a==null&&(a=o),t[n].set(a),o=a}e.unblock();for(let n=0;n<t.length;n++)t[n].emitController.unblockParentEmit();this.emitController.emit(sr.VALUE_UPDATED)}};var Io=(i=>(i.NONE="no conversion",i.SRGB_TO_LINEAR="sRGB -> linear",i.LINEAR_TO_SRGB="linear -> sRGB",i))(Io||{});var B$=["r","g","b"],_5=class extends Nn{constructor(){super(...arguments);this._value=new he,this._value_pre_conversion=new he,this._value_serialized_dirty=!1,this._value_serialized=[0,0,0],this._value_pre_conversion_serialized=[0,0,0],this._copied_value=[0,0,0]}static type(){return J.COLOR}componentNames(){return B$}defaultValueSerialized(){return K.isArray(this._default_value)?this._default_value:this._default_value.toArray()}valueSerialized(){return this._update_value_serialized_if_required(),this._value_serialized}valuePreConversionSerialized(){return this._update_value_serialized_if_required(),this._value_pre_conversion_serialized}_copyValue(e){e.value.toArray(this._copied_value),this.set(this._copied_value)}_cloneRawInput(e){if(e instanceof he)return e.clone();{let t=[e[0],e[1],e[2]];return t[0]==null&&(t[0]=t[0]||0),t[1]==null&&(t[1]=t[1]||t[0]),t[2]==null&&(t[2]=t[2]||t[1]),t}}static areRawInputEqual(e,t){return e instanceof he?t instanceof he?e.equals(t):e.r==t[0]&&e.g==t[1]&&e.b==t[2]:t instanceof he?e[0]==t.r&&e[1]==t.g&&e[2]==t.b:e[0]==t[0]&&e[1]==t[1]&&e[2]==t[2]}static areValuesEqual(e,t){return e.equals(t)}initComponents(){super.initComponents(),this.r=this.components[0],this.g=this.components[1],this.b=this.components[2],this._value_serialized_dirty=!0}_update_value_serialized_if_required(){!this._value_serialized_dirty||(this._value_serialized[0]=this._value.r,this._value_serialized[1]=this._value.g,this._value_serialized[2]=this._value.b,this._value_pre_conversion_serialized[0]=this._value_pre_conversion.r,this._value_pre_conversion_serialized[1]=this._value_pre_conversion.g,this._value_pre_conversion_serialized[2]=this._value_pre_conversion.b)}valuePreConversion(){return this._value_pre_conversion}set_value_from_components(){this._value_pre_conversion.r=this.r.value,this._value_pre_conversion.g=this.g.value,this._value_pre_conversion.b=this.b.value,this._value.copy(this._value_pre_conversion);let e=this.options.colorConversion();if(e!=null&&e!=Io.NONE){switch(e){case Io.SRGB_TO_LINEAR:{this._value.convertSRGBToLinear();return}case Io.LINEAR_TO_SRGB:{this._value.convertLinearToSRGB();return}}Be.unreachable(e)}this._value_serialized_dirty=!0}};var g5=class extends fo{static type(){return J.FOLDER}defaultValueSerialized(){return this._default_value}rawInputSerialized(){return this._raw_input}valueSerialized(){return this.value}_copyValue(e){}static areRawInputEqual(e,t){return!0}static areValuesEqual(e,t){return!0}};var Gh=class extends fc{static type(){return J.INTEGER}defaultValueSerialized(){return this._default_value}rawInputSerialized(){return this._raw_input}valueSerialized(){return this.value}_copyValue(e){this.set(e.valueSerialized())}_prefilterInvalidRawInput(e){return K.isArray(e)?e[0]:K.isString(e)&&Fe.isNumber(e)?parseInt(e):e}static areRawInputEqual(e,t){return e==t}static areValuesEqual(e,t){return e==t}static convert(e){if(K.isNumber(e))return Math.round(e);if(K.isBoolean(e))return e?1:0;if(Fe.isNumber(e)){let t=parseInt(e);if(K.isNumber(t))return t}return null}convert(e){let t=Gh.convert(e);return t&&this.options.ensureInRange(t)}};var _c=class{constructor(){this._index=-1,this._path_elements=[],this._named_nodes=[],this._graph_node_ids=[],this._node_element_by_graph_node_id=new Map}reset(){this._index=-1,this._path_elements=[],this._named_nodes=[],this._graph_node_ids=[],this._node_element_by_graph_node_id.clear()}add_node(e,t){this._index+=1,e==t.name()&&(this._named_nodes[this._index]=t),this._graph_node_ids[this._index]=t.graphNodeId(),this._node_element_by_graph_node_id.set(t.graphNodeId(),e)}add_path_element(e){this._index+=1,this._path_elements[this._index]=e}named_graph_nodes(){return this._named_nodes}named_nodes(){let e=[];for(let t of this._named_nodes)if(t){let r=t;r.nameController&&e.push(r)}return e}update_from_name_change(e){this._named_nodes.map(r=>r==null?void 0:r.graphNodeId()).includes(e.graphNodeId())&&this._node_element_by_graph_node_id.set(e.graphNodeId(),e.name())}to_path(){let e=new Array(this._index);for(let o=0;o<=this._index;o++){let n=this._named_nodes[o];if(n){let s=this._node_element_by_graph_node_id.get(n.graphNodeId());s&&(e[o]=s)}else{let s=this._path_elements[o];s&&(e[o]=s)}}let t=e.join(ct.SEPARATOR),r=t[0];return r&&(ct.NON_LETTER_PREFIXES.includes(r)||(t=`${ct.SEPARATOR}${t}`)),t}};var zh=class extends fo{constructor(){super(...arguments);this.decomposed_path=new _c}_handleReferences(e,t){this.scene().referencesController.setNamedNodesFromParam(this),e?this.scene().referencesController.setReferenceFromParam(this,e):this.scene().missingExpressionReferencesController.register(this,t)}};var v5=class extends zh{static type(){return J.PARAM_PATH}_initializeParam(){this._value=new sc}defaultValueSerialized(){return this._default_value}rawInputSerialized(){return`${this._raw_input}`}valueSerialized(){return`${this.value}`}_copyValue(e){this.set(e.valueSerialized())}static areRawInputEqual(e,t){return e==t}static areValuesEqual(e,t){return e==t}isDefault(){return this._raw_input==this._default_value}setParam(e){this.set(e.path())}processRawInput(){this._value.path()!=this._raw_input&&(this._value.setPath(this._raw_input),this.findTarget(),this.setDirty(),this.emitController.emit(sr.VALUE_UPDATED))}async processComputation(){this.findTarget()}findTarget(){if(!this.node)return;let e=this._raw_input,t=null,r=e!=null&&e!=="";this.scene().referencesController.resetReferenceFromParam(this),this.decomposed_path.reset(),r&&(t=ct.findParam(this.node,e,this.decomposed_path));let o=this._value.param(),n=t;if(n&&n.graphNodeId()==this.graphNodeId()){this.states.error.set("param cannot refer to itself");return}if(this._handleReferences(t,e),(o==null?void 0:o.graphNodeId())!==(n==null?void 0:n.graphNodeId())){let s=this.options.dependentOnFoundNode(),a=this._value.param();a&&s&&this.removeGraphInput(a),t?this._assign_found_node(t):this._value.setParam(null),this.options.executeCallback()}this.removeDirtyState()}_assign_found_node(e){let t=this.options.dependentOnFoundNode();this._value.setParam(e),t&&this.addGraphInput(e)}notifyPathRebuildRequired(e){this.decomposed_path.update_from_name_change(e);let t=this.decomposed_path.to_path();this.set(t)}notifyTargetParamOwnerParamsUpdated(e){this.setDirty()}};var Hh=class extends zh{static type(){return J.NODE_PATH}_initializeParam(){this._value=new Ci}defaultValueSerialized(){return this._default_value}rawInputSerialized(){return`${this._raw_input}`}valueSerialized(){return`${this.value}`}_copyValue(e){this.set(e.valueSerialized())}static areRawInputEqual(e,t){return e==t}static areValuesEqual(e,t){return e==t}isDefault(){return this._raw_input==this._default_value}setNode(e,t){if((t==null?void 0:t.relative)==!0){let r=ct.relativePath(this.node,e);this.set(r)}else this.set(e.path())}processRawInput(){this._value.path()!=this._raw_input&&(this._value.setPath(this._raw_input),this._findTarget(),this.setDirty(),this.emitController.emit(sr.VALUE_UPDATED))}async processComputation(){this._findTarget()}_findTarget(){if(!this.node)return;let e=this._raw_input,t=null,r=e!=null&&e!=="";this.scene().referencesController.resetReferenceFromParam(this),this.decomposed_path.reset(),r&&(t=ct.findNode(this.node,e,this.decomposed_path));let o=this._value.node(),n=t;if(n&&n.graphNodeId()==this.node.graphNodeId()){this.states.error.set("param cannot refer to its own node");return}if(this._handleReferences(t,e),(o==null?void 0:o.graphNodeId())!==(n==null?void 0:n.graphNodeId())){let s=this.options.dependentOnFoundNode(),a=this._value.node();a&&s&&this.removeGraphInput(a),t?this._assignFoundNode(t):this._value.setNode(null),this.options.executeCallback()}r&&!t&&this.scene().loadingController.loaded()&&r&&this.states.error.set(`no node found at path '${e}'`),this.removeDirtyState()}_assignFoundNode(e){let t=this.options.dependentOnFoundNode();this._isNodeExpectedContext(e)?this._isNodeExpectedType(e)?(this.states.error.clear(),this._value.setNode(e),t&&this.addGraphInput(e)):this.states.error.set(`node type is ${e.type()} but the params expects one of ${(this._expectedNodeTypes()||[]).join(", ")}`):this.states.error.set(`node context is ${e.context()} but the params expects a ${this._expectedContext()}`)}_expectedContext(){return this.options.nodeSelectionContext()}_isNodeExpectedContext(e){var t,r;let o=this._expectedContext();if(o==null)return!0;let n=(r=(t=e.parent())==null?void 0:t.childrenController)==null?void 0:r.context;return o==n}_expectedNodeTypes(){return this.options.nodeSelectionTypes()}_isNodeExpectedType(e){let t=this._expectedNodeTypes();return t==null?!0:t==null?void 0:t.includes(e.type())}notifyPathRebuildRequired(e){this.decomposed_path.update_from_name_change(e);let t=this.decomposed_path.to_path();this.set(t)}notifyTargetParamOwnerParamsUpdated(e){this.setDirty()}};var Wo=class{constructor(e,t,r,o){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=o!==void 0?o:new t.constructor(r),this.sampleValues=t,this.valueSize=r,this.settings=null,this.DefaultSettings_={}}evaluate(e){let t=this.parameterPositions,r=this._cachedIndex,o=t[r],n=t[r-1];r:{e:{let s;t:{o:if(!(e<o)){for(let a=r+2;;){if(o===void 0){if(e<n)break o;return r=t.length,this._cachedIndex=r,this.afterEnd_(r-1,e,n)}if(r===a)break;if(n=o,o=t[++r],e<o)break e}s=t.length;break t}if(!(e>=n)){let a=t[1];e<a&&(r=2,n=a);for(let c=r-2;;){if(n===void 0)return this._cachedIndex=0,this.beforeStart_(0,e,o);if(r===c)break;if(o=n,n=t[--r-1],e>=n)break e}s=r,r=0;break t}break r}for(;r<s;){let a=r+s>>>1;e<t[a]?s=a:r=a+1}if(o=t[r],n=t[r-1],n===void 0)return this._cachedIndex=0,this.beforeStart_(0,e,o);if(o===void 0)return r=t.length,this._cachedIndex=r,this.afterEnd_(r-1,n,e)}this._cachedIndex=r,this.intervalChanged_(r,n,o)}return this.interpolate_(r,n,e,o)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){let t=this.resultBuffer,r=this.sampleValues,o=this.valueSize,n=e*o;for(let s=0;s!==o;++s)t[s]=r[n+s];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}};Wo.prototype.beforeStart_=Wo.prototype.copySampleValue_;Wo.prototype.afterEnd_=Wo.prototype.copySampleValue_;var jh=class extends Wo{constructor(e,t,r,o){super(e,t,r,o);this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:Z2,endingEnd:Z2}}intervalChanged_(e,t,r){let o=this.parameterPositions,n=e-2,s=e+1,a=o[n],c=o[s];if(a===void 0)switch(this.getSettings_().endingStart){case Q2:n=e,a=2*t-r;break;case e3:n=o.length-2,a=t+o[n]-o[n+1];break;default:n=e,a=r}if(c===void 0)switch(this.getSettings_().endingEnd){case Q2:s=e,c=2*r-t;break;case e3:s=1,c=r+o[1]-o[0];break;default:s=e-1,c=t}let l=(r-t)*.5,u=this.valueSize;this._weightPrev=l/(t-a),this._weightNext=l/(c-r),this._offsetPrev=n*u,this._offsetNext=s*u}interpolate_(e,t,r,o){let n=this.resultBuffer,s=this.sampleValues,a=this.valueSize,c=e*a,l=c-a,u=this._offsetPrev,p=this._offsetNext,h=this._weightPrev,d=this._weightNext,m=(r-t)/(o-t),f=m*m,x=f*m,_=-h*x+2*h*f-h*m,g=(1+h)*x+(-1.5-2*h)*f+(-.5+h)*m+1,T=(-1-d)*x+(1.5+d)*f+.5*m,b=d*x-d*f;for(let y=0;y!==a;++y)n[y]=_*s[u+y]+g*s[l+y]+T*s[c+y]+b*s[p+y];return n}};var _s=class{constructor(e=0,t=0){this._position=e,this._value=t}toJSON(){return{position:this._position,value:this._value}}position(){return this._position}value(){return this._value}copy(e){this._position=e.position(),this._value=e.value()}clone(){let e=new _s;return e.copy(this),e}isEqual(e){return this._position==e.position()&&this._value==e.value()}isEqualJSON(e){return this._position==e.position&&this._value==e.value}fromJSON(e){this._position=e.position,this._value=e.value}static areEqualJSON(e,t){return e.position==t.position&&e.value==t.value}static fromJSON(e){return new _s(e.position,e.value)}},x5=(i=>(i.CUBIC="cubic",i))(x5||{});var Wr=class{constructor(e="cubic",t=[]){this._interpolation=e,this._points=t,this._uuid=qi()}uuid(){return this._uuid}interpolation(){return this._interpolation}points(){return this._points}static createInterpolantFromValues(e,t){let o=new Float32Array(1);return new jh(e,t,1,o)}createInterpolant(){return Wr.createInterpolant(this)}static createInterpolant(e){let t=e.points(),r=$e.sortBy(t,a=>a.position()),o=new Float32Array(r.length),n=new Float32Array(r.length),s=0;for(let a of r)o[s]=a.position(),n[s]=a.value(),s++;return this.createInterpolantFromValues(o,n)}static fromJSON(e){let t=[];for(let o of e.points)t.push(_s.fromJSON(o));let r=e.interpolation;return(r==null||r=="")&&(r="cubic"),new Wr(r,t)}toJSON(){return{interpolation:this._interpolation,points:this._points.map(e=>e.toJSON())}}clone(){let e=new Wr;return e.copy(this),e}copy(e){this._interpolation=e.interpolation();let t=e.points().length,r=this._points.length;if(r>t){let n=r-t,s=r-n;this._points.splice(s,n)}let o=0;for(let n of e.points()){let s=this._points[o];s?s.copy(n):this._points.push(n.clone()),o+=1}}isEqual(e){if(this._interpolation!=e.interpolation())return!1;let t=e.points();if(this._points.length!=t.length)return!1;let r=0;for(let o of this._points){let n=t[r];if(!o.isEqual(n))return!1;r+=1}return!0}isEqualJSON(e){if(this._interpolation!=e.interpolation||this._points.length!=e.points.length)return!1;let t=0;for(let r of this._points){let o=e.points[t];if(!r.isEqualJSON(o))return!1;t+=1}return!0}static are_json_equal(e,t){if(e.interpolation!=t.interpolation||e.points.length!=t.points.length)return!1;let r=0;for(let o of e.points){let n=t.points[r];if(!_s.areEqualJSON(o,n))return!1;r+=1}return!0}fromJSON(e){this._interpolation=e.interpolation;let t=e.points.length,r=this._points.length;if(r>t){let n=r-t,s=r-n;this._points.splice(s,n)}let o=0;for(let n of e.points){let s=this._points[o];s?s.fromJSON(n):this._points.push(_s.fromJSON(n)),o+=1}}};var _M=4,y5=1024,vM=1,gM=y5*vM,F$=1,xM=class extends fo{constructor(){super(...arguments);this._textureData=new Float32Array(_M*gM),this._rampTexture=new Mr(this._textureData,y5,vM,st,Wt)}static type(){return J.RAMP}defaultValueSerialized(){return this._default_value instanceof Wr?this._default_value.toJSON():this._default_value}_cloneRawInput(i){return i instanceof Wr?i.clone():Wr.fromJSON(i).toJSON()}rawInputSerialized(){return this._raw_input instanceof Wr?this._raw_input.toJSON():Wr.fromJSON(this._raw_input).toJSON()}valueSerialized(){return this.value.toJSON()}_copyValue(i){this.set(i.valueSerialized())}static areRawInputEqual(i,e){return i instanceof Wr?e instanceof Wr?i.isEqual(e):i.isEqualJSON(e):e instanceof Wr?e.isEqualJSON(i):Wr.are_json_equal(i,e)}static areValuesEqual(i,e){return i.isEqual(e)}isDefault(){return this._default_value instanceof Wr?this.value.isEqual(this._default_value):this.value.isEqualJSON(this._default_value)}processRawInput(){this._raw_input instanceof Wr?this._value?this._value.copy(this._raw_input):this._value=this._raw_input:this._value?this._value.fromJSON(this._raw_input):this._value=Wr.fromJSON(this._raw_input),this._resetRampInterpolant(),this._updateRampTexture(),this.options.executeCallback(),this.emitController.emit(sr.VALUE_UPDATED),this.setSuccessorsDirty(this)}hasExpression(){return!1}_resetRampInterpolant(){this._rampInterpolant=void 0}rampTexture(){return this._rampTexture}_updateRampTexture(){this._updateRampTextureData(),this.rampTexture().needsUpdate=!0}_updateRampTextureData(){let i=0,e=0,t=0;for(var r=0;r<gM;r++)i=r*_M,e=r/y5,t=this.valueAtPosition(e),this._textureData[i+0]=t*F$,this._textureData[i+1]=0,this._textureData[i+2]=0}interpolant(){return this._rampInterpolant=this._rampInterpolant||this._createInterpolant()}_createInterpolant(){return this.value.createInterpolant()}valueAtPosition(i){return this.interpolant().evaluate(i)[0]}},gs=xM;gs.DEFAULT_VALUE=new Wr(x5.CUBIC,[new _s(0,0),new _s(1,1)]);gs.DEFAULT_VALUE_JSON=xM.DEFAULT_VALUE.toJSON();var Wh=class extends fo{static type(){return J.STRING}defaultValueSerialized(){return this._default_value}_cloneRawInput(e){return`${e}`}rawInputSerialized(){return`${this._raw_input}`}valueSerialized(){return`${this.value}`}_copyValue(e){this.set(e.value)}static areRawInputEqual(e,t){return e==t}static areValuesEqual(e,t){return e==t}isDefault(){return this._raw_input==this._default_value}convert(e){return K.isString(e)?e:`${e}`}rawInput(){return this._raw_input}processRawInput(){this.states.error.clear(),this._value_elements(this._raw_input).length>=3?(this._expression_controller=this._expression_controller||new Vh(this),this._raw_input!=this._expression_controller.expression()&&(this._expression_controller.set_expression(this._raw_input),this.setDirty(),this.emitController.emit(sr.EXPRESSION_UPDATED))):this._raw_input!=this._value&&(this._value=this._raw_input,this.removeDirtyState(),this.setSuccessorsDirty(this),this.emitController.emit(sr.VALUE_UPDATED),this.options.executeCallback(),this._expression_controller&&(this._expression_controller.set_expression(void 0,!1),this.emitController.emit(sr.EXPRESSION_UPDATED)))}async processComputation(){var e;if(((e=this.expressionController)==null?void 0:e.active())&&!this.expressionController.requires_entities()){let t=await this.expressionController.computeExpression();if(this.expressionController.is_errored())this.states.error.set(`expression error: ${this.expressionController.error_message()}`);else{let r=this.convert(t);r!=null?(this._value=r,this.emitController.emit(sr.VALUE_UPDATED),this.options.executeCallback()):this.states.error.set(`expression returns an invalid type (${t})`),this.removeDirtyState()}}}_value_elements(e){return X0.string_value_elements(e)}};var U$=["x","y"],b5=class extends Nn{constructor(){super(...arguments);this._value=new G,this._copied_value=[0,0]}static type(){return J.VECTOR2}componentNames(){return U$}defaultValueSerialized(){return K.isArray(this._default_value)?this._default_value:this._default_value.toArray()}valueSerialized(){return this.value.toArray()}_copyValue(e){e.value.toArray(this._copied_value),this.set(this._copied_value)}_cloneRawInput(e){if(e instanceof G)return e.clone();{let t=[e[0],e[1]];return t[0]==null&&(t[0]=t[0]||0),t[1]==null&&(t[1]=t[1]||t[0]),t}}static areRawInputEqual(e,t){return e instanceof G?t instanceof G?e.equals(t):e.x==t[0]&&e.y==t[1]:t instanceof G?e[0]==t.x&&e[1]==t.y:e[0]==t[0]&&e[1]==t[1]}static areValuesEqual(e,t){return e.equals(t)}initComponents(){super.initComponents(),this.x=this.components[0],this.y=this.components[1]}set_value_from_components(){this._value.x=this.x.value,this._value.y=this.y.value}};var V$=["x","y","z"],T5=class extends Nn{constructor(){super(...arguments);this._value=new w,this._copied_value=[0,0,0]}static type(){return J.VECTOR3}componentNames(){return V$}defaultValueSerialized(){return K.isArray(this._default_value)?this._default_value:this._default_value.toArray()}valueSerialized(){return this.value.toArray()}_copyValue(e){e.value.toArray(this._copied_value),this.set(this._copied_value)}_cloneRawInput(e){if(e instanceof w)return e.clone();{let t=[e[0],e[1],e[2]];return t[0]==null&&(t[0]=t[0]||0),t[1]==null&&(t[1]=t[1]||t[0]),t[2]==null&&(t[2]=t[2]||t[1]),t}}static areRawInputEqual(e,t){return e instanceof w?t instanceof w?e.equals(t):e.x==t[0]&&e.y==t[1]&&e.z==t[2]:t instanceof w?e[0]==t.x&&e[1]==t.y&&e[2]==t.z:e[0]==t[0]&&e[1]==t[1]&&e[2]==t[2]}static areValuesEqual(e,t){return e.equals(t)}initComponents(){super.initComponents(),this.x=this.components[0],this.y=this.components[1],this.z=this.components[2]}set_value_from_components(){this._value.x=this.x.value,this._value.y=this.y.value,this._value.z=this.z.value}};var G$=["x","y","z","w"],A5=class extends Nn{constructor(){super(...arguments);this._value=new Ie,this._copied_value=[0,0,0,0]}static type(){return J.VECTOR4}componentNames(){return G$}defaultValueSerialized(){return K.isArray(this._default_value)?this._default_value:this._default_value.toArray()}valueSerialized(){return this.value.toArray()}_copyValue(e){e.value.toArray(this._copied_value),this.set(this._copied_value)}_cloneRawInput(e){if(e instanceof Ie)return e.clone();{let t=[e[0],e[1],e[2],e[3]];return t[0]==null&&(t[0]=t[0]||0),t[1]==null&&(t[1]=t[1]||t[0]),t[2]==null&&(t[2]=t[2]||t[1]),t[3]==null&&(t[3]=t[3]||t[2]),t}}static areRawInputEqual(e,t){return e instanceof Ie?t instanceof Ie?e.equals(t):e.x==t[0]&&e.y==t[1]&&e.z==t[2]&&e.w==t[3]:t instanceof Ie?e[0]==t.x&&e[1]==t.y&&e[2]==t.z&&e[3]==t.w:e[0]==t[0]&&e[1]==t[1]&&e[2]==t[2]&&e[3]==t[3]}static areValuesEqual(e,t){return e.equals(t)}initComponents(){super.initComponents(),this.x=this.components[0],this.y=this.components[1],this.z=this.components[2],this.w=this.components[3]}set_value_from_components(){this._value.x=this.x.value,this._value.y=this.y.value,this._value.z=this.z.value,this._value.w=this.w.value}};var yM={[J.BOOLEAN]:f5,[J.BUTTON]:m5,[J.COLOR]:_5,[J.FLOAT]:mc,[J.FOLDER]:g5,[J.INTEGER]:Gh,[J.PARAM_PATH]:v5,[J.NODE_PATH]:Hh,[J.RAMP]:gs,[J.STRING]:Wh,[J.VECTOR2]:b5,[J.VECTOR3]:T5,[J.VECTOR4]:A5};var z$="params",C5=class{constructor(e){this.node=e,this._param_create_mode=!1,this._params_created=!1,this._params_by_name={},this._params_list=[],this._param_names=[],this._non_spare_params=[],this._spare_params=[],this._non_spare_param_names=[],this._spare_param_names=[],this._params_added_since_last_params_eval=!1,this._promises=[]}dispose(){this._params_node&&this._params_node.dispose();for(let e of this.all)e.dispose();this._post_create_params_hook_names=void 0,this._post_create_params_hooks=void 0,this._on_scene_load_hooks=void 0,this._on_scene_load_hook_names=void 0}initDependencyNode(){this._params_node||(this._params_node=new Yt(this.node.scene(),z$),this.node.addGraphInput(this._params_node,!1))}init(){this.initDependencyNode(),this._param_create_mode=!0,this._initFromParamsConfig(),this.node.createParams(),this._postCreateParams()}_postCreateParams(){this._updateCaches(),this._initParamAccessors(),this._param_create_mode=!1,this._params_created=!0,this._runPostCreateParamsHooks()}postCreateSpareParams(){this._updateCaches(),this._initParamAccessors(),this.node.scene().referencesController.notifyParamsUpdated(this.node),this.node.emit(St.PARAMS_UPDATED)}updateParams(e){let t=!1,r=!1,o=[];if(e.namesToDelete)for(let n of e.namesToDelete)this.has(n)&&(this._deleteParam(n),r=!0);if(e.toAdd)for(let n of e.toAdd){let s=this.addParam(n.type,n.name,n.initValue,n.options);s&&(n.rawInput!=null&&s.set(n.rawInput),t=!0,o.push(s))}(r||t)&&this.postCreateSpareParams();for(let n of o)this.node.scene().missingExpressionReferencesController.checkForMissingParamReferences(n)}_initFromParamsConfig(){var e;let t=this.node.paramsConfig,r=!1;if(t)for(let o of Object.keys(t)){let n=t[o],s,a=(e=this.node.createOptions)==null?void 0:e.paramsInitValueOverrides;a&&(s=a[o],r=!0),this.addParam(n.type,o,n.init_value,n.options,s)}r&&this.node.setDirty(),this.node.createOptions&&(this.node.createOptions.paramsInitValueOverrides=void 0)}_initParamAccessors(){let e=Object.getOwnPropertyNames(this.node.pv);this._removeUnneededAccessors(e),e=Object.getOwnPropertyNames(this.node.pv);for(let t of this.all){let r=t.options.isSpare();(!e.includes(t.name())||r)&&(Object.defineProperty(this.node.pv,t.name(),{get:()=>t.value,configurable:r}),Object.defineProperty(this.node.p,t.name(),{get:()=>t,configurable:r}))}}_removeUnneededAccessors(e){let t=this._param_names,r=[];for(let o of e)t.includes(o)||r.push(o);for(let o of r)Object.defineProperty(this.node.pv,o,{get:()=>{},configurable:!0}),Object.defineProperty(this.node.p,o,{get:()=>{},configurable:!0})}get params_node(){return this._params_node}get all(){return this._params_list}get non_spare(){return this._non_spare_params}get spare(){return this._spare_params}get names(){return this._param_names}get non_spare_names(){return this._non_spare_param_names}get spare_names(){return this._spare_param_names}set_with_type(e,t,r){let o=this.paramWithType(e,r);o?o.set(t):Q.warn(`param ${e} not found with type ${r}`)}set_float(e,t){this.set_with_type(e,t,J.FLOAT)}set_vector3(e,t){this.set_with_type(e,t,J.VECTOR3)}has_param(e){return this._params_by_name[e]!=null}has(e){return this.has_param(e)}get(e){return this.param(e)}paramWithType(e,t){let r=this.param(e);if(r&&r.type()==t)return r}getFloat(e){return this.paramWithType(e,J.FLOAT)}value(e){var t;return(t=this.param(e))==null?void 0:t.value}valueWithType(e,t){var r;return(r=this.paramWithType(e,t))==null?void 0:r.value}boolean(e){return this.valueWithType(e,J.BOOLEAN)}float(e){return this.valueWithType(e,J.FLOAT)}integer(e){return this.valueWithType(e,J.INTEGER)}string(e){return this.valueWithType(e,J.STRING)}vector2(e){return this.valueWithType(e,J.VECTOR2)}vector3(e){return this.valueWithType(e,J.VECTOR3)}color(e){return this.valueWithType(e,J.COLOR)}param(e){let t=this._params_by_name[e];return t??(Q.warn(`tried to access param '${e}' in node ${this.node.path()}, but existing params are: ${this.names} on node ${this.node.path()}`),null)}_deleteParam(e){let t=this._params_by_name[e];if(t){if(this._params_node&&this._params_node.removeGraphInput(this._params_by_name[e]),t._setupNodeDependencies(null),delete this._params_by_name[e],t.isMultiple()&&t.components)for(let r of t.components){let o=r.name();delete this._params_by_name[o]}t.dispose()}else throw new Error(`param '${e}' does not exist on node ${this.node.path()}`)}addParam(e,t,r,o={},n){let s=o.spare||!1;this._param_create_mode===!1&&!s&&Q.warn(`node ${this.node.path()} (${this.node.type()}) param '${t}' cannot be created outside of createParams`),this.node.scene()==null&&Q.warn(`node ${this.node.path()} (${this.node.type()}) has no scene assigned`);let a=yM[e];if(a!=null){let c=this._params_by_name[t];c&&(s?c.type()!=e&&this._deleteParam(c.name()):Q.warn(`a param named ${t} already exists`,this.node));let l=new a(this.node.scene(),this.node);if(l.options.set(o),l.setName(t),l.setInitValue(r),l.initComponents(),n==null)l.set(r);else if(l.options.isExpressionForEntities()&&l.set(r),n.raw_input!=null)l.set(n.raw_input);else if(n.simple_data!=null)l.set(n.simple_data);else if(n.complex_data!=null){let u=n.complex_data.raw_input;u?l.set(u):l.set(r);let p=n.complex_data.overriden_options;if(p!=null){let h=Object.keys(p);for(let d of h)l.options.setOption(d,p[d])}}if(l._setupNodeDependencies(this.node),this._params_by_name[l.name()]=l,l.isMultiple()&&l.components)for(let u of l.components)this._params_by_name[u.name()]=u;return this._params_added_since_last_params_eval=!0,l}}_updateCaches(){this._params_list=Object.values(this._params_by_name),this._param_names=Object.keys(this._params_by_name),this._non_spare_params=Object.values(this._params_by_name).filter(e=>!e.options.isSpare()),this._spare_params=Object.values(this._params_by_name).filter(e=>e.options.isSpare()),this._non_spare_param_names=Object.values(this._params_by_name).filter(e=>!e.options.isSpare()).map(e=>e.name()),this._spare_param_names=Object.values(this._params_by_name).filter(e=>e.options.isSpare()).map(e=>e.name())}async _evalParam(e){e.isDirty()&&(await e.compute(),e.states.error.active()&&this.node.states.error.set(`param '${e.name()}' error: ${e.states.error.message()}`))}async evalParams(e){let t=0;for(let o of e)o.isDirty()&&(t+=1);this._promises.length=t;let r=0;for(let o of e)o.isDirty()&&(this._promises[r]=this._evalParam(o),r+=1);await Promise.all(this._promises),this.node.states.error.active()&&this.node._setContainer(null)}paramsEvalRequired(){return this._params_node!=null&&(this._params_node.isDirty()||this._params_added_since_last_params_eval)}async evalAll(){var e;this.paramsEvalRequired()&&(await this.evalParams(this._params_list),(e=this._params_node)==null||e.removeDirtyState(),this._params_added_since_last_params_eval=!1)}onParamsCreated(e,t){if(this._params_created)t();else{if(this._post_create_params_hook_names&&this._post_create_params_hook_names.includes(e)){Q.error(`hook name ${e} already exists`);return}this._post_create_params_hook_names=this._post_create_params_hook_names||[],this._post_create_params_hook_names.push(e),this._post_create_params_hooks=this._post_create_params_hooks||[],this._post_create_params_hooks.push(t)}}addOnSceneLoadHook(e,t){this._on_scene_load_hook_names=this._on_scene_load_hook_names||[],this._on_scene_load_hooks=this._on_scene_load_hooks||[],this._on_scene_load_hook_names.includes(e)?Q.warn(`hook with name ${e} already exists`,this.node):(this._on_scene_load_hook_names.push(e),this._on_scene_load_hooks.push(t))}_runPostCreateParamsHooks(){if(this._post_create_params_hooks)for(let e of this._post_create_params_hooks)e()}runOnSceneLoadHooks(){if(this._on_scene_load_hooks)for(let e of this._on_scene_load_hooks)e()}};var E5=class{constructor(){}};var bM=class{constructor(i,e,t=0,r=0){if(this._node_src=i,this._node_dest=e,this._output_index=t,this._input_index=r,this._output_index==null)throw"bad output index";if(this._input_index==null)throw"bad input index";this._id=bM._next_id++,this._node_src.io.connections&&this._node_dest.io.connections&&(this._node_src.io.connections.addOutputConnection(this),this._node_dest.io.connections.addInputConnection(this))}get id(){return this._id}get node_src(){return this._node_src}get node_dest(){return this._node_dest}get output_index(){return this._output_index}get input_index(){return this._input_index}src_connection_point(){let i=this._node_src,e=this._output_index;return i.io.outputs.namedOutputConnectionPoints()[e]}dest_connection_point(){let i=this._node_dest,e=this._input_index;return i.io.inputs.namedInputConnectionPoints()[e]}disconnect(i={}){this._node_src.io.connections&&this._node_dest.io.connections&&(this._node_src.io.connections.removeOutputConnection(this),this._node_dest.io.connections.removeInputConnection(this)),i.setInput===!0&&this._node_dest.io.inputs.setInput(this._input_index,null)}},S5=bM;S5._next_id=0;var w5=class{constructor(e){this.inputs_controller=e,this._cloneRequiredStates=[],this._overridden=!1,this.node=e.node}initInputsClonedState(e){K.isArray(e)?this._clonedStates=e:this._clonedState=e,this._updateCloneRequiredState()}overrideClonedStateAllowed(){if(this._clonedStates){for(let e of this._clonedStates)if(e==Ge.FROM_NODE)return!0}return this._clonedState?this._clonedState==Ge.FROM_NODE:!1}cloneRequiredState(e){return this._cloneRequiredStates[e]}cloneRequiredStates(){return this._cloneRequiredStates}_getCloneRequiredState(e){let t=this._clonedStates;if(t){let r=t[e];if(r!=null)return this._cloneRequiredFromState(r)}return this._clonedState?this._cloneRequiredFromState(this._clonedState):!0}_cloneRequiredFromState(e){switch(e){case Ge.ALWAYS:return!0;case Ge.NEVER:return!1;case Ge.FROM_NODE:return!this._overridden}return Be.unreachable(e)}overrideClonedState(e){this._overridden=e,this._updateCloneRequiredState(),this.node.emit(St.OVERRIDE_CLONABLE_STATE_UPDATE),this.node.setDirty()}overriden(){return this._overridden}_updateCloneRequiredState(){if(this._clonedStates){let e=[];for(let t=0;t<this._clonedStates.length;t++)e[t]=this._getCloneRequiredState(t);this._cloneRequiredStates=e}else if(this._clonedState){let e=this.inputs_controller.maxInputsCount(),t=[];for(let r=0;r<e;r++)t[r]=this._getCloneRequiredState(r);this._cloneRequiredStates=t}}};var M5=0,N5=class{constructor(e){this.node=e,this._graphNodeInputs=[],this._inputs=[],this._has_named_inputs=!1,this._minInputsCount=0,this._maxInputsCount=M5,this._maxInputsCountOnInput=M5,this._depends_on_inputs=!0}dispose(){this._graphNode&&this._graphNode.dispose();for(let e of this._graphNodeInputs)e&&e.dispose();this._on_update_hooks=void 0,this._on_update_hook_names=void 0}set_depends_on_inputs(e){this._depends_on_inputs=e}setMinCount(e){this._minInputsCount=e}minCount(){return this._minInputsCount}setMaxCount(e){this._maxInputsCount==M5&&(this._maxInputsCountOnInput=e),this._maxInputsCount=e,this._initGraphNodeInputs()}namedInputConnectionPointsByName(e){if(this._named_input_connection_points){for(let t of this._named_input_connection_points)if(t&&t.name()==e)return t}}setNamedInputConnectionPoints(e){this._has_named_inputs=!0;let t=this.node.io.connections.inputConnections();if(t)for(let r of t)r&&r.input_index>=e.length&&r.disconnect({setInput:!0});this._named_input_connection_points=e,this.setMinCount(0),this.setMaxCount(e.length),this._initGraphNodeInputs(),this.node.emit(St.NAMED_INPUTS_UPDATED)}hasNamedInputs(){return this._has_named_inputs}namedInputConnectionPoints(){return this._named_input_connection_points||[]}_initGraphNodeInputs(){for(let e=0;e<this._maxInputsCount;e++)this._graphNodeInputs[e]=this._graphNodeInputs[e]||this._createGraphNodeInput(e)}_createGraphNodeInput(e){let t=new Yt(this.node.scene(),`input_${e}`);return this._graphNode||(this._graphNode=new Yt(this.node.scene(),"inputs"),this.node.addGraphInput(this._graphNode,!1)),this._graphNode.addGraphInput(t,!1),t}maxInputsCount(){return this._maxInputsCount||0}maxInputsCountOverriden(){return this._maxInputsCount!=this._maxInputsCountOnInput}inputGraphNode(e){return this._graphNodeInputs[e]}setCount(e,t){t==null&&(t=e),this.setMinCount(e),this.setMaxCount(t),this._initConnectionControllerInputs()}_initConnectionControllerInputs(){this.node.io.connections.initInputs()}isAnyInputDirty(){var e;return((e=this._graphNode)==null?void 0:e.isDirty())||!1}containersWithoutEvaluation(){let e=[];for(let t=0;t<this._inputs.length;t++){let r=this._inputs[t],o;r&&(o=r.containerController.containerUnlessBypassed()),e.push(o)}return e}_existingInputIndices(){let e=[];if(this._maxInputsCount>0)for(let t=0;t<this._inputs.length;t++)this._inputs[t]&&e.push(t);return e}async evalRequiredInputs(){var e;let t=[];if(this._maxInputsCount>0){let r=this._existingInputIndices();if(r.length<this._minInputsCount)this.node.states.error.set("inputs are missing");else if(r.length>0){let o=[],n;for(let s=0;s<this._inputs.length;s++)n=this._inputs[s],n&&o.push(this.evalRequiredInput(s));t=await Promise.all(o),(e=this._graphNode)==null||e.removeDirtyState()}}return t}async evalRequiredInput(e){let t,r=this.input(e);if(r&&(t=await r.compute(),this._graphNodeInputs[e].removeDirtyState()),!(t&&t.coreContent())){let o=this.input(e);if(o){let n=o.states.error.message();n&&this.node.states.error.set(`input ${e} is invalid (error: ${n})`)}}return t}getNamedInputIndex(e){var t;if(this._named_input_connection_points){for(let r=0;r<this._named_input_connection_points.length;r++)if(((t=this._named_input_connection_points[r])==null?void 0:t.name())==e)return r}return-1}getInputIndex(e){if(K.isString(e)){if(this.hasNamedInputs())return this.getNamedInputIndex(e);throw new Error(`node ${this.node.path()} has no named inputs`)}else return e}setInput(e,t,r=0){let o=this.getInputIndex(e)||0;if(o<0){let u=`invalid input (${e}) for node ${this.node.path()}`;throw console.warn(u),new Error(u)}let n=0;if(t&&t.io.outputs.hasNamedOutputs()&&(n=t.io.outputs.getOutputIndex(r),n==null||n<0)){let p=t.io.outputs.namedOutputConnectionPoints().map(h=>h.name());console.warn(`node ${t.path()} does not have an output named ${r}. inputs are: ${p.join(", ")}`);return}let s=this._graphNodeInputs[o];if(s==null){let u=`graph_input_node not found at index ${o}`;throw console.warn(u),new Error(u)}if(t&&this.node.parent()!=t.parent())return;let a=this._inputs[o],c=null,l;this.node.io.connections&&(l=this.node.io.connections.inputConnection(o)),l&&(c=l.output_index),(t!==a||n!=c)&&(a!=null&&this._depends_on_inputs&&s.removeGraphInput(a),t!=null?s.addGraphInput(t)?(this._depends_on_inputs||s.removeGraphInput(t),l&&l.disconnect({setInput:!1}),this._inputs[o]=t,new S5(t,this.node,n,o)):console.warn(`cannot connect ${t.path()} to ${this.node.path()}`):(this._inputs[o]=null,l&&l.disconnect({setInput:!1})),this._run_on_set_input_hooks(),s.setSuccessorsDirty(),this.node.emit(St.INPUTS_UPDATED))}remove_input(e){let t=this.inputs(),r;for(let o=0;o<t.length;o++)r=t[o],r!=null&&e!=null&&r.graphNodeId()===e.graphNodeId()&&this.setInput(o,null)}input(e){return this._inputs[e]}named_input(e){if(this.hasNamedInputs()){let t=this.getInputIndex(e);return this._inputs[t]}else return null}named_input_connection_point(e){if(this.hasNamedInputs()&&this._named_input_connection_points){let t=this.getInputIndex(e);return this._named_input_connection_points[t]}}has_named_input(e){return this.getNamedInputIndex(e)>=0}hasInput(e){return this._inputs[e]!=null}inputs(){return this._inputs}initInputsClonedState(e){this._clonedStatesController||(this._clonedStatesController=new w5(this),this._clonedStatesController.initInputsClonedState(e))}overrideClonedStateAllowed(){var e;return((e=this._clonedStatesController)==null?void 0:e.overrideClonedStateAllowed())||!1}overrideClonedState(e){var t;(t=this._clonedStatesController)==null||t.overrideClonedState(e)}clonedStateOverriden(){var e;return((e=this._clonedStatesController)==null?void 0:e.overriden())||!1}cloneRequired(e){var t;let r=(t=this._clonedStatesController)==null?void 0:t.cloneRequiredState(e);return r??!0}cloneRequiredStates(){var e;let t=(e=this._clonedStatesController)==null?void 0:e.cloneRequiredStates();return t??!0}add_on_set_input_hook(e,t){this._on_update_hooks=this._on_update_hooks||[],this._on_update_hook_names=this._on_update_hook_names||[],this._on_update_hook_names.includes(e)?console.warn(`hook with name ${e} already exists`,this.node):(this._on_update_hooks.push(t),this._on_update_hook_names.push(e))}_run_on_set_input_hooks(){if(this._on_update_hooks)for(let e of this._on_update_hooks)e()}};var O5=class{constructor(e){this.node=e,this._has_outputs=!1,this._has_named_outputs=!1}dispose(){this._named_output_connection_points&&this._named_output_connection_points.splice(0,this._named_output_connection_points.length)}setHasOneOutput(){this._has_outputs=!0}setHasNoOutput(){this._has_outputs=!1}hasOutputs(){return this._has_outputs}hasNamedOutputs(){return this._has_named_outputs}hasNamedOutput(e){return this.getNamedOutputIndex(e)>=0}namedOutputConnectionPoints(){return this._named_output_connection_points||[]}namedOutputConnection(e){if(this._named_output_connection_points)return this._named_output_connection_points[e]}getNamedOutputIndex(e){var t;if(this._named_output_connection_points){for(let r=0;r<this._named_output_connection_points.length;r++)if(((t=this._named_output_connection_points[r])==null?void 0:t.name())==e)return r}return-1}getOutputIndex(e){return e!=null?K.isString(e)?this.hasNamedOutputs()?this.getNamedOutputIndex(e):(console.warn(`node ${this.node.path()} has no named outputs`),-1):e:-1}namedOutputConnectionPointsByName(e){if(this._named_output_connection_points){for(let t of this._named_output_connection_points)if((t==null?void 0:t.name())==e)return t}}setNamedOutputConnectionPoints(e,t=!0){this._has_named_outputs=!0;let r=this.node.io.connections.outputConnections();if(r)for(let o of r)o&&o.output_index>=e.length&&o.disconnect({setInput:!0});this._named_output_connection_points=e,t&&this.node.scene()&&this.node.setDirty(this.node),this.node.emit(St.NAMED_OUTPUTS_UPDATED)}used_output_names(){var e;let t=this.node.io.connections;if(t){let o=t.outputConnections().map(a=>a?a.output_index:null);o=$e.uniq(o);let n=[];o.forEach(a=>{K.isNumber(a)&&n.push(a)});let s=[];for(let a of n){let c=(e=this.namedOutputConnectionPoints()[a])==null?void 0:e.name();c&&s.push(c)}return s}else return[]}};var P5=class{constructor(e){this._node=e,this._outputConnections=new Map}initInputs(){let e=this._node.io.inputs.maxInputsCount();for(this._inputConnections=this._inputConnections||new Array(e);this._inputConnections.length<e;)this._inputConnections.push(void 0)}dispose(){this._inputConnections&&this._inputConnections.splice(0,this._inputConnections.length),this._outputConnections&&this._outputConnections.clear()}addInputConnection(e){this._inputConnections?this._inputConnections[e.input_index]=e:console.warn("input connections array not initialized")}removeInputConnection(e){if(this._inputConnections)if(e.input_index<this._inputConnections.length){this._inputConnections[e.input_index]=void 0;let t=!0;for(let r=e.input_index;r<this._inputConnections.length;r++)this._inputConnections[r]&&(t=!1);t&&(this._inputConnections=this._inputConnections.slice(0,e.input_index))}else console.warn(`attempt to remove an input connection at index ${e.input_index}`);else console.warn("input connections array not initialized")}inputConnection(e){if(this._inputConnections)return this._inputConnections[e]}firstInputConnection(){return this._inputConnections?$e.compact(this._inputConnections)[0]:null}inputConnections(){return this._inputConnections}existingInputConnections(){let e=this._inputConnections;if(e)for(;e.length>1&&e[e.length-1]===void 0;)e.pop();return e}addOutputConnection(e){let t=e.output_index,r=e.id,o=this._outputConnections.get(t);o||(o=new Map,this._outputConnections.set(t,o)),o.set(r,e)}removeOutputConnection(e){let t=e.output_index,r=e.id,o=this._outputConnections.get(t);o&&o.delete(r)}outputConnections(){let e=[];return this._outputConnections.forEach((t,r)=>{t.forEach((o,n)=>{o&&e.push(o)})}),e}};var R5=class{constructor(e){this._node=e}set_in(e){this._in=e}set_out(e){this._out=e}clear(){this._in=void 0,this._out=void 0}in(){return this._in}out(){return this._out}};var gc=class{constructor(e,t,r){this._name=e,this._type=t,this._init_value=r}get init_value(){return this._init_value}name(){return this._name}type(){return this._type}are_types_matched(e,t){return!0}toJSON(){return this._json=this._json||this._create_json()}_create_json(){return{name:this._name,type:this._type}}};var mo=(i=>(i.BOOL="bool",i.INT="int",i.FLOAT="float",i.VEC2="vec2",i.VEC3="vec3",i.VEC4="vec4",i.SAMPLER_2D="sampler2D",i.SSS_MODEL="SSSModel",i))(mo||{});var H$={bool:J.BOOLEAN,int:J.INTEGER,float:J.FLOAT,vec2:J.VECTOR2,vec3:J.VECTOR3,vec4:J.VECTOR4,sampler2D:J.RAMP,SSSModel:J.STRING},TM={[J.BOOLEAN]:"bool",[J.COLOR]:"vec3",[J.INTEGER]:"int",[J.FLOAT]:"float",[J.FOLDER]:void 0,[J.VECTOR2]:"vec2",[J.VECTOR3]:"vec3",[J.VECTOR4]:"vec4",[J.BUTTON]:void 0,[J.PARAM_PATH]:void 0,[J.NODE_PATH]:void 0,[J.RAMP]:void 0,[J.STRING]:void 0},j$={bool:!1,int:0,float:0,vec2:[0,0],vec3:[0,0,0],vec4:[0,0,0,0],sampler2D:gs.DEFAULT_VALUE_JSON,SSSModel:"SSSModel()"},qh={bool:1,int:1,float:1,vec2:2,vec3:3,vec4:4,sampler2D:1,SSSModel:1},L5=class extends gc{constructor(e,t,r){super(e,t);this._name=e,this._type=t,this._init_value=r,this._init_value=this._init_value||j$[this._type]}type(){return this._type}are_types_matched(e,t){return e==t}get param_type(){return H$[this._type]}get init_value(){return this._init_value}toJSON(){return this._json=this._json||this._create_json()}_create_json(){return{name:this._name,type:this._type}}};var I5=(i=>(i.BOOL="bool",i.INT="int",i.FLOAT="float",i.VEC2="vec2",i.VEC3="vec3",i.VEC4="vec4",i))(I5||{});var W$={bool:J.BOOLEAN,int:J.INTEGER,float:J.FLOAT,vec2:J.VECTOR2,vec3:J.VECTOR3,vec4:J.VECTOR4},AM={[J.BOOLEAN]:"bool",[J.COLOR]:"vec3",[J.INTEGER]:"int",[J.FLOAT]:"float",[J.FOLDER]:void 0,[J.VECTOR2]:"vec2",[J.VECTOR3]:"vec3",[J.VECTOR4]:"vec4",[J.BUTTON]:void 0,[J.PARAM_PATH]:void 0,[J.NODE_PATH]:void 0,[J.RAMP]:void 0,[J.STRING]:void 0},q$={bool:!1,int:0,float:0,vec2:[0,0],vec3:[0,0,0],vec4:[0,0,0,0]};var D5=class extends gc{constructor(e,t){super(e,t);this._type=t,this._init_value=q$[this._type]}type(){return this._type}are_types_matched(e,t){return e==t}get param_type(){return W$[this._type]}get init_value(){return this._init_value}toJSON(){return this._json=this._json||this._create_json()}_create_json(){return{name:this._name,type:this._type}}};var Ke=(i=>(i.BASE="base",i.DRAG="drag",i.KEYBOARD="keyboard",i.MOUSE="mouse",i.POINTER="pointer",i))(Ke||{}),Je=class extends gc{constructor(e,t,r){super(e,t);this._name=e,this._type=t,this._event_listener=r}type(){return this._type}get param_type(){return J.FLOAT}are_types_matched(e,t){return t=="base"?!0:e==t}get event_listener(){return this._event_listener}toJSON(){return this._json=this._json||this._create_json()}_create_json(){return{name:this._name,type:this._type}}};var CM={[oe.ANIM]:void 0,[oe.AUDIO]:void 0,[oe.COP]:void 0,[oe.EVENT]:Ke.BASE,[oe.GL]:mo.FLOAT,[oe.JS]:I5.FLOAT,[oe.MANAGER]:void 0,[oe.MAT]:void 0,[oe.OBJ]:void 0,[oe.POST]:void 0,[oe.ROP]:void 0,[oe.SOP]:void 0};function A1(i,e,t){switch(i){case oe.EVENT:return new Je(e,t);case oe.GL:return new L5(e,t);case oe.JS:return new D5(e,t);default:return}}function EM(i){switch(i){case oe.EVENT:return;case oe.GL:return TM;case oe.JS:return AM;default:return}}var k5=class{constructor(e,t){this.node=e,this._context=t,this._raw_input_serialized_by_param_name=new Map,this._default_value_serialized_by_param_name=new Map,this._initialized=!1}initializeNode(){if(this._initialized){console.warn("already initialized",this.node);return}this._initialized=!0,this.node.params.onParamsCreated("create_inputs_from_params",this.create_inputs_from_params.bind(this))}initialized(){return this._initialized}create_inputs_from_params(){let e=EM(this._context);if(!e)return;let t=[];for(let r of this.node.params.names){let o=!0;if(this._inputless_param_names&&this._inputless_param_names.length>0&&this._inputless_param_names.includes(r)&&(o=!1),o&&this.node.params.has(r)){let n=this.node.params.get(r);if(n&&!n.parentParam()){let s=e[n.type()];if(s){let a=A1(this._context,n.name(),s);a&&t.push(a)}}}}this.node.io.inputs.setNamedInputConnectionPoints(t)}set_inputless_param_names(e){return this._inputless_param_names=e}createSpareParameters(){if(this.node.scene().loadingController.isLoading())return;let e=this.node.params.spare_names,t={};for(let o of e)if(this.node.params.has(o)){let n=this.node.params.get(o);n&&(this._raw_input_serialized_by_param_name.set(o,n.rawInputSerialized()),this._default_value_serialized_by_param_name.set(o,n.defaultValueSerialized()),t.namesToDelete=t.namesToDelete||[],t.namesToDelete.push(o))}let r=0;for(let o of this.node.io.inputs.namedInputConnectionPoints()){if(o){let n=this.node.io.inputs.input(r)!=null,s=o.name(),a=o.param_type,c=o.init_value,l=this._default_value_serialized_by_param_name.get(s),u=this.node.paramDefaultValue(s);if(u!=null?c=u:l!=null?c=l:c=o.init_value,K.isArray(o.init_value))if(K.isNumber(c)){let p=new Array(o.init_value.length);p.fill(c),c=p}else K.isArray(c)&&c.length==o.init_value.length&&l!=null&&(c=o.init_value);c!=null&&(t.toAdd=t.toAdd||[],t.toAdd.push({name:s,type:a,initValue:Cr.clone(c),rawInput:Cr.clone(c),options:{spare:!0,editable:!n}}))}r++}this.node.params.updateParams(t);for(let o of this.node.params.spare)if(!o.parentParam()){let n=this._raw_input_serialized_by_param_name.get(o.name());n&&o.set(n)}}};function C1(i,e){if(i.length!=e.length)return!1;for(let t=0;t<i.length;t++)if(i[t]!=e[t])return!1;return!0}var B5=class{constructor(e,t){this.node=e,this._context=t,this._create_spare_params_from_inputs=!0,this._functions_overridden=!1,this._input_name_function=r=>`in${r}`,this._output_name_function=r=>r==0?"val":`val${r}`,this._expected_input_types_function=()=>{let r=this.first_input_connection_type()||this.default_connection_type();return[r,r]},this._expected_output_types_function=()=>[this._expected_input_types_function()[0]],this._update_signature_if_required_bound=this.update_signature_if_required.bind(this),this._initialized=!1,this._spare_params_controller=new k5(this.node,this._context)}default_connection_type(){return CM[this._context]}create_connection_point(e,t){return A1(this._context,e,t)}functions_overridden(){return this._functions_overridden}initialized(){return this._initialized}set_create_spare_params_from_inputs(e){this._create_spare_params_from_inputs=e}set_input_name_function(e){this._initialize_if_required(),this._input_name_function=e}set_output_name_function(e){this._initialize_if_required(),this._output_name_function=e}set_expected_input_types_function(e){this._initialize_if_required(),this._functions_overridden=!0,this._expected_input_types_function=e}set_expected_output_types_function(e){this._initialize_if_required(),this._functions_overridden=!0,this._expected_output_types_function=e}input_name(e){return this._wrapped_input_name_function(e)}output_name(e){return this._wrapped_output_name_function(e)}initializeNode(){if(this._initialized){console.warn("already initialized",this.node);return}this._initialized=!0,this.node.io.inputs.add_on_set_input_hook("_update_signature_if_required",this._update_signature_if_required_bound),this.node.params.addOnSceneLoadHook("_update_signature_if_required",this._update_signature_if_required_bound),this.node.params.onParamsCreated("_update_signature_if_required_bound",this._update_signature_if_required_bound),this.node.addPostDirtyHook("_update_signature_if_required",this._update_signature_if_required_bound),this._spare_params_controller.initialized()||this._spare_params_controller.initializeNode()}_initialize_if_required(){this._initialized||this.initializeNode()}get spare_params(){return this._spare_params_controller}update_signature_if_required(e){(!this.node.lifecycle.creationCompleted()||!this._inputsOutputsMatchExpectations())&&(this.update_connection_types(),this.node.removeDirtyState(),this.node.scene().loadingController.isLoading()||this.make_successors_update_signatures())}make_successors_update_signatures(){let e=this.node.graphAllSuccessors();if(this.node.childrenAllowed()){let t=this.node.nodesByType(l1.INPUT),r=this.node.nodesByType(l1.OUTPUT);for(let o of t)e.push(o);for(let o of r)e.push(o)}for(let t of e){let r=t;r.io&&r.io.has_connection_points_controller&&r.io.connection_points.initialized()&&r.io.connection_points.update_signature_if_required(this.node)}}update_connection_types(){let t=this._wrapped_expected_input_types_function(),r=this._wrapped_expected_output_types_function(),o=[];for(let s=0;s<t.length;s++){let a=t[s],c=this.create_connection_point(this._wrapped_input_name_function(s),a);o.push(c)}let n=[];for(let s=0;s<r.length;s++){let a=r[s],c=this.create_connection_point(this._wrapped_output_name_function(s),a);n.push(c)}this.node.io.inputs.setNamedInputConnectionPoints(o),this.node.io.outputs.setNamedOutputConnectionPoints(n,!1),this._create_spare_params_from_inputs&&this._spare_params_controller.createSpareParameters()}_inputsOutputsMatchExpectations(){let e=this.node.io.inputs.namedInputConnectionPoints(),t=this.node.io.outputs.namedOutputConnectionPoints(),r=C1(e.map(a=>a==null?void 0:a.type()),this._wrapped_expected_input_types_function()),o=C1(t.map(a=>a==null?void 0:a.type()),this._wrapped_expected_output_types_function()),n=C1(e.map(a=>a==null?void 0:a.name()),e.map((a,c)=>this._wrapped_input_name_function(c))),s=C1(t.map(a=>a==null?void 0:a.name()),t.map((a,c)=>this._wrapped_output_name_function(c)));return r&&o&&n&&s}_wrapped_expected_input_types_function(){if(this.node.scene().loadingController.isLoading()){let e=this.node.io.saved_connection_points_data.in();if(e)return e.map(t=>t.type)}return this._expected_input_types_function()}_wrapped_expected_output_types_function(){if(this.node.scene().loadingController.isLoading()){let e=this.node.io.saved_connection_points_data.out();if(e)return e.map(t=>t.type)}return this._expected_output_types_function()}_wrapped_input_name_function(e){if(this.node.scene().loadingController.isLoading()){let t=this.node.io.saved_connection_points_data.in();if(t)return t[e].name}return this._input_name_function(e)}_wrapped_output_name_function(e){if(this.node.scene().loadingController.isLoading()){let t=this.node.io.saved_connection_points_data.out();if(t)return t[e].name}return this._output_name_function(e)}first_input_connection_type(){return this.input_connection_type(0)}input_connection_type(e){let t=this.node.io.connections.inputConnections();if(t){let r=t[e];if(r)return r.src_connection_point().type()}}};var F5=class{constructor(e){this.node=e,this._connections=new P5(this.node)}dispose(){this.inputs.dispose(),this.outputs.dispose(),this.connections.dispose()}get connections(){return this._connections}get inputs(){return this._inputs=this._inputs||new N5(this.node)}hasInputs(){return this._inputs!=null}get outputs(){return this._outputs=this._outputs||new O5(this.node)}has_outputs(){return this._outputs!=null}get connection_points(){return this._connection_points=this._connection_points||new B5(this.node,this.node.context())}get has_connection_points_controller(){return this._connection_points!=null}get saved_connection_points_data(){return this._saved_connection_points_data=this._saved_connection_points_data||new R5(this.node)}clear_saved_connection_points_data(){this._saved_connection_points_data&&(this._saved_connection_points_data.clear(),this._saved_connection_points_data=void 0)}};var U5=class{constructor(){}};var dr=class extends Yt{constructor(e,t="BaseNode",r){super(e,t);this.createOptions=r,this.containerController=new J4(this),this.pv=new E5,this.p=new U5,this._initialized=!1}copy_param_values(e){let t=this.params.non_spare;for(let r of t){let o=e.params.get(r.name());o&&r.copyValue(o)}}get parentController(){return this._parent_controller=this._parent_controller||new A4(this)}static displayedInputNames(){return[]}childrenControllerContext(){return this._childrenControllerContext}_create_childrenController(){if(this._childrenControllerContext)return new N4(this,this._childrenControllerContext)}get childrenController(){return this._childrenController=this._childrenController||this._create_childrenController()}childrenAllowed(){return this._childrenControllerContext!=null}get uiData(){return this._uiData=this._uiData||new d4(this)}get states(){return this._states=this._states||new T4(this)}get lifecycle(){return this._lifecycle=this._lifecycle||new O4(this)}get serializer(){return this._serializer=this._serializer||new kh(this)}get cookController(){return this._cookController=this._cookController||new Q4(this)}get io(){return this._io=this._io||new F5(this)}get nameController(){return this._nameController=this._nameController||new Nh(this)}setName(e){this.nameController.setName(e)}_setCoreName(e){this._name=e}get params(){return this._paramsController=this._paramsController||new C5(this)}initializeBaseAndNode(){var e;this._initialized?console.warn("node already initialized"):(this._initialized=!0,(e=this.displayNodeController)==null||e.initializeNode(),this.initializeBaseNode(),this.initializeNode(),this.polyNodeController&&this.polyNodeController.initializeNode())}initializeBaseNode(){}initializeNode(){}static type(){throw"type to be overriden"}type(){return this.constructor.type()}static context(){throw console.error("node has no node_context",this),"context requires override"}context(){return this.constructor.context()}static require_webgl2(){return!1}require_webgl2(){return this.constructor.require_webgl2()}setParent(e){this.parentController.setParent(e)}parent(){return this.parentController.parent()}firstAncestorWithContext(e){return this.parentController.firstAncestorWithContext(e)}root(){return this._scene.root()}path(e){return this.parentController.path(e)}createParams(){}addParam(e,t,r,o){var n;return(n=this._paramsController)==null?void 0:n.addParam(e,t,r,o)}paramDefaultValue(e){return null}cook(e){return null}onCookEnd(e,t){this.cookController.registerOnCookEnd(e,t)}async compute(){var e,t;return this.isDirty()||((t=(e=this.flags)==null?void 0:e.bypass)==null?void 0:t.active())?await this.containerController.compute():this.containerController.container()}_setContainer(e,t=null){this.containerController.container().set_content(e),e!=null&&(e.name||(e.name=this.path()),e.node||(e.node=this)),this.cookController.endCook(t)}createNode(e,t){var r;return(r=this.childrenController)==null?void 0:r.createNode(e,t)}createOperationContainer(e,t,r){var o;return(o=this.childrenController)==null?void 0:o.createOperationContainer(e,t,r)}removeNode(e){var t;(t=this.childrenController)==null||t.removeNode(e)}dispose(){super.dispose(),this.setParent(null),this._nameController&&(this._nameController.dispose(),this._nameController=void 0),this._io&&(this._io.dispose(),this._io=void 0),this._lifecycle&&(this._lifecycle.dispose(),this._lifecycle=void 0),this.displayNodeController&&this.displayNodeController.dispose(),this._childrenController&&(this._childrenController.dispose(),this._childrenController=void 0),this._paramsController&&(this._paramsController.dispose(),this._paramsController=void 0),this._cookController&&(this._cookController.dispose(),this._cookController=void 0),this._serializer&&(this._serializer.dispose(),this._serializer=void 0),this._uiData&&(this._uiData.dispose(),this._uiData=void 0)}children(){var e;return((e=this.childrenController)==null?void 0:e.children())||[]}node(e){var t;return((t=this.parentController)==null?void 0:t.findNode(e))||null}nodeSibling(e){var t;let r=this.parent();if(r){let o=(t=r.childrenController)==null?void 0:t.childByName(e);if(o)return o}return null}nodesByType(e){var t;return((t=this.childrenController)==null?void 0:t.nodesByType(e))||[]}setInput(e,t,r=0){this.io.inputs.setInput(e,t,r)}emit(e,t=null){this.scene().dispatchController.dispatch(this,e,t)}toJSON(e=!1){return this.serializer.toJSON(e)}async requiredModules(){}usedAssembler(){}integrationData(){}};var V5=class extends dr{static context(){return oe.MANAGER}};var ai=class{constructor(e,t,r){this.type=e,this.init_value=t,this.options=r}},v=class{static BUTTON(e,t){return new ai(J.BUTTON,e,t)}static BOOLEAN(e,t){return new ai(J.BOOLEAN,e,t)}static COLOR(e,t){return e instanceof he&&(e=e.toArray()),new ai(J.COLOR,e,t)}static FLOAT(e,t){return new ai(J.FLOAT,e,t)}static FOLDER(e=null,t){return new ai(J.FOLDER,e,t)}static INTEGER(e,t){return new ai(J.INTEGER,e,t)}static RAMP(e=gs.DEFAULT_VALUE,t){return new ai(J.RAMP,e,t)}static STRING(e="",t){return new ai(J.STRING,e,t)}static VECTOR2(e,t){return e instanceof G&&(e=e.toArray()),new ai(J.VECTOR2,e,t)}static VECTOR3(e,t){return e instanceof w&&(e=e.toArray()),new ai(J.VECTOR3,e,t)}static VECTOR4(e,t){return e instanceof Ie&&(e=e.toArray()),new ai(J.VECTOR4,e,t)}static NODE_PATH(e,t){return new ai(J.NODE_PATH,e,t)}static PARAM_PATH(e,t){return new ai(J.PARAM_PATH,e,t)}},V=class{};var SM="/",G5=class{constructor(e){this.scene=e}findObjectByMask(e){return this.findObjectByMaskInObject(e,this.scene.threejsScene())}findObjectByMaskInObject(e,t,r=""){for(let o of t.children){let n=this._removeTrailingOrHeadingSlash(o.name);r=this._removeTrailingOrHeadingSlash(r);let s=`${r}/${n}`;if(Fe.matchMask(s,e))return o;let a=this.findObjectByMaskInObject(e,o,s);if(a)return a}}objectsByMask(e){let t=[];return this.traverseObjectsWithMask(e,r=>{t.push(r)}),t}objectsByMaskInObject(e,t,r=[],o=""){return this.traverseObjectsWithMask(e,n=>{r.push(n)}),r}traverseObjectsWithMask(e,t,r=!1){this.traverseObjectsWithMaskInObject(e,this.scene.threejsScene(),t,r)}traverseObjectsWithMaskInObject(e,t,r,o,n=""){for(let s of t.children){let a=this._removeTrailingOrHeadingSlash(s.name);n=this._removeTrailingOrHeadingSlash(n);let c=`${n}/${a}`,l=Fe.matchMask(c,e);o&&(l=!l),l&&r(s),this.traverseObjectsWithMaskInObject(e,s,r,o,c)}}_removeTrailingOrHeadingSlash(e){return e[0]=="/"&&(e=e.substring(1)),e[e.length-1]=="/"&&(e=e.substring(0,e.length-1)),e}};var wM={computeOnDirty:!1,callback:i=>{E1.update(i)}};function MM(i){return class extends i{constructor(){super(...arguments);this.displayAudioIcon=v.BOOLEAN(0,{...wM,separatorBefore:!0}),this.audioIconColor=v.COLOR([0,0,0],{...wM,visibleIf:{displayAudioIcon:1}})}}}var E1=class{constructor(e){this.node=e,this._callbacksByName=new Map}async toggleSound(){this.audioListeners().forEach(e=>{e.toggleSound()}),this.update(),this._runOnToggleSoundCallbacks()}soundOn(){let e=this.audioListeners()[0];return e&&e.pv.soundOn||!1}update(){this._updateViewers()}audioListeners(){return this.node.nodesByType("audioListener")}_updateViewers(){this.node.scene().viewersRegister.traverseViewers(e=>{e.audioController().update()})}static update(e){e.audioController.update()}onToggleSound(e,t){if(this._callbacksByName.get(e)){console.warn(`callback already registered ith name '${e}'`);return}this._callbacksByName.set(e,t)}_runOnToggleSoundCallbacks(){let e=this.soundOn();this._callbacksByName.forEach(t=>{t(e)})}};var X$={computeOnDirty:!1,callback:i=>{du.update(i)}};function S1(i){return class extends i{constructor(){super(...arguments);this.autoUpdate=v.BOOLEAN(1,{...X$,separatorBefore:!0})}}}var du=class{constructor(e){this.node=e}async update(){let e=this.node.object,t=this.node.pv;t.autoUpdate!=e.autoUpdate&&(e.autoUpdate=t.autoUpdate)}static async update(e){e.sceneAutoUpdateController.update()}};var fu=["none","color","texture"],z5={callback:i=>{mu.update(i)}};function w1(i){return class extends i{constructor(){super(...arguments);this.backgroundMode=v.INTEGER(fu.indexOf("color"),{menu:{entries:fu.map((t,r)=>({name:t,value:r}))},...z5,separatorBefore:!0}),this.bgColor=v.COLOR([.09,.09,.09],{visibleIf:{backgroundMode:fu.indexOf("color")},...z5,conversion:Io.SRGB_TO_LINEAR}),this.bgTexture=v.NODE_PATH("",{visibleIf:{backgroundMode:fu.indexOf("texture")},nodeSelection:{context:oe.COP},dependentOnFoundNode:!1,...z5})}}}var mu=class{constructor(e){this.node=e}setMode(e){this.node.p.backgroundMode.set(fu.indexOf(e))}backgroundMode(){return fu[this.node.pv.backgroundMode]}async update(){let e=this.backgroundMode();switch(e){case"none":return this._setBackgroundNone();case"color":return await this._setBackgroundColor();case"texture":return await this._setBackgroundTexture()}Be.unreachable(e)}_setBackgroundNone(){let e=this.node.object;e.background=null}async _setBackgroundColor(){let e=this.node.object,t=this.node.pv;await this.node.p.bgColor.compute(),e.background&&e.background instanceof he?e.background.copy(t.bgColor):e.background=t.bgColor}async _setBackgroundTexture(){let e=this.node.object,r=this.node.pv.bgTexture.nodeWithContext(oe.COP);if(r){let o=await r.compute();e.background=o.texture()}else this.node.states.error.set("bgTexture node not found")}static update(e){e.sceneBackgroundController.update()}};var NM={computeOnDirty:!1,callback:i=>{_u.update(i)}};function M1(i){return class extends i{constructor(){super(...arguments);this.useEnvironment=v.BOOLEAN(0,{...NM,separatorBefore:!0}),this.environment=v.NODE_PATH("",{visibleIf:{useEnvironment:1},nodeSelection:{context:oe.COP},dependentOnFoundNode:!1,...NM})}}}var _u=class{constructor(e){this.node=e}async update(){let e=this.node.object,t=this.node.pv;if(t.useEnvironment){let r=t.environment.nodeWithContext(oe.COP);r?r.compute().then(o=>{e.environment=o.texture()}):this.node.states.error.set("bgTexture node not found")}else e.environment=null}static async update(e){e.sceneEnvController.update()}};var Y0=class{constructor(e,t=1,r=1e3){this.name="",this.color=new he(e),this.near=t,this.far=r}clone(){return new Y0(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}};Y0.prototype.isFog=!0;var $0=class{constructor(e,t=25e-5){this.name="",this.color=new he(e),this.density=t}clone(){return new $0(this.color,this.density)}toJSON(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}};$0.prototype.isFogExp2=!0;var gu={computeOnDirty:!1,callback:i=>{xu.update(i)}};var vu=["linear","exponential"];function Xh(i){return class extends i{constructor(){super(...arguments);this.useFog=v.BOOLEAN(0,{...gu,separatorBefore:!0}),this.fogType=v.INTEGER(vu.indexOf("exponential"),{visibleIf:{useFog:1},menu:{entries:vu.map((t,r)=>({name:t,value:r}))},...gu}),this.fogColor=v.COLOR([1,1,1],{visibleIf:{useFog:1},...gu}),this.fogNear=v.FLOAT(1,{range:[0,100],rangeLocked:[!0,!1],visibleIf:{useFog:1,fogType:vu.indexOf("linear")},...gu}),this.fogFar=v.FLOAT(100,{range:[0,100],rangeLocked:[!0,!1],visibleIf:{useFog:1,fogType:vu.indexOf("linear")},...gu}),this.fogDensity=v.FLOAT(25e-5,{visibleIf:{useFog:1,fogType:vu.indexOf("exponential")},...gu})}}}var Y$=class extends Xh(V){},xu=class{constructor(e){this.node=e}async update(){let e=this.node.object,t=this.node.pv;if(t.useFog)if(t.fogType==vu.indexOf("linear")){let r=this.fog2(t);e.fog=r,r.color=t.fogColor,r.near=t.fogNear,r.far=t.fogFar}else{let r=this.fogExp2(t);e.fog=this.fogExp2(t),r.color=t.fogColor,r.density=t.fogDensity}else e.fog&&(e.fog=null)}fog2(e){return this._fog=this._fog||new Y0(16777215,e.fogNear,e.fogFar)}fogExp2(e){return this._fogExp2=this._fogExp2||new $0(16777215,e.fogDensity)}static async update(e){e.sceneFogController.update()}};function OM(i){return class extends i{constructor(){super(...arguments);this.nodesMask=v.STRING("*/file* */image* */envMap*",{cook:!1,separatorBefore:!0}),this.printNodes=v.BUTTON(null,{cook:!1,callback:t=>{N1.PARAM_CALLBACK_printResolve(t)}})}}}var N1=class{constructor(e){this.node=e}static async PARAM_CALLBACK_printResolve(e){let t=await e.loadProgress.resolvedNodes();console.log(t);let r=t.map(o=>o.path()).sort();console.log(r)}async resolvedNodes(){let e=this.node.p.nodesMask;e.isDirty()&&await e.compute();let t=e.value;return this.node.scene().nodesController.nodesFromMask(t||"")}};var PM={computeOnDirty:!1,callback:i=>{yu.update(i)}};function O1(i){return class extends i{constructor(){super(...arguments);this.useOverrideMaterial=v.BOOLEAN(0,{...PM,separatorBefore:!0}),this.overrideMaterial=v.NODE_PATH("",{visibleIf:{useOverrideMaterial:1},nodeSelection:{context:oe.MAT},dependentOnFoundNode:!1,...PM})}}}var yu=class{constructor(e){this.node=e}async update(){let e=this.node.object,t=this.node.pv;if(t.useOverrideMaterial){let r=t.overrideMaterial.nodeWithContext(oe.MAT);if(r){let o=await r.compute();e.overrideMaterial=o.material()}else e.overrideMaterial=null,this.node.states.error.set("overrideMaterial node not found")}else e.overrideMaterial=null}static async update(e){e.sceneMaterialOverrideController.update()}};var RM="RootNode",LM=class extends OM(MM(O1(M1(Xh(w1(S1(V))))))){},$$=new LM,H5=class extends V5{constructor(){super(...arguments);this.paramsConfig=$$,this._object=this._createScene(),this._queued_nodes_by_id=new Map,this.audioController=new E1(this),this.sceneAutoUpdateController=new du(this),this.sceneBackgroundController=new mu(this),this.sceneEnvController=new _u(this),this.sceneFogController=new xu(this),this.loadProgress=new N1(this),this.sceneMaterialOverrideController=new yu(this),this._childrenControllerContext=oe.OBJ}static type(){return"root"}cook(){this.cookController.endCook()}initializeNode(){this._object.matrixAutoUpdate=!1,this.lifecycle.onChildAdd(this._on_child_add.bind(this)),this.lifecycle.onChildRemove(this._on_child_remove.bind(this))}_createScene(){let e=new Ji;return e.name=SM,e.matrixAutoUpdate=!1,e}get object(){return this._object}createNode(e,t){return super.createNode(e,t)}children(){return super.children()}nodesByType(e){return super.nodesByType(e)}_updateScene(){this.sceneAutoUpdateController.update(),this.sceneBackgroundController.update(),this.sceneEnvController.update(),this.sceneFogController.update(),this.sceneMaterialOverrideController.update()}_addToQueue(e){let t=e.graphNodeId();return this._queued_nodes_by_id.has(t)||this._queued_nodes_by_id.set(t,e),e}async processQueue(){this._updateScene();let e=new Map,t=[];this._queued_nodes_by_id.forEach((r,o)=>{let n=`_____${r.renderOrder}__${r.path()}`;t.push(n),e.set(n,r)}),this._queued_nodes_by_id.clear();for(let r of t){let o=e.get(r);o&&(e.delete(r),this._addToScene(o))}}_update_object(e){return this.scene().loadingController.autoUpdating()?(e.isDisplayed()&&!e.cookController.isCooking()&&e.compute(),this._addToScene(e)):this._addToQueue(e)}getParentForNode(e){if(e.attachableToHierarchy()){let t=e.io.inputs.input(0);return t?t.childrenGroup():this._object}else return null}_addToScene(e){var t;if(e.attachableToHierarchy()){let r=this.getParentForNode(e);r&&(e.usedInScene()?((t=e.childrenDisplayController)==null||t.request_display_node_container(),e.addObjectToParent(r)):e.removeObjectFromParent())}}_removeFromScene(e){e.removeObjectFromParent()}areChildrenCooking(){let e=this.children();for(let t of e)if(t.cookController.isCooking()||t.isDisplayNodeCooking())return!0;return!1}addToParentTransform(e){this._update_object(e)}removeFromParentTransform(e){this._update_object(e)}_on_child_add(e){e&&this._update_object(e)}_on_child_remove(e){e&&this._removeFromScene(e)}};var j5=class{constructor(e){this.scene=e,this._node_context_signatures={},this._instanciated_nodes_by_context_and_type={}}init(){this._root=new H5(this.scene,RM),this._root.initializeBaseAndNode(),this._root.params.init()}root(){return this._root}_traverseNode(e,t){let r=e.children();if(!(!r||r.length==0))for(let o of r)t(o),o.childrenController&&this._traverseNode(o,t)}clear(){var e;let t=this.root().children();for(let r of t)(e=this.root().childrenController)==null||e.removeNode(r)}node(e){return e==="/"?this.root():this.root().node(e)}allNodes(){let e=[this.root()],t=[this.root()],r=0;for(;t.length>0&&r<10;){let o=t.map(n=>n.childrenAllowed()?n.children():[]).flat();e=e.concat(o),t=o,r+=1}return e.flat()}nodesFromMask(e){let t=this.allNodes(),r=[];for(let o of t){let n=o.path();Fe.matchMask(n,e)&&r.push(o)}return r}reset_node_context_signatures(){this._node_context_signatures={}}register_node_context_signature(e){e.childrenAllowed()&&e.childrenController&&(this._node_context_signatures[e.childrenController.node_context_signature()]=!0)}node_context_signatures(){return Object.keys(this._node_context_signatures).sort().map(e=>e.toLowerCase())}addToInstanciatedNode(e){let t=e.context(),r=e.type();this._instanciated_nodes_by_context_and_type[t]=this._instanciated_nodes_by_context_and_type[t]||{},this._instanciated_nodes_by_context_and_type[t][r]=this._instanciated_nodes_by_context_and_type[t][r]||{},this._instanciated_nodes_by_context_and_type[t][r][e.graphNodeId()]=e}removeFromInstanciatedNode(e){let t=e.context(),r=e.type();delete this._instanciated_nodes_by_context_and_type[t][r][e.graphNodeId()]}nodesByType(e){let t=[];return this._traverseNode(this.scene.root(),r=>{r.type()==e&&t.push(r)}),t}nodesByContextAndType(e,t){let r=[],o=this._instanciated_nodes_by_context_and_type[e];if(o){let n=o[t];if(n)for(let s of Object.keys(n))r.push(n[s])}return r}};var W5=class{constructor(e){this.scene=e}toJSON(e=!1){let t={},r={};for(let o of this.scene.nodesController.allNodes()){let n=new kh(o);t[o.graphNodeId()]=n.toJSON(e);let s=o.params.all;for(let a of s)r[a.graphNodeId()]=a.toJSON()}return{nodes_by_graph_node_id:t,params_by_graph_node_id:r}}};var Mi=class{constructor(e){this.dispatcher=e,this._nodesByGraphNodeId=new Map,this._requireCanvasEventListeners=!1,this._activeEventDatas=[],this._activeEventDataTypes=new Set}registerNode(e){this._nodesByGraphNodeId.set(e.graphNodeId(),e),this.updateViewerEventListeners()}unregisterNode(e){this._nodesByGraphNodeId.delete(e.graphNodeId()),this.updateViewerEventListeners()}processEvent(e){var t;if(this._activeEventDatas.length==0)return;let r=(t=e.event)==null?void 0:t.type;r&&!this._activeEventDataTypes.has(r)||this._nodesByGraphNodeId.forEach(o=>{o.processEvent(e)})}updateViewerEventListeners(){this._updateActiveEventTypes(),this._requireCanvasEventListeners&&this.dispatcher.scene.viewersRegister.traverseViewers(e=>{e.eventsController().updateEvents(this)})}activeEventDatas(){return this._activeEventDatas}_updateActiveEventTypes(){let e=new Map;this._activeEventDataTypes.clear(),this._nodesByGraphNodeId.forEach(t=>{if(t.parent()){let r=t.activeEventDatas();for(let o of r)e.set(o,!0)}}),this._activeEventDatas=[],e.forEach((t,r)=>{this._activeEventDatas.push(r),this._activeEventDataTypes.add(r.type)})}};var P1=["auxclick","click","contextmenu","dblclick","mousedown","mouseenter","mouseleave","mousemove","mouseover","mouseout","mouseup","pointerlockchange","pointerlockerror","select","wheel"],q5=class extends Mi{constructor(){super(...arguments);this._requireCanvasEventListeners=!0}type(){return"mouse"}acceptedEventTypes(){return new Set(P1.map(e=>`${e}`))}};var _o=class extends dr{constructor(){super(...arguments);this._cook_without_inputs_bound=this._cook_without_inputs.bind(this)}static context(){return oe.EVENT}initializeBaseNode(){this.uiData.setLayoutHorizontal(),this.addPostDirtyHook("cook_without_inputs_on_dirty",this._cook_without_inputs_bound),this.io.inputs.set_depends_on_inputs(!1),this.io.connections.initInputs(),this.io.connection_points.spare_params.initializeNode()}_cook_without_inputs(){this.cookController.cookMainWithoutInputs()}cook(){this.cookController.endCook()}processEventViaConnectionPoint(e,t){t.event_listener?t.event_listener(e):this.processEvent(e)}processEvent(e){}async dispatchEventToOutput(e,t){this.run_on_dispatch_hook(e,t);let r=this.io.outputs.getOutputIndex(e);if(r>=0){let n=this.io.connections.outputConnections().filter(a=>a.output_index==r),s;for(let a of n){s=a.node_dest;let c=s.io.inputs.namedInputConnectionPoints()[a.input_index];s.processEventViaConnectionPoint(t,c)}}else console.warn(`requested output '${e}' does not exist on node '${this.path()}'`)}onDispatch(e,t){this._on_dispatch_hooks_by_output_name=this._on_dispatch_hooks_by_output_name||new Map,Ft.pushOnArrayAtEntry(this._on_dispatch_hooks_by_output_name,e,t)}run_on_dispatch_hook(e,t){if(this._on_dispatch_hooks_by_output_name){let r=this._on_dispatch_hooks_by_output_name.get(e);if(r)for(let o of r)o(t)}}};var bu=["keydown","keypress","keyup"],X5=class extends Mi{constructor(){super(...arguments);this._requireCanvasEventListeners=!0}type(){return"keyboard"}acceptedEventTypes(){return new Set(bu.map(e=>`${e}`))}};var On=(i=>(i.CANVAS="canvas",i.DOCUMENT="document",i))(On||{}),qr=["canvas","document"];function K$(i,e){return i=="canvas"?e:document}var Y5=class{constructor(e){this.viewer=e,this._bound_listener_map_by_event_controller_type=new Map}updateEvents(e){let t=this.canvas();if(!t){console.warn("no canvas found");return}let r=e.type(),o=this._bound_listener_map_by_event_controller_type.get(r);o||(o=new Map,this._bound_listener_map_by_event_controller_type.set(r,o)),o.forEach((s,a)=>{for(let c of qr)this._eventOwner({emitter:c,type:a},t).removeEventListener(a,s.listener)}),o.clear();let n=s=>{this.processEvent(s,e,t)};for(let s of e.activeEventDatas()){let a=this._eventOwner(s,t);a.addEventListener(s.type,n),a!=document&&bu.includes(s.type)&&a.setAttribute("tabindex","0"),o.set(s.type,{listener:n,data:s})}}_eventOwner(e,t){return e.type=="resize"?window:K$(e.emitter,t)}cameraNode(){return this.viewer.camerasController().cameraNode()}canvas(){return this.viewer.canvas()}init(){if(!this.canvas()){console.warn("no canvas found for eventsController");return}this.viewer.scene().eventsDispatcher.traverseControllers(e=>{this.updateEvents(e)})}registeredEventTypes(){let e=[];return this._bound_listener_map_by_event_controller_type.forEach(t=>{t.forEach((r,o)=>{e.push(o)})}),e}dispose(){let e=this.canvas();this._bound_listener_map_by_event_controller_type.forEach(t=>{e&&t.forEach((r,o)=>{this._eventOwner(r.data,e).removeEventListener(o,r.listener)})})}processEvent(e,t,r){let o={viewer:this.viewer,event:e,cameraNode:this.cameraNode()};t.processEvent(o)}};var Xe={visibleIf:{active:1},callback:i=>{IM.PARAM_CALLBACK_updateRegister(i)}},ci=class extends _o{constructor(){super(...arguments);this._activeEventDatas=[]}initializeBaseNode(){super.initializeBaseNode();let e=()=>{this.scene().eventsDispatcher.registerEventNode(this)},t=()=>{this.scene().eventsDispatcher.unregisterEventNode(this)};this.lifecycle.onAfterAdded(e),this.lifecycle.onBeforeDeleted(t),this.params.onParamsCreated("update_register",()=>{this._updateRegister()})}processEvent(e){!this.pv.active||!e.event||this.dispatchEventToOutput(e.event.type,e)}static PARAM_CALLBACK_updateRegister(e){e._updateRegister()}_updateRegister(){this._updateActiveEventDatas(),this.scene().eventsDispatcher.updateViewerEventListeners(this)}_updateActiveEventDatas(){this._activeEventDatas=[],this.pv.active&&this.acceptedEventTypes().forEach(t=>{let r=this.params.get(t);r&&r.value&&this._activeEventDatas.push({type:t,emitter:qr[this.pv.element]})})}activeEventDatas(){return this._activeEventDatas}};var IM=class extends ci{acceptedEventTypes(){return new Set}};var DM=class extends V{constructor(){super(...arguments);this.active=v.BOOLEAN(!0,{callback:e=>{R1.PARAM_CALLBACK_updateRegister(e)},separatorAfter:!0}),this.element=v.INTEGER(qr.indexOf(On.CANVAS),{menu:{entries:qr.map((e,t)=>({name:e,value:t}))},separatorAfter:!0}),this.auxclick=v.BOOLEAN(0,Xe),this.click=v.BOOLEAN(0,Xe),this.contextmenu=v.BOOLEAN(0,Xe),this.dblclick=v.BOOLEAN(0,Xe),this.mousedown=v.BOOLEAN(1,Xe),this.mouseenter=v.BOOLEAN(0,Xe),this.mouseleave=v.BOOLEAN(0,Xe),this.mousemove=v.BOOLEAN(1,Xe),this.mouseover=v.BOOLEAN(0,Xe),this.mouseout=v.BOOLEAN(0,Xe),this.mouseup=v.BOOLEAN(1,Xe),this.pointerlockchange=v.BOOLEAN(0,Xe),this.pointerlockerror=v.BOOLEAN(0,Xe),this.select=v.BOOLEAN(0,Xe),this.wheel=v.BOOLEAN(0,Xe),this.ctrlKey=v.BOOLEAN(0,{...Xe,separatorBefore:!0}),this.altKey=v.BOOLEAN(0,Xe),this.shiftKey=v.BOOLEAN(0,Xe),this.metaKey=v.BOOLEAN(0,Xe)}},J$=new DM,R1=class extends ci{constructor(){super(...arguments);this.paramsConfig=J$}static type(){return"mouse"}acceptedEventTypes(){return new Set(P1.map(e=>`${e}`))}initializeNode(){this.io.outputs.setNamedOutputConnectionPoints(P1.map(e=>new Je(e,Ke.MOUSE)))}processEvent(e){if(!this.pv.active||!e.event)return;let t=e.event;t.ctrlKey==this.pv.ctrlKey&&t.shiftKey==this.pv.shiftKey&&t.altKey==this.pv.altKey&&t.metaKey==this.pv.metaKey&&this.dispatchEventToOutput(e.event.type,e)}};var L1=["pointerdown","pointermove","pointerup"],$5=class extends Mi{constructor(){super(...arguments);this._requireCanvasEventListeners=!0}type(){return"pointer"}acceptedEventTypes(){return new Set(L1.map(e=>`${e}`))}};var kM=class extends V{constructor(){super(...arguments);this.active=v.BOOLEAN(!0,{callback:e=>{Tu.PARAM_CALLBACK_updateRegister(e)},separatorAfter:!0}),this.element=v.INTEGER(qr.indexOf(On.CANVAS),{menu:{entries:qr.map((e,t)=>({name:e,value:t}))},separatorAfter:!0}),this.pointerdown=v.BOOLEAN(1,Xe),this.pointermove=v.BOOLEAN(0,Xe),this.pointerup=v.BOOLEAN(0,Xe),this.ctrlKey=v.BOOLEAN(0,{...Xe,separatorBefore:!0}),this.altKey=v.BOOLEAN(0,Xe),this.shiftKey=v.BOOLEAN(0,Xe),this.metaKey=v.BOOLEAN(0,Xe)}},Z$=new kM,Tu=class extends ci{constructor(){super(...arguments);this.paramsConfig=Z$}static type(){return"pointer"}acceptedEventTypes(){return new Set(L1.map(e=>`${e}`))}initializeNode(){this.io.outputs.setNamedOutputConnectionPoints(L1.map(e=>new Je(e,Ke.POINTER)))}processEvent(e){if(!this.pv.active||!e.event)return;let t=e.event;t.ctrlKey==this.pv.ctrlKey&&t.shiftKey==this.pv.shiftKey&&t.altKey==this.pv.altKey&&t.metaKey==this.pv.metaKey&&this.dispatchEventToOutput(e.event.type,e)}};var BM=class extends V{constructor(){super(...arguments);this.active=v.BOOLEAN(!0,{callback:(e,t)=>{I1.PARAM_CALLBACK_updateRegister(e)},separatorAfter:!0}),this.element=v.INTEGER(qr.indexOf(On.CANVAS),{menu:{entries:qr.map((e,t)=>({name:e,value:t}))},separatorAfter:!0,...Xe}),this.keydown=v.BOOLEAN(1,Xe),this.keypress=v.BOOLEAN(0,Xe),this.keyup=v.BOOLEAN(0,Xe),this.keyCodes=v.STRING("Digit1 KeyE ArrowDown",Xe),this.ctrlKey=v.BOOLEAN(0,Xe),this.altKey=v.BOOLEAN(0,Xe),this.shiftKey=v.BOOLEAN(0,Xe),this.metaKey=v.BOOLEAN(0,Xe)}},Q$=new BM,I1=class extends ci{constructor(){super(...arguments);this.paramsConfig=Q$}static type(){return"keyboard"}acceptedEventTypes(){return new Set(bu.map(e=>`${e}`))}initializeNode(){this.io.outputs.setNamedOutputConnectionPoints(bu.map(e=>new Je(e,Ke.KEYBOARD)))}setElement(e){this.p.element.set(qr.indexOf(e))}processEvent(e){if(!this.pv.active||!e.event)return;let t=e.event;t.ctrlKey==this.pv.ctrlKey&&t.shiftKey==this.pv.shiftKey&&t.altKey==this.pv.altKey&&t.metaKey==this.pv.metaKey&&(!Fe.matchMask(t.code,this.pv.keyCodes)||this.dispatchEventToOutput(e.event.type,e))}};var D1=["resize"],K5=class extends Mi{constructor(){super(...arguments);this._requireCanvasEventListeners=!0}type(){return"window"}acceptedEventTypes(){return new Set(D1.map(e=>`${e}`))}};var FM=class extends V{constructor(){super(...arguments);this.active=v.BOOLEAN(!0,{callback:e=>{k1.PARAM_CALLBACK_updateRegister(e)},separatorAfter:!0}),this.element=v.INTEGER(0,{hidden:!0}),this.resize=v.BOOLEAN(1,Xe)}},eK=new FM,k1=class extends ci{constructor(){super(...arguments);this.paramsConfig=eK}static type(){return"window"}acceptedEventTypes(){return new Set(D1.map(e=>`${e}`))}initializeNode(){this.io.outputs.setNamedOutputConnectionPoints(D1.map(e=>new Je(e,Ke.POINTER)))}processEvent(e){!this.pv.active||!e.event||this.dispatchEventToOutput(e.event.type,e)}};var B1=["dragover"],J5=class extends Mi{constructor(){super(...arguments);this._requireCanvasEventListeners=!0}type(){return"drag"}acceptedEventTypes(){return new Set(B1.map(e=>`${e}`))}};var F1=["touchstart","touchmove","touchend"],Z5=class extends Mi{constructor(){super(...arguments);this._requireCanvasEventListeners=!0}type(){return"touch"}acceptedEventTypes(){return new Set(F1.map(e=>`${e}`))}};var UM=class extends V{constructor(){super(...arguments);this.active=v.BOOLEAN(!0,{callback:e=>{U1.PARAM_CALLBACK_updateRegister(e)},separatorAfter:!0}),this.element=v.INTEGER(qr.indexOf(On.CANVAS),{menu:{entries:qr.map((e,t)=>({name:e,value:t}))},separatorAfter:!0}),this.dragover=v.BOOLEAN(1,Xe),this.ctrlKey=v.BOOLEAN(0,{...Xe,separatorBefore:!0}),this.altKey=v.BOOLEAN(0,Xe),this.shiftKey=v.BOOLEAN(0,Xe),this.metaKey=v.BOOLEAN(0,Xe)}},tK=new UM,U1=class extends ci{constructor(){super(...arguments);this.paramsConfig=tK}static type(){return"drag"}acceptedEventTypes(){return new Set(B1.map(e=>`${e}`))}initializeNode(){this.io.outputs.setNamedOutputConnectionPoints(B1.map(e=>new Je(e,Ke.DRAG)))}processEvent(e){if(!this.pv.active||!e.event)return;let t=e.event;t.ctrlKey==this.pv.ctrlKey&&t.shiftKey==this.pv.shiftKey&&t.altKey==this.pv.altKey&&t.metaKey==this.pv.metaKey&&this.dispatchEventToOutput(e.event.type,e)}};var VM=class extends V{constructor(){super(...arguments);this.active=v.BOOLEAN(!0,{callback:e=>{V1.PARAM_CALLBACK_updateRegister(e)},separatorAfter:!0}),this.element=v.INTEGER(qr.indexOf(On.CANVAS),{menu:{entries:qr.map((e,t)=>({name:e,value:t}))},separatorAfter:!0}),this.touchstart=v.BOOLEAN(1,Xe),this.touchmove=v.BOOLEAN(0,Xe),this.touchend=v.BOOLEAN(0,Xe)}},rK=new VM,V1=class extends ci{constructor(){super(...arguments);this.paramsConfig=rK}static type(){return"touch"}acceptedEventTypes(){return new Set(F1.map(e=>`${e}`))}initializeNode(){this.io.outputs.setNamedOutputConnectionPoints(F1.map(e=>new Je(e,Ke.DRAG)))}processEvent(e){!this.pv.active||!e.event||this.dispatchEventToOutput(e.event.type,e)}};var Q5=class{constructor(e){this.scene=e,this.sceneEventsController=new O3,this._controllers=[]}registerEventNode(e){let t=this._findOrCreateControllerForNode(e);t&&t.registerNode(e)}unregisterEventNode(e){let t=this._findOrCreateControllerForNode(e);t&&t.unregisterNode(e)}updateViewerEventListeners(e){let t=this._findOrCreateControllerForNode(e);t&&t.updateViewerEventListeners()}traverseControllers(e){for(let t of this._controllers)e(t)}_findOrCreateControllerForNode(e){switch(e.type()){case I1.type():return this.keyboardEventsController;case R1.type():return this.mouseEventsController;case U1.type():return this.dragEventsController;case Tu.type():return this.pointerEventsController;case V1.type():return this.touchEventsController;case k1.type():return this.windowEventsController}}get keyboardEventsController(){return this._keyboardEventsController=this._keyboardEventsController||this._createController(X5)}get mouseEventsController(){return this._mouseEventsController=this._mouseEventsController||this._createController(q5)}get dragEventsController(){return this._dragEventsController=this._dragEventsController||this._createController(J5)}get pointerEventsController(){return this._pointerEventsController=this._pointerEventsController||this._createController($5)}get windowEventsController(){return this._windowEventsController=this._windowEventsController||this._createController(K5)}get touchEventsController(){return this._touchEventsController=this._touchEventsController||this._createController(Z5)}_createController(e){let t=new e(this);return this._controllers.includes(t)||this._controllers.push(t),t}};var e8=class{constructor(e){this.scene=e,this._referenced_nodes_by_src_param_id=new Map,this._referencing_params_by_referenced_node_id=new Map,this._referencing_params_by_all_named_node_ids=new Map}setReferenceFromParam(e,t){this._referenced_nodes_by_src_param_id.set(e.graphNodeId(),t),Ft.pushOnArrayAtEntry(this._referencing_params_by_referenced_node_id,t.graphNodeId(),e)}setNamedNodesFromParam(e){let t=e.decomposed_path.named_nodes();for(let r of t)Ft.pushOnArrayAtEntry(this._referencing_params_by_all_named_node_ids,r.graphNodeId(),e)}resetReferenceFromParam(e){let t=this._referenced_nodes_by_src_param_id.get(e.graphNodeId());if(t){Ft.popFromArrayAtEntry(this._referencing_params_by_referenced_node_id,t.graphNodeId(),e);let r=e.decomposed_path.named_nodes();for(let o of r)Ft.popFromArrayAtEntry(this._referencing_params_by_all_named_node_ids,o.graphNodeId(),e);this._referenced_nodes_by_src_param_id.delete(e.graphNodeId())}}referencing_params(e){return this._referencing_params_by_referenced_node_id.get(e.graphNodeId())}referencing_nodes(e){let t=this._referencing_params_by_referenced_node_id.get(e.graphNodeId());if(t){let r=new Map;for(let n of t){let s=n.node;r.set(s.graphNodeId(),s)}let o=[];return r.forEach(n=>{o.push(n)}),o}}nodes_referenced_by(e){let t=new Set([J.NODE_PATH]),r=[];for(let a of e.params.all)t.has(a.type())&&r.push(a);let o=new Map,n=[];for(let a of r)this._check_param(a,o,n);for(let a of n)o.set(a.node.graphNodeId(),a.node);let s=[];return o.forEach(a=>{s.push(a)}),s}_check_param(e,t,r){if(e instanceof Hh){let o=e.value.node();o&&t.set(o.graphNodeId(),o);return}}notifyNameUpdated(e){let t=this._referencing_params_by_all_named_node_ids.get(e.graphNodeId());if(t){let r=$e.shallowClone(t);for(let o of r)o.notifyPathRebuildRequired(e)}}notifyParamsUpdated(e){let t=this._referencing_params_by_all_named_node_ids.get(e.graphNodeId());if(t){let r=$e.shallowClone(t);for(let o of r)o.options.isSelectingParam()&&o.notifyTargetParamOwnerParamsUpdated(e)}}};var GM={resolution:{value:new G(1e3,1e3)}},t8=class{constructor(e){this.scene=e}addUniforms(e,t){let{paramConfigs:r,additionalTextureUniforms:o,timeDependent:n,resolutionDependent:s}=t;for(let c of r)e[c.uniformName()]=c.uniform();let a=Object.keys(o);for(let c of a){let l=o[c];e[c]=l}n?this.addTimeUniform(e):this.removeTimeUniform(e),s?this.addResolutionUniforms(e):this.removeResolutionUniform(e)}addTimeUniform(e){e.time=this.scene.timeController.timeUniform()}removeTimeUniform(e){delete e.time}timeUniformValue(){return this.scene.timeController.timeUniform().value}addResolutionUniforms(e){e.resolution=GM.resolution}removeResolutionUniform(e){delete e.resolution}updateResolution(e){GM.resolution.value.copy(e)}};var r8=class{constructor(e){this.scene=e,this._viewersById=new Map,this._viewersByCamera=new Map}registerViewer(e){this._viewersById.set(e.id(),e),this._viewersByCamera.set(e.cameraNode(),e),this._updateCache()}unregisterViewer(e){this._viewersById.delete(e.id()),this._viewersByCamera.delete(e.cameraNode()),this._updateCache()}traverseViewers(e){this._viewersById.forEach(e)}viewerWithCamera(e){let t=this._viewersByCamera.get(e);return t||e.createViewer()}firstViewer(){return this._firstViewer}_updateCache(){this._firstViewer=void 0,this._viewersById.forEach(e=>{this._firstViewer=this._firstViewer||e})}};var o8=class{constructor(){this._require_webgl2=!1}require_webgl2(){return this._require_webgl2}set_require_webgl2(){this._require_webgl2||(this._require_webgl2=!0,Q.renderersController.setRequireWebGL2())}};var i8=class{constructor(e){this._scene=e,this._onWindowResizeBound=this._onWindowResize.bind(this)}graphNode(){return this._coreGraphNode=this._coreGraphNode||this._createGraphNode()}_createGraphNode(){let e=new Yt(this._scene,"SceneWindowController");return window.addEventListener("resize",this._onWindowResizeBound),e}_onWindowResize(){this.graphNode().setSuccessorsDirty()}dispose(){window.removeEventListener("resize",this._onWindowResizeBound)}};var n8=class{constructor(){this._params_by_id=new Map,this._assets_root=null}register_param(e){this._params_by_id.set(e.graphNodeId(),e)}deregister_param(e){this._params_by_id.delete(e.graphNodeId())}traverse_params(e){this._params_by_id.forEach((t,r)=>{e(t)})}root(){return this._assets_root}setRoot(e){e==""&&(e=null),this._assets_root=e}};var s8=class{constructor(){this._cameras_controller=new P3(this),this._cooker=new R3(this),this.cookController=new L3,this._graph=new I3,this._missing_expression_references_controller=new h4(this),this._expressions_controller=new c4,this._nodes_controller=new j5(this),this._objects_controller=new G5(this),this._references_controller=new e8(this),this._time_controller=new $s(this),this._read_only=!1,this._graph.setScene(this),this.nodesController.init()}threejsScene(){return this.root().object}setUuid(e){return this._uuid=e}get uuid(){return this._uuid}setName(e){return e=Fe.sanitizeName(e),this._name=e}name(){return this._name}get camerasController(){return this._cameras_controller}mainCameraNode(){return this.camerasController.mainCameraNode()}get cooker(){return this._cooker}get assets(){return this._assets_controller=this._assets_controller||new n8}async waitForCooksCompleted(){return await this.cookController.waitForCooksCompleted()}get dispatchController(){return this._dispatch_controller=this._dispatch_controller||new a4(this)}get eventsDispatcher(){return this._events_dispatcher=this._events_dispatcher||new Q5(this)}get graph(){return this._graph}get lifecycleController(){return this._lifecycle_controller=this._lifecycle_controller||new l4(this)}get loadingController(){return this._loading_controller=this._loading_controller||new u4(this)}get missingExpressionReferencesController(){return this._missing_expression_references_controller}get expressionsController(){return this._expressions_controller}get nodesController(){return this._nodes_controller}createNode(e,t){return this.root().createNode(e,t)}nodesByType(e){return this.nodesController.nodesByType(e)}get objectsController(){return this._objects_controller}findObjectByMask(e){return this._objects_controller.findObjectByMask(e)}objectsByMask(e){return this._objects_controller.objectsByMask(e)}get referencesController(){return this._references_controller}get performance(){return this._performance=this._performance||new s4}get viewersRegister(){return this._viewers_register=this._viewers_register||new r8(this)}get timeController(){return this._time_controller}setFrame(e){this.timeController.setFrame(e)}setFrameToStart(){this.timeController.setFrameToStart()}frame(){return this.timeController.frame()}time(){return this.timeController.time()}maxFrame(){return this.timeController.maxFrame()}play(){this.timeController.play()}pause(){this.timeController.pause()}get serializer(){return this._serializer=this._serializer||new W5(this)}toJSON(){return this.serializer.toJSON()}markAsReadOnly(e){this._read_only||(this._read_only_requester=e,this._read_only=!0)}readOnly(){return this._read_only}readOnlyRequester(){return this._read_only_requester}get uniformsController(){return this._uniformsController=this._uniformsController||new t8(this)}get webgl_controller(){return this._webgl_controller=this._webgl_controller||new o8}get windowController(){return this._windowController=this._windowController||new i8(this)}dispose(){var e;(e=this._windowController)==null||e.dispose()}async batchUpdates(e){this._cooker.block(),await e(),this._cooker.unblock()}node(e){return this.nodesController.node(e)}root(){return this.nodesController.root()}registerOnBeforeTick(e,t){this.timeController.registerOnBeforeTick(e,t)}unRegisterOnBeforeTick(e){this.timeController.unRegisterOnBeforeTick(e)}registeredBeforeTickCallbacks(){return this.timeController.registeredBeforeTickCallbacks()}registerOnAfterTick(e,t){this.timeController.registerOnAfterTick(e,t)}unRegisterOnAfterTick(e){this.timeController.unRegisterOnAfterTick(e)}registeredAfterTickCallbacks(){return this.timeController.registeredAfterTickCallbacks()}};var Ni=class{constructor(e){this._param=e}process_data(e){let t=e.raw_input;t!==void 0&&this._param.set(t),this.add_main(e)}add_main(e){}static spare_params_data(e){return this.params_data(!0,e)}static non_spare_params_data_value(e){return this.params_data_value(!1,e)}static params_data(e,t){let r;if(t){r={};let o=Object.keys(t),n;for(let s of o)n=t[s],n&&(r[s]=t)}return r}static params_data_value(e,t){let r;if(t){r={};let o=Object.keys(t),n;for(let s of o)if(n=t[s],n!=null){let a=n.options,c=n.overriden_options;if(a||c){let l=n;a&&a.spare==e?l.raw_input!=null&&(r[s]={complex_data:l}):c&&(r[s]={complex_data:l})}else{let l=n;(c||l!=null)&&(r[s]={simple_data:l})}}}return r}};var zM="operationsComposer",Yh=class{constructor(e,t,r){this._scene=e,this.states=t,this._node=r}static type(){throw"type to be overriden"}type(){return this.constructor.type()}static context(){throw console.error("operation has no node_context",this),"context requires override"}context(){return this.constructor.context()}scene(){return this._scene}cook(e,t){}convertExportParamData(e){let{params:t,paramName:r,paramData:o}=e,n=t[r];if(K.isBoolean(o))return o;if(K.isNumber(o))return K.isBoolean(n)?o>=1:o;if(K.isString(o))return n&&(n instanceof Ci||n instanceof sc)?n.setPath(o):o;K.isArray(o)&&t[r].fromArray(o)}};Yh.DEFAULT_PARAMS={};Yh.INPUT_CLONED_STATE=[];var vs=class{constructor(e){this._node=e,this._nodes=[],this._optimized_root_node_names=new Set,this._operation_containers_by_name=new Map,this._node_inputs=[]}nodes(){return this._nodes}process_data(e,t){var r,o,n;if(!t||!(this._node.childrenAllowed()&&this._node.childrenController))return;let{optimized_names:s}=vs.child_names_by_optimized_state(t);this._nodes=[],this._optimized_root_node_names=new Set;for(let a of s)vs.is_optimized_root_node(t,a)&&this._optimized_root_node_names.add(a);for(let a of this._optimized_root_node_names){let c=t[a],l={nodeName:a},u=this._node.createNode(zM,l);if(u){this._nodes.push(u),((r=c.flags)==null?void 0:r.display)&&((n=(o=u.flags)==null?void 0:o.display)==null||n.set(!0));let p=this._createOperationContainer(e,u,c,u.name());u.setOutputOperationContainer(p)}}for(let a of this._nodes){let c=a.outputOperationContainer();if(c){this._node_inputs=[],this._add_optimized_node_inputs(e,a,t,a.name(),c),a.io.inputs.setCount(this._node_inputs.length);for(let l=0;l<this._node_inputs.length;l++)a.setInput(l,this._node_inputs[l])}}}_add_optimized_node_inputs(e,t,r,o,n){var s;let a=r[o],c=a.inputs;if(!!c){for(let l of c)if(K.isString(l)){let u=r[l];if(u)if(vs.is_node_optimized(u)&&!this._optimized_root_node_names.has(l)){let p=this._operation_containers_by_name.get(l);p||(p=this._createOperationContainer(e,t,u,l),p&&this._add_optimized_node_inputs(e,t,r,l,p)),n.addInput(p)}else{let p=(s=t.parent())==null?void 0:s.node(l);if(p){this._node_inputs.push(p);let h=this._node_inputs.length-1;t.addInputConfig(n,{operation_input_index:n.currentInputIndex(),node_input_index:h}),n.incrementInputIndex()}}}a.cloned_state_overriden==!0&&n.overrideInputCloneState(a.cloned_state_overriden)}}static child_names_by_optimized_state(e){let t=Object.keys(e),r=[],o=[];for(let n of t){let s=e[n];Q.playerMode()&&this.is_node_optimized(s)?r.push(n):o.push(n)}return{optimized_names:r,non_optimized_names:o}}static is_optimized_root_node_generic(e){return e.outputs_count==0||e.non_optimized_count>0}static is_optimized_root_node(e,t){let r=this.node_outputs(e,t),o=0;return r.forEach(n=>{let s=e[n];this.is_node_optimized(s)||o++}),this.is_optimized_root_node_generic({outputs_count:r.size,non_optimized_count:o})}static is_optimized_root_node_from_node(e){var t,r,o,n;if(!((r=(t=e.flags)==null?void 0:t.optimize)==null?void 0:r.active()))return!1;let s=e.io.connections.outputConnections().map(c=>c.node_dest),a=0;for(let c of s)((n=(o=c.flags)==null?void 0:o.optimize)==null?void 0:n.active())||a++;return this.is_optimized_root_node_generic({outputs_count:s.length,non_optimized_count:a})}static node_outputs(e,t){let r=Object.keys(e),o=new Set;for(let n of r)if(n!=t){let a=e[n].inputs;if(a)for(let c of a)K.isString(c)&&c==t&&o.add(n)}return o}_createOperationContainer(e,t,r,o){let n=Ni.non_spare_params_data_value(r.params),s=vs.operation_type(r),a={paramsInitValueOverrides:n},c=this._node.createOperationContainer(s,o,a);return c&&(this._operation_containers_by_name.set(o,c),c.pathParamResolveRequired()&&(t.addOperationContainerWithPathParamResolveRequired(c),e.add_operations_composer_node_with_path_param_resolve_required(t))),c}static operation_type(e){return vs.is_node_bypassed(e)?"null":e.type}static is_node_optimized(e){let t=e.flags;return!!(t&&t.optimize)}static is_node_bypassed(e){let t=e.flags;return!!(t&&t.bypass)}};var a8=class{static migrateNodeType(e,t){return e.childrenControllerContext()==oe.GL&&t=="substract"?"subtract":t}};var c8=class{constructor(e){this._node=e}process_data(e,t){var r;if(!t||!(this._node.childrenAllowed()&&this._node.childrenController))return;let{optimized_names:o,non_optimized_names:n}=vs.child_names_by_optimized_state(t),s=[];for(let c of n){let l=t[c],u=a8.migrateNodeType(this._node,l.type.toLowerCase()),h={paramsInitValueOverrides:Ni.non_spare_params_data_value(l.params),nodeName:c};try{let d=this._node.createNode(u,h);d&&s.push(d)}catch(d){console.error(`error importing node: cannot create with type ${u}`,d);let m=Fe.camelCase(u);try{let f=this._node.createNode(m,h);f&&s.push(f)}catch{let x=`${u}Network`;try{let _=this._node.createNode(x,h);_&&s.push(_)}catch(_){let g=`failed to create node with type '${u}', '${m}' or '${x}'`;e.report.addWarning(g),Q.warn(g,_)}}}}if(o.length>0){let c=new vs(this._node);if(c.process_data(e,t),this._node.childrenController.context==oe.SOP){let l=Object.keys(t),u;for(let p of l)((r=t[p].flags)==null?void 0:r.display)&&(u=p);if(u){let p=s.map(d=>d.name()),h=c.nodes();for(let d of h)p.push(d.name());if(!p.includes(u)){let f=`node '${`${this._node.path()}/${u}`}' with display flag has been optimized and does not exist in player mode`;console.error(f)}}}}let a=new Map;for(let c of s)if(t[c.name()]){let u=K0.dispatch_node(c);a.set(c.name(),u),u.process_data(e,t[c.name()])}else Q.warn(`possible import error for node ${c.name()}`),Q.log("available names are",Object.keys(t).sort(),t);for(let c of s){let l=a.get(c.name());l&&l.process_inputs_data(t[c.name()])}}};var oK=["overriden_options","type"],$h=class{constructor(e){this._node=e}process_data(e,t){if(this.set_connection_points(t.connection_points),this._node.childrenAllowed()&&this.create_nodes(e,t.nodes),this.set_selection(t.selection),this._node.io.inputs.overrideClonedStateAllowed()){let r=t.cloned_state_overriden;r&&this._node.io.inputs.overrideClonedState(r)}this.set_flags(t),this.set_params(t),t.persisted_config&&this.set_persisted_config(t.persisted_config),this.from_data_custom(t)}process_inputs_data(e){let t=e.maxInputsCount;if(t!=null){let r=this._node.io.inputs.minCount();this._node.io.inputs.setCount(r,t)}this.setInputs(e.inputs)}process_ui_data(e,t){if(!t||Q.playerMode())return;let r=this._node.uiData,o=t.pos;if(o){let s=new G().fromArray(o);r.setPosition(s)}let n=t.comment;n&&r.setComment(n),this._node.childrenAllowed()&&this.process_nodes_ui_data(e,t.nodes)}create_nodes(e,t){if(!t)return;new c8(this._node).process_data(e,t)}set_selection(e){if(this._node.childrenAllowed()&&this._node.childrenController&&e&&e.length>0){let t=[];e.forEach(r=>{let o=this._node.node(r);o&&t.push(o)}),this._node.childrenController.selection.set(t)}}set_flags(e){var t,r,o,n,s,a;let c=e.flags;if(c){let l=c.bypass;l!=null&&((r=(t=this._node.flags)==null?void 0:t.bypass)==null||r.set(l));let u=c.display;u!=null&&((n=(o=this._node.flags)==null?void 0:o.display)==null||n.set(u));let p=c.optimize;p!=null&&((a=(s=this._node.flags)==null?void 0:s.optimize)==null||a.set(p))}}set_connection_points(e){!e||(e.in&&this._node.io.saved_connection_points_data.set_in(e.in),e.out&&this._node.io.saved_connection_points_data.set_out(e.out),this._node.io.has_connection_points_controller&&this._node.io.connection_points.update_signature_if_required())}setInputs(e){if(!e)return;let t;for(let r=0;r<e.length;r++)if(t=e[r],t&&this._node.parent())if(K.isString(t)){let o=t,n=this._node.nodeSibling(o);this._node.setInput(r,n)}else{let o=this._node.nodeSibling(t.node),n=t.index;this._node.setInput(n,o,t.output)}}process_nodes_ui_data(e,t){if(!t||Q.playerMode())return;let r=Object.keys(t);for(let o of r){let n=this._node.node(o);if(n){let s=t[o];K0.dispatch_node(n).process_ui_data(e,s)}}}set_params(e){let t=e.params;if(!t)return;let r=Object.keys(t),o={};for(let a of r){let c=t[a];if(c!=null){let l=c.options,u=c.type;u=="operator_path"&&(u=J.NODE_PATH);let p=this._node.params.has_param(a),h=!1,d;p&&(d=this._node.params.get(a),(d&&d.type()==u||u==null)&&(h=!0)),h?this._is_param_data_complex(c)?this._process_param_data_complex(a,c):this._process_param_data_simple(a,c):(o.namesToDelete=o.namesToDelete||[],o.namesToDelete.push(a),o.toAdd=o.toAdd||[],o.toAdd.push({name:a,type:u,initValue:c.default_value,rawInput:c.raw_input,options:l}))}}let n=o.namesToDelete&&o.namesToDelete.length>0,s=o.toAdd&&o.toAdd.length>0;if(n||s){this._node.params.updateParams(o);for(let a of this._node.params.spare){let c=t[a.name()];!a.parentParam()&&c&&(this._is_param_data_complex(c)?this._process_param_data_complex(a.name(),c):this._process_param_data_simple(a.name(),c))}}this._node.params.runOnSceneLoadHooks()}_process_param_data_simple(e,t){var r;(r=this._node.params.get(e))==null||r.set(t)}_process_param_data_complex(e,t){let r=this._node.params.get(e);r&&K0.dispatch_param(r).process_data(t)}_is_param_data_complex(e){if(K.isString(e)||K.isNumber(e)||K.isArray(e)||K.isBoolean(e))return!1;if(K.isObject(e)){let t=Object.keys(e);for(let r of oK)if(t.includes(r))return!0}return!1}set_persisted_config(e){this._node.persisted_config&&this._node.persisted_config.load(e)}from_data_custom(e){}};var l8=class extends Ni{add_main(e){}};var iK=/\\n+/g,u8=class extends Ni{add_main(e){let t=e.raw_input;t!==void 0&&(t=t.replace(iK,`
`),this._param.set(t))}};var p8=class extends Ni{add_main(e){let t=e.raw_input;t&&this._param.set(t)}};var h8=class extends $h{create_nodes(e,t){let o=this._node.polyNodeController;o&&o.createChildNodesFromDefinition()}};var K0=class{static dispatch_node(e){return e.polyNodeController?new h8(e):new $h(e)}static dispatch_param(e){return e instanceof Nn?new l8(e):e instanceof Wh?new u8(e):e instanceof gs?new p8(e):new Ni(e)}};var d8=class{constructor(e){this._warnings=[]}warnings(){return this._warnings}reset(){this._warnings=[]}addWarning(e){this._warnings.push(e)}};var Kh=class{constructor(e){this._data=e,this.report=new d8(this)}static async loadData(e){return await new Kh(e).scene()}async scene(){let e=new s8;e.loadingController.markAsLoading();let t=this._data.properties;if(t){let o=t.maxFrame||600;e.timeController.setMaxFrame(o);let n=t.maxFrameLocked;n&&e.timeController.setMaxFrameLocked(n);let s=t.realtimeState;s!=null&&e.timeController.setRealtimeState(s),e.setFrame(t.frame||$s.START_FRAME),t.mainCameraNodePath&&e.camerasController.setMainCameraNodePath(t.mainCameraNodePath)}e.cooker.block(),this._base_operations_composer_nodes_with_resolve_required=void 0;let r=K0.dispatch_node(e.root());return this._data.root&&r.process_data(this,this._data.root),this._data.ui&&r.process_ui_data(this,this._data.ui),this._resolve_operation_containers_with_path_param_resolve(),await e.loadingController.markAsLoaded(),e.cooker.unblock(),e}add_operations_composer_node_with_path_param_resolve_required(e){this._base_operations_composer_nodes_with_resolve_required||(this._base_operations_composer_nodes_with_resolve_required=[]),this._base_operations_composer_nodes_with_resolve_required.push(e)}_resolve_operation_containers_with_path_param_resolve(){if(!!this._base_operations_composer_nodes_with_resolve_required)for(let e of this._base_operations_composer_nodes_with_resolve_required)e.resolveOperationContainersPathParams()}};var Jh=class{constructor(e){this.options=e,this._onLoadCompleteCalled=!1}static async loadSceneData(e){let t=new Jh(e),r=await t.loadScene(),o=t._viewer;return{scene:r,viewer:o}}async _onLoadComplete(){this._onLoadCompleteCalled!=!0&&(this._onLoadCompleteCalled=!0,this._viewer&&this._viewer.markAsReady(),this._scene&&(await this._scene.cookController.waitForCooksCompleted(),this._scene.setFrame($s.START_FRAME),this._scene.play()))}_onNodesCookProgress(e){let t=o=>{this.options.onProgress&&this.options.onProgress(r.start+r.mult*o)},r=lx.nodes;t(e),e>=1&&this._onLoadComplete()}async _watchNodesProgress(e){let t=await e.root().loadProgress.resolvedNodes(),r=t.length;r==0&&this._onNodesCookProgress(1);let o="ScenePlayerImporter",n=new Set;for(let s of t){let a=s.graphNodeId();s.compute(),s.cookController.registerOnCookEnd(o,()=>{if(!n.has(a)){n.add(a);let c=n.size/r;this._onNodesCookProgress(c),s.cookController.deregisterOnCookEnd(o)}})}}async loadScene(){let e=new Kh(this.options.sceneData);this._scene=await e.scene(),this._scene.setName(this.options.sceneName);let t=this.options.configureScene;t&&t(this._scene);let r=this._scene.mainCameraNode();return r?this._viewer=r.createViewer({element:this.options.domElement,viewerProperties:{autoRender:!1}}):console.warn("no main camera found, viewer is not mounted"),this._watchNodesProgress(this._scene),this._scene}};function HM(i){}var rt=class{constructor(e){this.param=e,this._requireDependency=!1}requireDependency(){return this._requireDependency}node(){return this._node=this._node||this.param.node}static requiredArguments(){return console.warn("Expression.Method._Base.required_arguments virtual method call. Please override"),[]}static optionalArguments(){return[]}static minAllowedArgumentsCount(){return this.requiredArguments().length}static maxAllowedArgumentsCount(){return this.minAllowedArgumentsCount()+this.optionalArguments().length}static allowedArgumentsCount(e){return e>=this.minAllowedArgumentsCount()&&e<=this.maxAllowedArgumentsCount()}processArguments(e){throw"Expression.Method._Base.process_arguments virtual method call. Please override"}async getReferencedNodeContainer(e){let t=this.getReferencedNode(e);if(t){let r;if(t.isDirty()?r=await t.compute():r=t.containerController.container(),r&&r.coreContent())return r;throw`referenced node invalid: ${t.path()}`}else throw`invalid input (${e})`}getReferencedParam(e,t){let r=this.node();return r?ct.findParam(r,e,t):null}findReferencedGraphNode(e,t){if(K.isNumber(e)){let o=e,n=this.node();if(n)return n.io.inputs.inputGraphNode(o)}else{let o=e;return this.getReferencedNode(o,t)}return null}getReferencedNode(e,t){let r=null,o=this.node();if(K.isString(e)){if(o){let n=e;r=ct.findNode(o,n,t)}}else if(o){let n=e;r=o.io.inputs.input(n)}return r||null}findDependency(e){return null}createDependencyFromIndexOrPath(e){let t=new _c,r=this.findReferencedGraphNode(e,t);return r?this.createDependency(r,e,t):(Q.warn("node not found for path",e),null)}createDependency(e,t,r){return hc.create(this.param,t,e,r)}};var f8=class extends rt{constructor(){super(...arguments);this._requireDependency=!0}static requiredArguments(){return[["string","arguments list"],["number","index"]]}processArguments(e){return new Promise((t,r)=>{if(e.length==2){let o=e[0],n=e[1],s=o.split(" ")[n];t(s)}else t(0)})}};var m8=class extends rt{constructor(){super(...arguments);this._requireDependency=!0}static requiredArguments(){return[["string","arguments list"]]}processArguments(e){return new Promise((t,r)=>{if(e.length==1){let n=e[0].split(" ").length;t(n)}else t(0)})}};var nK=["min","max","size","center"],sK=["x","y","z"],_8=class extends rt{constructor(){super(...arguments);this._requireDependency=!0}static requiredArguments(){return[["string","path to node"],["string","vector name, min, max, size or center"],["string","component_name, x,y or z"]]}findDependency(e){return this.createDependencyFromIndexOrPath(e)}processArguments(e){let t=0;return new Promise(async(r,o)=>{if(e.length>=1){let n=e[0],s=e[1],a=e[2],c=null;try{c=await this.getReferencedNodeContainer(n)}catch(l){o(l)}c&&(t=this._get_value_from_container(c,s,a),r(t))}else r(0)})}_get_value_from_container(e,t,r){let o=e.boundingBox();if(!t)return o;if(nK.indexOf(t)>=0){let n=new w;switch(t){case"size":o.getSize(n);break;case"center":o.getCenter(n);break;default:n=o[t]}return r?sK.indexOf(r)>=0?n[r]:-1:n}else return-1}};var g8=class extends rt{constructor(){super(...arguments);this._requireDependency=!0}static requiredArguments(){return[["string","path to node"],["string","component_name, x,y or z"]]}findDependency(e){return this.createDependencyFromIndexOrPath(e)}processArguments(e){return new Promise(async(t,r)=>{if(e.length>=1){let o=e[0],n=e[1],s=null;try{s=await this.getReferencedNodeContainer(o)}catch(a){r(a)}if(s){let a=s.boundingBox(),c=a.min.clone().add(a.max).multiplyScalar(.5);if(n){let l=c[n];l!=null?t(l):t(0)}else t(c)}}else t(0)})}};var v8=class extends rt{constructor(){super(...arguments);this._requireDependency=!0}static requiredArguments(){return[["string","path to param"]]}findDependency(e){let t=new _c,r=this.getReferencedParam(e,t);return r?(this._referencedParam=r,this.createDependency(r,e,t)):null}async processArguments(e){return new Promise(async(t,r)=>{let o=0;if(e.length==1){let n=e[0],s=this._referencedParam||this.getReferencedParam(n);if(s){s.isDirty()&&await s.compute();let a=s.value;a!=null&&(o=a,t(o))}else r(0)}})}};var Oi=class{constructor(){this._objects=[],this._objects_with_geo=[],this.touch()}dispose(){if(this._objects=[],this._objects_with_geo=[],this._core_objects){for(let e of this._core_objects)e.dispose();this._core_objects=void 0}if(this._core_geometries){for(let e of this._core_geometries)e.dispose();this._core_geometries=void 0}}timestamp(){return this._timestamp}touch(){let e=Q.performance.performanceManager();this._timestamp=e.now(),this.reset()}reset(){this._bounding_box=void 0,this._core_geometries=void 0,this._core_objects=void 0}clone(){let e=new Oi;if(this._objects){let t=[];for(let r of this._objects)t.push(Or.clone(r));e.setObjects(t)}return e}setObjects(e){this._objects=e,this._objects_with_geo=e.filter(t=>t.geometry!=null),this.touch()}objects(){return this._objects}objectsWithGeo(){return this._objects_with_geo}coreObjects(){return this._core_objects=this._core_objects||this._create_core_objects()}_create_core_objects(){return this._objects?this._objects.map((e,t)=>new Or(e,t)):[]}objectsData(){return this._objects?this._objects.map(e=>this._objectData(e)):[]}_objectData(e){let t=0;return e.geometry&&(t=Ut.pointsCount(e.geometry)),{type:Zi(e.constructor),name:e.name,children_count:e.children.length,points_count:t}}geometries(){let e=[];for(let t of this.coreObjects()){let r=t.object().geometry;r&&e.push(r)}return e}coreGeometries(){return this._core_geometries=this._core_geometries||this._createCoreGeometries()}_createCoreGeometries(){let e=[];for(let t of this.geometries())e.push(new Ut(t));return e}static geometryFromObject(e){return e.isMesh||e.isLine||e.isPoints?e.geometry:null}faces(){let e=[];for(let t of this.objectsWithGeo())if(t.geometry){let o=new Ut(t.geometry).faces();for(let n of o)n.applyMatrix4(t.matrix),e.push(n)}return e}points(){return this.coreGeometries().map(e=>e.points()).flat()}pointsCount(){return $e.sum(this.coreGeometries().map(e=>e.pointsCount()))}totalPointsCount(){if(this._objects){let e=0;for(let t of this._objects)t.traverse(r=>{let o=r.geometry;o&&(e+=Ut.pointsCount(o))});return e}else return 0}pointsFromGroup(e){if(e){let t=Fe.indices(e),r=this.points();return $e.compact(t.map(o=>r[o]))}else return this.points()}static _fromObjects(e){let t=new Oi;return t.setObjects(e),t}objectsFromGroup(e){return this.coreObjectsFromGroup(e).map(t=>t.object())}coreObjectsFromGroup(e){if(e=e.trim(),e!==""){let t=parseInt(e);return K.isNaN(t)?this.coreObjects().filter(r=>Fe.matchMask(e,r.name())):$e.compact([this.coreObjects()[t]])}else return this.coreObjects()}boundingBox(e=!1){return e?this._bounding_box=this._computeBoundingBox():this._bounding_box=this._bounding_box||this._computeBoundingBox()}center(){let e=new w;return this.boundingBox().getCenter(e),e}size(){let e=new w;return this.boundingBox().getSize(e),e}_computeBoundingBox(){let e;if(this._objects)for(let t of this._objects){let r=t.geometry;r&&(r.computeBoundingBox(),e?e.expandByObject(t):r.boundingBox&&(e=r.boundingBox.clone()))}return e=e||new Bl(new w(-1,-1,-1),new w(1,1,1)),e}computeVertexNormals(){for(let e of this.coreObjects())e.computeVertexNormals()}hasAttrib(e){let t;return(t=this.coreGeometries()[0])!=null?t.hasAttrib(e):!1}attribType(e){let t=this.coreGeometries()[0];return t!=null?t.attribType(e):null}objectAttribType(e){let t=this.coreObjects()[0];return t!=null?t.attribType(e):null}renameAttrib(e,t,r){switch(r){case lc.ATTRIB_CLASS.VERTEX:if(this.hasAttrib(e)&&this._objects)for(let o of this._objects)o.traverse(n=>{let s=Oi.geometryFromObject(n);s&&new Ut(s).renameAttrib(e,t)});break;case lc.ATTRIB_CLASS.OBJECT:if(this.hasAttrib(e)&&this._objects)for(let o of this._objects)o.traverse(n=>{new Or(n,0).renameAttrib(e,t)});break}}attribNames(){let e;return(e=this.coreGeometries()[0])!=null?e.attribNames():[]}objectAttribNames(){let e;return(e=this.coreObjects()[0])!=null?e.attribNames():[]}attribNamesMatchingMask(e){let t=Fe.attribNames(e),r=[];for(let o of this.attribNames())for(let n of t)if(Fe.matchMask(o,n))r.push(o);else{let s=wt.remapName(n);o==s&&r.push(o)}return $e.uniq(r)}attribSizes(){let e;return(e=this.coreGeometries()[0])!=null?e.attribSizes():{}}objectAttribSizes(){let e;return(e=this.coreObjects()[0])!=null?e.attribSizes():{}}attribSize(e){let t;return(t=this.coreGeometries()[0])!=null?t.attribSize(e):0}addNumericVertexAttrib(e,t,r){r==null&&(r=wt.default_value(t));for(let o of this.coreGeometries())o.addNumericAttrib(e,t,r)}static clone(e){let t=new ut;return e.children.forEach(r=>{let o=Or.clone(r);t.add(o)}),t}};var Qe=class extends Yh{static context(){return oe.SOP}cook(e,t){}createCoreGroupFromObjects(e){let t=new Oi;return t.setObjects(e),t}createCoreGroupFromGeometry(e,t=$t.MESH){let r=Qe.createObject(e,t);return this.createCoreGroupFromObjects([r])}createObject(e,t,r){return Qe.createObject(e,t,r)}static createObject(e,t,r){this.createIndexIfNone(e);let o=$w[t];r=r||lc.MATERIALS[t].clone();let n=new o(e,r);return n.castShadow=!0,n.receiveShadow=!0,n.frustumCulled=!1,n.matrixAutoUpdate=!1,n}createIndexIfNone(e){Qe.createIndexIfNone(e)}static createIndexIfNone(e){Lh.createIndexIfNone(e)}};var G1="input geometry",aK=[G1,G1,G1,G1],et=class extends dr{constructor(){super(...arguments);this.flags=new x4(this)}static context(){return oe.SOP}static displayedInputNames(){return aK}initializeBaseNode(){this.flags.display.set(!1),this.flags.display.onUpdate(()=>{if(this.flags.display.active()){let e=this.parent();e&&e.displayNodeController&&e.displayNodeController.setDisplayNode(this)}}),this.io.outputs.setHasOneOutput()}setCoreGroup(e){this._setContainer(e,"from set_core_group")}setObject(e){this._setContainerObjects([e],"from set_object")}setObjects(e){this._setContainerObjects(e,"from set_objects")}setGeometry(e,t=$t.MESH){let r=this.createObject(e,t);this._setContainerObjects([r],"from set_geometry")}setGeometries(e,t=$t.MESH){let r=[],o;for(let n of e)o=this.createObject(n,t),r.push(o);this._setContainerObjects(r,"from set_geometries")}_setContainerObjects(e,t){let r=this.containerController.container().coreContent()||new Oi;r.setObjects(e),r.touch(),this._setContainer(r)}static createObject(e,t,r){return Qe.createObject(e,t,r)}createObject(e,t,r){return et.createObject(e,t,r)}static createIndexIfNone(e){Qe.createIndexIfNone(e)}_createIndexIfNone(e){et.createIndexIfNone(e)}};var Au=class extends De{constructor(){super();this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}clone(){return new this.constructor().copy(this)}toJSON(){let e=super.toJSON(this);return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}};Au.prototype.isInstancedBufferGeometry=!0;var Xr=class extends Ot{constructor(e,t,r,o=1){typeof r=="number"&&(o=r,r=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument."));super(e,t,r);this.meshPerAttribute=o}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){let e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}};Xr.prototype.isInstancedBufferAttribute=!0;var z1={SCALE:new w(1,1,1),PSCALE:1,EYE:new w(0,0,0),UP:new w(0,1,0)},cK="scale",lK="pscale",uK="normal",pK="up",hK=new w(1,1,1),dK=new G(0,0),jM="uv",WM="color";var fK={P:"instancePosition",N:"instanceOrientation",up:"instanceOrientation",Cd:"instanceColor",[mr.COLOR]:"instanceColor",[mr.NORMAL]:"instanceOrientation",[mr.POSITION]:"instancePosition",[mr.PSCALE]:"instanceScale",[mr.SCALE]:"instanceScale"},qM=class{constructor(i){this._coreGroup=i,this._is_pscale_present=!1,this._is_scale_present=!1,this._is_normal_present=!1,this._is_up_present=!1,this._do_rotate_matrices=!1,this._matrixT=new Ve,this._matrixR=new Ve,this._matrixS=new Ve,this._pointScale=new w,this._pointNormal=new w,this._pointUp=new w,i&&this.setCoreGroup(i)}static remapName(i){return fK[i]||i}setCoreGroup(i){this._coreGroup=i,this._is_pscale_present=this._coreGroup.hasAttrib(mr.PSCALE),this._is_scale_present=this._coreGroup.hasAttrib(mr.SCALE),this._is_normal_present=this._coreGroup.hasAttrib(mr.NORMAL),this._is_up_present=this._coreGroup.hasAttrib(mr.UP),this._do_rotate_matrices=this._is_normal_present}matrixFromPoint(i,e){e.identity();let t=i.position();this._is_scale_present?i.attribValue(cK,this._pointScale):this._pointScale.copy(z1.SCALE);let r=this._is_pscale_present?i.attribValue(lK):z1.PSCALE;this._pointScale.multiplyScalar(r);let o=this._matrixS;o.makeScale(this._pointScale.x,this._pointScale.y,this._pointScale.z);let n=this._matrixT;if(n.makeTranslation(t.x,t.y,t.z),e.multiply(n),this._do_rotate_matrices){let s=this._matrixR,a=z1.EYE;i.attribValue(uK,this._pointNormal),this._pointNormal.multiplyScalar(-1),this._is_up_present?i.attribValue(pK,this._pointUp):this._pointUp.copy(z1.UP),this._pointUp.normalize(),s.lookAt(a,this._pointNormal,this._pointUp),e.multiply(s)}e.multiply(o)}static updateTransformInstanceAttributes(i,e,t){let r=i.length,o=new Float32Array(r*3),n=new Float32Array(r*3),s=new Float32Array(r*4),a=new qM(e),c=0;for(let l of i){a.matrixFromPoint(l,this._tmpMatrix);let u=c*3,p=c*4;this._tmpMatrix.decompose(this._position,this._quaternion,this._scale),this._position.toArray(o,u),this._quaternion.toArray(s,p),this._scale.toArray(n,u),c++}t.setAttribute("instancePosition",new Xr(o,3)),t.setAttribute("instanceScale",new Xr(n,3)),t.setAttribute("instanceOrientation",new Xr(s,4))}static updateColorInstanceAttribute(i,e,t){let r=i.length,o=new Float32Array(r*3),n=e.hasAttrib(WM),s=0;for(let a of i)(n?a.attribValue(WM,this._point_color):hK).toArray(o,s*3),s++;t.setAttribute("instanceColor",new Xr(o,3))}static createInstanceBufferGeometry(i,e,t){let r=e.points(),o=new Au;o.copy(i),o.instanceCount=1/0;let n=r.length,s=e.hasAttrib(jM);if(s){let l=new Float32Array(n*2),u=0;for(let p of r){let h=u*2;(s?p.attribValue(jM,this._point_uv):dK).toArray(l,h),u++}o.setAttribute("instanceUv",new Xr(l,2))}return this.updateTransformInstanceAttributes(r,e,o),this.updateColorInstanceAttribute(r,e,o),e.attribNamesMatchingMask(t).forEach(l=>{let u=e.attribSize(l),p=new Float32Array(n*u);r.forEach((h,d)=>{let m=h.attribValue(l);K.isNumber(m)?p[d]=m:m.toArray(p,d*u)}),o.setAttribute(l,new Xr(p,u))}),new Ut(o).markAsInstance(),o}},Pn=qM;Pn.transformAttributeNames=["instancePosition","instanceOrientation","instanceScale"];Pn._point_color=new w;Pn._point_uv=new G;Pn._position=new w(0,0,0);Pn._quaternion=new Nt;Pn._scale=new w(1,1,1);Pn._tmpMatrix=new Ve;var x8=class extends Yt{constructor(e){super(e,"CopyStamp");this._globalIndex=0}reset(){this.setGlobalIndex(0)}setGlobalIndex(e){let t=this._globalIndex;this._globalIndex=e,t!=this._globalIndex&&(this.setDirty(),this.removeDirtyState())}value(e){return this._globalIndex}};var y8=class extends x8{reset(){super.reset(),this.setPoint(void 0)}setPoint(e){let t=this._point;this._point=e,t!=this._point&&(this.setDirty(),this.removeDirtyState())}value(e){return this._point?e?this._point.attribValue(e):this._point.index():this._globalIndex}};var e0=(i=>(i.OBJECTS="objects",i.GEOMETRIES="geometries",i))(e0||{}),t0=["geometries","objects"],vc=(i=>(i.XYZ="XYZ",i.XZY="XZY",i.YXZ="YXZ",i.YZX="YZX",i.ZYX="ZYX",i.ZXY="ZXY",i))(vc||{}),xs=["XYZ","XZY","YXZ","YZX","ZXY","ZYX"];var Xt=class{constructor(){this._translation_matrix=new Ve,this._translation_matrix_q=new Nt,this._translation_matrix_s=new w(1,1,1),this._matrix=new Ve().identity(),this._matrix_q=new Nt,this._matrix_euler=new o3,this._matrix_s=new w,this._m=new Ve,this._q=new Nt,this._rotateDirOrigin=new w,this._rotateDirDest=new w}static setParamsFromMatrix(e,t,r={}){let o=r.scale;o==null&&(o=!0),e.decompose(this.set_params_from_matrix_position,this.set_params_from_matrix_quaternion,this.set_params_from_matrix_scale),this.set_params_from_matrix_euler.setFromQuaternion(this.set_params_from_matrix_quaternion),this.set_params_from_matrix_euler.toVector3(this.set_params_from_matrix_rotation),this.set_params_from_matrix_rotation.divideScalar(Math.PI/180),this.set_params_from_matrix_position.toArray(this.set_params_from_matrix_t),this.set_params_from_matrix_rotation.toArray(this.set_params_from_matrix_r),this.set_params_from_matrix_scale.toArray(this.set_params_from_matrix_s),t.scene().batchUpdates(()=>{t.params.set_vector3("t",this.set_params_from_matrix_t),t.params.set_vector3("r",this.set_params_from_matrix_r),t.params.set_vector3("s",this.set_params_from_matrix_s),o&&t.params.set_float("scale",1)})}static setParamsFromObject(e,t){e.position.toArray(this.set_params_from_object_position_array),e.rotation.toArray(this.set_params_from_object_rotation_array),this.set_params_from_object_rotation_deg.fromArray(this.set_params_from_object_rotation_array),this.set_params_from_object_rotation_deg.multiplyScalar(180/Math.PI),this.set_params_from_object_rotation_deg.toArray(this.set_params_from_object_rotation_array),t.scene().batchUpdates(()=>{t.params.set_vector3("t",this.set_params_from_object_position_array),t.params.set_vector3("r",this.set_params_from_object_rotation_array)})}translationMatrix(e){return this._translation_matrix.compose(e,this._translation_matrix_q,this._translation_matrix_s),this._translation_matrix}matrix(e,t,r,o,n){return this._matrix_euler.set(yi(t.x),yi(t.y),yi(t.z),n),this._matrix_q.setFromEuler(this._matrix_euler),this._matrix_s.copy(r).multiplyScalar(o),this._matrix.compose(e,this._matrix_q,this._matrix_s),this._matrix}rotateGeometry(e,t,r){this._rotateDirDest.copy(r).normalize(),this._rotateDirOrigin.copy(t).normalize(),this._q.setFromUnitVectors(this._rotateDirOrigin,this._rotateDirDest),this._m.makeRotationFromQuaternion(this._q),e.applyMatrix4(this._m)}rotateObject(e,t,r){this._rotateDirDest.copy(r).normalize(),this._rotateDirOrigin.copy(t).normalize(),this._q.setFromUnitVectors(this._rotateDirOrigin,this._rotateDirDest),this._m.makeRotationFromQuaternion(this._q),e.matrix.multiply(this._m),e.matrix.decompose(e.position,e.quaternion,e.scale)}static decomposeMatrix(e){e.matrix.decompose(e.position,e.quaternion,e.scale)}};Xt.set_params_from_matrix_position=new w;Xt.set_params_from_matrix_quaternion=new Nt;Xt.set_params_from_matrix_scale=new w;Xt.set_params_from_matrix_euler=new o3;Xt.set_params_from_matrix_rotation=new w;Xt.set_params_from_matrix_t=[0,0,0];Xt.set_params_from_matrix_r=[0,0,0];Xt.set_params_from_matrix_s=[0,0,0];Xt.set_params_from_object_position_array=[0,0,0];Xt.set_params_from_object_rotation_deg=new w;Xt.set_params_from_object_rotation_array=[0,0,0];var mK=[0,1],_K=[{name:"object",value:0},{name:"geometry",value:1}],XM=class extends V{constructor(){super(...arguments);this.count=v.INTEGER(1,{range:[1,20],rangeLocked:[!0,!1]}),this.t=v.VECTOR3([0,0,0]),this.r=v.VECTOR3([0,0,0]),this.s=v.VECTOR3([1,1,1]),this.scale=v.FLOAT(1),this.transformOnly=v.BOOLEAN(0),this.transformMode=v.INTEGER(0,{menu:{entries:_K}}),this.copyAttributes=v.BOOLEAN(0),this.attributesToCopy=v.STRING("",{visibleIf:{copyAttributes:!0}}),this.useCopyExpr=v.BOOLEAN(1)}},gK=new XM,b8=class extends et{constructor(){super(...arguments);this.paramsConfig=gK,this._attribNamesToCopy=[],this._objects=[],this._instancer=new Pn,this._instanceMatrix=new Ve,this._coreTransform=new Xt,this._transformAccumulatedMatrix=new Ve,this._transformMatrix=new Ve}static type(){return"copy"}static displayedInputNames(){return["geometry to be copied","points to copy to"]}initializeNode(){this.io.inputs.setCount(1,2),this.io.inputs.initInputsClonedState([Ge.FROM_NODE,Ge.NEVER])}async cook(e){this.pv.useCopyExpr||this.stampNode().reset();let t=e[0];if(!this.io.inputs.hasInput(1)){await this.cookWithoutTemplate(t);return}let r=e[1];if(!r){this.states.error.set("second input invalid");return}await this.cookWithTemplate(t,r)}async cookWithTemplate(e,t){this._objects=[];let r=t.points();this._instancer.setCoreGroup(t),this._attribNamesToCopy=Fe.attribNames(this.pv.attributesToCopy).map(o=>wt.remapName(o)),this._attribNamesToCopy=this._attribNamesToCopy.filter(o=>t.hasAttrib(o)),await this._copyMovedObjectsOnTemplatePoints(e,r),this.setObjects(this._objects)}async _copyMovedObjectsOnTemplatePoints(e,t){this._initAccumulatedTransform();for(let r=0;r<t.length;r++)await this._copyMovedObjectOnTemplatePoint(e,t,r),this._accumulateTransform()}async _copyMovedObjectOnTemplatePoint(e,t,r){this._instancer.matrixFromPoint(t[r],this._instanceMatrix);let o=t[r];this.pv.useCopyExpr&&this.stampNode().setPoint(o);let n=await this._getMovedObjectsForTemplatePoint(e,r);for(let s of n)this.pv.copyAttributes&&this._copyAttributes_from_template(s,o),this.pv.transformOnly?s.applyMatrix4(this._instanceMatrix):this._applyMatrixToObjectOrGeometry(s,this._instanceMatrix),this._applyAccumulatedTransform(s),this._objects.push(s)}async _getMovedObjectsForTemplatePoint(e,t){let r=await this._stampInstanceGroupIfRequired(e);if(r){let o=()=>{let s=r.objects()[t];return s?[s.clone()]:[]};return this.pv.transformOnly?o():r.clone().objects()}else return[]}async _stampInstanceGroupIfRequired(e){let t=await this.containerController.requestInputContainer(0);if(t){let r=t.coreContent();return r||void 0}else{this.states.error.set(`input failed for index ${this.stampValue()}`);return}}async _copyMovedObjectsForEachInstance(e){this._initAccumulatedTransform();for(let t=0;t<this.pv.count;t++)await this._copyMovedObjectsForInstance(e,t),this._accumulateTransform()}async _copyMovedObjectsForInstance(e,t){this.pv.useCopyExpr&&this.stampNode().setGlobalIndex(t);let r=await this._stampInstanceGroupIfRequired(e);r&&r.objects().forEach(o=>{let n=Or.clone(o);this._applyAccumulatedTransform(n),this._objects.push(n)})}async cookWithoutTemplate(e){this._objects=[],await this._copyMovedObjectsForEachInstance(e),this.setObjects(this._objects)}_copyAttributes_from_template(e,t){this._attribNamesToCopy.forEach((r,o)=>{let n=t.attribValue(r);new Or(e,o).addAttribute(r,n)})}stampValue(e){return this.stampNode().value(e)}stampNode(){return this._stampNode=this._stampNode||this._createStampNode()}_createStampNode(){let e=new y8(this.scene());return this.dirtyController.setForbiddenTriggerNodes([e]),e}dispose(){super.dispose(),this._stampNode&&this._stampNode.dispose()}_initAccumulatedTransform(){let e=this.pv;this._transformMatrix=this._coreTransform.matrix(e.t,e.r,e.s,e.scale,vc.XYZ),this._transformAccumulatedMatrix.identity()}_accumulateTransform(){this._transformAccumulatedMatrix.multiply(this._transformMatrix)}_applyAccumulatedTransform(e){this._applyMatrixToObjectOrGeometry(e,this._transformAccumulatedMatrix)}_applyMatrixToObjectOrGeometry(e,t){let r=mK[this.pv.transformMode];switch(r){case 0:{this._applyMatrixToObject(e,t);return}case 1:{let o=e.geometry;o&&o.applyMatrix4(t);return}}Be.unreachable(r)}_applyMatrixToObject(e,t){e.matrix.multiply(t),e.matrix.decompose(e.position,e.quaternion,e.scale)}};var T8=class extends rt{constructor(){super(...arguments);this._requireDependency=!0}static requiredArguments(){return[["string","path to copy"],["integer","default value"]]}static optionalArguments(){return[["string","attribute name (optional)"]]}findDependency(e){let t=this.findReferencedGraphNode(e);if(t&&t.type()=="copy"){let r=t.stampNode();return this.createDependency(r,e)}return null}processArguments(e){return new Promise((t,r)=>{if(e.length>=1){let o=e[0],n=e[1]||0,s=e[2],a=this.node(),c=a?ct.findNode(a,o):null,l;c&&c.type()==b8.type()&&(l=c.stampValue(s)),l==null&&(l=n),t(l)}else t(0)})}};var A8=class extends rt{constructor(){super(...arguments);this._requireDependency=!0,this._resolution=new G}static requiredArguments(){return[["string","path to node"],["string","component_name: x or y"]]}findDependency(e){return this.createDependencyFromIndexOrPath(e)}async processArguments(e){if(e.length==1||e.length==2){let t=e[0],r=e[1],o=await this.getReferencedNodeContainer(t);if(o){let n=o.resolution();if(r){if([0,"0","x"].includes(r))return n[0];if([1,"1","y"].includes(r))return n[1]}else return this._resolution.set(n[0],n[1]),this._resolution}}return-1}};var Pi=class{static isChrome(){return navigator&&navigator.userAgent!=null&&navigator.userAgent.indexOf("Chrome")!=-1}static isMobile(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}static isiOS(){return/(iPad|iPhone|iPod)/g.test(navigator.userAgent)}static isAndroid(){return/(Android)/g.test(navigator.userAgent)}static isTouchDevice(){var e=document.createElement("div");return e.setAttribute("ongesturestart","return;"),typeof e.ongesturestart=="function"}};var C8=class extends rt{constructor(){super(...arguments);this._requireDependency=!0}static requiredArguments(){return[]}async processArguments(e){return new Promise(async(t,r)=>{t(Pi.isMobile())})}};var E8=class extends rt{constructor(){super(...arguments);this._requireDependency=!0}static requiredArguments(){return[]}async processArguments(e){return new Promise(async(t,r)=>{t(Pi.isTouchDevice())})}};var S8=class extends rt{static requiredArguments(){return[["string","javascript expression"]]}async processArguments(e){let t=0;if(e.length==1){let r=e[0];if(this._function=this._function||this._create_function(r),this._function)try{t=this._function(this.param.scene(),this.param.node,this.param)}catch(o){console.warn("expression error"),console.warn(o)}}return t}_create_function(e){return new Function("scene","node","param",`return ${e}`)}};var YM=3,w8=class extends rt{constructor(){super(...arguments);this._requireDependency=!0}static requiredArguments(){return[["string","path to node"],["string","attribute name"],["index","object index"]]}findDependency(e){return this.createDependencyFromIndexOrPath(e)}processArguments(e){return new Promise(async(t,r)=>{if(e.length==YM){let o=e[0],n=e[1],s=e[2],a=null;try{a=await this.getReferencedNodeContainer(o)}catch(c){r(c)}if(a){let c=this._get_value_from_container(a,n,s);t(c)}}else console.warn(`${e.length} given when expected ${YM}`),t(0)})}_get_value_from_container(e,t,r){let o=e.coreContent();if(o){let n=o.coreObjects()[r];return n?n.attribValue(t):0}else return null}};var M8=class extends rt{constructor(){super(...arguments);this._requireDependency=!0}static requiredArguments(){return[["string","path to node"]]}findDependency(e){return this.createDependencyFromIndexOrPath(e)}processArguments(e){return new Promise(async(t,r)=>{if(e.length==1){let o=e[0],n;try{n=await this.getReferencedNodeContainer(o)}catch(s){r(s);return}if(n){let s=n.objectsCount();t(s)}}else t(0)})}};var N8=class extends rt{constructor(){super(...arguments);this._requireDependency=!0}static requiredArguments(){return[["string","path to node"]]}findDependency(e){let t=this.findReferencedGraphNode(e);if(t){let r=t;if(r.nameController){let o=r.nameController.graph_node;return this.createDependency(o,e)}}return null}processArguments(e){return new Promise((t,r)=>{if(e.length==1){let o=e[0],n=this.getReferencedNode(o);if(n){let s=n.name(),a=Fe.tailDigits(s);t(a)}else t(0)}else t(0)})}};var O8=class extends rt{constructor(){super(...arguments);this._requireDependency=!0}static requiredArguments(){return[["string","path to node"]]}findDependency(e){let t=this.findReferencedGraphNode(e);if(t){let r=t;if(r.nameController){let o=r.nameController.graph_node;return this.createDependency(o,e)}}return null}processArguments(e){return new Promise((t,r)=>{if(e.length==1){let o=e[0],n=this.getReferencedNode(o);if(n){let s=n.name();t(s)}else t(0)}else t(0)})}};var P8=class extends rt{static requiredArguments(){return[["string","number"]]}processArguments(e){return new Promise(t=>{let r=e[0]||2,s=`${e[1]||0}`.padStart(r,"0");t(s)})}};var $M=3,R8=class extends rt{constructor(){super(...arguments);this._requireDependency=!0}static requiredArguments(){return[["string","path to node"],["string","attribute name"],["index","point index"]]}findDependency(e){return this.createDependencyFromIndexOrPath(e)}processArguments(e){return new Promise(async(t,r)=>{if(e.length==$M){let o=e[0],n=e[1],s=e[2],a=null;try{a=await this.getReferencedNodeContainer(o)}catch(c){r(c)}if(a){let c=this._get_value_from_container(a,n,s);t(c)}}else console.warn(`${e.length} given when expected ${$M}`),t(0)})}_get_value_from_container(e,t,r){let o=e.coreContent();if(o){let n=o.points()[r];return n?n.attribValue(t):0}else return null}};var L8=class extends rt{constructor(){super(...arguments);this._requireDependency=!0}static requiredArguments(){return[["string","path to node"]]}findDependency(e){return this.createDependencyFromIndexOrPath(e)}processArguments(e){return new Promise(async(t,r)=>{if(e.length==1){let o=e[0],n;try{n=await this.getReferencedNodeContainer(o)}catch(s){r(s);return}if(n){let s=n.pointsCount();t(s)}}else t(0)})}};var I8=class extends rt{static requiredArguments(){return[["string","string to count characters of"]]}async processArguments(e){let t=0;return e.length==1&&(t=e[0].length),t}};var D8=class extends rt{static requiredArguments(){return[]}async processArguments(e){let t="";for(let r of e)r==null&&(r=""),t+=`${r}`;return t}};var k8=class extends rt{static requiredArguments(){return[["string","string to get index from"],["string","char to find index of"]]}async processArguments(e){let t=-1;if(e.length==2){let r=e[0],o=e[1];t=r.indexOf(o)}return t}};function vK(i){return i==null?"":K.isString(i)?i:`${i}`}function KM(i,e){return i==null?e:K.isNumber(i)?i:parseInt(i)}var B8=class extends rt{static requiredArguments(){return[["string","string to get range from"],["integer","range start"],["integer","range size"]]}async processArguments(e){let t="",r=vK(e[0]),o=KM(e[1],0),n=KM(e[2],1);return r&&(t=r.substring(o,o+n)),t}};var F8=class extends rt{constructor(){super(...arguments);this._requireDependency=!0,this._windowSize=new G}static requiredArguments(){return[[]]}findDependency(e){return this.param.addGraphInput(this.param.scene().windowController.graphNode()),null}processArguments(e){return new Promise(t=>{this._windowSize.set(window.innerWidth,window.innerHeight),t(this._windowSize)})}};var U8=class{static run(e){e.expressionsRegister.register(f8,"arg"),e.expressionsRegister.register(m8,"argc"),e.expressionsRegister.register(_8,"bbox"),e.expressionsRegister.register(g8,"centroid"),e.expressionsRegister.register(v8,"ch"),e.expressionsRegister.register(T8,"copy"),e.expressionsRegister.register(A8,"copRes"),e.expressionsRegister.register(C8,"isDeviceMobile"),e.expressionsRegister.register(E8,"isDeviceTouch"),e.expressionsRegister.register(S8,"js"),e.expressionsRegister.register(w8,"object"),e.expressionsRegister.register(M8,"objectsCount"),e.expressionsRegister.register(N8,"opdigits"),e.expressionsRegister.register(O8,"opname"),e.expressionsRegister.register(P8,"padzero"),e.expressionsRegister.register(R8,"point"),e.expressionsRegister.register(L8,"pointsCount"),e.expressionsRegister.register(I8,"strCharsCount"),e.expressionsRegister.register(D8,"strConcat"),e.expressionsRegister.register(k8,"strIndex"),e.expressionsRegister.register(B8,"strSub"),e.expressionsRegister.register(F8,"windowSize")}};var H1="input animation clip",xK=[H1,H1,H1,H1],go=class extends dr{constructor(){super(...arguments);this.flags=new wh(this)}static context(){return oe.ANIM}static displayedInputNames(){return xK}initializeBaseNode(){this.io.outputs.setHasOneOutput()}setTimelineBuilder(e){this._setContainer(e)}};var Cu=(i=>(i.NONE="none",i.POWER1="power1",i.POWER2="power2",i.POWER3="power3",i.POWER4="power4",i.BACK="back",i.ELASTIC="elastic",i.BOUNCE="bounce",i.SLOW="slow",i.STEPS="steps",i.CIRC="circ",i.EXPO="expo",i.SINE="sine",i))(Cu||{}),j1=["none","power1","power2","power3","power4","back","elastic","bounce","slow","steps","circ","expo","sine"],V8=(i=>(i.IN="in",i.OUT="out",i.IN_OUT="inOut",i))(V8||{}),W1=["in","out","inOut"];var q1=class{constructor(){this._propertiesMap=new Map}static instance(){return this._instance=this._instance||new q1}registerProp(e,t){this._propertiesMap.set(this._convert(e),t)}deRegisterProp(e){this._propertiesMap.delete(this._convert(e))}registeredTimelineForProperty(e){return this._propertiesMap.get(this._convert(e))}registeredPropertiesCount(){let e=0;return this._propertiesMap.forEach(()=>{e++}),e}_convert(e){if(e.object){let t=e;return`${t.object.uuid}:${t.propertyName}`}else return e}},Zh=q1.instance();var JM=class{constructor(e){this.param=e,this.proxyValue=e.value}update(e){if(e){let t=e.evaluate(this.proxyValue)[0];this.param.set(t)}else this.param.set(this.proxyValue)}},ZM=class{constructor(e){this.param=e,this.proxyValue=e.value}update(){this.param.set(this.proxyValue)}},QM=class{constructor(e){this.param=e,this.proxyValue=new G,this._array=[0,0],this.proxyValue.copy(e.value)}update(){this.proxyValue.toArray(this._array),this.param.set(this._array)}},eN=class{constructor(e){this.param=e,this.proxyValue=new w,this._array=[0,0,0],this.proxyValue.copy(e.value)}update(){this.proxyValue.toArray(this._array),this.param.set(this._array)}},tN=class{constructor(e){this.param=e,this.proxyValue=new Ie,this._array=[0,0,0,0],this.proxyValue.copy(e.value)}update(){this.proxyValue.toArray(this._array),this.param.set(this._array)}},rN=class{constructor(e){this.param=e,this.proxyValue=new he,this._array=[0,0,0],this.proxyValue.copy(e.valuePreConversion())}update(){this.proxyValue.toArray(this._array),this.param.set(this._array)}},G8=class{constructor(e){this._map=new Map;let t=e.params.all;for(let r of t){let o=this._createParamProxy(r);o&&this._map.set(r,o)}}_createParamProxy(e){switch(e.type()){case J.INTEGER:return new ZM(e);case J.FLOAT:return new JM(e);case J.VECTOR2:return new QM(e);case J.VECTOR3:return new eN(e);case J.COLOR:return new rN(e);case J.VECTOR4:return new tN(e)}}getParamProxy(e){return this._map.get(e)}};var X1=class{constructor(){this._map=new Map}static instance(){return this._instance=this._instance||new X1}nodeProxy(e){let t=this._map.get(e);if(t)return t;let r=new G8(e);return this._map.set(e,r),r}paramProxy(e){return this.nodeProxy(e.node).getParamProxy(e)}},Eu=X1.instance();var oN=".",ed=class{constructor(){this._debug=!1}setName(e){this._propertyName=e}setTargetValue(e){this._targetValue=e}name(){return this._propertyName}targetValue(){return this._targetValue}setDebug(e){this._debug=e}_printDebug(e){!this._debug||console.log(e)}clone(){let e=new ed;if(this._propertyName&&e.setName(this._propertyName),this._targetValue!=null){let t=K.isNumber(this._targetValue)?this._targetValue:this._targetValue.clone();e.setTargetValue(t)}return e}addToTimeline(e){let{target:t}=e,r=t.objects(),o=t.node();this._printDebug(["addToTimeline",t,r,o]),r&&this._populateWithObjects(r,e),o&&this._populateWithNode(o,e)}_populateWithObjects(e,t){let{timelineBuilder:r}=t;if(this._printDebug(["_populateWithObjects",e]),!this._propertyName){Q.warn("no property name given");return}if(this._targetValue==null){Q.warn("no target value given");return}let o=r.operation(),n=r.updateCallback();for(let s of e){let a=this._sceneGraphProps(s,this._propertyName);if(a){let c={object:s,propertyName:this._propertyName},{targetProperty:l,toTarget:u,propertyNames:p}=a,h=this._commonVars(r);if(n&&n.updateMatrix()){let d=s.matrixAutoUpdate;h.onUpdate=()=>{s.matrixAutoUpdate=!0},h.onComplete=()=>{s.matrixAutoUpdate=d,s.matrixAutoUpdate||s.updateMatrix()}}if(l instanceof Nt&&this._targetValue instanceof Nt){let d={value:0},m=l,f=new Nt().copy(l),x=this._targetValue;h.onUpdate=()=>{m.slerpQuaternions(f,x,d.value)},u=d,h.value=1}if(K.isNumber(this._targetValue)){if(K.isNumber(l))for(let d of p)h[d]=this.withOp(l,this._targetValue,o)}else if(K.isVector(l)&&K.isVector(this._targetValue))for(let d of p)h[d]=this.withOp(l[d],this._targetValue[d],o);else if(K.isColor(l)&&K.isColor(this._targetValue))for(let d of p)h[d]=this.withOp(l[d],this._targetValue[d],o);u&&this._startTimeline({...t,vars:h,target:u,registerableProp:c})}}}_sceneGraphProps(e,t){let r=t.split(oN);if(r.length>1){let o=r.shift(),n=e[o];if(n){let s=r.join(oN);return this._sceneGraphProps(n,s)}else console.warn(`property ${o} not found on object`,e)}else{let o=e[t],n=null,s=[];return K.isNumber(o)?(n=e,s.push(t)):(n=o,this._targetValue instanceof G&&s.push("x","y"),this._targetValue instanceof w&&s.push("x","y","z"),this._targetValue instanceof Ie&&s.push("x","y","z","w"),this._targetValue instanceof he&&s.push("r","g","b"),this._targetValue instanceof Nt),{targetProperty:o,toTarget:n,propertyNames:s}}}_populateWithNode(e,t){this._printDebug(["_populateWithNode",e]);let r=e.p[this._propertyName];if(this._printDebug(["targetParam",r]),!r){Q.warn(`${this._propertyName} not found on node ${e.path()}`);return}r&&this._populateVarsForParam(r,t)}_populateVarsForParam(e,t){switch(this._printDebug(["_populateVarsForParam",e]),e.type()){case J.INTEGER:return this._populateVarsForParamInteger(e,t);case J.FLOAT:return this._populateVarsForParamFloat(e,t);case J.VECTOR2:return this._populateVarsForParamVector2(e,t);case J.VECTOR3:return this._populateVarsForParamVector3(e,t);case J.COLOR:return this._populateVarsForParamColor(e,t);case J.VECTOR4:return this._populateVarsForParamVector4(e,t)}Q.warn(`param type cannot be animated (yet): '${e.type()}' '${e.path()}'`)}_populateVarsForSingleNumericParam(e,t){if(!K.isNumber(this._targetValue)){Q.warn(`TimelineBuilderProperty error: cannot animate float/integer param '${e.path()}' with targetValue`,this._targetValue);return}let r=Eu.paramProxy(e);if(!r)return;let o=t.timelineBuilder.keyframes(),n=o?o.createInterpolant():void 0,s=this._commonVars(t.timelineBuilder);s.onUpdate=()=>{r.update(n)};let a=this._targetValue;o&&(a=1);let c=t.timelineBuilder.operation();s.proxyValue=this.withOp(e.value,a,c),this._startTimeline({...t,vars:s,target:r,registerableProp:e})}_populateVarsForParamInteger(e,t){this._populateVarsForSingleNumericParam(e,t)}_populateVarsForParamFloat(e,t){this._populateVarsForSingleNumericParam(e,t)}_populateVarsForParamVector2(e,t){if(!(this._targetValue instanceof G)){Q.warn(`TimelineBuilderProperty error: cannot animate vector2 param '${e.path()}' with targetValue`,this._targetValue);return}let r=Eu.paramProxy(e);if(!r)return;let o=this._commonVars(t.timelineBuilder);o.onUpdate=()=>{r.update()};let n=t.timelineBuilder.operation();o.x=this.withOp(e.value.x,this._targetValue.x,n),o.y=this.withOp(e.value.y,this._targetValue.y,n),this._startTimeline({...t,vars:o,target:r.proxyValue,registerableProp:e})}_populateVarsForParamVector3(e,t){if(!(this._targetValue instanceof w)){Q.warn(`TimelineBuilderProperty error: cannot animate vector3 param '${e.path()}' with targetValue`,this._targetValue);return}let r=Eu.paramProxy(e);if(!r)return;let o=this._commonVars(t.timelineBuilder);o.onUpdate=()=>{r.update()};let n=t.timelineBuilder.operation();o.x=this.withOp(e.value.x,this._targetValue.x,n),o.y=this.withOp(e.value.y,this._targetValue.y,n),o.z=this.withOp(e.value.z,this._targetValue.z,n),this._startTimeline({...t,vars:o,target:r.proxyValue,registerableProp:e})}_populateVarsForParamVector4(e,t){if(!(this._targetValue instanceof Ie)){Q.warn(`TimelineBuilderProperty error: cannot animate vector4 param '${e.path()}' with targetValue`,this._targetValue);return}let r=Eu.paramProxy(e);if(!r)return;let o=this._commonVars(t.timelineBuilder);o.onUpdate=()=>{r.update()};let n=t.timelineBuilder.operation();o.x=this.withOp(e.value.x,this._targetValue.x,n),o.y=this.withOp(e.value.y,this._targetValue.y,n),o.z=this.withOp(e.value.z,this._targetValue.z,n),o.w=this.withOp(e.value.w,this._targetValue.w,n),this._startTimeline({...t,vars:o,target:r.proxyValue,registerableProp:e})}_populateVarsForParamColor(e,t){if(!(this._targetValue instanceof he||this._targetValue instanceof w)){Q.warn(`TimelineBuilderProperty error: cannot animate color param '${e.path()}' with targetValue`,this._targetValue);return}let r=Eu.paramProxy(e);if(!r)return;let o=this._commonVars(t.timelineBuilder);o.onUpdate=()=>{r.update()};let n=t.timelineBuilder.operation(),s=this._targetValue instanceof he?this._targetValue.r:this._targetValue.x,a=this._targetValue instanceof he?this._targetValue.g:this._targetValue.y,c=this._targetValue instanceof he?this._targetValue.b:this._targetValue.z;o.r=this.withOp(e.value.r,s,n),o.g=this.withOp(e.value.g,a,n),o.b=this.withOp(e.value.b,c,n),this._startTimeline({...t,vars:o,target:r.proxyValue,registerableProp:e})}withOp(e,t,r){switch(r){case Qh.SET:return t;case Qh.ADD:return e+t;case Qh.SUBTRACT:return e-t}Be.unreachable(r)}_commonVars(e){let r={duration:e.duration()},o=e.easing()||Cu.NONE;o&&(r.ease=o);let n=e.delay();n!=null&&(r.delay=n);let s=e.repeatParams();return s&&(r.repeat=s.count,r.repeatDelay=s.delay,r.yoyo=s.yoyo),r}_startTimeline(e){let{timelineBuilder:t,timeline:r,vars:o,target:n,registerableProp:s,registerproperties:a}=e,c=t.position(),l=c?c.toParameter():void 0,u=Zh.registeredTimelineForProperty(s),p=r.to(n,o,l),h=()=>{if(u)if(u.stoppable)u.timeline.kill(),Zh.deRegisterProp(s);else{p.kill();return}a&&Zh.registerProp(s,{timeline:p,stoppable:t.stoppable()})},d=()=>{Zh.deRegisterProp(s)};if(o.onStart){let m=o.onStart;o.onStart=()=>{h(),m()}}else o.onStart=h;if(o.onComplete){let m=o.onComplete;o.onComplete=()=>{d(),m()}}else o.onComplete=d}};function r0(i){if(i===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return i}function pN(i,e){i.prototype=Object.create(e.prototype),i.prototype.constructor=i,i.__proto__=e}var qo={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},Mu={duration:.5,overwrite:!1,delay:0},r6,Ts=1e8,tr=1/Ts,Y8=Math.PI*2,yK=Y8/4,bK=0,hN=Math.sqrt,TK=Math.cos,AK=Math.sin,so=function(e){return typeof e=="string"},no=function(e){return typeof e=="function"},i0=function(e){return typeof e=="number"},t_=function(e){return typeof e>"u"},n0=function(e){return typeof e=="object"},ui=function(e){return e!==!1},dN=function(){return typeof window<"u"},iN=function(e){return no(e)||so(e)},fN=typeof ArrayBuffer=="function"&&ArrayBuffer.isView||function(){},Li=Array.isArray,$8=/(?:-?\.?\d|\.)+/gi,o6=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,yc=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,z8=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,i6=/[+-]=-?[.\d]+/,mN=/[^,'"\[\]\s]+/gi,CK=/[\d.+\-=]+(?:e[-+]\d*)*/i,xr,ys,K8,n6,Ii={},$1={},_N,gN=function(e){return($1=Ou(e,Ii))&&nn},r_=function(e,t){return console.warn("Invalid property",e,"set to",t,"Missing plugin? gsap.registerPlugin()")},K1=function(e,t){return!t&&console.warn(e)},vN=function(e,t){return e&&(Ii[e]=t)&&$1&&($1[e]=t)||Ii},Nu=function(){return 0},s6={},Z0=[],J8={},xN,li={},H8={},nN=30,Y1=[],a6="",c6=function(e){var t=e[0],r,o;if(n0(t)||no(t)||(e=[e]),!(r=(t._gsap||{}).harness)){for(o=Y1.length;o--&&!Y1[o].targetTest(t););r=Y1[o]}for(o=e.length;o--;)e[o]&&(e[o]._gsap||(e[o]._gsap=new p6(e[o],r)))||e.splice(o,1);return e},Q0=function(e){return e._gsap||c6(tn(e))[0]._gsap},l6=function(e,t,r){return(r=e[t])&&no(r)?e[t]():t_(r)&&e.getAttribute&&e.getAttribute(t)||r},pi=function(e,t){return(e=e.split(",")).forEach(t)||e},Pr=function(e){return Math.round(e*1e5)/1e5||0},Do=function(e){return Math.round(e*1e7)/1e7||0},EK=function(e,t){for(var r=t.length,o=0;e.indexOf(t[o])<0&&++o<r;);return o<r},J1=function(){var e=Z0.length,t=Z0.slice(0),r,o;for(J8={},Z0.length=0,r=0;r<e;r++)o=t[r],o&&o._lazy&&(o.render(o._lazy[0],o._lazy[1],!0)._lazy=0)},yN=function(e,t,r,o){Z0.length&&J1(),e.render(t,r,o),Z0.length&&J1()},bN=function(e){var t=parseFloat(e);return(t||t===0)&&(e+"").match(mN).length<2?t:so(e)?e.trim():e},TN=function(e){return e},on=function(e,t){for(var r in t)r in e||(e[r]=t[r]);return e},SK=function(e,t){for(var r in t)r in e||r==="duration"||r==="ease"||(e[r]=t[r])},Ou=function(e,t){for(var r in t)e[r]=t[r];return e},sN=function i(e,t){for(var r in t)r!=="__proto__"&&r!=="constructor"&&r!=="prototype"&&(e[r]=n0(t[r])?i(e[r]||(e[r]={}),t[r]):t[r]);return e},Z8=function(e,t){var r={},o;for(o in e)o in t||(r[o]=e[o]);return r},od=function(e){var t=e.parent||xr,r=e.keyframes?SK:on;if(ui(e.inherit))for(;t;)r(e,t.vars.defaults),t=t.parent||t._dp;return e},wK=function(e,t){for(var r=e.length,o=r===t.length;o&&r--&&e[r]===t[r];);return r<0},MK=function(e,t,r,o,n){r===void 0&&(r="_first"),o===void 0&&(o="_last");var s=e[o],a;if(n)for(a=t[n];s&&s[n]>a;)s=s._prev;return s?(t._next=s._next,s._next=t):(t._next=e[r],e[r]=t),t._next?t._next._prev=t:e[o]=t,t._prev=s,t.parent=t._dp=e,t},o_=function(e,t,r,o){r===void 0&&(r="_first"),o===void 0&&(o="_last");var n=t._prev,s=t._next;n?n._next=s:e[r]===t&&(e[r]=s),s?s._prev=n:e[o]===t&&(e[o]=n),t._next=t._prev=t.parent=null},ea=function(e,t){e.parent&&(!t||e.parent.autoRemoveChildren)&&e.parent.remove(e),e._act=0},xc=function(e,t){if(e&&(!t||t._end>e._dur||t._start<0))for(var r=e;r;)r._dirty=1,r=r.parent;return e},NK=function(e){for(var t=e.parent;t&&t.parent;)t._dirty=1,t.totalDuration(),t=t.parent;return e},OK=function i(e){return!e||e._ts&&i(e.parent)},aN=function(e){return e._repeat?Pu(e._tTime,e=e.duration()+e._rDelay)*e:0},Pu=function(e,t){var r=Math.floor(e/=t);return e&&r===e?r-1:r},Z1=function(e,t){return(e-t._start)*t._ts+(t._ts>=0?0:t._dirty?t.totalDuration():t._tDur)},i_=function(e){return e._end=Do(e._start+(e._tDur/Math.abs(e._ts||e._rts||tr)||0))},AN=function(e,t){var r=e._dp;return r&&r.smoothChildTiming&&e._ts&&(e._start=Do(r._time-(e._ts>0?t/e._ts:((e._dirty?e.totalDuration():e._tDur)-t)/-e._ts)),i_(e),r._dirty||xc(r,e)),e},CN=function(e,t){var r;if((t._time||t._initted&&!t._dur)&&(r=Z1(e.rawTime(),t),(!t._dur||ad(0,t.totalDuration(),r)-t._tTime>tr)&&t.render(r,!0)),xc(e,t)._dp&&e._initted&&e._time>=e._dur&&e._ts){if(e._dur<e.duration())for(r=e;r._dp;)r.rawTime()>=0&&r.totalTime(r._tTime),r=r._dp;e._zTime=-tr}},bs=function(e,t,r,o){return t.parent&&ea(t),t._start=Do((i0(r)?r:r||e!==xr?en(e,r,t):e._time)+t._delay),t._end=Do(t._start+(t.totalDuration()/Math.abs(t.timeScale())||0)),MK(e,t,"_first","_last",e._sort?"_start":0),Q8(t)||(e._recent=t),o||CN(e,t),e},EN=function(e,t){return(Ii.ScrollTrigger||r_("scrollTrigger",t))&&Ii.ScrollTrigger.create(t,e)},SN=function(e,t,r,o){if(QK(e,t),!e._initted)return 1;if(!r&&e._pt&&(e._dur&&e.vars.lazy!==!1||!e._dur&&e.vars.lazy)&&xN!==Ri.frame)return Z0.push(e),e._lazy=[t,o],1},PK=function i(e){var t=e.parent;return t&&t._ts&&t._initted&&!t._lock&&(t.rawTime()<0||i(t))},Q8=function(e){var t=e.data;return t==="isFromStart"||t==="isStart"},RK=function(e,t,r,o){var n=e.ratio,s=t<0||!t&&(!e._start&&PK(e)&&!(!e._initted&&Q8(e))||(e._ts<0||e._dp._ts<0)&&!Q8(e))?0:1,a=e._rDelay,c=0,l,u,p;if(a&&e._repeat&&(c=ad(0,e._tDur,t),u=Pu(c,a),p=Pu(e._tTime,a),e._yoyo&&u&1&&(s=1-s),u!==p&&(n=1-s,e.vars.repeatRefresh&&e._initted&&e.invalidate())),s!==n||o||e._zTime===tr||!t&&e._zTime){if(!e._initted&&SN(e,t,o,r))return;for(p=e._zTime,e._zTime=t||(r?tr:0),r||(r=t&&!p),e.ratio=s,e._from&&(s=1-s),e._time=0,e._tTime=c,l=e._pt;l;)l.r(s,l.d),l=l._next;e._startAt&&t<0&&e._startAt.render(t,!0,!0),e._onUpdate&&!r&&rn(e,"onUpdate"),c&&e._repeat&&!r&&e.parent&&rn(e,"onRepeat"),(t>=e._tDur||t<0)&&e.ratio===s&&(s&&ea(e,1),r||(rn(e,s?"onComplete":"onReverseComplete",!0),e._prom&&e._prom()))}else e._zTime||(e._zTime=t)},LK=function(e,t,r){var o;if(r>t)for(o=e._first;o&&o._start<=r;){if(!o._dur&&o.data==="isPause"&&o._start>t)return o;o=o._next}else for(o=e._last;o&&o._start>=r;){if(!o._dur&&o.data==="isPause"&&o._start<t)return o;o=o._prev}},Ru=function(e,t,r,o){var n=e._repeat,s=Do(t)||0,a=e._tTime/e._tDur;return a&&!o&&(e._time*=s/e._dur),e._dur=s,e._tDur=n?n<0?1e10:Do(s*(n+1)+e._rDelay*n):s,a&&!o?AN(e,e._tTime=e._tDur*a):e.parent&&i_(e),r||xc(e.parent,e),e},cN=function(e){return e instanceof ko?xc(e):Ru(e,e._dur)},IK={_start:0,endTime:Nu,totalDuration:Nu},en=function i(e,t,r){var o=e.labels,n=e._recent||IK,s=e.duration()>=Ts?n.endTime(!1):e._dur,a,c,l;return so(t)&&(isNaN(t)||t in o)?(c=t.charAt(0),l=t.substr(-1)==="%",a=t.indexOf("="),c==="<"||c===">"?(a>=0&&(t=t.replace(/=/,"")),(c==="<"?n._start:n.endTime(n._repeat>=0))+(parseFloat(t.substr(1))||0)*(l?(a<0?n:r).totalDuration()/100:1)):a<0?(t in o||(o[t]=s),o[t]):(c=parseFloat(t.charAt(a-1)+t.substr(a+1)),l&&r&&(c=c/100*(Li(r)?r[0]:r).totalDuration()),a>1?i(e,t.substr(0,a-1),r)+c:s+c)):t==null?s:+t},id=function(e,t,r){var o=i0(t[1]),n=(o?2:1)+(e<2?0:1),s=t[n],a,c;if(o&&(s.duration=t[1]),s.parent=r,e){for(a=s,c=r;c&&!("immediateRender"in a);)a=c.vars.defaults||{},c=ui(c.vars.inherit)&&c.parent;s.immediateRender=ui(a.immediateRender),e<2?s.runBackwards=1:s.startAt=t[n-1]}return new Yr(t[0],s,t[n+1])},ta=function(e,t){return e||e===0?t(e):t},ad=function(e,t,r){return r<e?e:r>t?t:r},hi=function(e){if(typeof e!="string")return"";var t=CK.exec(e);return t?e.substr(t.index+t[0].length):""},DK=function(e,t,r){return ta(r,function(o){return ad(e,t,o)})},e6=[].slice,wN=function(e,t){return e&&n0(e)&&"length"in e&&(!t&&!e.length||e.length-1 in e&&n0(e[0]))&&!e.nodeType&&e!==ys},kK=function(e,t,r){return r===void 0&&(r=[]),e.forEach(function(o){var n;return so(o)&&!t||wN(o,1)?(n=r).push.apply(n,tn(o)):r.push(o)})||r},tn=function(e,t,r){return so(e)&&!r&&(K8||!Lu())?e6.call((t||n6).querySelectorAll(e),0):Li(e)?kK(e,r):wN(e)?e6.call(e,0):e?[e]:[]},BK=function(e){return e=tn(e)[0]||K1("Invalid scope")||{},function(t){var r=e.current||e.nativeElement||e;return tn(t,r.querySelectorAll?r:r===e?K1("Invalid scope")||n6.createElement("div"):e)}},MN=function(e){return e.sort(function(){return .5-Math.random()})},NN=function(e){if(no(e))return e;var t=n0(e)?e:{each:e},r=wu(t.ease),o=t.from||0,n=parseFloat(t.base)||0,s={},a=o>0&&o<1,c=isNaN(o)||a,l=t.axis,u=o,p=o;return so(o)?u=p={center:.5,edges:.5,end:1}[o]||0:!a&&c&&(u=o[0],p=o[1]),function(h,d,m){var f=(m||t).length,x=s[f],_,g,T,b,y,A,E,S,M;if(!x){if(M=t.grid==="auto"?0:(t.grid||[1,Ts])[1],!M){for(E=-Ts;E<(E=m[M++].getBoundingClientRect().left)&&M<f;);M--}for(x=s[f]=[],_=c?Math.min(M,f)*u-.5:o%M,g=c?f*p/M-.5:o/M|0,E=0,S=Ts,A=0;A<f;A++)T=A%M-_,b=g-(A/M|0),x[A]=y=l?Math.abs(l==="y"?b:T):hN(T*T+b*b),y>E&&(E=y),y<S&&(S=y);o==="random"&&MN(x),x.max=E-S,x.min=S,x.v=f=(parseFloat(t.amount)||parseFloat(t.each)*(M>f?f-1:l?l==="y"?f/M:M:Math.max(M,f/M))||0)*(o==="edges"?-1:1),x.b=f<0?n-f:n,x.u=hi(t.amount||t.each)||0,r=r&&f<0?kN(r):r}return f=(x[h]-x.min)/x.max||0,Do(x.b+(r?r(f):f)*x.v)+x.u}},t6=function(e){var t=Math.pow(10,((e+"").split(".")[1]||"").length);return function(r){var o=Math.round(parseFloat(r)/e)*e*t;return(o-o%1)/t+(i0(r)?0:hi(r))}},ON=function(e,t){var r=Li(e),o,n;return!r&&n0(e)&&(o=r=e.radius||Ts,e.values?(e=tn(e.values),(n=!i0(e[0]))&&(o*=o)):e=t6(e.increment)),ta(t,r?no(e)?function(s){return n=e(s),Math.abs(n-s)<=o?n:s}:function(s){for(var a=parseFloat(n?s.x:s),c=parseFloat(n?s.y:0),l=Ts,u=0,p=e.length,h,d;p--;)n?(h=e[p].x-a,d=e[p].y-c,h=h*h+d*d):h=Math.abs(e[p]-a),h<l&&(l=h,u=p);return u=!o||l<=o?e[u]:s,n||u===s||i0(s)?u:u+hi(s)}:t6(e))},PN=function(e,t,r,o){return ta(Li(e)?!t:r===!0?!!(r=0):!o,function(){return Li(e)?e[~~(Math.random()*e.length)]:(r=r||1e-5)&&(o=r<1?Math.pow(10,(r+"").length-2):1)&&Math.floor(Math.round((e-r/2+Math.random()*(t-e+r*.99))/r)*r*o)/o})},FK=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(o){return t.reduce(function(n,s){return s(n)},o)}},UK=function(e,t){return function(r){return e(parseFloat(r))+(t||hi(r))}},VK=function(e,t,r){return LN(e,t,0,1,r)},RN=function(e,t,r){return ta(r,function(o){return e[~~t(o)]})},GK=function i(e,t,r){var o=t-e;return Li(e)?RN(e,i(0,e.length),t):ta(r,function(n){return(o+(n-e)%o)%o+e})},zK=function i(e,t,r){var o=t-e,n=o*2;return Li(e)?RN(e,i(0,e.length-1),t):ta(r,function(s){return s=(n+(s-e)%n)%n||0,e+(s>o?n-s:s)})},Iu=function(e){for(var t=0,r="",o,n,s,a;~(o=e.indexOf("random(",t));)s=e.indexOf(")",o),a=e.charAt(o+7)==="[",n=e.substr(o+7,s-o-7).match(a?mN:$8),r+=e.substr(t,o-t)+PN(a?n:+n[0],a?0:+n[1],+n[2]||1e-5),t=s+1;return r+e.substr(t,e.length-t)},LN=function(e,t,r,o,n){var s=t-e,a=o-r;return ta(n,function(c){return r+((c-e)/s*a||0)})},HK=function i(e,t,r,o){var n=isNaN(e+t)?0:function(d){return(1-d)*e+d*t};if(!n){var s=so(e),a={},c,l,u,p,h;if(r===!0&&(o=1)&&(r=null),s)e={p:e},t={p:t};else if(Li(e)&&!Li(t)){for(u=[],p=e.length,h=p-2,l=1;l<p;l++)u.push(i(e[l-1],e[l]));p--,n=function(m){m*=p;var f=Math.min(h,~~m);return u[f](m-f)},r=t}else o||(e=Ou(Li(e)?[]:{},e));if(!u){for(c in t)h6.call(a,e,c,"get",t[c]);n=function(m){return _6(m,a)||(s?e.p:e)}}}return ta(r,n)},lN=function(e,t,r){var o=e.labels,n=Ts,s,a,c;for(s in o)a=o[s]-t,a<0==!!r&&a&&n>(a=Math.abs(a))&&(c=s,n=a);return c},rn=function(e,t,r){var o=e.vars,n=o[t],s,a;if(!!n)return s=o[t+"Params"],a=o.callbackScope||e,r&&Z0.length&&J1(),s?n.apply(a,s):n.call(a)},td=function(e){return ea(e),e.scrollTrigger&&e.scrollTrigger.kill(!1),e.progress()<1&&rn(e,"onInterrupt"),e},Su,jK=function(e){e=!e.name&&e.default||e;var t=e.name,r=no(e),o=t&&!r&&e.init?function(){this._props=[]}:e,n={init:Nu,render:_6,add:h6,kill:sJ,modifier:nJ,rawVars:0},s={targetTest:0,get:0,getSetter:n_,aliases:{},register:0};if(Lu(),e!==o){if(li[t])return;on(o,on(Z8(e,n),s)),Ou(o.prototype,Ou(n,Z8(e,s))),li[o.prop=t]=o,e.targetTest&&(Y1.push(o),s6[t]=1),t=(t==="css"?"CSS":t.charAt(0).toUpperCase()+t.substr(1))+"Plugin"}vN(t,o),e.register&&e.register(nn,o,Xo)},er=255,rd={aqua:[0,er,er],lime:[0,er,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,er],navy:[0,0,128],white:[er,er,er],olive:[128,128,0],yellow:[er,er,0],orange:[er,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[er,0,0],pink:[er,192,203],cyan:[0,er,er],transparent:[er,er,er,0]},j8=function(e,t,r){return e=e<0?e+1:e>1?e-1:e,(e*6<1?t+(r-t)*e*6:e<.5?r:e*3<2?t+(r-t)*(2/3-e)*6:t)*er+.5|0},IN=function(e,t,r){var o=e?i0(e)?[e>>16,e>>8&er,e&er]:0:rd.black,n,s,a,c,l,u,p,h,d,m;if(!o){if(e.substr(-1)===","&&(e=e.substr(0,e.length-1)),rd[e])o=rd[e];else if(e.charAt(0)==="#"){if(e.length<6&&(n=e.charAt(1),s=e.charAt(2),a=e.charAt(3),e="#"+n+n+s+s+a+a+(e.length===5?e.charAt(4)+e.charAt(4):"")),e.length===9)return o=parseInt(e.substr(1,6),16),[o>>16,o>>8&er,o&er,parseInt(e.substr(7),16)/255];e=parseInt(e.substr(1),16),o=[e>>16,e>>8&er,e&er]}else if(e.substr(0,3)==="hsl"){if(o=m=e.match($8),!t)c=+o[0]%360/360,l=+o[1]/100,u=+o[2]/100,s=u<=.5?u*(l+1):u+l-u*l,n=u*2-s,o.length>3&&(o[3]*=1),o[0]=j8(c+1/3,n,s),o[1]=j8(c,n,s),o[2]=j8(c-1/3,n,s);else if(~e.indexOf("="))return o=e.match(o6),r&&o.length<4&&(o[3]=1),o}else o=e.match($8)||rd.transparent;o=o.map(Number)}return t&&!m&&(n=o[0]/er,s=o[1]/er,a=o[2]/er,p=Math.max(n,s,a),h=Math.min(n,s,a),u=(p+h)/2,p===h?c=l=0:(d=p-h,l=u>.5?d/(2-p-h):d/(p+h),c=p===n?(s-a)/d+(s<a?6:0):p===s?(a-n)/d+2:(n-s)/d+4,c*=60),o[0]=~~(c+.5),o[1]=~~(l*100+.5),o[2]=~~(u*100+.5)),r&&o.length<4&&(o[3]=1),o},DN=function(e){var t=[],r=[],o=-1;return e.split(o0).forEach(function(n){var s=n.match(yc)||[];t.push.apply(t,s),r.push(o+=s.length+1)}),t.c=r,t},uN=function(e,t,r){var o="",n=(e+o).match(o0),s=t?"hsla(":"rgba(",a=0,c,l,u,p;if(!n)return e;if(n=n.map(function(h){return(h=IN(h,t,1))&&s+(t?h[0]+","+h[1]+"%,"+h[2]+"%,"+h[3]:h.join(","))+")"}),r&&(u=DN(e),c=r.c,c.join(o)!==u.c.join(o)))for(l=e.replace(o0,"1").split(yc),p=l.length-1;a<p;a++)o+=l[a]+(~c.indexOf(a)?n.shift()||s+"0,0,0,0)":(u.length?u:n.length?n:r).shift());if(!l)for(l=e.split(o0),p=l.length-1;a<p;a++)o+=l[a]+n[a];return o+l[p]},o0=function(){var i="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b",e;for(e in rd)i+="|"+e+"\\b";return new RegExp(i+")","gi")}(),WK=/hsl[a]?\(/,u6=function(e){var t=e.join(" "),r;if(o0.lastIndex=0,o0.test(t))return r=WK.test(t),e[1]=uN(e[1],r),e[0]=uN(e[0],r,DN(e[1])),!0},Q1,Ri=function(){var i=Date.now,e=500,t=33,r=i(),o=r,n=1e3/240,s=n,a=[],c,l,u,p,h,d,m=function f(x){var _=i()-o,g=x===!0,T,b,y,A;if(_>e&&(r+=_-t),o+=_,y=o-r,T=y-s,(T>0||g)&&(A=++p.frame,h=y-p.time*1e3,p.time=y=y/1e3,s+=T+(T>=n?4:n-T),b=1),g||(c=l(f)),b)for(d=0;d<a.length;d++)a[d](y,h,A,x)};return p={time:0,frame:0,tick:function(){m(!0)},deltaRatio:function(x){return h/(1e3/(x||60))},wake:function(){_N&&(!K8&&dN()&&(ys=K8=window,n6=ys.document||{},Ii.gsap=nn,(ys.gsapVersions||(ys.gsapVersions=[])).push(nn.version),gN($1||ys.GreenSockGlobals||!ys.gsap&&ys||{}),u=ys.requestAnimationFrame),c&&p.sleep(),l=u||function(x){return setTimeout(x,s-p.time*1e3+1|0)},Q1=1,m(2))},sleep:function(){(u?ys.cancelAnimationFrame:clearTimeout)(c),Q1=0,l=Nu},lagSmoothing:function(x,_){e=x||1/tr,t=Math.min(_,e,0)},fps:function(x){n=1e3/(x||240),s=p.time*1e3+n},add:function(x){a.indexOf(x)<0&&a.push(x),Lu()},remove:function(x){var _;~(_=a.indexOf(x))&&a.splice(_,1)&&d>=_&&d--},_listeners:a},p}(),Lu=function(){return!Q1&&Ri.wake()},Ct={},qK=/^[\d.\-M][\d.\-,\s]/,XK=/["']/g,YK=function(e){for(var t={},r=e.substr(1,e.length-3).split(":"),o=r[0],n=1,s=r.length,a,c,l;n<s;n++)c=r[n],a=n!==s-1?c.lastIndexOf(","):c.length,l=c.substr(0,a),t[o]=isNaN(l)?l.replace(XK,"").trim():+l,o=c.substr(a+1).trim();return t},$K=function(e){var t=e.indexOf("(")+1,r=e.indexOf(")"),o=e.indexOf("(",t);return e.substring(t,~o&&o<r?e.indexOf(")",r+1):r)},KK=function(e){var t=(e+"").split("("),r=Ct[t[0]];return r&&t.length>1&&r.config?r.config.apply(null,~e.indexOf("{")?[YK(t[1])]:$K(e).split(",").map(bN)):Ct._CE&&qK.test(e)?Ct._CE("",e):r},kN=function(e){return function(t){return 1-e(1-t)}},BN=function i(e,t){for(var r=e._first,o;r;)r instanceof ko?i(r,t):r.vars.yoyoEase&&(!r._yoyo||!r._repeat)&&r._yoyo!==t&&(r.timeline?i(r.timeline,t):(o=r._ease,r._ease=r._yEase,r._yEase=o,r._yoyo=t)),r=r._next},wu=function(e,t){return e&&(no(e)?e:Ct[e]||KK(e))||t},bc=function(e,t,r,o){r===void 0&&(r=function(c){return 1-t(1-c)}),o===void 0&&(o=function(c){return c<.5?t(c*2)/2:1-t((1-c)*2)/2});var n={easeIn:t,easeOut:r,easeInOut:o},s;return pi(e,function(a){Ct[a]=Ii[a]=n,Ct[s=a.toLowerCase()]=r;for(var c in n)Ct[s+(c==="easeIn"?".in":c==="easeOut"?".out":".inOut")]=Ct[a+"."+c]=n[c]}),n},FN=function(e){return function(t){return t<.5?(1-e(1-t*2))/2:.5+e((t-.5)*2)/2}},W8=function i(e,t,r){var o=t>=1?t:1,n=(r||(e?.3:.45))/(t<1?t:1),s=n/Y8*(Math.asin(1/o)||0),a=function(u){return u===1?1:o*Math.pow(2,-10*u)*AK((u-s)*n)+1},c=e==="out"?a:e==="in"?function(l){return 1-a(1-l)}:FN(a);return n=Y8/n,c.config=function(l,u){return i(e,l,u)},c},q8=function i(e,t){t===void 0&&(t=1.70158);var r=function(s){return s?--s*s*((t+1)*s+t)+1:0},o=e==="out"?r:e==="in"?function(n){return 1-r(1-n)}:FN(r);return o.config=function(n){return i(e,n)},o};pi("Linear,Quad,Cubic,Quart,Quint,Strong",function(i,e){var t=e<5?e+1:e;bc(i+",Power"+(t-1),e?function(r){return Math.pow(r,t)}:function(r){return r},function(r){return 1-Math.pow(1-r,t)},function(r){return r<.5?Math.pow(r*2,t)/2:1-Math.pow((1-r)*2,t)/2})});Ct.Linear.easeNone=Ct.none=Ct.Linear.easeIn;bc("Elastic",W8("in"),W8("out"),W8());(function(i,e){var t=1/e,r=2*t,o=2.5*t,n=function(a){return a<t?i*a*a:a<r?i*Math.pow(a-1.5/e,2)+.75:a<o?i*(a-=2.25/e)*a+.9375:i*Math.pow(a-2.625/e,2)+.984375};bc("Bounce",function(s){return 1-n(1-s)},n)})(7.5625,2.75);bc("Expo",function(i){return i?Math.pow(2,10*(i-1)):0});bc("Circ",function(i){return-(hN(1-i*i)-1)});bc("Sine",function(i){return i===1?1:-TK(i*yK)+1});bc("Back",q8("in"),q8("out"),q8());Ct.SteppedEase=Ct.steps=Ii.SteppedEase={config:function(e,t){e===void 0&&(e=1);var r=1/e,o=e+(t?0:1),n=t?1:0,s=1-tr;return function(a){return((o*ad(0,s,a)|0)+n)*r}}};Mu.ease=Ct["quad.out"];pi("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",function(i){return a6+=i+","+i+"Params,"});var p6=function(e,t){this.id=bK++,e._gsap=this,this.target=e,this.harness=t,this.get=t?t.get:l6,this.set=t?t.getSetter:n_},sd=function(){function i(t){this.vars=t,this._delay=+t.delay||0,(this._repeat=t.repeat===1/0?-2:t.repeat||0)&&(this._rDelay=t.repeatDelay||0,this._yoyo=!!t.yoyo||!!t.yoyoEase),this._ts=1,Ru(this,+t.duration,1,1),this.data=t.data,Q1||Ri.wake()}var e=i.prototype;return e.delay=function(r){return r||r===0?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+r-this._delay),this._delay=r,this):this._delay},e.duration=function(r){return arguments.length?this.totalDuration(this._repeat>0?r+(r+this._rDelay)*this._repeat:r):this.totalDuration()&&this._dur},e.totalDuration=function(r){return arguments.length?(this._dirty=0,Ru(this,this._repeat<0?r:(r-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},e.totalTime=function(r,o){if(Lu(),!arguments.length)return this._tTime;var n=this._dp;if(n&&n.smoothChildTiming&&this._ts){for(AN(this,r),!n._dp||n.parent||CN(n,this);n&&n.parent;)n.parent._time!==n._start+(n._ts>=0?n._tTime/n._ts:(n.totalDuration()-n._tTime)/-n._ts)&&n.totalTime(n._tTime,!0),n=n.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&r<this._tDur||this._ts<0&&r>0||!this._tDur&&!r)&&bs(this._dp,this,this._start-this._delay)}return(this._tTime!==r||!this._dur&&!o||this._initted&&Math.abs(this._zTime)===tr||!r&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=r),yN(this,r,o)),this},e.time=function(r,o){return arguments.length?this.totalTime(Math.min(this.totalDuration(),r+aN(this))%(this._dur+this._rDelay)||(r?this._dur:0),o):this._time},e.totalProgress=function(r,o){return arguments.length?this.totalTime(this.totalDuration()*r,o):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.ratio},e.progress=function(r,o){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&!(this.iteration()&1)?1-r:r)+aN(this),o):this.duration()?Math.min(1,this._time/this._dur):this.ratio},e.iteration=function(r,o){var n=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(r-1)*n,o):this._repeat?Pu(this._tTime,n)+1:1},e.timeScale=function(r){if(!arguments.length)return this._rts===-tr?0:this._rts;if(this._rts===r)return this;var o=this.parent&&this._ts?Z1(this.parent._time,this):this._tTime;return this._rts=+r||0,this._ts=this._ps||r===-tr?0:this._rts,NK(this.totalTime(ad(-this._delay,this._tDur,o),!0)),i_(this),this},e.paused=function(r){return arguments.length?(this._ps!==r&&(this._ps=r,r?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(Lu(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,this.progress()===1&&Math.abs(this._zTime)!==tr&&(this._tTime-=tr)))),this):this._ps},e.startTime=function(r){if(arguments.length){this._start=r;var o=this.parent||this._dp;return o&&(o._sort||!this.parent)&&bs(o,this,r-this._delay),this}return this._start},e.endTime=function(r){return this._start+(ui(r)?this.totalDuration():this.duration())/Math.abs(this._ts||1)},e.rawTime=function(r){var o=this.parent||this._dp;return o?r&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?Z1(o.rawTime(r),this):this._tTime:this._tTime},e.globalTime=function(r){for(var o=this,n=arguments.length?r:o.rawTime();o;)n=o._start+n/(o._ts||1),o=o._dp;return n},e.repeat=function(r){return arguments.length?(this._repeat=r===1/0?-2:r,cN(this)):this._repeat===-2?1/0:this._repeat},e.repeatDelay=function(r){if(arguments.length){var o=this._time;return this._rDelay=r,cN(this),o?this.time(o):this}return this._rDelay},e.yoyo=function(r){return arguments.length?(this._yoyo=r,this):this._yoyo},e.seek=function(r,o){return this.totalTime(en(this,r),ui(o))},e.restart=function(r,o){return this.play().totalTime(r?-this._delay:0,ui(o))},e.play=function(r,o){return r!=null&&this.seek(r,o),this.reversed(!1).paused(!1)},e.reverse=function(r,o){return r!=null&&this.seek(r||this.totalDuration(),o),this.reversed(!0).paused(!1)},e.pause=function(r,o){return r!=null&&this.seek(r,o),this.paused(!0)},e.resume=function(){return this.paused(!1)},e.reversed=function(r){return arguments.length?(!!r!==this.reversed()&&this.timeScale(-this._rts||(r?-tr:0)),this):this._rts<0},e.invalidate=function(){return this._initted=this._act=0,this._zTime=-tr,this},e.isActive=function(){var r=this.parent||this._dp,o=this._start,n;return!!(!r||this._ts&&this._initted&&r.isActive()&&(n=r.rawTime(!0))>=o&&n<this.endTime(!0)-tr)},e.eventCallback=function(r,o,n){var s=this.vars;return arguments.length>1?(o?(s[r]=o,n&&(s[r+"Params"]=n),r==="onUpdate"&&(this._onUpdate=o)):delete s[r],this):s[r]},e.then=function(r){var o=this;return new Promise(function(n){var s=no(r)?r:TN,a=function(){var l=o.then;o.then=null,no(s)&&(s=s(o))&&(s.then||s===o)&&(o.then=l),n(s),o.then=l};o._initted&&o.totalProgress()===1&&o._ts>=0||!o._tTime&&o._ts<0?a():o._prom=a})},e.kill=function(){td(this)},i}();on(sd.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-tr,_prom:0,_ps:!1,_rts:1});var ko=function(i){pN(e,i);function e(r,o){var n;return r===void 0&&(r={}),n=i.call(this,r)||this,n.labels={},n.smoothChildTiming=!!r.smoothChildTiming,n.autoRemoveChildren=!!r.autoRemoveChildren,n._sort=ui(r.sortChildren),xr&&bs(r.parent||xr,r0(n),o),r.reversed&&n.reverse(),r.paused&&n.paused(!0),r.scrollTrigger&&EN(r0(n),r.scrollTrigger),n}var t=e.prototype;return t.to=function(o,n,s){return id(0,arguments,this),this},t.from=function(o,n,s){return id(1,arguments,this),this},t.fromTo=function(o,n,s,a){return id(2,arguments,this),this},t.set=function(o,n,s){return n.duration=0,n.parent=this,od(n).repeatDelay||(n.repeat=0),n.immediateRender=!!n.immediateRender,new Yr(o,n,en(this,s),1),this},t.call=function(o,n,s){return bs(this,Yr.delayedCall(0,o,n),s)},t.staggerTo=function(o,n,s,a,c,l,u){return s.duration=n,s.stagger=s.stagger||a,s.onComplete=l,s.onCompleteParams=u,s.parent=this,new Yr(o,s,en(this,c)),this},t.staggerFrom=function(o,n,s,a,c,l,u){return s.runBackwards=1,od(s).immediateRender=ui(s.immediateRender),this.staggerTo(o,n,s,a,c,l,u)},t.staggerFromTo=function(o,n,s,a,c,l,u,p){return a.startAt=s,od(a).immediateRender=ui(a.immediateRender),this.staggerTo(o,n,a,c,l,u,p)},t.render=function(o,n,s){var a=this._time,c=this._dirty?this.totalDuration():this._tDur,l=this._dur,u=o<=0?0:Do(o),p=this._zTime<0!=o<0&&(this._initted||!l),h,d,m,f,x,_,g,T,b,y,A,E;if(this!==xr&&u>c&&o>=0&&(u=c),u!==this._tTime||s||p){if(a!==this._time&&l&&(u+=this._time-a,o+=this._time-a),h=u,b=this._start,T=this._ts,_=!T,p&&(l||(a=this._zTime),(o||!n)&&(this._zTime=o)),this._repeat){if(A=this._yoyo,x=l+this._rDelay,this._repeat<-1&&o<0)return this.totalTime(x*100+o,n,s);if(h=Do(u%x),u===c?(f=this._repeat,h=l):(f=~~(u/x),f&&f===u/x&&(h=l,f--),h>l&&(h=l)),y=Pu(this._tTime,x),!a&&this._tTime&&y!==f&&(y=f),A&&f&1&&(h=l-h,E=1),f!==y&&!this._lock){var S=A&&y&1,M=S===(A&&f&1);if(f<y&&(S=!S),a=S?0:l,this._lock=1,this.render(a||(E?0:Do(f*x)),n,!l)._lock=0,this._tTime=u,!n&&this.parent&&rn(this,"onRepeat"),this.vars.repeatRefresh&&!E&&(this.invalidate()._lock=1),a&&a!==this._time||_!==!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(l=this._dur,c=this._tDur,M&&(this._lock=2,a=S?l:-1e-4,this.render(a,!0),this.vars.repeatRefresh&&!E&&this.invalidate()),this._lock=0,!this._ts&&!_)return this;BN(this,E)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(g=LK(this,Do(a),Do(h)),g&&(u-=h-(h=g._start))),this._tTime=u,this._time=h,this._act=!T,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=o,a=0),!a&&h&&!n&&(rn(this,"onStart"),this._tTime!==u))return this;if(h>=a&&o>=0)for(d=this._first;d;){if(m=d._next,(d._act||h>=d._start)&&d._ts&&g!==d){if(d.parent!==this)return this.render(o,n,s);if(d.render(d._ts>0?(h-d._start)*d._ts:(d._dirty?d.totalDuration():d._tDur)+(h-d._start)*d._ts,n,s),h!==this._time||!this._ts&&!_){g=0,m&&(u+=this._zTime=-tr);break}}d=m}else{d=this._last;for(var L=o<0?o:h;d;){if(m=d._prev,(d._act||L<=d._end)&&d._ts&&g!==d){if(d.parent!==this)return this.render(o,n,s);if(d.render(d._ts>0?(L-d._start)*d._ts:(d._dirty?d.totalDuration():d._tDur)+(L-d._start)*d._ts,n,s),h!==this._time||!this._ts&&!_){g=0,m&&(u+=this._zTime=L?-tr:tr);break}}d=m}}if(g&&!n&&(this.pause(),g.render(h>=a?0:-tr)._zTime=h>=a?1:-1,this._ts))return this._start=b,i_(this),this.render(o,n,s);this._onUpdate&&!n&&rn(this,"onUpdate",!0),(u===c&&c>=this.totalDuration()||!u&&a)&&(b===this._start||Math.abs(T)!==Math.abs(this._ts))&&(this._lock||((o||!l)&&(u===c&&this._ts>0||!u&&this._ts<0)&&ea(this,1),!n&&!(o<0&&!a)&&(u||a||!c)&&(rn(this,u===c&&o>=0?"onComplete":"onReverseComplete",!0),this._prom&&!(u<c&&this.timeScale()>0)&&this._prom())))}return this},t.add=function(o,n){var s=this;if(i0(n)||(n=en(this,n,o)),!(o instanceof sd)){if(Li(o))return o.forEach(function(a){return s.add(a,n)}),this;if(so(o))return this.addLabel(o,n);if(no(o))o=Yr.delayedCall(0,o);else return this}return this!==o?bs(this,o,n):this},t.getChildren=function(o,n,s,a){o===void 0&&(o=!0),n===void 0&&(n=!0),s===void 0&&(s=!0),a===void 0&&(a=-Ts);for(var c=[],l=this._first;l;)l._start>=a&&(l instanceof Yr?n&&c.push(l):(s&&c.push(l),o&&c.push.apply(c,l.getChildren(!0,n,s)))),l=l._next;return c},t.getById=function(o){for(var n=this.getChildren(1,1,1),s=n.length;s--;)if(n[s].vars.id===o)return n[s]},t.remove=function(o){return so(o)?this.removeLabel(o):no(o)?this.killTweensOf(o):(o_(this,o),o===this._recent&&(this._recent=this._last),xc(this))},t.totalTime=function(o,n){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=Do(Ri.time-(this._ts>0?o/this._ts:(this.totalDuration()-o)/-this._ts))),i.prototype.totalTime.call(this,o,n),this._forcing=0,this):this._tTime},t.addLabel=function(o,n){return this.labels[o]=en(this,n),this},t.removeLabel=function(o){return delete this.labels[o],this},t.addPause=function(o,n,s){var a=Yr.delayedCall(0,n||Nu,s);return a.data="isPause",this._hasPause=1,bs(this,a,en(this,o))},t.removePause=function(o){var n=this._first;for(o=en(this,o);n;)n._start===o&&n.data==="isPause"&&ea(n),n=n._next},t.killTweensOf=function(o,n,s){for(var a=this.getTweensOf(o,s),c=a.length;c--;)J0!==a[c]&&a[c].kill(o,n);return this},t.getTweensOf=function(o,n){for(var s=[],a=tn(o),c=this._first,l=i0(n),u;c;)c instanceof Yr?EK(c._targets,a)&&(l?(!J0||c._initted&&c._ts)&&c.globalTime(0)<=n&&c.globalTime(c.totalDuration())>n:!n||c.isActive())&&s.push(c):(u=c.getTweensOf(a,n)).length&&s.push.apply(s,u),c=c._next;return s},t.tweenTo=function(o,n){n=n||{};var s=this,a=en(s,o),c=n,l=c.startAt,u=c.onStart,p=c.onStartParams,h=c.immediateRender,d,m=Yr.to(s,on({ease:n.ease||"none",lazy:!1,immediateRender:!1,time:a,overwrite:"auto",duration:n.duration||Math.abs((a-(l&&"time"in l?l.time:s._time))/s.timeScale())||tr,onStart:function(){if(s.pause(),!d){var x=n.duration||Math.abs((a-(l&&"time"in l?l.time:s._time))/s.timeScale());m._dur!==x&&Ru(m,x,0,1).render(m._time,!0,!0),d=1}u&&u.apply(m,p||[])}},n));return h?m.render(0):m},t.tweenFromTo=function(o,n,s){return this.tweenTo(n,on({startAt:{time:en(this,o)}},s))},t.recent=function(){return this._recent},t.nextLabel=function(o){return o===void 0&&(o=this._time),lN(this,en(this,o))},t.previousLabel=function(o){return o===void 0&&(o=this._time),lN(this,en(this,o),1)},t.currentLabel=function(o){return arguments.length?this.seek(o,!0):this.previousLabel(this._time+tr)},t.shiftChildren=function(o,n,s){s===void 0&&(s=0);for(var a=this._first,c=this.labels,l;a;)a._start>=s&&(a._start+=o,a._end+=o),a=a._next;if(n)for(l in c)c[l]>=s&&(c[l]+=o);return xc(this)},t.invalidate=function(){var o=this._first;for(this._lock=0;o;)o.invalidate(),o=o._next;return i.prototype.invalidate.call(this)},t.clear=function(o){o===void 0&&(o=!0);for(var n=this._first,s;n;)s=n._next,this.remove(n),n=s;return this._dp&&(this._time=this._tTime=this._pTime=0),o&&(this.labels={}),xc(this)},t.totalDuration=function(o){var n=0,s=this,a=s._last,c=Ts,l,u,p;if(arguments.length)return s.timeScale((s._repeat<0?s.duration():s.totalDuration())/(s.reversed()?-o:o));if(s._dirty){for(p=s.parent;a;)l=a._prev,a._dirty&&a.totalDuration(),u=a._start,u>c&&s._sort&&a._ts&&!s._lock?(s._lock=1,bs(s,a,u-a._delay,1)._lock=0):c=u,u<0&&a._ts&&(n-=u,(!p&&!s._dp||p&&p.smoothChildTiming)&&(s._start+=u/s._ts,s._time-=u,s._tTime-=u),s.shiftChildren(-u,!1,-1/0),c=0),a._end>n&&a._ts&&(n=a._end),a=l;Ru(s,s===xr&&s._time>n?s._time:n,1,1),s._dirty=0}return s._tDur},e.updateRoot=function(o){if(xr._ts&&(yN(xr,Z1(o,xr)),xN=Ri.frame),Ri.frame>=nN){nN+=qo.autoSleep||120;var n=xr._first;if((!n||!n._ts)&&qo.autoSleep&&Ri._listeners.length<2){for(;n&&!n._ts;)n=n._next;n||Ri.sleep()}}},e}(sd);on(ko.prototype,{_lock:0,_hasPause:0,_forcing:0});var JK=function(e,t,r,o,n,s,a){var c=new Xo(this._pt,e,t,0,1,m6,null,n),l=0,u=0,p,h,d,m,f,x,_,g;for(c.b=r,c.e=o,r+="",o+="",(_=~o.indexOf("random("))&&(o=Iu(o)),s&&(g=[r,o],s(g,e,t),r=g[0],o=g[1]),h=r.match(z8)||[];p=z8.exec(o);)m=p[0],f=o.substring(l,p.index),d?d=(d+1)%5:f.substr(-5)==="rgba("&&(d=1),m!==h[u++]&&(x=parseFloat(h[u-1])||0,c._pt={_next:c._pt,p:f||u===1?f:",",s:x,c:m.charAt(1)==="="?parseFloat(m.substr(2))*(m.charAt(0)==="-"?-1:1):parseFloat(m)-x,m:d&&d<4?Math.round:0},l=z8.lastIndex);return c.c=l<o.length?o.substring(l,o.length):"",c.fp=a,(i6.test(o)||_)&&(c.e=0),this._pt=c,c},h6=function(e,t,r,o,n,s,a,c,l){no(o)&&(o=o(n||0,e,s));var u=e[t],p=r!=="get"?r:no(u)?l?e[t.indexOf("set")||!no(e["get"+t.substr(3)])?t:"get"+t.substr(3)](l):e[t]():u,h=no(u)?l?rJ:VN:f6,d;if(so(o)&&(~o.indexOf("random(")&&(o=Iu(o)),o.charAt(1)==="="&&(d=parseFloat(p)+parseFloat(o.substr(2))*(o.charAt(0)==="-"?-1:1)+(hi(p)||0),(d||d===0)&&(o=d))),p!==o)return!isNaN(p*o)&&o!==""?(d=new Xo(this._pt,e,t,+p||0,o-(p||0),typeof u=="boolean"?iJ:GN,0,h),l&&(d.fp=l),a&&d.modifier(a,this,e),this._pt=d):(!u&&!(t in e)&&r_(t,o),JK.call(this,e,t,p,o,h,c||qo.stringFilter,l))},ZK=function(e,t,r,o,n){if(no(e)&&(e=nd(e,n,t,r,o)),!n0(e)||e.style&&e.nodeType||Li(e)||fN(e))return so(e)?nd(e,n,t,r,o):e;var s={},a;for(a in e)s[a]=nd(e[a],n,t,r,o);return s},d6=function(e,t,r,o,n,s){var a,c,l,u;if(li[e]&&(a=new li[e]).init(n,a.rawVars?t[e]:ZK(t[e],o,n,s,r),r,o,s)!==!1&&(r._pt=c=new Xo(r._pt,n,e,0,1,a.render,a,0,a.priority),r!==Su))for(l=r._ptLookup[r._targets.indexOf(n)],u=a._props.length;u--;)l[a._props[u]]=c;return a},J0,QK=function i(e,t){var r=e.vars,o=r.ease,n=r.startAt,s=r.immediateRender,a=r.lazy,c=r.onUpdate,l=r.onUpdateParams,u=r.callbackScope,p=r.runBackwards,h=r.yoyoEase,d=r.keyframes,m=r.autoRevert,f=e._dur,x=e._startAt,_=e._targets,g=e.parent,T=g&&g.data==="nested"?g.parent._targets:_,b=e._overwrite==="auto"&&!r6,y=e.timeline,A,E,S,M,L,C,N,D,k,z,F,X,$;if(y&&(!d||!o)&&(o="none"),e._ease=wu(o,Mu.ease),e._yEase=h?kN(wu(h===!0?o:h,Mu.ease)):0,h&&e._yoyo&&!e._repeat&&(h=e._yEase,e._yEase=e._ease,e._ease=h),e._from=!y&&!!r.runBackwards,!y){if(D=_[0]?Q0(_[0]).harness:0,X=D&&r[D.prop],A=Z8(r,s6),x&&x.render(-1,!0).kill(),n)if(ea(e._startAt=Yr.set(_,on({data:"isStart",overwrite:!1,parent:g,immediateRender:!0,lazy:ui(a),startAt:null,delay:0,onUpdate:c,onUpdateParams:l,callbackScope:u,stagger:0},n))),t<0&&!s&&!m&&e._startAt.render(-1,!0),s){if(t>0&&!m&&(e._startAt=0),f&&t<=0){t&&(e._zTime=t);return}}else m===!1&&(e._startAt=0);else if(p&&f){if(x)!m&&(e._startAt=0);else if(t&&(s=!1),S=on({overwrite:!1,data:"isFromStart",lazy:s&&ui(a),immediateRender:s,stagger:0,parent:g},A),X&&(S[D.prop]=X),ea(e._startAt=Yr.set(_,S)),t<0&&e._startAt.render(-1,!0),!s)i(e._startAt,tr);else if(!t)return}for(e._pt=0,a=f&&ui(a)||a&&!f,E=0;E<_.length;E++){if(L=_[E],N=L._gsap||c6(_)[E]._gsap,e._ptLookup[E]=z={},J8[N.id]&&Z0.length&&J1(),F=T===_?E:T.indexOf(L),D&&(k=new D).init(L,X||A,e,F,T)!==!1&&(e._pt=M=new Xo(e._pt,L,k.name,0,1,k.render,k,0,k.priority),k._props.forEach(function(Y){z[Y]=M}),k.priority&&(C=1)),!D||X)for(S in A)li[S]&&(k=d6(S,A,e,F,L,T))?k.priority&&(C=1):z[S]=M=h6.call(e,L,S,"get",A[S],F,T,0,r.stringFilter);e._op&&e._op[E]&&e.kill(L,e._op[E]),b&&e._pt&&(J0=e,xr.killTweensOf(L,z,e.globalTime(t)),$=!e.parent,J0=0),e._pt&&a&&(J8[N.id]=1)}C&&g6(e),e._onInit&&e._onInit(e)}e._onUpdate=c,e._initted=(!e._op||e._pt)&&!$},eJ=function(e,t){var r=e[0]?Q0(e[0]).harness:0,o=r&&r.aliases,n,s,a,c;if(!o)return t;n=Ou({},t);for(s in o)if(s in n)for(c=o[s].split(","),a=c.length;a--;)n[c[a]]=n[s];return n},nd=function(e,t,r,o,n){return no(e)?e.call(t,r,o,n):so(e)&&~e.indexOf("random(")?Iu(e):e},UN=a6+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase",tJ=(UN+",id,stagger,delay,duration,paused,scrollTrigger").split(","),Yr=function(i){pN(e,i);function e(r,o,n,s){var a;typeof o=="number"&&(n.duration=o,o=n,n=null),a=i.call(this,s?o:od(o))||this;var c=a.vars,l=c.duration,u=c.delay,p=c.immediateRender,h=c.stagger,d=c.overwrite,m=c.keyframes,f=c.defaults,x=c.scrollTrigger,_=c.yoyoEase,g=o.parent||xr,T=(Li(r)||fN(r)?i0(r[0]):"length"in o)?[r]:tn(r),b,y,A,E,S,M,L,C;if(a._targets=T.length?c6(T):K1("GSAP target "+r+" not found. https://greensock.com",!qo.nullTargetWarn)||[],a._ptLookup=[],a._overwrite=d,m||h||iN(l)||iN(u)){if(o=a.vars,b=a.timeline=new ko({data:"nested",defaults:f||{}}),b.kill(),b.parent=b._dp=r0(a),b._start=0,m)od(on(b.vars.defaults,{ease:"none"})),h?T.forEach(function(N,D){return m.forEach(function(k,z){return b.to(N,k,z?">":D*h)})}):m.forEach(function(N){return b.to(T,N,">")});else{if(E=T.length,L=h?NN(h):Nu,n0(h))for(S in h)~UN.indexOf(S)&&(C||(C={}),C[S]=h[S]);for(y=0;y<E;y++){A={};for(S in o)tJ.indexOf(S)<0&&(A[S]=o[S]);A.stagger=0,_&&(A.yoyoEase=_),C&&Ou(A,C),M=T[y],A.duration=+nd(l,r0(a),y,M,T),A.delay=(+nd(u,r0(a),y,M,T)||0)-a._delay,!h&&E===1&&A.delay&&(a._delay=u=A.delay,a._start+=u,A.delay=0),b.to(M,A,L(y,M,T))}b.duration()?l=u=0:a.timeline=0}l||a.duration(l=b.duration())}else a.timeline=0;return d===!0&&!r6&&(J0=r0(a),xr.killTweensOf(T),J0=0),bs(g,r0(a),n),o.reversed&&a.reverse(),o.paused&&a.paused(!0),(p||!l&&!m&&a._start===Do(g._time)&&ui(p)&&OK(r0(a))&&g.data!=="nested")&&(a._tTime=-tr,a.render(Math.max(0,-u))),x&&EN(r0(a),x),a}var t=e.prototype;return t.render=function(o,n,s){var a=this._time,c=this._tDur,l=this._dur,u=o>c-tr&&o>=0?c:o<tr?0:o,p,h,d,m,f,x,_,g,T;if(!l)RK(this,o,n,s);else if(u!==this._tTime||!o||s||!this._initted&&this._tTime||this._startAt&&this._zTime<0!=o<0){if(p=u,g=this.timeline,this._repeat){if(m=l+this._rDelay,this._repeat<-1&&o<0)return this.totalTime(m*100+o,n,s);if(p=Do(u%m),u===c?(d=this._repeat,p=l):(d=~~(u/m),d&&d===u/m&&(p=l,d--),p>l&&(p=l)),x=this._yoyo&&d&1,x&&(T=this._yEase,p=l-p),f=Pu(this._tTime,m),p===a&&!s&&this._initted)return this;d!==f&&(g&&this._yEase&&BN(g,x),this.vars.repeatRefresh&&!x&&!this._lock&&(this._lock=s=1,this.render(Do(m*d),!0).invalidate()._lock=0))}if(!this._initted){if(SN(this,o<0?o:p,s,n))return this._tTime=0,this;if(l!==this._dur)return this.render(o,n,s)}if(this._tTime=u,this._time=p,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=_=(T||this._ease)(p/l),this._from&&(this.ratio=_=1-_),p&&!a&&!n&&(rn(this,"onStart"),this._tTime!==u))return this;for(h=this._pt;h;)h.r(_,h.d),h=h._next;g&&g.render(o<0?o:!p&&x?-tr:g._dur*_,n,s)||this._startAt&&(this._zTime=o),this._onUpdate&&!n&&(o<0&&this._startAt&&this._startAt.render(o,!0,s),rn(this,"onUpdate")),this._repeat&&d!==f&&this.vars.onRepeat&&!n&&this.parent&&rn(this,"onRepeat"),(u===this._tDur||!u)&&this._tTime===u&&(o<0&&this._startAt&&!this._onUpdate&&this._startAt.render(o,!0,!0),(o||!l)&&(u===this._tDur&&this._ts>0||!u&&this._ts<0)&&ea(this,1),!n&&!(o<0&&!a)&&(u||a)&&(rn(this,u===c?"onComplete":"onReverseComplete",!0),this._prom&&!(u<c&&this.timeScale()>0)&&this._prom()))}return this},t.targets=function(){return this._targets},t.invalidate=function(){return this._pt=this._op=this._startAt=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(),i.prototype.invalidate.call(this)},t.kill=function(o,n){if(n===void 0&&(n="all"),!o&&(!n||n==="all"))return this._lazy=this._pt=0,this.parent?td(this):this;if(this.timeline){var s=this.timeline.totalDuration();return this.timeline.killTweensOf(o,n,J0&&J0.vars.overwrite!==!0)._first||td(this),this.parent&&s!==this.timeline.totalDuration()&&Ru(this,this._dur*this.timeline._tDur/s,0,1),this}var a=this._targets,c=o?tn(o):a,l=this._ptLookup,u=this._pt,p,h,d,m,f,x,_;if((!n||n==="all")&&wK(a,c))return n==="all"&&(this._pt=0),td(this);for(p=this._op=this._op||[],n!=="all"&&(so(n)&&(f={},pi(n,function(g){return f[g]=1}),n=f),n=eJ(a,n)),_=a.length;_--;)if(~c.indexOf(a[_])){h=l[_],n==="all"?(p[_]=n,m=h,d={}):(d=p[_]=p[_]||{},m=n);for(f in m)x=h&&h[f],x&&((!("kill"in x.d)||x.d.kill(f)===!0)&&o_(this,x,"_pt"),delete h[f]),d!=="all"&&(d[f]=1)}return this._initted&&!this._pt&&u&&td(this),this},e.to=function(o,n){return new e(o,n,arguments[2])},e.from=function(o,n){return id(1,arguments)},e.delayedCall=function(o,n,s,a){return new e(n,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:o,onComplete:n,onReverseComplete:n,onCompleteParams:s,onReverseCompleteParams:s,callbackScope:a})},e.fromTo=function(o,n,s){return id(2,arguments)},e.set=function(o,n){return n.duration=0,n.repeatDelay||(n.repeat=0),new e(o,n)},e.killTweensOf=function(o,n,s){return xr.killTweensOf(o,n,s)},e}(sd);on(Yr.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0});pi("staggerTo,staggerFrom,staggerFromTo",function(i){Yr[i]=function(){var e=new ko,t=e6.call(arguments,0);return t.splice(i==="staggerFromTo"?5:4,0,0),e[i].apply(e,t)}});var f6=function(e,t,r){return e[t]=r},VN=function(e,t,r){return e[t](r)},rJ=function(e,t,r,o){return e[t](o.fp,r)},oJ=function(e,t,r){return e.setAttribute(t,r)},n_=function(e,t){return no(e[t])?VN:t_(e[t])&&e.setAttribute?oJ:f6},GN=function(e,t){return t.set(t.t,t.p,Math.round((t.s+t.c*e)*1e6)/1e6,t)},iJ=function(e,t){return t.set(t.t,t.p,!!(t.s+t.c*e),t)},m6=function(e,t){var r=t._pt,o="";if(!e&&t.b)o=t.b;else if(e===1&&t.e)o=t.e;else{for(;r;)o=r.p+(r.m?r.m(r.s+r.c*e):Math.round((r.s+r.c*e)*1e4)/1e4)+o,r=r._next;o+=t.c}t.set(t.t,t.p,o,t)},_6=function(e,t){for(var r=t._pt;r;)r.r(e,r.d),r=r._next},nJ=function(e,t,r,o){for(var n=this._pt,s;n;)s=n._next,n.p===o&&n.modifier(e,t,r),n=s},sJ=function(e){for(var t=this._pt,r,o;t;)o=t._next,t.p===e&&!t.op||t.op===e?o_(this,t,"_pt"):t.dep||(r=1),t=o;return!r},aJ=function(e,t,r,o){o.mSet(e,t,o.m.call(o.tween,r,o.mt),o)},g6=function(e){for(var t=e._pt,r,o,n,s;t;){for(r=t._next,o=n;o&&o.pr>t.pr;)o=o._next;(t._prev=o?o._prev:s)?t._prev._next=t:n=t,(t._next=o)?o._prev=t:s=t,t=r}e._pt=n},Xo=function(){function i(t,r,o,n,s,a,c,l,u){this.t=r,this.s=n,this.c=s,this.p=o,this.r=a||GN,this.d=c||this,this.set=l||f6,this.pr=u||0,this._next=t,t&&(t._prev=this)}var e=i.prototype;return e.modifier=function(r,o,n){this.mSet=this.mSet||this.set,this.set=aJ,this.m=r,this.mt=n,this.tween=o},i}();pi(a6+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",function(i){return s6[i]=1});Ii.TweenMax=Ii.TweenLite=Yr;Ii.TimelineLite=Ii.TimelineMax=ko;xr=new ko({sortChildren:!1,defaults:Mu,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0});qo.stringFilter=u6;var e_={registerPlugin:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];t.forEach(function(o){return jK(o)})},timeline:function(e){return new ko(e)},getTweensOf:function(e,t){return xr.getTweensOf(e,t)},getProperty:function(e,t,r,o){so(e)&&(e=tn(e)[0]);var n=Q0(e||{}).get,s=r?TN:bN;return r==="native"&&(r=""),e&&(t?s((li[t]&&li[t].get||n)(e,t,r,o)):function(a,c,l){return s((li[a]&&li[a].get||n)(e,a,c,l))})},quickSetter:function(e,t,r){if(e=tn(e),e.length>1){var o=e.map(function(u){return nn.quickSetter(u,t,r)}),n=o.length;return function(u){for(var p=n;p--;)o[p](u)}}e=e[0]||{};var s=li[t],a=Q0(e),c=a.harness&&(a.harness.aliases||{})[t]||t,l=s?function(u){var p=new s;Su._pt=0,p.init(e,r?u+r:u,Su,0,[e]),p.render(1,p),Su._pt&&_6(1,Su)}:a.set(e,c);return s?l:function(u){return l(e,c,r?u+r:u,a,1)}},isTweening:function(e){return xr.getTweensOf(e,!0).length>0},defaults:function(e){return e&&e.ease&&(e.ease=wu(e.ease,Mu.ease)),sN(Mu,e||{})},config:function(e){return sN(qo,e||{})},registerEffect:function(e){var t=e.name,r=e.effect,o=e.plugins,n=e.defaults,s=e.extendTimeline;(o||"").split(",").forEach(function(a){return a&&!li[a]&&!Ii[a]&&K1(t+" effect requires "+a+" plugin.")}),H8[t]=function(a,c,l){return r(tn(a),on(c||{},n),l)},s&&(ko.prototype[t]=function(a,c,l){return this.add(H8[t](a,n0(c)?c:(l=c)&&{},this),l)})},registerEase:function(e,t){Ct[e]=wu(t)},parseEase:function(e,t){return arguments.length?wu(e,t):Ct},getById:function(e){return xr.getById(e)},exportRoot:function(e,t){e===void 0&&(e={});var r=new ko(e),o,n;for(r.smoothChildTiming=ui(e.smoothChildTiming),xr.remove(r),r._dp=0,r._time=r._tTime=xr._time,o=xr._first;o;)n=o._next,(t||!(!o._dur&&o instanceof Yr&&o.vars.onComplete===o._targets[0]))&&bs(r,o,o._start-o._delay),o=n;return bs(xr,r,0),r},utils:{wrap:GK,wrapYoyo:zK,distribute:NN,random:PN,snap:ON,normalize:VK,getUnit:hi,clamp:DK,splitColor:IN,toArray:tn,selector:BK,mapRange:LN,pipe:FK,unitize:UK,interpolate:HK,shuffle:MN},install:gN,effects:H8,ticker:Ri,updateRoot:ko.updateRoot,plugins:li,globalTimeline:xr,core:{PropTween:Xo,globals:vN,Tween:Yr,Timeline:ko,Animation:sd,getCache:Q0,_removeLinkedListItem:o_,suppressOverwrites:function(e){return r6=e}}};pi("to,from,fromTo,delayedCall,set,killTweensOf",function(i){return e_[i]=Yr[i]});Ri.add(ko.updateRoot);Su=e_.to({},{duration:0});var cJ=function(e,t){for(var r=e._pt;r&&r.p!==t&&r.op!==t&&r.fp!==t;)r=r._next;return r},lJ=function(e,t){var r=e._targets,o,n,s;for(o in t)for(n=r.length;n--;)s=e._ptLookup[n][o],s&&(s=s.d)&&(s._pt&&(s=cJ(s,o)),s&&s.modifier&&s.modifier(t[o],e,r[n],o))},X8=function(e,t){return{name:e,rawVars:1,init:function(o,n,s){s._onInit=function(a){var c,l;if(so(n)&&(c={},pi(n,function(u){return c[u]=1}),n=c),t){c={};for(l in n)c[l]=t(n[l]);n=c}lJ(a,n)}}}},nn=e_.registerPlugin({name:"attr",init:function(e,t,r,o,n){var s,a;for(s in t)a=this.add(e,"setAttribute",(e.getAttribute(s)||0)+"",t[s],o,n,0,0,s),a&&(a.op=s),this._props.push(s)}},{name:"endArray",init:function(e,t){for(var r=t.length;r--;)this.add(e,r,e[r]||0,t[r])}},X8("roundProps",t6),X8("modifiers"),X8("snap",ON))||e_;Yr.version=ko.version=nn.version="3.8.0";_N=1;dN()&&Lu();var uJ=Ct.Power0,pJ=Ct.Power1,hJ=Ct.Power2,dJ=Ct.Power3,fJ=Ct.Power4,mJ=Ct.Linear,_J=Ct.Quad,gJ=Ct.Cubic,vJ=Ct.Quart,xJ=Ct.Quint,yJ=Ct.Strong,bJ=Ct.Elastic,TJ=Ct.Back,AJ=Ct.SteppedEase,CJ=Ct.Bounce,EJ=Ct.Sine,SJ=Ct.Expo,wJ=Ct.Circ;var zN,ra,Bu,A6,Ec,MJ,HN,NJ=function(){return typeof window<"u"},na={},Cc=180/Math.PI,Fu=Math.PI/180,Du=Math.atan2,jN=1e8,JN=/([A-Z])/g,OJ=/(?:left|right|width|margin|padding|x)/i,PJ=/[\s,\(]\S/,oa={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},ZN=function(e,t){return t.set(t.t,t.p,Math.round((t.s+t.c*e)*1e4)/1e4+t.u,t)},RJ=function(e,t){return t.set(t.t,t.p,e===1?t.e:Math.round((t.s+t.c*e)*1e4)/1e4+t.u,t)},LJ=function(e,t){return t.set(t.t,t.p,e?Math.round((t.s+t.c*e)*1e4)/1e4+t.u:t.b,t)},IJ=function(e,t){var r=t.s+t.c*e;t.set(t.t,t.p,~~(r+(r<0?-.5:.5))+t.u,t)},QN=function(e,t){return t.set(t.t,t.p,e?t.e:t.b,t)},eO=function(e,t){return t.set(t.t,t.p,e!==1?t.b:t.e,t)},DJ=function(e,t,r){return e.style[t]=r},kJ=function(e,t,r){return e.style.setProperty(t,r)},BJ=function(e,t,r){return e._gsap[t]=r},FJ=function(e,t,r){return e._gsap.scaleX=e._gsap.scaleY=r},UJ=function(e,t,r,o,n){var s=e._gsap;s.scaleX=s.scaleY=r,s.renderTransform(n,s)},VJ=function(e,t,r,o,n){var s=e._gsap;s[t]=r,s.renderTransform(n,s)},vo="transform",sa=vo+"Origin",tO,y6=function(e,t){var r=ra.createElementNS?ra.createElementNS((t||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),e):ra.createElement(e);return r.style?r:ra.createElement(e)},s0=function i(e,t,r){var o=getComputedStyle(e);return o[t]||o.getPropertyValue(t.replace(JN,"-$1").toLowerCase())||o.getPropertyValue(t)||!r&&i(e,Uu(t)||t,1)||""},WN="O,Moz,ms,Ms,Webkit".split(","),Uu=function(e,t,r){var o=t||Ec,n=o.style,s=5;if(e in n&&!r)return e;for(e=e.charAt(0).toUpperCase()+e.substr(1);s--&&!(WN[s]+e in n););return s<0?null:(s===3?"ms":s>=0?WN[s]:"")+e},b6=function(){NJ()&&window.document&&(zN=window,ra=zN.document,Bu=ra.documentElement,Ec=y6("div")||{style:{}},MJ=y6("div"),vo=Uu(vo),sa=vo+"Origin",Ec.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",tO=!!Uu("perspective"),A6=1)},v6=function i(e){var t=y6("svg",this.ownerSVGElement&&this.ownerSVGElement.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),r=this.parentNode,o=this.nextSibling,n=this.style.cssText,s;if(Bu.appendChild(t),t.appendChild(this),this.style.display="block",e)try{s=this.getBBox(),this._gsapBBox=this.getBBox,this.getBBox=i}catch{}else this._gsapBBox&&(s=this._gsapBBox());return r&&(o?r.insertBefore(this,o):r.appendChild(this)),Bu.removeChild(t),this.style.cssText=n,s},qN=function(e,t){for(var r=t.length;r--;)if(e.hasAttribute(t[r]))return e.getAttribute(t[r])},rO=function(e){var t;try{t=e.getBBox()}catch{t=v6.call(e,!0)}return t&&(t.width||t.height)||e.getBBox===v6||(t=v6.call(e,!0)),t&&!t.width&&!t.x&&!t.y?{x:+qN(e,["x","cx","x1"])||0,y:+qN(e,["y","cy","y1"])||0,width:0,height:0}:t},oO=function(e){return!!(e.getCTM&&(!e.parentNode||e.ownerSVGElement)&&rO(e))},ld=function(e,t){if(t){var r=e.style;t in na&&t!==sa&&(t=vo),r.removeProperty?((t.substr(0,2)==="ms"||t.substr(0,6)==="webkit")&&(t="-"+t),r.removeProperty(t.replace(JN,"-$1").toLowerCase())):r.removeAttribute(t)}},ia=function(e,t,r,o,n,s){var a=new Xo(e._pt,t,r,0,1,s?eO:QN);return e._pt=a,a.b=o,a.e=n,e._props.push(r),a},XN={deg:1,rad:1,turn:1},aa=function i(e,t,r,o){var n=parseFloat(r)||0,s=(r+"").trim().substr((n+"").length)||"px",a=Ec.style,c=OJ.test(t),l=e.tagName.toLowerCase()==="svg",u=(l?"client":"offset")+(c?"Width":"Height"),p=100,h=o==="px",d=o==="%",m,f,x,_;return o===s||!n||XN[o]||XN[s]?n:(s!=="px"&&!h&&(n=i(e,t,r,"px")),_=e.getCTM&&oO(e),(d||s==="%")&&(na[t]||~t.indexOf("adius"))?(m=_?e.getBBox()[c?"width":"height"]:e[u],Pr(d?n/m*p:n/100*m)):(a[c?"width":"height"]=p+(h?s:o),f=~t.indexOf("adius")||o==="em"&&e.appendChild&&!l?e:e.parentNode,_&&(f=(e.ownerSVGElement||{}).parentNode),(!f||f===ra||!f.appendChild)&&(f=ra.body),x=f._gsap,x&&d&&x.width&&c&&x.time===Ri.time?Pr(n/x.width*p):((d||s==="%")&&(a.position=s0(e,"position")),f===e&&(a.position="static"),f.appendChild(Ec),m=Ec[u],f.removeChild(Ec),a.position="absolute",c&&d&&(x=Q0(f),x.time=Ri.time,x.width=f[u]),Pr(h?m*n/p:m&&n?p/m*n:0))))},ku=function(e,t,r,o){var n;return A6||b6(),t in oa&&t!=="transform"&&(t=oa[t],~t.indexOf(",")&&(t=t.split(",")[0])),na[t]&&t!=="transform"?(n=pd(e,o),n=t!=="transformOrigin"?n[t]:n.svg?n.origin:a_(s0(e,sa))+" "+n.zOrigin+"px"):(n=e.style[t],(!n||n==="auto"||o||~(n+"").indexOf("calc("))&&(n=s_[t]&&s_[t](e,t,r)||s0(e,t)||l6(e,t)||(t==="opacity"?1:0))),r&&!~(n+"").trim().indexOf(" ")?aa(e,t,n,r)+r:n},GJ=function(e,t,r,o){if(!r||r==="none"){var n=Uu(t,e,1),s=n&&s0(e,n,1);s&&s!==r?(t=n,r=s):t==="borderColor"&&(r=s0(e,"borderTopColor"))}var a=new Xo(this._pt,e.style,t,0,1,m6),c=0,l=0,u,p,h,d,m,f,x,_,g,T,b,y,A;if(a.b=r,a.e=o,r+="",o+="",o==="auto"&&(e.style[t]=o,o=s0(e,t)||o,e.style[t]=r),u=[r,o],u6(u),r=u[0],o=u[1],h=r.match(yc)||[],A=o.match(yc)||[],A.length){for(;p=yc.exec(o);)x=p[0],g=o.substring(c,p.index),m?m=(m+1)%5:(g.substr(-5)==="rgba("||g.substr(-5)==="hsla(")&&(m=1),x!==(f=h[l++]||"")&&(d=parseFloat(f)||0,b=f.substr((d+"").length),y=x.charAt(1)==="="?+(x.charAt(0)+"1"):0,y&&(x=x.substr(2)),_=parseFloat(x),T=x.substr((_+"").length),c=yc.lastIndex-T.length,T||(T=T||qo.units[t]||b,c===o.length&&(o+=T,a.e+=T)),b!==T&&(d=aa(e,t,f,T)||0),a._pt={_next:a._pt,p:g||l===1?g:",",s:d,c:y?y*_:_-d,m:m&&m<4||t==="zIndex"?Math.round:0});a.c=c<o.length?o.substring(c,o.length):""}else a.r=t==="display"&&o==="none"?eO:QN;return i6.test(o)&&(a.e=0),this._pt=a,a},YN={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},zJ=function(e){var t=e.split(" "),r=t[0],o=t[1]||"50%";return(r==="top"||r==="bottom"||o==="left"||o==="right")&&(e=r,r=o,o=e),t[0]=YN[r]||r,t[1]=YN[o]||o,t.join(" ")},HJ=function(e,t){if(t.tween&&t.tween._time===t.tween._dur){var r=t.t,o=r.style,n=t.u,s=r._gsap,a,c,l;if(n==="all"||n===!0)o.cssText="",c=1;else for(n=n.split(","),l=n.length;--l>-1;)a=n[l],na[a]&&(c=1,a=a==="transformOrigin"?sa:vo),ld(r,a);c&&(ld(r,vo),s&&(s.svg&&r.removeAttribute("transform"),pd(r,1),s.uncache=1))}},s_={clearProps:function(e,t,r,o,n){if(n.data!=="isFromStart"){var s=e._pt=new Xo(e._pt,t,r,0,0,HJ);return s.u=o,s.pr=-10,s.tween=n,e._props.push(r),1}}},ud=[1,0,0,1,0,0],iO={},nO=function(e){return e==="matrix(1, 0, 0, 1, 0, 0)"||e==="none"||!e},$N=function(e){var t=s0(e,vo);return nO(t)?ud:t.substr(7).match(o6).map(Pr)},C6=function(e,t){var r=e._gsap||Q0(e),o=e.style,n=$N(e),s,a,c,l;return r.svg&&e.getAttribute("transform")?(c=e.transform.baseVal.consolidate().matrix,n=[c.a,c.b,c.c,c.d,c.e,c.f],n.join(",")==="1,0,0,1,0,0"?ud:n):(n===ud&&!e.offsetParent&&e!==Bu&&!r.svg&&(c=o.display,o.display="block",s=e.parentNode,(!s||!e.offsetParent)&&(l=1,a=e.nextSibling,Bu.appendChild(e)),n=$N(e),c?o.display=c:ld(e,"display"),l&&(a?s.insertBefore(e,a):s?s.appendChild(e):Bu.removeChild(e))),t&&n.length>6?[n[0],n[1],n[4],n[5],n[12],n[13]]:n)},T6=function(e,t,r,o,n,s){var a=e._gsap,c=n||C6(e,!0),l=a.xOrigin||0,u=a.yOrigin||0,p=a.xOffset||0,h=a.yOffset||0,d=c[0],m=c[1],f=c[2],x=c[3],_=c[4],g=c[5],T=t.split(" "),b=parseFloat(T[0])||0,y=parseFloat(T[1])||0,A,E,S,M;r?c!==ud&&(E=d*x-m*f)&&(S=b*(x/E)+y*(-f/E)+(f*g-x*_)/E,M=b*(-m/E)+y*(d/E)-(d*g-m*_)/E,b=S,y=M):(A=rO(e),b=A.x+(~T[0].indexOf("%")?b/100*A.width:b),y=A.y+(~(T[1]||T[0]).indexOf("%")?y/100*A.height:y)),o||o!==!1&&a.smooth?(_=b-l,g=y-u,a.xOffset=p+(_*d+g*f)-_,a.yOffset=h+(_*m+g*x)-g):a.xOffset=a.yOffset=0,a.xOrigin=b,a.yOrigin=y,a.smooth=!!o,a.origin=t,a.originIsAbsolute=!!r,e.style[sa]="0px 0px",s&&(ia(s,a,"xOrigin",l,b),ia(s,a,"yOrigin",u,y),ia(s,a,"xOffset",p,a.xOffset),ia(s,a,"yOffset",h,a.yOffset)),e.setAttribute("data-svg-origin",b+" "+y)},pd=function(e,t){var r=e._gsap||new p6(e);if("x"in r&&!t&&!r.uncache)return r;var o=e.style,n=r.scaleX<0,s="px",a="deg",c=s0(e,sa)||"0",l,u,p,h,d,m,f,x,_,g,T,b,y,A,E,S,M,L,C,N,D,k,z,F,X,$,Y,H,B,te,q,j;return l=u=p=m=f=x=_=g=T=0,h=d=1,r.svg=!!(e.getCTM&&oO(e)),A=C6(e,r.svg),r.svg&&(F=(!r.uncache||c==="0px 0px")&&!t&&e.getAttribute("data-svg-origin"),T6(e,F||c,!!F||r.originIsAbsolute,r.smooth!==!1,A)),b=r.xOrigin||0,y=r.yOrigin||0,A!==ud&&(L=A[0],C=A[1],N=A[2],D=A[3],l=k=A[4],u=z=A[5],A.length===6?(h=Math.sqrt(L*L+C*C),d=Math.sqrt(D*D+N*N),m=L||C?Du(C,L)*Cc:0,_=N||D?Du(N,D)*Cc+m:0,_&&(d*=Math.abs(Math.cos(_*Fu))),r.svg&&(l-=b-(b*L+y*N),u-=y-(b*C+y*D))):(j=A[6],te=A[7],Y=A[8],H=A[9],B=A[10],q=A[11],l=A[12],u=A[13],p=A[14],E=Du(j,B),f=E*Cc,E&&(S=Math.cos(-E),M=Math.sin(-E),F=k*S+Y*M,X=z*S+H*M,$=j*S+B*M,Y=k*-M+Y*S,H=z*-M+H*S,B=j*-M+B*S,q=te*-M+q*S,k=F,z=X,j=$),E=Du(-N,B),x=E*Cc,E&&(S=Math.cos(-E),M=Math.sin(-E),F=L*S-Y*M,X=C*S-H*M,$=N*S-B*M,q=D*M+q*S,L=F,C=X,N=$),E=Du(C,L),m=E*Cc,E&&(S=Math.cos(E),M=Math.sin(E),F=L*S+C*M,X=k*S+z*M,C=C*S-L*M,z=z*S-k*M,L=F,k=X),f&&Math.abs(f)+Math.abs(m)>359.9&&(f=m=0,x=180-x),h=Pr(Math.sqrt(L*L+C*C+N*N)),d=Pr(Math.sqrt(z*z+j*j)),E=Du(k,z),_=Math.abs(E)>2e-4?E*Cc:0,T=q?1/(q<0?-q:q):0),r.svg&&(F=e.getAttribute("transform"),r.forceCSS=e.setAttribute("transform","")||!nO(s0(e,vo)),F&&e.setAttribute("transform",F))),Math.abs(_)>90&&Math.abs(_)<270&&(n?(h*=-1,_+=m<=0?180:-180,m+=m<=0?180:-180):(d*=-1,_+=_<=0?180:-180)),r.x=l-((r.xPercent=l&&(r.xPercent||(Math.round(e.offsetWidth/2)===Math.round(-l)?-50:0)))?e.offsetWidth*r.xPercent/100:0)+s,r.y=u-((r.yPercent=u&&(r.yPercent||(Math.round(e.offsetHeight/2)===Math.round(-u)?-50:0)))?e.offsetHeight*r.yPercent/100:0)+s,r.z=p+s,r.scaleX=Pr(h),r.scaleY=Pr(d),r.rotation=Pr(m)+a,r.rotationX=Pr(f)+a,r.rotationY=Pr(x)+a,r.skewX=_+a,r.skewY=g+a,r.transformPerspective=T+s,(r.zOrigin=parseFloat(c.split(" ")[2])||0)&&(o[sa]=a_(c)),r.xOffset=r.yOffset=0,r.force3D=qo.force3D,r.renderTransform=r.svg?WJ:tO?sO:jJ,r.uncache=0,r},a_=function(e){return(e=e.split(" "))[0]+" "+e[1]},x6=function(e,t,r){var o=hi(t);return Pr(parseFloat(t)+parseFloat(aa(e,"x",r+"px",o)))+o},jJ=function(e,t){t.z="0px",t.rotationY=t.rotationX="0deg",t.force3D=0,sO(e,t)},Tc="0deg",cd="0px",Ac=") ",sO=function(e,t){var r=t||this,o=r.xPercent,n=r.yPercent,s=r.x,a=r.y,c=r.z,l=r.rotation,u=r.rotationY,p=r.rotationX,h=r.skewX,d=r.skewY,m=r.scaleX,f=r.scaleY,x=r.transformPerspective,_=r.force3D,g=r.target,T=r.zOrigin,b="",y=_==="auto"&&e&&e!==1||_===!0;if(T&&(p!==Tc||u!==Tc)){var A=parseFloat(u)*Fu,E=Math.sin(A),S=Math.cos(A),M;A=parseFloat(p)*Fu,M=Math.cos(A),s=x6(g,s,E*M*-T),a=x6(g,a,-Math.sin(A)*-T),c=x6(g,c,S*M*-T+T)}x!==cd&&(b+="perspective("+x+Ac),(o||n)&&(b+="translate("+o+"%, "+n+"%) "),(y||s!==cd||a!==cd||c!==cd)&&(b+=c!==cd||y?"translate3d("+s+", "+a+", "+c+") ":"translate("+s+", "+a+Ac),l!==Tc&&(b+="rotate("+l+Ac),u!==Tc&&(b+="rotateY("+u+Ac),p!==Tc&&(b+="rotateX("+p+Ac),(h!==Tc||d!==Tc)&&(b+="skew("+h+", "+d+Ac),(m!==1||f!==1)&&(b+="scale("+m+", "+f+Ac),g.style[vo]=b||"translate(0, 0)"},WJ=function(e,t){var r=t||this,o=r.xPercent,n=r.yPercent,s=r.x,a=r.y,c=r.rotation,l=r.skewX,u=r.skewY,p=r.scaleX,h=r.scaleY,d=r.target,m=r.xOrigin,f=r.yOrigin,x=r.xOffset,_=r.yOffset,g=r.forceCSS,T=parseFloat(s),b=parseFloat(a),y,A,E,S,M;c=parseFloat(c),l=parseFloat(l),u=parseFloat(u),u&&(u=parseFloat(u),l+=u,c+=u),c||l?(c*=Fu,l*=Fu,y=Math.cos(c)*p,A=Math.sin(c)*p,E=Math.sin(c-l)*-h,S=Math.cos(c-l)*h,l&&(u*=Fu,M=Math.tan(l-u),M=Math.sqrt(1+M*M),E*=M,S*=M,u&&(M=Math.tan(u),M=Math.sqrt(1+M*M),y*=M,A*=M)),y=Pr(y),A=Pr(A),E=Pr(E),S=Pr(S)):(y=p,S=h,A=E=0),(T&&!~(s+"").indexOf("px")||b&&!~(a+"").indexOf("px"))&&(T=aa(d,"x",s,"px"),b=aa(d,"y",a,"px")),(m||f||x||_)&&(T=Pr(T+m-(m*y+f*E)+x),b=Pr(b+f-(m*A+f*S)+_)),(o||n)&&(M=d.getBBox(),T=Pr(T+o/100*M.width),b=Pr(b+n/100*M.height)),M="matrix("+y+","+A+","+E+","+S+","+T+","+b+")",d.setAttribute("transform",M),g&&(d.style[vo]=M)},qJ=function(e,t,r,o,n,s){var a=360,c=so(n),l=parseFloat(n)*(c&&~n.indexOf("rad")?Cc:1),u=s?l*s:l-o,p=o+u+"deg",h,d;return c&&(h=n.split("_")[1],h==="short"&&(u%=a,u!==u%(a/2)&&(u+=u<0?a:-a)),h==="cw"&&u<0?u=(u+a*jN)%a-~~(u/a)*a:h==="ccw"&&u>0&&(u=(u-a*jN)%a-~~(u/a)*a)),e._pt=d=new Xo(e._pt,t,r,o,u,RJ),d.e=p,d.u="deg",e._props.push(r),d},KN=function(e,t){for(var r in t)e[r]=t[r];return e},XJ=function(e,t,r){var o=KN({},r._gsap),n="perspective,force3D,transformOrigin,svgOrigin",s=r.style,a,c,l,u,p,h,d,m;o.svg?(l=r.getAttribute("transform"),r.setAttribute("transform",""),s[vo]=t,a=pd(r,1),ld(r,vo),r.setAttribute("transform",l)):(l=getComputedStyle(r)[vo],s[vo]=t,a=pd(r,1),s[vo]=l);for(c in na)l=o[c],u=a[c],l!==u&&n.indexOf(c)<0&&(d=hi(l),m=hi(u),p=d!==m?aa(r,c,l,m):parseFloat(l),h=parseFloat(u),e._pt=new Xo(e._pt,a,c,p,h-p,ZN),e._pt.u=m||0,e._props.push(c));KN(a,o)};pi("padding,margin,Width,Radius",function(i,e){var t="Top",r="Right",o="Bottom",n="Left",s=(e<3?[t,r,o,n]:[t+n,t+r,o+r,o+n]).map(function(a){return e<2?i+a:"border"+a+i});s_[e>1?"border"+i:i]=function(a,c,l,u,p){var h,d;if(arguments.length<4)return h=s.map(function(m){return ku(a,m,l)}),d=h.join(" "),d.split(h[0]).length===5?h[0]:d;h=(u+"").split(" "),d={},s.forEach(function(m,f){return d[m]=h[f]=h[f]||h[(f-1)/2|0]}),a.init(c,d,p)}});var E6={name:"css",register:b6,targetTest:function(e){return e.style&&e.nodeType},init:function(e,t,r,o,n){var s=this._props,a=e.style,c=r.vars.startAt,l,u,p,h,d,m,f,x,_,g,T,b,y,A,E;A6||b6();for(f in t)if(f!=="autoRound"&&(u=t[f],!(li[f]&&d6(f,t,r,o,e,n)))){if(d=typeof u,m=s_[f],d==="function"&&(u=u.call(r,o,e,n),d=typeof u),d==="string"&&~u.indexOf("random(")&&(u=Iu(u)),m)m(this,e,f,u,r)&&(E=1);else if(f.substr(0,2)==="--")l=(getComputedStyle(e).getPropertyValue(f)+"").trim(),u+="",o0.lastIndex=0,o0.test(l)||(x=hi(l),_=hi(u)),_?x!==_&&(l=aa(e,f,l,_)+_):x&&(u+=x),this.add(a,"setProperty",l,u,o,n,0,0,f),s.push(f);else if(d!=="undefined"){if(c&&f in c?(l=typeof c[f]=="function"?c[f].call(r,o,e,n):c[f],f in qo.units&&!hi(l)&&(l+=qo.units[f]),so(l)&&~l.indexOf("random(")&&(l=Iu(l)),(l+"").charAt(1)==="="&&(l=ku(e,f))):l=ku(e,f),h=parseFloat(l),g=d==="string"&&u.charAt(1)==="="?+(u.charAt(0)+"1"):0,g&&(u=u.substr(2)),p=parseFloat(u),f in oa&&(f==="autoAlpha"&&(h===1&&ku(e,"visibility")==="hidden"&&p&&(h=0),ia(this,a,"visibility",h?"inherit":"hidden",p?"inherit":"hidden",!p)),f!=="scale"&&f!=="transform"&&(f=oa[f],~f.indexOf(",")&&(f=f.split(",")[0]))),T=f in na,T){if(b||(y=e._gsap,y.renderTransform&&!t.parseTransform||pd(e,t.parseTransform),A=t.smoothOrigin!==!1&&y.smooth,b=this._pt=new Xo(this._pt,a,vo,0,1,y.renderTransform,y,0,-1),b.dep=1),f==="scale")this._pt=new Xo(this._pt,y,"scaleY",y.scaleY,(g?g*p:p-y.scaleY)||0),s.push("scaleY",f),f+="X";else if(f==="transformOrigin"){u=zJ(u),y.svg?T6(e,u,0,A,0,this):(_=parseFloat(u.split(" ")[2])||0,_!==y.zOrigin&&ia(this,y,"zOrigin",y.zOrigin,_),ia(this,a,f,a_(l),a_(u)));continue}else if(f==="svgOrigin"){T6(e,u,1,A,0,this);continue}else if(f in iO){qJ(this,y,f,h,u,g);continue}else if(f==="smoothOrigin"){ia(this,y,"smooth",y.smooth,u);continue}else if(f==="force3D"){y[f]=u;continue}else if(f==="transform"){XJ(this,u,e);continue}}else f in a||(f=Uu(f)||f);if(T||(p||p===0)&&(h||h===0)&&!PJ.test(u)&&f in a)x=(l+"").substr((h+"").length),p||(p=0),_=hi(u)||(f in qo.units?qo.units[f]:x),x!==_&&(h=aa(e,f,l,_)),this._pt=new Xo(this._pt,T?y:a,f,h,g?g*p:p-h,!T&&(_==="px"||f==="zIndex")&&t.autoRound!==!1?IJ:ZN),this._pt.u=_||0,x!==_&&_!=="%"&&(this._pt.b=l,this._pt.r=LJ);else if(f in a)GJ.call(this,e,f,l,u);else if(f in e)this.add(e,f,l||e[f],u,o,n);else{r_(f,u);continue}s.push(f)}}E&&g6(this)},get:ku,aliases:oa,getSetter:function(e,t,r){var o=oa[t];return o&&o.indexOf(",")<0&&(t=o),t in na&&t!==sa&&(e._gsap.x||ku(e,"x"))?r&&HN===r?t==="scale"?FJ:BJ:(HN=r||{})&&(t==="scale"?UJ:VJ):e.style&&!t_(e.style[t])?DJ:~t.indexOf("-")?kJ:n_(e,t)},core:{_removeProperty:ld,_getMatrix:C6}};nn.utils.checkPrefix=Uu;(function(i,e,t,r){var o=pi(i+","+e+","+t,function(n){na[n]=1});pi(e,function(n){qo.units[n]="deg",iO[n]=1}),oa[o[13]]=i+","+e,pi(r,function(n){var s=n.split(":");oa[s[1]]=o[s[0]]})})("x,y,z,scale,scaleX,scaleY,xPercent,yPercent","rotation,rotationX,rotationY,skewX,skewY","transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective","0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY");pi("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",function(i){qo.units[i]="px"});nn.registerPlugin(E6);var Rn=nn.registerPlugin(E6)||nn,YTe=Rn.core.Tween;var Qh=(i=>(i.SET="set",i.ADD="add",i.SUBTRACT="subtract",i))(Qh||{});var Fr=class{constructor(){this._timelineBuilders=[],this._duration=1,this._operation="set",this._delay=0,this._stoppable=!0,this._debug=!1}setDebug(e){this._debug=e}_printDebug(e){!this._debug||console.log(e)}addTimelineBuilder(e){this._timelineBuilders.push(e),e.setParent(this)}timelineBuilders(){return this._timelineBuilders}setParent(e){this._parent=e}parent(){return this._parent}setTarget(e){this._target=e;for(let t of this._timelineBuilders)t.setTarget(e)}target(){return this._target}setDuration(e){if(e>=0){this._duration=e;for(let t of this._timelineBuilders)t.setDuration(e)}}duration(){return this._duration}setKeyframes(e){this._keyframes=e}keyframes(){return this._keyframes}setEasing(e){this._easing=e;for(let t of this._timelineBuilders)t.setEasing(e)}easing(){return this._easing}setOperation(e){this._operation=e;for(let t of this._timelineBuilders)t.setOperation(e)}operation(){return this._operation}setRepeatParams(e){this._repeatParams=e;for(let t of this._timelineBuilders)t.setRepeatParams(e)}repeatParams(){return this._repeatParams}setDelay(e){this._delay=e;for(let t of this._timelineBuilders)t.setDelay(e)}delay(){return this._delay}setPosition(e){this._position=e}position(){return this._position}setStoppable(e){this._stoppable=e}stoppable(){return this._stoppable}setUpdateCallback(e){this._updateCallback=e}updateCallback(){return this._updateCallback}clone(){let e=new Fr;if(e.setDuration(this._duration),e.setOperation(this._operation),e.setDelay(this._delay),this._target&&e.setTarget(this._target.clone()),this._easing&&e.setEasing(this._easing),this._keyframes&&e.setKeyframes(this._keyframes),this._delay&&e.setDelay(this._delay),this._updateCallback&&e.setUpdateCallback(this._updateCallback.clone()),this._repeatParams&&e.setRepeatParams({count:this._repeatParams.count,delay:this._repeatParams.delay,yoyo:this._repeatParams.yoyo}),this._property){let t=this._property.name();t&&e.setPropertyName(t);let r=this._property.targetValue();r!=null&&e.setPropertyValue(r)}this._position&&e.setPosition(this._position.clone()),e.setStoppable(this._stoppable);for(let t of this._timelineBuilders){let r=t.clone();e.addTimelineBuilder(r)}return e}setPropertyName(e){this.property().setName(e)}property(){return this._property=this._property||new ed}propertyName(){return this.property().name()}setPropertyValue(e){this.property().setTargetValue(e)}propertyValue(){var e;return(e=this._property)==null?void 0:e.targetValue()}populate(e,t){var r;this._printDebug(["populate",this,e,this._timelineBuilders]);for(let o of this._timelineBuilders){let n=Rn.timeline();o.setDebug(this._debug),o.populate(n,t);let s=((r=o.position())==null?void 0:r.toParameter())||void 0;e.add(n,s)}this._property&&this._target&&(this._property.setDebug(this._debug),this._property.addToTimeline({timelineBuilder:this,timeline:e,target:this._target,...t}))}};var aO=class extends V{constructor(){super(...arguments);this.duration=v.FLOAT(1,{range:[0,10],rangeLocked:[!0,!1]})}},YJ=new aO,S6=class extends go{constructor(){super(...arguments);this.paramsConfig=YJ}static type(){return"duration"}initializeNode(){this.io.inputs.setCount(0,1)}cook(e){let t=e[0]||new Fr;t.setDuration(this.pv.duration),this.setTimelineBuilder(t)}};var cO=class extends V{constructor(){super(...arguments);this.name=v.INTEGER(j1.indexOf(Cu.POWER4),{menu:{entries:j1.map((e,t)=>({name:e,value:t}))}}),this.inOut=v.INTEGER(W1.indexOf(V8.OUT),{menu:{entries:W1.map((e,t)=>({name:e,value:t}))}})}},$J=new cO,hd=class extends go{constructor(){super(...arguments);this.paramsConfig=$J}static type(){return"easing"}initializeNode(){this.io.inputs.setCount(0,1)}static easingFullName(e){let t=j1[e.pv.name];if(t==Cu.NONE)return t;let r=W1[e.pv.inOut];return`${t}.${r}`}cook(e){let t=e[0]||new Fr,r=hd.easingFullName(this);t.setEasing(r),this.setTimelineBuilder(t)}};var c_=(i=>(i.RELATIVE="relative",i.ABSOLUTE="absolute",i))(c_||{});var l_=(i=>(i.START="start",i.END="end",i))(l_||{});var Vu=class{constructor(){this._mode="relative",this._relativeTo="end",this._offset=0}clone(){let e=new Vu;return e.setMode(this._mode),e.setRelativeTo(this._relativeTo),e.setOffset(this._offset),e}setMode(e){this._mode=e}mode(){return this._mode}setRelativeTo(e){this._relativeTo=e}relativeTo(){return this._relativeTo}setOffset(e){this._offset=e}offset(){return this._offset}toParameter(){switch(this._mode){case"relative":return this._relative_position_param();case"absolute":return this._absolutePositionParam()}Be.unreachable(this._mode)}_relative_position_param(){switch(this._relativeTo){case"end":return this._offsetString();case"start":return`<${this._offset}`}Be.unreachable(this._relativeTo)}_absolutePositionParam(){return this._offset}_offsetString(){return this._offset>0?`+=${this._offset}`:`-=${Math.abs(this._offset)}`}};var lO=["play all together","play one at a time"],KJ=4,uO=class extends V{constructor(){super(...arguments);this.mode=v.INTEGER(0,{menu:{entries:lO.map((e,t)=>({name:e,value:t}))}}),this.offset=v.FLOAT(0,{range:[-1,1]}),this.overridePositions=v.BOOLEAN(0),this.inputsCount=v.INTEGER(KJ,{range:[1,32],rangeLocked:[!0,!1],callback:e=>{u_.PARAM_CALLBACK_setInputsCount(e)}})}},JJ=new uO,u_=class extends go{constructor(){super(...arguments);this.paramsConfig=JJ}static type(){return"merge"}initializeNode(){this.io.inputs.setCount(0,4),this.scene().dispatchController.onAddListener(()=>{this.params.addOnSceneLoadHook("update inputs",()=>{this._callbackUpdateInputsCount()})})}cook(e){let t=new Fr,r=0;for(let o of e)o&&(r>0&&this._updateTimelineBuilder(o),t.addTimelineBuilder(o),r++);this.setTimelineBuilder(t)}_updateTimelineBuilder(e){let t=lO[this.pv.mode];switch(t){case"play all together":return this._setPlayAllTogether(e);case"play one at a time":return this._setPlayOneAtATime(e)}Be.unreachable(t)}_setPlayAllTogether(e){let t=e.position();(!t||this.pv.overridePositions)&&(t=new Vu,t.setMode(c_.RELATIVE),t.setRelativeTo(l_.START),t.setOffset(this.pv.offset),e.setPosition(t))}_setPlayOneAtATime(e){let t=e.position();(!t||this.pv.overridePositions)&&(t=new Vu,t.setMode(c_.RELATIVE),t.setRelativeTo(l_.END),t.setOffset(this.pv.offset),e.setPosition(t))}_callbackUpdateInputsCount(){this.io.inputs.setCount(1,this.pv.inputsCount),this.emit(St.INPUTS_UPDATED)}static PARAM_CALLBACK_setInputsCount(e){e._callbackUpdateInputsCount()}};var pO=class extends V{constructor(){super(...arguments);this.play=v.BUTTON(null,{callback:e=>{dd.PARAM_CALLBACK_play(e)},hidden:!0}),this.pause=v.BUTTON(null,{callback:e=>{dd.PARAM_CALLBACK_pause(e)},hidden:!0}),this.stoppable=v.BOOLEAN(1),this.debug=v.BOOLEAN(0)}},ZJ=new pO,dd=class extends go{constructor(){super(...arguments);this.paramsConfig=ZJ}static type(){return"null"}initializeNode(){this.io.inputs.setCount(0,1)}cook(e){let t=e[0]||new Fr;t.setDebug(this.pv.debug),t.setStoppable(this.pv.stoppable),this.setTimelineBuilder(t)}async timelineBuilder(){let e=await this.compute();if(!e)return;let t=e.coreContent();if(!!t)return t}async play(){return new Promise(async e=>{this.pv.debug&&Q.log(`play from '${this.path()}'`);let t=!1;function r(){t||(t=!0,e())}let o=await this.timelineBuilder();!o||(this._timeline=Rn.timeline({onComplete:r}),o.populate(this._timeline,{registerproperties:!0}))})}async pause(){this._timeline&&this._timeline.pause()}static PARAM_CALLBACK_play(e){e.play()}static PARAM_CALLBACK_pause(e){e.pause()}};var QJ=["from","to"],hO=class extends V{constructor(){super(...arguments);this.play=v.BUTTON(null,{callback:e=>{Sc.PARAM_CALLBACK_play(e)},hidden:!0}),this.pause=v.BUTTON(null,{callback:e=>{Sc.PARAM_CALLBACK_pause(e)},hidden:!0}),this.reset=v.BUTTON(null,{callback:e=>{Sc.PARAM_CALLBACK_reset(e)},hidden:!0}),this.stoppable=v.BOOLEAN(1),this.debug=v.BOOLEAN(0),this.seek=v.FLOAT(0,{range:[0,1],rangeLocked:[!0,!0],cook:!1,callback:e=>{Sc.PARAM_CALLBACK_seek(e)}})}},eZ=new hO,Sc=class extends go{constructor(){super(...arguments);this.paramsConfig=eZ}static type(){return"play"}static displayedInputNames(){return QJ}initializeNode(){this.io.inputs.setCount(2)}cook(e){let t=e[0]||new Fr;this.setTimelineBuilder(t)}async timelineBuilder(e){let t=this.io.inputs.input(e);if(!t)return;let r=await t.compute();if(!r)return;let o=r.coreContentCloned();if(!!o)return o.setDebug(this.pv.debug),o.setStoppable(this.pv.stoppable),o}async _playFromInput(e){return new Promise(async t=>{let r=!1;function o(){r||(r=!0,t())}let n=await this.timelineBuilder(e);!n||(this._timeline=Rn.timeline({onComplete:o}),n.populate(this._timeline,{registerproperties:!0}))})}async play(){return this.pv.debug&&Q.log(`play from '${this.path()}'`),await this._playFromInput(1)}async reset(){return this.pv.debug&&Q.log(`reset from '${this.path()}'`),await this._playFromInput(0)}async pause(){this._timeline&&this._timeline.pause()}async seek(){let e=await this.timelineBuilder(0),t=await this.timelineBuilder(1);if(!(e&&t))return;let r=Rn.timeline({paused:!0});e.populate(r,{registerproperties:!1}),r.seek(r.duration()),r.kill();let o=Rn.timeline({paused:!0});t.populate(o,{registerproperties:!1}),o.seek(this.pv.seek*o.duration(),!1),o.kill()}static PARAM_CALLBACK_play(e){e.play()}static PARAM_CALLBACK_pause(e){e.pause()}static PARAM_CALLBACK_reset(e){e.reset()}static PARAM_CALLBACK_seek(e){e.seek()}};var dO=class extends V{constructor(){super(...arguments);this.name=v.STRING("position")}},tZ=new dO,w6=class extends go{constructor(){super(...arguments);this.paramsConfig=tZ}static type(){return"propertyName"}initializeNode(){this.io.inputs.setCount(0,1)}cook(e){let t=e[0]||new Fr;t.setPropertyName(this.pv.name),this.setTimelineBuilder(t)}};var Gu=["custom","from scene graph","from node"],ca=Gu.indexOf("custom"),p_=Gu.indexOf("from scene graph"),M6=Gu.indexOf("from node"),fO=class extends V{constructor(){super(...arguments);this.mode=v.INTEGER(ca,{menu:{entries:Gu.map((e,t)=>({name:e,value:t}))}}),this.nodePath=v.NODE_PATH("",{visibleIf:{mode:M6}}),this.objectMask=v.STRING("*geo1",{visibleIf:{mode:p_}}),this.printResolve=v.BUTTON(null,{visibleIf:{mode:p_},callback:e=>{h_.PARAM_CALLBACK_printResolve(e)}}),this.overridePropertyName=v.BOOLEAN(0,{visibleIf:[{mode:p_},{mode:M6}]}),this.propertyName=v.STRING("",{visibleIf:[{overridePropertyName:!0,mode:p_},{overridePropertyName:!0,mode:M6}]}),this.size=v.INTEGER(3,{range:[1,4],rangeLocked:[!0,!0],visibleIf:{mode:ca},separatorAfter:!0}),this.value1=v.FLOAT(0,{visibleIf:{mode:ca,size:1}}),this.value2=v.VECTOR2([0,0],{visibleIf:{mode:ca,size:2}}),this.value3=v.VECTOR3([0,0,0],{visibleIf:{mode:ca,size:3,asColor:!1}}),this.color=v.COLOR([0,0,0],{visibleIf:{mode:ca,size:3,asColor:!0}}),this.value4=v.VECTOR4([0,0,0,0],{visibleIf:{mode:ca,size:4}}),this.asColor=v.BOOLEAN(0,{visibleIf:{mode:ca,size:3}})}},rZ=new fO,h_=class extends go{constructor(){super(...arguments);this.paramsConfig=rZ}static type(){return"propertyValue"}initializeNode(){this.io.inputs.setCount(0,1)}async cook(e){let t=e[0]||new Fr;await this._prepareTimelineBuilder(t),this.setTimelineBuilder(t)}setMode(e){this.p.mode.set(Gu.indexOf(e))}async _prepareTimelineBuilder(e){let t=Gu[this.pv.mode];switch(t){case"custom":return this._prepareTimebuilderCustom(e);case"from scene graph":return this._prepareTimebuilderFromSceneGraph(e);case"from node":return await this._prepareTimebuilderFromNode(e)}Be.unreachable(t)}_prepareTimebuilderCustom(e){switch(this.pv.size){case 1:return e.setPropertyValue(this.pv.value1);case 2:return e.setPropertyValue(this.pv.value2);case 3:return this.pv.asColor?e.setPropertyValue(this.pv.color):e.setPropertyValue(this.pv.value3);case 4:return e.setPropertyValue(this.pv.value4)}}_prepareTimebuilderFromSceneGraph(e){let t=this.pv.overridePropertyName?this.pv.propertyName:e.propertyName();if(!t)return;let r=this._foundObjectFromSceneGraph();if(r){let o=r[t];o&&(K.isNumber(o)||K.isVector(o)||o instanceof Nt)&&e.setPropertyValue(o)}}async _prepareTimebuilderFromNode(e){let t=this.pv.overridePropertyName?this.pv.propertyName:e.propertyName();if(!t)return;let r=this.pv.nodePath.node();if(!r)return;let o=r.params.get(t);if(!o)return;o.isDirty()&&await o.compute();let n=o.value;n&&(K.isNumber(n)||K.isVector(n))&&e.setPropertyValue(n)}static PARAM_CALLBACK_printResolve(e){e.printResolve()}_foundObjectFromSceneGraph(){return this.scene().findObjectByMask(this.pv.objectMask)}printResolve(){let e=this._foundObjectFromSceneGraph();console.log(e)}};var zu=class{constructor(e,t){this._scene=e,this._options=t}clone(){return new zu(this._scene,this._options)}objects(){let e=this._options.objectMask;if(!!e)return this._scene.objectsByMask(e)}node(){if(!this._options.node)return;let e=this._options.node;return e.relativeTo.node(e.path)}};var fd=class{constructor(){this._update_matrix=!1}clone(){let e=new fd;return e.setUpdateMatrix(this._update_matrix),e}setUpdateMatrix(e){this._update_matrix=e}updateMatrix(){return this._update_matrix}};var wc=["scene graph","node"],N6=wc.indexOf("scene graph"),oZ=wc.indexOf("node"),mO=class extends V{constructor(){super(...arguments);this.type=v.INTEGER(N6,{menu:{entries:wc.map((e,t)=>({name:e,value:t}))}}),this.nodePath=v.NODE_PATH("",{visibleIf:{type:oZ}}),this.objectMask=v.STRING("/geo*",{visibleIf:{type:N6}}),this.updateMatrix=v.BOOLEAN(1,{visibleIf:{type:N6}}),this.printResolve=v.BUTTON(null,{callback:(e,t)=>{d_.PARAM_CALLBACK_print_resolve(e)}})}},iZ=new mO,d_=class extends go{constructor(){super(...arguments);this.paramsConfig=iZ}static type(){return"target"}initializeNode(){this.io.inputs.setCount(0,1)}cook(e){let t=e[0]||new Fr,r=this._create_target(t);t.setTarget(r),this._set_update_callback(t),this.setTimelineBuilder(t)}setTargetType(e){this.p.type.set(wc.indexOf(e))}_create_target(e){let t=wc[this.pv.type];switch(t){case"node":return new zu(this.scene(),{node:{path:this.pv.nodePath.path(),relativeTo:this}});case"scene graph":return new zu(this.scene(),{objectMask:this.pv.objectMask})}Be.unreachable(t)}_set_update_callback(e){let t=wc[this.pv.type],r=e.updateCallback();switch(t){case"node":return;case"scene graph":{this.pv.updateMatrix&&(r=r||new fd,r.setUpdateMatrix(this.pv.updateMatrix),e.setUpdateCallback(r));return}}Be.unreachable(t)}static PARAM_CALLBACK_print_resolve(e){e.print_resolve()}print_resolve(){let e=wc[this.pv.type],t=new Fr,r=this._create_target(t);switch(e){case"node":return console.log(r.node());case"scene graph":return console.log(r.objects())}}};var f_="input audio properties",nZ=[f_,f_,f_,f_],$r=class extends dr{constructor(){super(...arguments);this.flags=new wh(this)}static context(){return oe.AUDIO}static displayedInputNames(){return nZ}initializeBaseNode(){this.io.outputs.setHasOneOutput()}setAudioBuilder(e){this._setContainer(e)}};var Di=class{setAudioNode(e){this._audioNode=e}audioNode(){return this._audioNode}setSource(e){this._source=e,this._audioNode||this.setAudioNode(e)}source(){return this._source}setInstrument(e){this._instrument=e,this._audioNode||this.setAudioNode(e)}instrument(){return this._instrument}setOscillatorParams(e){this._oscillatorParams=e}oscillatorParams(){return this._oscillatorParams}setEnvelopeParams(e){this._envelopeParams=e}envelopeParams(){return this._envelopeParams}clone(){let e=new Di;return e.setAudioNode(this._audioNode),e.setSource(this._source),e.setInstrument(this._instrument),e.setEnvelopeParams(this._envelopeParams),e}};var di=bn(O6());var wO=()=>new DOMException("","AbortError");var MO=i=>(e,t,[r,o,n],s)=>{i(e[o],[t,r,n],a=>a[0]===t&&a[1]===r,s)};var NO=i=>(e,t,r)=>{let o=[];for(let n=0;n<r.numberOfInputs;n+=1)o.push(new Set);i.set(e,{activeInputs:o,outputs:new Set,passiveInputs:new WeakMap,renderer:t})};var OO=i=>(e,t)=>{i.set(e,{activeInputs:new Set,passiveInputs:new WeakMap,renderer:t})};var As=new WeakSet,__=new WeakMap,Hu=new WeakMap,g_=new WeakMap,Ad=new WeakMap,ju=new WeakMap,v_=new WeakMap,Cd=new WeakMap,Ed=new WeakMap,Sd=new WeakMap;var PO={construct(){return PO}},RO=i=>{try{let e=new Proxy(i,PO);new e}catch{return!1}return!0};var LO=/^import(?:(?:[\s]+[\w]+|(?:[\s]+[\w]+[\s]*,)?[\s]*\{[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?(?:[\s]*,[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?)*[\s]*}|(?:[\s]+[\w]+[\s]*,)?[\s]*\*[\s]+as[\s]+[\w]+)[\s]+from)?(?:[\s]*)("([^"\\]|\\.)+"|'([^'\\]|\\.)+')(?:[\s]*);?/,P6=(i,e)=>{let t=[],r=i.replace(/^[\s]+/,""),o=r.match(LO);for(;o!==null;){let n=o[1].slice(1,-1),s=o[0].replace(/([\s]+)?;?$/,"").replace(n,new URL(n,e).toString());t.push(s),r=r.slice(o[0].length).replace(/^[\s]+/,""),o=r.match(LO)}return[t.join(";"),r]};var IO=i=>{if(i!==void 0&&!Array.isArray(i))throw new TypeError("The parameterDescriptors property of given value for processorCtor is not an array.")},DO=i=>{if(!RO(i))throw new TypeError("The given value for processorCtor should be a constructor.");if(i.prototype===null||typeof i.prototype!="object")throw new TypeError("The given value for processorCtor should have a prototype.")},kO=(i,e,t,r,o,n,s,a,c,l,u,p,h)=>{let d=0;return(m,f,x={credentials:"omit"})=>{let _=u.get(m);if(_!==void 0&&_.has(f))return Promise.resolve();let g=l.get(m);if(g!==void 0){let y=g.get(f);if(y!==void 0)return y}let T=n(m),b=T.audioWorklet===void 0?o(f).then(([y,A])=>{let[E,S]=P6(y,A),M=`${E};((a,b)=>{(a[b]=a[b]||[]).push((AudioWorkletProcessor,global,registerProcessor,sampleRate,self,window)=>{${S}
})})(window,'_AWGS')`;return t(M)}).then(()=>{let y=h._AWGS.pop();if(y===void 0)throw new SyntaxError;r(T.currentTime,T.sampleRate,()=>y(class{},void 0,(A,E)=>{if(A.trim()==="")throw e();let S=Ed.get(T);if(S!==void 0){if(S.has(A))throw e();DO(E),IO(E.parameterDescriptors),S.set(A,E)}else DO(E),IO(E.parameterDescriptors),Ed.set(T,new Map([[A,E]]))},T.sampleRate,void 0,void 0))}):Promise.all([o(f),Promise.resolve(i(p,p))]).then(([[y,A],E])=>{let S=d+1;d=S;let[M,L]=P6(y,A),k=`${M};((AudioWorkletProcessor,registerProcessor)=>{${L}
})(${E?"AudioWorkletProcessor":"class extends AudioWorkletProcessor {__b=new WeakSet();constructor(){super();(p=>p.postMessage=(q=>(m,t)=>q.call(p,m,t?t.filter(u=>!this.__b.has(u)):t))(p.postMessage))(this.port)}}"},(n,p)=>registerProcessor(n,class extends p{${E?"":"__c = (a) => a.forEach(e=>this.__b.add(e.buffer));"}process(i,o,p){${E?"":"i.forEach(this.__c);o.forEach(this.__c);this.__c(Object.values(p));"}return super.process(i.map(j=>j.some(k=>k.length===0)?[]:j),o,p)}}));registerProcessor('__sac${S}',class extends AudioWorkletProcessor{process(){return !1}})`,z=new Blob([k],{type:"application/javascript; charset=utf-8"}),F=URL.createObjectURL(z);return T.audioWorklet.addModule(F,x).then(()=>{if(a(T))return T;let X=s(T);return X.audioWorklet.addModule(F,x).then(()=>X)}).then(X=>{if(c===null)throw new SyntaxError;try{new c(X,`__sac${S}`)}catch{throw new SyntaxError}}).finally(()=>URL.revokeObjectURL(F))});return g===void 0?l.set(m,new Map([[f,b]])):g.set(f,b),b.then(()=>{let y=u.get(m);y===void 0?u.set(m,new Set([f])):y.add(f)}).finally(()=>{let y=l.get(m);y!==void 0&&y.delete(f)}),b}};var Ur=(i,e)=>{let t=i.get(e);if(t===void 0)throw new Error("A value with the given key could not be found.");return t};var la=(i,e)=>{let t=Array.from(i).filter(e);if(t.length>1)throw Error("More than one element was found.");if(t.length===0)throw Error("No element was found.");let[r]=t;return i.delete(r),r};var x_=(i,e,t,r)=>{let o=Ur(i,e),n=la(o,s=>s[0]===t&&s[1]===r);return o.size===0&&i.delete(e),n};var Cs=i=>Ur(v_,i);var Ln=i=>{if(As.has(i))throw new Error("The AudioNode is already stored.");As.add(i),Cs(i).forEach(e=>e(!0))};var y_=i=>"port"in i;var Es=i=>{if(!As.has(i))throw new Error("The AudioNode is not stored.");As.delete(i),Cs(i).forEach(e=>e(!1))};var wd=(i,e)=>{!y_(i)&&e.every(t=>t.size===0)&&Es(i)};var BO=(i,e,t,r,o,n,s,a,c,l,u,p,h)=>{let d=new WeakMap;return(m,f,x,_,g)=>{let{activeInputs:T,passiveInputs:b}=n(f),{outputs:y}=n(m),A=a(m),E=S=>{let M=c(f),L=c(m);if(S){let C=x_(b,m,x,_);i(T,m,C,!1),!g&&!p(m)&&t(L,M,x,_),h(f)&&Ln(f)}else{let C=r(T,m,x,_);e(b,_,C,!1),!g&&!p(m)&&o(L,M,x,_);let N=s(f);if(N===0)u(f)&&wd(f,T);else{let D=d.get(f);D!==void 0&&clearTimeout(D),d.set(f,setTimeout(()=>{u(f)&&wd(f,T)},N*1e3))}}};return l(y,[f,x,_],S=>S[0]===f&&S[1]===x&&S[2]===_,!0)?(A.add(E),u(m)?i(T,m,[x,_,E],!0):e(b,_,[m,x,E],!0),!0):!1}};var FO=i=>(e,t,[r,o,n],s)=>{let a=e.get(r);a===void 0?e.set(r,new Set([[o,t,n]])):i(a,[o,t,n],c=>c[0]===o&&c[1]===t,s)};var UO=i=>(e,t)=>{let r=i(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});t.connect(r).connect(e.destination);let o=()=>{t.removeEventListener("ended",o),t.disconnect(r),r.disconnect()};t.addEventListener("ended",o)};var VO=i=>(e,t)=>{i(e).add(t)};var vZ={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",fftSize:2048,maxDecibels:-30,minDecibels:-100,smoothingTimeConstant:.8},GO=(i,e,t,r,o,n)=>class extends i{constructor(a,c){let l=o(a),u={...vZ,...c},p=r(l,u),h=n(l)?e():null;super(a,!1,p,h);this._nativeAnalyserNode=p}get fftSize(){return this._nativeAnalyserNode.fftSize}set fftSize(a){this._nativeAnalyserNode.fftSize=a}get frequencyBinCount(){return this._nativeAnalyserNode.frequencyBinCount}get maxDecibels(){return this._nativeAnalyserNode.maxDecibels}set maxDecibels(a){let c=this._nativeAnalyserNode.maxDecibels;if(this._nativeAnalyserNode.maxDecibels=a,!(a>this._nativeAnalyserNode.minDecibels))throw this._nativeAnalyserNode.maxDecibels=c,t()}get minDecibels(){return this._nativeAnalyserNode.minDecibels}set minDecibels(a){let c=this._nativeAnalyserNode.minDecibels;if(this._nativeAnalyserNode.minDecibels=a,!(this._nativeAnalyserNode.maxDecibels>a))throw this._nativeAnalyserNode.minDecibels=c,t()}get smoothingTimeConstant(){return this._nativeAnalyserNode.smoothingTimeConstant}set smoothingTimeConstant(a){this._nativeAnalyserNode.smoothingTimeConstant=a}getByteFrequencyData(a){this._nativeAnalyserNode.getByteFrequencyData(a)}getByteTimeDomainData(a){this._nativeAnalyserNode.getByteTimeDomainData(a)}getFloatFrequencyData(a){this._nativeAnalyserNode.getFloatFrequencyData(a)}getFloatTimeDomainData(a){this._nativeAnalyserNode.getFloatTimeDomainData(a)}};var Pt=(i,e)=>i.context===e;var zO=(i,e,t)=>()=>{let r=new WeakMap,o=async(n,s)=>{let a=e(n);if(!Pt(a,s)){let l={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,fftSize:a.fftSize,maxDecibels:a.maxDecibels,minDecibels:a.minDecibels,smoothingTimeConstant:a.smoothingTimeConstant};a=i(s,l)}return r.set(s,a),await t(n,s,a),a};return{render(n,s){let a=r.get(s);return a!==void 0?Promise.resolve(a):o(n,s)}}};var Wu=i=>{try{i.copyToChannel(new Float32Array(1),0,-1)}catch{return!1}return!0};var sn=()=>new DOMException("","IndexSizeError");var qu=i=>{i.getChannelData=(e=>t=>{try{return e.call(i,t)}catch(r){throw r.code===12?sn():r}})(i.getChannelData)};var xZ={numberOfChannels:1},HO=(i,e,t,r,o,n,s,a)=>{let c=null;return class jO{constructor(u){if(o===null)throw new Error("Missing the native OfflineAudioContext constructor.");let{length:p,numberOfChannels:h,sampleRate:d}={...xZ,...u};c===null&&(c=new o(1,1,44100));let m=r!==null&&e(n,n)?new r({length:p,numberOfChannels:h,sampleRate:d}):c.createBuffer(h,p,d);if(m.numberOfChannels===0)throw t();return typeof m.copyFromChannel!="function"?(s(m),qu(m)):e(Wu,()=>Wu(m))||a(m),i.add(m),m}static[Symbol.hasInstance](u){return u!==null&&typeof u=="object"&&Object.getPrototypeOf(u)===jO.prototype||i.has(u)}}};var Rr=-34028234663852886e22,Sr=-Rr;var Yo=i=>As.has(i);var yZ={buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1},WO=(i,e,t,r,o,n,s,a)=>class extends i{constructor(l,u){let p=n(l),h={...yZ,...u},d=o(p,h),m=s(p),f=m?e():null;super(l,!1,d,f);this._audioBufferSourceNodeRenderer=f,this._isBufferNullified=!1,this._isBufferSet=h.buffer!==null,this._nativeAudioBufferSourceNode=d,this._onended=null,this._playbackRate=t(this,m,d.playbackRate,Sr,Rr)}get buffer(){return this._isBufferNullified?null:this._nativeAudioBufferSourceNode.buffer}set buffer(l){if(this._nativeAudioBufferSourceNode.buffer=l,l!==null){if(this._isBufferSet)throw r();this._isBufferSet=!0}}get loop(){return this._nativeAudioBufferSourceNode.loop}set loop(l){this._nativeAudioBufferSourceNode.loop=l}get loopEnd(){return this._nativeAudioBufferSourceNode.loopEnd}set loopEnd(l){this._nativeAudioBufferSourceNode.loopEnd=l}get loopStart(){return this._nativeAudioBufferSourceNode.loopStart}set loopStart(l){this._nativeAudioBufferSourceNode.loopStart=l}get onended(){return this._onended}set onended(l){let u=typeof l=="function"?a(this,l):null;this._nativeAudioBufferSourceNode.onended=u;let p=this._nativeAudioBufferSourceNode.onended;this._onended=p!==null&&p===u?l:p}get playbackRate(){return this._playbackRate}start(l=0,u=0,p){if(this._nativeAudioBufferSourceNode.start(l,u,p),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.start=p===void 0?[l,u]:[l,u,p]),this.context.state!=="closed"){Ln(this);let h=()=>{this._nativeAudioBufferSourceNode.removeEventListener("ended",h),Yo(this)&&Es(this)};this._nativeAudioBufferSourceNode.addEventListener("ended",h)}}stop(l=0){this._nativeAudioBufferSourceNode.stop(l),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.stop=l)}};var qO=(i,e,t,r,o)=>()=>{let n=new WeakMap,s=null,a=null,c=async(l,u)=>{let p=t(l),h=Pt(p,u);if(!h){let d={buffer:p.buffer,channelCount:p.channelCount,channelCountMode:p.channelCountMode,channelInterpretation:p.channelInterpretation,loop:p.loop,loopEnd:p.loopEnd,loopStart:p.loopStart,playbackRate:p.playbackRate.value};p=e(u,d),s!==null&&p.start(...s),a!==null&&p.stop(a)}return n.set(u,p),h?await i(u,l.playbackRate,p.playbackRate):await r(u,l.playbackRate,p.playbackRate),await o(l,u,p),p};return{set start(l){s=l},set stop(l){a=l},render(l,u){let p=n.get(u);return p!==void 0?Promise.resolve(p):c(l,u)}}};var XO=i=>"playbackRate"in i;var YO=i=>"frequency"in i&&"gain"in i;var $O=i=>"offset"in i;var KO=i=>!("frequency"in i)&&"gain"in i;var JO=i=>"detune"in i&&"frequency"in i;var ZO=i=>"pan"in i;var Kr=i=>Ur(__,i);var ua=i=>Ur(g_,i);var b_=(i,e)=>{let{activeInputs:t}=Kr(i);t.forEach(o=>o.forEach(([n])=>{e.includes(i)||b_(n,[...e,i])}));let r=XO(i)?[i.playbackRate]:y_(i)?Array.from(i.parameters.values()):YO(i)?[i.Q,i.detune,i.frequency,i.gain]:$O(i)?[i.offset]:KO(i)?[i.gain]:JO(i)?[i.detune,i.frequency]:ZO(i)?[i.pan]:[];for(let o of r){let n=ua(o);n!==void 0&&n.activeInputs.forEach(([s])=>b_(s,e))}Yo(i)&&Es(i)};var pa=i=>{b_(i.destination,[])};var T_=i=>i===void 0||typeof i=="number"||typeof i=="string"&&(i==="balanced"||i==="interactive"||i==="playback");var QO=(i,e,t,r,o,n,s,a,c)=>class extends i{constructor(u={}){if(c===null)throw new Error("Missing the native AudioContext constructor.");let p;try{p=new c(u)}catch(m){throw m.code===12&&m.message==="sampleRate is not in range"?t():m}if(p===null)throw r();if(!T_(u.latencyHint))throw new TypeError(`The provided value '${u.latencyHint}' is not a valid enum value of type AudioContextLatencyCategory.`);if(u.sampleRate!==void 0&&p.sampleRate!==u.sampleRate)throw t();super(p,2);let{latencyHint:h}=u,{sampleRate:d}=p;if(this._baseLatency=typeof p.baseLatency=="number"?p.baseLatency:h==="balanced"?512/d:h==="interactive"||h===void 0?256/d:h==="playback"?1024/d:Math.max(2,Math.min(128,Math.round(h*d/128)))*128/d,this._nativeAudioContext=p,c.name==="webkitAudioContext"?(this._nativeGainNode=p.createGain(),this._nativeOscillatorNode=p.createOscillator(),this._nativeGainNode.gain.value=1e-37,this._nativeOscillatorNode.connect(this._nativeGainNode).connect(p.destination),this._nativeOscillatorNode.start()):(this._nativeGainNode=null,this._nativeOscillatorNode=null),this._state=null,p.state==="running"){this._state="suspended";let m=()=>{this._state==="suspended"&&(this._state=null),p.removeEventListener("statechange",m)};p.addEventListener("statechange",m)}}get baseLatency(){return this._baseLatency}get state(){return this._state!==null?this._state:this._nativeAudioContext.state}close(){return this.state==="closed"?this._nativeAudioContext.close().then(()=>{throw e()}):(this._state==="suspended"&&(this._state=null),this._nativeAudioContext.close().then(()=>{this._nativeGainNode!==null&&this._nativeOscillatorNode!==null&&(this._nativeOscillatorNode.stop(),this._nativeGainNode.disconnect(),this._nativeOscillatorNode.disconnect()),pa(this)}))}createMediaElementSource(u){return new o(this,{mediaElement:u})}createMediaStreamDestination(){return new n(this)}createMediaStreamSource(u){return new s(this,{mediaStream:u})}createMediaStreamTrackSource(u){return new a(this,{mediaStreamTrack:u})}resume(){return this._state==="suspended"?new Promise((u,p)=>{let h=()=>{this._nativeAudioContext.removeEventListener("statechange",h),this._nativeAudioContext.state==="running"?u():this.resume().then(u,p)};this._nativeAudioContext.addEventListener("statechange",h)}):this._nativeAudioContext.resume().catch(u=>{throw u===void 0||u.code===15?e():u})}suspend(){return this._nativeAudioContext.suspend().catch(u=>{throw u===void 0?e():u})}};var eP=(i,e,t,r,o,n,s,a)=>class extends i{constructor(l,u){let p=n(l),h=s(p),d=o(p,u,h),m=h?e(a):null;super(l,!1,d,m);this._isNodeOfNativeOfflineAudioContext=h,this._nativeAudioDestinationNode=d}get channelCount(){return this._nativeAudioDestinationNode.channelCount}set channelCount(l){if(this._isNodeOfNativeOfflineAudioContext)throw r();if(l>this._nativeAudioDestinationNode.maxChannelCount)throw t();this._nativeAudioDestinationNode.channelCount=l}get channelCountMode(){return this._nativeAudioDestinationNode.channelCountMode}set channelCountMode(l){if(this._isNodeOfNativeOfflineAudioContext)throw r();this._nativeAudioDestinationNode.channelCountMode=l}get maxChannelCount(){return this._nativeAudioDestinationNode.maxChannelCount}};var tP=i=>{let e=new WeakMap,t=async(r,o)=>{let n=o.destination;return e.set(o,n),await i(r,o,n),n};return{render(r,o){let n=e.get(o);return n!==void 0?Promise.resolve(n):t(r,o)}}};var rP=(i,e,t,r,o,n,s,a)=>(c,l)=>{let u=l.listener,p=()=>{let y=new Float32Array(1),A=e(l,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:9}),E=s(l),S=!1,M=[0,0,-1,0,1,0],L=[0,0,0],C=()=>{if(S)return;S=!0;let z=r(l,256,9,0);z.onaudioprocess=({inputBuffer:F})=>{let X=[n(F,y,0),n(F,y,1),n(F,y,2),n(F,y,3),n(F,y,4),n(F,y,5)];X.some((Y,H)=>Y!==M[H])&&(u.setOrientation(...X),M=X);let $=[n(F,y,6),n(F,y,7),n(F,y,8)];$.some((Y,H)=>Y!==L[H])&&(u.setPosition(...$),L=$)},A.connect(z)},N=z=>F=>{F!==M[z]&&(M[z]=F,u.setOrientation(...M))},D=z=>F=>{F!==L[z]&&(L[z]=F,u.setPosition(...L))},k=(z,F,X)=>{let $=t(l,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:F});$.connect(A,0,z),$.start(),Object.defineProperty($.offset,"defaultValue",{get(){return F}});let Y=i({context:c},E,$.offset,Sr,Rr);return a(Y,"value",H=>()=>H.call(Y),H=>B=>{try{H.call(Y,B)}catch(te){if(te.code!==9)throw te}C(),E&&X(B)}),Y.cancelAndHoldAtTime=(H=>E?()=>{throw o()}:(...B)=>{let te=H.apply(Y,B);return C(),te})(Y.cancelAndHoldAtTime),Y.cancelScheduledValues=(H=>E?()=>{throw o()}:(...B)=>{let te=H.apply(Y,B);return C(),te})(Y.cancelScheduledValues),Y.exponentialRampToValueAtTime=(H=>E?()=>{throw o()}:(...B)=>{let te=H.apply(Y,B);return C(),te})(Y.exponentialRampToValueAtTime),Y.linearRampToValueAtTime=(H=>E?()=>{throw o()}:(...B)=>{let te=H.apply(Y,B);return C(),te})(Y.linearRampToValueAtTime),Y.setTargetAtTime=(H=>E?()=>{throw o()}:(...B)=>{let te=H.apply(Y,B);return C(),te})(Y.setTargetAtTime),Y.setValueAtTime=(H=>E?()=>{throw o()}:(...B)=>{let te=H.apply(Y,B);return C(),te})(Y.setValueAtTime),Y.setValueCurveAtTime=(H=>E?()=>{throw o()}:(...B)=>{let te=H.apply(Y,B);return C(),te})(Y.setValueCurveAtTime),Y};return{forwardX:k(0,0,N(0)),forwardY:k(1,0,N(1)),forwardZ:k(2,-1,N(2)),positionX:k(6,0,D(0)),positionY:k(7,0,D(1)),positionZ:k(8,0,D(2)),upX:k(3,0,N(3)),upY:k(4,1,N(4)),upZ:k(5,0,N(5))}},{forwardX:h,forwardY:d,forwardZ:m,positionX:f,positionY:x,positionZ:_,upX:g,upY:T,upZ:b}=u.forwardX===void 0?p():u;return{get forwardX(){return h},get forwardY(){return d},get forwardZ(){return m},get positionX(){return f},get positionY(){return x},get positionZ(){return _},get upX(){return g},get upY(){return T},get upZ(){return b}}};var Mc=i=>"context"in i;var ha=i=>Mc(i[0]);var In=(i,e,t,r)=>{for(let o of i)if(t(o)){if(r)return!1;throw Error("The set contains at least one similar element.")}return i.add(e),!0};var R6=(i,e,[t,r],o)=>{In(i,[e,t,r],n=>n[0]===e&&n[1]===t,o)};var L6=(i,[e,t,r],o)=>{let n=i.get(e);n===void 0?i.set(e,new Set([[t,r]])):In(n,[t,r],s=>s[0]===t,o)};var an=i=>"inputs"in i;var Xu=(i,e,t,r)=>{if(an(e)){let o=e.inputs[r];return i.connect(o,t,0),[o,t,0]}return i.connect(e,t,r),[e,t,r]};var I6=(i,e,t)=>{for(let r of i)if(r[0]===e&&r[1]===t)return i.delete(r),r;return null};var oP=(i,e,t)=>la(i,r=>r[0]===e&&r[1]===t);var D6=(i,e)=>{if(!Cs(i).delete(e))throw new Error("Missing the expected event listener.")};var k6=(i,e,t)=>{let r=Ur(i,e),o=la(r,n=>n[0]===t);return r.size===0&&i.delete(e),o};var Yu=(i,e,t,r)=>{an(e)?i.disconnect(e.inputs[r],t,0):i.disconnect(e,t,r)};var Kt=i=>Ur(Hu,i);var Nc=i=>Ur(Ad,i);var a0=i=>Cd.has(i);var $u=i=>!As.has(i);var B6=(i,e)=>new Promise(t=>{if(e!==null)t(!0);else{let r=i.createScriptProcessor(256,1,1),o=i.createGain(),n=i.createBuffer(1,2,44100),s=n.getChannelData(0);s[0]=1,s[1]=1;let a=i.createBufferSource();a.buffer=n,a.loop=!0,a.connect(r).connect(i.destination),a.connect(o),a.disconnect(o),r.onaudioprocess=c=>{let l=c.inputBuffer.getChannelData(0);Array.prototype.some.call(l,u=>u===1)?t(!0):t(!1),a.stop(),r.onaudioprocess=null,a.disconnect(r),r.disconnect(i.destination)},a.start()}});var A_=(i,e)=>{let t=new Map;for(let r of i)for(let o of r){let n=t.get(o);t.set(o,n===void 0?1:n+1)}t.forEach((r,o)=>e(o,r))};var Oc=i=>"context"in i;var iP=i=>{let e=new Map;i.connect=(t=>(r,o=0,n=0)=>{let s=Oc(r)?t(r,o,n):t(r,o),a=e.get(r);return a===void 0?e.set(r,[{input:n,output:o}]):a.every(c=>c.input!==n||c.output!==o)&&a.push({input:n,output:o}),s})(i.connect.bind(i)),i.disconnect=(t=>(r,o,n)=>{if(t.apply(i),r===void 0)e.clear();else if(typeof r=="number")for(let[s,a]of e){let c=a.filter(l=>l.output!==r);c.length===0?e.delete(s):e.set(s,c)}else if(e.has(r))if(o===void 0)e.delete(r);else{let s=e.get(r);if(s!==void 0){let a=s.filter(c=>c.output!==o&&(c.input!==n||n===void 0));a.length===0?e.delete(r):e.set(r,a)}}for(let[s,a]of e)a.forEach(c=>{Oc(s)?i.connect(s,c.output,c.input):i.connect(s,c.output)})})(i.disconnect)};var bZ=(i,e,t,r)=>{let{activeInputs:o,passiveInputs:n}=ua(e),{outputs:s}=Kr(i),a=Cs(i),c=l=>{let u=Kt(i),p=Nc(e);if(l){let h=k6(n,i,t);R6(o,i,h,!1),!r&&!a0(i)&&u.connect(p,t)}else{let h=oP(o,i,t);L6(n,h,!1),!r&&!a0(i)&&u.disconnect(p,t)}};return In(s,[e,t],l=>l[0]===e&&l[1]===t,!0)?(a.add(c),Yo(i)?R6(o,i,[t,c],!0):L6(n,[i,t,c],!0),!0):!1},TZ=(i,e,t,r)=>{let{activeInputs:o,passiveInputs:n}=Kr(e),s=I6(o[r],i,t);return s===null?[x_(n,i,t,r)[2],!1]:[s[2],!0]},AZ=(i,e,t)=>{let{activeInputs:r,passiveInputs:o}=ua(e),n=I6(r,i,t);return n===null?[k6(o,i,t)[1],!1]:[n[2],!0]},F6=(i,e,t,r,o)=>{let[n,s]=TZ(i,t,r,o);if(n!==null&&(D6(i,n),s&&!e&&!a0(i)&&Yu(Kt(i),Kt(t),r,o)),Yo(t)){let{activeInputs:a}=Kr(t);wd(t,a)}},U6=(i,e,t,r)=>{let[o,n]=AZ(i,t,r);o!==null&&(D6(i,o),n&&!e&&!a0(i)&&Kt(i).disconnect(Nc(t),r))},CZ=(i,e)=>{let t=Kr(i),r=[];for(let o of t.outputs)ha(o)?F6(i,e,...o):U6(i,e,...o),r.push(o[0]);return t.outputs.clear(),r},EZ=(i,e,t)=>{let r=Kr(i),o=[];for(let n of r.outputs)n[1]===t&&(ha(n)?F6(i,e,...n):U6(i,e,...n),o.push(n[0]),r.outputs.delete(n));return o},SZ=(i,e,t,r,o)=>{let n=Kr(i);return Array.from(n.outputs).filter(s=>s[0]===t&&(r===void 0||s[1]===r)&&(o===void 0||s[2]===o)).map(s=>(ha(s)?F6(i,e,...s):U6(i,e,...s),n.outputs.delete(s),s[0]))},nP=(i,e,t,r,o,n,s,a,c,l,u,p,h,d,m,f)=>class extends l{constructor(_,g,T,b){super(T);this._context=_,this._nativeAudioNode=T;let y=u(_);p(y)&&t(B6,()=>B6(y,f))!==!0&&iP(T),Hu.set(this,T),v_.set(this,new Set),_.state!=="closed"&&g&&Ln(this),i(this,b,T)}get channelCount(){return this._nativeAudioNode.channelCount}set channelCount(_){this._nativeAudioNode.channelCount=_}get channelCountMode(){return this._nativeAudioNode.channelCountMode}set channelCountMode(_){this._nativeAudioNode.channelCountMode=_}get channelInterpretation(){return this._nativeAudioNode.channelInterpretation}set channelInterpretation(_){this._nativeAudioNode.channelInterpretation=_}get context(){return this._context}get numberOfInputs(){return this._nativeAudioNode.numberOfInputs}get numberOfOutputs(){return this._nativeAudioNode.numberOfOutputs}connect(_,g=0,T=0){if(g<0||g>=this._nativeAudioNode.numberOfOutputs)throw o();let b=u(this._context),y=m(b);if(h(_)||d(_))throw n();if(Mc(_)){let S=Kt(_);try{let L=Xu(this._nativeAudioNode,S,g,T),C=$u(this);(y||C)&&this._nativeAudioNode.disconnect(...L),this.context.state!=="closed"&&!C&&$u(_)&&Ln(_)}catch(L){throw L.code===12?n():L}if(e(this,_,g,T,y)){let L=c([this],_);A_(L,r(y))}return _}let A=Nc(_);if(A.name==="playbackRate"&&A.maxValue===1024)throw s();try{this._nativeAudioNode.connect(A,g),(y||$u(this))&&this._nativeAudioNode.disconnect(A,g)}catch(S){throw S.code===12?n():S}if(bZ(this,_,g,y)){let S=c([this],_);A_(S,r(y))}}disconnect(_,g,T){let b,y=u(this._context),A=m(y);if(_===void 0)b=CZ(this,A);else if(typeof _=="number"){if(_<0||_>=this.numberOfOutputs)throw o();b=EZ(this,A,_)}else{if(g!==void 0&&(g<0||g>=this.numberOfOutputs)||Mc(_)&&T!==void 0&&(T<0||T>=_.numberOfInputs))throw o();if(b=SZ(this,A,_,g,T),b.length===0)throw n()}for(let E of b){let S=c([this],E);A_(S,a)}}};var sP=bn(O6()),aP=(i,e,t,r,o,n,s,a,c,l,u,p,h)=>(d,m,f,x=null,_=null)=>{let g=new sP.AutomationEventList(f.defaultValue),T=m?r(g):null,b={get defaultValue(){return f.defaultValue},get maxValue(){return x===null?f.maxValue:x},get minValue(){return _===null?f.minValue:_},get value(){return f.value},set value(y){f.value=y,b.setValueAtTime(y,d.context.currentTime)},cancelAndHoldAtTime(y){if(typeof f.cancelAndHoldAtTime=="function")T===null&&g.flush(d.context.currentTime),g.add(o(y)),f.cancelAndHoldAtTime(y);else{let A=Array.from(g).pop();T===null&&g.flush(d.context.currentTime),g.add(o(y));let E=Array.from(g).pop();f.cancelScheduledValues(y),A!==E&&E!==void 0&&(E.type==="exponentialRampToValue"?f.exponentialRampToValueAtTime(E.value,E.endTime):E.type==="linearRampToValue"?f.linearRampToValueAtTime(E.value,E.endTime):E.type==="setValue"?f.setValueAtTime(E.value,E.startTime):E.type==="setValueCurve"&&f.setValueCurveAtTime(E.values,E.startTime,E.duration))}return b},cancelScheduledValues(y){return T===null&&g.flush(d.context.currentTime),g.add(n(y)),f.cancelScheduledValues(y),b},exponentialRampToValueAtTime(y,A){if(y===0)throw new RangeError;if(!Number.isFinite(A)||A<0)throw new RangeError;return T===null&&g.flush(d.context.currentTime),g.add(s(y,A)),f.exponentialRampToValueAtTime(y,A),b},linearRampToValueAtTime(y,A){return T===null&&g.flush(d.context.currentTime),g.add(a(y,A)),f.linearRampToValueAtTime(y,A),b},setTargetAtTime(y,A,E){return T===null&&g.flush(d.context.currentTime),g.add(c(y,A,E)),f.setTargetAtTime(y,A,E),b},setValueAtTime(y,A){return T===null&&g.flush(d.context.currentTime),g.add(l(y,A)),f.setValueAtTime(y,A),b},setValueCurveAtTime(y,A,E){let S=y instanceof Float32Array?y:new Float32Array(y);if(p!==null&&p.name==="webkitAudioContext"){let M=A+E,L=d.context.sampleRate,C=Math.ceil(A*L),N=Math.floor(M*L),D=N-C,k=new Float32Array(D);for(let F=0;F<D;F+=1){let X=(S.length-1)/E*((C+F)/L-A),$=Math.floor(X),Y=Math.ceil(X);k[F]=$===Y?S[$]:(1-(X-$))*S[$]+(1-(Y-X))*S[Y]}T===null&&g.flush(d.context.currentTime),g.add(u(k,A,E)),f.setValueCurveAtTime(k,A,E);let z=N/L;z<M&&h(b,k[k.length-1],z),h(b,S[S.length-1],M)}else T===null&&g.flush(d.context.currentTime),g.add(u(S,A,E)),f.setValueCurveAtTime(S,A,E);return b}};return t.set(b,f),e.set(b,d),i(b,T),b};var cP=i=>({replay(e){for(let t of i)if(t.type==="exponentialRampToValue"){let{endTime:r,value:o}=t;e.exponentialRampToValueAtTime(o,r)}else if(t.type==="linearRampToValue"){let{endTime:r,value:o}=t;e.linearRampToValueAtTime(o,r)}else if(t.type==="setTarget"){let{startTime:r,target:o,timeConstant:n}=t;e.setTargetAtTime(o,r,n)}else if(t.type==="setValue"){let{startTime:r,value:o}=t;e.setValueAtTime(o,r)}else if(t.type==="setValueCurve"){let{duration:r,startTime:o,values:n}=t;e.setValueCurveAtTime(n,o,r)}else throw new Error("Can't apply an unknown automation.")}});var Md=class{constructor(e){this._map=new Map(e)}get size(){return this._map.size}entries(){return this._map.entries()}forEach(e,t=null){return this._map.forEach((r,o)=>e.call(t,r,o,this))}get(e){return this._map.get(e)}has(e){return this._map.has(e)}keys(){return this._map.keys()}values(){return this._map.values()}};var wZ={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:1,numberOfOutputs:1,parameterData:{},processorOptions:{}},lP=(i,e,t,r,o,n,s,a,c,l,u,p,h,d)=>class extends e{constructor(f,x,_){var g;let T=a(f),b=c(T),y=u({...wZ,..._});h(y);let A=Ed.get(T),E=A==null?void 0:A.get(x),S=b||T.state!=="closed"?T:(g=s(T))!==null&&g!==void 0?g:T,M=o(S,b?null:f.baseLatency,l,x,E,y),L=b?r(x,y,E):null;super(f,!0,M,L);let C=[];M.parameters.forEach((D,k)=>{let z=t(this,b,D);C.push([k,z])}),this._nativeAudioWorkletNode=M,this._onprocessorerror=null,this._parameters=new Md(C),b&&i(T,this);let{activeInputs:N}=n(this);p(M,N)}get onprocessorerror(){return this._onprocessorerror}set onprocessorerror(f){let x=typeof f=="function"?d(this,f):null;this._nativeAudioWorkletNode.onprocessorerror=x;let _=this._nativeAudioWorkletNode.onprocessorerror;this._onprocessorerror=_!==null&&_===x?f:_}get parameters(){return this._parameters===null?this._nativeAudioWorkletNode.parameters:this._parameters}get port(){return this._nativeAudioWorkletNode.port}};function Ku(i,e,t,r,o){if(typeof i.copyFromChannel=="function")e[t].byteLength===0&&(e[t]=new Float32Array(128)),i.copyFromChannel(e[t],r,o);else{let n=i.getChannelData(r);if(e[t].byteLength===0)e[t]=n.slice(o,o+128);else{let s=new Float32Array(n.buffer,o*Float32Array.BYTES_PER_ELEMENT,128);e[t].set(s)}}}var C_=(i,e,t,r,o)=>{typeof i.copyToChannel=="function"?e[t].byteLength!==0&&i.copyToChannel(e[t],r,o):e[t].byteLength!==0&&i.getChannelData(r).set(e[t],o)};var Ju=(i,e)=>{let t=[];for(let r=0;r<i;r+=1){let o=[],n=typeof e=="number"?e:e[r];for(let s=0;s<n;s+=1)o.push(new Float32Array(128));t.push(o)}return t};var uP=(i,e)=>{let t=Ur(Sd,i),r=Kt(e);return Ur(t,r)};var MZ=async(i,e,t,r,o,n,s)=>{let a=e===null?Math.ceil(i.context.length/128)*128:e.length,c=r.channelCount*r.numberOfInputs,l=o.reduce((x,_)=>x+_,0),u=l===0?null:t.createBuffer(l,a,t.sampleRate);if(n===void 0)throw new Error("Missing the processor constructor.");let p=Kr(i),h=await uP(t,i),d=Ju(r.numberOfInputs,r.channelCount),m=Ju(r.numberOfOutputs,o),f=Array.from(i.parameters.keys()).reduce((x,_)=>({...x,[_]:new Float32Array(128)}),{});for(let x=0;x<a;x+=128){if(r.numberOfInputs>0&&e!==null)for(let _=0;_<r.numberOfInputs;_+=1)for(let g=0;g<r.channelCount;g+=1)Ku(e,d[_],g,g,x);n.parameterDescriptors!==void 0&&e!==null&&n.parameterDescriptors.forEach(({name:_},g)=>{Ku(e,f,_,c+g,x)});for(let _=0;_<r.numberOfInputs;_+=1)for(let g=0;g<o[_];g+=1)m[_][g].byteLength===0&&(m[_][g]=new Float32Array(128));try{let _=d.map((T,b)=>p.activeInputs[b].size===0?[]:T),g=s(x/t.sampleRate,t.sampleRate,()=>h.process(_,m,f));if(u!==null)for(let T=0,b=0;T<r.numberOfOutputs;T+=1){for(let y=0;y<o[T];y+=1)C_(u,m[T],y,b+y,x);b+=o[T]}if(!g)break}catch(_){i.dispatchEvent(new ErrorEvent("processorerror",{colno:_.colno,filename:_.filename,lineno:_.lineno,message:_.message}));break}}return u},pP=(i,e,t,r,o,n,s,a,c,l,u,p,h,d,m,f)=>(x,_,g)=>{let T=new WeakMap,b=null,y=async(A,E)=>{let S=u(A),M=null,L=Pt(S,E),C=Array.isArray(_.outputChannelCount)?_.outputChannelCount:Array.from(_.outputChannelCount);if(p===null){let N=C.reduce((F,X)=>F+X,0),D=o(E,{channelCount:Math.max(1,N),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,N)}),k=[];for(let F=0;F<A.numberOfOutputs;F+=1)k.push(r(E,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:C[F]}));let z=s(E,{channelCount:_.channelCount,channelCountMode:_.channelCountMode,channelInterpretation:_.channelInterpretation,gain:1});z.connect=e.bind(null,k),z.disconnect=c.bind(null,k),M=[D,k,z]}else L||(S=new p(E,x));if(T.set(E,M===null?S:M[2]),M!==null){if(b===null){if(g===void 0)throw new Error("Missing the processor constructor.");if(h===null)throw new Error("Missing the native OfflineAudioContext constructor.");let X=A.channelCount*A.numberOfInputs,$=g.parameterDescriptors===void 0?0:g.parameterDescriptors.length,Y=X+$;b=MZ(A,Y===0?null:await(async()=>{let B=new h(Y,Math.ceil(A.context.length/128)*128,E.sampleRate),te=[],q=[];for(let Ne=0;Ne<_.numberOfInputs;Ne+=1)te.push(s(B,{channelCount:_.channelCount,channelCountMode:_.channelCountMode,channelInterpretation:_.channelInterpretation,gain:1})),q.push(o(B,{channelCount:_.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:_.channelCount}));let j=await Promise.all(Array.from(A.parameters.values()).map(async Ne=>{let xe=n(B,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:Ne.value});return await d(B,Ne,xe.offset),xe})),R=r(B,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,X+$)});for(let Ne=0;Ne<_.numberOfInputs;Ne+=1){te[Ne].connect(q[Ne]);for(let xe=0;xe<_.channelCount;xe+=1)q[Ne].connect(R,xe,Ne*_.channelCount+xe)}for(let[Ne,xe]of j.entries())xe.connect(R,0,X+Ne),xe.start(0);return R.connect(B.destination),await Promise.all(te.map(Ne=>m(A,B,Ne))),f(B)})(),E,_,C,g,l)}let N=await b,D=t(E,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),[k,z,F]=M;N!==null&&(D.buffer=N,D.start(0)),D.connect(k);for(let X=0,$=0;X<A.numberOfOutputs;X+=1){let Y=z[X];for(let H=0;H<C[X];H+=1)k.connect(Y,$+H,H);$+=C[X]}return F}if(L)for(let[N,D]of A.parameters.entries())await i(E,D,S.parameters.get(N));else for(let[N,D]of A.parameters.entries())await d(E,D,S.parameters.get(N));return await m(A,E,S),S};return{render(A,E){a(E,A);let S=T.get(E);return S!==void 0?Promise.resolve(S):y(A,E)}}};var hP=(i,e,t,r,o,n,s,a,c,l,u,p,h,d,m,f,x,_,g,T)=>class extends m{constructor(y,A){super(y,A);this._nativeContext=y,this._audioWorklet=i===void 0?void 0:{addModule:(E,S)=>i(this,E,S)}}get audioWorklet(){return this._audioWorklet}createAnalyser(){return new e(this)}createBiquadFilter(){return new o(this)}createBuffer(y,A,E){return new t({length:A,numberOfChannels:y,sampleRate:E})}createBufferSource(){return new r(this)}createChannelMerger(y=6){return new n(this,{numberOfInputs:y})}createChannelSplitter(y=6){return new s(this,{numberOfOutputs:y})}createConstantSource(){return new a(this)}createConvolver(){return new c(this)}createDelay(y=1){return new u(this,{maxDelayTime:y})}createDynamicsCompressor(){return new p(this)}createGain(){return new h(this)}createIIRFilter(y,A){return new d(this,{feedback:A,feedforward:y})}createOscillator(){return new f(this)}createPanner(){return new x(this)}createPeriodicWave(y,A,E={disableNormalization:!1}){return new _(this,{...E,imag:A,real:y})}createStereoPanner(){return new g(this)}createWaveShaper(){return new T(this)}decodeAudioData(y,A,E){return l(this._nativeContext,y).then(S=>(typeof A=="function"&&A(S),S),S=>{throw typeof E=="function"&&E(S),S})}};var NZ={Q:1,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:350,gain:0,type:"lowpass"},dP=(i,e,t,r,o,n,s,a)=>class extends i{constructor(l,u){let p=n(l),h={...NZ,...u},d=o(p,h),m=s(p),f=m?t():null;super(l,!1,d,f);this._Q=e(this,m,d.Q,Sr,Rr),this._detune=e(this,m,d.detune,1200*Math.log2(Sr),-1200*Math.log2(Sr)),this._frequency=e(this,m,d.frequency,l.sampleRate/2,0),this._gain=e(this,m,d.gain,40*Math.log10(Sr),Rr),this._nativeBiquadFilterNode=d,a(this,1)}get detune(){return this._detune}get frequency(){return this._frequency}get gain(){return this._gain}get Q(){return this._Q}get type(){return this._nativeBiquadFilterNode.type}set type(l){this._nativeBiquadFilterNode.type=l}getFrequencyResponse(l,u,p){try{this._nativeBiquadFilterNode.getFrequencyResponse(l,u,p)}catch(h){throw h.code===11?r():h}if(l.length!==u.length||u.length!==p.length)throw r()}};var fP=(i,e,t,r,o)=>()=>{let n=new WeakMap,s=async(a,c)=>{let l=t(a),u=Pt(l,c);if(!u){let p={Q:l.Q.value,channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,detune:l.detune.value,frequency:l.frequency.value,gain:l.gain.value,type:l.type};l=e(c,p)}return n.set(c,l),u?(await i(c,a.Q,l.Q),await i(c,a.detune,l.detune),await i(c,a.frequency,l.frequency),await i(c,a.gain,l.gain)):(await r(c,a.Q,l.Q),await r(c,a.detune,l.detune),await r(c,a.frequency,l.frequency),await r(c,a.gain,l.gain)),await o(a,c,l),l};return{render(a,c){let l=n.get(c);return l!==void 0?Promise.resolve(l):s(a,c)}}};var mP=(i,e)=>(t,r)=>{let o=e.get(t);if(o!==void 0)return o;let n=i.get(t);if(n!==void 0)return n;try{let s=r();return s instanceof Promise?(i.set(t,s),s.catch(()=>!1).then(a=>(i.delete(t),e.set(t,a),a))):(e.set(t,s),s)}catch{return e.set(t,!1),!1}};var OZ={channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6},_P=(i,e,t,r,o)=>class extends i{constructor(s,a){let c=r(s),l={...OZ,...a},u=t(c,l),p=o(c)?e():null;super(s,!1,u,p)}};var gP=(i,e,t)=>()=>{let r=new WeakMap,o=async(n,s)=>{let a=e(n);if(!Pt(a,s)){let l={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,numberOfInputs:a.numberOfInputs};a=i(s,l)}return r.set(s,a),await t(n,s,a),a};return{render(n,s){let a=r.get(s);return a!==void 0?Promise.resolve(a):o(n,s)}}};var PZ={channelCount:6,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:6},vP=(i,e,t,r,o,n)=>class extends i{constructor(a,c){let l=r(a),u=n({...PZ,...c}),p=t(l,u),h=o(l)?e():null;super(a,!1,p,h)}};var xP=(i,e,t)=>()=>{let r=new WeakMap,o=async(n,s)=>{let a=e(n);if(!Pt(a,s)){let l={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,numberOfOutputs:a.numberOfOutputs};a=i(s,l)}return r.set(s,a),await t(n,s,a),a};return{render(n,s){let a=r.get(s);return a!==void 0?Promise.resolve(a):o(n,s)}}};var yP=i=>(e,t,r)=>i(t,e,r);var bP=i=>(e,t,r=0,o=0)=>{let n=e[r];if(n===void 0)throw i();return Oc(t)?n.connect(t,0,o):n.connect(t,0)};var TP=i=>(e,t)=>{let r=i(e,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),o=e.createBuffer(1,2,44100);return r.buffer=o,r.loop=!0,r.connect(t),r.start(),()=>{r.stop(),r.disconnect(t)}};var RZ={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",offset:1},AP=(i,e,t,r,o,n,s)=>class extends i{constructor(c,l){let u=o(c),p={...RZ,...l},h=r(u,p),d=n(u),m=d?t():null;super(c,!1,h,m);this._constantSourceNodeRenderer=m,this._nativeConstantSourceNode=h,this._offset=e(this,d,h.offset,Sr,Rr),this._onended=null}get offset(){return this._offset}get onended(){return this._onended}set onended(c){let l=typeof c=="function"?s(this,c):null;this._nativeConstantSourceNode.onended=l;let u=this._nativeConstantSourceNode.onended;this._onended=u!==null&&u===l?c:u}start(c=0){if(this._nativeConstantSourceNode.start(c),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.start=c),this.context.state!=="closed"){Ln(this);let l=()=>{this._nativeConstantSourceNode.removeEventListener("ended",l),Yo(this)&&Es(this)};this._nativeConstantSourceNode.addEventListener("ended",l)}}stop(c=0){this._nativeConstantSourceNode.stop(c),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.stop=c)}};var CP=(i,e,t,r,o)=>()=>{let n=new WeakMap,s=null,a=null,c=async(l,u)=>{let p=t(l),h=Pt(p,u);if(!h){let d={channelCount:p.channelCount,channelCountMode:p.channelCountMode,channelInterpretation:p.channelInterpretation,offset:p.offset.value};p=e(u,d),s!==null&&p.start(s),a!==null&&p.stop(a)}return n.set(u,p),h?await i(u,l.offset,p.offset):await r(u,l.offset,p.offset),await o(l,u,p),p};return{set start(l){s=l},set stop(l){a=l},render(l,u){let p=n.get(u);return p!==void 0?Promise.resolve(p):c(l,u)}}};var EP=i=>e=>(i[0]=e,i[0]);var LZ={buffer:null,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",disableNormalization:!1},SP=(i,e,t,r,o,n)=>class extends i{constructor(a,c){let l=r(a),u={...LZ,...c},p=t(l,u),d=o(l)?e():null;super(a,!1,p,d);this._isBufferNullified=!1,this._nativeConvolverNode=p,u.buffer!==null&&n(this,u.buffer.duration)}get buffer(){return this._isBufferNullified?null:this._nativeConvolverNode.buffer}set buffer(a){if(this._nativeConvolverNode.buffer=a,a===null&&this._nativeConvolverNode.buffer!==null){let c=this._nativeConvolverNode.context;this._nativeConvolverNode.buffer=c.createBuffer(1,1,44100),this._isBufferNullified=!0,n(this,0)}else this._isBufferNullified=!1,n(this,this._nativeConvolverNode.buffer===null?0:this._nativeConvolverNode.buffer.duration)}get normalize(){return this._nativeConvolverNode.normalize}set normalize(a){this._nativeConvolverNode.normalize=a}};var wP=(i,e,t)=>()=>{let r=new WeakMap,o=async(n,s)=>{let a=e(n);if(!Pt(a,s)){let l={buffer:a.buffer,channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,disableNormalization:!a.normalize};a=i(s,l)}return r.set(s,a),an(a)?await t(n,s,a.inputs[0]):await t(n,s,a),a};return{render(n,s){let a=r.get(s);return a!==void 0?Promise.resolve(a):o(n,s)}}};var MP=(i,e)=>(t,r,o)=>{if(e===null)throw new Error("Missing the native OfflineAudioContext constructor.");try{return new e(t,r,o)}catch(n){throw n.name==="SyntaxError"?i():n}};var NP=()=>new DOMException("","DataCloneError");var V6=i=>{let{port1:e,port2:t}=new MessageChannel;return new Promise(r=>{let o=()=>{t.onmessage=null,e.close(),t.close(),r()};t.onmessage=()=>o();try{e.postMessage(i,[i])}finally{o()}})};var OP=(i,e,t,r,o,n,s,a,c,l,u)=>(p,h)=>{let d=s(p)?p:n(p);if(o.has(h)){let m=t();return Promise.reject(m)}try{o.add(h)}catch{}return e(c,()=>c(d))?d.decodeAudioData(h).then(m=>(V6(h).catch(()=>{}),e(a,()=>a(m))||u(m),i.add(m),m)):new Promise((m,f)=>{let x=async()=>{try{await V6(h)}catch{}},_=g=>{f(g),x()};try{d.decodeAudioData(h,g=>{typeof g.copyFromChannel!="function"&&(l(g),qu(g)),i.add(g),x().then(()=>m(g))},g=>{_(g===null?r():g)})}catch(g){_(g)}})};var PP=(i,e,t,r,o,n,s,a)=>(c,l)=>{let u=e.get(c);if(u===void 0)throw new Error("Missing the expected cycle count.");let p=n(c.context),h=a(p);if(u===l){if(e.delete(c),!h&&s(c)){let d=r(c),{outputs:m}=t(c);for(let f of m)if(ha(f)){let x=r(f[0]);i(d,x,f[1],f[2])}else{let x=o(f[0]);d.connect(x,f[1])}}}else e.set(c,u-l)};var IZ={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",delayTime:0,maxDelayTime:1},RP=(i,e,t,r,o,n,s)=>class extends i{constructor(c,l){let u=o(c),p={...IZ,...l},h=r(u,p),d=n(u),m=d?t(p.maxDelayTime):null;super(c,!1,h,m);this._delayTime=e(this,d,h.delayTime),s(this,p.maxDelayTime)}get delayTime(){return this._delayTime}};var LP=(i,e,t,r,o)=>n=>{let s=new WeakMap,a=async(c,l)=>{let u=t(c),p=Pt(u,l);if(!p){let h={channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,delayTime:u.delayTime.value,maxDelayTime:n};u=e(l,h)}return s.set(l,u),p?await i(l,c.delayTime,u.delayTime):await r(l,c.delayTime,u.delayTime),await o(c,l,u),u};return{render(c,l){let u=s.get(l);return u!==void 0?Promise.resolve(u):a(c,l)}}};var IP=i=>(e,t,r,o)=>i(e[o],n=>n[0]===t&&n[1]===r);var DP=i=>(e,t)=>{i(e).delete(t)};var kP=i=>"delayTime"in i;var BP=(i,e,t)=>function r(o,n){let s=Mc(n)?n:t(i,n);if(kP(s))return[];if(o[0]===s)return[o];if(o.includes(s))return[];let{outputs:a}=e(s);return Array.from(a).map(c=>r([...o,s],c[0])).reduce((c,l)=>c.concat(l),[])};var E_=(i,e,t)=>{let r=e[t];if(r===void 0)throw i();return r},FP=i=>(e,t=void 0,r=void 0,o=0)=>t===void 0?e.forEach(n=>n.disconnect()):typeof t=="number"?E_(i,e,t).disconnect():Oc(t)?r===void 0?e.forEach(n=>n.disconnect(t)):o===void 0?E_(i,e,r).disconnect(t,0):E_(i,e,r).disconnect(t,0,o):r===void 0?e.forEach(n=>n.disconnect(t)):E_(i,e,r).disconnect(t,0);var DZ={attack:.003,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",knee:30,ratio:12,release:.25,threshold:-24},UP=(i,e,t,r,o,n,s,a)=>class extends i{constructor(l,u){let p=n(l),h={...DZ,...u},d=r(p,h),m=s(p),f=m?t():null;super(l,!1,d,f);this._attack=e(this,m,d.attack),this._knee=e(this,m,d.knee),this._nativeDynamicsCompressorNode=d,this._ratio=e(this,m,d.ratio),this._release=e(this,m,d.release),this._threshold=e(this,m,d.threshold),a(this,.006)}get attack(){return this._attack}get channelCount(){return this._nativeDynamicsCompressorNode.channelCount}set channelCount(l){let u=this._nativeDynamicsCompressorNode.channelCount;if(this._nativeDynamicsCompressorNode.channelCount=l,l>2)throw this._nativeDynamicsCompressorNode.channelCount=u,o()}get channelCountMode(){return this._nativeDynamicsCompressorNode.channelCountMode}set channelCountMode(l){let u=this._nativeDynamicsCompressorNode.channelCountMode;if(this._nativeDynamicsCompressorNode.channelCountMode=l,l==="max")throw this._nativeDynamicsCompressorNode.channelCountMode=u,o()}get knee(){return this._knee}get ratio(){return this._ratio}get reduction(){return typeof this._nativeDynamicsCompressorNode.reduction.value=="number"?this._nativeDynamicsCompressorNode.reduction.value:this._nativeDynamicsCompressorNode.reduction}get release(){return this._release}get threshold(){return this._threshold}};var VP=(i,e,t,r,o)=>()=>{let n=new WeakMap,s=async(a,c)=>{let l=t(a),u=Pt(l,c);if(!u){let p={attack:l.attack.value,channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,knee:l.knee.value,ratio:l.ratio.value,release:l.release.value,threshold:l.threshold.value};l=e(c,p)}return n.set(c,l),u?(await i(c,a.attack,l.attack),await i(c,a.knee,l.knee),await i(c,a.ratio,l.ratio),await i(c,a.release,l.release),await i(c,a.threshold,l.threshold)):(await r(c,a.attack,l.attack),await r(c,a.knee,l.knee),await r(c,a.ratio,l.ratio),await r(c,a.release,l.release),await r(c,a.threshold,l.threshold)),await o(a,c,l),l};return{render(a,c){let l=n.get(c);return l!==void 0?Promise.resolve(l):s(a,c)}}};var GP=()=>new DOMException("","EncodingError");var zP=i=>e=>new Promise((t,r)=>{if(i===null){r(new SyntaxError);return}let o=i.document.head;if(o===null)r(new SyntaxError);else{let n=i.document.createElement("script"),s=new Blob([e],{type:"application/javascript"}),a=URL.createObjectURL(s),c=i.onerror,l=()=>{i.onerror=c,URL.revokeObjectURL(a)};i.onerror=(u,p,h,d,m)=>{if(p===a||p===i.location.href&&h===1&&d===1)return l(),r(m),!1;if(c!==null)return c(u,p,h,d,m)},n.onerror=()=>{l(),r(new SyntaxError)},n.onload=()=>{l(),t()},n.src=a,n.type="module",o.appendChild(n)}});var HP=i=>class{constructor(t){this._nativeEventTarget=t,this._listeners=new WeakMap}addEventListener(t,r,o){if(r!==null){let n=this._listeners.get(r);n===void 0&&(n=i(this,r),typeof r=="function"&&this._listeners.set(r,n)),this._nativeEventTarget.addEventListener(t,n,o)}}dispatchEvent(t){return this._nativeEventTarget.dispatchEvent(t)}removeEventListener(t,r,o){let n=r===null?void 0:this._listeners.get(r);this._nativeEventTarget.removeEventListener(t,n===void 0?null:n,o)}};var jP=i=>(e,t,r)=>{Object.defineProperties(i,{currentFrame:{configurable:!0,get(){return Math.round(e*t)}},currentTime:{configurable:!0,get(){return e}}});try{return r()}finally{i!==null&&(delete i.currentFrame,delete i.currentTime)}};var WP=i=>async e=>{try{let t=await fetch(e);if(t.ok)return[await t.text(),t.url]}catch{}throw i()};var kZ={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",gain:1},qP=(i,e,t,r,o,n)=>class extends i{constructor(a,c){let l=o(a),u={...kZ,...c},p=r(l,u),h=n(l),d=h?t():null;super(a,!1,p,d);this._gain=e(this,h,p.gain,Sr,Rr)}get gain(){return this._gain}};var XP=(i,e,t,r,o)=>()=>{let n=new WeakMap,s=async(a,c)=>{let l=t(a),u=Pt(l,c);if(!u){let p={channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,gain:l.gain.value};l=e(c,p)}return n.set(c,l),u?await i(c,a.gain,l.gain):await r(c,a.gain,l.gain),await o(a,c,l),l};return{render(a,c){let l=n.get(c);return l!==void 0?Promise.resolve(l):s(a,c)}}};var YP=(i,e)=>t=>e(i,t);var $P=i=>e=>{let t=i(e);if(t.renderer===null)throw new Error("Missing the renderer of the given AudioNode in the audio graph.");return t.renderer};var KP=i=>e=>{var t;return(t=i.get(e))!==null&&t!==void 0?t:0};var JP=i=>e=>{let t=i(e);if(t.renderer===null)throw new Error("Missing the renderer of the given AudioParam in the audio graph.");return t.renderer};var ZP=i=>e=>i.get(e);var _r=()=>new DOMException("","InvalidStateError");var QP=i=>e=>{let t=i.get(e);if(t===void 0)throw _r();return t};var eR=(i,e)=>t=>{let r=i.get(t);if(r!==void 0)return r;if(e===null)throw new Error("Missing the native OfflineAudioContext constructor.");return r=new e(1,1,44100),i.set(t,r),r};var tR=i=>e=>{let t=i.get(e);if(t===void 0)throw new Error("The context has no set of AudioWorkletNodes.");return t};var Zu=()=>new DOMException("","InvalidAccessError");var rR=i=>{i.getFrequencyResponse=(e=>(t,r,o)=>{if(t.length!==r.length||r.length!==o.length)throw Zu();return e.call(i,t,r,o)})(i.getFrequencyResponse)};var BZ={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers"},oR=(i,e,t,r,o,n)=>class extends i{constructor(a,c){let l=r(a),u=o(l),p={...BZ,...c},h=e(l,u?null:a.baseLatency,p),d=u?t(p.feedback,p.feedforward):null;super(a,!1,h,d);rR(h),this._nativeIIRFilterNode=h,n(this,1)}getFrequencyResponse(a,c,l){return this._nativeIIRFilterNode.getFrequencyResponse(a,c,l)}};var S_=(i,e,t,r,o,n,s,a,c,l,u)=>{let p=l.length,h=a;for(let d=0;d<p;d+=1){let m=t[0]*l[d];for(let f=1;f<o;f+=1){let x=h-f&c-1;m+=t[f]*n[x],m-=i[f]*s[x]}for(let f=o;f<r;f+=1)m+=t[f]*n[h-f&c-1];for(let f=o;f<e;f+=1)m-=i[f]*s[h-f&c-1];n[h]=l[d],s[h]=m,h=h+1&c-1,u[d]=m}return h};var FZ=(i,e,t,r)=>{let o=t instanceof Float64Array?t:new Float64Array(t),n=r instanceof Float64Array?r:new Float64Array(r),s=o.length,a=n.length,c=Math.min(s,a);if(o[0]!==1){for(let m=0;m<s;m+=1)n[m]/=o[0];for(let m=1;m<a;m+=1)o[m]/=o[0]}let l=32,u=new Float32Array(l),p=new Float32Array(l),h=e.createBuffer(i.numberOfChannels,i.length,i.sampleRate),d=i.numberOfChannels;for(let m=0;m<d;m+=1){let f=i.getChannelData(m),x=h.getChannelData(m);u.fill(0),p.fill(0),S_(o,s,n,a,c,u,p,0,l,f,x)}return h},iR=(i,e,t,r,o)=>(n,s)=>{let a=new WeakMap,c=null,l=async(u,p)=>{let h=null,d=e(u),m=Pt(d,p);if(p.createIIRFilter===void 0?h=i(p,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}):m||(d=p.createIIRFilter(s,n)),a.set(p,h===null?d:h),h!==null){if(c===null){if(t===null)throw new Error("Missing the native OfflineAudioContext constructor.");let x=new t(u.context.destination.channelCount,u.context.length,p.sampleRate);c=(async()=>{await r(u,x,x.destination);let _=await o(x);return FZ(_,p,n,s)})()}let f=await c;return h.buffer=f,h.start(0),h}return await r(u,p,d),d};return{render(u,p){let h=a.get(p);return h!==void 0?Promise.resolve(h):l(u,p)}}};var nR=(i,e,t,r,o,n)=>s=>(a,c)=>{let l=i.get(a);if(l===void 0){if(!s&&n(a)){let u=r(a),{outputs:p}=t(a);for(let h of p)if(ha(h)){let d=r(h[0]);e(u,d,h[1],h[2])}else{let d=o(h[0]);u.disconnect(d,h[1])}}i.set(a,c)}else i.set(a,l+c)};var sR=(i,e)=>t=>{let r=i.get(t);return e(r)||e(t)};var aR=(i,e)=>t=>i.has(t)||e(t);var cR=(i,e)=>t=>i.has(t)||e(t);var lR=(i,e)=>t=>{let r=i.get(t);return e(r)||e(t)};var uR=i=>e=>i!==null&&e instanceof i;var pR=i=>e=>i!==null&&typeof i.AudioNode=="function"&&e instanceof i.AudioNode;var hR=i=>e=>i!==null&&typeof i.AudioParam=="function"&&e instanceof i.AudioParam;var dR=(i,e)=>t=>i(t)||e(t);var fR=i=>e=>i!==null&&e instanceof i;var mR=i=>i!==null&&i.isSecureContext;var _R=(i,e,t,r)=>class extends i{constructor(n,s){let a=t(n),c=e(a,s);if(r(a))throw TypeError();super(n,!0,c,null);this._nativeMediaElementAudioSourceNode=c}get mediaElement(){return this._nativeMediaElementAudioSourceNode.mediaElement}};var UZ={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers"},gR=(i,e,t,r)=>class extends i{constructor(n,s){let a=t(n);if(r(a))throw new TypeError;let c={...UZ,...s},l=e(a,c);super(n,!1,l,null);this._nativeMediaStreamAudioDestinationNode=l}get stream(){return this._nativeMediaStreamAudioDestinationNode.stream}};var vR=(i,e,t,r)=>class extends i{constructor(n,s){let a=t(n),c=e(a,s);if(r(a))throw new TypeError;super(n,!0,c,null);this._nativeMediaStreamAudioSourceNode=c}get mediaStream(){return this._nativeMediaStreamAudioSourceNode.mediaStream}};var xR=(i,e,t)=>class extends i{constructor(o,n){let s=t(o),a=e(s,n);super(o,!0,a,null)}};var yR=(i,e,t,r,o)=>class extends r{constructor(s={}){if(o===null)throw new Error("Missing the native AudioContext constructor.");let a;try{a=new o(s)}catch(u){throw u.code===12&&u.message==="sampleRate is not in range"?e():u}if(a===null)throw t();if(!T_(s.latencyHint))throw new TypeError(`The provided value '${s.latencyHint}' is not a valid enum value of type AudioContextLatencyCategory.`);if(s.sampleRate!==void 0&&a.sampleRate!==s.sampleRate)throw e();super(a,2);let{latencyHint:c}=s,{sampleRate:l}=a;if(this._baseLatency=typeof a.baseLatency=="number"?a.baseLatency:c==="balanced"?512/l:c==="interactive"||c===void 0?256/l:c==="playback"?1024/l:Math.max(2,Math.min(128,Math.round(c*l/128)))*128/l,this._nativeAudioContext=a,o.name==="webkitAudioContext"?(this._nativeGainNode=a.createGain(),this._nativeOscillatorNode=a.createOscillator(),this._nativeGainNode.gain.value=1e-37,this._nativeOscillatorNode.connect(this._nativeGainNode).connect(a.destination),this._nativeOscillatorNode.start()):(this._nativeGainNode=null,this._nativeOscillatorNode=null),this._state=null,a.state==="running"){this._state="suspended";let u=()=>{this._state==="suspended"&&(this._state=null),a.removeEventListener("statechange",u)};a.addEventListener("statechange",u)}}get baseLatency(){return this._baseLatency}get state(){return this._state!==null?this._state:this._nativeAudioContext.state}close(){return this.state==="closed"?this._nativeAudioContext.close().then(()=>{throw i()}):(this._state==="suspended"&&(this._state=null),this._nativeAudioContext.close().then(()=>{this._nativeGainNode!==null&&this._nativeOscillatorNode!==null&&(this._nativeOscillatorNode.stop(),this._nativeGainNode.disconnect(),this._nativeOscillatorNode.disconnect()),pa(this)}))}resume(){return this._state==="suspended"?new Promise((s,a)=>{let c=()=>{this._nativeAudioContext.removeEventListener("statechange",c),this._nativeAudioContext.state==="running"?s():this.resume().then(s,a)};this._nativeAudioContext.addEventListener("statechange",c)}):this._nativeAudioContext.resume().catch(s=>{throw s===void 0||s.code===15?i():s})}suspend(){return this._nativeAudioContext.suspend().catch(s=>{throw s===void 0?i():s})}};var bR=(i,e,t,r,o,n)=>class extends t{constructor(a,c){super(a);this._nativeContext=a,ju.set(this,a),r(a)&&o.set(a,new Set),this._destination=new i(this,c),this._listener=e(this,a),this._onstatechange=null}get currentTime(){return this._nativeContext.currentTime}get destination(){return this._destination}get listener(){return this._listener}get onstatechange(){return this._onstatechange}set onstatechange(a){let c=typeof a=="function"?n(this,a):null;this._nativeContext.onstatechange=c;let l=this._nativeContext.onstatechange;this._onstatechange=l!==null&&l===c?a:l}get sampleRate(){return this._nativeContext.sampleRate}get state(){return this._nativeContext.state}};var Dn=i=>{let e=new Uint32Array([1179011410,40,1163280727,544501094,16,131073,44100,176400,1048580,1635017060,4,0]);try{let t=i.decodeAudioData(e.buffer,()=>{});return t===void 0?!1:(t.catch(()=>{}),!0)}catch{}return!1};var VZ={numberOfChannels:1},TR=(i,e,t,r,o)=>class extends r{constructor(s){let{length:a,numberOfChannels:c,sampleRate:l}={...VZ,...s},u=t(c,a,l);i(Dn,()=>Dn(u))||u.addEventListener("statechange",(()=>{let p=0,h=d=>{this._state==="running"&&(p>0?(u.removeEventListener("statechange",h),d.stopImmediatePropagation(),this._waitForThePromiseToSettle(d)):p+=1)};return h})());super(u,c);this._length=a,this._nativeOfflineAudioContext=u,this._state=null}get length(){return this._nativeOfflineAudioContext.length===void 0?this._length:this._nativeOfflineAudioContext.length}get state(){return this._state===null?this._nativeOfflineAudioContext.state:this._state}startRendering(){return this._state==="running"?Promise.reject(e()):(this._state="running",o(this.destination,this._nativeOfflineAudioContext).finally(()=>{this._state=null,pa(this)}))}_waitForThePromiseToSettle(s){this._state===null?this._nativeOfflineAudioContext.dispatchEvent(s):setTimeout(()=>this._waitForThePromiseToSettle(s))}};var AR=(i,e)=>(t,r,o)=>{let n=new Set;return t.connect=(s=>(a,c=0,l=0)=>{let u=n.size===0;if(e(a))return s.call(t,a,c,l),i(n,[a,c,l],p=>p[0]===a&&p[1]===c&&p[2]===l,!0),u&&r(),a;s.call(t,a,c),i(n,[a,c],p=>p[0]===a&&p[1]===c,!0),u&&r()})(t.connect),t.disconnect=(s=>(a,c,l)=>{let u=n.size>0;if(a===void 0)s.apply(t),n.clear();else if(typeof a=="number"){s.call(t,a);for(let h of n)h[1]===a&&n.delete(h)}else{e(a)?s.call(t,a,c,l):s.call(t,a,c);for(let h of n)h[0]===a&&(c===void 0||h[1]===c)&&(l===void 0||h[2]===l)&&n.delete(h)}let p=n.size===0;u&&p&&o()})(t.disconnect),t};var Rt=(i,e,t)=>{let r=e[t];r!==void 0&&r!==i[t]&&(i[t]=r)};var xt=(i,e)=>{Rt(i,e,"channelCount"),Rt(i,e,"channelCountMode"),Rt(i,e,"channelInterpretation")};var G6=i=>typeof i.getFloatTimeDomainData=="function";var CR=i=>{i.getFloatTimeDomainData=e=>{let t=new Uint8Array(e.length);i.getByteTimeDomainData(t);let r=Math.max(t.length,i.fftSize);for(let o=0;o<r;o+=1)e[o]=(t[o]-128)*.0078125;return e}};var ER=(i,e)=>(t,r)=>{let o=t.createAnalyser();if(xt(o,r),!(r.maxDecibels>r.minDecibels))throw e();return Rt(o,r,"fftSize"),Rt(o,r,"maxDecibels"),Rt(o,r,"minDecibels"),Rt(o,r,"smoothingTimeConstant"),i(G6,()=>G6(o))||CR(o),o};var SR=i=>i===null?null:i.hasOwnProperty("AudioBuffer")?i.AudioBuffer:null;var Vt=(i,e,t)=>{let r=e[t];r!==void 0&&r!==i[t].value&&(i[t].value=r)};var wR=i=>{i.start=(e=>{let t=!1;return(r=0,o=0,n)=>{if(t)throw _r();e.call(i,r,o,n),t=!0}})(i.start)};var Qu=i=>{i.start=(e=>(t=0,r=0,o)=>{if(typeof o=="number"&&o<0||r<0||t<0)throw new RangeError("The parameters can't be negative.");e.call(i,t,r,o)})(i.start)};var ep=i=>{i.stop=(e=>(t=0)=>{if(t<0)throw new RangeError("The parameter can't be negative.");e.call(i,t)})(i.stop)};var MR=(i,e,t,r,o,n,s,a,c,l,u)=>(p,h)=>{let d=p.createBufferSource();return xt(d,h),Vt(d,h,"playbackRate"),Rt(d,h,"buffer"),Rt(d,h,"loop"),Rt(d,h,"loopEnd"),Rt(d,h,"loopStart"),e(t,()=>t(p))||wR(d),e(r,()=>r(p))||c(d),e(o,()=>o(p))||l(d,p),e(n,()=>n(p))||Qu(d),e(s,()=>s(p))||u(d,p),e(a,()=>a(p))||ep(d),i(p,d),d};var NR=i=>i===null?null:i.hasOwnProperty("AudioContext")?i.AudioContext:i.hasOwnProperty("webkitAudioContext")?i.webkitAudioContext:null;var OR=(i,e)=>(t,r,o)=>{let n=t.destination;if(n.channelCount!==r)try{n.channelCount=r}catch{}o&&n.channelCountMode!=="explicit"&&(n.channelCountMode="explicit"),n.maxChannelCount===0&&Object.defineProperty(n,"maxChannelCount",{value:r});let s=i(t,{channelCount:r,channelCountMode:n.channelCountMode,channelInterpretation:n.channelInterpretation,gain:1});return e(s,"channelCount",a=>()=>a.call(s),a=>c=>{a.call(s,c);try{n.channelCount=c}catch(l){if(c>n.maxChannelCount)throw l}}),e(s,"channelCountMode",a=>()=>a.call(s),a=>c=>{a.call(s,c),n.channelCountMode=c}),e(s,"channelInterpretation",a=>()=>a.call(s),a=>c=>{a.call(s,c),n.channelInterpretation=c}),Object.defineProperty(s,"maxChannelCount",{get:()=>n.maxChannelCount}),s.connect(n),s};var PR=i=>i===null?null:i.hasOwnProperty("AudioWorkletNode")?i.AudioWorkletNode:null;var RR=i=>{let{port1:e}=new MessageChannel;try{e.postMessage(i)}finally{e.close()}};var LR=(i,e,t,r,o)=>(n,s,a,c,l,u)=>{if(a!==null)try{let p=new a(n,c,u),h=new Map,d=null;if(Object.defineProperties(p,{channelCount:{get:()=>u.channelCount,set:()=>{throw i()}},channelCountMode:{get:()=>"explicit",set:()=>{throw i()}},onprocessorerror:{get:()=>d,set:m=>{typeof d=="function"&&p.removeEventListener("processorerror",d),d=typeof m=="function"?m:null,typeof d=="function"&&p.addEventListener("processorerror",d)}}}),p.addEventListener=(m=>(...f)=>{if(f[0]==="processorerror"){let x=typeof f[1]=="function"?f[1]:typeof f[1]=="object"&&f[1]!==null&&typeof f[1].handleEvent=="function"?f[1].handleEvent:null;if(x!==null){let _=h.get(f[1]);_!==void 0?f[1]=_:(f[1]=g=>{g.type==="error"?(Object.defineProperties(g,{type:{value:"processorerror"}}),x(g)):x(new ErrorEvent(f[0],{...g}))},h.set(x,f[1]))}}return m.call(p,"error",f[1],f[2]),m.call(p,...f)})(p.addEventListener),p.removeEventListener=(m=>(...f)=>{if(f[0]==="processorerror"){let x=h.get(f[1]);x!==void 0&&(h.delete(f[1]),f[1]=x)}return m.call(p,"error",f[1],f[2]),m.call(p,f[0],f[1],f[2])})(p.removeEventListener),u.numberOfOutputs!==0){let m=t(n,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return p.connect(m).connect(n.destination),o(p,()=>m.disconnect(),()=>m.connect(n.destination))}return p}catch(p){throw p.code===11?r():p}if(l===void 0)throw r();return RR(u),e(n,s,l,u)};var w_=(i,e)=>i===null?512:Math.max(512,Math.min(16384,Math.pow(2,Math.round(Math.log2(i*e)))));var IR=i=>new Promise((e,t)=>{let{port1:r,port2:o}=new MessageChannel;r.onmessage=({data:n})=>{r.close(),o.close(),e(n)},r.onmessageerror=({data:n})=>{r.close(),o.close(),t(n)},o.postMessage(i)});var DR=async(i,e)=>{let t=await IR(e);return new i(t)};var kR=(i,e,t,r)=>{let o=Sd.get(i);o===void 0&&(o=new WeakMap,Sd.set(i,o));let n=DR(t,r);return o.set(e,n),n};var BR=(i,e,t,r,o,n,s,a,c,l,u,p,h)=>(d,m,f,x)=>{if(x.numberOfInputs===0&&x.numberOfOutputs===0)throw c();let _=Array.isArray(x.outputChannelCount)?x.outputChannelCount:Array.from(x.outputChannelCount);if(_.some(ie=>ie<1))throw c();if(_.length!==x.numberOfOutputs)throw e();if(x.channelCountMode!=="explicit")throw c();let g=x.channelCount*x.numberOfInputs,T=_.reduce((ie,de)=>ie+de,0),b=f.parameterDescriptors===void 0?0:f.parameterDescriptors.length;if(g+b>6||T>6)throw c();let y=new MessageChannel,A=[],E=[];for(let ie=0;ie<x.numberOfInputs;ie+=1)A.push(s(d,{channelCount:x.channelCount,channelCountMode:x.channelCountMode,channelInterpretation:x.channelInterpretation,gain:1})),E.push(o(d,{channelCount:x.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:x.channelCount}));let S=[];if(f.parameterDescriptors!==void 0)for(let{defaultValue:ie,maxValue:de,minValue:we,name:Ee}of f.parameterDescriptors){let Pe=n(d,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:x.parameterData[Ee]!==void 0?x.parameterData[Ee]:ie===void 0?0:ie});Object.defineProperties(Pe.offset,{defaultValue:{get:()=>ie===void 0?0:ie},maxValue:{get:()=>de===void 0?Sr:de},minValue:{get:()=>we===void 0?Rr:we}}),S.push(Pe)}let M=r(d,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,g+b)}),L=w_(m,d.sampleRate),C=a(d,L,g+b,Math.max(1,T)),N=o(d,{channelCount:Math.max(1,T),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,T)}),D=[];for(let ie=0;ie<x.numberOfOutputs;ie+=1)D.push(r(d,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:_[ie]}));for(let ie=0;ie<x.numberOfInputs;ie+=1){A[ie].connect(E[ie]);for(let de=0;de<x.channelCount;de+=1)E[ie].connect(M,de,ie*x.channelCount+de)}let k=new Md(f.parameterDescriptors===void 0?[]:f.parameterDescriptors.map(({name:ie},de)=>{let we=S[de];return we.connect(M,0,g+de),we.start(0),[ie,we.offset]}));M.connect(C);let z=x.channelInterpretation,F=null,X=x.numberOfOutputs===0?[C]:D,$={get bufferSize(){return L},get channelCount(){return x.channelCount},set channelCount(ie){throw t()},get channelCountMode(){return x.channelCountMode},set channelCountMode(ie){throw t()},get channelInterpretation(){return z},set channelInterpretation(ie){for(let de of A)de.channelInterpretation=ie;z=ie},get context(){return C.context},get inputs(){return A},get numberOfInputs(){return x.numberOfInputs},get numberOfOutputs(){return x.numberOfOutputs},get onprocessorerror(){return F},set onprocessorerror(ie){typeof F=="function"&&$.removeEventListener("processorerror",F),F=typeof ie=="function"?ie:null,typeof F=="function"&&$.addEventListener("processorerror",F)},get parameters(){return k},get port(){return y.port2},addEventListener(...ie){return C.addEventListener(ie[0],ie[1],ie[2])},connect:i.bind(null,X),disconnect:l.bind(null,X),dispatchEvent(...ie){return C.dispatchEvent(ie[0])},removeEventListener(...ie){return C.removeEventListener(ie[0],ie[1],ie[2])}},Y=new Map;y.port1.addEventListener=(ie=>(...de)=>{if(de[0]==="message"){let we=typeof de[1]=="function"?de[1]:typeof de[1]=="object"&&de[1]!==null&&typeof de[1].handleEvent=="function"?de[1].handleEvent:null;if(we!==null){let Ee=Y.get(de[1]);Ee!==void 0?de[1]=Ee:(de[1]=Pe=>{u(d.currentTime,d.sampleRate,()=>we(Pe))},Y.set(we,de[1]))}}return ie.call(y.port1,de[0],de[1],de[2])})(y.port1.addEventListener),y.port1.removeEventListener=(ie=>(...de)=>{if(de[0]==="message"){let we=Y.get(de[1]);we!==void 0&&(Y.delete(de[1]),de[1]=we)}return ie.call(y.port1,de[0],de[1],de[2])})(y.port1.removeEventListener);let H=null;Object.defineProperty(y.port1,"onmessage",{get:()=>H,set:ie=>{typeof H=="function"&&y.port1.removeEventListener("message",H),H=typeof ie=="function"?ie:null,typeof H=="function"&&(y.port1.addEventListener("message",H),y.port1.start())}}),f.prototype.port=y.port1;let B=null;kR(d,$,f,x).then(ie=>B=ie);let q=Ju(x.numberOfInputs,x.channelCount),j=Ju(x.numberOfOutputs,_),R=f.parameterDescriptors===void 0?[]:f.parameterDescriptors.reduce((ie,{name:de})=>({...ie,[de]:new Float32Array(128)}),{}),Ne=!0,xe=()=>{x.numberOfOutputs>0&&C.disconnect(N);for(let ie=0,de=0;ie<x.numberOfOutputs;ie+=1){let we=D[ie];for(let Ee=0;Ee<_[ie];Ee+=1)N.disconnect(we,de+Ee,Ee);de+=_[ie]}},ae=new Map;C.onaudioprocess=({inputBuffer:ie,outputBuffer:de})=>{if(B!==null){let we=p($);for(let Ee=0;Ee<L;Ee+=128){for(let Pe=0;Pe<x.numberOfInputs;Pe+=1)for(let We=0;We<x.channelCount;We+=1)Ku(ie,q[Pe],We,We,Ee);f.parameterDescriptors!==void 0&&f.parameterDescriptors.forEach(({name:Pe},We)=>{Ku(ie,R,Pe,g+We,Ee)});for(let Pe=0;Pe<x.numberOfInputs;Pe+=1)for(let We=0;We<_[Pe];We+=1)j[Pe][We].byteLength===0&&(j[Pe][We]=new Float32Array(128));try{let Pe=q.map((Ze,I)=>{if(we[I].size>0)return ae.set(I,L/128),Ze;let fe=ae.get(I);return fe===void 0?[]:(Ze.every(ee=>ee.every(me=>me===0))&&(fe===1?ae.delete(I):ae.set(I,fe-1)),Ze)});Ne=u(d.currentTime+Ee/d.sampleRate,d.sampleRate,()=>B.process(Pe,j,R));for(let Ze=0,I=0;Ze<x.numberOfOutputs;Ze+=1){for(let O=0;O<_[Ze];O+=1)C_(de,j[Ze],O,I+O,Ee);I+=_[Ze]}}catch(Pe){Ne=!1,$.dispatchEvent(new ErrorEvent("processorerror",{colno:Pe.colno,filename:Pe.filename,lineno:Pe.lineno,message:Pe.message}))}if(!Ne){for(let Pe=0;Pe<x.numberOfInputs;Pe+=1){A[Pe].disconnect(E[Pe]);for(let We=0;We<x.channelCount;We+=1)E[Ee].disconnect(M,We,Pe*x.channelCount+We)}if(f.parameterDescriptors!==void 0){let Pe=f.parameterDescriptors.length;for(let We=0;We<Pe;We+=1){let Ze=S[We];Ze.disconnect(M,0,g+We),Ze.stop()}}M.disconnect(C),C.onaudioprocess=null,Ae?xe():le();break}}}};let Ae=!1,Re=s(d,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0}),Oe=()=>C.connect(Re).connect(d.destination),le=()=>{C.disconnect(Re),Re.disconnect()},ye=()=>{if(Ne){le(),x.numberOfOutputs>0&&C.connect(N);for(let ie=0,de=0;ie<x.numberOfOutputs;ie+=1){let we=D[ie];for(let Ee=0;Ee<_[ie];Ee+=1)N.connect(we,de+Ee,Ee);de+=_[ie]}}Ae=!0},be=()=>{Ne&&(Oe(),xe()),Ae=!1};return Oe(),h($,ye,be)};var z6=(i,e)=>{let t=i.createBiquadFilter();return xt(t,e),Vt(t,e,"Q"),Vt(t,e,"detune"),Vt(t,e,"frequency"),Vt(t,e,"gain"),Rt(t,e,"type"),t};var FR=(i,e)=>(t,r)=>{let o=t.createChannelMerger(r.numberOfInputs);return i!==null&&i.name==="webkitAudioContext"&&e(t,o),xt(o,r),o};var UR=i=>{let e=i.numberOfOutputs;Object.defineProperty(i,"channelCount",{get:()=>e,set:t=>{if(t!==e)throw _r()}}),Object.defineProperty(i,"channelCountMode",{get:()=>"explicit",set:t=>{if(t!=="explicit")throw _r()}}),Object.defineProperty(i,"channelInterpretation",{get:()=>"discrete",set:t=>{if(t!=="discrete")throw _r()}})};var tp=(i,e)=>{let t=i.createChannelSplitter(e.numberOfOutputs);return xt(t,e),UR(t),t};var VR=(i,e,t,r,o)=>(n,s)=>{if(n.createConstantSource===void 0)return t(n,s);let a=n.createConstantSource();return xt(a,s),Vt(a,s,"offset"),e(r,()=>r(n))||Qu(a),e(o,()=>o(n))||ep(a),i(n,a),a};var cn=(i,e)=>(i.connect=e.connect.bind(e),i.disconnect=e.disconnect.bind(e),i);var GR=(i,e,t,r)=>(o,{offset:n,...s})=>{let a=o.createBuffer(1,2,44100),c=e(o,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),l=t(o,{...s,gain:n}),u=a.getChannelData(0);u[0]=1,u[1]=1,c.buffer=a,c.loop=!0;let p={get bufferSize(){},get channelCount(){return l.channelCount},set channelCount(m){l.channelCount=m},get channelCountMode(){return l.channelCountMode},set channelCountMode(m){l.channelCountMode=m},get channelInterpretation(){return l.channelInterpretation},set channelInterpretation(m){l.channelInterpretation=m},get context(){return l.context},get inputs(){return[]},get numberOfInputs(){return c.numberOfInputs},get numberOfOutputs(){return l.numberOfOutputs},get offset(){return l.gain},get onended(){return c.onended},set onended(m){c.onended=m},addEventListener(...m){return c.addEventListener(m[0],m[1],m[2])},dispatchEvent(...m){return c.dispatchEvent(m[0])},removeEventListener(...m){return c.removeEventListener(m[0],m[1],m[2])},start(m=0){c.start.call(c,m)},stop(m=0){c.stop.call(c,m)}},h=()=>c.connect(l),d=()=>c.disconnect(l);return i(o,c),r(cn(p,l),h,d)};var zR=(i,e)=>(t,r)=>{let o=t.createConvolver();if(xt(o,r),r.disableNormalization===o.normalize&&(o.normalize=!r.disableNormalization),Rt(o,r,"buffer"),r.channelCount>2||(e(o,"channelCount",n=>()=>n.call(o),n=>s=>{if(s>2)throw i();return n.call(o,s)}),r.channelCountMode==="max"))throw i();return e(o,"channelCountMode",n=>()=>n.call(o),n=>s=>{if(s==="max")throw i();return n.call(o,s)}),o};var H6=(i,e)=>{let t=i.createDelay(e.maxDelayTime);return xt(t,e),Vt(t,e,"delayTime"),t};var HR=i=>(e,t)=>{let r=e.createDynamicsCompressor();if(xt(r,t),t.channelCount>2||t.channelCountMode==="max")throw i();return Vt(r,t,"attack"),Vt(r,t,"knee"),Vt(r,t,"ratio"),Vt(r,t,"release"),Vt(r,t,"threshold"),r};var $o=(i,e)=>{let t=i.createGain();return xt(t,e),Vt(t,e,"gain"),t};var jR=i=>(e,t,r)=>{if(e.createIIRFilter===void 0)return i(e,t,r);let o=e.createIIRFilter(r.feedforward,r.feedback);return xt(o,r),o};function GZ(i,e){let t=e[0]*e[0]+e[1]*e[1];return[(i[0]*e[0]+i[1]*e[1])/t,(i[1]*e[0]-i[0]*e[1])/t]}function zZ(i,e){return[i[0]*e[0]-i[1]*e[1],i[0]*e[1]+i[1]*e[0]]}function WR(i,e){let t=[0,0];for(let r=i.length-1;r>=0;r-=1)t=zZ(t,e),t[0]+=i[r];return t}var qR=(i,e,t,r)=>(o,n,{channelCount:s,channelCountMode:a,channelInterpretation:c,feedback:l,feedforward:u})=>{let p=w_(n,o.sampleRate),h=l instanceof Float64Array?l:new Float64Array(l),d=u instanceof Float64Array?u:new Float64Array(u),m=h.length,f=d.length,x=Math.min(m,f);if(m===0||m>20)throw r();if(h[0]===0)throw e();if(f===0||f>20)throw r();if(d[0]===0)throw e();if(h[0]!==1){for(let S=0;S<f;S+=1)d[S]/=h[0];for(let S=1;S<m;S+=1)h[S]/=h[0]}let _=t(o,p,s,s);_.channelCount=s,_.channelCountMode=a,_.channelInterpretation=c;let g=32,T=[],b=[],y=[];for(let S=0;S<s;S+=1){T.push(0);let M=new Float32Array(g),L=new Float32Array(g);M.fill(0),L.fill(0),b.push(M),y.push(L)}_.onaudioprocess=S=>{let M=S.inputBuffer,L=S.outputBuffer,C=M.numberOfChannels;for(let N=0;N<C;N+=1){let D=M.getChannelData(N),k=L.getChannelData(N);T[N]=S_(h,m,d,f,x,b[N],y[N],T[N],g,D,k)}};let A=o.sampleRate/2;return cn({get bufferSize(){return p},get channelCount(){return _.channelCount},set channelCount(S){_.channelCount=S},get channelCountMode(){return _.channelCountMode},set channelCountMode(S){_.channelCountMode=S},get channelInterpretation(){return _.channelInterpretation},set channelInterpretation(S){_.channelInterpretation=S},get context(){return _.context},get inputs(){return[_]},get numberOfInputs(){return _.numberOfInputs},get numberOfOutputs(){return _.numberOfOutputs},addEventListener(...S){return _.addEventListener(S[0],S[1],S[2])},dispatchEvent(...S){return _.dispatchEvent(S[0])},getFrequencyResponse(S,M,L){if(S.length!==M.length||M.length!==L.length)throw i();let C=S.length;for(let N=0;N<C;N+=1){let D=-Math.PI*(S[N]/A),k=[Math.cos(D),Math.sin(D)],z=WR(d,k),F=WR(h,k),X=GZ(z,F);M[N]=Math.sqrt(X[0]*X[0]+X[1]*X[1]),L[N]=Math.atan2(X[1],X[0])}},removeEventListener(...S){return _.removeEventListener(S[0],S[1],S[2])}},_)};var XR=(i,e)=>i.createMediaElementSource(e.mediaElement);var YR=(i,e)=>{let t=i.createMediaStreamDestination();return xt(t,e),t.numberOfOutputs===1&&Object.defineProperty(t,"numberOfOutputs",{get:()=>0}),t};var $R=(i,{mediaStream:e})=>{let t=e.getAudioTracks();t.sort((n,s)=>n.id<s.id?-1:n.id>s.id?1:0);let r=t.slice(0,1),o=i.createMediaStreamSource(new MediaStream(r));return Object.defineProperty(o,"mediaStream",{value:e}),o};var KR=(i,e)=>(t,{mediaStreamTrack:r})=>{if(typeof t.createMediaStreamTrackSource=="function")return t.createMediaStreamTrackSource(r);let o=new MediaStream([r]),n=t.createMediaStreamSource(o);if(r.kind!=="audio")throw i();if(e(t))throw new TypeError;return n};var JR=i=>i===null?null:i.hasOwnProperty("OfflineAudioContext")?i.OfflineAudioContext:i.hasOwnProperty("webkitOfflineAudioContext")?i.webkitOfflineAudioContext:null;var ZR=(i,e,t,r,o,n)=>(s,a)=>{let c=s.createOscillator();return xt(c,a),Vt(c,a,"detune"),Vt(c,a,"frequency"),a.periodicWave!==void 0?c.setPeriodicWave(a.periodicWave):Rt(c,a,"type"),e(t,()=>t(s))||Qu(c),e(r,()=>r(s))||n(c,s),e(o,()=>o(s))||ep(c),i(s,c),c};var QR=i=>(e,t)=>{let r=e.createPanner();return r.orientationX===void 0?i(e,t):(xt(r,t),Vt(r,t,"orientationX"),Vt(r,t,"orientationY"),Vt(r,t,"orientationZ"),Vt(r,t,"positionX"),Vt(r,t,"positionY"),Vt(r,t,"positionZ"),Rt(r,t,"coneInnerAngle"),Rt(r,t,"coneOuterAngle"),Rt(r,t,"coneOuterGain"),Rt(r,t,"distanceModel"),Rt(r,t,"maxDistance"),Rt(r,t,"panningModel"),Rt(r,t,"refDistance"),Rt(r,t,"rolloffFactor"),r)};var eL=(i,e,t,r,o,n,s,a,c,l)=>(u,{coneInnerAngle:p,coneOuterAngle:h,coneOuterGain:d,distanceModel:m,maxDistance:f,orientationX:x,orientationY:_,orientationZ:g,panningModel:T,positionX:b,positionY:y,positionZ:A,refDistance:E,rolloffFactor:S,...M})=>{let L=u.createPanner();if(M.channelCount>2||M.channelCountMode==="max")throw s();xt(L,M);let C={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},N=t(u,{...C,channelInterpretation:"speakers",numberOfInputs:6}),D=r(u,{...M,gain:1}),k=r(u,{...C,gain:1}),z=r(u,{...C,gain:0}),F=r(u,{...C,gain:0}),X=r(u,{...C,gain:0}),$=r(u,{...C,gain:0}),Y=r(u,{...C,gain:0}),H=o(u,256,6,1),B=n(u,{...C,curve:new Float32Array([1,1]),oversample:"none"}),te=[x,_,g],q=[b,y,A],j=new Float32Array(1);H.onaudioprocess=({inputBuffer:ae})=>{let Ae=[c(ae,j,0),c(ae,j,1),c(ae,j,2)];Ae.some((Oe,le)=>Oe!==te[le])&&(L.setOrientation(...Ae),te=Ae);let Re=[c(ae,j,3),c(ae,j,4),c(ae,j,5)];Re.some((Oe,le)=>Oe!==q[le])&&(L.setPosition(...Re),q=Re)},Object.defineProperty(z.gain,"defaultValue",{get:()=>0}),Object.defineProperty(F.gain,"defaultValue",{get:()=>0}),Object.defineProperty(X.gain,"defaultValue",{get:()=>0}),Object.defineProperty($.gain,"defaultValue",{get:()=>0}),Object.defineProperty(Y.gain,"defaultValue",{get:()=>0});let R={get bufferSize(){},get channelCount(){return L.channelCount},set channelCount(ae){if(ae>2)throw s();D.channelCount=ae,L.channelCount=ae},get channelCountMode(){return L.channelCountMode},set channelCountMode(ae){if(ae==="max")throw s();D.channelCountMode=ae,L.channelCountMode=ae},get channelInterpretation(){return L.channelInterpretation},set channelInterpretation(ae){D.channelInterpretation=ae,L.channelInterpretation=ae},get coneInnerAngle(){return L.coneInnerAngle},set coneInnerAngle(ae){L.coneInnerAngle=ae},get coneOuterAngle(){return L.coneOuterAngle},set coneOuterAngle(ae){L.coneOuterAngle=ae},get coneOuterGain(){return L.coneOuterGain},set coneOuterGain(ae){if(ae<0||ae>1)throw e();L.coneOuterGain=ae},get context(){return L.context},get distanceModel(){return L.distanceModel},set distanceModel(ae){L.distanceModel=ae},get inputs(){return[D]},get maxDistance(){return L.maxDistance},set maxDistance(ae){if(ae<0)throw new RangeError;L.maxDistance=ae},get numberOfInputs(){return L.numberOfInputs},get numberOfOutputs(){return L.numberOfOutputs},get orientationX(){return k.gain},get orientationY(){return z.gain},get orientationZ(){return F.gain},get panningModel(){return L.panningModel},set panningModel(ae){L.panningModel=ae},get positionX(){return X.gain},get positionY(){return $.gain},get positionZ(){return Y.gain},get refDistance(){return L.refDistance},set refDistance(ae){if(ae<0)throw new RangeError;L.refDistance=ae},get rolloffFactor(){return L.rolloffFactor},set rolloffFactor(ae){if(ae<0)throw new RangeError;L.rolloffFactor=ae},addEventListener(...ae){return D.addEventListener(ae[0],ae[1],ae[2])},dispatchEvent(...ae){return D.dispatchEvent(ae[0])},removeEventListener(...ae){return D.removeEventListener(ae[0],ae[1],ae[2])}};p!==R.coneInnerAngle&&(R.coneInnerAngle=p),h!==R.coneOuterAngle&&(R.coneOuterAngle=h),d!==R.coneOuterGain&&(R.coneOuterGain=d),m!==R.distanceModel&&(R.distanceModel=m),f!==R.maxDistance&&(R.maxDistance=f),x!==R.orientationX.value&&(R.orientationX.value=x),_!==R.orientationY.value&&(R.orientationY.value=_),g!==R.orientationZ.value&&(R.orientationZ.value=g),T!==R.panningModel&&(R.panningModel=T),b!==R.positionX.value&&(R.positionX.value=b),y!==R.positionY.value&&(R.positionY.value=y),A!==R.positionZ.value&&(R.positionZ.value=A),E!==R.refDistance&&(R.refDistance=E),S!==R.rolloffFactor&&(R.rolloffFactor=S),(te[0]!==1||te[1]!==0||te[2]!==0)&&L.setOrientation(...te),(q[0]!==0||q[1]!==0||q[2]!==0)&&L.setPosition(...q);let Ne=()=>{D.connect(L),i(D,B,0,0),B.connect(k).connect(N,0,0),B.connect(z).connect(N,0,1),B.connect(F).connect(N,0,2),B.connect(X).connect(N,0,3),B.connect($).connect(N,0,4),B.connect(Y).connect(N,0,5),N.connect(H).connect(u.destination)},xe=()=>{D.disconnect(L),a(D,B,0,0),B.disconnect(k),k.disconnect(N),B.disconnect(z),z.disconnect(N),B.disconnect(F),F.disconnect(N),B.disconnect(X),X.disconnect(N),B.disconnect($),$.disconnect(N),B.disconnect(Y),Y.disconnect(N),N.disconnect(H),H.disconnect(u.destination)};return l(cn(R,L),Ne,xe)};var tL=i=>(e,{disableNormalization:t,imag:r,real:o})=>{let n=r instanceof Float32Array?r:new Float32Array(r),s=o instanceof Float32Array?o:new Float32Array(o),a=e.createPeriodicWave(s,n,{disableNormalization:t});if(Array.from(r).length<2)throw i();return a};var rp=(i,e,t,r)=>i.createScriptProcessor(e,t,r);var rL=(i,e)=>(t,r)=>{let o=r.channelCountMode;if(o==="clamped-max")throw e();if(t.createStereoPanner===void 0)return i(t,r);let n=t.createStereoPanner();return xt(n,r),Vt(n,r,"pan"),Object.defineProperty(n,"channelCountMode",{get:()=>o,set:s=>{if(s!==o)throw e()}}),n};var oL=(i,e,t,r,o,n)=>{let a=new Float32Array([1,1]),c=Math.PI/2,l={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},u={...l,oversample:"none"},p=(m,f,x,_)=>{let g=new Float32Array(16385),T=new Float32Array(16385);for(let M=0;M<16385;M+=1){let L=M/16384*c;g[M]=Math.cos(L),T[M]=Math.sin(L)}let b=t(m,{...l,gain:0}),y=r(m,{...u,curve:g}),A=r(m,{...u,curve:a}),E=t(m,{...l,gain:0}),S=r(m,{...u,curve:T});return{connectGraph(){f.connect(b),f.connect(A.inputs===void 0?A:A.inputs[0]),f.connect(E),A.connect(x),x.connect(y.inputs===void 0?y:y.inputs[0]),x.connect(S.inputs===void 0?S:S.inputs[0]),y.connect(b.gain),S.connect(E.gain),b.connect(_,0,0),E.connect(_,0,1)},disconnectGraph(){f.disconnect(b),f.disconnect(A.inputs===void 0?A:A.inputs[0]),f.disconnect(E),A.disconnect(x),x.disconnect(y.inputs===void 0?y:y.inputs[0]),x.disconnect(S.inputs===void 0?S:S.inputs[0]),y.disconnect(b.gain),S.disconnect(E.gain),b.disconnect(_,0,0),E.disconnect(_,0,1)}}},h=(m,f,x,_)=>{let g=new Float32Array(16385),T=new Float32Array(16385),b=new Float32Array(16385),y=new Float32Array(16385),A=Math.floor(16385/2);for(let X=0;X<16385;X+=1)if(X>A){let $=(X-A)/(16384-A)*c;g[X]=Math.cos($),T[X]=Math.sin($),b[X]=0,y[X]=1}else{let $=X/(16384-A)*c;g[X]=1,T[X]=0,b[X]=Math.cos($),y[X]=Math.sin($)}let E=e(m,{channelCount:2,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:2}),S=t(m,{...l,gain:0}),M=r(m,{...u,curve:g}),L=t(m,{...l,gain:0}),C=r(m,{...u,curve:T}),N=r(m,{...u,curve:a}),D=t(m,{...l,gain:0}),k=r(m,{...u,curve:b}),z=t(m,{...l,gain:0}),F=r(m,{...u,curve:y});return{connectGraph(){f.connect(E),f.connect(N.inputs===void 0?N:N.inputs[0]),E.connect(S,0),E.connect(L,0),E.connect(D,1),E.connect(z,1),N.connect(x),x.connect(M.inputs===void 0?M:M.inputs[0]),x.connect(C.inputs===void 0?C:C.inputs[0]),x.connect(k.inputs===void 0?k:k.inputs[0]),x.connect(F.inputs===void 0?F:F.inputs[0]),M.connect(S.gain),C.connect(L.gain),k.connect(D.gain),F.connect(z.gain),S.connect(_,0,0),D.connect(_,0,0),L.connect(_,0,1),z.connect(_,0,1)},disconnectGraph(){f.disconnect(E),f.disconnect(N.inputs===void 0?N:N.inputs[0]),E.disconnect(S,0),E.disconnect(L,0),E.disconnect(D,1),E.disconnect(z,1),N.disconnect(x),x.disconnect(M.inputs===void 0?M:M.inputs[0]),x.disconnect(C.inputs===void 0?C:C.inputs[0]),x.disconnect(k.inputs===void 0?k:k.inputs[0]),x.disconnect(F.inputs===void 0?F:F.inputs[0]),M.disconnect(S.gain),C.disconnect(L.gain),k.disconnect(D.gain),F.disconnect(z.gain),S.disconnect(_,0,0),D.disconnect(_,0,0),L.disconnect(_,0,1),z.disconnect(_,0,1)}}},d=(m,f,x,_,g)=>{if(f===1)return p(m,x,_,g);if(f===2)return h(m,x,_,g);throw o()};return(m,{channelCount:f,channelCountMode:x,pan:_,...g})=>{if(x==="max")throw o();let T=i(m,{...g,channelCount:1,channelCountMode:x,numberOfInputs:2}),b=t(m,{...g,channelCount:f,channelCountMode:x,gain:1}),y=t(m,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:_}),{connectGraph:A,disconnectGraph:E}=d(m,f,b,y,T);Object.defineProperty(y.gain,"defaultValue",{get:()=>0}),Object.defineProperty(y.gain,"maxValue",{get:()=>1}),Object.defineProperty(y.gain,"minValue",{get:()=>-1});let S={get bufferSize(){},get channelCount(){return b.channelCount},set channelCount(N){b.channelCount!==N&&(M&&E(),{connectGraph:A,disconnectGraph:E}=d(m,N,b,y,T),M&&A()),b.channelCount=N},get channelCountMode(){return b.channelCountMode},set channelCountMode(N){if(N==="clamped-max"||N==="max")throw o();b.channelCountMode=N},get channelInterpretation(){return b.channelInterpretation},set channelInterpretation(N){b.channelInterpretation=N},get context(){return b.context},get inputs(){return[b]},get numberOfInputs(){return b.numberOfInputs},get numberOfOutputs(){return b.numberOfOutputs},get pan(){return y.gain},addEventListener(...N){return b.addEventListener(N[0],N[1],N[2])},dispatchEvent(...N){return b.dispatchEvent(N[0])},removeEventListener(...N){return b.removeEventListener(N[0],N[1],N[2])}},M=!1,L=()=>{A(),M=!0},C=()=>{E(),M=!1};return n(cn(S,T),L,C)}};var iL=(i,e,t,r,o,n,s)=>(a,c)=>{let l=a.createWaveShaper();if(n!==null&&n.name==="webkitAudioContext"&&a.createGain().gain.automationRate===void 0)return t(a,c);xt(l,c);let u=c.curve===null||c.curve instanceof Float32Array?c.curve:new Float32Array(c.curve);if(u!==null&&u.length<2)throw e();Rt(l,{curve:u},"curve"),Rt(l,c,"oversample");let p=null,h=!1;return s(l,"curve",f=>()=>f.call(l),f=>x=>(f.call(l,x),h&&(r(x)&&p===null?p=i(a,l):!r(x)&&p!==null&&(p(),p=null)),x)),o(l,()=>{h=!0,r(l.curve)&&(p=i(a,l))},()=>{h=!1,p!==null&&(p(),p=null)})};var nL=(i,e,t,r,o)=>(n,{curve:s,oversample:a,...c})=>{let l=n.createWaveShaper(),u=n.createWaveShaper();xt(l,c),xt(u,c);let p=t(n,{...c,gain:1}),h=t(n,{...c,gain:-1}),d=t(n,{...c,gain:1}),m=t(n,{...c,gain:-1}),f=null,x=!1,_=null,g={get bufferSize(){},get channelCount(){return l.channelCount},set channelCount(y){p.channelCount=y,h.channelCount=y,l.channelCount=y,d.channelCount=y,u.channelCount=y,m.channelCount=y},get channelCountMode(){return l.channelCountMode},set channelCountMode(y){p.channelCountMode=y,h.channelCountMode=y,l.channelCountMode=y,d.channelCountMode=y,u.channelCountMode=y,m.channelCountMode=y},get channelInterpretation(){return l.channelInterpretation},set channelInterpretation(y){p.channelInterpretation=y,h.channelInterpretation=y,l.channelInterpretation=y,d.channelInterpretation=y,u.channelInterpretation=y,m.channelInterpretation=y},get context(){return l.context},get curve(){return _},set curve(y){if(y!==null&&y.length<2)throw e();if(y===null)l.curve=y,u.curve=y;else{let A=y.length,E=new Float32Array(A+2-A%2),S=new Float32Array(A+2-A%2);E[0]=y[0],S[0]=-y[A-1];let M=Math.ceil((A+1)/2),L=(A+1)/2-1;for(let C=1;C<M;C+=1){let N=C/M*L,D=Math.floor(N),k=Math.ceil(N);E[C]=D===k?y[D]:(1-(N-D))*y[D]+(1-(k-N))*y[k],S[C]=D===k?-y[A-1-D]:-((1-(N-D))*y[A-1-D])-(1-(k-N))*y[A-1-k]}E[M]=A%2===1?y[M-1]:(y[M-2]+y[M-1])/2,l.curve=E,u.curve=S}_=y,x&&(r(_)&&f===null?f=i(n,p):f!==null&&(f(),f=null))},get inputs(){return[p]},get numberOfInputs(){return l.numberOfInputs},get numberOfOutputs(){return l.numberOfOutputs},get oversample(){return l.oversample},set oversample(y){l.oversample=y,u.oversample=y},addEventListener(...y){return p.addEventListener(y[0],y[1],y[2])},dispatchEvent(...y){return p.dispatchEvent(y[0])},removeEventListener(...y){return p.removeEventListener(y[0],y[1],y[2])}};s!==null&&(g.curve=s instanceof Float32Array?s:new Float32Array(s)),a!==g.oversample&&(g.oversample=a);let T=()=>{p.connect(l).connect(d),p.connect(h).connect(u).connect(m).connect(d),x=!0,r(_)&&(f=i(n,p))},b=()=>{p.disconnect(l),l.disconnect(d),p.disconnect(h),h.disconnect(u),u.disconnect(m),m.disconnect(d),x=!1,f!==null&&(f(),f=null)};return o(cn(g,d),T,b)};var xo=()=>new DOMException("","NotSupportedError");var HZ={numberOfChannels:1},sL=(i,e,t,r,o)=>class extends i{constructor(s,a,c){let l;if(typeof s=="number"&&a!==void 0&&c!==void 0)l={length:a,numberOfChannels:s,sampleRate:c};else if(typeof s=="object")l=s;else throw new Error("The given parameters are not valid.");let{length:u,numberOfChannels:p,sampleRate:h}={...HZ,...l},d=r(p,u,h);e(Dn,()=>Dn(d))||d.addEventListener("statechange",(()=>{let m=0,f=x=>{this._state==="running"&&(m>0?(d.removeEventListener("statechange",f),x.stopImmediatePropagation(),this._waitForThePromiseToSettle(x)):m+=1)};return f})());super(d,p);this._length=u,this._nativeOfflineAudioContext=d,this._state=null}get length(){return this._nativeOfflineAudioContext.length===void 0?this._length:this._nativeOfflineAudioContext.length}get state(){return this._state===null?this._nativeOfflineAudioContext.state:this._state}startRendering(){return this._state==="running"?Promise.reject(t()):(this._state="running",o(this.destination,this._nativeOfflineAudioContext).finally(()=>{this._state=null,pa(this)}))}_waitForThePromiseToSettle(s){this._state===null?this._nativeOfflineAudioContext.dispatchEvent(s):setTimeout(()=>this._waitForThePromiseToSettle(s))}};var jZ={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:440,periodicWave:void 0,type:"sine"},aL=(i,e,t,r,o,n,s)=>class extends i{constructor(c,l){let u=o(c),p={...jZ,...l},h=t(u,p),d=n(u),m=d?r():null,f=c.sampleRate/2;super(c,!1,h,m);this._detune=e(this,d,h.detune,153600,-153600),this._frequency=e(this,d,h.frequency,f,-f),this._nativeOscillatorNode=h,this._onended=null,this._oscillatorNodeRenderer=m,this._oscillatorNodeRenderer!==null&&p.periodicWave!==void 0&&(this._oscillatorNodeRenderer.periodicWave=p.periodicWave)}get detune(){return this._detune}get frequency(){return this._frequency}get onended(){return this._onended}set onended(c){let l=typeof c=="function"?s(this,c):null;this._nativeOscillatorNode.onended=l;let u=this._nativeOscillatorNode.onended;this._onended=u!==null&&u===l?c:u}get type(){return this._nativeOscillatorNode.type}set type(c){this._nativeOscillatorNode.type=c,this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=null)}setPeriodicWave(c){this._nativeOscillatorNode.setPeriodicWave(c),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=c)}start(c=0){if(this._nativeOscillatorNode.start(c),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.start=c),this.context.state!=="closed"){Ln(this);let l=()=>{this._nativeOscillatorNode.removeEventListener("ended",l),Yo(this)&&Es(this)};this._nativeOscillatorNode.addEventListener("ended",l)}}stop(c=0){this._nativeOscillatorNode.stop(c),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.stop=c)}};var cL=(i,e,t,r,o)=>()=>{let n=new WeakMap,s=null,a=null,c=null,l=async(u,p)=>{let h=t(u),d=Pt(h,p);if(!d){let m={channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,detune:h.detune.value,frequency:h.frequency.value,periodicWave:s===null?void 0:s,type:h.type};h=e(p,m),a!==null&&h.start(a),c!==null&&h.stop(c)}return n.set(p,h),d?(await i(p,u.detune,h.detune),await i(p,u.frequency,h.frequency)):(await r(p,u.detune,h.detune),await r(p,u.frequency,h.frequency)),await o(u,p,h),h};return{set periodicWave(u){s=u},set start(u){a=u},set stop(u){c=u},render(u,p){let h=n.get(p);return h!==void 0?Promise.resolve(h):l(u,p)}}};var WZ={channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:1,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1},lL=(i,e,t,r,o,n,s)=>class extends i{constructor(c,l){let u=o(c),p={...WZ,...l},h=t(u,p),d=n(u),m=d?r():null;super(c,!1,h,m);this._nativePannerNode=h,this._orientationX=e(this,d,h.orientationX,Sr,Rr),this._orientationY=e(this,d,h.orientationY,Sr,Rr),this._orientationZ=e(this,d,h.orientationZ,Sr,Rr),this._positionX=e(this,d,h.positionX,Sr,Rr),this._positionY=e(this,d,h.positionY,Sr,Rr),this._positionZ=e(this,d,h.positionZ,Sr,Rr),s(this,1)}get coneInnerAngle(){return this._nativePannerNode.coneInnerAngle}set coneInnerAngle(c){this._nativePannerNode.coneInnerAngle=c}get coneOuterAngle(){return this._nativePannerNode.coneOuterAngle}set coneOuterAngle(c){this._nativePannerNode.coneOuterAngle=c}get coneOuterGain(){return this._nativePannerNode.coneOuterGain}set coneOuterGain(c){this._nativePannerNode.coneOuterGain=c}get distanceModel(){return this._nativePannerNode.distanceModel}set distanceModel(c){this._nativePannerNode.distanceModel=c}get maxDistance(){return this._nativePannerNode.maxDistance}set maxDistance(c){this._nativePannerNode.maxDistance=c}get orientationX(){return this._orientationX}get orientationY(){return this._orientationY}get orientationZ(){return this._orientationZ}get panningModel(){return this._nativePannerNode.panningModel}set panningModel(c){this._nativePannerNode.panningModel=c}get positionX(){return this._positionX}get positionY(){return this._positionY}get positionZ(){return this._positionZ}get refDistance(){return this._nativePannerNode.refDistance}set refDistance(c){this._nativePannerNode.refDistance=c}get rolloffFactor(){return this._nativePannerNode.rolloffFactor}set rolloffFactor(c){this._nativePannerNode.rolloffFactor=c}};var uL=(i,e,t,r,o,n,s,a,c,l)=>()=>{let u=new WeakMap,p=null,h=async(d,m)=>{let f=null,x=n(d),_={channelCount:x.channelCount,channelCountMode:x.channelCountMode,channelInterpretation:x.channelInterpretation},g={..._,coneInnerAngle:x.coneInnerAngle,coneOuterAngle:x.coneOuterAngle,coneOuterGain:x.coneOuterGain,distanceModel:x.distanceModel,maxDistance:x.maxDistance,panningModel:x.panningModel,refDistance:x.refDistance,rolloffFactor:x.rolloffFactor},T=Pt(x,m);if("bufferSize"in x)f=r(m,{..._,gain:1});else if(!T){let b={...g,orientationX:x.orientationX.value,orientationY:x.orientationY.value,orientationZ:x.orientationZ.value,positionX:x.positionX.value,positionY:x.positionY.value,positionZ:x.positionZ.value};x=o(m,b)}if(u.set(m,f===null?x:f),f!==null){if(p===null){if(s===null)throw new Error("Missing the native OfflineAudioContext constructor.");let C=new s(6,d.context.length,m.sampleRate),N=e(C,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6});N.connect(C.destination),p=(async()=>{let D=await Promise.all([d.orientationX,d.orientationY,d.orientationZ,d.positionX,d.positionY,d.positionZ].map(async(k,z)=>{let F=t(C,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:z===0?1:0});return await a(C,k,F.offset),F}));for(let k=0;k<6;k+=1)D[k].connect(N,0,k),D[k].start(0);return l(C)})()}let b=await p,y=r(m,{..._,gain:1});await c(d,m,y);let A=[];for(let C=0;C<b.numberOfChannels;C+=1)A.push(b.getChannelData(C));let E=[A[0][0],A[1][0],A[2][0]],S=[A[3][0],A[4][0],A[5][0]],M=r(m,{..._,gain:1}),L=o(m,{...g,orientationX:E[0],orientationY:E[1],orientationZ:E[2],positionX:S[0],positionY:S[1],positionZ:S[2]});y.connect(M).connect(L.inputs[0]),L.connect(f);for(let C=128;C<b.length;C+=128){let N=[A[0][C],A[1][C],A[2][C]],D=[A[3][C],A[4][C],A[5][C]];if(N.some((k,z)=>k!==E[z])||D.some((k,z)=>k!==S[z])){E=N,S=D;let k=C/m.sampleRate;M.gain.setValueAtTime(0,k),M=r(m,{..._,gain:0}),L=o(m,{...g,orientationX:E[0],orientationY:E[1],orientationZ:E[2],positionX:S[0],positionY:S[1],positionZ:S[2]}),M.gain.setValueAtTime(1,k),y.connect(M).connect(L.inputs[0]),L.connect(f)}}return f}return T?(await i(m,d.orientationX,x.orientationX),await i(m,d.orientationY,x.orientationY),await i(m,d.orientationZ,x.orientationZ),await i(m,d.positionX,x.positionX),await i(m,d.positionY,x.positionY),await i(m,d.positionZ,x.positionZ)):(await a(m,d.orientationX,x.orientationX),await a(m,d.orientationY,x.orientationY),await a(m,d.orientationZ,x.orientationZ),await a(m,d.positionX,x.positionX),await a(m,d.positionY,x.positionY),await a(m,d.positionZ,x.positionZ)),an(x)?await c(d,m,x.inputs[0]):await c(d,m,x),x};return{render(d,m){let f=u.get(m);return f!==void 0?Promise.resolve(f):h(d,m)}}};var qZ={disableNormalization:!1},pL=(i,e,t,r)=>class hL{constructor(n,s){let a=e(n),c=r({...qZ,...s}),l=i(a,c);return t.add(l),l}static[Symbol.hasInstance](n){return n!==null&&typeof n=="object"&&Object.getPrototypeOf(n)===hL.prototype||t.has(n)}};var dL=(i,e)=>(t,r,o)=>(i(r).replay(o),e(r,t,o));var fL=(i,e,t)=>async(r,o,n)=>{let s=i(r);await Promise.all(s.activeInputs.map((a,c)=>Array.from(a).map(async([l,u])=>{let h=await e(l).render(l,o),d=r.context.destination;!t(l)&&(r!==d||!t(r))&&h.connect(n,u,c)})).reduce((a,c)=>[...a,...c],[]))};var mL=(i,e,t)=>async(r,o,n)=>{let s=e(r);await Promise.all(Array.from(s.activeInputs).map(async([a,c])=>{let u=await i(a).render(a,o);t(a)||u.connect(n,c)}))};var _L=(i,e,t,r)=>o=>i(Dn,()=>Dn(o))?Promise.resolve(i(r,r)).then(n=>{if(!n){let s=t(o,512,0,1);o.oncomplete=()=>{s.onaudioprocess=null,s.disconnect()},s.onaudioprocess=()=>o.currentTime,s.connect(o.destination)}return o.startRendering()}):new Promise(n=>{let s=e(o,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});o.oncomplete=a=>{s.disconnect(),n(a.renderedBuffer)},s.connect(o.destination),o.startRendering()});var gL=i=>(e,t)=>{i.set(e,t)};var vL=i=>(e,t)=>i.set(e,t);var xL=(i,e,t,r,o,n,s,a)=>(c,l)=>t(c).render(c,l).then(()=>Promise.all(Array.from(r(l)).map(u=>t(u).render(u,l)))).then(()=>o(l)).then(u=>(typeof u.copyFromChannel!="function"?(s(u),qu(u)):e(n,()=>n(u))||a(u),i.add(u),u));var XZ={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",pan:0},yL=(i,e,t,r,o,n)=>class extends i{constructor(a,c){let l=o(a),u={...XZ,...c},p=t(l,u),h=n(l),d=h?r():null;super(a,!1,p,d);this._pan=e(this,h,p.pan)}get pan(){return this._pan}};var bL=(i,e,t,r,o)=>()=>{let n=new WeakMap,s=async(a,c)=>{let l=t(a),u=Pt(l,c);if(!u){let p={channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,pan:l.pan.value};l=e(c,p)}return n.set(c,l),u?await i(c,a.pan,l.pan):await r(c,a.pan,l.pan),an(l)?await o(a,c,l.inputs[0]):await o(a,c,l),l};return{render(a,c){let l=n.get(c);return l!==void 0?Promise.resolve(l):s(a,c)}}};var TL=i=>()=>{if(i===null)return!1;try{new i({length:1,sampleRate:44100})}catch{return!1}return!0};var AL=(i,e)=>async()=>{if(i===null)return!0;if(e===null)return!1;let t=new Blob(['class A extends AudioWorkletProcessor{process(i){this.port.postMessage(i,[i[0][0].buffer])}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),r=new e(1,128,44100),o=URL.createObjectURL(t),n=!1,s=!1;try{await r.audioWorklet.addModule(o);let a=new i(r,"a",{numberOfOutputs:0}),c=r.createOscillator();a.port.onmessage=()=>n=!0,a.onprocessorerror=()=>s=!0,c.connect(a),c.start(0),await r.startRendering()}catch{}finally{URL.revokeObjectURL(o)}return n&&!s};var CL=(i,e)=>()=>{if(e===null)return Promise.resolve(!1);let t=new e(1,1,44100),r=i(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return new Promise(o=>{t.oncomplete=()=>{r.disconnect(),o(t.currentTime!==0)},t.startRendering()})};var j6=()=>new DOMException("","UnknownError");var YZ={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",curve:null,oversample:"none"},EL=(i,e,t,r,o,n,s)=>class extends i{constructor(c,l){let u=o(c),p={...YZ,...l},h=t(u,p),m=n(u)?r():null;super(c,!0,h,m);this._isCurveNullified=!1,this._nativeWaveShaperNode=h,s(this,1)}get curve(){return this._isCurveNullified?null:this._nativeWaveShaperNode.curve}set curve(c){if(c===null)this._isCurveNullified=!0,this._nativeWaveShaperNode.curve=new Float32Array([0,0]);else{if(c.length<2)throw e();this._isCurveNullified=!1,this._nativeWaveShaperNode.curve=c}}get oversample(){return this._nativeWaveShaperNode.oversample}set oversample(c){this._nativeWaveShaperNode.oversample=c}};var SL=(i,e,t)=>()=>{let r=new WeakMap,o=async(n,s)=>{let a=e(n);if(!Pt(a,s)){let l={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,curve:a.curve,oversample:a.oversample};a=i(s,l)}return r.set(s,a),an(a)?await t(n,s,a.inputs[0]):await t(n,s,a),a};return{render(n,s){let a=r.get(s);return a!==void 0?Promise.resolve(a):o(n,s)}}};var wL=()=>typeof window>"u"?null:window;var ML=(i,e)=>t=>{t.copyFromChannel=(r,o,n=0)=>{let s=i(n),a=i(o);if(a>=t.numberOfChannels)throw e();let c=t.length,l=t.getChannelData(a),u=r.length;for(let p=s<0?-s:0;p+s<c&&p<u;p+=1)r[p]=l[p+s]},t.copyToChannel=(r,o,n=0)=>{let s=i(n),a=i(o);if(a>=t.numberOfChannels)throw e();let c=t.length,l=t.getChannelData(a),u=r.length;for(let p=s<0?-s:0;p+s<c&&p<u;p+=1)l[p+s]=r[p]}};var NL=i=>e=>{e.copyFromChannel=(t=>(r,o,n=0)=>{let s=i(n),a=i(o);if(s<e.length)return t.call(e,r,a,s)})(e.copyFromChannel),e.copyToChannel=(t=>(r,o,n=0)=>{let s=i(n),a=i(o);if(s<e.length)return t.call(e,r,a,s)})(e.copyToChannel)};var OL=i=>(e,t)=>{let r=t.createBuffer(1,1,44100);e.buffer===null&&(e.buffer=r),i(e,"buffer",o=>()=>{let n=o.call(e);return n===r?null:n},o=>n=>o.call(e,n===null?r:n))};var PL=(i,e)=>(t,r)=>{r.channelCount=1,r.channelCountMode="explicit",Object.defineProperty(r,"channelCount",{get:()=>1,set:()=>{throw i()}}),Object.defineProperty(r,"channelCountMode",{get:()=>"explicit",set:()=>{throw i()}});let o=t.createBufferSource();e(r,()=>{let a=r.numberOfInputs;for(let c=0;c<a;c+=1)o.connect(r,0,c)},()=>o.disconnect(r))};var W6=(i,e,t)=>i.copyFromChannel===void 0?i.getChannelData(t)[0]:(i.copyFromChannel(e,t),e[0]);var q6=i=>{if(i===null)return!1;let e=i.length;return e%2!==0?i[Math.floor(e/2)]!==0:i[e/2-1]+i[e/2]!==0};var op=(i,e,t,r)=>{let o=i;for(;!o.hasOwnProperty(e);)o=Object.getPrototypeOf(o);let{get:n,set:s}=Object.getOwnPropertyDescriptor(o,e);Object.defineProperty(i,e,{get:t(n),set:r(s)})};var RL=i=>({...i,outputChannelCount:i.outputChannelCount!==void 0?i.outputChannelCount:i.numberOfInputs===1&&i.numberOfOutputs===1?[i.channelCount]:Array.from({length:i.numberOfOutputs},()=>1)});var LL=i=>({...i,channelCount:i.numberOfOutputs});var IL=i=>{let{imag:e,real:t}=i;return e===void 0?t===void 0?{...i,imag:[0,0],real:[0,0]}:{...i,imag:Array.from(t,()=>0),real:t}:t===void 0?{...i,imag:e,real:Array.from(e,()=>0)}:{...i,imag:e,real:t}};var X6=(i,e,t)=>{try{i.setValueAtTime(e,t)}catch(r){if(r.code!==9)throw r;X6(i,e,t+1e-7)}};var DL=i=>{let e=i.createBufferSource();e.start();try{e.start()}catch{return!0}return!1};var kL=i=>{let e=i.createBufferSource(),t=i.createBuffer(1,1,44100);e.buffer=t;try{e.start(0,1)}catch{return!1}return!0};var BL=i=>{let e=i.createBufferSource();e.start();try{e.stop()}catch{return!1}return!0};var M_=i=>{let e=i.createOscillator();try{e.start(-1)}catch(t){return t instanceof RangeError}return!1};var Y6=i=>{let e=i.createBuffer(1,1,44100),t=i.createBufferSource();t.buffer=e,t.start(),t.stop();try{return t.stop(),!0}catch{return!1}};var N_=i=>{let e=i.createOscillator();try{e.stop(-1)}catch(t){return t instanceof RangeError}return!1};var FL=i=>{let{port1:e,port2:t}=new MessageChannel;try{e.postMessage(i)}finally{e.close(),t.close()}};var UL=i=>{i.start=(e=>(t=0,r=0,o)=>{let n=i.buffer,s=n===null?r:Math.min(n.duration,r);n!==null&&s>n.duration-.5/i.context.sampleRate?e.call(i,t,0,0):e.call(i,t,s,o)})(i.start)};var $6=(i,e)=>{let t=e.createGain();i.connect(t);let r=(o=>()=>{o.call(i,t),i.removeEventListener("ended",r)})(i.disconnect);i.addEventListener("ended",r),cn(i,t),i.stop=(o=>{let n=!1;return(s=0)=>{if(n)try{o.call(i,s)}catch{t.gain.setValueAtTime(0,s)}else o.call(i,s),n=!0}})(i.stop)};var Pc=(i,e)=>t=>{let r={value:i};return Object.defineProperties(t,{currentTarget:r,target:r}),typeof e=="function"?e.call(i,t):e.handleEvent.call(i,t)};var $Z=MO(In),KZ=FO(In),JZ=IP(la),GL=new WeakMap,ZZ=KP(GL),ln=mP(new Map,new WeakMap),Ss=wL(),zL=ER(ln,sn),K6=$P(Kr),yo=fL(Kr,K6,a0),QZ=zO(zL,Kt,yo),ar=QP(ju),c0=JR(Ss),Jt=fR(c0),HL=new WeakMap,jL=HP(Pc),ip=NR(Ss),J6=uR(ip),Z6=pR(Ss),WL=hR(Ss),Nd=PR(Ss),Lr=nP(NO(__),BO($Z,KZ,Xu,JZ,Yu,Kr,ZZ,Cs,Kt,In,Yo,a0,$u),ln,nR(Cd,Yu,Kr,Kt,Nc,Yo),sn,Zu,xo,PP(Xu,Cd,Kr,Kt,Nc,ar,Yo,Jt),BP(HL,Kr,Ur),jL,ar,J6,Z6,WL,Jt,Nd),eQ=GO(Lr,QZ,sn,zL,ar,Jt);var Q6=new WeakSet,VL=SR(Ss),qL=EP(new Uint32Array(1)),e7=ML(qL,sn),t7=NL(qL),tQ=HO(Q6,ln,xo,VL,c0,TL(VL),e7,t7);var O_=UO($o),XL=mL(K6,ua,a0),ws=yP(XL),np=MR(O_,ln,DL,kL,BL,M_,Y6,N_,UL,OL(op),$6),Ms=dL(JP(ua),XL),rQ=qO(ws,np,Kt,Ms,yo),kn=aP(OO(g_),HL,Ad,cP,di.createCancelAndHoldAutomationEvent,di.createCancelScheduledValuesAutomationEvent,di.createExponentialRampToValueAutomationEvent,di.createLinearRampToValueAutomationEvent,di.createSetTargetAutomationEvent,di.createSetValueAutomationEvent,di.createSetValueCurveAutomationEvent,ip,X6),oQ=WO(Lr,rQ,kn,_r,np,ar,Jt,Pc);var iQ=eP(Lr,tP,sn,_r,OR($o,op),ar,Jt,yo),nQ=fP(ws,z6,Kt,Ms,yo),Rc=vL(GL),sQ=dP(Lr,kn,nQ,Zu,z6,ar,Jt,Rc),da=AR(In,Z6),aQ=PL(_r,da),fa=FR(ip,aQ),cQ=gP(fa,Kt,yo),lQ=_P(Lr,cQ,fa,ar,Jt),uQ=xP(tp,Kt,yo),pQ=vP(Lr,uQ,tp,ar,Jt,LL),hQ=GR(O_,np,$o,da),sp=VR(O_,ln,hQ,M_,N_),dQ=CP(ws,sp,Kt,Ms,yo),fQ=AP(Lr,kn,dQ,sp,ar,Jt,Pc),YL=zR(xo,op),mQ=wP(YL,Kt,yo),_Q=SP(Lr,mQ,YL,ar,Jt,Rc),gQ=LP(ws,H6,Kt,Ms,yo),vQ=RP(Lr,kn,gQ,H6,ar,Jt,Rc),$L=HR(xo),xQ=VP(ws,$L,Kt,Ms,yo),yQ=UP(Lr,kn,xQ,$L,xo,ar,Jt,Rc),bQ=XP(ws,$o,Kt,Ms,yo),TQ=qP(Lr,kn,bQ,$o,ar,Jt),AQ=qR(Zu,_r,rp,xo),P_=_L(ln,$o,rp,CL($o,c0)),CQ=iR(np,Kt,c0,yo,P_),EQ=jR(AQ),SQ=oR(Lr,EQ,CQ,ar,Jt,Rc),wQ=rP(kn,fa,sp,rp,xo,W6,Jt,op),KL=new WeakMap,r7=bR(iQ,wQ,jL,Jt,KL,Pc),JL=ZR(O_,ln,M_,Y6,N_,$6),MQ=cL(ws,JL,Kt,Ms,yo),NQ=aL(Lr,kn,JL,MQ,ar,Jt,Pc),ZL=TP(np),OQ=nL(ZL,_r,$o,q6,da),R_=iL(ZL,_r,OQ,q6,da,ip,op),PQ=eL(Xu,_r,fa,$o,rp,R_,xo,Yu,W6,da),QL=QR(PQ),RQ=uL(ws,fa,sp,$o,QL,Kt,c0,Ms,yo,P_),LQ=lL(Lr,kn,QL,RQ,ar,Jt,Rc),IQ=tL(sn),DQ=pL(IQ,ar,new WeakSet,IL),kQ=oL(fa,tp,$o,R_,xo,da),eI=rL(kQ,xo),BQ=bL(ws,eI,Kt,Ms,yo),FQ=yL(Lr,kn,eI,BQ,ar,Jt),UQ=SL(R_,Kt,yo),VQ=EL(Lr,_r,R_,UQ,ar,Jt,Rc),tI=mR(Ss),o7=jP(Ss),rI=new WeakMap,GQ=eR(rI,c0),zQ=tI?kO(ln,xo,zP(Ss),o7,WP(wO),ar,GQ,Jt,Nd,new WeakMap,new WeakMap,AL(Nd,c0),Ss):void 0,HQ=dR(J6,Jt),jQ=OP(Q6,ln,NP,GP,new WeakSet,ar,HQ,Wu,Dn,e7,t7),oI=hP(zQ,eQ,tQ,oQ,sQ,lQ,pQ,fQ,_Q,jQ,vQ,yQ,TQ,SQ,r7,NQ,LQ,DQ,FQ,VQ),WQ=_R(Lr,XR,ar,Jt),qQ=gR(Lr,YR,ar,Jt),XQ=vR(Lr,$R,ar,Jt),YQ=KR(_r,Jt),$Q=xR(Lr,YQ,ar),iI=QO(oI,_r,xo,j6,WQ,qQ,XQ,$Q,ip);var i7=tR(KL),KQ=VO(i7),nI=bP(sn),JQ=DP(i7),sI=FP(sn),aI=new WeakMap,ZQ=YP(aI,Ur),QQ=BR(nI,sn,_r,fa,tp,sp,$o,rp,xo,sI,o7,ZQ,da),eee=LR(_r,QQ,$o,xo,da),tee=pP(ws,nI,np,fa,tp,sp,$o,JQ,sI,o7,Kt,Nd,c0,Ms,yo,P_),ree=ZP(rI),oee=gL(aI),n7=tI?lP(KQ,Lr,kn,tee,eee,Kr,ree,ar,Jt,Nd,RL,oee,FL,Pc):void 0;var pqe=yR(_r,xo,j6,r7,ip);var cI=MP(xo,c0),lI=xL(Q6,ln,K6,i7,P_,Wu,e7,t7),hqe=TR(ln,_r,cI,r7,lI);var uI=sL(oI,ln,_r,cI,lI);var pI=sR(ju,J6),hI=aR(Hu,Z6),dI=cR(Ad,WL),fI=lR(ju,Jt);function Bn(i){return dI(i)}function Ns(i){return hI(i)}function ap(i){return fI(i)}function ma(i){return pI(i)}function L_(i){return i instanceof AudioBuffer}function Jr(i){return typeof i>"u"}function qe(i){return!Jr(i)}function mI(i){return typeof i=="function"}function ki(i){return typeof i=="number"}function Os(i){return Object.prototype.toString.call(i)==="[object Object]"&&i.constructor===Object}function _I(i){return typeof i=="boolean"}function ao(i){return Array.isArray(i)}function bo(i){return typeof i=="string"}function Od(i){return bo(i)&&/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i.test(i)}function iee(i,e){return i==="value"||Bn(e)||Ns(e)||L_(e)}function Pd(i,...e){if(!e.length)return i;let t=e.shift();if(Os(i)&&Os(t))for(let r in t)iee(r,t[r])?i[r]=t[r]:Os(t[r])?(i[r]||Object.assign(i,{[r]:{}}),Pd(i[r],t[r])):Object.assign(i,{[r]:t[r]});return Pd(i,...e)}function gI(i,e){return i.length===e.length&&i.every((t,r)=>e[r]===t)}function pe(i,e,t=[],r){let o={},n=Array.from(e);if(Os(n[0])&&r&&!Reflect.has(n[0],r)&&(Object.keys(n[0]).some(a=>Reflect.has(i,a))||(Pd(o,{[r]:n[0]}),t.splice(t.indexOf(r),1),n.shift())),n.length===1&&Os(n[0]))Pd(o,n[0]);else for(let s=0;s<t.length;s++)qe(n[s])&&(o[t[s]]=n[s]);return Pd(i,o)}function vI(i){return i.constructor.getDefaults()}function l0(i,e){return Jr(i)?e:i}function _a(i,e){return e.forEach(t=>{Reflect.has(i,t)&&delete i[t]}),i}function cp(i){return Math.pow(10,i/20)}function I_(i){return 20*(Math.log(i)/Math.LN10)}function D_(i){return Math.pow(2,i/12)}var k_=440;function xI(){return k_}function yI(i){k_=i}function Rd(i){return Math.round(s7(i))}function s7(i){return 69+12*Math.log2(i/k_)}function bI(i){return k_*Math.pow(2,(i-69)/12)}var Ld="14.7.77";function ze(i,e){if(!i)throw new Error(e)}function Bo(i,e,t=1/0){if(!(e<=i&&i<=t))throw new RangeError(`Value must be within [${e}, ${t}], got: ${i}`)}function B_(i){!i.isOffline&&i.state!=="running"&&Id('The AudioContext is "suspended". Invoke Tone.start() from a user action to start the audio.')}var TI=console;function AI(...i){TI.log(...i)}function Id(...i){TI.warn(...i)}function CI(i){return new iI(i)}function EI(i,e,t){return new uI(i,e,t)}var u0=typeof self=="object"?self:null,SI=u0&&(u0.hasOwnProperty("AudioContext")||u0.hasOwnProperty("webkitAudioContext"));function wI(i,e,t){return ze(qe(n7),"This node only works in a secure context (https or localhost)"),new n7(i,e,t)}var co=class{constructor(){this.debug=!1,this._wasDisposed=!1}static getDefaults(){return{}}log(...e){(this.debug||u0&&this.toString()===u0.TONE_DEBUG_CLASS)&&AI(this,...e)}dispose(){return this._wasDisposed=!0,this}get disposed(){return this._wasDisposed}toString(){return this.name}};co.version=Ld;function lp(i,e){return i>e+1e-6}function Dd(i,e){return lp(i,e)||Ko(i,e)}function F_(i,e){return i+1e-6<e}function Ko(i,e){return Math.abs(i-e)<1e-6}function MI(i,e,t){return Math.max(Math.min(i,t),e)}var To=class extends co{constructor(){super();this.name="Timeline",this._timeline=[];let e=pe(To.getDefaults(),arguments,["memory"]);this.memory=e.memory,this.increasing=e.increasing}static getDefaults(){return{memory:1/0,increasing:!1}}get length(){return this._timeline.length}add(e){if(ze(Reflect.has(e,"time"),"Timeline: events must have a time attribute"),e.time=e.time.valueOf(),this.increasing&&this.length){let t=this._timeline[this.length-1];ze(Dd(e.time,t.time),"The time must be greater than or equal to the last scheduled time"),this._timeline.push(e)}else{let t=this._search(e.time);this._timeline.splice(t+1,0,e)}if(this.length>this.memory){let t=this.length-this.memory;this._timeline.splice(0,t)}return this}remove(e){let t=this._timeline.indexOf(e);return t!==-1&&this._timeline.splice(t,1),this}get(e,t="time"){let r=this._search(e,t);return r!==-1?this._timeline[r]:null}peek(){return this._timeline[0]}shift(){return this._timeline.shift()}getAfter(e,t="time"){let r=this._search(e,t);return r+1<this._timeline.length?this._timeline[r+1]:null}getBefore(e){let t=this._timeline.length;if(t>0&&this._timeline[t-1].time<e)return this._timeline[t-1];let r=this._search(e);return r-1>=0?this._timeline[r-1]:null}cancel(e){if(this._timeline.length>1){let t=this._search(e);if(t>=0)if(Ko(this._timeline[t].time,e)){for(let r=t;r>=0&&Ko(this._timeline[r].time,e);r--)t=r;this._timeline=this._timeline.slice(0,t)}else this._timeline=this._timeline.slice(0,t+1);else this._timeline=[]}else this._timeline.length===1&&Dd(this._timeline[0].time,e)&&(this._timeline=[]);return this}cancelBefore(e){let t=this._search(e);return t>=0&&(this._timeline=this._timeline.slice(t+1)),this}previousEvent(e){let t=this._timeline.indexOf(e);return t>0?this._timeline[t-1]:null}_search(e,t="time"){if(this._timeline.length===0)return-1;let r=0,o=this._timeline.length,n=o;if(o>0&&this._timeline[o-1][t]<=e)return o-1;for(;r<n;){let s=Math.floor(r+(n-r)/2),a=this._timeline[s],c=this._timeline[s+1];if(Ko(a[t],e)){for(let l=s;l<this._timeline.length;l++){let u=this._timeline[l];if(Ko(u[t],e))s=l;else break}return s}else{if(F_(a[t],e)&&lp(c[t],e))return s;lp(a[t],e)?n=s:r=s+1}}return-1}_iterate(e,t=0,r=this._timeline.length-1){this._timeline.slice(t,r+1).forEach(e)}forEach(e){return this._iterate(e),this}forEachBefore(e,t){let r=this._search(e);return r!==-1&&this._iterate(t,0,r),this}forEachAfter(e,t){let r=this._search(e);return this._iterate(t,r+1),this}forEachBetween(e,t,r){let o=this._search(e),n=this._search(t);return o!==-1&&n!==-1?(this._timeline[o].time!==e&&(o+=1),this._timeline[n].time===t&&(n-=1),this._iterate(r,o,n)):o===-1&&this._iterate(r,0,n),this}forEachFrom(e,t){let r=this._search(e);for(;r>=0&&this._timeline[r].time>=e;)r--;return this._iterate(t,r+1),this}forEachAtTime(e,t){let r=this._search(e);if(r!==-1&&Ko(this._timeline[r].time,e)){let o=r;for(let n=r;n>=0&&Ko(this._timeline[n].time,e);n--)o=n;this._iterate(n=>{t(n)},o,r)}return this}dispose(){return super.dispose(),this._timeline=[],this}};var KI=bn($I(),1),{__extends:zqe,__assign:Hqe,__rest:jqe,__decorate:Bi,__param:Wqe,__metadata:qqe,__awaiter:yt,__generator:Xqe,__exportStar:Yqe,__createBinding:$qe,__values:Kqe,__read:Jqe,__spread:Zqe,__spreadArrays:Qqe,__spreadArray:eXe,__await:tXe,__asyncGenerator:rXe,__asyncDelegator:oXe,__asyncValues:iXe,__makeTemplateObject:nXe,__importStar:sXe,__importDefault:aXe,__classPrivateFieldGet:cXe,__classPrivateFieldSet:lXe}=KI.default;var c7=class{constructor(e,t,r){this._callback=e,this._type=t,this._updateInterval=r,this._createClock()}_createWorker(){let e=new Blob([`
			// the initial timeout time
			let timeoutTime =  ${(this._updateInterval*1e3).toFixed(1)};
			// onmessage callback
			self.onmessage = function(msg){
				timeoutTime = parseInt(msg.data);
			};
			// the tick function which posts a message
			// and schedules a new tick
			function tick(){
				setTimeout(tick, timeoutTime);
				self.postMessage('tick');
			}
			// call tick initially
			tick();
			`],{type:"text/javascript"}),t=URL.createObjectURL(e),r=new Worker(t);r.onmessage=this._callback.bind(this),this._worker=r}_createTimeout(){this._timeout=setTimeout(()=>{this._createTimeout(),this._callback()},this._updateInterval*1e3)}_createClock(){if(this._type==="worker")try{this._createWorker()}catch{this._type="timeout",this._createClock()}else this._type==="timeout"&&this._createTimeout()}_disposeClock(){this._timeout&&(clearTimeout(this._timeout),this._timeout=0),this._worker&&(this._worker.terminate(),this._worker.onmessage=null)}get updateInterval(){return this._updateInterval}set updateInterval(e){this._updateInterval=Math.max(e,128/44100),this._type==="worker"&&this._worker.postMessage(Math.max(e*1e3,1))}get type(){return this._type}set type(e){this._disposeClock(),this._type=e,this._createClock()}dispose(){this._disposeClock()}};var JI=[];function pp(i){JI.push(i)}function ZI(i){JI.forEach(e=>e(i))}var QI=[];function hp(i){QI.push(i)}function eD(i){QI.forEach(e=>e(i))}var p0=class extends co{constructor(){super(...arguments);this.name="Emitter"}on(e,t){return e.split(/\W+/).forEach(o=>{Jr(this._events)&&(this._events={}),this._events.hasOwnProperty(o)||(this._events[o]=[]),this._events[o].push(t)}),this}once(e,t){let r=(...o)=>{t(...o),this.off(e,r)};return this.on(e,r),this}off(e,t){return e.split(/\W+/).forEach(o=>{if(Jr(this._events)&&(this._events={}),this._events.hasOwnProperty(e))if(Jr(t))this._events[e]=[];else{let n=this._events[e];for(let s=n.length-1;s>=0;s--)n[s]===t&&n.splice(s,1)}}),this}emit(e,...t){if(this._events&&this._events.hasOwnProperty(e)){let r=this._events[e].slice(0);for(let o=0,n=r.length;o<n;o++)r[o].apply(this,t)}return this}static mixin(e){["on","once","off","emit"].forEach(t=>{let r=Object.getOwnPropertyDescriptor(p0.prototype,t);Object.defineProperty(e.prototype,t,r)})}dispose(){return super.dispose(),this._events=void 0,this}};var kd=class extends p0{constructor(){super(...arguments);this.isOffline=!1}toJSON(){return{}}};var ga=class extends kd{constructor(){super();this.name="Context",this._constants=new Map,this._timeouts=new To,this._timeoutIds=0,this._initialized=!1,this.isOffline=!1,this._workletModules=new Map;let e=pe(ga.getDefaults(),arguments,["context"]);e.context?this._context=e.context:this._context=CI({latencyHint:e.latencyHint}),this._ticker=new c7(this.emit.bind(this,"tick"),e.clockSource,e.updateInterval),this.on("tick",this._timeoutLoop.bind(this)),this._context.onstatechange=()=>{this.emit("statechange",this.state)},this._setLatencyHint(e.latencyHint),this.lookAhead=e.lookAhead}static getDefaults(){return{clockSource:"worker",latencyHint:"interactive",lookAhead:.1,updateInterval:.05}}initialize(){return this._initialized||(ZI(this),this._initialized=!0),this}createAnalyser(){return this._context.createAnalyser()}createOscillator(){return this._context.createOscillator()}createBufferSource(){return this._context.createBufferSource()}createBiquadFilter(){return this._context.createBiquadFilter()}createBuffer(e,t,r){return this._context.createBuffer(e,t,r)}createChannelMerger(e){return this._context.createChannelMerger(e)}createChannelSplitter(e){return this._context.createChannelSplitter(e)}createConstantSource(){return this._context.createConstantSource()}createConvolver(){return this._context.createConvolver()}createDelay(e){return this._context.createDelay(e)}createDynamicsCompressor(){return this._context.createDynamicsCompressor()}createGain(){return this._context.createGain()}createIIRFilter(e,t){return this._context.createIIRFilter(e,t)}createPanner(){return this._context.createPanner()}createPeriodicWave(e,t,r){return this._context.createPeriodicWave(e,t,r)}createStereoPanner(){return this._context.createStereoPanner()}createWaveShaper(){return this._context.createWaveShaper()}createMediaStreamSource(e){return ze(ma(this._context),"Not available if OfflineAudioContext"),this._context.createMediaStreamSource(e)}createMediaElementSource(e){return ze(ma(this._context),"Not available if OfflineAudioContext"),this._context.createMediaElementSource(e)}createMediaStreamDestination(){return ze(ma(this._context),"Not available if OfflineAudioContext"),this._context.createMediaStreamDestination()}decodeAudioData(e){return this._context.decodeAudioData(e)}get currentTime(){return this._context.currentTime}get state(){return this._context.state}get sampleRate(){return this._context.sampleRate}get listener(){return this.initialize(),this._listener}set listener(e){ze(!this._initialized,"The listener cannot be set after initialization."),this._listener=e}get transport(){return this.initialize(),this._transport}set transport(e){ze(!this._initialized,"The transport cannot be set after initialization."),this._transport=e}get draw(){return this.initialize(),this._draw}set draw(e){ze(!this._initialized,"Draw cannot be set after initialization."),this._draw=e}get destination(){return this.initialize(),this._destination}set destination(e){ze(!this._initialized,"The destination cannot be set after initialization."),this._destination=e}createAudioWorkletNode(e,t){return wI(this.rawContext,e,t)}addAudioWorkletModule(e,t){return yt(this,void 0,void 0,function*(){ze(qe(this.rawContext.audioWorklet),"AudioWorkletNode is only available in a secure context (https or localhost)"),this._workletModules.has(t)||this._workletModules.set(t,this.rawContext.audioWorklet.addModule(e)),yield this._workletModules.get(t)})}workletsAreReady(){return yt(this,void 0,void 0,function*(){let e=[];this._workletModules.forEach(t=>e.push(t)),yield Promise.all(e)})}get updateInterval(){return this._ticker.updateInterval}set updateInterval(e){this._ticker.updateInterval=e}get clockSource(){return this._ticker.type}set clockSource(e){this._ticker.type=e}get latencyHint(){return this._latencyHint}_setLatencyHint(e){let t=0;if(this._latencyHint=e,bo(e))switch(e){case"interactive":t=.1;break;case"playback":t=.5;break;case"balanced":t=.25;break}this.lookAhead=t,this.updateInterval=t/2}get rawContext(){return this._context}now(){return this._context.currentTime+this.lookAhead}immediate(){return this._context.currentTime}resume(){return ma(this._context)?this._context.resume():Promise.resolve()}close(){return yt(this,void 0,void 0,function*(){ma(this._context)&&(yield this._context.close()),this._initialized&&eD(this)})}getConstant(e){if(this._constants.has(e))return this._constants.get(e);{let t=this._context.createBuffer(1,128,this._context.sampleRate),r=t.getChannelData(0);for(let n=0;n<r.length;n++)r[n]=e;let o=this._context.createBufferSource();return o.channelCount=1,o.channelCountMode="explicit",o.buffer=t,o.loop=!0,o.start(0),this._constants.set(e,o),o}}dispose(){return super.dispose(),this._ticker.dispose(),this._timeouts.dispose(),Object.keys(this._constants).map(e=>this._constants[e].disconnect()),this}_timeoutLoop(){let e=this.now(),t=this._timeouts.peek();for(;this._timeouts.length&&t&&t.time<=e;)t.callback(),this._timeouts.shift(),t=this._timeouts.peek()}setTimeout(e,t){this._timeoutIds++;let r=this.now();return this._timeouts.add({callback:e,id:this._timeoutIds,time:r+t}),this._timeoutIds}clearTimeout(e){return this._timeouts.forEach(t=>{t.id===e&&this._timeouts.remove(t)}),this}clearInterval(e){return this.clearTimeout(e)}setInterval(e,t){let r=++this._timeoutIds,o=()=>{let n=this.now();this._timeouts.add({callback:()=>{e(),o()},id:r,time:n+t})};return o(),r}};var l7=class extends kd{constructor(){super(...arguments);this.lookAhead=0,this.latencyHint=0,this.isOffline=!1}createAnalyser(){return{}}createOscillator(){return{}}createBufferSource(){return{}}createBiquadFilter(){return{}}createBuffer(e,t,r){return{}}createChannelMerger(e){return{}}createChannelSplitter(e){return{}}createConstantSource(){return{}}createConvolver(){return{}}createDelay(e){return{}}createDynamicsCompressor(){return{}}createGain(){return{}}createIIRFilter(e,t){return{}}createPanner(){return{}}createPeriodicWave(e,t,r){return{}}createStereoPanner(){return{}}createWaveShaper(){return{}}createMediaStreamSource(e){return{}}createMediaElementSource(e){return{}}createMediaStreamDestination(){return{}}decodeAudioData(e){return Promise.resolve({})}createAudioWorkletNode(e,t){return{}}get rawContext(){return{}}addAudioWorkletModule(e,t){return yt(this,void 0,void 0,function*(){return Promise.resolve()})}resume(){return Promise.resolve()}setTimeout(e,t){return 0}clearTimeout(e){return this}setInterval(e,t){return 0}clearInterval(e){return this}getConstant(e){return{}}get currentTime(){return 0}get state(){return{}}get sampleRate(){return 0}get listener(){return{}}get transport(){return{}}get draw(){return{}}set draw(e){}get destination(){return{}}set destination(e){}now(){return 0}immediate(){return 0}};function _t(i,e){ao(e)?e.forEach(t=>_t(i,t)):Object.defineProperty(i,e,{enumerable:!0,writable:!1})}function u7(i,e){ao(e)?e.forEach(t=>u7(i,t)):Object.defineProperty(i,e,{writable:!0})}var gt=()=>{};var Gt=class extends co{constructor(){super();this.name="ToneAudioBuffer",this.onload=gt;let e=pe(Gt.getDefaults(),arguments,["url","onload","onerror"]);this.reverse=e.reverse,this.onload=e.onload,e.url&&L_(e.url)||e.url instanceof Gt?this.set(e.url):bo(e.url)&&this.load(e.url).catch(e.onerror)}static getDefaults(){return{onerror:gt,onload:gt,reverse:!1}}get sampleRate(){return this._buffer?this._buffer.sampleRate:Fn().sampleRate}set(e){return e instanceof Gt?e.loaded?this._buffer=e.get():e.onload=()=>{this.set(e),this.onload(this)}:this._buffer=e,this._reversed&&this._reverse(),this}get(){return this._buffer}load(e){return yt(this,void 0,void 0,function*(){let t=Gt.load(e).then(r=>{this.set(r),this.onload(this)});Gt.downloads.push(t);try{yield t}finally{let r=Gt.downloads.indexOf(t);Gt.downloads.splice(r,1)}return this})}dispose(){return super.dispose(),this._buffer=void 0,this}fromArray(e){let t=ao(e)&&e[0].length>0,r=t?e.length:1,o=t?e[0].length:e.length,n=Fn(),s=n.createBuffer(r,o,n.sampleRate),a=!t&&r===1?[e]:e;for(let c=0;c<r;c++)s.copyToChannel(a[c],c);return this._buffer=s,this}toMono(e){if(ki(e))this.fromArray(this.toArray(e));else{let t=new Float32Array(this.length),r=this.numberOfChannels;for(let o=0;o<r;o++){let n=this.toArray(o);for(let s=0;s<n.length;s++)t[s]+=n[s]}t=t.map(o=>o/r),this.fromArray(t)}return this}toArray(e){if(ki(e))return this.getChannelData(e);if(this.numberOfChannels===1)return this.toArray(0);{let t=[];for(let r=0;r<this.numberOfChannels;r++)t[r]=this.getChannelData(r);return t}}getChannelData(e){return this._buffer?this._buffer.getChannelData(e):new Float32Array(0)}slice(e,t=this.duration){let r=Math.floor(e*this.sampleRate),o=Math.floor(t*this.sampleRate);ze(r<o,"The start time must be less than the end time");let n=o-r,s=Fn().createBuffer(this.numberOfChannels,n,this.sampleRate);for(let a=0;a<this.numberOfChannels;a++)s.copyToChannel(this.getChannelData(a).subarray(r,o),a);return new Gt(s)}_reverse(){if(this.loaded)for(let e=0;e<this.numberOfChannels;e++)this.getChannelData(e).reverse();return this}get loaded(){return this.length>0}get duration(){return this._buffer?this._buffer.duration:0}get length(){return this._buffer?this._buffer.length:0}get numberOfChannels(){return this._buffer?this._buffer.numberOfChannels:0}get reverse(){return this._reversed}set reverse(e){this._reversed!==e&&(this._reversed=e,this._reverse())}static fromArray(e){return new Gt().fromArray(e)}static fromUrl(e){return yt(this,void 0,void 0,function*(){return yield new Gt().load(e)})}static load(e){return yt(this,void 0,void 0,function*(){let t=e.match(/\[([^\]\[]+\|.+)\]$/);if(t){let a=t[1].split("|"),c=a[0];for(let l of a)if(Gt.supportsType(l)){c=l;break}e=e.replace(t[0],c)}let r=Gt.baseUrl===""||Gt.baseUrl.endsWith("/")?Gt.baseUrl:Gt.baseUrl+"/",o=yield fetch(r+e);if(!o.ok)throw new Error(`could not load url: ${e}`);let n=yield o.arrayBuffer();return yield Fn().decodeAudioData(n)})}static supportsType(e){let t=e.split("."),r=t[t.length-1];return document.createElement("audio").canPlayType("audio/"+r)!==""}static loaded(){return yt(this,void 0,void 0,function*(){for(yield Promise.resolve();Gt.downloads.length;)yield Gt.downloads[0]})}};Gt.baseUrl="";Gt.downloads=[];var Lc=class extends ga{constructor(){super({clockSource:"offline",context:ap(arguments[0])?arguments[0]:EI(arguments[0],arguments[1]*arguments[2],arguments[2]),lookAhead:0,updateInterval:ap(arguments[0])?128/arguments[0].sampleRate:128/arguments[2]});this.name="OfflineContext",this._currentTime=0,this.isOffline=!0,this._duration=ap(arguments[0])?arguments[0].length/arguments[0].sampleRate:arguments[1]}now(){return this._currentTime}get currentTime(){return this._currentTime}_renderClock(e){return yt(this,void 0,void 0,function*(){let t=0;for(;this._duration-this._currentTime>=0;){this.emit("tick"),this._currentTime+=128/this.sampleRate,t++;let r=Math.floor(this.sampleRate/128);e&&t%r===0&&(yield new Promise(o=>setTimeout(o,1)))}})}render(e=!0){return yt(this,void 0,void 0,function*(){yield this.workletsAreReady(),yield this._renderClock(e);let t=yield this._context.startRendering();return new Gt(t)})}close(){return Promise.resolve()}};var tD=new l7,dp=tD;function Fn(){return dp===tD&&SI&&nee(new ga),dp}function nee(i){ma(i)?dp=new ga(i):ap(i)?dp=new Lc(i):dp=i}function rD(){return dp.resume()}if(u0&&!u0.TONE_SILENCE_LOGGING){let i="v";Ld==="dev"&&(i="");let e=` * Tone.js ${i}${Ld} * `;console.log(`%c${e}`,"background: #000; color: #fff")}var Bd=class extends co{constructor(e,t,r){super();this.defaultUnits="s",this._val=t,this._units=r,this.context=e,this._expressions=this._getExpressions()}_getExpressions(){return{hz:{method:e=>this._frequencyToUnits(parseFloat(e)),regexp:/^(\d+(?:\.\d+)?)hz$/i},i:{method:e=>this._ticksToUnits(parseInt(e,10)),regexp:/^(\d+)i$/i},m:{method:e=>this._beatsToUnits(parseInt(e,10)*this._getTimeSignature()),regexp:/^(\d+)m$/i},n:{method:(e,t)=>{let r=parseInt(e,10),o=t==="."?1.5:1;return r===1?this._beatsToUnits(this._getTimeSignature())*o:this._beatsToUnits(4/r)*o},regexp:/^(\d+)n(\.?)$/i},number:{method:e=>this._expressions[this.defaultUnits].method.call(this,e),regexp:/^(\d+(?:\.\d+)?)$/},s:{method:e=>this._secondsToUnits(parseFloat(e)),regexp:/^(\d+(?:\.\d+)?)s$/},samples:{method:e=>parseInt(e,10)/this.context.sampleRate,regexp:/^(\d+)samples$/},t:{method:e=>{let t=parseInt(e,10);return this._beatsToUnits(8/(Math.floor(t)*3))},regexp:/^(\d+)t$/i},tr:{method:(e,t,r)=>{let o=0;return e&&e!=="0"&&(o+=this._beatsToUnits(this._getTimeSignature()*parseFloat(e))),t&&t!=="0"&&(o+=this._beatsToUnits(parseFloat(t))),r&&r!=="0"&&(o+=this._beatsToUnits(parseFloat(r)/4)),o},regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?$/}}}valueOf(){if(this._val instanceof Bd&&this.fromType(this._val),Jr(this._val))return this._noArg();if(bo(this._val)&&Jr(this._units)){for(let e in this._expressions)if(this._expressions[e].regexp.test(this._val.trim())){this._units=e;break}}else if(Os(this._val)){let e=0;for(let t in this._val)if(qe(this._val[t])){let r=this._val[t];e+=new this.constructor(this.context,t).valueOf()*r}return e}if(qe(this._units)){let e=this._expressions[this._units],t=this._val.toString().trim().match(e.regexp);return t?e.method.apply(this,t.slice(1)):e.method.call(this,this._val)}else return bo(this._val)?parseFloat(this._val):this._val}_frequencyToUnits(e){return 1/e}_beatsToUnits(e){return 60/this._getBpm()*e}_secondsToUnits(e){return e}_ticksToUnits(e){return e*this._beatsToUnits(1)/this._getPPQ()}_noArg(){return this._now()}_getBpm(){return this.context.transport.bpm.value}_getTimeSignature(){return this.context.transport.timeSignature}_getPPQ(){return this.context.transport.PPQ}fromType(e){switch(this._units=void 0,this.defaultUnits){case"s":this._val=e.toSeconds();break;case"i":this._val=e.toTicks();break;case"hz":this._val=e.toFrequency();break;case"midi":this._val=e.toMidi();break}return this}toFrequency(){return 1/this.toSeconds()}toSamples(){return this.toSeconds()*this.context.sampleRate}toMilliseconds(){return this.toSeconds()*1e3}};var Fo=class extends Bd{constructor(){super(...arguments);this.name="TimeClass"}_getExpressions(){return Object.assign(super._getExpressions(),{now:{method:e=>this._now()+new this.constructor(this.context,e).valueOf(),regexp:/^\+(.+)/},quantize:{method:e=>{let t=new Fo(this.context,e).valueOf();return this._secondsToUnits(this.context.transport.nextSubdivision(t))},regexp:/^@(.+)/}})}quantize(e,t=1){let r=new this.constructor(this.context,e).valueOf(),o=this.valueOf(),a=Math.round(o/r)*r-o;return o+a*t}toNotation(){let e=this.toSeconds(),t=["1m"];for(let n=1;n<9;n++){let s=Math.pow(2,n);t.push(s+"n."),t.push(s+"n"),t.push(s+"t")}t.push("0");let r=t[0],o=new Fo(this.context,t[0]).toSeconds();return t.forEach(n=>{let s=new Fo(this.context,n).toSeconds();Math.abs(s-e)<Math.abs(o-e)&&(r=n,o=s)}),r}toBarsBeatsSixteenths(){let e=this._beatsToUnits(1),t=this.valueOf()/e;t=parseFloat(t.toFixed(4));let r=Math.floor(t/this._getTimeSignature()),o=t%1*4;t=Math.floor(t)%this._getTimeSignature();let n=o.toString();return n.length>3&&(o=parseFloat(parseFloat(n).toFixed(3))),[r,t,o].join(":")}toTicks(){let e=this._beatsToUnits(1),t=this.valueOf()/e;return Math.round(t*this._getPPQ())}toSeconds(){return this.valueOf()}toMidi(){return Rd(this.toFrequency())}_now(){return this.context.now()}};var Jo=class extends Fo{constructor(){super(...arguments);this.name="Frequency",this.defaultUnits="hz"}static get A4(){return xI()}static set A4(e){yI(e)}_getExpressions(){return Object.assign({},super._getExpressions(),{midi:{regexp:/^(\d+(?:\.\d+)?midi)/,method(e){return this.defaultUnits==="midi"?e:Jo.mtof(e)}},note:{regexp:/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i,method(e,t){let o=see[e.toLowerCase()]+(parseInt(t,10)+1)*12;return this.defaultUnits==="midi"?o:Jo.mtof(o)}},tr:{regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?/,method(e,t,r){let o=1;return e&&e!=="0"&&(o*=this._beatsToUnits(this._getTimeSignature()*parseFloat(e))),t&&t!=="0"&&(o*=this._beatsToUnits(parseFloat(t))),r&&r!=="0"&&(o*=this._beatsToUnits(parseFloat(r)/4)),o}}})}transpose(e){return new Jo(this.context,this.valueOf()*D_(e))}harmonize(e){return e.map(t=>this.transpose(t))}toMidi(){return Rd(this.valueOf())}toNote(){let e=this.toFrequency(),t=Math.log2(e/Jo.A4),r=Math.round(12*t)+57,o=Math.floor(r/12);return o<0&&(r+=-12*o),aee[r%12]+o.toString()}toSeconds(){return 1/super.toSeconds()}toTicks(){let e=this._beatsToUnits(1),t=this.valueOf()/e;return Math.floor(t*this._getPPQ())}_noArg(){return 0}_frequencyToUnits(e){return e}_ticksToUnits(e){return 1/(e*60/(this._getBpm()*this._getPPQ()))}_beatsToUnits(e){return 1/super._beatsToUnits(e)}_secondsToUnits(e){return 1/e}static mtof(e){return bI(e)}static ftom(e){return Rd(e)}},see={cbb:-2,cb:-1,c:0,"c#":1,cx:2,dbb:0,db:1,d:2,"d#":3,dx:4,ebb:2,eb:3,e:4,"e#":5,ex:6,fbb:3,fb:4,f:5,"f#":6,fx:7,gbb:5,gb:6,g:7,"g#":8,gx:9,abb:7,ab:8,a:9,"a#":10,ax:11,bbb:9,bb:10,b:11,"b#":12,bx:13},aee=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];var h0=class extends Fo{constructor(){super(...arguments);this.name="TransportTime"}_now(){return this.context.transport.seconds}};var Zr=class extends co{constructor(){super();let e=pe(Zr.getDefaults(),arguments,["context"]);this.defaultContext?this.context=this.defaultContext:this.context=e.context}static getDefaults(){return{context:Fn()}}now(){return this.context.currentTime+this.context.lookAhead}immediate(){return this.context.currentTime}get sampleTime(){return 1/this.context.sampleRate}get blockTime(){return 128/this.context.sampleRate}toSeconds(e){return new Fo(this.context,e).toSeconds()}toFrequency(e){return new Jo(this.context,e).toFrequency()}toTicks(e){return new h0(this.context,e).toTicks()}_getPartialProperties(e){let t=this.get();return Object.keys(t).forEach(r=>{Jr(e[r])&&delete t[r]}),t}get(){let e=vI(this);return Object.keys(e).forEach(t=>{if(Reflect.has(this,t)){let r=this[t];qe(r)&&qe(r.value)&&qe(r.setValueAtTime)?e[t]=r.value:r instanceof Zr?e[t]=r._getPartialProperties(e[t]):ao(r)||ki(r)||bo(r)||_I(r)?e[t]=r:delete e[t]}}),e}set(e){return Object.keys(e).forEach(t=>{Reflect.has(this,t)&&qe(this[t])&&(this[t]&&qe(this[t].value)&&qe(this[t].setValueAtTime)?this[t].value!==e[t]&&(this[t].value=e[t]):this[t]instanceof Zr?this[t].set(e[t]):this[t]=e[t])}),this}};var ft=class extends Zr{constructor(){super(pe(ft.getDefaults(),arguments,["param","units","convert"]));this.name="Param",this.overridden=!1,this._minOutput=1e-7;let e=pe(ft.getDefaults(),arguments,["param","units","convert"]);for(ze(qe(e.param)&&(Bn(e.param)||e.param instanceof ft),"param must be an AudioParam");!Bn(e.param);)e.param=e.param._param;this._swappable=qe(e.swappable)?e.swappable:!1,this._swappable?(this.input=this.context.createGain(),this._param=e.param,this.input.connect(this._param)):this._param=this.input=e.param,this._events=new To(1e3),this._initialValue=this._param.defaultValue,this.units=e.units,this.convert=e.convert,this._minValue=e.minValue,this._maxValue=e.maxValue,qe(e.value)&&e.value!==this._toType(this._initialValue)&&this.setValueAtTime(e.value,0)}static getDefaults(){return Object.assign(Zr.getDefaults(),{convert:!0,units:"number"})}get value(){let e=this.now();return this.getValueAtTime(e)}set value(e){this.cancelScheduledValues(this.now()),this.setValueAtTime(e,this.now())}get minValue(){return qe(this._minValue)?this._minValue:this.units==="time"||this.units==="frequency"||this.units==="normalRange"||this.units==="positive"||this.units==="transportTime"||this.units==="ticks"||this.units==="bpm"||this.units==="hertz"||this.units==="samples"?0:this.units==="audioRange"?-1:this.units==="decibels"?-1/0:this._param.minValue}get maxValue(){return qe(this._maxValue)?this._maxValue:this.units==="normalRange"||this.units==="audioRange"?1:this._param.maxValue}_is(e,t){return this.units===t}_assertRange(e){return qe(this.maxValue)&&qe(this.minValue)&&Bo(e,this._fromType(this.minValue),this._fromType(this.maxValue)),e}_fromType(e){return this.convert&&!this.overridden?this._is(e,"time")?this.toSeconds(e):this._is(e,"decibels")?cp(e):this._is(e,"frequency")?this.toFrequency(e):e:this.overridden?0:e}_toType(e){return this.convert&&this.units==="decibels"?I_(e):e}setValueAtTime(e,t){let r=this.toSeconds(t),o=this._fromType(e);return ze(isFinite(o)&&isFinite(r),`Invalid argument(s) to setValueAtTime: ${JSON.stringify(e)}, ${JSON.stringify(t)}`),this._assertRange(o),this.log(this.units,"setValueAtTime",e,r),this._events.add({time:r,type:"setValueAtTime",value:o}),this._param.setValueAtTime(o,r),this}getValueAtTime(e){let t=Math.max(this.toSeconds(e),0),r=this._events.getAfter(t),o=this._events.get(t),n=this._initialValue;if(o===null)n=this._initialValue;else if(o.type==="setTargetAtTime"&&(r===null||r.type==="setValueAtTime")){let s=this._events.getBefore(o.time),a;s===null?a=this._initialValue:a=s.value,o.type==="setTargetAtTime"&&(n=this._exponentialApproach(o.time,a,o.value,o.constant,t))}else if(r===null)n=o.value;else if(r.type==="linearRampToValueAtTime"||r.type==="exponentialRampToValueAtTime"){let s=o.value;if(o.type==="setTargetAtTime"){let a=this._events.getBefore(o.time);a===null?s=this._initialValue:s=a.value}r.type==="linearRampToValueAtTime"?n=this._linearInterpolate(o.time,s,r.time,r.value,t):n=this._exponentialInterpolate(o.time,s,r.time,r.value,t)}else n=o.value;return this._toType(n)}setRampPoint(e){e=this.toSeconds(e);let t=this.getValueAtTime(e);return this.cancelAndHoldAtTime(e),this._fromType(t)===0&&(t=this._toType(this._minOutput)),this.setValueAtTime(t,e),this}linearRampToValueAtTime(e,t){let r=this._fromType(e),o=this.toSeconds(t);return ze(isFinite(r)&&isFinite(o),`Invalid argument(s) to linearRampToValueAtTime: ${JSON.stringify(e)}, ${JSON.stringify(t)}`),this._assertRange(r),this._events.add({time:o,type:"linearRampToValueAtTime",value:r}),this.log(this.units,"linearRampToValueAtTime",e,o),this._param.linearRampToValueAtTime(r,o),this}exponentialRampToValueAtTime(e,t){let r=this._fromType(e);r=Ko(r,0)?this._minOutput:r,this._assertRange(r);let o=this.toSeconds(t);return ze(isFinite(r)&&isFinite(o),`Invalid argument(s) to exponentialRampToValueAtTime: ${JSON.stringify(e)}, ${JSON.stringify(t)}`),this._events.add({time:o,type:"exponentialRampToValueAtTime",value:r}),this.log(this.units,"exponentialRampToValueAtTime",e,o),this._param.exponentialRampToValueAtTime(r,o),this}exponentialRampTo(e,t,r){return r=this.toSeconds(r),this.setRampPoint(r),this.exponentialRampToValueAtTime(e,r+this.toSeconds(t)),this}linearRampTo(e,t,r){return r=this.toSeconds(r),this.setRampPoint(r),this.linearRampToValueAtTime(e,r+this.toSeconds(t)),this}targetRampTo(e,t,r){return r=this.toSeconds(r),this.setRampPoint(r),this.exponentialApproachValueAtTime(e,r,t),this}exponentialApproachValueAtTime(e,t,r){t=this.toSeconds(t),r=this.toSeconds(r);let o=Math.log(r+1)/Math.log(200);return this.setTargetAtTime(e,t,o),this.cancelAndHoldAtTime(t+r*.9),this.linearRampToValueAtTime(e,t+r),this}setTargetAtTime(e,t,r){let o=this._fromType(e);ze(isFinite(r)&&r>0,"timeConstant must be a number greater than 0");let n=this.toSeconds(t);return this._assertRange(o),ze(isFinite(o)&&isFinite(n),`Invalid argument(s) to setTargetAtTime: ${JSON.stringify(e)}, ${JSON.stringify(t)}`),this._events.add({constant:r,time:n,type:"setTargetAtTime",value:o}),this.log(this.units,"setTargetAtTime",e,n,r),this._param.setTargetAtTime(o,n,r),this}setValueCurveAtTime(e,t,r,o=1){r=this.toSeconds(r),t=this.toSeconds(t);let n=this._fromType(e[0])*o;this.setValueAtTime(this._toType(n),t);let s=r/(e.length-1);for(let a=1;a<e.length;a++){let c=this._fromType(e[a])*o;this.linearRampToValueAtTime(this._toType(c),t+a*s)}return this}cancelScheduledValues(e){let t=this.toSeconds(e);return ze(isFinite(t),`Invalid argument to cancelScheduledValues: ${JSON.stringify(e)}`),this._events.cancel(t),this._param.cancelScheduledValues(t),this.log(this.units,"cancelScheduledValues",t),this}cancelAndHoldAtTime(e){let t=this.toSeconds(e),r=this._fromType(this.getValueAtTime(t));ze(isFinite(t),`Invalid argument to cancelAndHoldAtTime: ${JSON.stringify(e)}`),this.log(this.units,"cancelAndHoldAtTime",t,"value="+r);let o=this._events.get(t),n=this._events.getAfter(t);return o&&Ko(o.time,t)?n?(this._param.cancelScheduledValues(n.time),this._events.cancel(n.time)):(this._param.cancelAndHoldAtTime(t),this._events.cancel(t+this.sampleTime)):n&&(this._param.cancelScheduledValues(n.time),this._events.cancel(n.time),n.type==="linearRampToValueAtTime"?this.linearRampToValueAtTime(this._toType(r),t):n.type==="exponentialRampToValueAtTime"&&this.exponentialRampToValueAtTime(this._toType(r),t)),this._events.add({time:t,type:"setValueAtTime",value:r}),this._param.setValueAtTime(r,t),this}rampTo(e,t=.1,r){return this.units==="frequency"||this.units==="bpm"||this.units==="decibels"?this.exponentialRampTo(e,t,r):this.linearRampTo(e,t,r),this}apply(e){let t=this.context.currentTime;e.setValueAtTime(this.getValueAtTime(t),t);let r=this._events.get(t);if(r&&r.type==="setTargetAtTime"){let o=this._events.getAfter(r.time),n=o?o.time:t+2,s=(n-t)/10;for(let a=t;a<n;a+=s)e.linearRampToValueAtTime(this.getValueAtTime(a),a)}return this._events.forEachAfter(this.context.currentTime,o=>{o.type==="cancelScheduledValues"?e.cancelScheduledValues(o.time):o.type==="setTargetAtTime"?e.setTargetAtTime(o.value,o.time,o.constant):e[o.type](o.value,o.time)}),this}setParam(e){ze(this._swappable,"The Param must be assigned as 'swappable' in the constructor");let t=this.input;return t.disconnect(this._param),this.apply(e),this._param=e,t.connect(this._param),this}dispose(){return super.dispose(),this._events.dispose(),this}get defaultValue(){return this._toType(this._param.defaultValue)}_exponentialApproach(e,t,r,o,n){return r+(t-r)*Math.exp(-(n-e)/o)}_linearInterpolate(e,t,r,o,n){return t+(o-t)*((n-e)/(r-e))}_exponentialInterpolate(e,t,r,o,n){return t*Math.pow(o/t,(n-e)/(r-e))}};var je=class extends Zr{constructor(){super(...arguments);this.name="ToneAudioNode",this._internalChannels=[]}get numberOfInputs(){return qe(this.input)?Bn(this.input)||this.input instanceof ft?1:this.input.numberOfInputs:0}get numberOfOutputs(){return qe(this.output)?this.output.numberOfOutputs:0}_isAudioNode(e){return qe(e)&&(e instanceof je||Ns(e))}_getInternalNodes(){let e=this._internalChannels.slice(0);return this._isAudioNode(this.input)&&e.push(this.input),this._isAudioNode(this.output)&&this.input!==this.output&&e.push(this.output),e}_setChannelProperties(e){this._getInternalNodes().forEach(r=>{r.channelCount=e.channelCount,r.channelCountMode=e.channelCountMode,r.channelInterpretation=e.channelInterpretation})}_getChannelProperties(){let e=this._getInternalNodes();ze(e.length>0,"ToneAudioNode does not have any internal nodes");let t=e[0];return{channelCount:t.channelCount,channelCountMode:t.channelCountMode,channelInterpretation:t.channelInterpretation}}get channelCount(){return this._getChannelProperties().channelCount}set channelCount(e){let t=this._getChannelProperties();this._setChannelProperties(Object.assign(t,{channelCount:e}))}get channelCountMode(){return this._getChannelProperties().channelCountMode}set channelCountMode(e){let t=this._getChannelProperties();this._setChannelProperties(Object.assign(t,{channelCountMode:e}))}get channelInterpretation(){return this._getChannelProperties().channelInterpretation}set channelInterpretation(e){let t=this._getChannelProperties();this._setChannelProperties(Object.assign(t,{channelInterpretation:e}))}connect(e,t=0,r=0){return un(this,e,t,r),this}toDestination(){return this.connect(this.context.destination),this}toMaster(){return Id("toMaster() has been renamed toDestination()"),this.toDestination()}disconnect(e,t=0,r=0){return cee(this,e,t,r),this}chain(...e){return z_(this,...e),this}fan(...e){return e.forEach(t=>this.connect(t)),this}dispose(){return super.dispose(),qe(this.input)&&(this.input instanceof je?this.input.dispose():Ns(this.input)&&this.input.disconnect()),qe(this.output)&&(this.output instanceof je?this.output.dispose():Ns(this.output)&&this.output.disconnect()),this._internalChannels=[],this}};function z_(...i){let e=i.shift();i.reduce((t,r)=>(t instanceof je?t.connect(r):Ns(t)&&un(t,r),r),e)}function un(i,e,t=0,r=0){for(ze(qe(i),"Cannot connect from undefined node"),ze(qe(e),"Cannot connect to undefined node"),(e instanceof je||Ns(e))&&ze(e.numberOfInputs>0,"Cannot connect to node with no inputs"),ze(i.numberOfOutputs>0,"Cannot connect from node with no outputs");e instanceof je||e instanceof ft;)qe(e.input)&&(e=e.input);for(;i instanceof je;)qe(i.output)&&(i=i.output);Bn(e)?i.connect(e,t):i.connect(e,t,r)}function cee(i,e,t=0,r=0){if(qe(e))for(;e instanceof je;)e=e.input;for(;!Ns(i);)qe(i.output)&&(i=i.output);Bn(e)?i.disconnect(e,t):Ns(e)?i.disconnect(e,t,r):i.disconnect()}var Zt=class extends je{constructor(){super(pe(Zt.getDefaults(),arguments,["gain","units"]));this.name="Gain",this._gainNode=this.context.createGain(),this.input=this._gainNode,this.output=this._gainNode;let e=pe(Zt.getDefaults(),arguments,["gain","units"]);this.gain=new ft({context:this.context,convert:e.convert,param:this._gainNode.gain,units:e.units,value:e.gain,minValue:e.minValue,maxValue:e.maxValue}),_t(this,"gain")}static getDefaults(){return Object.assign(je.getDefaults(),{convert:!0,gain:1,units:"gain"})}dispose(){return super.dispose(),this._gainNode.disconnect(),this.gain.dispose(),this}};var Ps=class extends je{constructor(e){super(e);this.onended=gt,this._startTime=-1,this._stopTime=-1,this._timeout=-1,this.output=new Zt({context:this.context,gain:0}),this._gainNode=this.output,this.getStateAtTime=function(t){let r=this.toSeconds(t);return this._startTime!==-1&&r>=this._startTime&&(this._stopTime===-1||r<=this._stopTime)?"started":"stopped"},this._fadeIn=e.fadeIn,this._fadeOut=e.fadeOut,this._curve=e.curve,this.onended=e.onended}static getDefaults(){return Object.assign(je.getDefaults(),{curve:"linear",fadeIn:0,fadeOut:0,onended:gt})}_startGain(e,t=1){ze(this._startTime===-1,"Source cannot be started more than once");let r=this.toSeconds(this._fadeIn);return this._startTime=e+r,this._startTime=Math.max(this._startTime,this.context.currentTime),r>0?(this._gainNode.gain.setValueAtTime(0,e),this._curve==="linear"?this._gainNode.gain.linearRampToValueAtTime(t,e+r):this._gainNode.gain.exponentialApproachValueAtTime(t,e,r)):this._gainNode.gain.setValueAtTime(t,e),this}stop(e){return this.log("stop",e),this._stopGain(this.toSeconds(e)),this}_stopGain(e){ze(this._startTime!==-1,"'start' must be called before 'stop'"),this.cancelStop();let t=this.toSeconds(this._fadeOut);return this._stopTime=this.toSeconds(e)+t,this._stopTime=Math.max(this._stopTime,this.context.currentTime),t>0?this._curve==="linear"?this._gainNode.gain.linearRampTo(0,t,e):this._gainNode.gain.targetRampTo(0,t,e):(this._gainNode.gain.cancelAndHoldAtTime(e),this._gainNode.gain.setValueAtTime(0,e)),this.context.clearTimeout(this._timeout),this._timeout=this.context.setTimeout(()=>{let r=this._curve==="exponential"?t*2:0;this._stopSource(this.now()+r),this._onended()},this._stopTime-this.context.currentTime),this}_onended(){if(this.onended!==gt&&(this.onended(this),this.onended=gt,!this.context.isOffline)){let e=()=>this.dispose();typeof window.requestIdleCallback<"u"?window.requestIdleCallback(e):setTimeout(e,1e3)}}get state(){return this.getStateAtTime(this.now())}cancelStop(){return this.log("cancelStop"),ze(this._startTime!==-1,"Source is not started"),this._gainNode.gain.cancelScheduledValues(this._startTime+this.sampleTime),this.context.clearTimeout(this._timeout),this._stopTime=-1,this}dispose(){return super.dispose(),this._gainNode.disconnect(),this}};var fp=class extends Ps{constructor(){super(pe(fp.getDefaults(),arguments,["offset"]));this.name="ToneConstantSource",this._source=this.context.createConstantSource();let e=pe(fp.getDefaults(),arguments,["offset"]);un(this._source,this._gainNode),this.offset=new ft({context:this.context,convert:e.convert,param:this._source.offset,units:e.units,value:e.offset,minValue:e.minValue,maxValue:e.maxValue})}static getDefaults(){return Object.assign(Ps.getDefaults(),{convert:!0,offset:1,units:"number"})}start(e){let t=this.toSeconds(e);return this.log("start",t),this._startGain(t),this._source.start(t),this}_stopSource(e){this._source.stop(e)}dispose(){return super.dispose(),this.state==="started"&&this.stop(),this._source.disconnect(),this.offset.dispose(),this}};var Lt=class extends je{constructor(){super(pe(Lt.getDefaults(),arguments,["value","units"]));this.name="Signal",this.override=!0;let e=pe(Lt.getDefaults(),arguments,["value","units"]);this.output=this._constantSource=new fp({context:this.context,convert:e.convert,offset:e.value,units:e.units,minValue:e.minValue,maxValue:e.maxValue}),this._constantSource.start(0),this.input=this._param=this._constantSource.offset}static getDefaults(){return Object.assign(je.getDefaults(),{convert:!0,units:"number",value:0})}connect(e,t=0,r=0){return Fd(this,e,t,r),this}dispose(){return super.dispose(),this._param.dispose(),this._constantSource.dispose(),this}setValueAtTime(e,t){return this._param.setValueAtTime(e,t),this}getValueAtTime(e){return this._param.getValueAtTime(e)}setRampPoint(e){return this._param.setRampPoint(e),this}linearRampToValueAtTime(e,t){return this._param.linearRampToValueAtTime(e,t),this}exponentialRampToValueAtTime(e,t){return this._param.exponentialRampToValueAtTime(e,t),this}exponentialRampTo(e,t,r){return this._param.exponentialRampTo(e,t,r),this}linearRampTo(e,t,r){return this._param.linearRampTo(e,t,r),this}targetRampTo(e,t,r){return this._param.targetRampTo(e,t,r),this}exponentialApproachValueAtTime(e,t,r){return this._param.exponentialApproachValueAtTime(e,t,r),this}setTargetAtTime(e,t,r){return this._param.setTargetAtTime(e,t,r),this}setValueCurveAtTime(e,t,r,o){return this._param.setValueCurveAtTime(e,t,r,o),this}cancelScheduledValues(e){return this._param.cancelScheduledValues(e),this}cancelAndHoldAtTime(e){return this._param.cancelAndHoldAtTime(e),this}rampTo(e,t,r){return this._param.rampTo(e,t,r),this}get value(){return this._param.value}set value(e){this._param.value=e}get convert(){return this._param.convert}set convert(e){this._param.convert=e}get units(){return this._param.units}get overridden(){return this._param.overridden}set overridden(e){this._param.overridden=e}get maxValue(){return this._param.maxValue}get minValue(){return this._param.minValue}apply(e){return this._param.apply(e),this}};function Fd(i,e,t,r){(e instanceof ft||Bn(e)||e instanceof Lt&&e.override)&&(e.cancelScheduledValues(0),e.setValueAtTime(0,0),e instanceof Lt&&(e.overridden=!0)),un(i,e,t,r)}var Ic=class extends je{constructor(){super(Object.assign(pe(Ic.getDefaults(),arguments,["context"])))}connect(e,t=0,r=0){return Fd(this,e,t,r),this}};var va=class extends Ic{constructor(){super(Object.assign(pe(va.getDefaults(),arguments,["mapping","length"])));this.name="WaveShaper",this._shaper=this.context.createWaveShaper(),this.input=this._shaper,this.output=this._shaper;let e=pe(va.getDefaults(),arguments,["mapping","length"]);ao(e.mapping)||e.mapping instanceof Float32Array?this.curve=Float32Array.from(e.mapping):mI(e.mapping)&&this.setMap(e.mapping,e.length)}static getDefaults(){return Object.assign(Lt.getDefaults(),{length:1024})}setMap(e,t=1024){let r=new Float32Array(t);for(let o=0,n=t;o<n;o++){let s=o/(n-1)*2-1;r[o]=e(s,o)}return this.curve=r,this}get curve(){return this._shaper.curve}set curve(e){this._shaper.curve=e}get oversample(){return this._shaper.oversample}set oversample(e){let t=["none","2x","4x"].some(r=>r.includes(e));ze(t,"oversampling must be either 'none', '2x', or '4x'"),this._shaper.oversample=e}dispose(){return super.dispose(),this._shaper.disconnect(),this}};var Ud=class extends Ic{constructor(){super(...arguments);this.name="AudioToGain",this._norm=new va({context:this.context,mapping:e=>(e+1)/2}),this.input=this._norm,this.output=this._norm}dispose(){return super.dispose(),this._norm.dispose(),this}};var Fi=class extends Lt{constructor(){super(Object.assign(pe(Fi.getDefaults(),arguments,["value"])));this.name="Multiply",this.override=!1;let e=pe(Fi.getDefaults(),arguments,["value"]);this._mult=this.input=this.output=new Zt({context:this.context,minValue:e.minValue,maxValue:e.maxValue}),this.factor=this._param=this._mult.gain,this.factor.setValueAtTime(e.value,0)}static getDefaults(){return Object.assign(Lt.getDefaults(),{value:0})}dispose(){return super.dispose(),this._mult.dispose(),this}};function oD(i,e=1/0){let t=new WeakMap;return function(r,o){Reflect.defineProperty(r,o,{configurable:!0,enumerable:!0,get:function(){return t.get(this)},set:function(n){Bo(n,i,e),t.set(this,n)}})}}function pn(i,e=1/0){let t=new WeakMap;return function(r,o){Reflect.defineProperty(r,o,{configurable:!0,enumerable:!0,get:function(){return t.get(this)},set:function(n){Bo(this.toSeconds(n),i,e),t.set(this,n)}})}}var Zo=class extends je{constructor(){super(pe(Zo.getDefaults(),arguments,["attack","decay","sustain","release"]));this.name="Envelope",this._sig=new Lt({context:this.context,value:0}),this.output=this._sig,this.input=void 0;let e=pe(Zo.getDefaults(),arguments,["attack","decay","sustain","release"]);this.attack=e.attack,this.decay=e.decay,this.sustain=e.sustain,this.release=e.release,this.attackCurve=e.attackCurve,this.releaseCurve=e.releaseCurve,this.decayCurve=e.decayCurve}static getDefaults(){return Object.assign(je.getDefaults(),{attack:.01,attackCurve:"linear",decay:.1,decayCurve:"exponential",release:1,releaseCurve:"exponential",sustain:.5})}get value(){return this.getValueAtTime(this.now())}_getCurve(e,t){if(bo(e))return e;{let r;for(r in H_)if(H_[r][t]===e)return r;return e}}_setCurve(e,t,r){if(bo(r)&&Reflect.has(H_,r)){let o=H_[r];Os(o)?e!=="_decayCurve"&&(this[e]=o[t]):this[e]=o}else if(ao(r)&&e!=="_decayCurve")this[e]=r;else throw new Error("Envelope: invalid curve: "+r)}get attackCurve(){return this._getCurve(this._attackCurve,"In")}set attackCurve(e){this._setCurve("_attackCurve","In",e)}get releaseCurve(){return this._getCurve(this._releaseCurve,"Out")}set releaseCurve(e){this._setCurve("_releaseCurve","Out",e)}get decayCurve(){return this._decayCurve}set decayCurve(e){ze(["linear","exponential"].some(t=>t===e),`Invalid envelope curve: ${e}`),this._decayCurve=e}triggerAttack(e,t=1){this.log("triggerAttack",e,t),e=this.toSeconds(e);let o=this.toSeconds(this.attack),n=this.toSeconds(this.decay),s=this.getValueAtTime(e);if(s>0){let a=1/o;o=(1-s)/a}if(o<this.sampleTime)this._sig.cancelScheduledValues(e),this._sig.setValueAtTime(t,e);else if(this._attackCurve==="linear")this._sig.linearRampTo(t,o,e);else if(this._attackCurve==="exponential")this._sig.targetRampTo(t,o,e);else{this._sig.cancelAndHoldAtTime(e);let a=this._attackCurve;for(let c=1;c<a.length;c++)if(a[c-1]<=s&&s<=a[c]){a=this._attackCurve.slice(c),a[0]=s;break}this._sig.setValueCurveAtTime(a,e,o,t)}if(n&&this.sustain<1){let a=t*this.sustain,c=e+o;this.log("decay",c),this._decayCurve==="linear"?this._sig.linearRampToValueAtTime(a,n+c):this._sig.exponentialApproachValueAtTime(a,c,n)}return this}triggerRelease(e){this.log("triggerRelease",e),e=this.toSeconds(e);let t=this.getValueAtTime(e);if(t>0){let r=this.toSeconds(this.release);r<this.sampleTime?this._sig.setValueAtTime(0,e):this._releaseCurve==="linear"?this._sig.linearRampTo(0,r,e):this._releaseCurve==="exponential"?this._sig.targetRampTo(0,r,e):(ze(ao(this._releaseCurve),"releaseCurve must be either 'linear', 'exponential' or an array"),this._sig.cancelAndHoldAtTime(e),this._sig.setValueCurveAtTime(this._releaseCurve,e,r,t))}return this}getValueAtTime(e){return this._sig.getValueAtTime(e)}triggerAttackRelease(e,t,r=1){return t=this.toSeconds(t),this.triggerAttack(t,r),this.triggerRelease(t+this.toSeconds(e)),this}cancel(e){return this._sig.cancelScheduledValues(this.toSeconds(e)),this}connect(e,t=0,r=0){return Fd(this,e,t,r),this}asArray(e=1024){return yt(this,void 0,void 0,function*(){let t=e/this.context.sampleRate,r=new Lc(1,t,this.context.sampleRate),o=this.toSeconds(this.attack)+this.toSeconds(this.decay),n=o+this.toSeconds(this.release),s=n*.1,a=n+s,c=new this.constructor(Object.assign(this.get(),{attack:t*this.toSeconds(this.attack)/a,decay:t*this.toSeconds(this.decay)/a,release:t*this.toSeconds(this.release)/a,context:r}));return c._sig.toDestination(),c.triggerAttackRelease(t*(o+s)/a,0),(yield r.render()).getChannelData(0)})}dispose(){return super.dispose(),this._sig.dispose(),this}};Bi([pn(0)],Zo.prototype,"attack",void 0);Bi([pn(0)],Zo.prototype,"decay",void 0);Bi([oD(0,1)],Zo.prototype,"sustain",void 0);Bi([pn(0)],Zo.prototype,"release",void 0);var H_=(()=>{let e,t,r=[];for(e=0;e<128;e++)r[e]=Math.sin(e/(128-1)*(Math.PI/2));let o=[],n=6.4;for(e=0;e<128-1;e++){t=e/(128-1);let h=Math.sin(t*(Math.PI*2)*n-Math.PI/2)+1;o[e]=h/10+t*.83}o[128-1]=1;let s=[],a=5;for(e=0;e<128;e++)s[e]=Math.ceil(e/(128-1)*a)/a;let c=[];for(e=0;e<128;e++)t=e/(128-1),c[e]=.5*(1-Math.cos(Math.PI*t));let l=[];for(e=0;e<128;e++){t=e/(128-1);let h=Math.pow(t,3)*4+.2,d=Math.cos(h*Math.PI*2*t);l[e]=Math.abs(d*(1-t))}function u(h){let d=new Array(h.length);for(let m=0;m<h.length;m++)d[m]=1-h[m];return d}function p(h){return h.slice(0).reverse()}return{bounce:{In:u(l),Out:l},cosine:{In:r,Out:p(r)},exponential:"exponential",linear:"linear",ripple:{In:o,Out:u(o)},sine:{In:c,Out:u(c)},step:{In:s,Out:u(s)}}})();var fi=class extends je{constructor(){super(pe(fi.getDefaults(),arguments,["volume"]));this.name="Volume";let e=pe(fi.getDefaults(),arguments,["volume"]);this.input=this.output=new Zt({context:this.context,gain:e.volume,units:"decibels"}),this.volume=this.output.gain,_t(this,"volume"),this._unmutedVolume=e.volume,this.mute=e.mute}static getDefaults(){return Object.assign(je.getDefaults(),{mute:!1,volume:0})}get mute(){return this.volume.value===-1/0}set mute(e){!this.mute&&e?(this._unmutedVolume=this.volume.value,this.volume.value=-1/0):this.mute&&!e&&(this.volume.value=this._unmutedVolume)}dispose(){return super.dispose(),this.input.dispose(),this.volume.dispose(),this}};var Rs=class extends je{constructor(){super(pe(Rs.getDefaults(),arguments));this._scheduledEvents=[],this._synced=!1,this._original_triggerAttack=this.triggerAttack,this._original_triggerRelease=this.triggerRelease;let e=pe(Rs.getDefaults(),arguments);this._volume=this.output=new fi({context:this.context,volume:e.volume}),this.volume=this._volume.volume,_t(this,"volume")}static getDefaults(){return Object.assign(je.getDefaults(),{volume:0})}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",0)),this}_syncState(){let e=!1;return this._synced||(this._synced=!0,e=!0),e}_syncMethod(e,t){let r=this["_original_"+e]=this[e];this[e]=(...o)=>{let n=o[t],s=this.context.transport.schedule(a=>{o[t]=a,r.apply(this,o)},n);this._scheduledEvents.push(s)}}unsync(){return this._scheduledEvents.forEach(e=>this.context.transport.clear(e)),this._scheduledEvents=[],this._synced&&(this._synced=!1,this.triggerAttack=this._original_triggerAttack,this.triggerRelease=this._original_triggerRelease),this}triggerAttackRelease(e,t,r,o){let n=this.toSeconds(r),s=this.toSeconds(t);return this.triggerAttack(e,n,o),this.triggerRelease(n+s),this}dispose(){return super.dispose(),this._volume.dispose(),this.unsync(),this._scheduledEvents=[],this}};var Un=class extends Rs{constructor(){super(pe(Un.getDefaults(),arguments));let e=pe(Un.getDefaults(),arguments);this.portamento=e.portamento,this.onsilence=e.onsilence}static getDefaults(){return Object.assign(Rs.getDefaults(),{detune:0,onsilence:gt,portamento:0})}triggerAttack(e,t,r=1){this.log("triggerAttack",e,t,r);let o=this.toSeconds(t);return this._triggerEnvelopeAttack(o,r),this.setNote(e,o),this}triggerRelease(e){this.log("triggerRelease",e);let t=this.toSeconds(e);return this._triggerEnvelopeRelease(t),this}setNote(e,t){let r=this.toSeconds(t),o=e instanceof Jo?e.toFrequency():e;if(this.portamento>0&&this.getLevelAtTime(r)>.05){let n=this.toSeconds(this.portamento);this.frequency.exponentialRampTo(o,n,r)}else this.frequency.setValueAtTime(o,r);return this}};Bi([pn(0)],Un.prototype,"portamento",void 0);var Vd=class extends je{constructor(){super(pe(Vd.getDefaults(),arguments));this.name="Destination",this.input=new fi({context:this.context}),this.output=new Zt({context:this.context}),this.volume=this.input.volume;let e=pe(Vd.getDefaults(),arguments);z_(this.input,this.output,this.context.rawContext.destination),this.mute=e.mute,this._internalChannels=[this.input,this.context.rawContext.destination,this.output]}static getDefaults(){return Object.assign(je.getDefaults(),{mute:!1,volume:0})}get mute(){return this.input.mute}set mute(e){this.input.mute=e}chain(...e){return this.input.disconnect(),e.unshift(this.input),e.push(this.output),z_(...e),this}get maxChannelCount(){return this.context.rawContext.destination.maxChannelCount}dispose(){return super.dispose(),this.volume.dispose(),this}};pp(i=>{i.destination=new Vd({context:i})});hp(i=>{i.destination.dispose()});var p7=class extends co{constructor(e){super();this.name="TimelineValue",this._timeline=new To({memory:10}),this._initialValue=e}set(e,t){return this._timeline.add({value:e,time:t}),this}get(e){let t=this._timeline.get(e);return t?t.value:this._initialValue}};var hn=class extends h0{constructor(){super(...arguments);this.name="Ticks",this.defaultUnits="i"}_now(){return this.context.transport.ticks}_beatsToUnits(e){return this._getPPQ()*e}_secondsToUnits(e){return Math.floor(e/(60/this._getBpm())*this._getPPQ())}_ticksToUnits(e){return e}toTicks(){return this.valueOf()}toSeconds(){return this.valueOf()/this._getPPQ()*(60/this._getBpm())}};var h7=class extends co{constructor(){super(...arguments);this.name="IntervalTimeline",this._root=null,this._length=0}add(e){ze(qe(e.time),"Events must have a time property"),ze(qe(e.duration),"Events must have a duration parameter"),e.time=e.time.valueOf();let t=new iD(e.time,e.time+e.duration,e);for(this._root===null?this._root=t:this._root.insert(t),this._length++;t!==null;)t.updateHeight(),t.updateMax(),this._rebalance(t),t=t.parent;return this}remove(e){if(this._root!==null){let t=[];this._root.search(e.time,t);for(let r of t)if(r.event===e){this._removeNode(r),this._length--;break}}return this}get length(){return this._length}cancel(e){return this.forEachFrom(e,t=>this.remove(t)),this}_setRoot(e){this._root=e,this._root!==null&&(this._root.parent=null)}_replaceNodeInParent(e,t){e.parent!==null?(e.isLeftChild()?e.parent.left=t:e.parent.right=t,this._rebalance(e.parent)):this._setRoot(t)}_removeNode(e){if(e.left===null&&e.right===null)this._replaceNodeInParent(e,null);else if(e.right===null)this._replaceNodeInParent(e,e.left);else if(e.left===null)this._replaceNodeInParent(e,e.right);else{let t=e.getBalance(),r,o=null;if(t>0)if(e.left.right===null)r=e.left,r.right=e.right,o=r;else{for(r=e.left.right;r.right!==null;)r=r.right;r.parent&&(r.parent.right=r.left,o=r.parent,r.left=e.left,r.right=e.right)}else if(e.right.left===null)r=e.right,r.left=e.left,o=r;else{for(r=e.right.left;r.left!==null;)r=r.left;r.parent&&(r.parent.left=r.right,o=r.parent,r.left=e.left,r.right=e.right)}e.parent!==null?e.isLeftChild()?e.parent.left=r:e.parent.right=r:this._setRoot(r),o&&this._rebalance(o)}e.dispose()}_rotateLeft(e){let t=e.parent,r=e.isLeftChild(),o=e.right;o&&(e.right=o.left,o.left=e),t!==null?r?t.left=o:t.right=o:this._setRoot(o)}_rotateRight(e){let t=e.parent,r=e.isLeftChild(),o=e.left;o&&(e.left=o.right,o.right=e),t!==null?r?t.left=o:t.right=o:this._setRoot(o)}_rebalance(e){let t=e.getBalance();t>1&&e.left?e.left.getBalance()<0?this._rotateLeft(e.left):this._rotateRight(e):t<-1&&e.right&&(e.right.getBalance()>0?this._rotateRight(e.right):this._rotateLeft(e))}get(e){if(this._root!==null){let t=[];if(this._root.search(e,t),t.length>0){let r=t[0];for(let o=1;o<t.length;o++)t[o].low>r.low&&(r=t[o]);return r.event}}return null}forEach(e){if(this._root!==null){let t=[];this._root.traverse(r=>t.push(r)),t.forEach(r=>{r.event&&e(r.event)})}return this}forEachAtTime(e,t){if(this._root!==null){let r=[];this._root.search(e,r),r.forEach(o=>{o.event&&t(o.event)})}return this}forEachFrom(e,t){if(this._root!==null){let r=[];this._root.searchAfter(e,r),r.forEach(o=>{o.event&&t(o.event)})}return this}dispose(){return super.dispose(),this._root!==null&&this._root.traverse(e=>e.dispose()),this._root=null,this}},iD=class{constructor(e,t,r){this._left=null,this._right=null,this.parent=null,this.height=0,this.event=r,this.low=e,this.high=t,this.max=this.high}insert(e){e.low<=this.low?this.left===null?this.left=e:this.left.insert(e):this.right===null?this.right=e:this.right.insert(e)}search(e,t){e>this.max||(this.left!==null&&this.left.search(e,t),this.low<=e&&this.high>e&&t.push(this),!(this.low>e)&&this.right!==null&&this.right.search(e,t))}searchAfter(e,t){this.low>=e&&(t.push(this),this.left!==null&&this.left.searchAfter(e,t)),this.right!==null&&this.right.searchAfter(e,t)}traverse(e){e(this),this.left!==null&&this.left.traverse(e),this.right!==null&&this.right.traverse(e)}updateHeight(){this.left!==null&&this.right!==null?this.height=Math.max(this.left.height,this.right.height)+1:this.right!==null?this.height=this.right.height+1:this.left!==null?this.height=this.left.height+1:this.height=0}updateMax(){this.max=this.high,this.left!==null&&(this.max=Math.max(this.max,this.left.max)),this.right!==null&&(this.max=Math.max(this.max,this.right.max))}getBalance(){let e=0;return this.left!==null&&this.right!==null?e=this.left.height-this.right.height:this.left!==null?e=this.left.height+1:this.right!==null&&(e=-(this.right.height+1)),e}isLeftChild(){return this.parent!==null&&this.parent.left===this}get left(){return this._left}set left(e){this._left=e,e!==null&&(e.parent=this),this.updateHeight(),this.updateMax()}get right(){return this._right}set right(e){this._right=e,e!==null&&(e.parent=this),this.updateHeight(),this.updateMax()}dispose(){this.parent=null,this._left=null,this._right=null,this.event=null}};var Dc=class extends To{constructor(e="stopped"){super();this.name="StateTimeline",this._initial=e,this.setStateAtTime(this._initial,0)}getValueAtTime(e){let t=this.get(e);return t!==null?t.state:this._initial}setStateAtTime(e,t,r){return Bo(t,0),this.add(Object.assign({},r,{state:e,time:t})),this}getLastState(e,t){let r=this._search(t);for(let o=r;o>=0;o--){let n=this._timeline[o];if(n.state===e)return n}}getNextState(e,t){let r=this._search(t);if(r!==-1)for(let o=r;o<this._timeline.length;o++){let n=this._timeline[o];if(n.state===e)return n}}};var mp=class extends ft{constructor(){super(pe(mp.getDefaults(),arguments,["value"]));this.name="TickParam",this._events=new To(1/0),this._multiplier=1;let e=pe(mp.getDefaults(),arguments,["value"]);this._multiplier=e.multiplier,this._events.cancel(0),this._events.add({ticks:0,time:0,type:"setValueAtTime",value:this._fromType(e.value)}),this.setValueAtTime(e.value,0)}static getDefaults(){return Object.assign(ft.getDefaults(),{multiplier:1,units:"hertz",value:1})}setTargetAtTime(e,t,r){t=this.toSeconds(t),this.setRampPoint(t);let o=this._fromType(e),n=this._events.get(t),s=Math.round(Math.max(1/r,1));for(let a=0;a<=s;a++){let c=r*a+t,l=this._exponentialApproach(n.time,n.value,o,r,c);this.linearRampToValueAtTime(this._toType(l),c)}return this}setValueAtTime(e,t){let r=this.toSeconds(t);super.setValueAtTime(e,t);let o=this._events.get(r),n=this._events.previousEvent(o),s=this._getTicksUntilEvent(n,r);return o.ticks=Math.max(s,0),this}linearRampToValueAtTime(e,t){let r=this.toSeconds(t);super.linearRampToValueAtTime(e,t);let o=this._events.get(r),n=this._events.previousEvent(o),s=this._getTicksUntilEvent(n,r);return o.ticks=Math.max(s,0),this}exponentialRampToValueAtTime(e,t){t=this.toSeconds(t);let r=this._fromType(e),o=this._events.get(t),n=Math.round(Math.max((t-o.time)*10,1)),s=(t-o.time)/n;for(let a=0;a<=n;a++){let c=s*a+o.time,l=this._exponentialInterpolate(o.time,o.value,t,r,c);this.linearRampToValueAtTime(this._toType(l),c)}return this}_getTicksUntilEvent(e,t){if(e===null)e={ticks:0,time:0,type:"setValueAtTime",value:0};else if(Jr(e.ticks)){let s=this._events.previousEvent(e);e.ticks=this._getTicksUntilEvent(s,e.time)}let r=this._fromType(this.getValueAtTime(e.time)),o=this._fromType(this.getValueAtTime(t)),n=this._events.get(t);return n&&n.time===t&&n.type==="setValueAtTime"&&(o=this._fromType(this.getValueAtTime(t-this.sampleTime))),.5*(t-e.time)*(r+o)+e.ticks}getTicksAtTime(e){let t=this.toSeconds(e),r=this._events.get(t);return Math.max(this._getTicksUntilEvent(r,t),0)}getDurationOfTicks(e,t){let r=this.toSeconds(t),o=this.getTicksAtTime(t);return this.getTimeOfTick(o+e)-r}getTimeOfTick(e){let t=this._events.get(e,"ticks"),r=this._events.getAfter(e,"ticks");if(t&&t.ticks===e)return t.time;if(t&&r&&r.type==="linearRampToValueAtTime"&&t.value!==r.value){let o=this._fromType(this.getValueAtTime(t.time)),s=(this._fromType(this.getValueAtTime(r.time))-o)/(r.time-t.time),a=Math.sqrt(Math.pow(o,2)-2*s*(t.ticks-e)),c=(-o+a)/s,l=(-o-a)/s;return(c>0?c:l)+t.time}else return t?t.value===0?1/0:t.time+(e-t.ticks)/t.value:e/this._initialValue}ticksToTime(e,t){return this.getDurationOfTicks(e,t)}timeToTicks(e,t){let r=this.toSeconds(t),o=this.toSeconds(e),n=this.getTicksAtTime(r);return this.getTicksAtTime(r+o)-n}_fromType(e){return this.units==="bpm"&&this.multiplier?1/(60/e/this.multiplier):super._fromType(e)}_toType(e){return this.units==="bpm"&&this.multiplier?e/this.multiplier*60:super._toType(e)}get multiplier(){return this._multiplier}set multiplier(e){let t=this.value;this._multiplier=e,this.cancelScheduledValues(0),this.setValueAtTime(t,0)}};var _p=class extends Lt{constructor(){super(pe(_p.getDefaults(),arguments,["value"]));this.name="TickSignal";let e=pe(_p.getDefaults(),arguments,["value"]);this.input=this._param=new mp({context:this.context,convert:e.convert,multiplier:e.multiplier,param:this._constantSource.offset,units:e.units,value:e.value})}static getDefaults(){return Object.assign(Lt.getDefaults(),{multiplier:1,units:"hertz",value:1})}ticksToTime(e,t){return this._param.ticksToTime(e,t)}timeToTicks(e,t){return this._param.timeToTicks(e,t)}getTimeOfTick(e){return this._param.getTimeOfTick(e)}getDurationOfTicks(e,t){return this._param.getDurationOfTicks(e,t)}getTicksAtTime(e){return this._param.getTicksAtTime(e)}get multiplier(){return this._param.multiplier}set multiplier(e){this._param.multiplier=e}dispose(){return super.dispose(),this._param.dispose(),this}};var gp=class extends Zr{constructor(){super(pe(gp.getDefaults(),arguments,["frequency"]));this.name="TickSource",this._state=new Dc,this._tickOffset=new To;let e=pe(gp.getDefaults(),arguments,["frequency"]);this.frequency=new _p({context:this.context,units:e.units,value:e.frequency}),_t(this,"frequency"),this._state.setStateAtTime("stopped",0),this.setTicksAtTime(0,0)}static getDefaults(){return Object.assign({frequency:1,units:"hertz"},Zr.getDefaults())}get state(){return this.getStateAtTime(this.now())}start(e,t){let r=this.toSeconds(e);return this._state.getValueAtTime(r)!=="started"&&(this._state.setStateAtTime("started",r),qe(t)&&this.setTicksAtTime(t,r)),this}stop(e){let t=this.toSeconds(e);if(this._state.getValueAtTime(t)==="stopped"){let r=this._state.get(t);r&&r.time>0&&(this._tickOffset.cancel(r.time),this._state.cancel(r.time))}return this._state.cancel(t),this._state.setStateAtTime("stopped",t),this.setTicksAtTime(0,t),this}pause(e){let t=this.toSeconds(e);return this._state.getValueAtTime(t)==="started"&&this._state.setStateAtTime("paused",t),this}cancel(e){return e=this.toSeconds(e),this._state.cancel(e),this._tickOffset.cancel(e),this}getTicksAtTime(e){let t=this.toSeconds(e),r=this._state.getLastState("stopped",t),o={state:"paused",time:t};this._state.add(o);let n=r,s=0;return this._state.forEachBetween(r.time,t+this.sampleTime,a=>{let c=n.time,l=this._tickOffset.get(a.time);l&&l.time>=n.time&&(s=l.ticks,c=l.time),n.state==="started"&&a.state!=="started"&&(s+=this.frequency.getTicksAtTime(a.time)-this.frequency.getTicksAtTime(c)),n=a}),this._state.remove(o),s}get ticks(){return this.getTicksAtTime(this.now())}set ticks(e){this.setTicksAtTime(e,this.now())}get seconds(){return this.getSecondsAtTime(this.now())}set seconds(e){let t=this.now(),r=this.frequency.timeToTicks(e,t);this.setTicksAtTime(r,t)}getSecondsAtTime(e){e=this.toSeconds(e);let t=this._state.getLastState("stopped",e),r={state:"paused",time:e};this._state.add(r);let o=t,n=0;return this._state.forEachBetween(t.time,e+this.sampleTime,s=>{let a=o.time,c=this._tickOffset.get(s.time);c&&c.time>=o.time&&(n=c.seconds,a=c.time),o.state==="started"&&s.state!=="started"&&(n+=s.time-a),o=s}),this._state.remove(r),n}setTicksAtTime(e,t){return t=this.toSeconds(t),this._tickOffset.cancel(t),this._tickOffset.add({seconds:this.frequency.getDurationOfTicks(e,t),ticks:e,time:t}),this}getStateAtTime(e){return e=this.toSeconds(e),this._state.getValueAtTime(e)}getTimeOfTick(e,t=this.now()){let r=this._tickOffset.get(t),o=this._state.get(t),n=Math.max(r.time,o.time),s=this.frequency.getTicksAtTime(n)+e-r.ticks;return this.frequency.getTimeOfTick(s)}forEachTickBetween(e,t,r){let o=this._state.get(e);this._state.forEachBetween(e,t,s=>{o&&o.state==="started"&&s.state!=="started"&&this.forEachTickBetween(Math.max(o.time,e),s.time-this.sampleTime,r),o=s});let n=null;if(o&&o.state==="started"){let s=Math.max(o.time,e),a=this.frequency.getTicksAtTime(s),c=this.frequency.getTicksAtTime(o.time),l=a-c,u=Math.ceil(l)-l;u=Ko(u,1)?0:u;let p=this.frequency.getTimeOfTick(a+u);for(;p<t;){try{r(p,Math.round(this.getTicksAtTime(p)))}catch(h){n=h;break}p+=this.frequency.getDurationOfTicks(1,p)}}if(n)throw n;return this}dispose(){return super.dispose(),this._state.dispose(),this._tickOffset.dispose(),this.frequency.dispose(),this}};var kc=class extends Zr{constructor(){super(pe(kc.getDefaults(),arguments,["callback","frequency"]));this.name="Clock",this.callback=gt,this._lastUpdate=0,this._state=new Dc("stopped"),this._boundLoop=this._loop.bind(this);let e=pe(kc.getDefaults(),arguments,["callback","frequency"]);this.callback=e.callback,this._tickSource=new gp({context:this.context,frequency:e.frequency,units:e.units}),this._lastUpdate=0,this.frequency=this._tickSource.frequency,_t(this,"frequency"),this._state.setStateAtTime("stopped",0),this.context.on("tick",this._boundLoop)}static getDefaults(){return Object.assign(Zr.getDefaults(),{callback:gt,frequency:1,units:"hertz"})}get state(){return this._state.getValueAtTime(this.now())}start(e,t){B_(this.context);let r=this.toSeconds(e);return this.log("start",r),this._state.getValueAtTime(r)!=="started"&&(this._state.setStateAtTime("started",r),this._tickSource.start(r,t),r<this._lastUpdate&&this.emit("start",r,t)),this}stop(e){let t=this.toSeconds(e);return this.log("stop",t),this._state.cancel(t),this._state.setStateAtTime("stopped",t),this._tickSource.stop(t),t<this._lastUpdate&&this.emit("stop",t),this}pause(e){let t=this.toSeconds(e);return this._state.getValueAtTime(t)==="started"&&(this._state.setStateAtTime("paused",t),this._tickSource.pause(t),t<this._lastUpdate&&this.emit("pause",t)),this}get ticks(){return Math.ceil(this.getTicksAtTime(this.now()))}set ticks(e){this._tickSource.ticks=e}get seconds(){return this._tickSource.seconds}set seconds(e){this._tickSource.seconds=e}getSecondsAtTime(e){return this._tickSource.getSecondsAtTime(e)}setTicksAtTime(e,t){return this._tickSource.setTicksAtTime(e,t),this}getTimeOfTick(e,t=this.now()){return this._tickSource.getTimeOfTick(e,t)}getTicksAtTime(e){return this._tickSource.getTicksAtTime(e)}nextTickTime(e,t){let r=this.toSeconds(t),o=this.getTicksAtTime(r);return this._tickSource.getTimeOfTick(o+e,r)}_loop(){let e=this._lastUpdate,t=this.now();this._lastUpdate=t,this.log("loop",e,t),e!==t&&(this._state.forEachBetween(e,t,r=>{switch(r.state){case"started":let o=this._tickSource.getTicksAtTime(r.time);this.emit("start",r.time,o);break;case"stopped":r.time!==0&&this.emit("stop",r.time);break;case"paused":this.emit("pause",r.time);break}}),this._tickSource.forEachTickBetween(e,t,(r,o)=>{this.callback(r,o)}))}getStateAtTime(e){let t=this.toSeconds(e);return this._state.getValueAtTime(t)}dispose(){return super.dispose(),this.context.off("tick",this._boundLoop),this._tickSource.dispose(),this._state.dispose(),this}};p0.mixin(kc);var Vn=class{constructor(e,t){this.id=Vn._eventId++;let r=Object.assign(Vn.getDefaults(),t);this.transport=e,this.callback=r.callback,this._once=r.once,this.time=r.time}static getDefaults(){return{callback:gt,once:!1,time:0}}invoke(e){this.callback&&(this.callback(e),this._once&&this.transport.clear(this.id))}dispose(){return this.callback=void 0,this}};Vn._eventId=0;var Gd=class extends Vn{constructor(e,t){super(e,t);this._currentId=-1,this._nextId=-1,this._nextTick=this.time,this._boundRestart=this._restart.bind(this);let r=Object.assign(Gd.getDefaults(),t);this.duration=new hn(e.context,r.duration).valueOf(),this._interval=new hn(e.context,r.interval).valueOf(),this._nextTick=r.time,this.transport.on("start",this._boundRestart),this.transport.on("loopStart",this._boundRestart),this.context=this.transport.context,this._restart()}static getDefaults(){return Object.assign({},Vn.getDefaults(),{duration:1/0,interval:1,once:!1})}invoke(e){this._createEvents(e),super.invoke(e)}_createEvents(e){let t=this.transport.getTicksAtTime(e);t>=this.time&&t>=this._nextTick&&this._nextTick+this._interval<this.time+this.duration&&(this._nextTick+=this._interval,this._currentId=this._nextId,this._nextId=this.transport.scheduleOnce(this.invoke.bind(this),new hn(this.context,this._nextTick).toSeconds()))}_restart(e){this.transport.clear(this._currentId),this.transport.clear(this._nextId),this._nextTick=this.time;let t=this.transport.getTicksAtTime(e);t>this.time&&(this._nextTick=this.time+Math.ceil((t-this.time)/this._interval)*this._interval),this._currentId=this.transport.scheduleOnce(this.invoke.bind(this),new hn(this.context,this._nextTick).toSeconds()),this._nextTick+=this._interval,this._nextId=this.transport.scheduleOnce(this.invoke.bind(this),new hn(this.context,this._nextTick).toSeconds())}dispose(){return super.dispose(),this.transport.clear(this._currentId),this.transport.clear(this._nextId),this.transport.off("start",this._boundRestart),this.transport.off("loopStart",this._boundRestart),this}};var vp=class extends Zr{constructor(){super(pe(vp.getDefaults(),arguments));this.name="Transport",this._loop=new p7(!1),this._loopStart=0,this._loopEnd=0,this._scheduledEvents={},this._timeline=new To,this._repeatedEvents=new h7,this._syncedSignals=[],this._swingAmount=0;let e=pe(vp.getDefaults(),arguments);this._ppq=e.ppq,this._clock=new kc({callback:this._processTick.bind(this),context:this.context,frequency:0,units:"bpm"}),this._bindClockEvents(),this.bpm=this._clock.frequency,this._clock.frequency.multiplier=e.ppq,this.bpm.setValueAtTime(e.bpm,0),_t(this,"bpm"),this._timeSignature=e.timeSignature,this._swingTicks=e.ppq/2}static getDefaults(){return Object.assign(Zr.getDefaults(),{bpm:120,loopEnd:"4m",loopStart:0,ppq:192,swing:0,swingSubdivision:"8n",timeSignature:4})}_processTick(e,t){if(this._loop.get(e)&&t>=this._loopEnd&&(this.emit("loopEnd",e),this._clock.setTicksAtTime(this._loopStart,e),t=this._loopStart,this.emit("loopStart",e,this._clock.getSecondsAtTime(e)),this.emit("loop",e)),this._swingAmount>0&&t%this._ppq!==0&&t%(this._swingTicks*2)!==0){let r=t%(this._swingTicks*2)/(this._swingTicks*2),o=Math.sin(r*Math.PI)*this._swingAmount;e+=new hn(this.context,this._swingTicks*2/3).toSeconds()*o}this._timeline.forEachAtTime(t,r=>r.invoke(e))}schedule(e,t){let r=new Vn(this,{callback:e,time:new h0(this.context,t).toTicks()});return this._addEvent(r,this._timeline)}scheduleRepeat(e,t,r,o=1/0){let n=new Gd(this,{callback:e,duration:new Fo(this.context,o).toTicks(),interval:new Fo(this.context,t).toTicks(),time:new h0(this.context,r).toTicks()});return this._addEvent(n,this._repeatedEvents)}scheduleOnce(e,t){let r=new Vn(this,{callback:e,once:!0,time:new h0(this.context,t).toTicks()});return this._addEvent(r,this._timeline)}clear(e){if(this._scheduledEvents.hasOwnProperty(e)){let t=this._scheduledEvents[e.toString()];t.timeline.remove(t.event),t.event.dispose(),delete this._scheduledEvents[e.toString()]}return this}_addEvent(e,t){return this._scheduledEvents[e.id.toString()]={event:e,timeline:t},t.add(e),e.id}cancel(e=0){let t=this.toTicks(e);return this._timeline.forEachFrom(t,r=>this.clear(r.id)),this._repeatedEvents.forEachFrom(t,r=>this.clear(r.id)),this}_bindClockEvents(){this._clock.on("start",(e,t)=>{t=new hn(this.context,t).toSeconds(),this.emit("start",e,t)}),this._clock.on("stop",e=>{this.emit("stop",e)}),this._clock.on("pause",e=>{this.emit("pause",e)})}get state(){return this._clock.getStateAtTime(this.now())}start(e,t){let r;return qe(t)&&(r=this.toTicks(t)),this._clock.start(e,r),this}stop(e){return this._clock.stop(e),this}pause(e){return this._clock.pause(e),this}toggle(e){return e=this.toSeconds(e),this._clock.getStateAtTime(e)!=="started"?this.start(e):this.stop(e),this}get timeSignature(){return this._timeSignature}set timeSignature(e){ao(e)&&(e=e[0]/e[1]*4),this._timeSignature=e}get loopStart(){return new Fo(this.context,this._loopStart,"i").toSeconds()}set loopStart(e){this._loopStart=this.toTicks(e)}get loopEnd(){return new Fo(this.context,this._loopEnd,"i").toSeconds()}set loopEnd(e){this._loopEnd=this.toTicks(e)}get loop(){return this._loop.get(this.now())}set loop(e){this._loop.set(e,this.now())}setLoopPoints(e,t){return this.loopStart=e,this.loopEnd=t,this}get swing(){return this._swingAmount}set swing(e){this._swingAmount=e}get swingSubdivision(){return new hn(this.context,this._swingTicks).toNotation()}set swingSubdivision(e){this._swingTicks=this.toTicks(e)}get position(){let e=this.now(),t=this._clock.getTicksAtTime(e);return new hn(this.context,t).toBarsBeatsSixteenths()}set position(e){let t=this.toTicks(e);this.ticks=t}get seconds(){return this._clock.seconds}set seconds(e){let t=this.now(),r=this._clock.frequency.timeToTicks(e,t);this.ticks=r}get progress(){if(this.loop){let e=this.now();return(this._clock.getTicksAtTime(e)-this._loopStart)/(this._loopEnd-this._loopStart)}else return 0}get ticks(){return this._clock.ticks}set ticks(e){if(this._clock.ticks!==e){let t=this.now();if(this.state==="started"){let r=this._clock.getTicksAtTime(t),o=this._clock.frequency.getDurationOfTicks(Math.ceil(r)-r,t),n=t+o;this.emit("stop",n),this._clock.setTicksAtTime(e,n),this.emit("start",n,this._clock.getSecondsAtTime(n))}else this._clock.setTicksAtTime(e,t)}}getTicksAtTime(e){return Math.round(this._clock.getTicksAtTime(e))}getSecondsAtTime(e){return this._clock.getSecondsAtTime(e)}get PPQ(){return this._clock.frequency.multiplier}set PPQ(e){this._clock.frequency.multiplier=e}nextSubdivision(e){if(e=this.toTicks(e),this.state!=="started")return 0;{let t=this.now(),r=this.getTicksAtTime(t),o=e-r%e;return this._clock.nextTickTime(o,t)}}syncSignal(e,t){if(!t){let o=this.now();if(e.getValueAtTime(o)!==0){let n=this.bpm.getValueAtTime(o),s=1/(60/n/this.PPQ);t=e.getValueAtTime(o)/s}else t=0}let r=new Zt(t);return this.bpm.connect(r),r.connect(e._param),this._syncedSignals.push({initial:e.value,ratio:r,signal:e}),e.value=0,this}unsyncSignal(e){for(let t=this._syncedSignals.length-1;t>=0;t--){let r=this._syncedSignals[t];r.signal===e&&(r.ratio.dispose(),r.signal.value=r.initial,this._syncedSignals.splice(t,1))}return this}dispose(){return super.dispose(),this._clock.dispose(),u7(this,"bpm"),this._timeline.dispose(),this._repeatedEvents.dispose(),this}};p0.mixin(vp);pp(i=>{i.transport=new vp({context:i})});hp(i=>{i.transport.dispose()});var cr=class extends je{constructor(e){super(e);this.input=void 0,this._state=new Dc("stopped"),this._synced=!1,this._scheduled=[],this._syncedStart=gt,this._syncedStop=gt,this._state.memory=100,this._state.increasing=!0,this._volume=this.output=new fi({context:this.context,mute:e.mute,volume:e.volume}),this.volume=this._volume.volume,_t(this,"volume"),this.onstop=e.onstop}static getDefaults(){return Object.assign(je.getDefaults(),{mute:!1,onstop:gt,volume:0})}get state(){return this._synced?this.context.transport.state==="started"?this._state.getValueAtTime(this.context.transport.seconds):"stopped":this._state.getValueAtTime(this.now())}get mute(){return this._volume.mute}set mute(e){this._volume.mute=e}_clampToCurrentTime(e){return this._synced?e:Math.max(e,this.context.currentTime)}start(e,t,r){let o=Jr(e)&&this._synced?this.context.transport.seconds:this.toSeconds(e);if(o=this._clampToCurrentTime(o),!this._synced&&this._state.getValueAtTime(o)==="started")ze(lp(o,this._state.get(o).time),"Start time must be strictly greater than previous start time"),this._state.cancel(o),this._state.setStateAtTime("started",o),this.log("restart",o),this.restart(o,t,r);else if(this.log("start",o),this._state.setStateAtTime("started",o),this._synced){let n=this._state.get(o);n&&(n.offset=this.toSeconds(l0(t,0)),n.duration=r?this.toSeconds(r):void 0);let s=this.context.transport.schedule(a=>{this._start(a,t,r)},o);this._scheduled.push(s),this.context.transport.state==="started"&&this.context.transport.getSecondsAtTime(this.immediate())>o&&this._syncedStart(this.now(),this.context.transport.seconds)}else B_(this.context),this._start(o,t,r);return this}stop(e){let t=Jr(e)&&this._synced?this.context.transport.seconds:this.toSeconds(e);if(t=this._clampToCurrentTime(t),this._state.getValueAtTime(t)==="started"||qe(this._state.getNextState("started",t))){if(this.log("stop",t),!this._synced)this._stop(t);else{let r=this.context.transport.schedule(this._stop.bind(this),t);this._scheduled.push(r)}this._state.cancel(t),this._state.setStateAtTime("stopped",t)}return this}restart(e,t,r){return e=this.toSeconds(e),this._state.getValueAtTime(e)==="started"&&(this._state.cancel(e),this._restart(e,t,r)),this}sync(){return this._synced||(this._synced=!0,this._syncedStart=(e,t)=>{if(t>0){let r=this._state.get(t);if(r&&r.state==="started"&&r.time!==t){let o=t-this.toSeconds(r.time),n;r.duration&&(n=this.toSeconds(r.duration)-o),this._start(e,this.toSeconds(r.offset)+o,n)}}},this._syncedStop=e=>{let t=this.context.transport.getSecondsAtTime(Math.max(e-this.sampleTime,0));this._state.getValueAtTime(t)==="started"&&this._stop(e)},this.context.transport.on("start",this._syncedStart),this.context.transport.on("loopStart",this._syncedStart),this.context.transport.on("stop",this._syncedStop),this.context.transport.on("pause",this._syncedStop),this.context.transport.on("loopEnd",this._syncedStop)),this}unsync(){return this._synced&&(this.context.transport.off("stop",this._syncedStop),this.context.transport.off("pause",this._syncedStop),this.context.transport.off("loopEnd",this._syncedStop),this.context.transport.off("start",this._syncedStart),this.context.transport.off("loopStart",this._syncedStart)),this._synced=!1,this._scheduled.forEach(e=>this.context.transport.clear(e)),this._scheduled=[],this._state.cancel(0),this._stop(0),this}dispose(){return super.dispose(),this.onstop=gt,this.unsync(),this._volume.dispose(),this._state.dispose(),this}};function mi(i,e){return yt(this,void 0,void 0,function*(){let t=e/i.context.sampleRate,r=new Lc(1,t,i.context.sampleRate);return new i.constructor(Object.assign(i.get(),{frequency:2/t,detune:0,context:r})).toDestination().start(0),(yield r.render()).getChannelData(0)})}var xp=class extends Ps{constructor(){super(pe(xp.getDefaults(),arguments,["frequency","type"]));this.name="ToneOscillatorNode",this._oscillator=this.context.createOscillator(),this._internalChannels=[this._oscillator];let e=pe(xp.getDefaults(),arguments,["frequency","type"]);un(this._oscillator,this._gainNode),this.type=e.type,this.frequency=new ft({context:this.context,param:this._oscillator.frequency,units:"frequency",value:e.frequency}),this.detune=new ft({context:this.context,param:this._oscillator.detune,units:"cents",value:e.detune}),_t(this,["frequency","detune"])}static getDefaults(){return Object.assign(Ps.getDefaults(),{detune:0,frequency:440,type:"sine"})}start(e){let t=this.toSeconds(e);return this.log("start",t),this._startGain(t),this._oscillator.start(t),this}_stopSource(e){this._oscillator.stop(e)}setPeriodicWave(e){return this._oscillator.setPeriodicWave(e),this}get type(){return this._oscillator.type}set type(e){this._oscillator.type=e}dispose(){return super.dispose(),this.state==="started"&&this.stop(),this._oscillator.disconnect(),this.frequency.dispose(),this.detune.dispose(),this}};var Qt=class extends cr{constructor(){super(pe(Qt.getDefaults(),arguments,["frequency","type"]));this.name="Oscillator",this._oscillator=null;let e=pe(Qt.getDefaults(),arguments,["frequency","type"]);this.frequency=new Lt({context:this.context,units:"frequency",value:e.frequency}),_t(this,"frequency"),this.detune=new Lt({context:this.context,units:"cents",value:e.detune}),_t(this,"detune"),this._partials=e.partials,this._partialCount=e.partialCount,this._type=e.type,e.partialCount&&e.type!=="custom"&&(this._type=this.baseType+e.partialCount.toString()),this.phase=e.phase}static getDefaults(){return Object.assign(cr.getDefaults(),{detune:0,frequency:440,partialCount:0,partials:[],phase:0,type:"sine"})}_start(e){let t=this.toSeconds(e),r=new xp({context:this.context,onended:()=>this.onstop(this)});this._oscillator=r,this._wave?this._oscillator.setPeriodicWave(this._wave):this._oscillator.type=this._type,this._oscillator.connect(this.output),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.start(t)}_stop(e){let t=this.toSeconds(e);this._oscillator&&this._oscillator.stop(t)}_restart(e){let t=this.toSeconds(e);return this.log("restart",t),this._oscillator&&this._oscillator.cancelStop(),this._state.cancel(t),this}syncFrequency(){return this.context.transport.syncSignal(this.frequency),this}unsyncFrequency(){return this.context.transport.unsyncSignal(this.frequency),this}_getCachedPeriodicWave(){if(this._type==="custom")return Qt._periodicWaveCache.find(t=>t.phase===this._phase&&gI(t.partials,this._partials));{let e=Qt._periodicWaveCache.find(t=>t.type===this._type&&t.phase===this._phase);return this._partialCount=e?e.partialCount:this._partialCount,e}}get type(){return this._type}set type(e){this._type=e;let t=["sine","square","sawtooth","triangle"].indexOf(e)!==-1;if(this._phase===0&&t)this._wave=void 0,this._partialCount=0,this._oscillator!==null&&(this._oscillator.type=e);else{let r=this._getCachedPeriodicWave();if(qe(r)){let{partials:o,wave:n}=r;this._wave=n,this._partials=o,this._oscillator!==null&&this._oscillator.setPeriodicWave(this._wave)}else{let[o,n]=this._getRealImaginary(e,this._phase),s=this.context.createPeriodicWave(o,n);this._wave=s,this._oscillator!==null&&this._oscillator.setPeriodicWave(this._wave),Qt._periodicWaveCache.push({imag:n,partialCount:this._partialCount,partials:this._partials,phase:this._phase,real:o,type:this._type,wave:this._wave}),Qt._periodicWaveCache.length>100&&Qt._periodicWaveCache.shift()}}}get baseType(){return this._type.replace(this.partialCount.toString(),"")}set baseType(e){this.partialCount&&this._type!=="custom"&&e!=="custom"?this.type=e+this.partialCount:this.type=e}get partialCount(){return this._partialCount}set partialCount(e){Bo(e,0);let t=this._type,r=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(this._type);if(r&&(t=r[1]),this._type!=="custom")e===0?this.type=t:this.type=t+e.toString();else{let o=new Float32Array(e);this._partials.forEach((n,s)=>o[s]=n),this._partials=Array.from(o),this.type=this._type}}_getRealImaginary(e,t){let o=2048,n=new Float32Array(o),s=new Float32Array(o),a=1;if(e==="custom"){if(a=this._partials.length+1,this._partialCount=this._partials.length,o=a,this._partials.length===0)return[n,s]}else{let c=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(e);c?(a=parseInt(c[2],10)+1,this._partialCount=parseInt(c[2],10),e=c[1],a=Math.max(a,2),o=a):this._partialCount=0,this._partials=[]}for(let c=1;c<o;++c){let l=2/(c*Math.PI),u;switch(e){case"sine":u=c<=a?1:0,this._partials[c-1]=u;break;case"square":u=c&1?2*l:0,this._partials[c-1]=u;break;case"sawtooth":u=l*(c&1?1:-1),this._partials[c-1]=u;break;case"triangle":c&1?u=2*(l*l)*(c-1>>1&1?-1:1):u=0,this._partials[c-1]=u;break;case"custom":u=this._partials[c-1];break;default:throw new TypeError("Oscillator: invalid type: "+e)}u!==0?(n[c]=-u*Math.sin(t*c),s[c]=u*Math.cos(t*c)):(n[c]=0,s[c]=0)}return[n,s]}_inverseFFT(e,t,r){let o=0,n=e.length;for(let s=0;s<n;s++)o+=e[s]*Math.cos(s*r)+t[s]*Math.sin(s*r);return o}getInitialValue(){let[e,t]=this._getRealImaginary(this._type,0),r=0,o=Math.PI*2,n=32;for(let s=0;s<n;s++)r=Math.max(this._inverseFFT(e,t,s/n*o),r);return MI(-this._inverseFFT(e,t,this._phase)/r,-1,1)}get partials(){return this._partials.slice(0,this.partialCount)}set partials(e){this._partials=e,this._partialCount=this._partials.length,e.length&&(this.type="custom")}get phase(){return this._phase*(180/Math.PI)}set phase(e){this._phase=e*Math.PI/180,this.type=this._type}asArray(e=1024){return yt(this,void 0,void 0,function*(){return mi(this,e)})}dispose(){return super.dispose(),this._oscillator!==null&&this._oscillator.dispose(),this._wave=void 0,this.frequency.dispose(),this.detune.dispose(),this}};Qt._periodicWaveCache=[];var Bc=class extends cr{constructor(){super(pe(Bc.getDefaults(),arguments,["frequency","type","modulationType"]));this.name="AMOscillator",this._modulationScale=new Ud({context:this.context}),this._modulationNode=new Zt({context:this.context});let e=pe(Bc.getDefaults(),arguments,["frequency","type","modulationType"]);this._carrier=new Qt({context:this.context,detune:e.detune,frequency:e.frequency,onstop:()=>this.onstop(this),phase:e.phase,type:e.type}),this.frequency=this._carrier.frequency,this.detune=this._carrier.detune,this._modulator=new Qt({context:this.context,phase:e.phase,type:e.modulationType}),this.harmonicity=new Fi({context:this.context,units:"positive",value:e.harmonicity}),this.frequency.chain(this.harmonicity,this._modulator.frequency),this._modulator.chain(this._modulationScale,this._modulationNode.gain),this._carrier.chain(this._modulationNode,this.output),_t(this,["frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(Qt.getDefaults(),{harmonicity:1,modulationType:"square"})}_start(e){this._modulator.start(e),this._carrier.start(e)}_stop(e){this._modulator.stop(e),this._carrier.stop(e)}_restart(e){this._modulator.restart(e),this._carrier.restart(e)}get type(){return this._carrier.type}set type(e){this._carrier.type=e}get baseType(){return this._carrier.baseType}set baseType(e){this._carrier.baseType=e}get partialCount(){return this._carrier.partialCount}set partialCount(e){this._carrier.partialCount=e}get modulationType(){return this._modulator.type}set modulationType(e){this._modulator.type=e}get phase(){return this._carrier.phase}set phase(e){this._carrier.phase=e,this._modulator.phase=e}get partials(){return this._carrier.partials}set partials(e){this._carrier.partials=e}asArray(e=1024){return yt(this,void 0,void 0,function*(){return mi(this,e)})}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this._modulationScale.dispose(),this}};var Fc=class extends cr{constructor(){super(pe(Fc.getDefaults(),arguments,["frequency","type","spread"]));this.name="FatOscillator",this._oscillators=[];let e=pe(Fc.getDefaults(),arguments,["frequency","type","spread"]);this.frequency=new Lt({context:this.context,units:"frequency",value:e.frequency}),this.detune=new Lt({context:this.context,units:"cents",value:e.detune}),this._spread=e.spread,this._type=e.type,this._phase=e.phase,this._partials=e.partials,this._partialCount=e.partialCount,this.count=e.count,_t(this,["frequency","detune"])}static getDefaults(){return Object.assign(Qt.getDefaults(),{count:3,spread:20,type:"sawtooth"})}_start(e){e=this.toSeconds(e),this._forEach(t=>t.start(e))}_stop(e){e=this.toSeconds(e),this._forEach(t=>t.stop(e))}_restart(e){this._forEach(t=>t.restart(e))}_forEach(e){for(let t=0;t<this._oscillators.length;t++)e(this._oscillators[t],t)}get type(){return this._type}set type(e){this._type=e,this._forEach(t=>t.type=e)}get spread(){return this._spread}set spread(e){if(this._spread=e,this._oscillators.length>1){let t=-e/2,r=e/(this._oscillators.length-1);this._forEach((o,n)=>o.detune.value=t+r*n)}}get count(){return this._oscillators.length}set count(e){if(Bo(e,1),this._oscillators.length!==e){this._forEach(t=>t.dispose()),this._oscillators=[];for(let t=0;t<e;t++){let r=new Qt({context:this.context,volume:-6-e*1.1,type:this._type,phase:this._phase+t/e*360,partialCount:this._partialCount,onstop:t===0?()=>this.onstop(this):gt});this.type==="custom"&&(r.partials=this._partials),this.frequency.connect(r.frequency),this.detune.connect(r.detune),r.detune.overridden=!1,r.connect(this.output),this._oscillators[t]=r}this.spread=this._spread,this.state==="started"&&this._forEach(t=>t.start())}}get phase(){return this._phase}set phase(e){this._phase=e,this._forEach((t,r)=>t.phase=this._phase+r/this.count*360)}get baseType(){return this._oscillators[0].baseType}set baseType(e){this._forEach(t=>t.baseType=e),this._type=this._oscillators[0].type}get partials(){return this._oscillators[0].partials}set partials(e){this._partials=e,this._partialCount=this._partials.length,e.length&&(this._type="custom",this._forEach(t=>t.partials=e))}get partialCount(){return this._oscillators[0].partialCount}set partialCount(e){this._partialCount=e,this._forEach(t=>t.partialCount=e),this._type=this._oscillators[0].type}asArray(e=1024){return yt(this,void 0,void 0,function*(){return mi(this,e)})}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this._forEach(e=>e.dispose()),this}};var Uc=class extends cr{constructor(){super(pe(Uc.getDefaults(),arguments,["frequency","type","modulationType"]));this.name="FMOscillator",this._modulationNode=new Zt({context:this.context,gain:0});let e=pe(Uc.getDefaults(),arguments,["frequency","type","modulationType"]);this._carrier=new Qt({context:this.context,detune:e.detune,frequency:0,onstop:()=>this.onstop(this),phase:e.phase,type:e.type}),this.detune=this._carrier.detune,this.frequency=new Lt({context:this.context,units:"frequency",value:e.frequency}),this._modulator=new Qt({context:this.context,phase:e.phase,type:e.modulationType}),this.harmonicity=new Fi({context:this.context,units:"positive",value:e.harmonicity}),this.modulationIndex=new Fi({context:this.context,units:"positive",value:e.modulationIndex}),this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.frequency.chain(this.modulationIndex,this._modulationNode),this._modulator.connect(this._modulationNode.gain),this._modulationNode.connect(this._carrier.frequency),this._carrier.connect(this.output),this.detune.connect(this._modulator.detune),_t(this,["modulationIndex","frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(Qt.getDefaults(),{harmonicity:1,modulationIndex:2,modulationType:"square"})}_start(e){this._modulator.start(e),this._carrier.start(e)}_stop(e){this._modulator.stop(e),this._carrier.stop(e)}_restart(e){return this._modulator.restart(e),this._carrier.restart(e),this}get type(){return this._carrier.type}set type(e){this._carrier.type=e}get baseType(){return this._carrier.baseType}set baseType(e){this._carrier.baseType=e}get partialCount(){return this._carrier.partialCount}set partialCount(e){this._carrier.partialCount=e}get modulationType(){return this._modulator.type}set modulationType(e){this._modulator.type=e}get phase(){return this._carrier.phase}set phase(e){this._carrier.phase=e,this._modulator.phase=e}get partials(){return this._carrier.partials}set partials(e){this._carrier.partials=e}asArray(e=1024){return yt(this,void 0,void 0,function*(){return mi(this,e)})}dispose(){return super.dispose(),this.frequency.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this.modulationIndex.dispose(),this}};var d0=class extends cr{constructor(){super(pe(d0.getDefaults(),arguments,["frequency","width"]));this.name="PulseOscillator",this._widthGate=new Zt({context:this.context,gain:0}),this._thresh=new va({context:this.context,mapping:t=>t<=0?-1:1});let e=pe(d0.getDefaults(),arguments,["frequency","width"]);this.width=new Lt({context:this.context,units:"audioRange",value:e.width}),this._triangle=new Qt({context:this.context,detune:e.detune,frequency:e.frequency,onstop:()=>this.onstop(this),phase:e.phase,type:"triangle"}),this.frequency=this._triangle.frequency,this.detune=this._triangle.detune,this._triangle.chain(this._thresh,this.output),this.width.chain(this._widthGate,this._thresh),_t(this,["width","frequency","detune"])}static getDefaults(){return Object.assign(cr.getDefaults(),{detune:0,frequency:440,phase:0,type:"pulse",width:.2})}_start(e){e=this.toSeconds(e),this._triangle.start(e),this._widthGate.gain.setValueAtTime(1,e)}_stop(e){e=this.toSeconds(e),this._triangle.stop(e),this._widthGate.gain.cancelScheduledValues(e),this._widthGate.gain.setValueAtTime(0,e)}_restart(e){this._triangle.restart(e),this._widthGate.gain.cancelScheduledValues(e),this._widthGate.gain.setValueAtTime(1,e)}get phase(){return this._triangle.phase}set phase(e){this._triangle.phase=e}get type(){return"pulse"}get baseType(){return"pulse"}get partials(){return[]}get partialCount(){return 0}set carrierType(e){this._triangle.type=e}asArray(e=1024){return yt(this,void 0,void 0,function*(){return mi(this,e)})}dispose(){return super.dispose(),this._triangle.dispose(),this.width.dispose(),this._widthGate.dispose(),this._thresh.dispose(),this}};var Vc=class extends cr{constructor(){super(pe(Vc.getDefaults(),arguments,["frequency","modulationFrequency"]));this.name="PWMOscillator",this.sourceType="pwm",this._scale=new Fi({context:this.context,value:2});let e=pe(Vc.getDefaults(),arguments,["frequency","modulationFrequency"]);this._pulse=new d0({context:this.context,frequency:e.modulationFrequency}),this._pulse.carrierType="sine",this.modulationFrequency=this._pulse.frequency,this._modulator=new Qt({context:this.context,detune:e.detune,frequency:e.frequency,onstop:()=>this.onstop(this),phase:e.phase}),this.frequency=this._modulator.frequency,this.detune=this._modulator.detune,this._modulator.chain(this._scale,this._pulse.width),this._pulse.connect(this.output),_t(this,["modulationFrequency","frequency","detune"])}static getDefaults(){return Object.assign(cr.getDefaults(),{detune:0,frequency:440,modulationFrequency:.4,phase:0,type:"pwm"})}_start(e){e=this.toSeconds(e),this._modulator.start(e),this._pulse.start(e)}_stop(e){e=this.toSeconds(e),this._modulator.stop(e),this._pulse.stop(e)}_restart(e){this._modulator.restart(e),this._pulse.restart(e)}get type(){return"pwm"}get baseType(){return"pwm"}get partials(){return[]}get partialCount(){return 0}get phase(){return this._modulator.phase}set phase(e){this._modulator.phase=e}asArray(e=1024){return yt(this,void 0,void 0,function*(){return mi(this,e)})}dispose(){return super.dispose(),this._pulse.dispose(),this._scale.dispose(),this._modulator.dispose(),this}};var nD={am:Bc,fat:Fc,fm:Uc,oscillator:Qt,pulse:d0,pwm:Vc},Ls=class extends cr{constructor(){super(pe(Ls.getDefaults(),arguments,["frequency","type"]));this.name="OmniOscillator";let e=pe(Ls.getDefaults(),arguments,["frequency","type"]);this.frequency=new Lt({context:this.context,units:"frequency",value:e.frequency}),this.detune=new Lt({context:this.context,units:"cents",value:e.detune}),_t(this,["frequency","detune"]),this.set(e)}static getDefaults(){return Object.assign(Qt.getDefaults(),Uc.getDefaults(),Bc.getDefaults(),Fc.getDefaults(),d0.getDefaults(),Vc.getDefaults())}_start(e){this._oscillator.start(e)}_stop(e){this._oscillator.stop(e)}_restart(e){return this._oscillator.restart(e),this}get type(){let e="";return["am","fm","fat"].some(t=>this._sourceType===t)&&(e=this._sourceType),e+this._oscillator.type}set type(e){e.substr(0,2)==="fm"?(this._createNewOscillator("fm"),this._oscillator=this._oscillator,this._oscillator.type=e.substr(2)):e.substr(0,2)==="am"?(this._createNewOscillator("am"),this._oscillator=this._oscillator,this._oscillator.type=e.substr(2)):e.substr(0,3)==="fat"?(this._createNewOscillator("fat"),this._oscillator=this._oscillator,this._oscillator.type=e.substr(3)):e==="pwm"?(this._createNewOscillator("pwm"),this._oscillator=this._oscillator):e==="pulse"?this._createNewOscillator("pulse"):(this._createNewOscillator("oscillator"),this._oscillator=this._oscillator,this._oscillator.type=e)}get partials(){return this._oscillator.partials}set partials(e){!this._getOscType(this._oscillator,"pulse")&&!this._getOscType(this._oscillator,"pwm")&&(this._oscillator.partials=e)}get partialCount(){return this._oscillator.partialCount}set partialCount(e){!this._getOscType(this._oscillator,"pulse")&&!this._getOscType(this._oscillator,"pwm")&&(this._oscillator.partialCount=e)}set(e){return Reflect.has(e,"type")&&e.type&&(this.type=e.type),super.set(e),this}_createNewOscillator(e){if(e!==this._sourceType){this._sourceType=e;let t=nD[e],r=this.now();if(this._oscillator){let o=this._oscillator;o.stop(r),this.context.setTimeout(()=>o.dispose(),this.blockTime)}this._oscillator=new t({context:this.context}),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.connect(this.output),this._oscillator.onstop=()=>this.onstop(this),this.state==="started"&&this._oscillator.start(r)}}get phase(){return this._oscillator.phase}set phase(e){this._oscillator.phase=e}get sourceType(){return this._sourceType}set sourceType(e){let t="sine";this._oscillator.type!=="pwm"&&this._oscillator.type!=="pulse"&&(t=this._oscillator.type),e==="fm"?this.type="fm"+t:e==="am"?this.type="am"+t:e==="fat"?this.type="fat"+t:e==="oscillator"?this.type=t:e==="pulse"?this.type="pulse":e==="pwm"&&(this.type="pwm")}_getOscType(e,t){return e instanceof nD[t]}get baseType(){return this._oscillator.baseType}set baseType(e){!this._getOscType(this._oscillator,"pulse")&&!this._getOscType(this._oscillator,"pwm")&&e!=="pulse"&&e!=="pwm"&&(this._oscillator.baseType=e)}get width(){if(this._getOscType(this._oscillator,"pulse"))return this._oscillator.width}get count(){if(this._getOscType(this._oscillator,"fat"))return this._oscillator.count}set count(e){this._getOscType(this._oscillator,"fat")&&ki(e)&&(this._oscillator.count=e)}get spread(){if(this._getOscType(this._oscillator,"fat"))return this._oscillator.spread}set spread(e){this._getOscType(this._oscillator,"fat")&&ki(e)&&(this._oscillator.spread=e)}get modulationType(){if(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))return this._oscillator.modulationType}set modulationType(e){(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))&&bo(e)&&(this._oscillator.modulationType=e)}get modulationIndex(){if(this._getOscType(this._oscillator,"fm"))return this._oscillator.modulationIndex}get harmonicity(){if(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))return this._oscillator.harmonicity}get modulationFrequency(){if(this._getOscType(this._oscillator,"pwm"))return this._oscillator.modulationFrequency}asArray(e=1024){return yt(this,void 0,void 0,function*(){return mi(this,e)})}dispose(){return super.dispose(),this.detune.dispose(),this.frequency.dispose(),this._oscillator.dispose(),this}};var zd=class extends Zo{constructor(){super(pe(zd.getDefaults(),arguments,["attack","decay","sustain","release"]));this.name="AmplitudeEnvelope",this._gainNode=new Zt({context:this.context,gain:0}),this.output=this._gainNode,this.input=this._gainNode,this._sig.connect(this._gainNode.gain),this.output=this._gainNode,this.input=this._gainNode}dispose(){return super.dispose(),this._gainNode.dispose(),this}};var Gc=class extends Un{constructor(){super(pe(Gc.getDefaults(),arguments));this.name="Synth";let e=pe(Gc.getDefaults(),arguments);this.oscillator=new Ls(Object.assign({context:this.context,detune:e.detune,onstop:()=>this.onsilence(this)},e.oscillator)),this.frequency=this.oscillator.frequency,this.detune=this.oscillator.detune,this.envelope=new zd(Object.assign({context:this.context},e.envelope)),this.oscillator.chain(this.envelope,this.output),_t(this,["oscillator","frequency","detune","envelope"])}static getDefaults(){return Object.assign(Un.getDefaults(),{envelope:Object.assign(_a(Zo.getDefaults(),Object.keys(je.getDefaults())),{attack:.005,decay:.1,release:1,sustain:.3}),oscillator:Object.assign(_a(Ls.getDefaults(),[...Object.keys(cr.getDefaults()),"frequency","detune"]),{type:"triangle"})})}_triggerEnvelopeAttack(e,t){if(this.envelope.triggerAttack(e,t),this.oscillator.start(e),this.envelope.sustain===0){let r=this.toSeconds(this.envelope.attack),o=this.toSeconds(this.envelope.decay);this.oscillator.stop(e+r+o)}}_triggerEnvelopeRelease(e){this.envelope.triggerRelease(e),this.oscillator.stop(e+this.toSeconds(this.envelope.release))}getLevelAtTime(e){return e=this.toSeconds(e),this.envelope.getValueAtTime(e)}dispose(){return super.dispose(),this.oscillator.dispose(),this.envelope.dispose(),this}};var yp=class extends Un{constructor(){super(pe(yp.getDefaults(),arguments));this.name="ModulationSynth";let e=pe(yp.getDefaults(),arguments);this._carrier=new Gc({context:this.context,oscillator:e.oscillator,envelope:e.envelope,onsilence:()=>this.onsilence(this),volume:-10}),this._modulator=new Gc({context:this.context,oscillator:e.modulation,envelope:e.modulationEnvelope,volume:-10}),this.oscillator=this._carrier.oscillator,this.envelope=this._carrier.envelope,this.modulation=this._modulator.oscillator,this.modulationEnvelope=this._modulator.envelope,this.frequency=new Lt({context:this.context,units:"frequency"}),this.detune=new Lt({context:this.context,value:e.detune,units:"cents"}),this.harmonicity=new Fi({context:this.context,value:e.harmonicity,minValue:0}),this._modulationNode=new Zt({context:this.context,gain:0}),_t(this,["frequency","harmonicity","oscillator","envelope","modulation","modulationEnvelope","detune"])}static getDefaults(){return Object.assign(Un.getDefaults(),{harmonicity:3,oscillator:Object.assign(_a(Ls.getDefaults(),[...Object.keys(cr.getDefaults()),"frequency","detune"]),{type:"sine"}),envelope:Object.assign(_a(Zo.getDefaults(),Object.keys(je.getDefaults())),{attack:.01,decay:.01,sustain:1,release:.5}),modulation:Object.assign(_a(Ls.getDefaults(),[...Object.keys(cr.getDefaults()),"frequency","detune"]),{type:"square"}),modulationEnvelope:Object.assign(_a(Zo.getDefaults(),Object.keys(je.getDefaults())),{attack:.5,decay:0,sustain:1,release:.5})})}_triggerEnvelopeAttack(e,t){this._carrier._triggerEnvelopeAttack(e,t),this._modulator._triggerEnvelopeAttack(e,t)}_triggerEnvelopeRelease(e){return this._carrier._triggerEnvelopeRelease(e),this._modulator._triggerEnvelopeRelease(e),this}getLevelAtTime(e){return e=this.toSeconds(e),this.envelope.getValueAtTime(e)}dispose(){return super.dispose(),this._carrier.dispose(),this._modulator.dispose(),this.frequency.dispose(),this.detune.dispose(),this.harmonicity.dispose(),this._modulationNode.dispose(),this}};var Hd=class extends yp{constructor(){super(pe(Hd.getDefaults(),arguments));this.name="AMSynth",this._modulationScale=new Ud({context:this.context}),this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.detune.fan(this._carrier.detune,this._modulator.detune),this._modulator.chain(this._modulationScale,this._modulationNode.gain),this._carrier.chain(this._modulationNode,this.output)}dispose(){return super.dispose(),this._modulationScale.dispose(),this}};var bp={attackCurve:"linear",attack:.01,decayCurve:"exponential",decay:.1,releaseCurve:"exponential",release:1,sustain:.5},sD=class extends V{constructor(){super(...arguments);this.attack=v.FLOAT(bp.attack,{range:[0,.1],rangeLocked:[!0,!1]}),this.decay=v.FLOAT(bp.decay,{range:[0,1],rangeLocked:[!0,!1]}),this.sustain=v.FLOAT(bp.sustain,{range:[0,1],rangeLocked:[!0,!1]}),this.release=v.FLOAT(bp.release,{range:[0,1],rangeLocked:[!0,!1]})}},lee=new sD,d7=class extends $r{constructor(){super(...arguments);this.paramsConfig=lee}static type(){return"envelope"}initializeNode(){this.io.inputs.setCount(0)}cook(e){let t=new Di;t.setEnvelopeParams({attackCurve:"linear",attack:this.pv.attack,decayCurve:"exponential",decay:this.pv.decay,releaseCurve:"exponential",release:this.pv.release,sustain:this.pv.sustain}),this.setAudioBuilder(t)}};var aD=class extends V{},uee=new aD,f7=class extends $r{constructor(){super(...arguments);this.paramsConfig=uee}static type(){return"AMSynth"}initializeNode(){this.io.inputs.setCount(0,1)}static displayedInputNames(){return["envelope"]}cook(e){let r=e[0].envelopeParams()||bp,o=new Hd({harmonicity:2.5,oscillator:{type:"fatsawtooth"},envelope:r,modulation:{type:"square"},modulationEnvelope:{attack:.5,decay:.01}}),n=new Di;n.setInstrument(o),this.setAudioBuilder(n)}};var Tp=class extends je{constructor(){super(pe(Tp.getDefaults(),arguments,["channels"]));this.name="Split";let e=pe(Tp.getDefaults(),arguments,["channels"]);this._splitter=this.input=this.output=this.context.createChannelSplitter(e.channels),this._internalChannels=[this._splitter]}static getDefaults(){return Object.assign(je.getDefaults(),{channels:2})}dispose(){return super.dispose(),this._splitter.disconnect(),this}};var xa=class extends je{constructor(){super(pe(xa.getDefaults(),arguments,["type","size"]));this.name="Analyser",this._analysers=[],this._buffers=[];let e=pe(xa.getDefaults(),arguments,["type","size"]);this.input=this.output=this._gain=new Zt({context:this.context}),this._split=new Tp({context:this.context,channels:e.channels}),this.input.connect(this._split),Bo(e.channels,1);for(let t=0;t<e.channels;t++)this._analysers[t]=this.context.createAnalyser(),this._split.connect(this._analysers[t],t,0);this.size=e.size,this.type=e.type}static getDefaults(){return Object.assign(je.getDefaults(),{size:1024,smoothing:.8,type:"fft",channels:1})}getValue(){return this._analysers.forEach((e,t)=>{let r=this._buffers[t];this._type==="fft"?e.getFloatFrequencyData(r):this._type==="waveform"&&e.getFloatTimeDomainData(r)}),this.channels===1?this._buffers[0]:this._buffers}get size(){return this._analysers[0].frequencyBinCount}set size(e){this._analysers.forEach((t,r)=>{t.fftSize=e*2,this._buffers[r]=new Float32Array(e)})}get channels(){return this._analysers.length}get type(){return this._type}set type(e){ze(e==="waveform"||e==="fft",`Analyser: invalid type: ${e}`),this._type=e}get smoothing(){return this._analysers[0].smoothingTimeConstant}set smoothing(e){this._analysers.forEach(t=>t.smoothingTimeConstant=e)}dispose(){return super.dispose(),this._analysers.forEach(e=>e.disconnect()),this._split.dispose(),this._gain.dispose(),this}};var Gn=class extends je{constructor(){super(pe(Gn.getDefaults(),arguments));this.name="MeterBase",this.input=this.output=this._analyser=new xa({context:this.context,size:256,type:"waveform"})}dispose(){return super.dispose(),this._analyser.dispose(),this}};var Ap=class extends Gn{constructor(){super(pe(Ap.getDefaults(),arguments,["size"]));this.name="FFT";let e=pe(Ap.getDefaults(),arguments,["size"]);this.normalRange=e.normalRange,this._analyser.type="fft",this.size=e.size}static getDefaults(){return Object.assign(je.getDefaults(),{normalRange:!1,size:1024,smoothing:.8})}getValue(){return this._analyser.getValue().map(t=>this.normalRange?cp(t):t)}get size(){return this._analyser.size}set size(e){this._analyser.size=e}get smoothing(){return this._analyser.smoothing}set smoothing(e){this._analyser.smoothing=e}getFrequencyOfIndex(e){return ze(0<=e&&e<this.size,`index must be greater than or equal to 0 and less than ${this.size}`),e*this.context.sampleRate/(this.size*2)}};function ya(i){return{cook:!1,callback:i}}var zc=class extends $r{};function cD(i,e,t){let r=t,o=0,n=1,s=i.length,a=t==2?pee:hee;for(let c=0;c<s;){let{octaveIndexTmp:l}=a({values:i,target:e,currentOctaveSize:n,i:c,octaveIndex:o,divisionsMult:r});o=l,c+=n,n*=2}}function pee(i){let{values:e,target:t,currentOctaveSize:r,i:o,octaveIndex:n,divisionsMult:s}=i,a=n,[c,l]=j_(r),u=0,p=[c,l];for(let h of p){let d=0;for(let m=0;m<h;m++){let f=o+m+u;d+=e[f]}u+=h,t[a]=d*s,a++}return{octaveIndexTmp:a}}function j_(i){let e=Math.max(1,Math.floor(i/3)),t=i-e;return[e,t]}function hee(i){let{values:e,target:t,currentOctaveSize:r,i:o,octaveIndex:n,divisionsMult:s}=i,a=n,[c,l]=j_(r),[u,p]=j_(c),[h,d]=j_(l),m=0,f=[u,p,h,d];for(let x of f){let _=0;for(let g=0;g<x;g++){let T=o+g+m;_+=e[T]}m+=x,t[a]=_*s,a++}return{octaveIndexTmp:a}}function lD(i,e){let t=0,r=1,o=i.length;for(let n=0;n<o;){let s=0;for(let a=0;a<r;a++)s+=i[n+a];e[t]=s,n+=r,r*=2,t++}}var dee={normalRange:!1,size:1024,smoothing:.8},uD=i=>{Cp.PARAM_CALLBACK_updateEffect(i)},hD=[1e4,-1e4],dD=class extends V{constructor(){super(...arguments);this.sizeExponent=v.INTEGER(10,{range:[4,14],rangeLocked:[!0,!0]}),this.arraySize=v.INTEGER("2**ch('sizeExponent')",{editable:!1}),this.smoothing=v.FLOAT(dee.smoothing,{range:[0,1],rangeLocked:[!0,!0],...ya(uD)}),this.normalRange=v.BOOLEAN(1,ya(uD)),this.asOctaves=v.BOOLEAN(0,{}),this.octaveDivisions=v.INTEGER(1,{range:[1,2],rangeLocked:[!0,!0],visibleIf:{asOctaves:1},separatorAfter:!0}),this.updateRangeParam=v.BOOLEAN(1,{cook:!1,callback:e=>{Cp.PARAM_CALLBACK_updateUpdateRangeParam(e)}}),this.range=v.VECTOR2([0,0],{visibleIf:{updateRangeParam:1},editable:!1,cook:!1}),this.maxRange=v.VECTOR2(hD,{visibleIf:{updateRangeParam:1},editable:!1,cook:!1}),this.resetMaxRange=v.BUTTON(null,{visibleIf:{updateRangeParam:1},callback:e=>{Cp.PARAM_CALLBACK_resetMaxRange(e)}})}},fee=new dD,Cp=class extends zc{constructor(){super(...arguments);this.paramsConfig=fee}static type(){return cc.FFT}initializeNode(){this.io.inputs.setCount(1)}cook(e){let t=e[0];this._resetEffect();let r=this._effect();this._updateOnTickHook();let o=t.audioNode();o&&o.connect(r),t.setAudioNode(r),this.setAudioBuilder(t)}getAnalyserValue(){if(this.__effect__){let e=this.__effect__.getValue();if(this.pv.asOctaves){let t=this._octaveValues();return this._octaveDivisions()==1?lD(e,t):cD(e,t,this._octaveDivisions()),t}else return e}}_octaveDivisions(){return 2**(this.pv.octaveDivisions-1)}_octaveValues(){let e=this.pv.asOctaves?this.pv.sizeExponent*this._octaveDivisions():this.pv.sizeExponent;return this.__octaveValues&&this.__octaveValues.length!=e&&(this.__octaveValues=void 0),this.__octaveValues=this.__octaveValues||new Float32Array(e)}_effect(){return this.__effect__=this.__effect__||this._createEffect()}_createEffect(){return new Ap({size:this._FFTSize(),normalRange:this.pv.normalRange,smoothing:this.pv.smoothing})}_resetEffect(){this.__effect__&&(this.__effect__.dispose(),this.__effect__=void 0)}static PARAM_CALLBACK_updateEffect(e){e._updateEffect()}_updateEffect(){let e=this._effect();e.normalRange=this.pv.normalRange,e.smoothing=this.pv.smoothing}_FFTSize(){return 2**this.pv.sizeExponent}static PARAM_CALLBACK_updateUpdateRangeParam(e){e._updateRangeParam(),e._updateOnTickHook()}static PARAM_CALLBACK_resetMaxRange(e){e.p.maxRange.set(hD)}_updateRangeParam(){if(!this.__effect__)return;let e=this.getAnalyserValue();if(!e)return;let t=Math.min(...e),r=Math.max(...e);this.p.range.set([t,r]),t<this.pv.maxRange.x&&K.isNumber(t)&&isFinite(t)&&this.p.maxRange.x.set(t),r>this.pv.maxRange.y&&K.isNumber(r)&&isFinite(r)&&this.p.maxRange.y.set(r)}_updateOnTickHook(){this.pv.updateRangeParam?this._registerOnTickHook():this._unRegisterOnTickHook()}async _registerOnTickHook(){this.scene().registeredBeforeTickCallbacks().has(this._tickCallbackName())||this.scene().registerOnBeforeTick(this._tickCallbackName(),this._updateRangeParam.bind(this))}async _unRegisterOnTickHook(){this.scene().unRegisterOnBeforeTick(this._tickCallbackName())}_tickCallbackName(){return`audio/FFT-${this.graphNodeId()}`}};var fD=class extends dr{static context(){return oe.AUDIO}cook(){this.cookController.endCook()}},jd=class extends fD{};var m7=class extends jd{constructor(){super(...arguments);this._childrenControllerContext=oe.COP}static type(){return Ro.COP}createNode(e,t){return super.createNode(e,t)}children(){return super.children()}nodesByType(e){return super.nodesByType(e)}};var _7=class extends jd{constructor(){super(...arguments);this._childrenControllerContext=oe.EVENT}static type(){return Ro.EVENT}createNode(e,t){return super.createNode(e,t)}children(){return super.children()}nodesByType(e){return super.nodesByType(e)}};var ba=class extends Ps{constructor(){super(pe(ba.getDefaults(),arguments,["url","onload"]));this.name="ToneBufferSource",this._source=this.context.createBufferSource(),this._internalChannels=[this._source],this._sourceStarted=!1,this._sourceStopped=!1;let e=pe(ba.getDefaults(),arguments,["url","onload"]);un(this._source,this._gainNode),this._source.onended=()=>this._stopSource(),this.playbackRate=new ft({context:this.context,param:this._source.playbackRate,units:"positive",value:e.playbackRate}),this.loop=e.loop,this.loopStart=e.loopStart,this.loopEnd=e.loopEnd,this._buffer=new Gt(e.url,e.onload,e.onerror),this._internalChannels.push(this._source)}static getDefaults(){return Object.assign(Ps.getDefaults(),{url:new Gt,loop:!1,loopEnd:0,loopStart:0,onload:gt,onerror:gt,playbackRate:1})}get fadeIn(){return this._fadeIn}set fadeIn(e){this._fadeIn=e}get fadeOut(){return this._fadeOut}set fadeOut(e){this._fadeOut=e}get curve(){return this._curve}set curve(e){this._curve=e}start(e,t,r,o=1){ze(this.buffer.loaded,"buffer is either not set or not loaded");let n=this.toSeconds(e);this._startGain(n,o),this.loop?t=l0(t,this.loopStart):t=l0(t,0);let s=Math.max(this.toSeconds(t),0);if(this.loop){let a=this.toSeconds(this.loopEnd)||this.buffer.duration,c=this.toSeconds(this.loopStart),l=a-c;Dd(s,a)&&(s=(s-c)%l+c),Ko(s,this.buffer.duration)&&(s=0)}if(this._source.buffer=this.buffer.get(),this._source.loopEnd=this.toSeconds(this.loopEnd)||this.buffer.duration,F_(s,this.buffer.duration)&&(this._sourceStarted=!0,this._source.start(n,s)),qe(r)){let a=this.toSeconds(r);a=Math.max(a,0),this.stop(n+a)}return this}_stopSource(e){!this._sourceStopped&&this._sourceStarted&&(this._sourceStopped=!0,this._source.stop(this.toSeconds(e)),this._onended())}get loopStart(){return this._source.loopStart}set loopStart(e){this._source.loopStart=this.toSeconds(e)}get loopEnd(){return this._source.loopEnd}set loopEnd(e){this._source.loopEnd=this.toSeconds(e)}get buffer(){return this._buffer}set buffer(e){this._buffer.set(e)}get loop(){return this._source.loop}set loop(e){this._source.loop=e,this._sourceStarted&&this.cancelStop()}dispose(){return super.dispose(),this._source.onended=null,this._source.disconnect(),this._buffer.dispose(),this.playbackRate.dispose(),this}};var Ta=class extends cr{constructor(){super(pe(Ta.getDefaults(),arguments,["url","onload"]));this.name="Player",this._activeSources=new Set;let e=pe(Ta.getDefaults(),arguments,["url","onload"]);this._buffer=new Gt({onload:this._onload.bind(this,e.onload),onerror:e.onerror,reverse:e.reverse,url:e.url}),this.autostart=e.autostart,this._loop=e.loop,this._loopStart=e.loopStart,this._loopEnd=e.loopEnd,this._playbackRate=e.playbackRate,this.fadeIn=e.fadeIn,this.fadeOut=e.fadeOut}static getDefaults(){return Object.assign(cr.getDefaults(),{autostart:!1,fadeIn:0,fadeOut:0,loop:!1,loopEnd:0,loopStart:0,onload:gt,onerror:gt,playbackRate:1,reverse:!1})}load(e){return yt(this,void 0,void 0,function*(){return yield this._buffer.load(e),this._onload(),this})}_onload(e=gt){e(),this.autostart&&this.start()}_onSourceEnd(e){this.onstop(this),this._activeSources.delete(e),this._activeSources.size===0&&!this._synced&&this._state.getValueAtTime(this.now())==="started"&&(this._state.cancel(this.now()),this._state.setStateAtTime("stopped",this.now()))}start(e,t,r){return super.start(e,t,r),this}_start(e,t,r){this._loop?t=l0(t,this._loopStart):t=l0(t,0);let o=this.toSeconds(t),n=r;r=l0(r,Math.max(this._buffer.duration-o,0));let s=this.toSeconds(r);s=s/this._playbackRate,e=this.toSeconds(e);let a=new ba({url:this._buffer,context:this.context,fadeIn:this.fadeIn,fadeOut:this.fadeOut,loop:this._loop,loopEnd:this._loopEnd,loopStart:this._loopStart,onended:this._onSourceEnd.bind(this),playbackRate:this._playbackRate}).connect(this.output);!this._loop&&!this._synced&&(this._state.cancel(e+s),this._state.setStateAtTime("stopped",e+s,{implicitEnd:!0})),this._activeSources.add(a),this._loop&&Jr(n)?a.start(e,o):a.start(e,o,s-this.toSeconds(this.fadeOut))}_stop(e){let t=this.toSeconds(e);this._activeSources.forEach(r=>r.stop(t))}restart(e,t,r){return super.restart(e,t,r),this}_restart(e,t,r){this._stop(e),this._start(e,t,r)}seek(e,t){let r=this.toSeconds(t);if(this._state.getValueAtTime(r)==="started"){let o=this.toSeconds(e);this._stop(r),this._start(r,o)}return this}setLoopPoints(e,t){return this.loopStart=e,this.loopEnd=t,this}get loopStart(){return this._loopStart}set loopStart(e){this._loopStart=e,this.buffer.loaded&&Bo(this.toSeconds(e),0,this.buffer.duration),this._activeSources.forEach(t=>{t.loopStart=e})}get loopEnd(){return this._loopEnd}set loopEnd(e){this._loopEnd=e,this.buffer.loaded&&Bo(this.toSeconds(e),0,this.buffer.duration),this._activeSources.forEach(t=>{t.loopEnd=e})}get buffer(){return this._buffer}set buffer(e){this._buffer.set(e)}get loop(){return this._loop}set loop(e){if(this._loop!==e&&(this._loop=e,this._activeSources.forEach(t=>{t.loop=e}),e)){let t=this._state.getNextState("stopped",this.now());t&&this._state.cancel(t.time)}}get playbackRate(){return this._playbackRate}set playbackRate(e){this._playbackRate=e;let t=this.now(),r=this._state.getNextState("stopped",t);r&&r.implicitEnd&&(this._state.cancel(r.time),this._activeSources.forEach(o=>o.cancelStop())),this._activeSources.forEach(o=>{o.playbackRate.setValueAtTime(e,t)})}get reverse(){return this._buffer.reverse}set reverse(e){this._buffer.reverse=e}get loaded(){return this._buffer.loaded}dispose(){return super.dispose(),this._activeSources.forEach(e=>e.dispose()),this._activeSources.clear(),this._buffer.dispose(),this}};Bi([pn(0)],Ta.prototype,"fadeIn",void 0);Bi([pn(0)],Ta.prototype,"fadeOut",void 0);function mee(){let i=new Bm;return i.setURLModifier(e=>{let t=Q.assetUrls.remapedUrl(e);if(t)return t;let r=Q.blobs.blobUrl(e);return r||e}),i}var Ep=mee(),mD=class{constructor(i,e,t,r={}){this._url=i,this._scene=e,this._node=t,this.blobOptions=r,this.loadingManager=Ep}static extension(i){let e=null;try{e=new URL(i).searchParams.get("ext")}catch{}if(!e){let r=i.split("?")[0].split(".");e=r[r.length-1].toLowerCase()}return e}extension(){return mD.extension(this._url)}async _urlToLoad(){let i=this._url;return this._node&&await Q.blobs.fetchBlobForNode({fullUrl:i,node:this._node,multiAssetsForNode:this.blobOptions.multiAssetsForNode}),Q.blobs.blobUrl(i)||i}static async _loadMultipleBlobGlobal(i){let e=[];for(let r of i.files){let o=r.fullUrl;e.push(Q.blobs.fetchBlobGlobal(o))}let t=await Promise.all(e);if(i.node)for(let r of t)r.error&&i.node.states.error.set(i.error)}},Uo=mD;Uo.loadingManager=Ep;var W_,_D={getContext:function(){return W_===void 0&&(W_=new(window.AudioContext||window.webkitAudioContext)),W_},setContext:function(i){W_=i}};var gD=class extends io{constructor(e){super(e);this.manager=e}load(e,t,r,o){let n=this,s=new Ho(this.manager);s.setResponseType("arraybuffer"),s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,function(a){try{if(!(a instanceof ArrayBuffer)){o(new ErrorEvent("file content is not an ArrayBuffer"));return}let c=a.slice(0);_D.getContext().decodeAudioData(c,function(u){t(u)},function(u){o(new ErrorEvent("failed to decode file"))})}catch{o(new ErrorEvent("failed to decode file")),n.manager.itemError(e)}},r,o)}},Wd=class extends Uo{async load(){let e=new gD(this.loadingManager),t=await this._urlToLoad();return new Promise((r,o)=>{let n=c=>{r(c)},s=c=>{},a=c=>{console.log("error:"),console.log(c),o()};e.load(t,n,s,a)})}};var _ee={cook:!1,callback:i=>{dn.PARAM_CALLBACK_updateLoop(i)}},vD=class extends V{constructor(){super(...arguments);this.url=v.STRING("",{fileBrowse:{type:[pc.AUDIO]}}),this.autostart=v.BOOLEAN(1),this.duration=v.FLOAT(-1,{cook:!1,editable:!1}),this.updateCurrentTimeParam=v.BOOLEAN(0,{cook:!1,callback:e=>{dn.PARAM_CALLBACK_updateUpdateCurrentTimeParam(e)}}),this.currentTime=v.FLOAT(0,{visibleIf:{updateCurrentTimeParam:1},range:[0,100],editable:!1,cook:!1}),this.loop=v.BOOLEAN(1,{..._ee}),this.play=v.BUTTON(null,{callback:e=>{dn.PARAM_CALLBACK_play(e)},hidden:!0}),this.pause=v.BUTTON(null,{callback:e=>{dn.PARAM_CALLBACK_pause(e)},hidden:!0}),this.restart=v.BUTTON(null,{callback:e=>{dn.PARAM_CALLBACK_restart(e)},hidden:!0}),this.seekM10=v.BUTTON(null,{callback:e=>{dn.PARAM_CALLBACK_seekOffset(e,-10)},hidden:!0}),this.seekM5=v.BUTTON(null,{callback:e=>{dn.PARAM_CALLBACK_seekOffset(e,-5)},hidden:!0}),this.seekP5=v.BUTTON(null,{callback:e=>{dn.PARAM_CALLBACK_seekOffset(e,5)},hidden:!0}),this.seekP10=v.BUTTON(null,{callback:e=>{dn.PARAM_CALLBACK_seekOffset(e,10)},hidden:!0})}},gee=new vD,dn=class extends $r{constructor(){super(...arguments);this.paramsConfig=gee,this._stoppedAt=0}static type(){return"file"}initializeNode(){this.io.inputs.setCount(0)}dispose(){super.dispose(),this._player&&(this.pause(),this._player.dispose()),Q.blobs.clearBlobsForNode(this)}async cook(e){if(await this._loadUrl(),this._updateOnTickHook(),this._player){let t=new Di;t.setSource(this._player),this.setAudioBuilder(t)}else this.cookController.endCook()}async _loadUrl(){try{let t=await new Wd(this.pv.url,this.scene(),this).load();return new Promise(r=>{this._player&&this._player.dispose(),this._player=new Ta({url:t,loop:this.pv.loop,volume:0}),this.p.duration.set(t.duration),this.pv.autostart&&this.play(),r(this._player)})}catch{this.states.error.set(`failed to load url '${this.pv.url}'`);return}}async play(){if(!this._player)return;let e=this.pv.updateCurrentTimeParam?this.pv.currentTime:this._currentTime(),t=Math.max(e,0);try{this._runOnBeforePlayCallbacks(t),this._player.start(0,t),this._runOnPlaySuccessCallbacks()}catch(r){console.error(r),this._runOnPlayErrorCallbacks(r)}this._startedAt=this._player.now()-this._stoppedAt,this._stoppedAt=0}async pause(){if(!this._player||this._startedAt==null)return;let e=this._player.now()-this._startedAt;this._player.stop(),this._stoppedAt=e}async restart(){!this._player||(this._player.seek(0),this._stoppedAt=0,this._startedAt=void 0,this.p.currentTime.set(0),this.play())}seekOffset(e){if(!this._player||this._startedAt==null)return;let t=this._currentTime();this._startedAt-=e,this._player.seek(t+e)}static PARAM_CALLBACK_updateUpdateCurrentTimeParam(e){e._updateCurrentTimeParam(),e._updateOnTickHook()}_updateCurrentTimeParam(){if(!this._player)return;let e=this._currentTime();this.p.currentTime.set(e)}_currentTime(){if(this._stoppedAt)return this._stoppedAt;if(this._player&&this._startedAt!=null){let e=this._player.now()-this._startedAt,t=this.pv.duration;return e>t&&(e-=t),e}return 0}static PARAM_CALLBACK_updateLoop(e){e._updateLoop()}_updateLoop(){!this._player||(this._player.loop=this.pv.loop)}_updateOnTickHook(){this.pv.updateCurrentTimeParam?this._registerOnTickHook():this._unRegisterOnTickHook()}async _registerOnTickHook(){this.scene().registeredBeforeTickCallbacks().has(this._tickCallbackName())||this.scene().registerOnBeforeTick(this._tickCallbackName(),this._updateCurrentTimeParam.bind(this))}async _unRegisterOnTickHook(){this.scene().unRegisterOnBeforeTick(this._tickCallbackName())}_tickCallbackName(){return`audio/File-${this.graphNodeId()}`}static PARAM_CALLBACK_seekOffset(e,t){e.seekOffset(t)}static PARAM_CALLBACK_play(e){e.play()}static PARAM_CALLBACK_pause(e){e.pause()}static PARAM_CALLBACK_restart(e){e.restart()}onBeforePlay(e){this._onBeforePlayCallbacks=this._onBeforePlayCallbacks||new Set,this._onBeforePlayCallbacks.add(e)}_runOnBeforePlayCallbacks(e){!this._onBeforePlayCallbacks||this._onBeforePlayCallbacks.forEach(t=>t(e))}onPlaySuccess(e){this._onPlaySuccessCallbacks=this._onPlaySuccessCallbacks||new Set,this._onPlaySuccessCallbacks.add(e)}_runOnPlaySuccessCallbacks(){!this._onPlaySuccessCallbacks||this._onPlaySuccessCallbacks.forEach(e=>e())}onPlayError(e){this._onPlayErrorCallbacks=this._onPlayErrorCallbacks||new Set,this._onPlayErrorCallbacks.add(e)}_runOnPlayErrorCallbacks(e){!this._onPlayErrorCallbacks||this._onPlayErrorCallbacks.forEach(t=>t(e))}};var Sp=class extends Gn{constructor(){super(pe(Sp.getDefaults(),arguments,["smoothing"]));this.name="Meter",this._rms=0;let e=pe(Sp.getDefaults(),arguments,["smoothing"]);this.input=this.output=this._analyser=new xa({context:this.context,size:256,type:"waveform",channels:e.channels}),this.smoothing=e.smoothing,this.normalRange=e.normalRange}static getDefaults(){return Object.assign(Gn.getDefaults(),{smoothing:.8,normalRange:!1,channels:1})}getLevel(){return Id("'getLevel' has been changed to 'getValue'"),this.getValue()}getValue(){let e=this._analyser.getValue(),r=(this.channels===1?[e]:e).map(o=>{let n=o.reduce((a,c)=>a+c*c,0),s=Math.sqrt(n/o.length);return this._rms=Math.max(s,this._rms*this.smoothing),this.normalRange?this._rms:I_(this._rms)});return this.channels===1?r[0]:r}get channels(){return this._analyser.channels}dispose(){return super.dispose(),this._analyser.dispose(),this}};var vee={smoothing:.8},xD=i=>{wp.PARAM_CALLBACK_updateEffect(i)},xee=[1e4,-1e4],yD=class extends V{constructor(){super(...arguments);this.smoothing=v.FLOAT(vee.smoothing,{range:[0,1],rangeLocked:[!0,!0],...ya(xD)}),this.normalRange=v.BOOLEAN(1,ya(xD)),this.updateRangeParam=v.BOOLEAN(1,{cook:!1,callback:e=>{wp.PARAM_CALLBACK_updateUpdateMeterParam(e)}}),this.value=v.FLOAT(0,{visibleIf:{updateRangeParam:1},range:[-100,100],editable:!1,cook:!1}),this.maxRange=v.VECTOR2([1e4,-1e4],{visibleIf:{updateRangeParam:1},editable:!1,cook:!1}),this.resetMaxRange=v.BUTTON(null,{visibleIf:{updateRangeParam:1},callback:e=>{wp.PARAM_CALLBACK_resetMaxRange(e)}})}},yee=new yD,wp=class extends zc{constructor(){super(...arguments);this.paramsConfig=yee,this._arrayValue=new Float32Array(1)}static type(){return cc.METER}initializeNode(){this.io.inputs.setCount(1)}cook(e){let t=e[0];this._resetEffect();let r=this._effect();this._updateOnTickHook();let o=t.audioNode();o&&o.connect(r),t.setAudioNode(r),this.setAudioBuilder(t)}getAnalyserValue(){if(this.__effect__){let e=this.__effect__.getValue();return K.isNumber(e)?(this._arrayValue[0]=e,this._arrayValue):e}}_effect(){return this.__effect__=this.__effect__||this._createEffect()}_createEffect(){return new Sp({smoothing:this.pv.smoothing,normalRange:this.pv.normalRange})}_resetEffect(){this.__effect__&&(this.__effect__.dispose(),this.__effect__=void 0)}static PARAM_CALLBACK_updateEffect(e){e._updateEffect()}_updateEffect(){let e=this._effect();e.normalRange=this.pv.normalRange,e.smoothing=this.pv.smoothing}static PARAM_CALLBACK_updateUpdateMeterParam(e){e._updateMeterParam(),e._updateOnTickHook()}static PARAM_CALLBACK_resetMaxRange(e){e.p.maxRange.set(xee)}_updateMeterParam(){if(!this.__effect__)return;let e=this.getAnalyserValue();if(!e)return;let t=e[0];if(!isFinite(t))return;K.isNumber(t)&&this.p.value.set(t);let r=t;r<this.pv.maxRange.x?this.p.maxRange.x.set(r):r>this.pv.maxRange.y&&this.p.maxRange.y.set(r)}_updateOnTickHook(){this.pv.updateRangeParam?this._registerOnTickHook():this._unRegisterOnTickHook()}async _registerOnTickHook(){this.scene().registeredBeforeTickCallbacks().has(this._tickCallbackName())||this.scene().registerOnBeforeTick(this._tickCallbackName(),this._updateMeterParam.bind(this))}async _unRegisterOnTickHook(){this.scene().unRegisterOnBeforeTick(this._tickCallbackName())}_tickCallbackName(){return`audio/Meter-${this.graphNodeId()}`}};var bD=class extends V{},bee=new bD,g7=class extends $r{constructor(){super(...arguments);this.paramsConfig=bee}static type(){return"null"}initializeNode(){this.io.inputs.setCount(1)}cook(e){let t=e[0];this.setAudioBuilder(t)}};var TD="C1",AD=["Cbb-4","Cb-4","C-4","C#-4","Cx-4","Dbb-4","Db-4","D-4","D#-4","Dx-4","Ebb-4","Eb-4","E-4","E#-4","Ex-4","Fbb-4","Fb-4","F-4","F#-4","Fx-4","Gbb-4","Gb-4","G-4","G#-4","Gx-4","Abb-4","Ab-4","A-4","A#-4","Ax-4","Bbb-4","Bb-4","B-4","B#-4","Bx-4","Cbb-3","Cb-3","C-3","C#-3","Cx-3","Dbb-3","Db-3","D-3","D#-3","Dx-3","Ebb-3","Eb-3","E-3","E#-3","Ex-3","Fbb-3","Fb-3","F-3","F#-3","Fx-3","Gbb-3","Gb-3","G-3","G#-3","Gx-3","Abb-3","Ab-3","A-3","A#-3","Ax-3","Bbb-3","Bb-3","B-3","B#-3","Bx-3","Cbb-2","Cb-2","C-2","C#-2","Cx-2","Dbb-2","Db-2","D-2","D#-2","Dx-2","Ebb-2","Eb-2","E-2","E#-2","Ex-2","Fbb-2","Fb-2","F-2","F#-2","Fx-2","Gbb-2","Gb-2","G-2","G#-2","Gx-2","Abb-2","Ab-2","A-2","A#-2","Ax-2","Bbb-2","Bb-2","B-2","B#-2","Bx-2","Cbb-1","Cb-1","C-1","C#-1","Cx-1","Dbb-1","Db-1","D-1","D#-1","Dx-1","Ebb-1","Eb-1","E-1","E#-1","Ex-1","Fbb-1","Fb-1","F-1","F#-1","Fx-1","Gbb-1","Gb-1","G-1","G#-1","Gx-1","Abb-1","Ab-1","A-1","A#-1","Ax-1","Bbb-1","Bb-1","B-1","B#-1","Bx-1","Cbb0","Cb0","C0","C#0","Cx0","Dbb0","Db0","D0","D#0","Dx0","Ebb0","Eb0","E0","E#0","Ex0","Fbb0","Fb0","F0","F#0","Fx0","Gbb0","Gb0","G0","G#0","Gx0","Abb0","Ab0","A0","A#0","Ax0","Bbb0","Bb0","B0","B#0","Bx0","Cbb1","Cb1","C1","C#1","Cx1","Dbb1","Db1","D1","D#1","Dx1","Ebb1","Eb1","E1","E#1","Ex1","Fbb1","Fb1","F1","F#1","Fx1","Gbb1","Gb1","G1","G#1","Gx1","Abb1","Ab1","A1","A#1","Ax1","Bbb1","Bb1","B1","B#1","Bx1","Cbb2","Cb2","C2","C#2","Cx2","Dbb2","Db2","D2","D#2","Dx2","Ebb2","Eb2","E2","E#2","Ex2","Fbb2","Fb2","F2","F#2","Fx2","Gbb2","Gb2","G2","G#2","Gx2","Abb2","Ab2","A2","A#2","Ax2","Bbb2","Bb2","B2","B#2","Bx2","Cbb3","Cb3","C3","C#3","Cx3","Dbb3","Db3","D3","D#3","Dx3","Ebb3","Eb3","E3","E#3","Ex3","Fbb3","Fb3","F3","F#3","Fx3","Gbb3","Gb3","G3","G#3","Gx3","Abb3","Ab3","A3","A#3","Ax3","Bbb3","Bb3","B3","B#3","Bx3","Cbb4","Cb4","C4","C#4","Cx4","Dbb4","Db4","D4","D#4","Dx4","Ebb4","Eb4","E4","E#4","Ex4","Fbb4","Fb4","F4","F#4","Fx4","Gbb4","Gb4","G4","G#4","Gx4","Abb4","Ab4","A4","A#4","Ax4","Bbb4","Bb4","B4","B#4","Bx4","Cbb5","Cb5","C5","C#5","Cx5","Dbb5","Db5","D5","D#5","Dx5","Ebb5","Eb5","E5","E#5","Ex5","Fbb5","Fb5","F5","F#5","Fx5","Gbb5","Gb5","G5","G#5","Gx5","Abb5","Ab5","A5","A#5","Ax5","Bbb5","Bb5","B5","B#5","Bx5","Cbb6","Cb6","C6","C#6","Cx6","Dbb6","Db6","D6","D#6","Dx6","Ebb6","Eb6","E6","E#6","Ex6","Fbb6","Fb6","F6","F#6","Fx6","Gbb6","Gb6","G6","G#6","Gx6","Abb6","Ab6","A6","A#6","Ax6","Bbb6","Bb6","B6","B#6","Bx6","Cbb7","Cb7","C7","C#7","Cx7","Dbb7","Db7","D7","D#7","Dx7","Ebb7","Eb7","E7","E#7","Ex7","Fbb7","Fb7","F7","F#7","Fx7","Gbb7","Gb7","G7","G#7","Gx7","Abb7","Ab7","A7","A#7","Ax7","Bbb7","Bb7","B7","B#7","Bx7","Cbb8","Cb8","C8","C#8","Cx8","Dbb8","Db8","D8","D#8","Dx8","Ebb8","Eb8","E8","E#8","Ex8","Fbb8","Fb8","F8","F#8","Fx8","Gbb8","Gb8","G8","G#8","Gx8","Abb8","Ab8","A8","A#8","Ax8","Bbb8","Bb8","B8","B#8","Bx8","Cbb9","Cb9","C9","C#9","Cx9","Dbb9","Db9","D9","D#9","Dx9","Ebb9","Eb9","E9","E#9","Ex9","Fbb9","Fb9","F9","F#9","Fx9","Gbb9","Gb9","G9","G#9","Gx9","Abb9","Ab9","A9","A#9","Ax9","Bbb9","Bb9","B9","B#9","Bx9","Cbb10","Cb10","C10","C#10","Cx10","Dbb10","Db10","D10","D#10","Dx10","Ebb10","Eb10","E10","E#10","Ex10","Fbb10","Fb10","F10","F#10","Fx10","Gbb10","Gb10","G10","G#10","Gx10","Abb10","Ab10","A10","A#10","Ax10","Bbb10","Bb10","B10","B#10","Bx10","Cbb11","Cb11","C11","C#11","Cx11","Dbb11","Db11","D11","D#11","Dx11","Ebb11","Eb11","E11","E#11","Ex11","Fbb11","Fb11","F11","F#11","Fx11","Gbb11","Gb11","G11","G#11","Gx11","Abb11","Ab11","A11","A#11","Ax11","Bbb11","Bb11","B11","B#11","Bx11"];var CD=class extends V{constructor(){super(...arguments);this.note=v.STRING(TD,{menuString:{entries:AD.sort().map(e=>({value:e,name:e}))},cook:!1}),this.duration=v.FLOAT(.125,{range:[0,1],rangeLocked:[!0,!1],cook:!1}),this.showNotes=v.BOOLEAN(0,{separatorBefore:!0}),this.showKeys=v.BOOLEAN(0),this.startOctave=v.INTEGER(2,{range:[1,8],rangeLocked:[!1,!1]}),this.endOctave=v.INTEGER(4,{range:[1,8],rangeLocked:[!1,!1]}),this.updateNoteFromInstrument=v.BOOLEAN(0)}},Tee=new CD,v7=class extends $r{constructor(){super(...arguments);this.paramsConfig=Tee}static type(){return"playInstrument"}initializeNode(){this.io.inputs.setCount(1)}cook(e){let t=e[0];this.setAudioBuilder(t)}async play(){let e=await this._getInstrument();if(!e){console.log("no instrument");return}e.triggerAttackRelease(this.pv.note,this.pv.duration)}async _getInstrument(){this.isDirty()&&await this.compute();let e=this.containerController.container().coreContent();if(!!e)return e.instrument()}};var qd=class extends co{constructor(){super();this.name="ToneAudioBuffers",this._buffers=new Map,this._loadingCount=0;let e=pe(qd.getDefaults(),arguments,["urls","onload","baseUrl"],"urls");this.baseUrl=e.baseUrl,Object.keys(e.urls).forEach(t=>{this._loadingCount++;let r=e.urls[t];this.add(t,r,this._bufferLoaded.bind(this,e.onload),e.onerror)})}static getDefaults(){return{baseUrl:"",onerror:gt,onload:gt,urls:{}}}has(e){return this._buffers.has(e.toString())}get(e){return ze(this.has(e),`ToneAudioBuffers has no buffer named: ${e}`),this._buffers.get(e.toString())}_bufferLoaded(e){this._loadingCount--,this._loadingCount===0&&e&&e()}get loaded(){return Array.from(this._buffers).every(([e,t])=>t.loaded)}add(e,t,r=gt,o=gt){return bo(t)?this._buffers.set(e.toString(),new Gt(this.baseUrl+t,r,o)):this._buffers.set(e.toString(),new Gt(t,r,o)),this}dispose(){return super.dispose(),this._buffers.forEach(e=>e.dispose()),this._buffers.clear(),this}};var Aa=class extends Rs{constructor(){super(pe(Aa.getDefaults(),arguments,["urls","onload","baseUrl"],"urls"));this.name="Sampler",this._activeSources=new Map;let e=pe(Aa.getDefaults(),arguments,["urls","onload","baseUrl"],"urls"),t={};Object.keys(e.urls).forEach(r=>{let o=parseInt(r,10);if(ze(Od(r)||ki(o)&&isFinite(o),`url key is neither a note or midi pitch: ${r}`),Od(r)){let n=new Jo(this.context,r).toMidi();t[n]=e.urls[r]}else ki(o)&&isFinite(o)&&(t[o]=e.urls[o])}),this._buffers=new qd({urls:t,onload:e.onload,baseUrl:e.baseUrl,onerror:e.onerror}),this.attack=e.attack,this.release=e.release,this.curve=e.curve,this._buffers.loaded&&Promise.resolve().then(e.onload)}static getDefaults(){return Object.assign(Rs.getDefaults(),{attack:0,baseUrl:"",curve:"exponential",onload:gt,onerror:gt,release:.1,urls:{}})}_findClosest(e){let r=0;for(;r<96;){if(this._buffers.has(e+r))return-r;if(this._buffers.has(e-r))return r;r++}throw new Error(`No available buffers for note: ${e}`)}triggerAttack(e,t,r=1){return this.log("triggerAttack",e,t,r),Array.isArray(e)||(e=[e]),e.forEach(o=>{let n=s7(new Jo(this.context,o).toFrequency()),s=Math.round(n),a=n-s,c=this._findClosest(s),l=s-c,u=this._buffers.get(l),p=D_(c+a),h=new ba({url:u,context:this.context,curve:this.curve,fadeIn:this.attack,fadeOut:this.release,playbackRate:p}).connect(this.output);h.start(t,0,u.duration/p,r),ao(this._activeSources.get(s))||this._activeSources.set(s,[]),this._activeSources.get(s).push(h),h.onended=()=>{if(this._activeSources&&this._activeSources.has(s)){let d=this._activeSources.get(s),m=d.indexOf(h);m!==-1&&d.splice(m,1)}}}),this}triggerRelease(e,t){return this.log("triggerRelease",e,t),Array.isArray(e)||(e=[e]),e.forEach(r=>{let o=new Jo(this.context,r).toMidi();if(this._activeSources.has(o)&&this._activeSources.get(o).length){let n=this._activeSources.get(o);t=this.toSeconds(t),n.forEach(s=>{s.stop(t)}),this._activeSources.set(o,[])}}),this}releaseAll(e){let t=this.toSeconds(e);return this._activeSources.forEach(r=>{for(;r.length;)r.shift().stop(t)}),this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",1)),this}triggerAttackRelease(e,t,r,o=1){let n=this.toSeconds(r);return this.triggerAttack(e,n,o),ao(t)?(ze(ao(e),"notes must be an array when duration is array"),e.forEach((s,a)=>{let c=t[Math.min(a,t.length-1)];this.triggerRelease(s,n+this.toSeconds(c))})):this.triggerRelease(e,n+this.toSeconds(t)),this}add(e,t,r){if(ze(Od(e)||isFinite(e),`note must be a pitch or midi: ${e}`),Od(e)){let o=new Jo(this.context,e).toMidi();this._buffers.add(o,t,r)}else this._buffers.add(e,t,r);return this}get loaded(){return this._buffers.loaded}dispose(){return super.dispose(),this._buffers.dispose(),this._activeSources.forEach(e=>{e.forEach(t=>t.dispose())}),this._activeSources.clear(),this}};Bi([pn(0)],Aa.prototype,"attack",void 0);Bi([pn(0)],Aa.prototype,"release",void 0);var x7=class{static sanitize(e){return e.replace(/([^:])\/\//g,"$1/")}static urlParam(e){let t=window.location.search;return new URLSearchParams(t).get(e)}};var Aee={attack:.01,release:1},Cee={A0:"A0",C1:"C1","D#1":"Ds1","F#1":"Fs1",A1:"A1",C2:"C2","D#2":"Ds2","F#2":"Fs2",A2:"A2",C3:"C3","D#3":"Ds3","F#3":"Fs3",A3:"A3",C4:"C4","D#4":"Ds4","F#4":"Fs4",A4:"A4",C5:"C5","D#5":"Ds5","F#5":"Fs5",A5:"A5",C6:"C6","D#6":"Ds6","F#6":"Fs6",A6:"A6",C7:"C7","D#7":"Ds7","F#7":"Fs7",A7:"A7",C8:"C8"},ED=class extends V{constructor(){super(...arguments);this.urlsMap=v.STRING(JSON.stringify(Cee,null,2),{multiline:!0,language:o5.JSON}),this.baseUrl=v.STRING("./"),this.extension=v.STRING("mp3")}},Eee=new ED,y7=class extends $r{constructor(){super(...arguments);this.paramsConfig=Eee}static type(){return"sampler"}initializeNode(){this.io.inputs.setCount(1)}static displayedInputNames(){return["envelope"]}dispose(){super.dispose(),Q.blobs.clearBlobsForNode(this)}async cook(e){let r=e[0].envelopeParams()||Aee,o={},n=[];try{let c=this.pv.extension;o=JSON.parse(this.pv.urlsMap);let l=Object.keys(o);for(let u of l){let p=o[u],h=`${this.pv.baseUrl}/${p}.${c}`;o[u]=x7.sanitize(h),n.push(h)}}catch{this.states.error.set("urlsMap is invalid JSON")}let s=n.map(c=>new Wd(c,this.scene(),this,{multiAssetsForNode:!0}));await Promise.all(s.map(c=>c.load()));let a=new Aa({urls:o,attack:r.attack,release:r.release,baseUrl:"",onerror:c=>{this.states.error.set(c.message)},onload:()=>{let c=new Di;c.setInstrument(a),this.setAudioBuilder(c)}})}};var Ca=class extends je{constructor(){super(pe(Ca.getDefaults(),arguments,["volume"]));this.name="UserMedia";let e=pe(Ca.getDefaults(),arguments,["volume"]);this._volume=this.output=new fi({context:this.context,volume:e.volume}),this.volume=this._volume.volume,_t(this,"volume"),this.mute=e.mute}static getDefaults(){return Object.assign(je.getDefaults(),{mute:!1,volume:0})}open(e){return yt(this,void 0,void 0,function*(){ze(Ca.supported,"UserMedia is not supported"),this.state==="started"&&this.close();let t=yield Ca.enumerateDevices();ki(e)?this._device=t[e]:(this._device=t.find(n=>n.label===e||n.deviceId===e),!this._device&&t.length>0&&(this._device=t[0]),ze(qe(this._device),`No matching device ${e}`));let r={audio:{echoCancellation:!1,sampleRate:this.context.sampleRate,noiseSuppression:!1,mozNoiseSuppression:!1}};this._device&&(r.audio.deviceId=this._device.deviceId);let o=yield navigator.mediaDevices.getUserMedia(r);if(!this._stream){this._stream=o;let n=this.context.createMediaStreamSource(o);un(n,this.output),this._mediaStream=n}return this})}close(){return this._stream&&this._mediaStream&&(this._stream.getAudioTracks().forEach(e=>{e.stop()}),this._stream=void 0,this._mediaStream.disconnect(),this._mediaStream=void 0),this._device=void 0,this}static enumerateDevices(){return yt(this,void 0,void 0,function*(){return(yield navigator.mediaDevices.enumerateDevices()).filter(t=>t.kind==="audioinput")})}get state(){return this._stream&&this._stream.active?"started":"stopped"}get deviceId(){if(this._device)return this._device.deviceId}get groupId(){if(this._device)return this._device.groupId}get label(){if(this._device)return this._device.label}get mute(){return this._volume.mute}set mute(e){this._volume.mute=e}dispose(){return super.dispose(),this.close(),this._volume.dispose(),this.volume.dispose(),this}static get supported(){return qe(navigator.mediaDevices)&&qe(navigator.mediaDevices.getUserMedia)}};var SD=class extends V{constructor(){super(...arguments);this.autostart=v.BOOLEAN(1),this.open=v.BUTTON(null,{callback:e=>{Xd.PARAM_CALLBACK_open(e)}}),this.close=v.BUTTON(null,{callback:e=>{Xd.PARAM_CALLBACK_close(e)}})}},See=new SD,Xd=class extends $r{constructor(){super(...arguments);this.paramsConfig=See}static type(){return"userMedia"}initializeNode(){this.io.inputs.setCount(0)}async cook(e){let t=new Di,r=this._userMedia();this.pv.autostart&&await r.open(),t.setSource(r),this.setAudioBuilder(t)}_userMedia(){return this.__userMedia__=this.__userMedia__||this._createEffect()}_createEffect(){return new Ca}async open(){return await this._userMedia().open()}close(){this._userMedia().close()}static PARAM_CALLBACK_open(e){e.open()}static PARAM_CALLBACK_close(e){e.close()}};var wee={volume:0},Mee=i=>{q_.PARAM_CALLBACK_updateEffect(i)},wD=class extends V{constructor(){super(...arguments);this.volume=v.FLOAT(wee.volume,{range:[-20,20],rangeLocked:[!1,!1],...ya(Mee)})}},Nee=new wD,q_=class extends $r{constructor(){super(...arguments);this.paramsConfig=Nee}static type(){return"volume"}initializeNode(){this.io.inputs.setCount(1)}cook(e){let t=e[0],r=this._effect(),o=t.audioNode();o&&o.connect(r),t.setAudioNode(r),this.setAudioBuilder(t)}_effect(){return this.__effect__=this.__effect__||this._createEffect()}_createEffect(){return new fi({volume:this.pv.volume})}static PARAM_CALLBACK_updateEffect(e){e._updateEffect()}_updateEffect(){this._effect().volume.linearRampToValueAtTime(this.pv.volume,"+1")}};var Mp=class extends Gn{constructor(){super(pe(Mp.getDefaults(),arguments,["size"]));this.name="Waveform";let e=pe(Mp.getDefaults(),arguments,["size"]);this._analyser.type="waveform",this.size=e.size}static getDefaults(){return Object.assign(Gn.getDefaults(),{size:1024})}getValue(){return this._analyser.getValue()}get size(){return this._analyser.size}set size(e){this._analyser.size=e}};var Oee={size:1024,smoothing:.8},MD=[1e4,-1e4],ND=class extends V{constructor(){super(...arguments);this.sizeExponent=v.INTEGER(10,{range:[4,14],rangeLocked:[!0,!0]}),this.arraySize=v.INTEGER("2**ch('sizeExponent')",{editable:!1}),this.smoothing=v.FLOAT(Oee.smoothing,{range:[0,1],rangeLocked:[!0,!0],cook:!1}),this.normalRange=v.BOOLEAN(1,{cook:!1}),this.updateRangeParam=v.BOOLEAN(1,{cook:!1,callback:e=>{Yd.PARAM_CALLBACK_updateUpdateRangeParam(e)}}),this.range=v.VECTOR2([0,0],{visibleIf:{updateRangeParam:1},editable:!1,cook:!1}),this.maxRange=v.VECTOR2(MD,{visibleIf:{updateRangeParam:1},editable:!1,cook:!1}),this.resetMaxRange=v.BUTTON(null,{visibleIf:{updateRangeParam:1},callback:e=>{Yd.PARAM_CALLBACK_resetMaxRange(e)}})}},Pee=new ND,Yd=class extends zc{constructor(){super(...arguments);this.paramsConfig=Pee}static type(){return cc.WAVEFORM}initializeNode(){this.io.inputs.setCount(1)}cook(e){let t=e[0];this._resetEffect();let r=this._effect();this._updateOnTickHook();let o=t.audioNode();o&&o.connect(r),t.setAudioNode(r),this.setAudioBuilder(t)}getAnalyserValue(){let e=this._getWaveFormValue();if(!e)return;let t=this._previousValue!=null&&e.length==this._previousValue.length?this._blendValue(e,this._previousValue):e;return(!this._previousValue||e.length!=this._previousValue.length)&&(this._previousValue=new Float32Array(e.length)),this._previousValue.set(e),t}_getWaveFormValue(){if(this.__effect__){let e=this.__effect__.getValue();return this.pv.normalRange?e.map(t=>cp(t)):e}}_blendValue(e,t){let r=this.pv.smoothing;if(r==0)return e;if(r==1)return t;let o=e.length;for(let n=0;n<o;n++)e[n]=r*t[n]+(1-r)*e[n];return e}_effect(){return this.__effect__=this.__effect__||this._createEffect()}_createEffect(){return new Mp({size:this._effectSize()})}_resetEffect(){this.__effect__&&(this.__effect__.dispose(),this.__effect__=void 0)}_effectSize(){return 2**this.pv.sizeExponent}static PARAM_CALLBACK_updateUpdateRangeParam(e){e._updateRangeParam(),e._updateOnTickHook()}static PARAM_CALLBACK_resetMaxRange(e){e.p.maxRange.set(MD)}_updateRangeParam(){if(!this.__effect__)return;let e=this.getAnalyserValue();if(!e)return;let t=Math.min(...e),r=Math.max(...e);this.p.range.set([t,r]),t<this.pv.maxRange.x&&K.isNumber(t)&&isFinite(t)&&this.p.maxRange.x.set(t),r>this.pv.maxRange.y&&K.isNumber(r)&&isFinite(r)&&this.p.maxRange.y.set(r)}_updateOnTickHook(){this.pv.updateRangeParam?this._registerOnTickHook():this._unRegisterOnTickHook()}async _registerOnTickHook(){this.scene().registeredBeforeTickCallbacks().has(this._tickCallbackName())||this.scene().registerOnBeforeTick(this._tickCallbackName(),this._updateRangeParam.bind(this))}async _unRegisterOnTickHook(){this.scene().unRegisterOnBeforeTick(this._tickCallbackName())}_tickCallbackName(){return`audio/FFT-${this.graphNodeId()}`}};var X_="input texture",Ree=[X_,X_,X_,X_],b7=32,OD=new Uint16Array(b7);for(Y_=0;Y_<b7;Y_++)OD[Y_]=28898;var Y_,Lee=new Mr(OD,b7,1,Dl,zr),Ea=class extends dr{constructor(){super(...arguments);this.flags=new v4(this)}static context(){return oe.COP}static displayedInputNames(){return Ree}initializeBaseNode(){this.io.outputs.setHasOneOutput()}setTexture(e){e.name=this.path(),this._setContainer(e)}_clearTexture(){this._setContainer(Lee)}},T7=class extends Ea{};var Iee={R:0,G:1,B:2,A:3},PD=["R","G","B","A"],Dee=2,RD=1,$_=.04,LD=class extends V{constructor(){super(...arguments);this.activeR=v.BOOLEAN(0),this.audioNodeR=v.NODE_PATH("",{nodeSelection:{context:oe.AUDIO,types:Ph},visibleIf:{activeR:1}}),this.rangeR=v.VECTOR2([0,1],{visibleIf:{activeR:1}}),this.speedMultR=v.FLOAT($_,{visibleIf:{activeR:1},separatorAfter:!0}),this.activeG=v.BOOLEAN(0),this.audioNodeG=v.NODE_PATH("",{nodeSelection:{context:oe.AUDIO,types:Ph},visibleIf:{activeG:1}}),this.rangeG=v.VECTOR2([0,1],{visibleIf:{activeG:1}}),this.speedMultG=v.FLOAT($_,{visibleIf:{activeG:1},separatorAfter:!0}),this.activeB=v.BOOLEAN(0),this.audioNodeB=v.NODE_PATH("",{nodeSelection:{context:oe.AUDIO,types:Ph},visibleIf:{activeB:1}}),this.rangeB=v.VECTOR2([0,1],{visibleIf:{activeB:1}}),this.speedMultB=v.FLOAT($_,{visibleIf:{activeB:1},separatorAfter:!0}),this.activeA=v.BOOLEAN(0),this.audioNodeA=v.NODE_PATH("",{nodeSelection:{context:oe.AUDIO,types:Ph},visibleIf:{activeA:1}}),this.rangeA=v.VECTOR2([0,1],{visibleIf:{activeA:1}}),this.speedMultA=v.FLOAT($_,{visibleIf:{activeA:1},separatorAfter:!0})}},kee=new LD,A7=class extends Ea{constructor(){super(...arguments);this.paramsConfig=kee,this._audioNodesByChannel={},this._valuesByChannel={}}static type(){return"audioAnalyser"}async cook(){this._initParamsByChannel(),await this._getAudioNodes(),this._registerOnTickHook(),this._updateTexture(1),this.cookController.endCook()}dispose(){super.dispose(),this._unRegisterOnTickHook()}async _getAudioNodes(){let e=[this._getAudioNode("R"),this._getAudioNode("G"),this._getAudioNode("B"),this._getAudioNode("A")];await Promise.all(e)}async _getAudioNode(e){if(!this._paramSetByChannel)return;let t=this._paramSetByChannel[e];if(!t.active.value)return;let o=t.node.value.nodeWithContext(oe.AUDIO);if(!o){this.states.error.set("no audio analyser node found"),this.cookController.endCook();return}let n=o;!n.getAnalyserValue||(await o.compute(),this._audioNodesByChannel[e]=n)}_updateTexture(e){if(!this._paramSetByChannel)return;let t=-1;for(let r of PD){let o=this._valuesForChannel(r,this._paramSetByChannel[r]);if(this._valuesByChannel[r]=o,o){let n=o.length;t<n&&(t=n)}}if(this._dataTexture?this._dataTexture.image.width!=t&&this._createDataTexture(t):this._createDataTexture(t),!!this._dataTexture)for(let r of PD){let o=this._valuesByChannel[r];o&&this._updateTextureChannel(r,this._paramSetByChannel[r],o,this._dataTexture,e)}}_valuesForChannel(e,t){let r=this._audioNodesByChannel[e];if(!!r&&!!t.active.value)return r.getAnalyserValue()}async _updateTextureChannel(e,t,r,o,n){if(!this._dataTexture)return;let s=this._dataTexture.image.width,a=Iee[e],c=t.range.x.value,l=t.range.y.value,u=o.image.data,p=s*4,h=t.speedMult.value;for(let d=0;d<s;d++){let m=(r[d]-c)/(l-c),x=Math.max(0,Math.min(1,m))*RD,_=d*4+a,g=u[_];u[_]=x;let T=h*(x-g)/n;u[p+_]=T}o.needsUpdate=!0}_createDataTexture(e){if(e<=0)return;let t=Dee,r=e,o=r*t*4,n=new Float32Array(o);n.fill(0);for(let a=0;a<o;a++)n[a*4+3]=RD;let s=new Mr(n,r,t,st,Wt);s.minFilter=nt,s.magFilter=nt,this._dataTexture=s,this.setTexture(this._dataTexture)}_initParamsByChannel(){this._paramSetByChannel=this._paramSetByChannel||{R:{active:this.p.activeR,node:this.p.audioNodeR,range:this.p.rangeR,speedMult:this.p.speedMultR},G:{active:this.p.activeG,node:this.p.audioNodeG,range:this.p.rangeG,speedMult:this.p.speedMultG},B:{active:this.p.activeB,node:this.p.audioNodeB,range:this.p.rangeB,speedMult:this.p.speedMultB},A:{active:this.p.activeA,node:this.p.audioNodeA,range:this.p.rangeA,speedMult:this.p.speedMultA}}}async _registerOnTickHook(){this.scene().registeredBeforeTickCallbacks().has(this._tickCallbackName())||this.scene().registerOnBeforeTick(this._tickCallbackName(),this._updateTexture.bind(this))}async _unRegisterOnTickHook(){this.scene().unRegisterOnBeforeTick(this._tickCallbackName())}_tickCallbackName(){return`cop/audioAnalyserNode-${this.graphNodeId()}`}};var C7=class{static overlay(e,t){return new Promise((r,o)=>{let n=document.createElement("canvas");n.width=Math.max(e.width,t.width),n.height=Math.max(e.height,t.height);let s=n.getContext("2d");s.drawImage(e,0,0,e.width,e.height),s.drawImage(t,0,0,t.width,t.height);let a=n.toDataURL("image/png"),c=new Image;c.onload=()=>{r(c)},c.src=a})}static create_white_image(e,t){return new Promise((r,o)=>{let n=document.createElement("canvas");n.width=e,n.height=t;let s=n.getContext("2d");s.beginPath(),s.rect(0,0,e,t),s.fillStyle="white",s.fill();let a=n.toDataURL("image/png"),c=new Image;c.onload=()=>{r(c)},c.src=a})}static make_square(e){return new Promise((t,r)=>{let o=document.createElement("canvas"),n=Math.min(e.width,e.height),s=e.width/e.height;o.width=n,o.height=n;let a=o.getContext("2d"),c=s>1,l=c?(e.width-n)/2:(e.height-n)/2;c?a.drawImage(e,l,0,n,n,0,0,n,n):a.drawImage(e,0,l,n,n,0,0,n,n);let u=o.toDataURL("image/png"),p=new Image;p.onload=()=>{t(p)},p.src=u})}static async image_to_blob(e){return new Promise(function(t,r){try{let o=new XMLHttpRequest;o.open("GET",e.src),o.responseType="blob",o.onerror=function(){r("Network error.")},o.onload=function(){o.status===200?t(o.response):r("Loading error:"+o.statusText)},o.send()}catch(o){r(o.message)}})}static data_from_url(e){return new Promise((t,r)=>{let o=new Image;o.crossOrigin="Anonymous",o.onload=()=>{let n=this.data_from_image(o);t(n)},o.src=e})}static data_from_image(e){let t=document.createElement("canvas");t.width=e.width,t.height=e.height;let r=t.getContext("2d");return r.drawImage(e,0,0,e.width,e.height),r.getImageData(0,0,e.width,e.height)}};var E7=(i=>(i.Uint8Array="Uint8Array",i.Uint8ClampedArray="Uint8ClampedArray",i.Float32Array="Float32Array",i))(E7||{}),S7=class{constructor(e){this.buffer_type=e}from_render_target(e,t){return(!this._data_texture||!this._same_dimensions(t.texture))&&(this._data_texture=this._create_data_texture(t.texture)),this._copy_to_data_texture(e,t),this._data_texture}from_texture(e){let t=C7.data_from_image(e.image);(!this._data_texture||!this._same_dimensions(e))&&(this._data_texture=this._create_data_texture(e));let r=t.width*t.height,o=t.data,n=this._data_texture.image.data,a=r*4;for(let c=0;c<a;c++)n[c]=o[c];return this._data_texture}get data_texture(){return this._data_texture}reset(){this._data_texture=void 0}_copy_to_data_texture(e,t){let r=t.texture.image;this._data_texture=this._data_texture||this._create_data_texture(t.texture),e.readRenderTargetPixels(t,0,0,r.width,r.height,this._data_texture.image.data),this._data_texture.needsUpdate=!0}_create_data_texture(e){let t=e.image,r=this._create_pixel_buffer(t.width,t.height);return new Mr(r,t.width,t.height,e.format,e.type,e.mapping,e.wrapS,e.wrapT,e.magFilter,e.minFilter,e.anisotropy,e.encoding)}_create_pixel_buffer(e,t){let r=e*t*4;switch(this.buffer_type){case"Uint8Array":return new Uint8Array(r);case"Uint8ClampedArray":return new Uint8ClampedArray(r);case"Float32Array":return new Float32Array(r)}Be.unreachable(this.buffer_type)}_same_dimensions(e){if(this._data_texture){let t=this._data_texture.image.width==e.image.width,r=this._data_texture.image.height==e.image.height;return t&&r}else return!0}};var ID=class extends V{},Krt=new ID;var $d=class{constructor(e){this.node=e}async renderer(){return await this.cameraRenderer()}reset(){var e;(e=this._renderer)==null||e.dispose(),this._renderer=void 0}async cameraRenderer(){let e=await Q.renderersController.waitForRenderer();return e||await Q.renderersController.waitForRenderer()}saveState(){this._makeLinear()}_makeLinear(){}restoreState(){}};var DD=["reflection","refraction"],kD=class extends V{constructor(){super(...arguments);this.useCameraRenderer=v.BOOLEAN(1),this.mode=v.INTEGER(0,{menu:{entries:DD.map((e,t)=>({name:e,value:t}))}})}},Bee=new kD,w7=class extends Ea{constructor(){super(...arguments);this.paramsConfig=Bee}static type(){return"envMap"}initializeNode(){this.io.inputs.setCount(1),this.io.inputs.initInputsClonedState(Ge.NEVER)}async cook(e){let t=e[0];this.convert_texture_to_env_map(t)}async convert_texture_to_env_map(e){this._renderer_controller=this._renderer_controller||new $d(this);let t=await this._renderer_controller.renderer();if(t){let o=new Yl(t).fromEquirectangular(e);if(this.pv.useCameraRenderer)this._set_mapping(o.texture),this.setTexture(o.texture);else{this._data_texture_controller=this._data_texture_controller||new S7(E7.Uint8Array);let n=this._data_texture_controller.from_render_target(t,o);this._set_mapping(n),this.setTexture(n)}}else this.states.error.set("no renderer found to convert the texture to an env map"),this.cookController.endCook()}_set_mapping(e){DD[this.pv.mode]=="reflection"?e.mapping=ii:e.mapping=An}};var K_=class extends gr{constructor(e,t,r,o,n,s,a,c,l){super(e,t,r,o,n,s,a,c,l);this.minFilter=s!==void 0?s:at,this.magFilter=n!==void 0?n:at,this.generateMipmaps=!1;let u=this;function p(){u.needsUpdate=!0,e.requestVideoFrameCallback(p)}"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(p)}clone(){return new this.constructor(this.image).copy(this)}update(){let e=this.image;"requestVideoFrameCallback"in e===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}};K_.prototype.isVideoTexture=!0;var Np=class extends io{constructor(e){super(e)}load(e,t,r,o){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);let n=this,s=Gl.get(e);if(s!==void 0)return n.manager.itemStart(e),setTimeout(function(){t&&t(s),n.manager.itemEnd(e)},0),s;let a=Vl("img");function c(){u(),Gl.add(e,this),t&&t(this),n.manager.itemEnd(e)}function l(p){u(),o&&o(p),n.manager.itemError(e),n.manager.itemEnd(e)}function u(){a.removeEventListener("load",c,!1),a.removeEventListener("error",l,!1)}return a.addEventListener("load",c,!1),a.addEventListener("error",l,!1),e.substr(0,5)!=="data:"&&this.crossOrigin!==void 0&&(a.crossOrigin=this.crossOrigin),n.manager.itemStart(e),a.src=e,a}};var Kd=class extends io{constructor(e){super(e)}load(e,t,r,o){let n=new gr,s=new Np(this.manager);return s.setCrossOrigin(this.crossOrigin),s.setPath(this.path),s.load(e,function(a){n.image=a,n.needsUpdate=!0,t!==void 0&&t(n)},r,o),n}};var pt=(i=>(i.DRACOLoader="DRACOLoader",i.EXRLoader="EXRLoader",i.FBXLoader="FBXLoader",i.GLTFLoader="GLTFLoader",i.KTX2Loader="KTX2Loader",i.LDrawLoader="LDrawLoader",i.OBJLoader="OBJLoader",i.PDBLoader="PDBLoader",i.PLYLoader="PLYLoader",i.RGBELoader="RGBELoader",i.SVGLoader="SVGLoader",i.STLLoader="STLLoader",i.TTFLoader="TTFLoader",i))(pt||{});var Jd="https://raw.githubusercontent.com/polygonjs/polygonjs-assets/master/";var BD=["mp4","ogv","ogg"],Sa=(i=>(i.JPG="jpg",i.JPEG="jpeg",i.PNG="png",i.EXR="exr",i.KTX2="ktx2",i.HDR="hdr",i))(Sa||{}),M7=["jpeg","jpg","png","exr","ktx2","hdr"];function Fee(i){let t=i.split("?")[0].split(".");return t[t.length-1]}function FD(i){return M7.includes(Fee(i).toLowerCase())}var Qr=class extends Uo{constructor(i,e,t,r,o){super(i,r,t);this._param=e,this._node=t,this._scene=r,this._forceVideo=!1,this._forceImage=!1,this._forceVideo=(o==null?void 0:o.forceVideo)||this._forceVideo,this._forceImage=(o==null?void 0:o.forceImage)||this._forceImage}static onTextureLoaded(i){this._onTextureLoadedCallback=i}async load_texture_from_url_or_op(i){this._node&&Q.blobs.clearBlobsForNode(this._node);let e=null,t=null;if(this._url.substring(0,3)=="op:"){let r=this._url.substring(3);t=ct.findNode(this._node,r),t?t instanceof T7?e=(await t.compute()).texture():this._node.states.error.set("found node is not a texture node"):this._node.states.error.set(`no node found in path '${r}'`)}else e=await this._loadUrl(i),e||this._node.states.error.set(`could not load texture ${this._url}`);return t&&this._param.graphPredecessors()[0]!=t&&(this._param.graphDisconnectPredecessors(),this._param.addGraphInput(t)),e}async _loadUrl(i){return new Promise(async(e,t)=>{let r=this.extension(),o=await this._urlToLoad();if(this._forceVideo||BD.includes(r)){let n=await this._loadVideo(o);e(n)}else if(this._forceImage||M7.includes(r))try{let n=await this._loadImage(o,i);e(n)}catch{t()}})}_loadImage(i,e){return new Promise(async(t,r)=>{let o=this.extension();this.loader_for_ext(o,e).then(async n=>{n?(Qr.incrementInProgressLoadsCount(),await Qr.waitForMaxConcurrentLoadsQueueFreed(),n.load(i,s=>{Qr.decrementInProgressLoadsCount();let a=Qr._onTextureLoadedCallback;a&&a(i,s),t(s)},void 0,s=>{Qr.decrementInProgressLoadsCount(),Q.warn("error",s),r()})):r()})})}_loadVideo(i){return new Promise(async(e,t)=>{Qr.incrementInProgressLoadsCount(),await Qr.waitForMaxConcurrentLoadsQueueFreed();let r=document.createElement("video");r.setAttribute("crossOrigin","anonymous"),r.setAttribute("autoplay",`${!0}`),r.setAttribute("loop",`${!0}`),r.onloadedmetadata=function(){r.pause();let u=new K_(r);Qr.decrementInProgressLoadsCount();let p=Qr._onTextureLoadedCallback;p&&p(i,u),e(u)};let o=document.createElement("source"),n=Uo.extension(i),s=Qr.VIDEO_SOURCE_TYPE_BY_EXT[n];s=s||Qr._default_video_source_type(i),o.setAttribute("type",s),o.setAttribute("src",i),r.appendChild(o);let a;n=="mp4"?a=Qr.replaceExtension(i,"ogv"):a=Qr.replaceExtension(i,"mp4");let c=document.createElement("source"),l=Uo.extension(a);s=Qr.VIDEO_SOURCE_TYPE_BY_EXT[l],s=s||Qr._default_video_source_type(i),c.setAttribute("type",s),c.setAttribute("src",i),r.appendChild(c)})}static module_names(i){switch(i){case Sa.EXR:return[pt.EXRLoader];case Sa.HDR:return[pt.RGBELoader];case Sa.KTX2:return[pt.KTX2Loader]}}async loader_for_ext(i,e){switch(i.toLowerCase()){case Sa.EXR:return await this._exr_loader(e);case Sa.HDR:return await this._hdr_loader(e);case Sa.KTX2:return await Qr._KTX2loader(this._node)}return new Kd(this.loadingManager)}async _exr_loader(i){let e=await Q.modulesRegister.module(pt.EXRLoader);if(e){let t=new e(this.loadingManager);return i.tdataType&&t.setDataType(i.dataType),t}}async _hdr_loader(i){let e=await Q.modulesRegister.module(pt.RGBELoader);if(e){let t=new e(this.loadingManager);return i.tdataType&&t.setDataType(i.dataType),t}}static async _KTX2loader(i){let e=await Q.modulesRegister.module(pt.KTX2Loader);if(e){let t=new e(this.loadingManager),r=Q.libs.root(),o=Q.libs.KTX2Path();if(r||o){let s=`${r||""}${o||""}/`;if(i){let a=["basis_transcoder.js","basis_transcoder.wasm"];await this._loadMultipleBlobGlobal({files:a.map(c=>({fullUrl:`${s}${c}`})),node:i,error:"failed to load basis libraries. Make sure to install them to load .basis files"})}t.setTranscoderPath(s)}else t.setTranscoderPath(void 0);let n=await Q.renderersController.waitForRenderer();return n?t.detectSupport(n):Q.warn("texture loader found no renderer for KTX2Loader"),t}}static _default_video_source_type(i){return`video/${Uo.extension(i)}`}static pixel_data(i){let e=i.image,t=document.createElement("canvas");t.width=e.width,t.height=e.height;let r=t.getContext("2d");if(r)return r.drawImage(e,0,0,e.width,e.height),r.getImageData(0,0,e.width,e.height)}static replaceExtension(i,e){let t=i.split("?"),o=t[0].split(".");return o.pop(),o.push(e),[o.join("."),t[1]].join("?")}static setMaxConcurrentLoadsCount(i){this._maxConcurrentLoadsCountMethod=i}static _init_max_concurrent_loads_count(){return this._maxConcurrentLoadsCountMethod?this._maxConcurrentLoadsCountMethod():Pi.isChrome()?10:4}static _init_concurrent_loads_delay(){return Pi.isChrome()?0:10}static incrementInProgressLoadsCount(){this.in_progress_loads_count++}static decrementInProgressLoadsCount(){this.in_progress_loads_count--;let i=this._queue.pop();if(i){let e=this.CONCURRENT_LOADS_DELAY;setTimeout(()=>{i()},e)}}static async waitForMaxConcurrentLoadsQueueFreed(){if(!(this.in_progress_loads_count<=this.MAX_CONCURRENT_LOADS_COUNT))return new Promise(i=>{this._queue.push(i)})}},zn=Qr;zn.PARAM_DEFAULT=`${Jd}/textures/uv.jpg`;zn.PARAM_ENV_DEFAULT=`${Jd}/textures/piz_compressed.exr`;zn.VIDEO_SOURCE_TYPE_BY_EXT={ogg:'video/ogg; codecs="theora, vorbis"',ogv:'video/ogg; codecs="theora, vorbis"',mp4:'video/mp4; codecs="avc1.42E01E, mp4a.40.2"'};zn.MAX_CONCURRENT_LOADS_COUNT=Qr._init_max_concurrent_loads_count();zn.CONCURRENT_LOADS_DELAY=Qr._init_concurrent_loads_delay();zn.in_progress_loads_count=0;zn._queue=[];var J_=[{LinearFilter:at},{NearestFilter:nt}],Z_=[{NearestFilter:nt},{NearestMipMapNearestFilter:kx},{NearestMipMapLinearFilter:Bx},{LinearFilter:at},{LinearMipMapNearestFilter:Fx},{LinearMipMapLinearFilter:Ux}],UD=Object.values(J_[0])[0],VD=Object.values(Z_[5])[0],GD=J_.map(i=>({name:Object.keys(i)[0],value:Object.values(i)[0]})),zD=Z_.map(i=>({name:Object.keys(i)[0],value:Object.values(i)[0]}));var Q_=[{LinearEncoding:Hr},{sRGBEncoding:bt},{BasicDepthPacking:Lm},{RGBADepthPacking:Im}],Uee={};for(let i of Q_){let e=Object.keys(i)[0],t=Object.values(i)[0];Uee[`${t}`]=e}var e9=[{ClampToEdgeWrapping:kt},{RepeatWrapping:Hi},{MirroredRepeatWrapping:P0}];var N7=[{UVMapping:Tn},{CubeReflectionMapping:oi},{CubeRefractionMapping:vi},{EquirectangularReflectionMapping:zs},{EquirectangularRefractionMapping:Hs},{CubeUVReflectionMapping:ii},{CubeUVRefractionMapping:An}];var HD=[{UnsignedByteType:Go},{ByteType:_m},{ShortType:gm},{UnsignedShortType:En},{IntType:vm},{UnsignedIntType:R0},{FloatType:Wt},{HalfFloatType:zr},{UnsignedShort4444Type:xm},{UnsignedShort5551Type:ym},{UnsignedInt248Type:ji}];var jD=[{AlphaFormat:bm},{RedFormat:Am},{RedIntegerFormat:Cm},{RGFormat:Em},{RGIntegerFormat:Sm},{RGBAFormat:st},{RGBAIntegerFormat:wm},{LuminanceFormat:Dl},{LuminanceAlphaFormat:Tm},{DepthFormat:xi},{DepthStencilFormat:Wi}];function mn(i){return{cook:!1,callback:e=>{Qd[i](e)}}}var fn={ENCODING:Hr,FORMAT:st,MAPPING:Tn,MIN_FILTER:at,MAG_FILTER:at,TYPE:Go,WRAPPING:Hi},WD=mn("PARAM_CALLBACK_update_encoding"),qD=mn("PARAM_CALLBACK_update_mapping"),O7=mn("PARAM_CALLBACK_update_wrap"),t9=mn("PARAM_CALLBACK_update_filter"),P7=mn("PARAM_CALLBACK_update_anisotropy"),XD=mn("PARAM_CALLBACK_update_flipY"),Vee=mn("PARAM_CALLBACK_update_transform"),Gee=mn("PARAM_CALLBACK_update_repeat"),zee=mn("PARAM_CALLBACK_update_offset"),Hee=mn("PARAM_CALLBACK_update_rotation"),jee=mn("PARAM_CALLBACK_update_center"),Zd=mn("PARAM_CALLBACK_update_advanced");function R7(i,e){return class extends i{constructor(){super(...arguments);this.tencoding=v.BOOLEAN((e==null?void 0:e.tencoding)||0,{...WD}),this.encoding=v.INTEGER((e==null?void 0:e.encoding)||fn.ENCODING,{visibleIf:{tencoding:1},menu:{entries:Q_.map(r=>({name:Object.keys(r)[0],value:Object.values(r)[0]}))},...WD}),this.tmapping=v.BOOLEAN(0,{...qD}),this.mapping=v.INTEGER(fn.MAPPING,{visibleIf:{tmapping:1},menu:{entries:N7.map(r=>({name:Object.keys(r)[0],value:Object.values(r)[0]}))},...qD}),this.twrap=v.BOOLEAN(0,{...O7}),this.wrapS=v.INTEGER(fn.WRAPPING,{visibleIf:{twrap:1},menu:{entries:e9.map(r=>({name:Object.keys(r)[0],value:Object.values(r)[0]}))},...O7}),this.wrapT=v.INTEGER(fn.WRAPPING,{visibleIf:{twrap:1},menu:{entries:e9.map(r=>({name:Object.keys(r)[0],value:Object.values(r)[0]}))},separatorAfter:!0,...O7}),this.tminFilter=v.BOOLEAN(0,{...t9}),this.minFilter=v.INTEGER(VD,{visibleIf:{tminFilter:1},menu:{entries:zD},...t9}),this.tmagFilter=v.BOOLEAN(0,{...t9}),this.magFilter=v.INTEGER(UD,{visibleIf:{tmagFilter:1},menu:{entries:GD},...t9}),this.tanisotropy=v.BOOLEAN(0,{...P7}),this.useRendererMaxAnisotropy=v.BOOLEAN(0,{visibleIf:{tanisotropy:1},...P7}),this.anisotropy=v.INTEGER(2,{visibleIf:{tanisotropy:1,useRendererMaxAnisotropy:0},range:[0,32],rangeLocked:[!0,!1],...P7}),this.tflipY=v.BOOLEAN(0,{...XD}),this.flipY=v.BOOLEAN(0,{visibleIf:{tflipY:1},...XD}),this.ttransform=v.BOOLEAN(0,{...Vee}),this.offset=v.VECTOR2([0,0],{visibleIf:{ttransform:1},...zee}),this.repeat=v.VECTOR2([1,1],{visibleIf:{ttransform:1},...Gee}),this.rotation=v.FLOAT(0,{range:[-1,1],visibleIf:{ttransform:1},...Hee}),this.center=v.VECTOR2([0,0],{visibleIf:{ttransform:1},...jee}),this.tadvanced=v.BOOLEAN(0,{...Zd}),this.tformat=v.BOOLEAN(0,{visibleIf:{tadvanced:1},...Zd}),this.format=v.INTEGER(fn.FORMAT,{visibleIf:{tadvanced:1,tformat:1},menu:{entries:jD.map(r=>({name:Object.keys(r)[0],value:Object.values(r)[0]}))},...Zd}),this.ttype=v.BOOLEAN(0,{visibleIf:{tadvanced:1},...Zd}),this.type=v.INTEGER(fn.TYPE,{visibleIf:{tadvanced:1,ttype:1},menu:{entries:HD.map(r=>({name:Object.keys(r)[0],value:Object.values(r)[0]}))},...Zd})}}}var YD=class extends R7(V){},Qot=new YD;var Qd=class{constructor(e){this.node=e}async update(e){let t=this.node.pv;this._updateEncoding(e,t),this._updateAdvanced(e,t),this._updateMapping(e,t),this._updateWrap(e,t),this._updateFilter(e,t),this._updateFlip(e,t),await this._updateAnisotropy(e,t),this._updateTransform(e)}_updateEncoding(e,t){t.tencoding?e.encoding=t.encoding:e.encoding=fn.ENCODING,e.needsUpdate=!0}_updateAdvanced(e,t){t.tadvanced&&(t.tformat?e.format=t.format:e.format=fn.FORMAT,t.ttype?e.type=t.type:e.type=fn.TYPE),e.needsUpdate=!0}_updateMapping(e,t){t.tmapping?e.mapping=t.mapping:e.mapping=fn.MAPPING,e.needsUpdate=!0}_updateWrap(e,t){t.twrap?(e.wrapS=t.wrapS,e.wrapT=t.wrapT):(e.wrapS=fn.WRAPPING,e.wrapT=fn.WRAPPING),e.needsUpdate=!0}_updateFilter(e,t){t.tminFilter?e.minFilter=t.minFilter:e.minFilter=at,t.tmagFilter?e.magFilter=t.magFilter:e.magFilter=at,e.needsUpdate=!0}_updateFlip(e,t){e.flipY=t.tflipY&&t.flipY,e.needsUpdate=!0}async _updateAnisotropy(e,t){if(!t.tanisotropy){e.anisotropy=1;return}if(t.useRendererMaxAnisotropy)e.anisotropy=await this._maxRendererAnisotropy();else{let r=t.anisotropy;r<=2?e.anisotropy=r:e.anisotropy=Math.min(r,await this._maxRendererAnisotropy())}e.needsUpdate=!0}async _maxRendererAnisotropy(){return this._renderer_controller=this._renderer_controller||new $d(this.node),(await this._renderer_controller.renderer()).capabilities.getMaxAnisotropy()}_updateTransform(e){if(!this.node.pv.ttransform){e.offset.set(0,0),e.rotation=0,e.repeat.set(1,1),e.center.set(0,0);return}this._updateTransformOffset(e,!1),this._updateTransformRepeat(e,!1),this._updateTransformRotation(e,!1),this._updateTransformCenter(e,!1),e.updateMatrix()}async _updateTransformOffset(e,t){e.offset.copy(this.node.pv.offset),t&&e.updateMatrix()}async _updateTransformRepeat(e,t){e.repeat.copy(this.node.pv.repeat),t&&e.updateMatrix()}async _updateTransformRotation(e,t){e.rotation=this.node.pv.rotation,t&&e.updateMatrix()}async _updateTransformCenter(e,t){e.center.copy(this.node.pv.center),t&&e.updateMatrix()}static PARAM_CALLBACK_update_encoding(e){let t=e.containerController.container().texture();!t||e.textureParamsController._updateEncoding(t,e.pv)}static PARAM_CALLBACK_update_mapping(e){let t=e.containerController.container().texture();!t||e.textureParamsController._updateMapping(t,e.pv)}static PARAM_CALLBACK_update_wrap(e){let t=e.containerController.container().texture();!t||e.textureParamsController._updateWrap(t,e.pv)}static PARAM_CALLBACK_update_filter(e){let t=e.containerController.container().texture();!t||e.textureParamsController._updateFilter(t,e.pv)}static PARAM_CALLBACK_update_anisotropy(e){let t=e.containerController.container().texture();!t||e.textureParamsController._updateAnisotropy(t,e.pv)}static PARAM_CALLBACK_update_flipY(e){let t=e.containerController.container().texture();!t||e.textureParamsController._updateFlip(t,e.pv)}static PARAM_CALLBACK_update_transform(e){let t=e.containerController.container().texture();!t||e.textureParamsController._updateTransform(t)}static PARAM_CALLBACK_update_offset(e){let t=e.containerController.container().texture();!t||e.textureParamsController._updateTransformOffset(t,!0)}static PARAM_CALLBACK_update_repeat(e){let t=e.containerController.container().texture();!t||e.textureParamsController._updateTransformRepeat(t,!0)}static PARAM_CALLBACK_update_rotation(e){let t=e.containerController.container().texture();!t||e.textureParamsController._updateTransformRotation(t,!0)}static PARAM_CALLBACK_update_center(e){let t=e.containerController.container().texture();!t||e.textureParamsController._updateTransformCenter(t,!0)}static PARAM_CALLBACK_update_advanced(e){let t=e.containerController.container().texture();!t||e.textureParamsController._updateAdvanced(t,e.pv)}static copyTextureAttributes(e,t){e.encoding=t.encoding,e.mapping=t.mapping,e.wrapS=t.wrapS,e.wrapT=t.wrapT,e.minFilter=t.minFilter,e.magFilter=t.magFilter,e.magFilter=t.magFilter,e.anisotropy=t.anisotropy,e.flipY=t.flipY,e.repeat.copy(t.repeat),e.offset.copy(t.offset),e.center.copy(t.center),e.rotation=t.rotation,e.type=t.type,e.format=t.format,e.needsUpdate=!0}paramLabelsParams(){let e=this.node.p;return[e.tencoding,e.encoding,e.tmapping,e.mapping,e.twrap,e.wrapS,e.wrapT,e.tminFilter,e.minFilter,e.tmagFilter,e.magFilter,e.tflipY,e.flipY]}paramLabels(){let e=[],t=this.node.pv;if(t.tencoding)for(let r of Q_){let o=Object.keys(r)[0];r[o]==t.encoding&&e.push(`encoding: ${o}`)}if(t.tmapping)for(let r of N7){let o=Object.keys(r)[0];r[o]==t.mapping&&e.push(`mapping: ${o}`)}if(t.twrap){let r=function(o){for(let n of e9){let s=Object.keys(n)[0];n[s]==t[o]&&e.push(`${o}: ${s}`)}};r("wrapS"),r("wrapT")}if(t.tminFilter)for(let r of Z_){let o=Object.keys(r)[0];r[o]==t.minFilter&&e.push(`minFilter: ${o}`)}if(t.tmagFilter)for(let r of J_){let o=Object.keys(r)[0];r[o]==t.magFilter&&e.push(`magFilter: ${o}`)}return t.tflipY&&e.push(`flipY: ${t.flipY}`),e}};function $D(i){return class extends i{constructor(){super(...arguments);this.checkFileType=v.BOOLEAN(!0)}}}function Wee(i){return class extends i{constructor(){super(...arguments);this.url=v.STRING(zn.PARAM_DEFAULT,{fileBrowse:{type:[pc.TEXTURE_IMAGE]}}),this.reload=v.BUTTON(null,{callback:(t,r)=>{r9.PARAM_CALLBACK_reload(t,r)}})}}}var KD=class extends $D(R7(Wee(V))){},qee=new KD,r9=class extends Ea{constructor(){super(...arguments);this.paramsConfig=qee,this.textureParamsController=new Qd(this)}static type(){return"image"}async requiredModules(){this.p.url.isDirty()&&await this.p.url.compute();let e=Uo.extension(this.pv.url||"");return zn.module_names(e)}static displayedInputNames(){return["optional texture to copy attributes from"]}dispose(){super.dispose(),Q.blobs.clearBlobsForNode(this)}initializeNode(){this.io.inputs.setCount(0,1),this.io.inputs.initInputsClonedState(Ge.NEVER)}async cook(e){if(this.pv.checkFileType&&!FD(this.pv.url))this.states.error.set("url is not an image");else{let t=await this._loadTexture();if(t){let r=e[0];r&&Qd.copyTextureAttributes(t,r),await this.textureParamsController.update(t),this.setTexture(t)}else this._clearTexture()}}static PARAM_CALLBACK_reload(e,t){e.paramCallbackReload()}paramCallbackReload(){this.p.url.setDirty()}_loader(){return new zn(this.pv.url,this.p.url,this,this.scene(),{forceImage:!this.pv.checkFileType})}async _loadTexture(){let e=null;try{e=await this._loader().load_texture_from_url_or_op({tdataType:this.pv.ttype&&this.pv.tadvanced,dataType:this.pv.type}),e&&(e.matrixAutoUpdate=!1)}catch{}return e||this.states.error.set(`could not load texture '${this.pv.url}'`),e}};var JD=class extends V{constructor(){super(...arguments);this.animation=v.NODE_PATH("",{nodeSelection:{context:oe.ANIM},dependentOnFoundNode:!1}),this.play=v.BUTTON(null,{callback:e=>{ef.PARAM_CALLBACK_play(e)}}),this.pause=v.BUTTON(null,{callback:e=>{ef.PARAM_CALLBACK_pause(e)}}),this.stopsPreviousAnim=v.BOOLEAN(1)}},Xee=new JD,ef=class extends _o{constructor(){super(...arguments);this.paramsConfig=Xee}static type(){return"animation"}initializeNode(){this.io.inputs.setNamedInputConnectionPoints([new Je("start",Ke.BASE,this._play.bind(this)),new Je("stop",Ke.BASE,this._pause.bind(this))]),this.io.outputs.setNamedOutputConnectionPoints([new Je("start",Ke.BASE),new Je("completed",Ke.BASE)])}processEvent(e){}static PARAM_CALLBACK_play(e){e._play({})}static PARAM_CALLBACK_pause(e){e._pause()}async _play(e){let t=this.p.animation;t.isDirty()&&await t.compute();let r=t.value.nodeWithContext(oe.ANIM);if(!r)return;let o=await r.compute();!o||(this._timelineBuilder=o.coreContent(),!!this._timelineBuilder&&(this._timeline&&this.pv.stopsPreviousAnim&&this._timeline.kill(),this._timeline=Rn.timeline(),this._timelineBuilder.populate(this._timeline,{registerproperties:!0}),this._timeline.vars.onStart=()=>{this._triggerAnimationStarted(e)},this._timeline.vars.onComplete=()=>{this._triggerAnimationCompleted(e)}))}_pause(){this._timeline&&this._timeline.pause()}_triggerAnimationStarted(e){this.dispatchEventToOutput("start",e)}_triggerAnimationCompleted(e){this.dispatchEventToOutput("completed",e)}};var L7=class extends _o{constructor(){super(...arguments);this._controls_by_viewer=new Map}async apply_controls(e,t){var r;(r=t.controlsController())==null||r.dispose_controls();let o=t.canvas();if(!o)return;let n=await this.createControlsInstance(e,o),s=this._controls_by_viewer.get(t);s&&s.dispose(),this._controls_by_viewer.set(t,n);let c=Q.performance.performanceManager().now();return n.name=`${this.path()}:${e.name}:${c}:${this.controls_id()}`,await this.params.evalAll(),this.setupControls(n),n}controls_id(){return JSON.stringify(this.params.all.map(e=>e.valueSerialized()))}};var o9=class{constructor(e=1,t=0,r=0){return this.radius=e,this.phi=t,this.theta=r,this}set(e,t,r){return this.radius=e,this.phi=t,this.theta=r,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,r){return this.radius=Math.sqrt(e*e+t*t+r*r),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,r),this.phi=Math.acos(qs(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}};var ZD={type:"change"},I7={type:"start"},D7={type:"end"},k7=class extends Ul{constructor(e,t){super();t===void 0&&console.warn('THREE.OrbitControls: The second parameter "domElement" is now mandatory.'),t===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),this.object=e,this.domElement=t,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new w,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.enableKeys=!0,this.keyMode="pan",this.keyRotateSpeedVertical=1,this.keyRotateSpeedHorizontal=1,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:Ka.ROTATE,MIDDLE:Ka.DOLLY,RIGHT:Ka.PAN},this.touches={ONE:Ja.ROTATE,TWO:Ja.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return a.phi},this.getAzimuthalAngle=function(){return a.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(U){U.addEventListener("keydown",Ze),this._domElementKeyEvents=U},this.saveState=function(){r.target0.copy(r.target),r.position0.copy(r.object.position),r.zoom0=r.object.zoom},this.reset=function(){r.target.copy(r.target0),r.object.position.copy(r.position0),r.object.zoom=r.zoom0,r.object.updateProjectionMatrix(),r.dispatchEvent(ZD),r.update(),n=o.NONE},this.update=function(){let U=new w,se=new Nt().setFromUnitVectors(e.up,new w(0,1,0)),ve=se.clone().invert(),ke=new w,W=new Nt,Le=2*Math.PI,Me=!1;return function(){let _e=r.object.position;if(U.copy(_e).sub(r.target),U.applyQuaternion(se),a.setFromVector3(U),r.autoRotate&&n===o.NONE&&M(E()),r.enableDamping){let or=c.theta*r.dampingFactor,Mo=c.phi*r.dampingFactor;or<s&&Mo<s?Me||(r.dispatchEvent(D7),Me=!0):Me=!1,a.theta+=or,a.phi+=Mo}else a.theta+=c.theta,a.phi+=c.phi;let He=r.minAzimuthAngle,tt=r.maxAzimuthAngle;return isFinite(He)&&isFinite(tt)&&(He<-Math.PI?He+=Le:He>Math.PI&&(He-=Le),tt<-Math.PI?tt+=Le:tt>Math.PI&&(tt-=Le),He<tt?a.theta=Math.max(He,Math.min(tt,a.theta)):a.theta=a.theta>(He+tt)/2?Math.max(He,a.theta):Math.min(tt,a.theta)),a.phi=Math.max(r.minPolarAngle,Math.min(r.maxPolarAngle,a.phi)),a.makeSafe(),a.radius*=l,a.radius=Math.max(r.minDistance,Math.min(r.maxDistance,a.radius)),r.enableDamping===!0?r.target.addScaledVector(u,r.dampingFactor):r.target.add(u),U.setFromSpherical(a),U.applyQuaternion(ve),_e.copy(r.target).add(U),r.object.lookAt(r.target),r.enableDamping===!0?(c.theta*=1-r.dampingFactor,c.phi*=1-r.dampingFactor,u.multiplyScalar(1-r.dampingFactor)):(c.set(0,0,0),u.set(0,0,0)),l=1,p||ke.distanceToSquared(r.object.position)>s||8*(1-W.dot(r.object.quaternion))>s?(r.dispatchEvent(ZD),ke.copy(r.object.position),W.copy(r.object.quaternion),p=!1,!0):!1}}(),this.dispose=function(){r.domElement.removeEventListener("contextmenu",fe),r.domElement.removeEventListener("pointerdown",be),r.domElement.removeEventListener("pointercancel",we),r.domElement.removeEventListener("wheel",We),r.domElement.ownerDocument.removeEventListener("pointermove",ie),r.domElement.ownerDocument.removeEventListener("pointerup",de),r._domElementKeyEvents!==null&&r._domElementKeyEvents.removeEventListener("keydown",Ze)};let r=this,o={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},n=o.NONE,s=1e-6,a=new o9,c=new o9,l=1,u=new w,p=!1,h=new G,d=new G,m=new G,f=new G,x=new G,_=new G,g=new G,T=new G,b=new G,y=[],A={};function E(){return 2*Math.PI/60/60*r.autoRotateSpeed}function S(){return Math.pow(.95,r.zoomSpeed)}function M(U){c.theta-=U}function L(U){c.phi-=U}let C=function(){let U=new w;return function(ve,ke){U.setFromMatrixColumn(ke,0),U.multiplyScalar(-ve),u.add(U)}}(),N=function(){let U=new w;return function(ve,ke){r.screenSpacePanning===!0?U.setFromMatrixColumn(ke,1):(U.setFromMatrixColumn(ke,0),U.crossVectors(r.object.up,U)),U.multiplyScalar(ve),u.add(U)}}(),D=function(){let U=new w;return function(ve,ke){let W=r.domElement;if(r.object.isPerspectiveCamera){let Le=r.object.position;U.copy(Le).sub(r.target);let Me=U.length();Me*=Math.tan(r.object.fov/2*Math.PI/180),C(2*ve*Me/W.clientHeight,r.object.matrix),N(2*ke*Me/W.clientHeight,r.object.matrix)}else r.object.isOrthographicCamera?(C(ve*(r.object.right-r.object.left)/r.object.zoom/W.clientWidth,r.object.matrix),N(ke*(r.object.top-r.object.bottom)/r.object.zoom/W.clientHeight,r.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),r.enablePan=!1)}}();function k(U){r.object.isPerspectiveCamera?l/=U:r.object.isOrthographicCamera?(r.object.zoom=Math.max(r.minZoom,Math.min(r.maxZoom,r.object.zoom*U)),r.object.updateProjectionMatrix(),p=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),r.enableZoom=!1)}function z(U){r.object.isPerspectiveCamera?l*=U:r.object.isOrthographicCamera?(r.object.zoom=Math.max(r.minZoom,Math.min(r.maxZoom,r.object.zoom/U)),r.object.updateProjectionMatrix(),p=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),r.enableZoom=!1)}function F(U){h.set(U.clientX,U.clientY)}function X(U){g.set(U.clientX,U.clientY)}function $(U){f.set(U.clientX,U.clientY)}function Y(U){d.set(U.clientX,U.clientY),m.subVectors(d,h).multiplyScalar(r.rotateSpeed);var se=r.domElement;M(2*Math.PI*m.x/se.clientHeight),L(2*Math.PI*m.y/se.clientHeight),h.copy(d),r.update()}function H(U){T.set(U.clientX,U.clientY),b.subVectors(T,g),b.y>0?k(S()):b.y<0&&z(S()),g.copy(T),r.update()}function B(U){x.set(U.clientX,U.clientY),_.subVectors(x,f).multiplyScalar(r.panSpeed),D(_.x,_.y),f.copy(x),r.update()}function te(U){U.deltaY<0?z(S()):U.deltaY>0&&k(S()),r.update()}function q(U){let se=!1;if(r.keyMode=="pan")switch(U.code){case r.keys.UP:D(0,r.keyPanSpeed),se=!0;break;case r.keys.BOTTOM:D(0,-r.keyPanSpeed),se=!0;break;case r.keys.LEFT:D(r.keyPanSpeed,0),se=!0;break;case r.keys.RIGHT:D(-r.keyPanSpeed,0),se=!0;break}else switch(U.code){case r.keys.UP:L(r.keyRotateSpeedVertical),se=!0;break;case r.keys.BOTTOM:L(-r.keyRotateSpeedVertical),se=!0;break;case r.keys.LEFT:M(r.keyRotateSpeedHorizontal),se=!0;break;case r.keys.RIGHT:M(-r.keyRotateSpeedHorizontal),se=!0;break}se&&(U.preventDefault(),r.update())}function j(){if(y.length===1)h.set(y[0].pageX,y[0].pageY);else{let U=.5*(y[0].pageX+y[1].pageX),se=.5*(y[0].pageY+y[1].pageY);h.set(U,se)}}function R(){if(y.length===1)f.set(y[0].pageX,y[0].pageY);else{let U=.5*(y[0].pageX+y[1].pageX),se=.5*(y[0].pageY+y[1].pageY);f.set(U,se)}}function Ne(){let U=y[0].pageX-y[1].pageX,se=y[0].pageY-y[1].pageY,ve=Math.sqrt(U*U+se*se);g.set(0,ve)}function xe(){r.enableZoom&&Ne(),r.enablePan&&R()}function ae(){r.enableZoom&&Ne(),r.enableRotate&&j()}function Ae(U){if(y.length==1)d.set(U.pageX,U.pageY);else{let ve=Se(U),ke=.5*(U.pageX+ve.x),W=.5*(U.pageY+ve.y);d.set(ke,W)}m.subVectors(d,h).multiplyScalar(r.rotateSpeed);let se=r.domElement;M(2*Math.PI*m.x/se.clientHeight),L(2*Math.PI*m.y/se.clientHeight),h.copy(d)}function Re(U){if(y.length===1)x.set(U.pageX,U.pageY);else{let se=Se(U),ve=.5*(U.pageX+se.x),ke=.5*(U.pageY+se.y);x.set(ve,ke)}_.subVectors(x,f).multiplyScalar(r.panSpeed),D(_.x,_.y),f.copy(x)}function Oe(U){let se=Se(U),ve=U.pageX-se.x,ke=U.pageY-se.y,W=Math.sqrt(ve*ve+ke*ke);T.set(0,W),b.set(0,Math.pow(T.y/g.y,r.zoomSpeed)),k(b.y),g.copy(T)}function le(U){r.enableZoom&&Oe(U),r.enablePan&&Re(U)}function ye(U){r.enableZoom&&Oe(U),r.enableRotate&&Ae(U)}function be(U){r.enabled!==!1&&(y.length===0&&(r.domElement.setPointerCapture(U.pointerId),r.domElement.ownerDocument.addEventListener("pointermove",ie),r.domElement.ownerDocument.addEventListener("pointerup",de)),ee(U),U.pointerType==="touch"?I(U):Ee(U))}function ie(U){r.enabled!==!1&&(U.pointerType==="touch"?O(U):Pe(U))}function de(U){me(U),y.length===0&&(r.domElement.releasePointerCapture(U.pointerId),r.domElement.ownerDocument.removeEventListener("pointermove",ie),r.domElement.ownerDocument.removeEventListener("pointerup",de)),r.dispatchEvent(D7),n=o.NONE}function we(U){me(U)}function Ee(U){let se;switch(U.button){case 0:se=r.mouseButtons.LEFT;break;case 1:se=r.mouseButtons.MIDDLE;break;case 2:se=r.mouseButtons.RIGHT;break;default:se=-1}switch(se){case Ka.DOLLY:if(r.enableZoom===!1)return;X(U),n=o.DOLLY;break;case Ka.ROTATE:if(U.ctrlKey||U.metaKey||U.shiftKey){if(r.enablePan===!1)return;$(U),n=o.PAN}else{if(r.enableRotate===!1)return;F(U),n=o.ROTATE}break;case Ka.PAN:if(U.ctrlKey||U.metaKey||U.shiftKey){if(r.enableRotate===!1)return;F(U),n=o.ROTATE}else{if(r.enablePan===!1)return;$(U),n=o.PAN}break;default:n=o.NONE}n!==o.NONE&&r.dispatchEvent(I7)}function Pe(U){if(r.enabled!==!1)switch(n){case o.ROTATE:if(r.enableRotate===!1)return;Y(U);break;case o.DOLLY:if(r.enableZoom===!1)return;H(U);break;case o.PAN:if(r.enablePan===!1)return;B(U);break}}function We(U){r.enabled===!1||r.enableZoom===!1||n!==o.NONE||(U.preventDefault(),r.dispatchEvent(I7),te(U),r.dispatchEvent(D7))}function Ze(U){r.enabled===!1||r.enablePan===!1||q(U)}function I(U){switch(Z(U),y.length){case 1:switch(r.touches.ONE){case Ja.ROTATE:if(r.enableRotate===!1)return;j(),n=o.TOUCH_ROTATE;break;case Ja.PAN:if(r.enablePan===!1)return;R(),n=o.TOUCH_PAN;break;default:n=o.NONE}break;case 2:switch(r.touches.TWO){case Ja.DOLLY_PAN:if(r.enableZoom===!1&&r.enablePan===!1)return;xe(),n=o.TOUCH_DOLLY_PAN;break;case Ja.DOLLY_ROTATE:if(r.enableZoom===!1&&r.enableRotate===!1)return;ae(),n=o.TOUCH_DOLLY_ROTATE;break;default:n=o.NONE}break;default:n=o.NONE}n!==o.NONE&&r.dispatchEvent(I7)}function O(U){switch(Z(U),n){case o.TOUCH_ROTATE:if(r.enableRotate===!1)return;Ae(U),r.update();break;case o.TOUCH_PAN:if(r.enablePan===!1)return;Re(U),r.update();break;case o.TOUCH_DOLLY_PAN:if(r.enableZoom===!1&&r.enablePan===!1)return;le(U),r.update();break;case o.TOUCH_DOLLY_ROTATE:if(r.enableZoom===!1&&r.enableRotate===!1)return;ye(U),r.update();break;default:n=o.NONE}}function fe(U){r.enabled!==!1&&U.preventDefault()}function ee(U){y.push(U)}function me(U){delete A[U.pointerId];for(let se=0;se<y.length;se++)if(y[se].pointerId==U.pointerId){y.splice(se,1);return}}function Z(U){let se=A[U.pointerId];se===void 0&&(se=new G,A[U.pointerId]=se),se.set(U.pageX,U.pageY)}function Se(U){let se=U.pointerId===y[0].pointerId?y[1]:y[0];return A[se.pointerId]}r.domElement.addEventListener("contextmenu",fe),r.domElement.addEventListener("pointerdown",be),r.domElement.addEventListener("pointercancel",we),r.domElement.addEventListener("wheel",We,{passive:!1}),this.update()}};var QD="start",ek="change",tk="end";var Op=["pan","rotate"],rk=class extends V{constructor(){super(...arguments);this.enabled=v.BOOLEAN(1),this.allowPan=v.BOOLEAN(1),this.allowRotate=v.BOOLEAN(1),this.allowZoom=v.BOOLEAN(1),this.tdamping=v.BOOLEAN(1),this.damping=v.FLOAT(.1,{visibleIf:{tdamping:!0}}),this.screenSpacePanning=v.BOOLEAN(1),this.rotateSpeed=v.FLOAT(.5),this.minDistance=v.FLOAT(.1,{range:[.1,100],rangeLocked:[!0,!1]}),this.maxDistance=v.FLOAT(50,{range:[0,100],rangeLocked:[!0,!1]}),this.limitAzimuthAngle=v.BOOLEAN(0),this.azimuthAngleRange=v.VECTOR2(["-2*$PI","2*$PI"],{visibleIf:{limitAzimuthAngle:1}}),this.polarAngleRange=v.VECTOR2([0,"$PI"]),this.target=v.VECTOR3([0,0,0],{cook:!1,computeOnDirty:!0,callback:e=>{i9.PARAM_CALLBACK_update_target(e)}}),this.enableKeys=v.BOOLEAN(0),this.keysMode=v.INTEGER(Op.indexOf("pan"),{visibleIf:{enableKeys:1},menu:{entries:Op.map((e,t)=>({name:e,value:t}))}}),this.keysPanSpeed=v.FLOAT(7,{range:[0,10],rangeLocked:[!1,!1],visibleIf:{enableKeys:1,keysMode:Op.indexOf("pan")}}),this.keysRotateSpeedVertical=v.FLOAT(1,{range:[0,1],rangeLocked:[!1,!1],visibleIf:{enableKeys:1,keysMode:Op.indexOf("rotate")}}),this.keysRotateSpeedHorizontal=v.FLOAT(1,{range:[0,1],rangeLocked:[!1,!1],visibleIf:{enableKeys:1,keysMode:Op.indexOf("rotate")}})}},Yee=new rk,i9=class extends L7{constructor(){super(...arguments);this.paramsConfig=Yee,this._controls_by_element_id=new Map,this._target_array=[0,0,0]}static type(){return R4.ORBIT}endEventName(){return"end"}initializeNode(){this.io.outputs.setNamedOutputConnectionPoints([new Je(QD,Ke.BASE),new Je(ek,Ke.BASE),new Je(tk,Ke.BASE)])}async createControlsInstance(e,t){let r=new k7(e,t);return r.addEventListener("end",()=>{this._on_controls_end(r)}),this._controls_by_element_id.set(t.id,r),this._bind_listeners_to_controls_instance(r),r}_bind_listeners_to_controls_instance(e){e.addEventListener("start",()=>{this.dispatchEventToOutput(QD,{})}),e.addEventListener("change",()=>{this.dispatchEventToOutput(ek,{})}),e.addEventListener("end",()=>{this.dispatchEventToOutput(tk,{})})}setupControls(e){e.enabled=this.pv.enabled,e.enablePan=this.pv.allowPan,e.enableRotate=this.pv.allowRotate,e.enableZoom=this.pv.allowZoom,e.enableDamping=this.pv.tdamping,e.dampingFactor=this.pv.damping,e.rotateSpeed=this.pv.rotateSpeed,e.screenSpacePanning=this.pv.screenSpacePanning,e.minDistance=this.pv.minDistance,e.maxDistance=this.pv.maxDistance,this._set_azimuth_angle(e),e.minPolarAngle=this.pv.polarAngleRange.x,e.maxPolarAngle=this.pv.polarAngleRange.y,e.target.copy(this.pv.target),e.enabled&&e.update(),e.enableKeys=this.pv.enableKeys,e.enableKeys&&(e.keyMode=Op[this.pv.keysMode],e.keyRotateSpeedVertical=this.pv.keysRotateSpeedVertical,e.keyRotateSpeedHorizontal=this.pv.keysRotateSpeedHorizontal,e.keyPanSpeed=this.pv.keysPanSpeed)}_set_azimuth_angle(e){this.pv.limitAzimuthAngle?(e.minAzimuthAngle=this.pv.azimuthAngleRange.x,e.maxAzimuthAngle=this.pv.azimuthAngleRange.y):(e.minAzimuthAngle=1/0,e.maxAzimuthAngle=1/0)}updateRequired(){return this.pv.tdamping}_on_controls_end(e){!this.pv.allowPan||(e.target.toArray(this._target_array),this.p.target.set(this._target_array))}static PARAM_CALLBACK_update_target(e){e._update_target()}_update_target(){let e=this.pv.target;this._controls_by_element_id.forEach((t,r)=>{let o=t.target;o.equals(e)||(o.copy(e),t.update())})}disposeControlsForHtmlElementId(e){this._controls_by_element_id.get(e)&&this._controls_by_element_id.delete(e)}};var tf=class{constructor(e,t,r=0,o=1/0){this.ray=new Zx(e,t),this.near=r,this.far=o,this.camera=null,this.layers=new km,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t&&t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t&&t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}intersectObject(e,t=!0,r=[]){return B7(e,this,r,t),r.sort(ok),r}intersectObjects(e,t=!0,r=[]){for(let o=0,n=e.length;o<n;o++)B7(e[o],this,r,t);return r.sort(ok),r}};function ok(i,e){return i.distance-e.distance}function B7(i,e,t,r){if(i.layers.test(e.layers)&&i.raycast(e,t),r===!0){let o=i.children;for(let n=0,s=o.length;n<s;n++)B7(o[n],e,t,!0)}}var F7=class{constructor(e){this._node=e,this._set_pos_timestamp=-1,this._hit_velocity=new w(0,0,0),this._hit_velocity_array=[0,0,0]}process(e){if(!this._node.pv.tvelocity)return;if(!this._prev_position){this._prev_position=this._prev_position||new w,this._prev_position.copy(e);return}let r=Q.performance.performanceManager().now(),o=r-this._set_pos_timestamp;if(this._set_pos_timestamp=r,this._hit_velocity.copy(e).sub(this._prev_position).divideScalar(o).multiplyScalar(1e3),this._hit_velocity.toArray(this._hit_velocity_array),this._node.pv.tvelocityTarget){if(Q.playerMode())this._found_velocity_target_param=this._found_velocity_target_param||this._node.pv.velocityTarget.paramWithType(J.VECTOR3);else{let n=this._node.pv.velocityTarget;this._found_velocity_target_param=n.paramWithType(J.VECTOR3)}this._found_velocity_target_param&&this._found_velocity_target_param.set(this._hit_velocity_array)}else this._node.p.velocity.set(this._hit_velocity_array);this._prev_position.copy(e)}reset(){this._prev_position=void 0}};var wa=(i=>(i.GEOMETRY="geometry",i.PLANE="plane",i))(wa||{}),Hc=["geometry","plane"];var ik=class extends V{constructor(){super(...arguments);this.attributeName=v.STRING("id",{cook:!1}),this.attributeType=v.INTEGER(At.indexOf(Ue.NUMERIC),{menu:{entries:j0}}),this.attributeValue1=v.FLOAT(0,{cook:!1,visibleIf:{attributeType:At.indexOf(Ue.NUMERIC)}}),this.resetValue1=v.FLOAT(-1,{cook:!1,visibleIf:{attributeType:At.indexOf(Ue.NUMERIC)}}),this.attributeValues=v.STRING("",{visibleIf:{attributeType:At.indexOf(Ue.STRING)}}),this.resetValues=v.STRING("",{visibleIf:{attributeType:At.indexOf(Ue.STRING)}})}},$ee=new ik,rf=class extends _o{constructor(){super(...arguments);this.paramsConfig=$ee}static type(){return"intersectData"}initializeNode(){this.io.inputs.setNamedInputConnectionPoints([new Je(rf.INPUT_HIT,Ke.BASE,this._processHit.bind(this)),new Je(rf.INPUT_MISS,Ke.BASE,this._processMiss.bind(this))])}_processHit(i){var e;let t=(e=i.value)==null?void 0:e.intersect;!t||this._resolveIntersectAttribute(t)}_processMiss(i){let e=At[this.pv.attributeType];switch(e){case Ue.NUMERIC:{this.p.attributeValue1.set(this.pv.resetValue1);return}case Ue.STRING:{this.p.attributeValues.set(this.pv.resetValues);return}}Be.unreachable(e)}_resolveIntersectAttribute(i){let e=At[this.pv.attributeType],t=rf.resolveObjectAttribute(i,this.pv.attributeName);if(t==null&&(t=rf.resolveGeometryAttribute(i,this.pv.attributeName,e)),t!=null){switch(e){case Ue.NUMERIC:{this.p.attributeValue1.set(t);return}case Ue.STRING:{K.isString(t)&&this.p.attributeValues.set(t);return}}Be.unreachable(e)}}static resolveObjectAttribute(i,e){let t=Or.attribValue(i.object,e);if(t!=null){if(K.isNumber(t)||K.isString(t))return t;if(K.isArray(t))return t[0];if(K.isVector(t))return t.x}}static resolveGeometryAttribute(i,e,t){switch(Zi(i.object.constructor)){case $t.MESH:return this.resolveGeometryAttributeForMesh(i,e,t);case $t.POINTS:return this.resolveGeometryAttributeForPoint(i,e,t)}}static resolveGeometryAttributeForMesh(i,e,t){let r=i.object.geometry;if(r){let o=r.getAttribute(e);if(o){switch(t){case Ue.NUMERIC:{let n=r.getAttribute("position");return i.face?(this._vA.fromBufferAttribute(n,i.face.a),this._vB.fromBufferAttribute(n,i.face.b),this._vC.fromBufferAttribute(n,i.face.c),this._uvA.fromBufferAttribute(o,i.face.a),this._uvB.fromBufferAttribute(o,i.face.b),this._uvC.fromBufferAttribute(o,i.face.c),i.uv=as.getUV(i.point,this._vA,this._vB,this._vC,this._uvA,this._uvB,this._uvC,this._hitUV),this._hitUV.x):void 0}case Ue.STRING:{let s=new Ut(r).points()[0];return s?s.stringAttribValue(e):void 0}}Be.unreachable(t)}}}static resolveGeometryAttributeForPoint(i,e,t){let r=i.object.geometry;if(r&&i.index!=null){switch(t){case Ue.NUMERIC:{let o=r.getAttribute(e);return o?o.array[i.index]:void 0}case Ue.STRING:{let n=new Ut(r).points()[i.index];return n?n.stringAttribValue(e):void 0}}Be.unreachable(t)}}},_n=rf;_n.INPUT_HIT="hit";_n.INPUT_MISS="miss";_n._vA=new w;_n._vB=new w;_n._vC=new w;_n._uvA=new G;_n._uvB=new G;_n._uvC=new G;_n._hitUV=new G;function nk(i,e,t){var r=e.getBoundingClientRect();t.offsetX=i.pageX-r.left,t.offsetY=i.pageY-r.top}function Kee(){let i=new tf;return i.firstHitOnly=!0,i}var jc=class{constructor(e){this._node=e,this._offset={offsetX:0,offsetY:0},this._mouse=new G,this._mouse_array=[0,0],this._raycaster=Kee(),this._plane=new bi,this._plane_intersect_target=new w,this._intersections=[],this._hit_position_array=[0,0,0],this.velocity_controller=new F7(this._node)}updateMouse(e){var t;let r=(t=e.viewer)==null?void 0:t.canvas(),o=e.cameraNode;if(!(r&&o))return;let n=a=>{this._mouse.x=a.offsetX/r.offsetWidth*2-1,this._mouse.y=-(a.offsetY/r.offsetHeight)*2+1,this._mouse.toArray(this._mouse_array),this._node.p.mouse.set(this._mouse_array)},s=e.event;if((s instanceof MouseEvent||s instanceof DragEvent||s instanceof PointerEvent)&&nk(s,r,this._offset),window.TouchEvent&&s instanceof TouchEvent){let a=s.touches[0];nk(a,r,this._offset)}n(this._offset),this._raycaster.setFromCamera(this._mouse,o.object)}processEvent(e){this._prepareRaycaster(e);let t=Hc[this._node.pv.intersectWith];switch(t){case wa.GEOMETRY:return this._intersectGeometry(e);case wa.PLANE:return this._intersectPlane(e)}Be.unreachable(t)}_intersectPlane(e){this._plane.normal.copy(this._node.pv.planeDirection),this._plane.constant=this._node.pv.planeOffset,this._raycaster.ray.intersectPlane(this._plane,this._plane_intersect_target),this._setPositionParam(this._plane_intersect_target),this._node.triggerHit(e)}_intersectGeometry(e){if(this._resolved_targets||this.update_target(),this._resolved_targets){this._intersections.length=0;let r=this._raycaster.intersectObjects(this._resolved_targets,this._node.pv.traverseChildren,this._intersections)[0];r?(this._node.pv.tposition&&this._setPositionParam(r.point),this._node.pv.geoAttribute&&this._resolveIntersectAttribute(r),e.value={intersect:r},this._node.triggerHit(e)):this._node.triggerMiss(e)}}_resolveIntersectAttribute(e){let t=At[this._node.pv.geoAttributeType],r=_n.resolveObjectAttribute(e,this._node.pv.geoAttributeName);if(r==null&&(r=_n.resolveGeometryAttribute(e,this._node.pv.geoAttributeName,t)),r!=null){switch(t){case Ue.NUMERIC:{this._node.p.geoAttributeValue1.set(r);return}case Ue.STRING:{K.isString(r)&&this._node.p.geoAttributeValues.set(r);return}}Be.unreachable(t)}}_setPositionParam(e){if(e.toArray(this._hit_position_array),this._node.pv.tpositionTarget){if(Q.playerMode())this._found_position_target_param=this._found_position_target_param||this._node.pv.positionTarget.paramWithType(J.VECTOR3);else{let t=this._node.pv.positionTarget;this._found_position_target_param=t.paramWithType(J.VECTOR3)}this._found_position_target_param&&this._found_position_target_param.set(this._hit_position_array)}else this._node.p.position.set(this._hit_position_array);this.velocity_controller.process(e)}_prepareRaycaster(e){let t=this._raycaster.params.Points;t&&(t.threshold=this._node.pv.pointsThreshold);let r=e.cameraNode;if(this._node.pv.overrideCamera)if(this._node.pv.overrideRay)this._raycaster.ray.origin.copy(this._node.pv.rayOrigin),this._raycaster.ray.direction.copy(this._node.pv.rayDirection);else{let o=this._node.pv.camera.nodeWithContext(oe.OBJ,this._node.states.error);o&&u1.includes(o.type())&&(r=o)}r&&!this._node.pv.overrideRay&&r.prepareRaycaster(this._mouse,this._raycaster)}update_target(){let e=Pp[this._node.pv.targetType];switch(e){case n9.NODE:return this._update_target_from_node();case n9.SCENE_GRAPH:return this._update_target_from_scene_graph()}Be.unreachable(e)}_update_target_from_node(){let e=this._node.p.targetNode.value.nodeWithContext(oe.OBJ);if(e){let t=this._node.pv.traverseChildren?e.object:e.childrenDisplayController.sopGroup();t?this._resolved_targets=[t]:this._resolved_targets=void 0}else this._node.states.error.set("node is not an object")}_update_target_from_scene_graph(){let e=this._node.scene().objectsByMask(this._node.pv.objectMask);e.length>0?this._resolved_targets=e:this._resolved_targets=void 0}async update_position_target(){this._node.p.positionTarget.isDirty()&&await this._node.p.positionTarget.compute()}static PARAM_CALLBACK_update_target(e){e.cpuController.update_target()}static PARAM_CALLBACK_print_resolve(e){e.cpuController.print_resolve()}print_resolve(){this.update_target(),console.log(this._resolved_targets)}};var s9=class{constructor(e){this._node=e,this._resolved_material=null,this._restore_context={scene:{overrideMaterial:null},renderer:{toneMapping:-1,outputEncoding:-1}},this._mouse=new G,this._mouseArray=[0,0],this._read=new Float32Array(4),this._param_read=[0,0,0,0]}updateMouse(e){var t;let r=(t=e.viewer)==null?void 0:t.canvas();!(r&&e.event)||(e.event instanceof MouseEvent||e.event instanceof DragEvent||e.event instanceof PointerEvent?(this._mouse.x=e.event.offsetX/r.offsetWidth,this._mouse.y=1-e.event.offsetY/r.offsetHeight,this._mouse.toArray(this._mouseArray),this._node.p.mouse.set(this._mouseArray)):console.warn("event type not implemented"))}processEvent(e){var t;let r=(t=e.viewer)==null?void 0:t.canvas();if(!(r&&e.cameraNode))return;let o=e.cameraNode,n=o.renderController();if(n){if(this._renderTarget=this._renderTarget||new vr(r.offsetWidth,r.offsetHeight,{minFilter:at,magFilter:nt,format:st,type:Wt}),!this._resolved_material){this.update_material(),console.warn("no material found");return}let s=o,a=n.resolvedScene()||o.scene().threejsScene(),c=n.renderer(r);if(!c)return;this._modify_scene_and_renderer(a,c),c.setRenderTarget(this._renderTarget),c.clear(),c.render(a,s.object),c.setRenderTarget(null),this._restore_scene_and_renderer(a,c),c.readRenderTargetPixels(this._renderTarget,Math.round(this._mouse.x*r.offsetWidth),Math.round(this._mouse.y*r.offsetHeight),1,1,this._read),this._param_read[0]=this._read[0],this._param_read[1]=this._read[1],this._param_read[2]=this._read[2],this._param_read[3]=this._read[3],this._node.p.pixelValue.set(this._param_read),this._node.pv.pixelValue.x>this._node.pv.hitThreshold?this._node.triggerHit(e):this._node.triggerMiss(e)}}_modify_scene_and_renderer(e,t){this._restore_context.scene.overrideMaterial=e.overrideMaterial,this._restore_context.renderer.outputEncoding=t.outputEncoding,this._restore_context.renderer.toneMapping=t.toneMapping,e.overrideMaterial=this._resolved_material,t.toneMapping=Oo,t.outputEncoding=Hr}_restore_scene_and_renderer(e,t){e.overrideMaterial=this._restore_context.scene.overrideMaterial,t.outputEncoding=this._restore_context.renderer.outputEncoding,t.toneMapping=this._restore_context.renderer.toneMapping}update_material(){let e=this._node.pv.material.nodeWithContext(oe.MAT,this._node.states.error);e?e.context()==oe.MAT?this._resolved_material=e.material:this._node.states.error.set("target is not an obj"):this._node.states.error.set("no target found")}static PARAM_CALLBACK_update_material(e){e.gpuController.update_material()}};var U7=1e3/60;var Hn=["cpu","gpu"];function f0(i={}){return i.mode=Hn.indexOf("cpu"),{visibleIf:i}}function Is(i={}){return i.mode=Hn.indexOf("cpu"),i.intersectWith=Hc.indexOf(wa.GEOMETRY),{visibleIf:i}}function sk(i={}){return i.mode=Hn.indexOf("cpu"),i.intersectWith=Hc.indexOf(wa.PLANE),{visibleIf:i}}function V7(i={}){return i.mode=Hn.indexOf("gpu"),{visibleIf:i}}var n9=(i=>(i.SCENE_GRAPH="scene graph",i.NODE="node",i))(n9||{}),Pp=["scene graph","node"],ak=class extends V{constructor(){super(...arguments);this.mode=v.INTEGER(Hn.indexOf("cpu"),{menu:{entries:Hn.map((e,t)=>({name:e,value:t}))}}),this.mouse=v.VECTOR2([0,0],{cook:!1}),this.overrideCamera=v.BOOLEAN(0),this.overrideRay=v.BOOLEAN(0,{visibleIf:{mode:Hn.indexOf("cpu"),overrideCamera:1}}),this.camera=v.NODE_PATH("",{nodeSelection:{context:oe.OBJ,types:u1},dependentOnFoundNode:!1,visibleIf:{overrideCamera:1,overrideRay:0}}),this.rayOrigin=v.VECTOR3([0,0,0],{visibleIf:{overrideCamera:1,overrideRay:1}}),this.rayDirection=v.VECTOR3([0,0,1],{visibleIf:{overrideCamera:1,overrideRay:1}}),this.material=v.NODE_PATH("",{nodeSelection:{context:oe.MAT},dependentOnFoundNode:!1,callback:(e,t)=>{s9.PARAM_CALLBACK_update_material(e)},...V7()}),this.pixelValue=v.VECTOR4([0,0,0,0],{cook:!1,...V7()}),this.hitThreshold=v.FLOAT(.5,{cook:!1,...V7()}),this.intersectWith=v.INTEGER(Hc.indexOf(wa.GEOMETRY),{menu:{entries:Hc.map((e,t)=>({name:e,value:t}))},...f0()}),this.pointsThreshold=v.FLOAT(1,{range:[0,100],rangeLocked:[!0,!1],...f0()}),this.planeDirection=v.VECTOR3([0,1,0],{...sk()}),this.planeOffset=v.FLOAT(0,{...sk()}),this.targetType=v.INTEGER(0,{menu:{entries:Pp.map((e,t)=>({name:e,value:t}))},...Is()}),this.targetNode=v.NODE_PATH("",{nodeSelection:{context:oe.OBJ},dependentOnFoundNode:!1,callback:(e,t)=>{jc.PARAM_CALLBACK_update_target(e)},...Is({targetType:Pp.indexOf("node")})}),this.objectMask=v.STRING("*geo1*",{callback:(e,t)=>{jc.PARAM_CALLBACK_update_target(e)},...Is({targetType:Pp.indexOf("scene graph")})}),this.printFoundObjectsFromMask=v.BUTTON(null,{callback:(e,t)=>{jc.PARAM_CALLBACK_print_resolve(e)},...Is({targetType:Pp.indexOf("scene graph")})}),this.traverseChildren=v.BOOLEAN(!0,{callback:(e,t)=>{jc.PARAM_CALLBACK_update_target(e)},...Is(),separatorAfter:!0}),this.tposition=v.BOOLEAN(1,{cook:!1,...f0()}),this.tpositionTarget=v.BOOLEAN(0,{cook:!1,...f0({tposition:1})}),this.position=v.VECTOR3([0,0,0],{cook:!1,...f0({tposition:1,tpositionTarget:0})}),this.positionTarget=v.PARAM_PATH("",{cook:!1,...f0({tposition:1,tpositionTarget:1}),paramSelection:J.VECTOR3,computeOnDirty:!0}),this.tvelocity=v.BOOLEAN(0,{cook:!1}),this.tvelocityTarget=v.BOOLEAN(0,{cook:!1,...f0({tvelocity:1})}),this.velocity=v.VECTOR3([0,0,0],{cook:!1,...f0({tvelocity:1,tvelocityTarget:0})}),this.velocityTarget=v.PARAM_PATH("",{cook:!1,...f0({tvelocity:1,tvelocityTarget:1}),paramSelection:J.VECTOR3,computeOnDirty:!0}),this.geoAttribute=v.BOOLEAN(0,Is()),this.geoAttributeName=v.STRING("id",{cook:!1,...Is({geoAttribute:1})}),this.geoAttributeType=v.INTEGER(At.indexOf(Ue.NUMERIC),{menu:{entries:j0},...Is({geoAttribute:1})}),this.geoAttributeValue1=v.FLOAT(0,{cook:!1,...Is({geoAttribute:1,geoAttributeType:At.indexOf(Ue.NUMERIC)})}),this.geoAttributeValues=v.STRING("",{...Is({geoAttribute:1,geoAttributeType:At.indexOf(Ue.STRING)})})}},Jee=new ak,m0=class extends _o{constructor(){super(...arguments);this.paramsConfig=Jee,this.cpuController=new jc(this),this.gpuController=new s9(this),this._lastEventProcessedAt=-1}static type(){return"raycast"}initializeNode(){this.io.inputs.setNamedInputConnectionPoints([new Je(m0.INPUT_TRIGGER,Ke.BASE,this._processTriggerEventThrottled.bind(this)),new Je(m0.INPUT_MOUSE,Ke.MOUSE,this._processMouseEvent.bind(this)),new Je(m0.INPUT_UPDATE_OBJECTS,Ke.BASE,this._process_trigger_update_objects.bind(this)),new Je(m0.INPUT_TRIGGER_VEL_RESET,Ke.BASE,this._process_trigger_vel_reset.bind(this))]),this.io.outputs.setNamedOutputConnectionPoints([new Je(m0.OUTPUT_HIT,Ke.BASE),new Je(m0.OUTPUT_MISS,Ke.BASE)])}triggerHit(i){this.dispatchEventToOutput(m0.OUTPUT_HIT,i)}triggerMiss(i){this.dispatchEventToOutput(m0.OUTPUT_MISS,i)}_processMouseEvent(i){this.pv.mode==Hn.indexOf("cpu")?this.cpuController.updateMouse(i):this.gpuController.updateMouse(i)}_processTriggerEventThrottled(i){let e=Q.performance.performanceManager().now(),t=o=>{let n=this._lastEventProcessedAt;return o-n},r=t(e);r<U7?setTimeout(()=>{t(e)<U7&&this._processTriggerEvent(i)},U7-r):this._processTriggerEvent(i)}_processTriggerEvent(i){this._processMouseEvent(i),this._lastEventProcessedAt=Q.performance.performanceManager().now(),this.pv.mode==Hn.indexOf("cpu")?this.cpuController.processEvent(i):this.gpuController.processEvent(i)}_process_trigger_update_objects(i){this.pv.mode==Hn.indexOf("cpu")&&this.cpuController.update_target()}_process_trigger_vel_reset(i){this.pv.mode==Hn.indexOf("cpu")&&this.cpuController.velocity_controller.reset()}},Ma=m0;Ma.INPUT_TRIGGER="trigger";Ma.INPUT_MOUSE="mouse";Ma.INPUT_UPDATE_OBJECTS="updateObjects";Ma.INPUT_TRIGGER_VEL_RESET="triggerVelReset";Ma.OUTPUT_HIT="hit";Ma.OUTPUT_MISS="miss";var G7={visibleIf:{active:1},callback:i=>{Wc.PARAM_CALLBACK_updateSceneEventsController(i)}},z7={visibleIf:{active:1},callback:i=>{Wc.PARAM_CALLBACK_updateTimeDependency(i)}},ck=class extends V{constructor(){super(...arguments);this.active=v.BOOLEAN(!0,{callback:(e,t)=>{Wc.PARAM_CALLBACK_updateActiveState(e)},separatorAfter:!0}),this.element=v.INTEGER(0,{hidden:!0}),this.sceneLoaded=v.BOOLEAN(1,G7),this.play=v.BOOLEAN(1,G7),this.pause=v.BOOLEAN(1,G7),this.tick=v.BOOLEAN(1,{separatorAfter:!0,...z7}),this.treachedTime=v.BOOLEAN(0,z7),this.reachedTime=v.FLOAT(10,{visibleIf:{treachedTime:1},range:[0,100],separatorAfter:!0,...z7}),this.setFrameValue=v.INTEGER(1,{range:[0,100]}),this.setFrame=v.BUTTON(null,{callback:e=>{Wc.PARAM_CALLBACK_setFrame(e)}})}},Zee=new ck,Wc=class extends _o{constructor(){super(...arguments);this.paramsConfig=Zee,this._timeReached=!1}static type(){return"scene"}dispose(){var e;(e=this._graphNode)==null||e.dispose(),super.dispose()}initializeNode(){this.io.inputs.setNamedInputConnectionPoints([new Je("setFrame",Ke.BASE,this._onSetFrame.bind(this)),new Je(oc.PLAY,Ke.BASE,this._play.bind(this)),new Je(oc.PAUSE,Ke.BASE,this._pause.bind(this))]);let e=IA.map(o=>new Je(o,Ke.BASE));e.push(new Je("tick",Ke.BASE)),e.push(new Je("timeReached",Ke.BASE)),this.io.outputs.setNamedOutputConnectionPoints(e),this.params.onParamsCreated("updateTimeDependency",()=>{this._updateTimeDependency()}),this._updateSceneEventsController();let t=()=>{this._updateSceneEventsController()},r=()=>{this.scene().eventsDispatcher.sceneEventsController.removeObserverFromAllEventTypes(this)};this.lifecycle.onAfterAdded(t),this.lifecycle.onBeforeDeleted(r)}processEvent(e){!this.pv.active||!e.event||this.dispatchEventToOutput(e.event.type,e)}_onSetFrame(e){this.scene().setFrame(this.pv.setFrameValue)}_play(e){this.scene().play()}_pause(e){this.scene().pause()}_onTickCheckTimeReached(e,t){e>=this.pv.reachedTime?this._timeReached||(this._timeReached=!0,this.dispatchEventToOutput("timeReached",{})):this._timeReached=!1}_onTickEvent(){this.dispatchEventToOutput("tick",{})}_updateTimeDependency(){var e,t;let r=this.scene().timeController.graphNode;if((e=this._graphNode)==null||e.removeGraphInput(r),!!this.pv.active&&(this.pv.treachedTime||this.pv.tick)){this._graphNode=this._graphNode||new Yt(this.scene(),"sceneNodeTimeGraphNode"),this._graphNode.addGraphInput(r);let o={tick:this.pv.tick,treachedTime:this.pv.treachedTime,reachedTime:this.pv.reachedTime},n=(t=this._buildOnTickCallback(o))==null?void 0:t.bind(this);if(n){let s="timeUpdate";this._graphNode.removePostDirtyHook(s),this._graphNode.addPostDirtyHook(s,n)}}}_buildOnTickCallback(e){if(e.treachedTime&&e.tick)return()=>{let t=this.scene().time();this._onTickEvent(),this._onTickCheckTimeReached(t,e.reachedTime)};if(e.treachedTime)return()=>{let t=this.scene().time();this._onTickCheckTimeReached(t,e.reachedTime)};if(e.tick)return this._onTickEvent.bind(this)}static PARAM_CALLBACK_setFrame(e){e._onSetFrame({})}static PARAM_CALLBACK_updateTimeDependency(e){e._updateTimeDependency()}static PARAM_CALLBACK_updateSceneEventsController(e){e._updateSceneEventsController()}static PARAM_CALLBACK_updateActiveState(e){e._updateTimeDependency(),e._updateSceneEventsController()}_updateSceneEventsController(){let e=this.scene().eventsDispatcher.sceneEventsController;e.removeObserverFromAllEventTypes(this),!!this.pv.active&&(this._updateTimeDependency(),this.pv.sceneLoaded&&e.addObserver(this,oc.LOADED),this.pv.play&&e.addObserver(this,oc.PLAY),this.pv.pause&&e.addObserver(this,oc.PAUSE))}};var _0=["boolean","button","number","vector2","vector3","vector4","string"],lk=_0.indexOf("boolean"),H7=_0.indexOf("number"),uk=_0.indexOf("vector2"),pk=_0.indexOf("vector3"),hk=_0.indexOf("vector4"),Qee=_0.indexOf("string");function qc(){return{cook:!1}}var dk="output",fk=class extends V{constructor(){super(...arguments);this.param=v.PARAM_PATH("",{paramSelection:!0,computeOnDirty:!0}),this.type=v.INTEGER(H7,{menu:{entries:_0.map((e,t)=>({name:e,value:t}))}}),this.toggle=v.BOOLEAN(0,{visibleIf:{type:lk}}),this.boolean=v.BOOLEAN(0,{visibleIf:{type:lk,toggle:0},...qc()}),this.number=v.FLOAT(0,{visibleIf:{type:H7},...qc()}),this.vector2=v.VECTOR2([0,0],{visibleIf:{type:uk},...qc()}),this.vector3=v.VECTOR3([0,0,0],{visibleIf:{type:pk},...qc()}),this.vector4=v.VECTOR4([0,0,0,0],{visibleIf:{type:hk},...qc()}),this.increment=v.BOOLEAN(0,{visibleIf:[{type:H7},{type:uk},{type:pk},{type:hk}],...qc()}),this.string=v.STRING("",{visibleIf:{type:Qee},...qc()}),this.execute=v.BUTTON(null,{callback:e=>{a9.PARAM_CALLBACK_execute(e)}})}},ete=new fk,a9=class extends _o{constructor(){super(...arguments);this.paramsConfig=ete,this._tmp_vector2=new G,this._tmp_vector3=new w,this._tmp_vector4=new Ie,this._tmp_array2=[0,0],this._tmp_array3=[0,0,0],this._tmp_array4=[0,0,0,0]}static type(){return"setParam"}initializeNode(){this.io.inputs.setNamedInputConnectionPoints([new Je("trigger",Ke.BASE)]),this.io.outputs.setNamedOutputConnectionPoints([new Je(dk,Ke.BASE)])}setParamType(e){let t=_0.indexOf(e);this.p.type.set(t)}async processEvent(e){this.p.param.isDirty()&&await this.p.param.compute();let t=this.p.param.value.param();if(t){let r=await this._newParamValue(t);r!=null&&t.set(r)}else this.states.error.set("target param not found");this.dispatchEventToOutput(dk,e)}async _newParamValue(e){let t=_0[this.pv.type];switch(t){case"boolean":return await this._computeParamsIfDirty([this.p.toggle]),this.pv.toggle?e.value?0:1:this.pv.boolean?1:0;case"button":return e.options.executeCallback();case"number":return await this._computeParamsIfDirty([this.p.increment,this.p.number]),this.pv.increment?e.type()==J.FLOAT?e.value+this.pv.number:e.value:this.pv.number;case"vector2":return await this._computeParamsIfDirty([this.p.increment,this.p.vector2]),this.pv.increment?e.type()==J.VECTOR2?(this._tmp_vector2.copy(e.value),this._tmp_vector2.add(this.pv.vector2),this._tmp_vector2.toArray(this._tmp_array2)):e.value.toArray(this._tmp_array2):this.pv.vector2.toArray(this._tmp_array2),this._tmp_array2;case"vector3":return await this._computeParamsIfDirty([this.p.increment,this.p.vector3]),this.pv.increment?e.type()==J.VECTOR3?(this._tmp_vector3.copy(e.value),this._tmp_vector3.add(this.pv.vector3),this._tmp_vector3.toArray(this._tmp_array3)):e.value.toArray(this._tmp_array3):this.pv.vector3.toArray(this._tmp_array3),this._tmp_array3;case"vector4":return await this._computeParamsIfDirty([this.p.increment,this.p.vector4]),this.pv.increment?e.type()==J.VECTOR4?(this._tmp_vector4.copy(e.value),this._tmp_vector4.add(this.pv.vector4),this._tmp_vector4.toArray(this._tmp_array4)):e.value.toArray(this._tmp_array4):this.pv.vector4.toArray(this._tmp_array4),this._tmp_array4;case"string":return await this._computeParamsIfDirty([this.p.string]),this.pv.string}Be.unreachable(t)}static PARAM_CALLBACK_execute(e){e.processEvent({})}async _computeParamsIfDirty(e){let t=[];for(let o of e)o.isDirty()&&t.push(o);let r=[];for(let o of t)r.push(o.compute());return await Promise.all(r)}};var Rk=bn(Pk()),W7={callback:i=>{c9.PARAM_CALLBACK_resetDebouncedFunc(i)}},Lk=class extends V{constructor(){super(...arguments);this.time=v.INTEGER(100,{range:[0,1e3],rangeLocked:[!0,!1],...W7}),this.leading=v.BOOLEAN(!0,W7),this.trailing=v.BOOLEAN(!0,W7)}},Mte=new Lk,q7=class extends _o{constructor(){super(...arguments);this.paramsConfig=Mte}static type(){return"throttle"}initializeNode(){this.io.inputs.setNamedInputConnectionPoints([new Je("trigger",Ke.BASE)]),this.io.outputs.setNamedOutputConnectionPoints([new Je(q7.OUTPUT_NAME,Ke.BASE)])}processEvent(i){this._lastEventContextReceived=i,this._debouncedFunc=this._debouncedFunc||this._buildDebouncedFunc(),this._debouncedFunc()}_buildDebouncedFunc(){let{leading:i,trailing:e,time:t}=this.pv;return(0,Rk.default)(()=>{this._lastEventContextReceived&&this.dispatchEventToOutput(q7.OUTPUT_NAME,this._lastEventContextReceived)},t,{leading:i,trailing:e})}_resetDebouncedFunc(){this._debouncedFunc=void 0}static PARAM_CALLBACK_resetDebouncedFunc(i){i._resetDebouncedFunc()}},c9=q7;c9.OUTPUT_NAME="output";var g0=class extends dr{constructor(){super(...arguments);this._cook_main_without_inputs_when_dirty_bound=this._cook_main_without_inputs_when_dirty.bind(this)}static context(){return oe.MAT}initializeBaseNode(){super.initializeBaseNode(),this.nameController.add_post_set_fullPath_hook(this.set_material_name.bind(this)),this.addPostDirtyHook("_cook_main_without_inputs_when_dirty",()=>{setTimeout(this._cook_main_without_inputs_when_dirty_bound,0)})}async _cook_main_without_inputs_when_dirty(){await this.cookController.cookMainWithoutInputs()}set_material_name(){this._material&&(this._material.name=this.path())}get material(){return this._material=this._material||this.createMaterial()}setMaterial(e){this._setContainer(e)}};var Ir=class{constructor(e){this.node=e}update(){}get material(){return this.node.material}};function X7(i,e){let t=e.front?oo:Dt,r=e.doubleSided?uo:t;if(r!=i.side&&(i.side=r,i.needsUpdate=!0),e.overrideShadowSide){let n=e.shadowFront?oo:Dt,s=e.shadowDoubleSided?uo:n;s!=i.shadowSide&&(i.shadowSide=s,i.needsUpdate=!0)}else i.shadowSide=null;let o=i.customMaterials;if(o){let n=Object.keys(o);for(let s of n){let a=o[s];a&&X7(a,e)}}}var Ik={NoBlending:ri,NormalBlending:Za,AdditiveBlending:sh,SubtractiveBlending:ah,MultiplyBlending:ch},Nte=Object.keys(Ik);function Ao(i){return class extends i{constructor(){super(...arguments);this.doubleSided=v.BOOLEAN(0),this.front=v.BOOLEAN(1,{visibleIf:{doubleSided:!1}}),this.overrideShadowSide=v.BOOLEAN(0),this.shadowDoubleSided=v.BOOLEAN(0,{visibleIf:{overrideShadowSide:!0}}),this.shadowFront=v.BOOLEAN(1,{visibleIf:{overrideShadowSide:!0,shadowDoubleSided:!1}}),this.colorWrite=v.BOOLEAN(1,{separatorBefore:!0,cook:!1,callback:(t,r)=>{Vr.update(t)}}),this.depthWrite=v.BOOLEAN(1,{cook:!1,callback:(t,r)=>{Vr.update(t)}}),this.depthTest=v.BOOLEAN(1,{cook:!1,callback:(t,r)=>{Vr.update(t)}}),this.premultipliedAlpha=v.BOOLEAN(!1,{separatorAfter:!0}),this.blending=v.INTEGER(Za,{menu:{entries:Nte.map(t=>({name:t,value:Ik[t]}))}}),this.dithering=v.BOOLEAN(0),this.polygonOffset=v.BOOLEAN(!1,{separatorBefore:!0}),this.polygonOffsetFactor=v.INTEGER(0,{range:[0,1e3],visibleIf:{polygonOffset:1}}),this.polygonOffsetUnits=v.INTEGER(0,{range:[0,1e3],visibleIf:{polygonOffset:1}})}}}var Ote=class extends Ao(V){};var Vr=class extends Ir{constructor(e){super(e);this.node=e}initializeNode(){}async update(){let e=this.node.material,t=this.node.pv;this._updateSides(e,t),e.colorWrite=t.colorWrite,e.depthWrite=t.depthWrite,e.depthTest=t.depthTest,e.blending=t.blending,e.premultipliedAlpha=t.premultipliedAlpha,e.dithering=t.dithering,e.polygonOffset=t.polygonOffset,e.polygonOffset&&(e.polygonOffsetFactor=t.polygonOffsetFactor,e.polygonOffsetUnits=t.polygonOffsetUnits,e.needsUpdate=!0)}_updateSides(e,t){X7(e,t)}static async update(e){e.controllers.advancedCommon.update()}};var Dk=class extends Ao(V){constructor(){super(...arguments);this.color=v.COLOR([1,1,1]),this.lineWidth=v.FLOAT(1,{range:[1,10],rangeLocked:[!0,!1]})}},Pte=new Dk,Y7=class extends g0{constructor(){super(...arguments);this.paramsConfig=Pte,this.controllers={advancedCommon:new Vr(this)},this.controllerNames=Object.keys(this.controllers)}static type(){return"lineBasic"}createMaterial(){return new ur({color:16777215,linewidth:1})}initializeNode(){this.params.onParamsCreated("init controllers",()=>{for(let e of this.controllerNames)this.controllers[e].initializeNode()})}async cook(){for(let e of this.controllerNames)this.controllers[e].update();this.material.color.copy(this.pv.color),this.material.linewidth=this.pv.lineWidth,this.material.needsUpdate=!0,console.log(this.material),this.setMaterial(this.material)}};function jn(i){return class extends i{constructor(){super(...arguments);this.transparent=v.BOOLEAN(0),this.opacity=v.FLOAT(1),this.alphaTest=v.FLOAT(0)}}}var Rte=class extends jn(V){};var Wn=class extends Ir{constructor(e){super(e);this.node=e}static update(e){let t=e.material,r=e.pv;this._updateTransparency(t,r)}static _updateTransparency(e,t){e.transparent=t.transparent,this._updateCommon(e,t)}static _updateCommon(e,t){let r=e;r.uniforms&&r.uniforms.opacity&&(r.uniforms.opacity.value=t.opacity),e.opacity=t.opacity,r.uniforms&&r.uniforms.alphaTest&&(r.uniforms.alphaTest.value=t.alphaTest),e.alphaTest=t.alphaTest;let o=e.customMaterials;if(o){let n=Object.keys(o);for(let s of n){let a=o[s];a&&this._updateCommon(a,t)}}}};var $7={};S2($7,{LineBasicMaterial:()=>ur,LineDashedMaterial:()=>d9,Material:()=>Bt,MeshBasicMaterial:()=>si,MeshDepthMaterial:()=>Jl,MeshDistanceMaterial:()=>Zl,MeshLambertMaterial:()=>Lp,MeshMatcapMaterial:()=>h9,MeshNormalMaterial:()=>p9,MeshPhongMaterial:()=>ey,MeshPhysicalMaterial:()=>Qo,MeshStandardMaterial:()=>Ei,MeshToonMaterial:()=>u9,PointsMaterial:()=>Xs,RawShaderMaterial:()=>k0,ShaderMaterial:()=>Ar,ShadowMaterial:()=>l9,SpriteMaterial:()=>Rp});var l9=class extends Bt{constructor(e){super();this.type="ShadowMaterial",this.color=new he(0),this.transparent=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this}};l9.prototype.isShadowMaterial=!0;var Rp=class extends Bt{constructor(e){super();this.type="SpriteMaterial",this.color=new he(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this}};Rp.prototype.isSpriteMaterial=!0;var Qo=class extends Ei{constructor(e){super();this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new G(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return qs(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.sheenColor=new he(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=0,this.attenuationColor=new he(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new he(1,1,1),this.specularColorMap=null,this._sheen=0,this._clearcoat=0,this._transmission=0,this.setValues(e)}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}};Qo.prototype.isMeshPhysicalMaterial=!0;var u9=class extends Bt{constructor(e){super();this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new he(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new he(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ni,this.normalScale=new G(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this}};u9.prototype.isMeshToonMaterial=!0;var p9=class extends Bt{constructor(e){super();this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ni,this.normalScale=new G(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}};p9.prototype.isMeshNormalMaterial=!0;var Lp=class extends Bt{constructor(e){super();this.type="MeshLambertMaterial",this.color=new he(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new he(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Ll,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this}};Lp.prototype.isMeshLambertMaterial=!0;var h9=class extends Bt{constructor(e){super();this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new he(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ni,this.normalScale=new G(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this}};h9.prototype.isMeshMatcapMaterial=!0;var d9=class extends ur{constructor(e){super();this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}};d9.prototype.isLineDashedMaterial=!0;var of=class extends io{constructor(e){super(e);this.textures={}}load(e,t,r,o){let n=this,s=new Ho(n.manager);s.setPath(n.path),s.setRequestHeader(n.requestHeader),s.setWithCredentials(n.withCredentials),s.load(e,function(a){try{t(n.parse(JSON.parse(a)))}catch(c){o?o(c):console.error(c),n.manager.itemError(e)}},r,o)}parse(e){let t=this.textures;function r(n){return t[n]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",n),t[n]}let o=new $7[e.type];if(e.uuid!==void 0&&(o.uuid=e.uuid),e.name!==void 0&&(o.name=e.name),e.color!==void 0&&o.color!==void 0&&o.color.setHex(e.color),e.roughness!==void 0&&(o.roughness=e.roughness),e.metalness!==void 0&&(o.metalness=e.metalness),e.sheen!==void 0&&(o.sheen=e.sheen),e.sheenColor!==void 0&&(o.sheenColor=new he().setHex(e.sheenColor)),e.sheenRoughness!==void 0&&(o.sheenRoughness=e.sheenRoughness),e.emissive!==void 0&&o.emissive!==void 0&&o.emissive.setHex(e.emissive),e.specular!==void 0&&o.specular!==void 0&&o.specular.setHex(e.specular),e.specularIntensity!==void 0&&(o.specularIntensity=e.specularIntensity),e.specularColor!==void 0&&o.specularColor!==void 0&&o.specularColor.setHex(e.specularColor),e.shininess!==void 0&&(o.shininess=e.shininess),e.clearcoat!==void 0&&(o.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(o.clearcoatRoughness=e.clearcoatRoughness),e.transmission!==void 0&&(o.transmission=e.transmission),e.thickness!==void 0&&(o.thickness=e.thickness),e.attenuationDistance!==void 0&&(o.attenuationDistance=e.attenuationDistance),e.attenuationColor!==void 0&&o.attenuationColor!==void 0&&o.attenuationColor.setHex(e.attenuationColor),e.fog!==void 0&&(o.fog=e.fog),e.flatShading!==void 0&&(o.flatShading=e.flatShading),e.blending!==void 0&&(o.blending=e.blending),e.combine!==void 0&&(o.combine=e.combine),e.side!==void 0&&(o.side=e.side),e.shadowSide!==void 0&&(o.shadowSide=e.shadowSide),e.opacity!==void 0&&(o.opacity=e.opacity),e.transparent!==void 0&&(o.transparent=e.transparent),e.alphaTest!==void 0&&(o.alphaTest=e.alphaTest),e.depthTest!==void 0&&(o.depthTest=e.depthTest),e.depthWrite!==void 0&&(o.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(o.colorWrite=e.colorWrite),e.stencilWrite!==void 0&&(o.stencilWrite=e.stencilWrite),e.stencilWriteMask!==void 0&&(o.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(o.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(o.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(o.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(o.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(o.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(o.stencilZPass=e.stencilZPass),e.wireframe!==void 0&&(o.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(o.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(o.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(o.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(o.rotation=e.rotation),e.linewidth!==1&&(o.linewidth=e.linewidth),e.dashSize!==void 0&&(o.dashSize=e.dashSize),e.gapSize!==void 0&&(o.gapSize=e.gapSize),e.scale!==void 0&&(o.scale=e.scale),e.polygonOffset!==void 0&&(o.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(o.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(o.polygonOffsetUnits=e.polygonOffsetUnits),e.dithering!==void 0&&(o.dithering=e.dithering),e.alphaToCoverage!==void 0&&(o.alphaToCoverage=e.alphaToCoverage),e.premultipliedAlpha!==void 0&&(o.premultipliedAlpha=e.premultipliedAlpha),e.visible!==void 0&&(o.visible=e.visible),e.toneMapped!==void 0&&(o.toneMapped=e.toneMapped),e.userData!==void 0&&(o.userData=e.userData),e.vertexColors!==void 0&&(typeof e.vertexColors=="number"?o.vertexColors=e.vertexColors>0:o.vertexColors=e.vertexColors),e.uniforms!==void 0)for(let n in e.uniforms){let s=e.uniforms[n];switch(o.uniforms[n]={},s.type){case"t":o.uniforms[n].value=r(s.value);break;case"c":o.uniforms[n].value=new he().setHex(s.value);break;case"v2":o.uniforms[n].value=new G().fromArray(s.value);break;case"v3":o.uniforms[n].value=new w().fromArray(s.value);break;case"v4":o.uniforms[n].value=new Ie().fromArray(s.value);break;case"m3":o.uniforms[n].value=new zo().fromArray(s.value);break;case"m4":o.uniforms[n].value=new Ve().fromArray(s.value);break;default:o.uniforms[n].value=s.value}}if(e.defines!==void 0&&(o.defines=e.defines),e.vertexShader!==void 0&&(o.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(o.fragmentShader=e.fragmentShader),e.extensions!==void 0)for(let n in e.extensions)o.extensions[n]=e.extensions[n];if(e.shading!==void 0&&(o.flatShading=e.shading===1),e.size!==void 0&&(o.size=e.size),e.sizeAttenuation!==void 0&&(o.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(o.map=r(e.map)),e.matcap!==void 0&&(o.matcap=r(e.matcap)),e.alphaMap!==void 0&&(o.alphaMap=r(e.alphaMap)),e.bumpMap!==void 0&&(o.bumpMap=r(e.bumpMap)),e.bumpScale!==void 0&&(o.bumpScale=e.bumpScale),e.normalMap!==void 0&&(o.normalMap=r(e.normalMap)),e.normalMapType!==void 0&&(o.normalMapType=e.normalMapType),e.normalScale!==void 0){let n=e.normalScale;Array.isArray(n)===!1&&(n=[n,n]),o.normalScale=new G().fromArray(n)}return e.displacementMap!==void 0&&(o.displacementMap=r(e.displacementMap)),e.displacementScale!==void 0&&(o.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(o.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(o.roughnessMap=r(e.roughnessMap)),e.metalnessMap!==void 0&&(o.metalnessMap=r(e.metalnessMap)),e.emissiveMap!==void 0&&(o.emissiveMap=r(e.emissiveMap)),e.emissiveIntensity!==void 0&&(o.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(o.specularMap=r(e.specularMap)),e.specularIntensityMap!==void 0&&(o.specularIntensityMap=r(e.specularIntensityMap)),e.specularColorMap!==void 0&&(o.specularColorMap=r(e.specularColorMap)),e.envMap!==void 0&&(o.envMap=r(e.envMap)),e.envMapIntensity!==void 0&&(o.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(o.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(o.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(o.lightMap=r(e.lightMap)),e.lightMapIntensity!==void 0&&(o.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(o.aoMap=r(e.aoMap)),e.aoMapIntensity!==void 0&&(o.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(o.gradientMap=r(e.gradientMap)),e.clearcoatMap!==void 0&&(o.clearcoatMap=r(e.clearcoatMap)),e.clearcoatRoughnessMap!==void 0&&(o.clearcoatRoughnessMap=r(e.clearcoatRoughnessMap)),e.clearcoatNormalMap!==void 0&&(o.clearcoatNormalMap=r(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(o.clearcoatNormalScale=new G().fromArray(e.clearcoatNormalScale)),e.transmissionMap!==void 0&&(o.transmissionMap=r(e.transmissionMap)),e.thicknessMap!==void 0&&(o.thicknessMap=r(e.thicknessMap)),e.sheenColorMap!==void 0&&(o.sheenColorMap=r(e.sheenColorMap)),e.sheenRoughnessMap!==void 0&&(o.sheenRoughnessMap=r(e.sheenRoughnessMap)),o}setTextures(e){return this.textures=e,this}};var nf=class{constructor(e){this.node=e}toJSON(){}load(e){}_materialToJson(e,t){let r;return this._withPreparedMaterial(e,()=>{try{r=e.toJSON({}),r&&(r.shadowSide=e.shadowSide,r.colorWrite=e.colorWrite)}catch(o){console.error("failed to save material data"),console.log(e),console.log(o)}r&&e.lights!=null&&(r.lights=e.lights),r&&(r.uuid=`${t.node.path()}-${t.suffix}`)}),r}_withPreparedMaterial(e,t){this._withUnassignedUniformTextures(e,()=>{this._withUnassignedBasePropertyTextures(e,()=>{this._withUnassignedOnBeforeCompileData(e,()=>{t()})})})}_withUnassignedOnBeforeCompileData(e,t){let r=uu.removeUniforms(e),o=q0.removeData(e);t(),r&&uu.setUniforms(e,r),o&&q0.setData(e,o)}_withUnassignedUniformTextures(e,t){let r=new Map,o=e.uniforms;if(o){let n=Object.keys(o);for(let s of n){let a=o[s].value;if(a&&a.uuid){let c=a;r.set(s,c),o[s].value=null}}}t(),o&&r.forEach((n,s)=>{o[s].value=n})}_withUnassignedBasePropertyTextures(e,t){let r=new Map,o=Object.keys(e);for(let n of o){let s=e[n];s&&s.uuid&&s instanceof gr&&(r.set(n,s),e[n]=null)}t(),r.forEach((n,s)=>{e[s]=n})}_loadMaterial(e){e.color=void 0;let r=new of().parse(e);e.shadowSide&&(r.shadowSide=e.shadowSide),e.lights!=null&&(r.lights=e.lights);let o=r.uniforms;if(o){let n=o.uv2Transform;n&&this.mat4ToMat3(n);let s=o.uvTransform;s&&this.mat4ToMat3(s)}return r}mat4ToMat3(e){let t=e.value;if(t.elements[t.elements.length-1]==null){let o=new zo;for(let n=0;n<o.elements.length;n++)o.elements[n]=t.elements[n];e.value=o}}};var K7=class extends nf{constructor(e){super(e);this.node=e}toJSON(){let e=this.node.assemblerController();if(!e)return;let t=e.assembler,r=t.onBeforeCompileData();if(!r)return;let o=W0.toJSON(r),n={},s=this.node.material.customMaterials;s&&t.traverseCustomAssemblers((l,u)=>{let p=l.onBeforeCompileData();if(p){let h=s[u];if(h){let d=this._materialToJson(h,{node:this.node,suffix:u});d&&(n[u]={material:d,onBeforeCompileDataJSON:W0.toJSON(p)})}}});let a=this._materialToJson(this.node.material,{node:this.node,suffix:"main"});return a||console.warn("failed to save material from node",this.node.path()),{material:a||{},onBeforeCompileDataJSON:o,customMaterials:n}}load(e){if(this.node.assemblerController()||(this._material=this._loadMaterial(e.material),!this._material))return;let r=W0.fromJSON(e.onBeforeCompileDataJSON),o=this._material;v1(this.node.scene(),o,r);for(let n of r.paramConfigs)n.applyToNode(this.node);if(this._material.customMaterials=this._material.customMaterials||{},e.customMaterials){let n=Object.keys(e.customMaterials);for(let s of n){let a=e.customMaterials[s],c=this._loadMaterial(a.material);if(c){let l=W0.fromJSON(a.onBeforeCompileDataJSON);l.paramConfigs=r.paramConfigs,v1(this.node.scene(),c,l),this._material.customMaterials[s]=c}}}}material(){return this._material}};function qn(i){return class extends i{constructor(){super(...arguments);this.setBuilderNode=v.BOOLEAN(0,{callback:t=>{Ui.PARAM_CALLBACK_setCompileRequired(t)}}),this.builderNode=v.NODE_PATH("",{visibleIf:{setBuilderNode:!0},callback:t=>{Ui.PARAM_CALLBACK_setCompileRequired(t)}})}}}var Lte=class extends qn(V){},Ui=class extends g0{constructor(){super(...arguments);this._childrenControllerContext=oe.GL,this.persisted_config=new K7(this)}createMaterial(){var e;let t;return this.persisted_config&&(t=this.persisted_config.material()),t||(t=(e=this.assemblerController())==null?void 0:e.assembler.createMaterial()),t}assemblerController(){return this._assemblerController=this._assemblerController||this._createAssemblerController()}createNode(e,t){return super.createNode(e,t)}children(){return super.children()}nodesByType(e){return super.nodesByType(e)}childrenAllowed(){return this.assemblerController()?super.childrenAllowed():(this.scene().markAsReadOnly(this),!1)}compileIfRequired(){var e;if((e=this.assemblerController())==null?void 0:e.compileRequired())try{this._compile()}catch(t){let r=t.message||"failed to compile";this.states.error.set(r)}}_compile(){let e=this.assemblerController();this.material&&e&&(e.assembler.setGlParentNode(this),this._setAssemblerGlParentNode(e),e.assembler.compileMaterial(this.material),e.post_compile())}_setAssemblerGlParentNode(e){if(!this.pv.setBuilderNode)return;let t=this.pv.builderNode.nodeWithContext(oe.MAT);if(!t)return;let r=t;if(!r.assemblerController()){this.states.error.set(`resolved node '${t.path()}' is not a builder node`);return}if(r.type()!=this.type()){this.states.error.set(`resolved node '${t.path()}' does not have the same type '${t.type()}' as current node '${this.type()}'`);return}e.assembler.setGlParentNode(r)}static PARAM_CALLBACK_setCompileRequired(e){e.PARAM_CALLBACK_setCompileRequired()}PARAM_CALLBACK_setCompileRequired(){var e;(e=this.assemblerController())==null||e.setCompilationRequired(!0)}};function Xn(i){return class extends i{constructor(){super(...arguments);this.useFog=v.BOOLEAN(0)}}}var Ite=class extends Xn(V){};var Yn=class extends Ir{constructor(e){super(e);this.node=e}static update(e){let t=e.material,r=e.pv;t.fog=r.useFog}};function _i(i){return class extends i{constructor(){super(...arguments);this.default=v.FOLDER(null)}}}function gi(i){return class extends i{constructor(){super(...arguments);this.advanced=v.FOLDER(null)}}}var kk=class extends Xn(Ao(qn(gi(jn(_i(V)))))){constructor(){super(...arguments);this.linewidth=v.FLOAT(1,{range:[0,10],rangeLocked:[!0,!1]})}},Dte=new kk,J7=class extends Ui{constructor(){super(...arguments);this.paramsConfig=Dte,this.controllers={advancedCommon:new Vr(this)},this.controllerNames=Object.keys(this.controllers)}static type(){return"lineBasicBuilder"}usedAssembler(){return Ai.GL_LINE}_createAssemblerController(){return Q.assemblersRegister.assembler(this,this.usedAssembler())}initializeNode(){this.params.onParamsCreated("init controllers",()=>{for(let e of this.controllerNames)this.controllers[e].initializeNode()})}async cook(){for(let e of this.controllerNames)this.controllers[e].update();Wn.update(this),Yn.update(this),this.compileIfRequired(),this.material.linewidth=this.pv.linewidth,this.setMaterial(this.material)}};function sf(i){return class extends i{constructor(){super(...arguments);this.color=v.COLOR([1,1,1],{conversion:Io.SRGB_TO_LINEAR}),this.useVertexColors=v.BOOLEAN(0,{separatorAfter:!0}),this.transparent=v.BOOLEAN(0),this.opacity=v.FLOAT(1),this.alphaTest=v.FLOAT(0)}}}var kte=class extends sf(V){};var af=class extends Ir{constructor(e){super(e);this.node=e}static update(e){let t=e.material,r=e.pv;t.color.copy(r.color);let o=r.useVertexColors;o!=t.vertexColors&&(t.vertexColors=o,t.needsUpdate=!0),t.opacity=r.opacity,t.transparent=r.transparent,t.alphaTest=r.alphaTest}};function cf(i){return class extends i{constructor(){super(...arguments);this.useFog=v.BOOLEAN(0)}}}var Bte=class extends cf(V){};var lf=class extends Ir{constructor(e){super(e);this.node=e}static update(e){let t=e.material,r=e.pv;t.fog=r.useFog}};function rr(i){return{cook:!1,callback:(e,t)=>{i.update(e)}}}function zt(i,e,t){return{visibleIf:{[e]:1},nodeSelection:{context:oe.COP,types:t==null?void 0:t.types},cook:!1,callback:(r,o)=>{i.update(r)}}}var fr=class extends Ir{constructor(e){super(e);this.node=e}add_hooks(e,t){e.addPostDirtyHook("TextureController",()=>{this.update()}),t.addPostDirtyHook("TextureController",()=>{this.update()})}static update(e){}async _update(e,t,r,o){let n=e,s=t;await this._update_texture_on_material(n,s,r,o)}async _update_texture_on_material(e,t,r,o){this._update_required_attribute(e,e,t,r,o,this._apply_texture_on_material.bind(this),this._remove_texture_from_material.bind(this))}_apply_texture_on_material(e,t,r,o){let n=t[r],s=!1;n&&n.uuid!=o.uuid&&(s=!0),(n==null||s)&&(t[r]=o,e.needsUpdate=!0)}_remove_texture_from_material(e,t,r){t[r]&&(t[r]=null,e.needsUpdate=!0)}async _update_required_attribute(e,t,r,o,n,s,a){if(o.isDirty()&&await o.compute(),o.value){n.isDirty()&&await n.compute();let l=n.value.nodeWithContext(oe.COP);if(l){let p=(await l.compute()).texture();if(p){s(e,t,r,p);return}}}a(e,t,r)}};function $n(i){return class extends i{constructor(){super(...arguments);this.useMap=v.BOOLEAN(0,rr(Vi)),this.map=v.NODE_PATH("",zt(Vi,"useMap"))}}}var Fte=class extends $n(V){};var Vi=class extends fr{constructor(e){super(e);this.node=e}initializeNode(){this.add_hooks(this.node.p.useMap,this.node.p.map)}async update(){this._update(this.node.material,"map",this.node.p.useMap,this.node.p.map)}static async update(e){e.controllers.map.update()}};function Kn(i){return class extends i{constructor(){super(...arguments);this.useAlphaMap=v.BOOLEAN(0,{separatorBefore:!0,...rr(Gi)}),this.alphaMap=v.NODE_PATH("",zt(Gi,"useAlphaMap"))}}}var Ute=class extends Kn(V){};var Gi=class extends fr{constructor(e){super(e);this.node=e}initializeNode(){this.add_hooks(this.node.p.useAlphaMap,this.node.p.alphaMap)}async update(){this._update(this.node.material,"alphaMap",this.node.p.useAlphaMap,this.node.p.alphaMap)}static async update(e){e.controllers.alphaMap.update()}};function Jn(i){return class extends i{constructor(){super(...arguments);this.useAOMap=v.BOOLEAN(0,{separatorBefore:!0,...rr(zi)}),this.aoMap=v.NODE_PATH("",zt(zi,"useAOMap")),this.aoMapIntensity=v.FLOAT(1,{range:[0,1],rangeLocked:[!1,!1],visibleIf:{useAOMap:1}})}}}var Vte=class extends Jn(V){};var zi=class extends fr{constructor(e){super(e);this.node=e}initializeNode(){this.add_hooks(this.node.p.useAOMap,this.node.p.aoMap)}async update(){this._update(this.node.material,"aoMap",this.node.p.useAOMap,this.node.p.aoMap);let e=this.node.material;e.aoMapIntensity=this.node.pv.aoMapIntensity}static async update(e){e.controllers.aoMap.update()}};var Z7=(i=>(i.CUBE_CAMERA="cubeCamera",i.VIDEO="video",i.WEB_CAM="webCam",i.SNAPSHOT="snapshot",i))(Z7||{});var Bk=["mult","add","mix"],Gte={mult:Ll,add:pm,mix:um};function Xc(i){return class extends i{constructor(){super(...arguments);this.useEnvMap=v.BOOLEAN(0,{separatorBefore:!0,...rr(v0)}),this.envMap=v.NODE_PATH("",zt(v0,"useEnvMap",{types:[Z7.CUBE_CAMERA]})),this.combine=v.INTEGER(0,{visibleIf:{useEnvMap:1},menu:{entries:Bk.map((t,r)=>({name:t,value:r}))}}),this.reflectivity=v.FLOAT(1,{visibleIf:{useEnvMap:1}}),this.refractionRatio=v.FLOAT(.98,{range:[-1,1],rangeLocked:[!1,!1],visibleIf:{useEnvMap:1}})}}}var zte=class extends Xc(V){};var v0=class extends fr{constructor(e){super(e);this.node=e}initializeNode(){this.add_hooks(this.node.p.useEnvMap,this.node.p.envMap)}async update(){this._update(this.node.material,"envMap",this.node.p.useEnvMap,this.node.p.envMap);let e=Gte[Bk[this.node.pv.combine]],t=this.node.material;t.combine=e,t.reflectivity=this.node.pv.reflectivity,t.refractionRatio=this.node.pv.refractionRatio}static async update(e){e.controllers.envMap.update()}};function x0(i){return class extends i{constructor(){super(...arguments);this.useLightMap=v.BOOLEAN(0,{separatorBefore:!0,...rr(Zn)}),this.lightMap=v.NODE_PATH("",zt(Zn,"useLightMap")),this.lightMapIntensity=v.FLOAT(1,{visibleIf:{useLightMap:1}})}}}var Hte=class extends x0(V){};var Zn=class extends fr{constructor(e){super(e);this.node=e}initializeNode(){this.add_hooks(this.node.p.useLightMap,this.node.p.lightMap)}async update(){this._update(this.node.material,"lightMap",this.node.p.useLightMap,this.node.p.lightMap);let e=this.node.material;e.lightMapIntensity=this.node.pv.lightMapIntensity}static async update(e){e.controllers.lightMap.update()}};var Fk=["round","butt","square"];var Uk=["round","bevel","miter"];function uf(i){return class extends i{constructor(){super(...arguments);this.wireframe=v.BOOLEAN(0,{separatorBefore:!0}),this.wireframeLinecap=v.INTEGER(0,{menu:{entries:Fk.map((t,r)=>({name:t,value:r}))},visibleIf:{wireframe:1}}),this.wireframeLinejoin=v.INTEGER(0,{menu:{entries:Uk.map((t,r)=>({name:t,value:r}))},visibleIf:{wireframe:1}})}}}var jte=class extends uf(V){};var pf=class extends Ir{constructor(e){super(e);this.node=e}static update(e){let t=e.material,r=e.pv;t.wireframe=r.wireframe,t.wireframeLinecap=Fk[r.wireframeLinecap],t.wireframeLinejoin=Uk[r.wireframeLinejoin],t.needsUpdate=!0}};function Ds(i){return class extends i{constructor(){super(...arguments);this.textures=v.FOLDER(null)}}}var Vk=class extends cf(uf(Ao(gi(x0(Xc(Jn(Kn($n(Ds(sf(_i(V)))))))))))){},Wte=new Vk,Q7=class extends g0{constructor(){super(...arguments);this.paramsConfig=Wte,this.controllers={advancedCommon:new Vr(this),alphaMap:new Gi(this),aoMap:new zi(this),envMap:new v0(this),lightMap:new Zn(this),map:new Vi(this)},this.controllerNames=Object.keys(this.controllers)}static type(){return"meshBasic"}createMaterial(){return new si({vertexColors:!1,side:oo,color:16777215,opacity:1})}initializeNode(){this.params.onParamsCreated("init controllers",()=>{for(let e of this.controllerNames)this.controllers[e].initializeNode()})}async cook(){for(let e of this.controllerNames)this.controllers[e].update();af.update(this),lf.update(this),pf.update(this),this.setMaterial(this.material)}};function Yc(i){return class extends i{constructor(){super(...arguments);this.wireframe=v.BOOLEAN(0)}}}var qte=class extends Yc(V){};var $c=class extends Ir{constructor(e){super(e);this.node=e}static update(e){let t=e.material,r=e.pv,o=t;o.wireframe!=null&&(o.wireframe=r.wireframe,o.needsUpdate=!0)}};var Gk=class extends Xn(Yc(Ao(qn(gi(Xc(Jn(Kn($n(Ds(jn(_i(V)))))))))))){},Xte=new Gk,eg=class extends Ui{constructor(){super(...arguments);this.paramsConfig=Xte,this.controllers={advancedCommon:new Vr(this),alphaMap:new Gi(this),aoMap:new zi(this),envMap:new v0(this),map:new Vi(this)},this.controllerNames=Object.keys(this.controllers)}static type(){return"meshBasicBuilder"}usedAssembler(){return Ai.GL_MESH_BASIC}_createAssemblerController(){return Q.assemblersRegister.assembler(this,this.usedAssembler())}initializeNode(){this.params.onParamsCreated("init controllers",()=>{for(let e of this.controllerNames)this.controllers[e].initializeNode()})}async cook(){for(let e of this.controllerNames)this.controllers[e].update();Wn.update(this),Yn.update(this),$c.update(this),this.compileIfRequired(),this.setMaterial(this.material)}};function Kc(i){return class extends i{constructor(){super(...arguments);this.emissive=v.COLOR([0,0,0],{separatorBefore:!0}),this.useEmissiveMap=v.BOOLEAN(0,rr(y0)),this.emissiveMap=v.NODE_PATH("",zt(y0,"useEmissiveMap")),this.emissiveIntensity=v.FLOAT(1)}}}var Yte=class extends Kc(V){};var y0=class extends fr{constructor(e){super(e);this.node=e}initializeNode(){this.add_hooks(this.node.p.useEmissiveMap,this.node.p.emissiveMap)}async update(){this._update(this.node.material,"emissiveMap",this.node.p.useEmissiveMap,this.node.p.emissiveMap);let e=this.node.material;e.emissive.copy(this.node.pv.emissive),e.emissiveIntensity=this.node.pv.emissiveIntensity}static async update(e){e.controllers.emissiveMap.update()}};var qk=bn(Hk()),Xk=bn(Wk());var Na=class{static any(e){return K.isString(e)?e:K.isBoolean(e)?`${e}`:K.isNumber(e)?`${Fe.ensureFloat(e)}`:K.isArray(e)?this.numeric_array(e):e instanceof G||e instanceof w||e instanceof Ie||e instanceof he?this.numeric_array(e.toArray()):`ThreeToGl error: unknown value type '${e}'`}static numeric_array(e){let t=new Array(e.length);for(let o=0;o<e.length;o++)t[o]=`${Fe.ensureFloat(e[o])}`;return`${`vec${e.length}`}(${t.join(", ")})`}static vector4(e){return K.isString(e)?e:`vec4(${e.toArray().map(r=>`${Fe.ensureFloat(r)}`).join(", ")})`}static vector3(e){return K.isString(e)?e:`vec3(${e.toArray().map(r=>`${Fe.ensureFloat(r)}`).join(", ")})`}static vector2(e){return K.isString(e)?e:`vec2(${e.toArray().map(r=>`${Fe.ensureFloat(r)}`).join(", ")})`}static vector3_float(e,t){return K.isNumber(t)&&(t=Fe.ensureFloat(t)),`vec4(${this.vector3(e)}, ${t})`}static float4(e,t,r,o){return K.isNumber(e)&&(e=Fe.ensureFloat(e)),K.isNumber(t)&&(t=Fe.ensureFloat(t)),K.isNumber(r)&&(r=Fe.ensureFloat(r)),K.isNumber(o)&&(o=Fe.ensureFloat(o)),`vec4(${e}, ${t}, ${r}, ${o})`}static float3(e,t,r){return K.isNumber(e)&&(e=Fe.ensureFloat(e)),K.isNumber(t)&&(t=Fe.ensureFloat(t)),K.isNumber(r)&&(r=Fe.ensureFloat(r)),`vec3(${e}, ${t}, ${r})`}static float2(e,t){return K.isNumber(e)&&(e=Fe.ensureFloat(e)),K.isNumber(t)&&(t=Fe.ensureFloat(t)),`vec2(${e}, ${t})`}static float(e){if(K.isNumber(e))return Fe.ensureFloat(e);{let t=parseFloat(e);return K.isNaN(t)?e:Fe.ensureFloat(t)}}static integer(e){if(K.isNumber(e))return Fe.ensureInteger(e);{let t=parseInt(e);return K.isNaN(t)?e:Fe.ensureInteger(t)}}static bool(e){return K.isBoolean(e)?`${e}`:e}};function hf(i){return class extends i{constructor(){super(...arguments);this.shadowPCSS=v.BOOLEAN(0,{callback:t=>{Oa.PARAM_CALLBACK_setRecompileRequired(t)},separatorBefore:!0}),this.shadowPCSSFilterSize=v.FLOAT(1,{visibleIf:{shadowPCSS:1},range:[0,10],rangeLocked:[!0,!1]})}}}var $te=class extends hf(V){};var Oa=class extends Ir{constructor(e){super(e);this.node=e}initializeNode(){}static filterFragmentShader(e,t){let r=`
#define PCSS_FILTER_SIZE ${Na.float(e.pv.shadowPCSSFilterSize)}
${qk.default}
`,o=Gm;return o=o.replace("#ifdef USE_SHADOWMAP",`#ifdef USE_SHADOWMAP
${r}
				`),o=o.replace("#if defined( SHADOWMAP_TYPE_PCF )",`
				${Xk.default}
				#if defined( SHADOWMAP_TYPE_PCF )`),t=t.replace("#include <shadowmap_pars_fragment>",o),t}async update(){var e,t;let r=this.node;if(!r.assemblerController)return;let o="PCSS";this.node.pv.shadowPCSS?(e=r.assemblerController())==null||e.addFilterFragmentShaderCallback(o,n=>Oa.filterFragmentShader(this.node,n)):(t=r.assemblerController())==null||t.removeFilterFragmentShaderCallback(o)}static async update(e){e.controllers.PCSS.update()}static PARAM_CALLBACK_setRecompileRequired(e){e.controllers.PCSS.update()}};var Yk=class extends hf(Xn(Yc(Ao(qn(gi(x0(Xc(Kc(Jn(Kn($n(Ds(jn(_i(V))))))))))))))){},Kte=new Yk,tg=class extends Ui{constructor(){super(...arguments);this.paramsConfig=Kte,this.controllers={advancedCommon:new Vr(this),alphaMap:new Gi(this),aoMap:new zi(this),emissiveMap:new y0(this),envMap:new v0(this),lightMap:new Zn(this),map:new Vi(this),PCSS:new Oa(this)},this.controllerNames=Object.keys(this.controllers)}static type(){return"meshLambertBuilder"}usedAssembler(){return Ai.GL_MESH_LAMBERT}_createAssemblerController(){return Q.assemblersRegister.assembler(this,this.usedAssembler())}initializeNode(){this.params.onParamsCreated("init controllers",()=>{for(let e of this.controllerNames)this.controllers[e].initializeNode()})}async cook(){for(let e of this.controllerNames)this.controllers[e].update();Wn.update(this),Yn.update(this),$c.update(this),this.compileIfRequired(),this.setMaterial(this.material)}};function df(i){return class extends i{constructor(){super(...arguments);this.useEnvMap=v.BOOLEAN(0,{separatorBefore:!0,...rr(Jc)}),this.envMap=v.NODE_PATH("",zt(Jc,"useEnvMap")),this.envMapIntensity=v.FLOAT(1,{visibleIf:{useEnvMap:1}}),this.refractionRatio=v.FLOAT(.98,{range:[-1,1],rangeLocked:[!1,!1],visibleIf:{useEnvMap:1}})}}}var Jte=class extends df(V){};var Jc=class extends fr{constructor(e){super(e);this.node=e}initializeNode(){this.add_hooks(this.node.p.useEnvMap,this.node.p.envMap)}async update(){this._update(this.node.material,"envMap",this.node.p.useEnvMap,this.node.p.envMap);let e=this.node.material;e.envMapIntensity=this.node.pv.envMapIntensity,e.refractionRatio=this.node.pv.refractionRatio}static async update(e){e.controllers.envMap.update()}};function ff(i){return class extends i{constructor(){super(...arguments);this.useBumpMap=v.BOOLEAN(0,{separatorBefore:!0,...rr(b0)}),this.bumpMap=v.NODE_PATH("",zt(b0,"useBumpMap")),this.bumpScale=v.FLOAT(1,{range:[0,1],rangeLocked:[!1,!1],...zt(b0,"useBumpMap")}),this.bumpBias=v.FLOAT(0,{range:[0,1],rangeLocked:[!1,!1],...zt(b0,"useBumpMap")})}}}var Zte=class extends ff(V){};var b0=class extends fr{constructor(e){super(e);this.node=e}initializeNode(){this.add_hooks(this.node.p.useBumpMap,this.node.p.bumpMap)}async update(){this._update(this.node.material,"bumpMap",this.node.p.useBumpMap,this.node.p.bumpMap);let e=this.node.material;e.bumpScale=this.node.pv.bumpScale}static async update(e){e.controllers.bumpMap.update()}};var $k=["tangent","object"],Qte={tangent:ni,object:Dm};function mf(i){return class extends i{constructor(){super(...arguments);this.useNormalMap=v.BOOLEAN(0,{separatorBefore:!0,...rr(Zc)}),this.normalMap=v.NODE_PATH("",zt(Zc,"useNormalMap")),this.normalMapType=v.INTEGER(0,{visibleIf:{useNormalMap:1},menu:{entries:$k.map((t,r)=>({name:t,value:r}))}}),this.normalScale=v.VECTOR2([1,1],{visibleIf:{useNormalMap:1}}),this.normalScaleMult=v.FLOAT(1,{range:[0,1],rangeLocked:[!1,!1],visibleIf:{useNormalMap:1}})}}}var ere=class extends mf(V){};var Zc=class extends fr{constructor(e){super(e);this.node=e}initializeNode(){this.add_hooks(this.node.p.useNormalMap,this.node.p.normalMap)}async update(){let{p:e,pv:t,material:r}=this.node;this._update(this.node.material,"normalMap",e.useNormalMap,e.normalMap);let o=Qte[$k[t.normalMapType]],n=r;n.normalMapType=o,n.normalScale.copy(t.normalScale).multiplyScalar(t.normalScaleMult)}static async update(e){e.controllers.normalMap.update()}};function _f(i){return class extends i{constructor(){super(...arguments);this.useMetalnessMap=v.BOOLEAN(0,{separatorBefore:!0,...rr(T0)}),this.metalnessMap=v.NODE_PATH("",zt(T0,"useMetalnessMap")),this.metalness=v.FLOAT(1),this.useRoughnessMap=v.BOOLEAN(0,{separatorBefore:!0,...rr(T0)}),this.roughnessMap=v.NODE_PATH("",zt(T0,"useRoughnessMap")),this.roughness=v.FLOAT(.5)}}}var tre=class extends _f(V){};var T0=class extends fr{constructor(e){super(e);this.node=e}initializeNode(){this.add_hooks(this.node.p.useMetalnessMap,this.node.p.metalnessMap)}async update(){this._update(this.node.material,"metalnessMap",this.node.p.useMetalnessMap,this.node.p.metalnessMap);let e=this.node.material;e.metalness=this.node.pv.metalness,this._update(this.node.material,"roughnessMap",this.node.p.useRoughnessMap,this.node.p.roughnessMap),e.roughness=this.node.pv.roughness}static async update(e){e.controllers.metalnessRoughnessMap.update()}};function rg(i){return class extends i{constructor(){super(...arguments);this.clearcoat=v.FLOAT(0,{separatorBefore:!0}),this.useClearCoatMap=v.BOOLEAN(0,rr(A0)),this.clearcoatMap=v.NODE_PATH("",zt(A0,"useClearCoatMap")),this.useClearCoatNormalMap=v.BOOLEAN(0,rr(A0)),this.clearcoatNormalMap=v.NODE_PATH("",zt(A0,"useClearCoatNormalMap")),this.clearcoatNormalScale=v.VECTOR2([1,1],{visibleIf:{useClearCoatNormalMap:1}}),this.clearcoatRoughness=v.FLOAT(0),this.useClearCoatRoughnessMap=v.BOOLEAN(0,rr(A0)),this.clearcoatRoughnessMap=v.NODE_PATH("",zt(A0,"useClearCoatRoughnessMap")),this.useSheen=v.BOOLEAN(0),this.sheen=v.FLOAT(0,{range:[0,1],rangeLocked:[!0,!1],visibleIf:{useSheen:1}}),this.sheenRoughness=v.FLOAT(1,{range:[0,1],rangeLocked:[!0,!1],visibleIf:{useSheen:1}}),this.sheenColor=v.COLOR([1,1,1],{visibleIf:{useSheen:1}}),this.transmission=v.FLOAT(0,{range:[0,1]}),this.useTransmissionMap=v.BOOLEAN(0),this.transmissionMap=v.NODE_PATH("",{visibleIf:{useTransmissionMap:1}}),this.ior=v.FLOAT(1.5,{range:[1,2.3333],rangeLocked:[!0,!0]}),this.thickness=v.FLOAT(.01,{range:[0,10],rangeLocked:[!0,!1]}),this.useThicknessMap=v.BOOLEAN(0),this.thicknessMap=v.NODE_PATH("",{visibleIf:{useThicknessMap:1}}),this.attenuationDistance=v.FLOAT(0,{range:[0,10],rangeLocked:[!0,!1]}),this.attenuationColor=v.COLOR([1,1,1])}}}var rre=class extends rg(V){};var Kk=new Qo,A0=class extends fr{constructor(e){super(e);this.node=e,this._sheenColorClone=new he}initializeNode(){this.add_hooks(this.node.p.useClearCoatMap,this.node.p.clearcoatMap),this.add_hooks(this.node.p.useClearCoatNormalMap,this.node.p.clearcoatNormalMap),this.add_hooks(this.node.p.useClearCoatRoughnessMap,this.node.p.clearcoatRoughnessMap),this.add_hooks(this.node.p.useTransmissionMap,this.node.p.transmissionMap),this.add_hooks(this.node.p.useThicknessMap,this.node.p.thicknessMap)}async update(){this._update(this.node.material,"clearcoatMap",this.node.p.useClearCoatMap,this.node.p.clearcoatMap),this._update(this.node.material,"clearcoatNormalMap",this.node.p.useClearCoatNormalMap,this.node.p.clearcoatNormalMap),this._update(this.node.material,"clearcoatRoughnessMap",this.node.p.useClearCoatRoughnessMap,this.node.p.clearcoatRoughnessMap),this._update(this.node.material,"transmissionMap",this.node.p.useTransmissionMap,this.node.p.transmissionMap),this._update(this.node.material,"thicknessMap",this.node.p.useThicknessMap,this.node.p.thicknessMap);let e=this.node.pv;Kk.ior=e.ior;let t=Kk.reflectivity,r=this.node.material;r.clearcoat=e.clearcoat,r.clearcoatNormalScale!=null&&r.clearcoatNormalScale.copy(e.clearcoatNormalScale),r.clearcoatRoughness=e.clearcoatRoughness,r.reflectivity=t,e.useSheen?(this._sheenColorClone.copy(e.sheenColor),r.sheen=e.sheen,r.sheenRoughness=e.sheenRoughness,r.sheenColor=this._sheenColorClone):r.sheen=0,r.transmission=e.transmission,r.thickness=e.thickness,r.attenuationDistance=e.attenuationDistance,r.attenuationColor=e.attenuationColor}static async update(e){e.controllers.physical.update()}};function gf(i){return class extends i{constructor(){super(...arguments);this.useDisplacementMap=v.BOOLEAN(0,{separatorBefore:!0,...rr(C0)}),this.displacementMap=v.NODE_PATH("",zt(C0,"useDisplacementMap")),this.displacementScale=v.FLOAT(1,{range:[0,1],rangeLocked:[!1,!1],...zt(C0,"useDisplacementMap")}),this.displacementBias=v.FLOAT(0,{range:[0,1],rangeLocked:[!1,!1],...zt(C0,"useDisplacementMap")})}}}var ore=class extends gf(V){};var C0=class extends fr{constructor(e){super(e);this.node=e}initializeNode(){this.add_hooks(this.node.p.useDisplacementMap,this.node.p.displacementMap)}async update(){this._update(this.node.material,"displacementMap",this.node.p.useDisplacementMap,this.node.p.displacementMap);let e=this.node.material;e.displacementScale=this.node.pv.displacementScale,e.displacementBias=this.node.pv.displacementBias}static async update(e){e.controllers.displacementMap.update()}};var Jk=class extends cf(uf(Ao(gi(rg(_f(mf(x0(df(Kc(gf(ff(Jn(Kn($n(Ds(sf(_i(V)))))))))))))))))){},ire=new Jk,og=class extends g0{constructor(){super(...arguments);this.paramsConfig=ire,this.controllers={advancedCommon:new Vr(this),alphaMap:new Gi(this),aoMap:new zi(this),bumpMap:new b0(this),displacementMap:new C0(this),emissiveMap:new y0(this),envMap:new Jc(this),lightMap:new Zn(this),map:new Vi(this),metalnessRoughnessMap:new T0(this),normalMap:new Zc(this),physical:new A0(this)},this.controllerNames=Object.keys(this.controllers)}static type(){return"meshPhysical"}createMaterial(){return new Qo({vertexColors:!1,side:oo,color:16777215,opacity:1,metalness:1,roughness:0})}initializeNode(){this.params.onParamsCreated("init controllers",()=>{for(let e of this.controllerNames)this.controllers[e].initializeNode()})}async cook(){for(let e of this.controllerNames)this.controllers[e].update();af.update(this),lf.update(this),pf.update(this),this.setMaterial(this.material)}};var Zk=class extends hf(Xn(Yc(Ao(qn(gi(_f(mf(x0(df(Kc(gf(ff(Jn(Kn($n(Ds(jn(_i(V))))))))))))))))))){},nre=new Zk,ig=class extends Ui{constructor(){super(...arguments);this.paramsConfig=nre,this.controllers={advancedCommon:new Vr(this),alphaMap:new Gi(this),aoMap:new zi(this),bumpMap:new b0(this),displacementMap:new C0(this),emissiveMap:new y0(this),envMap:new Jc(this),lightMap:new Zn(this),map:new Vi(this),metalnessRoughnessMap:new T0(this),normalMap:new Zc(this),PCSS:new Oa(this)},this.controllerNames=Object.keys(this.controllers)}static type(){return"meshStandardBuilder"}usedAssembler(){return Ai.GL_MESH_STANDARD}_createAssemblerController(){return Q.assemblersRegister.assembler(this,this.usedAssembler())}initializeNode(){this.params.onParamsCreated("init controllers",()=>{for(let e of this.controllerNames)this.controllers[e].initializeNode()})}async cook(){for(let e of this.controllerNames)this.controllers[e].update();Wn.update(this),Yn.update(this),$c.update(this),this.compileIfRequired(),this.setMaterial(this.material)}};function ng(i){return class extends i{constructor(){super(...arguments);this.size=v.FLOAT(1,{range:[0,10],rangeLocked:[!0,!1]}),this.sizeAttenuation=v.BOOLEAN(1,{separatorAfter:!0})}}}var sre=class extends ng(V){};var sg=class extends Ir{constructor(e){super(e);this.node=e}static update(e){let t=e.material,r=e.pv;t.size=r.size;let o=t.sizeAttenuation,n=r.sizeAttenuation;o!=n&&(t.sizeAttenuation=n,t.needsUpdate=!0)}};var Qk=class extends Xn(Ao(qn(gi(jn(ng(_i(V))))))){},are=new Qk,ag=class extends Ui{constructor(){super(...arguments);this.paramsConfig=are,this.controllers={advancedCommon:new Vr(this)},this.controllerNames=Object.keys(this.controllers)}static type(){return"pointsBuilder"}usedAssembler(){return Ai.GL_POINTS}_createAssemblerController(){return Q.assemblersRegister.assembler(this,this.usedAssembler())}initializeNode(){this.params.onParamsCreated("init controllers",()=>{for(let e of this.controllerNames)this.controllers[e].initializeNode()})}async cook(){for(let e of this.controllerNames)this.controllers[e].update();Wn.update(this),Yn.update(this),sg.update(this),this.compileIfRequired(),this.setMaterial(this.material)}};var f9="parent object",cre=[f9,f9,f9,f9],vf=(i=>(i[i.MANAGER=0]="MANAGER",i[i.CAMERA=2]="CAMERA",i[i.LIGHT=3]="LIGHT",i))(vf||{}),Co=class extends dr{constructor(){super(...arguments);this.renderOrder=0,this._children_group=this._create_children_group(),this._attachableToHierarchy=!0,this._used_in_scene=!0}static context(){return oe.OBJ}static displayedInputNames(){return cre}_create_children_group(){let e=new ut;return e.matrixAutoUpdate=!1,e}attachableToHierarchy(){return this._attachableToHierarchy}usedInScene(){return this._used_in_scene}addObjectToParent(e){this.attachableToHierarchy()&&e.add(this.object)}removeObjectFromParent(){if(this.attachableToHierarchy()){let e=this.object.parent;e&&e.remove(this.object)}}initializeBaseNode(){this._object=this._create_object_with_attributes(),this.nameController.add_post_set_fullPath_hook(this.set_object_name.bind(this)),this.set_object_name()}childrenGroup(){return this._children_group}get object(){return this._object}_create_object_with_attributes(){let e=this.createObject();return e.node=this,e.add(this._children_group),e}set_object_name(){this._object&&(this._object.name=this.path(),this._children_group.name=`${this.path()}:parentedOutputs`)}createObject(){let e=new vt;return e.matrixAutoUpdate=!1,e}isDisplayNodeCooking(){if(this.displayNodeController){let e=this.displayNodeController.displayNode();if(e)return e.cookController.isCooking()}return!1}isDisplayed(){var e,t;return((t=(e=this.flags)==null?void 0:e.display)==null?void 0:t.active())||!1}};var xf=class extends Co{constructor(){super(...arguments);this.flags=new ho(this),this.renderOrder=vf.LIGHT,this._color_with_intensity=new he(0),this._used_in_scene=!0,this._cook_main_without_inputs_when_dirty_bound=this._cook_main_without_inputs_when_dirty.bind(this)}get light(){return this._light}initializeBaseNode(){super.initializeBaseNode(),this._light=this.createLight(),this.object.add(this._light),this.flags.display.onUpdate(()=>{this._updateLightAttachment()}),this.dirtyController.addPostDirtyHook("_cook_main_without_inputs_when_dirty",this._cook_main_without_inputs_when_dirty_bound)}async _cook_main_without_inputs_when_dirty(){await this.cookController.cookMainWithoutInputs()}set_object_name(){super.set_object_name(),this._light&&(this._light.name=`${this.path()}:light`)}_updateLightAttachment(){this.flags.display.active()?(this.object.add(this.light),this._cook_main_without_inputs_when_dirty()):this.object.remove(this.light)}cook(){this.updateLightParams(),this.updateShadowParams(),this.cookController.endCook()}updateLightParams(){}updateShadowParams(){}};function eo(i,e){let t=(e==null?void 0:e.matrixAutoUpdate)||!1;return class extends i{constructor(){super(...arguments);this.transform=v.FOLDER(),this.keepPosWhenParenting=v.BOOLEAN(0),this.rotationOrder=v.INTEGER(xs.indexOf(vc.XYZ),{menu:{entries:xs.map((o,n)=>({name:o,value:n}))}}),this.t=v.VECTOR3([0,0,0]),this.r=v.VECTOR3([0,0,0]),this.s=v.VECTOR3([1,1,1]),this.scale=v.FLOAT(1),this.matrixAutoUpdate=v.BOOLEAN(t?1:0),this.updateTransformFromObject=v.BUTTON(null,{callback:o=>{Vo.PARAM_CALLBACK_update_transform_from_object(o)}})}}}var lre=class extends eo(V){};var eB="_cook_main_without_inputs_when_dirty",Vo=class{constructor(e){this.node=e,this._cook_main_without_inputs_when_dirty_bound=this._cook_main_without_inputs_when_dirty.bind(this),this._core_transform=new Xt,this._keep_pos_when_parenting_m_object=new Ve,this._keep_pos_when_parenting_m_new_parent_inv=new Ve}initializeNode(){this.node.dirtyController.hasHook(eB)||this.node.dirtyController.addPostDirtyHook(eB,this._cook_main_without_inputs_when_dirty_bound)}async _cook_main_without_inputs_when_dirty(){await this.node.cookController.cookMainWithoutInputs()}update(){this.update_transform_with_matrix();let e=this.node.object;e.matrixAutoUpdate=this.node.pv.matrixAutoUpdate}update_transform_with_matrix(e){let t=this.node.object;e!=null&&!e.equals(t.matrix)?(t.matrix.copy(e),t.dispatchEvent({type:"change"})):this._update_matrix_from_params_with_core_transform()}_update_matrix_from_params_with_core_transform(){let e=this.node.object,t=e.matrixAutoUpdate;t&&(e.matrixAutoUpdate=!1);let r=this._core_transform.matrix(this.node.pv.t,this.node.pv.r,this.node.pv.s,this.node.pv.scale,xs[this.node.pv.rotationOrder]);e.matrix.identity(),e.applyMatrix4(r),this._apply_look_at(),e.updateMatrix(),t&&(e.matrixAutoUpdate=!0),e.dispatchEvent({type:"change"})}_apply_look_at(){}set_params_from_matrix(e,t={}){Xt.setParamsFromMatrix(e,this.node,t)}static update_node_transform_params_if_required(e,t){e.transformController.update_node_transform_params_if_required(t)}update_node_transform_params_if_required(e){if(!this.node.pv.keepPosWhenParenting||!this.node.scene().loadingController.loaded()||e==this.node.object.parent)return;let t=this.node.object;t.updateMatrixWorld(!0),e.updateMatrixWorld(!0),this._keep_pos_when_parenting_m_object.copy(t.matrixWorld),this._keep_pos_when_parenting_m_new_parent_inv.copy(e.matrixWorld),this._keep_pos_when_parenting_m_new_parent_inv.invert(),this._keep_pos_when_parenting_m_object.premultiply(this._keep_pos_when_parenting_m_new_parent_inv),Xt.setParamsFromMatrix(this._keep_pos_when_parenting_m_object,this.node,{scale:!0})}update_node_transform_params_from_object(e=!1){let t=this.node.object;e&&t.updateMatrix(),Xt.setParamsFromMatrix(t.matrix,this.node,{scale:!0})}static PARAM_CALLBACK_update_transform_from_object(e){e.transformController.update_node_transform_params_from_object()}};var to=class{constructor(e){this.node=e}initializeNode(){this.node.io.inputs.setCount(0,1),this.node.io.inputs.set_depends_on_inputs(!1),this.node.io.outputs.setHasOneOutput(),this.node.io.inputs.add_on_set_input_hook("on_input_updated:update_parent",()=>{this.on_input_updated()})}static on_input_updated(e){let t=e.root().getParentForNode(e);e.transformController&&t&&Vo.update_node_transform_params_if_required(e,t),e.io.inputs.input(0)!=null?e.root().addToParentTransform(e):e.root().removeFromParentTransform(e)}on_input_updated(){to.on_input_updated(this.node)}};var ure=class extends eo(V){},yf=class extends xf{constructor(){super(...arguments);this.flags=new ho(this),this.hierarchyController=new to(this),this.transformController=new Vo(this)}initializeBaseNode(){super.initializeBaseNode(),this.hierarchyController.initializeNode(),this.transformController.initializeNode()}cook(){this.transformController.update(),this.updateLightParams(),this.updateShadowParams(),this.cookController.endCook()}};var cg={color:new he(1,1,1),intensity:1,width:1,height:1,showHelper:!1},bf=cg;function tB(i){return class extends i{constructor(){super(...arguments);this.light=v.FOLDER(),this.color=v.COLOR(bf.color.toArray(),{conversion:Io.SRGB_TO_LINEAR}),this.intensity=v.FLOAT(bf.intensity,{range:[0,10],rangeLocked:[!0,!1]}),this.width=v.FLOAT(bf.width,{range:[0,10],rangeLocked:[!0,!1]}),this.height=v.FLOAT(bf.height,{range:[0,10],rangeLocked:[!0,!1]}),this.showHelper=v.BOOLEAN(bf.showHelper)}}}function pre(){let i=new De,e=[1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0];return i.setAttribute("position",new Ce(e,3)),i.computeBoundingSphere(),i}function hre(){let i=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],e=new De;return e.setAttribute("position",new Ce(i,3)),e.computeBoundingSphere(),e}var Qc=class extends cs{constructor(e){super();this.light=e,this.geometry=pre(),this.material=new ur({fog:!1}),this.type="RectAreaLightHelper",this._childMesh=new lt(hre(),new si({side:Dt,fog:!1})),this.add(this._childMesh)}update(){this.scale.set(.5*this.light.width,.5*this.light.height,1),this.material.color.copy(this.light.color).multiplyScalar(this.light.intensity);let e=this.material.color,t=Math.max(e.r,e.g,e.b);t>1&&e.multiplyScalar(1/t),this._childMesh.material.color.copy(this.material.color),this.matrixWorld.extractRotation(this.light.matrixWorld).scale(this.scale).copyPosition(this.light.matrixWorld),this._childMesh.matrixWorld.copy(this.matrixWorld)}dispose(){this.geometry.dispose(),this.material.dispose(),this._childMesh.geometry.dispose(),this._childMesh.material.dispose()}clone(e){let t=new Qc(this.light);return t.updateMatrixWorld(),t}};var Eo=class extends vt{constructor(e,t=1){super();this.type="Light",this.color=new he(e),this.intensity=t}dispose(){}copy(e){return super.copy(e),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){let t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),t}};Eo.prototype.isLight=!0;var Ip=class extends Eo{constructor(e,t,r=10,o=10){super(e,t);this.type="RectAreaLight",this.width=r,this.height=o}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){let t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}};Ip.prototype.isRectAreaLight=!0;var Tf=class{static init(){let e=[1,0,0,2e-5,1,0,0,503905e-9,1,0,0,.00201562,1,0,0,.00453516,1,0,0,.00806253,1,0,0,.0125978,1,0,0,.018141,1,0,0,.0246924,1,0,0,.0322525,1,0,0,.0408213,1,0,0,.0503999,1,0,0,.0609894,1,0,0,.0725906,1,0,0,.0852058,1,0,0,.0988363,1,0,0,.113484,1,0,0,.129153,1,0,0,.145839,1,0,0,.163548,1,0,0,.182266,1,0,0,.201942,1,0,0,.222314,1,0,0,.241906,1,0,0,.262314,1,0,0,.285754,1,0,0,.310159,1,0,0,.335426,1,0,0,.361341,1,0,0,.387445,1,0,0,.412784,1,0,0,.438197,1,0,0,.466966,1,0,0,.49559,1,0,0,.523448,1,0,0,.549938,1,0,0,.57979,1,0,0,.608746,1,0,0,.636185,1,0,0,.664748,1,0,0,.69313,1,0,0,.71966,1,0,0,.747662,1,0,0,.774023,1,0,0,.799775,1,0,0,.825274,1,0,0,.849156,1,0,0,.873248,1,0,0,.89532,1,0,0,.917565,1,0,0,.937863,1,0,0,.958139,1,0,0,.976563,1,0,0,.994658,1,0,0,1.0112,1,0,0,1.02712,1,0,0,1.04189,1,0,0,1.05568,1,0,0,1.06877,1,0,0,1.08058,1,0,0,1.09194,1,0,0,1.10191,1,0,0,1.11161,1,0,0,1.1199,1,0,0,1.12813,.999547,-448815e-12,.0224417,199902e-10,.999495,-113079e-10,.0224406,503651e-9,.999496,-452317e-10,.0224406,.00201461,.999496,-101772e-9,.0224406,.00453287,.999495,-180928e-9,.0224406,.00805845,.999497,-282702e-9,.0224406,.0125914,.999496,-407096e-9,.0224406,.0181319,.999498,-554114e-9,.0224406,.02468,.999499,-723768e-9,.0224406,.0322363,.999495,-916058e-9,.0224405,.0408009,.999499,-.00113101,.0224408,.050375,.999494,-.00136863,.0224405,.0609586,.999489,-.00162896,.0224401,.0725537,.999489,-.00191201,.0224414,.0851619,.999498,-.00221787,.0224413,.0987867,.999492,-.00254642,.0224409,.113426,.999507,-.00289779,.0224417,.129088,.999494,-.0032716,.0224386,.145767,.999546,-.0036673,.0224424,.163472,.999543,-.00408166,.0224387,.182182,.999499,-.00450056,.0224338,.201843,.999503,-.00483661,.0224203,.222198,.999546,-.00452928,.022315,.241714,.999508,-.00587403,.0224329,.262184,.999509,-.00638806,.0224271,.285609,.999501,-.00691028,.0224166,.309998,.999539,-.00741979,.0223989,.335262,.999454,-.00786282,.0223675,.361154,.999529,-.00811928,.0222828,.387224,.999503,-.00799941,.0221063,.41252,.999561,-.00952753,.0223057,.438006,.999557,-.0099134,.0222065,.466735,.999541,-.0100935,.0220402,.495332,.999562,-.00996821,.0218067,.523197,.999556,-.0105031,.0217096,.550223,.999561,-.0114191,.0217215,.579498,.999588,-.0111818,.0213357,.608416,.999633,-.0107725,.0208689,.635965,.999527,-.0121671,.0210149,.664476,.999508,-.0116005,.020431,.692786,.999568,-.0115604,.0199791,.719709,.999671,-.0121117,.0197415,.74737,.999688,-.0110769,.0188846,.773692,.99962,-.0122368,.0188452,.799534,.999823,-.0110325,.0178001,.825046,.999599,-.0114923,.0174221,.849075,.999619,-.0105923,.0164345,.872999,.999613,-.0105988,.0158227,.895371,.99964,-.00979861,.0148131,.917364,.99977,-.00967238,.0140721,.938002,.999726,-.00869175,.0129543,.957917,.99973,-.00866872,.0122329,.976557,.999773,-.00731956,.0108958,.994459,.999811,-.00756027,.0102715,1.01118,.999862,-.00583732,.00878781,1.02701,.999835,-.00631438,.00827529,1.04186,.999871,-.00450785,.00674583,1.05569,.999867,-.00486079,.00621041,1.06861,.999939,-.00322072,.00478301,1.08064,.999918,-.00318199,.00406395,1.09181,1.00003,-.00193348,.00280682,1.10207,.999928,-.00153729,.00198741,1.11152,.999933,-623666e-9,917714e-9,1.12009,1,-102387e-11,907581e-12,1.12813,.997866,-896716e-12,.0448334,199584e-10,.997987,-225945e-10,.0448389,502891e-9,.997987,-903781e-10,.0448388,.00201156,.997985,-203351e-9,.0448388,.00452602,.997986,-361514e-9,.0448388,.00804629,.997987,-56487e-8,.0448389,.0125724,.997988,-813423e-9,.0448389,.0181045,.997984,-.00110718,.0448387,.0246427,.997985,-.00144616,.0448388,.0321875,.997987,-.00183038,.044839,.0407392,.997983,-.00225987,.0448387,.0502986,.997991,-.00273467,.0448389,.0608667,.997984,-.00325481,.0448384,.0724444,.998002,-.00382043,.044839,.0850348,.997997,-.00443145,.0448396,.0986372,.998007,-.00508796,.0448397,.113255,.998008,-.00578985,.04484,.128891,.998003,-.00653683,.0448384,.145548,.997983,-.00732713,.0448358,.163221,.997985,-.00815454,.0448358,.181899,.998005,-.00898985,.0448286,.201533,.998026,-.00964404,.0447934,.221821,.998055,-.00922677,.044611,.241282,.99804,-.0117361,.0448245,.261791,.998048,-.0127628,.0448159,.285181,.998088,-.0138055,.0447996,.30954,.998058,-.0148206,.0447669,.334751,.998099,-.0156998,.044697,.36061,.998116,-.0161976,.0445122,.386603,.998195,-.015945,.0441711,.411844,.998168,-.0183947,.0444255,.43773,.998184,-.0197913,.0443809,.466009,.998251,-.0201426,.0440689,.494574,.998305,-.0198847,.0435632,.522405,.998273,-.0210577,.043414,.549967,.998254,-.0227901,.0433943,.578655,.998349,-.0223108,.0426529,.60758,.99843,-.0223088,.042,.635524,.998373,-.0241141,.0418987,.663621,.998425,-.0231446,.0408118,.691906,.998504,-.0233684,.0400565,.719339,.998443,-.0241652,.0394634,.74643,.99848,-.0228715,.0380002,.773086,.998569,-.023519,.0372322,.798988,.998619,-.0223108,.0356468,.824249,.998594,-.0223105,.034523,.848808,.998622,-.0213426,.0328887,.87227,.998669,-.0207912,.0314374,.895157,.998705,-.0198416,.0296925,.916769,.998786,-.0189168,.0279634,.937773,.998888,-.0178811,.0261597,.957431,.99906,-.0166845,.0242159,.976495,.999038,-.0155464,.0222638,.994169,.999237,-.0141349,.0201967,1.01112,.999378,-.0129324,.0181744,1.02692,.999433,-.0113192,.0159898,1.04174,.999439,-.0101244,.0140385,1.05559,.999614,-.00837456,.0117826,1.06852,.999722,-.00721769,.00983745,1.08069,.999817,-.00554067,.00769002,1.09176,.99983,-.00426961,.005782,1.10211,.999964,-.00273904,.00374503,1.11152,1.00001,-.00136739,.00187176,1.12031,.999946,393227e-10,-28919e-9,1.12804,.995847,-13435e-10,.0671785,19916e-9,.995464,-338387e-10,.0671527,501622e-9,.99547,-135355e-9,.0671531,.00200649,.995471,-30455e-8,.0671532,.00451461,.99547,-541423e-9,.0671531,.008026,.995471,-84598e-8,.0671531,.0125407,.99547,-.00121823,.0671531,.0180589,.99547,-.00165817,.0671531,.0245806,.995463,-.00216583,.0671526,.0321062,.995468,-.00274127,.0671527,.0406366,.995474,-.00338447,.0671534,.0501717,.995473,-.00409554,.0671533,.0607131,.995478,-.00487451,.0671531,.0722618,.995476,-.00572148,.0671532,.0848191,.995477,-.00663658,.0671539,.0983882,.995498,-.00761986,.0671541,.112972,.995509,-.00867094,.0671542,.128568,.995509,-.00978951,.0671531,.145183,.995503,-.0109725,.0671491,.162808,.995501,-.012211,.0671465,.181441,.99553,-.0134565,.0671371,.201015,.99555,-.014391,.0670831,.221206,.99558,-.014351,.0668883,.240813,.995577,-.0173997,.0671055,.261257,.995602,-.0191111,.0671178,.284467,.995623,-.0206705,.0670946,.308765,.995658,-.022184,.0670472,.333905,.995705,-.0234832,.0669417,.359677,.995719,-.0241933,.0666714,.385554,.995786,-.0243539,.066266,.410951,.995887,-.0271866,.0664367,.437163,.995944,-.0296012,.0664931,.464842,.996004,-.0301045,.0660105,.49332,.996128,-.0298311,.0652694,.521131,.996253,-.0316426,.0650739,.549167,.996244,-.0339043,.0649433,.57737,.996309,-.033329,.0638926,.606073,.996417,-.0338935,.0630849,.634527,.996372,-.0353104,.0625083,.66256,.996542,-.0348942,.0611986,.690516,.996568,-.0351614,.060069,.718317,.996711,-.0354317,.0588522,.74528,.996671,-.0349513,.0571902,.772061,.996865,-.0345622,.0555321,.798089,.996802,-.0342566,.0537816,.823178,.996992,-.0330862,.0516095,.847949,.996944,-.0324666,.0495537,.871431,.997146,-.0309544,.0470302,.894357,.997189,-.0299372,.0446043,.916142,.997471,-.0281389,.0418812,.937193,.997515,-.0268702,.0391823,.957,.997812,-.0247166,.0361338,.975936,.998027,-.0233525,.0333945,.99391,.998233,-.0209839,.0301917,1.01075,.998481,-.0194309,.027271,1.02669,.998859,-.0169728,.0240162,1.04173,.99894,-.0152322,.0210517,1.05551,.999132,-.0127497,.0178632,1.06856,.999369,-.0108282,.014787,1.08054,.999549,-.00845886,.0116185,1.09185,.999805,-.0063937,.00867209,1.10207,.99985,-.00414582,.00566823,1.1117,.999912,-.00207443,.00277562,1.12022,1.00001,870226e-10,-53766e-9,1.12832,.991943,-178672e-11,.0893382,198384e-10,.991952,-450183e-10,.089339,499849e-9,.991956,-180074e-9,.0893394,.0019994,.991955,-405167e-9,.0893393,.00449867,.991953,-720298e-9,.0893391,.00799764,.991955,-.00112548,.0893393,.0124964,.991957,-.0016207,.0893395,.0179951,.991958,-.00220601,.0893396,.0244939,.991947,-.00288137,.0893385,.0319929,.991962,-.00364693,.0893399,.0404933,.991965,-.00450264,.0893399,.049995,.99198,-.00544862,.0893411,.0604995,.99197,-.00648491,.0893397,.0720074,.991976,-.00761164,.089341,.0845207,.99198,-.00882891,.0893405,.0980413,.991982,-.0101367,.0893396,.112571,.992008,-.011535,.0893415,.128115,.992026,-.0130228,.0893414,.144672,.992064,-.0145966,.0893418,.162241,.992041,-.0162421,.0893359,.180801,.992086,-.0178888,.0893214,.200302,.992157,-.0190368,.0892401,.220332,.992181,-.0195584,.0890525,.240144,.992175,-.0227257,.0892153,.260728,.99221,-.0254195,.089304,.283473,.99222,-.0274883,.0892703,.307673,.992317,-.0294905,.0892027,.332729,.992374,-.0311861,.0890577,.358387,.992505,-.0320656,.0886994,.384102,.992568,-.0329715,.0883198,.409767,.992675,-.036006,.0883602,.436145,.992746,-.0392897,.0884591,.463217,.992873,-.0399337,.0878287,.491557,.992934,-.040231,.0870108,.519516,.993091,-.0422013,.0865857,.547741,.993259,-.0443503,.0861937,.575792,.993455,-.0446368,.0851187,.604233,.993497,-.0454299,.0840576,.632925,.993694,-.0463296,.0829671,.660985,.993718,-.0470619,.0817185,.688714,.993973,-.0468838,.0800294,.716743,.994207,-.046705,.0781286,.74377,.994168,-.0469698,.0763337,.77042,.9945,-.0456816,.0738184,.796659,.994356,-.0455518,.0715545,.821868,.994747,-.0439488,.0686085,.846572,.994937,-.0430056,.065869,.870435,.995142,-.0413414,.0626446,.893272,.995451,-.0396521,.05929,.915376,.995445,-.0378453,.0558503,.936196,.995967,-.0355219,.0520949,.956376,.996094,-.0335146,.048377,.975327,.996622,-.030682,.0442575,.993471,.996938,-.0285504,.0404693,1.01052,.997383,-.0253399,.0360903,1.02637,.997714,-.0231651,.0322176,1.04139,.998249,-.0198138,.0278433,1.05542,.998596,-.0174337,.0238759,1.06846,.998946,-.0141349,.0195944,1.08056,.99928,-.0115603,.0156279,1.09181,.999507,-.00839065,.0114607,1.10213,.999697,-.005666,.00763325,1.11169,.999869,-.00269902,.00364946,1.12042,1.00001,623836e-10,-319288e-10,1.12832,.987221,-222675e-11,.111332,197456e-10,.98739,-561116e-10,.111351,497563e-9,.987448,-224453e-9,.111357,.00199031,.987441,-505019e-9,.111357,.0044782,.987442,-897816e-9,.111357,.00796129,.987442,-.00140284,.111357,.0124396,.987444,-.00202012,.111357,.0179132,.987442,-.00274964,.111357,.0243824,.987446,-.00359147,.111357,.0318474,.987435,-.00454562,.111356,.0403086,.987461,-.00561225,.111358,.0497678,.987458,-.00679125,.111358,.0602239,.987443,-.0080828,.111356,.0716792,.987476,-.0094872,.111358,.0841364,.98749,-.0110044,.111361,.097597,.987508,-.0126344,.111362,.112062,.987494,-.0143767,.111357,.127533,.987526,-.0162307,.111359,.144015,.987558,-.0181912,.111361,.161502,.987602,-.0202393,.111355,.179979,.987692,-.022273,.111346,.199386,.987702,-.0235306,.111215,.219183,.987789,-.0247628,.111061,.239202,.987776,-.0280668,.111171,.259957,.987856,-.0316751,.111327,.282198,.987912,-.0342468,.111282,.306294,.988,-.0367205,.111198,.331219,.988055,-.0387766,.110994,.356708,.988241,-.0397722,.110547,.382234,.988399,-.0416076,.110198,.408227,.988539,-.0448192,.110137,.434662,.988661,-.0483793,.110143,.461442,.988967,-.0495895,.109453,.489318,.989073,-.0506797,.108628,.517516,.989274,-.0526953,.108003,.545844,.989528,-.054578,.107255,.573823,.989709,-.0561503,.106294,.601944,.989991,-.056866,.104896,.630855,.990392,-.0572914,.103336,.658925,.990374,-.0586224,.10189,.686661,.990747,-.0584764,.099783,.714548,.991041,-.0582662,.0974309,.74186,.991236,-.0584118,.0951678,.768422,.991585,-.0573055,.0921581,.794817,.991984,-.0564241,.0891167,.820336,.9921,-.0553608,.085805,.84493,.992749,-.0533816,.0820354,.868961,.99288,-.0518661,.0782181,.891931,.993511,-.0492492,.0738935,.914186,.993617,-.0471956,.0696402,.93532,.99411,-.044216,.0649659,.95543,.994595,-.0416654,.0603177,.974685,.994976,-.0384314,.0553493,.992807,.995579,-.0353491,.0503942,1.00996,.996069,-.0319787,.0452123,1.02606,.996718,-.028472,.0400112,1.04114,.997173,-.0250789,.0349456,1.05517,.997818,-.0213326,.029653,1.0683,.998318,-.0178509,.024549,1.0805,.998853,-.0141118,.0194197,1.09177,.999218,-.0105914,.0143869,1.1022,.999594,-.00693474,.00943517,1.11175,.99975,-.00340478,.00464051,1.12056,1.00001,109172e-9,-112821e-9,1.12853,.983383,-266524e-11,.133358,196534e-10,.981942,-671009e-10,.133162,494804e-9,.981946,-268405e-9,.133163,.00197923,.981944,-603912e-9,.133163,.00445326,.981941,-.00107362,.133162,.00791693,.981946,-.00167755,.133163,.0123703,.981944,-.00241569,.133162,.0178135,.981945,-.00328807,.133163,.0242466,.981945,-.00429472,.133162,.03167,.981955,-.00543573,.133164,.0400846,.981951,-.00671105,.133163,.0494901,.981968,-.00812092,.133165,.0598886,.981979,-.00966541,.133166,.0712811,.981996,-.0113446,.133168,.083669,.982014,-.0131585,.133169,.0970533,.982011,-.0151073,.133167,.111438,.982062,-.0171906,.133172,.126826,.9821,-.0194067,.133175,.143215,.982149,-.0217502,.133176,.160609,.982163,-.0241945,.133173,.178981,.982247,-.0265907,.133148,.198249,.982291,-.027916,.132974,.217795,.982396,-.0299663,.132868,.238042,.982456,-.0334544,.132934,.258901,.982499,-.0378636,.133137,.280639,.982617,-.0409274,.133085,.304604,.98274,-.0438523,.132985,.329376,.982944,-.0462288,.132728,.354697,.98308,-.0475995,.132228,.380102,.983391,-.0501901,.131924,.406256,.983514,-.0535899,.131737,.432735,.98373,-.0571858,.131567,.459359,.984056,-.0592353,.130932,.486637,.984234,-.0610488,.130092,.51509,.984748,-.0630758,.12923,.543461,.985073,-.0647398,.128174,.571376,.985195,-.0671941,.127133,.599414,.985734,-.0681345,.125576,.628134,.986241,-.0686089,.123639,.656399,.986356,-.0698511,.121834,.684258,.986894,-.0700931,.119454,.711818,.987382,-.0698321,.116718,.739511,.988109,-.0693975,.113699,.766267,.988363,-.0689584,.110454,.792456,.989112,-.0672353,.106602,.81813,.989241,-.0662034,.10267,.842889,.990333,-.0638938,.0981381,.867204,.990591,-.0618534,.0935388,.89038,.991106,-.0593117,.088553,.912576,.991919,-.0562676,.0832187,.934118,.992111,-.0534085,.0778302,.954254,.992997,-.0495459,.0720453,.973722,.993317,-.0463707,.0663458,.991949,.994133,-.0421245,.0601883,1.00936,.994705,-.0384977,.0542501,1.02559,.995495,-.0340956,.0479862,1.04083,.996206,-.030105,.041887,1.05497,.996971,-.0256095,.0355355,1.06824,.997796,-.0213932,.0293655,1.08056,.998272,-.0169612,.0232926,1.09182,.998857,-.0126756,.0172786,1.10219,.99939,-.00832486,.0113156,1.11192,.999752,-.00410826,.00557892,1.12075,1,150957e-9,-119101e-9,1.12885,.975169,-309397e-11,.154669,195073e-10,.975439,-779608e-10,.154712,491534e-9,.975464,-311847e-9,.154716,.00196617,.975464,-701656e-9,.154716,.00442387,.975462,-.0012474,.154715,.0078647,.975461,-.00194906,.154715,.0122886,.975464,-.00280667,.154715,.0176959,.975468,-.00382025,.154716,.0240867,.975471,-.00498985,.154716,.0314612,.975472,-.00631541,.154717,.0398199,.975486,-.00779719,.154718,.0491639,.975489,-.00943505,.154718,.0594932,.975509,-.0112295,.154721,.0708113,.97554,-.0131802,.154724,.0831176,.975557,-.0152876,.154726,.096415,.975585,-.0175512,.154728,.110705,.975605,-.0199713,.154729,.125992,.975645,-.0225447,.154729,.142272,.975711,-.0252649,.154735,.159549,.975788,-.0280986,.154736,.177805,.975872,-.0308232,.154704,.196911,.975968,-.0324841,.154525,.216324,.976063,-.0351281,.154432,.236628,.976157,-.0388618,.15446,.257539,.976204,-.0437704,.154665,.278975,.976358,-.047514,.154652,.302606,.976571,-.0508638,.154535,.327204,.976725,-.0534995,.154221,.352276,.977013,-.0555547,.153737,.377696,.977294,-.0586728,.153403,.403855,.977602,-.0622715,.15312,.430333,.977932,-.0658166,.152755,.456855,.978241,-.0689877,.152233,.483668,.978602,-.0712805,.15132,.512097,.979234,-.0732775,.150235,.540455,.97977,-.075163,.148978,.568486,.979995,-.0778026,.147755,.596524,.98078,-.0791854,.146019,.624825,.981628,-.0799666,.143906,.653403,.982067,-.0808532,.141561,.681445,.98271,-.0816024,.139025,.708918,.983734,-.0812511,.135764,.736594,.98431,-.0806201,.132152,.763576,.985071,-.0801605,.12846,.789797,.98618,-.0784208,.124084,.815804,.986886,-.0766643,.1193,.840869,.987485,-.0747744,.114236,.864952,.988431,-.0716701,.108654,.888431,.988886,-.0691609,.102994,.910963,.990024,-.0654048,.0967278,.932629,.990401,-.0619765,.090384,.95313,.991093,-.0579296,.0837885,.972587,.992018,-.0536576,.0770171,.991184,.992536,-.0493719,.0701486,1.00863,.993421,-.0444813,.062953,1.02494,.993928,-.040008,.0560455,1.04017,.994994,-.0347982,.04856,1.05463,.995866,-.0301017,.0416152,1.06807,.996916,-.0248225,.0342597,1.08039,.997766,-.0199229,.0271668,1.09177,.998479,-.0147422,.0201387,1.10235,.99921,-.00980173,.0131944,1.11206,.999652,-.0047426,.00640712,1.12104,.999998,891673e-10,-10379e-8,1.12906,.967868,-351885e-11,.175947,193569e-10,.968001,-886733e-10,.175972,487782e-9,.96801,-354697e-9,.175973,.00195115,.968012,-798063e-9,.175974,.00439006,.968011,-.00141879,.175973,.00780461,.968011,-.00221686,.175973,.0121948,.968016,-.00319231,.175974,.0175607,.968019,-.00434515,.175974,.0239027,.968018,-.00567538,.175974,.0312208,.968033,-.00718308,.175977,.0395158,.968049,-.00886836,.175979,.0487885,.968047,-.0107312,.175978,.0590394,.968072,-.0127719,.175981,.0702705,.968108,-.0149905,.175986,.0824836,.968112,-.0173866,.175985,.0956783,.968173,-.0199611,.175993,.109862,.96827,-.0227128,.176008,.125033,.968292,-.025639,.17601,.141193,.968339,-.0287299,.176007,.158336,.968389,-.0319399,.176001,.176441,.968501,-.034941,.175962,.195359,.968646,-.0370812,.175793,.214686,.968789,-.0402329,.175708,.234973,.96886,-.0442601,.1757,.255871,.969013,-.049398,.175876,.277238,.969242,-.0539932,.17594,.300326,.969419,-.0577299,.175781,.324702,.969763,-.0605643,.175432,.349527,.970093,-.0634488,.174992,.374976,.970361,-.0670589,.174611,.401097,.970825,-.0708246,.174226,.427496,.971214,-.0742871,.173684,.453858,.971622,-.0782608,.173186,.480637,.972175,-.0813151,.172288,.508655,.972944,-.0832678,.170979,.536973,.973595,-.0855964,.169573,.565138,.974345,-.0882163,.168152,.593222,.975233,-.0901671,.166314,.621201,.976239,-.0912111,.163931,.649919,.977289,-.0916959,.161106,.678011,.978076,-.0927061,.158272,.705717,.979533,-.0925562,.15475,.733228,.980335,-.0918159,.150638,.760454,.981808,-.0908508,.146201,.786918,.983061,-.0896172,.141386,.812953,.984148,-.0871588,.135837,.838281,.985047,-.0850624,.130135,.862594,.986219,-.0818541,.123882,.88633,.987043,-.0784523,.117126,.908952,.988107,-.0749601,.110341,.930744,.988955,-.0703548,.102885,.951728,.989426,-.0662798,.0954167,.971166,.990421,-.0610834,.0876331,.989984,.991032,-.0562936,.0797785,1.00765,.992041,-.0508154,.0718166,1.02434,.992794,-.0454045,.0637125,1.03976,.993691,-.0398194,.0555338,1.05418,.994778,-.0341482,.0473388,1.06772,.995915,-.028428,.0391016,1.08028,.997109,-.022642,.0309953,1.09185,.998095,-.0168738,.0230288,1.10247,.998985,-.0111274,.0150722,1.11229,.999581,-.00543881,.00740605,1.12131,1.00003,162239e-9,-105549e-9,1.12946,.959505,-393734e-11,.196876,191893e-10,.959599,-992157e-10,.196895,483544e-9,.959641,-396868e-9,.196903,.0019342,.959599,-892948e-9,.196895,.00435193,.959603,-.00158747,.196896,.0077368,.959604,-.00248042,.196896,.0120888,.959605,-.00357184,.196896,.0174082,.959605,-.00486169,.196896,.0236949,.959613,-.00635008,.196897,.0309497,.959619,-.00803696,.196898,.0391725,.959636,-.00992255,.196901,.0483649,.959634,-.0120067,.1969,.0585266,.959675,-.0142898,.196906,.0696609,.959712,-.0167717,.196911,.0817678,.959752,-.0194524,.196918,.0948494,.959807,-.0223321,.196925,.10891,.959828,-.0254091,.196924,.123947,.959906,-.0286815,.196934,.139968,.960005,-.0321371,.196944,.156968,.960071,-.0357114,.196936,.17491,.960237,-.0389064,.196882,.193597,.960367,-.041623,.196731,.21285,.960562,-.0452655,.196654,.233075,.960735,-.0496207,.196643,.253941,.960913,-.0549379,.196774,.275278,.961121,-.0603414,.196893,.297733,.96139,-.0644244,.196717,.321877,.961818,-.067556,.196314,.346476,.962175,-.0712709,.195917,.371907,.96255,-.0752848,.1955,.397916,.963164,-.0792073,.195026,.424229,.963782,-.0828225,.194424,.450637,.964306,-.0873119,.193831,.477288,.964923,-.0911051,.192973,.504716,.966048,-.093251,.19151,.533053,.967024,-.0958983,.190013,.561366,.968038,-.09835,.188253,.589464,.969152,-.100754,.186257,.617433,.970557,-.102239,.183775,.645801,.972104,-.102767,.180645,.674278,.973203,-.103492,.177242,.702004,.975123,-.103793,.17345,.729529,.97641,-.102839,.168886,.756712,.978313,-.101687,.163892,.783801,.980036,-.100314,.158439,.809671,.981339,-.097836,.152211,.835402,.982794,-.0950006,.145679,.860081,.984123,-.0920994,.138949,.883757,.984918,-.0878641,.131283,.90685,.985999,-.083939,.123464,.928786,.987151,-.0791234,.115324,.94983,.987827,-.0739332,.106854,.96962,.988806,-.0688088,.0982691,.98861,.989588,-.0628962,.0893456,1.00667,.990438,-.0573146,.0805392,1.02344,.991506,-.0509433,.0713725,1.03933,.992492,-.0448724,.0623732,1.05378,.993663,-.0383497,.0530838,1.06747,.994956,-.0319593,.0439512,1.08007,.99634,-.025401,.0347803,1.09182,.99761,-.0189687,.0257954,1.1025,.99863,-.0124441,.0169893,1.11247,.99947,-.00614003,.00829498,1.12151,1.00008,216624e-9,-146107e-9,1.12993,.950129,-434955e-11,.217413,190081e-10,.950264,-10957e-8,.217444,47884e-8,.9503,-438299e-9,.217451,.00191543,.950246,-986124e-9,.21744,.00430951,.950246,-.00175311,.21744,.00766137,.950245,-.00273923,.21744,.011971,.950253,-.00394453,.217441,.0172385,.950258,-.00536897,.217442,.0234641,.950267,-.00701262,.217444,.030648,.950277,-.00887551,.217446,.038791,.950284,-.0109576,.217446,.0478931,.950312,-.0132591,.217451,.0579568,.950334,-.01578,.217454,.0689821,.950378,-.0185204,.217462,.0809714,.950417,-.0214803,.217467,.0939265,.950488,-.0246594,.217479,.10785,.950534,-.0280565,.217483,.122743,.950633,-.0316685,.217498,.138611,.950698,-.0354787,.217499,.155442,.950844,-.0394003,.217507,.173208,.950999,-.0426812,.217419,.191605,.951221,-.0461302,.217317,.21084,.951412,-.0502131,.217238,.230945,.951623,-.0549183,.21722,.251745,.951867,-.0604493,.217306,.273001,.952069,-.0665189,.217466,.294874,.952459,-.0709179,.217266,.318732,.952996,-.0746112,.216891,.34318,.953425,-.0789252,.216503,.36849,.953885,-.0833293,.216042,.394373,.954617,-.087371,.215469,.420505,.955429,-.0914054,.214802,.446907,.956068,-.0961671,.214146,.473522,.957094,-.10048,.213286,.50052,.958372,-.103248,.211796,.528715,.959654,-.106033,.21016,.557065,.961305,-.108384,.208149,.585286,.962785,-.111122,.206024,.613334,.964848,-.112981,.203442,.641334,.966498,-.113717,.19996,.669955,.968678,-.114121,.196105,.698094,.970489,-.114524,.191906,.725643,.972903,-.113792,.186963,.752856,.974701,-.112406,.181343,.780013,.976718,-.110685,.175185,.806268,.978905,-.108468,.168535,.832073,.980267,-.105061,.161106,.857149,.981967,-.101675,.153387,.881145,.983063,-.0974492,.145199,.904255,.984432,-.0925815,.136527,.926686,.985734,-.0877983,.127584,.947901,.986228,-.081884,.118125,.968111,.98719,-.0761208,.108594,.98719,.988228,-.0698196,.0989996,1.00559,.989046,-.0632739,.0890074,1.02246,.990242,-.056522,.0790832,1.03841,.991252,-.0495272,.0689182,1.05347,.992542,-.0425373,.0588592,1.06724,.994096,-.0353198,.0486833,1.08009,.995593,-.028235,.0385977,1.09177,.99711,-.0209511,.0286457,1.10274,.998263,-.0139289,.0188497,1.11262,.999254,-.0067359,.009208,1.12191,.999967,141846e-9,-657764e-10,1.13024,.935608,-474692e-11,.236466,187817e-10,.93996,-11971e-8,.237568,473646e-9,.939959,-478845e-9,.237567,.0018946,.939954,-.0010774,.237566,.00426284,.939956,-.00191538,.237566,.00757842,.939954,-.00299277,.237566,.0118413,.93996,-.00430961,.237567,.0170518,.939969,-.00586589,.237569,.02321,.939982,-.00766166,.237572,.0303164,.939987,-.00969686,.237572,.0383711,.939997,-.0119715,.237574,.0473751,.940031,-.0144858,.237581,.0573298,.940073,-.0172399,.237589,.0682366,.94012,-.0202335,.237598,.080097,.940162,-.0234663,.237604,.0929116,.940237,-.0269387,.237615,.106686,.940328,-.0306489,.237632,.121421,.940419,-.0345917,.237645,.137115,.940522,-.0387481,.237654,.153766,.940702,-.0429906,.237661,.17133,.940871,-.0465089,.237561,.189502,.941103,-.050531,.23748,.208616,.941369,-.0550657,.237423,.228595,.941641,-.0601337,.237399,.249287,.941903,-.0658804,.237443,.270467,.942224,-.0722674,.237597,.292024,.942633,-.0771788,.237419,.315272,.943172,-.0815623,.237068,.339579,.943691,-.0863973,.236682,.364717,.944382,-.0911536,.236213,.390435,.945392,-.0952967,.235562,.416425,.946185,-.0998948,.234832,.442772,.947212,-.104796,.234114,.469347,.948778,-.10928,.233222,.496162,.950149,-.113081,.231845,.523978,.951989,-.115893,.230005,.552295,.953921,-.11846,.227862,.580569,.955624,-.12115,.225439,.608698,.958234,-.123373,.222635,.636696,.960593,-.124519,.219093,.665208,.963201,-.124736,.214749,.693557,.965642,-.125012,.210059,.721334,.968765,-.124661,.204935,.748613,.971753,-.122996,.198661,.776224,.973751,-.120998,.191823,.802461,.976709,-.118583,.184359,.828399,.977956,-.115102,.176437,.853693,.979672,-.111077,.167681,.877962,.981816,-.10688,.158872,.901564,.98238,-.101469,.149398,.924057,.983964,-.0960013,.139436,.945751,.984933,-.0899626,.12943,.966272,.985694,-.0832973,.11894,.985741,.986822,-.0767082,.108349,1.00407,.987725,-.0693614,.0976026,1.02154,.98877,-.06211,.086652,1.03757,.990129,-.0544143,.0756182,1.05296,.991337,-.046744,.0645753,1.06683,.992978,-.0387931,.0534683,1.0798,.994676,-.030973,.0424137,1.09181,.99645,-.0230311,.0314035,1.10286,.997967,-.0152065,.0206869,1.11291,.99922,-.00744837,.010155,1.12237,1.00002,240209e-9,-752767e-10,1.13089,.922948,-515351e-11,.255626,186069e-10,.928785,-129623e-9,.257244,468009e-9,.928761,-51849e-8,.257237,.00187202,.928751,-.0011666,.257235,.00421204,.928751,-.00207395,.257234,.0074881,.928754,-.00324055,.257235,.0117002,.92876,-.00466639,.257236,.0168486,.928763,-.00635149,.257237,.0229334,.928774,-.00829584,.257239,.029955,.928791,-.0104995,.257243,.0379139,.928804,-.0129623,.257245,.0468108,.928847,-.0156846,.257255,.0566473,.92889,-.0186661,.257263,.0674246,.928924,-.0219067,.257268,.0791433,.928989,-.0254066,.257282,.0918076,.92909,-.0291651,.257301,.105419,.92918,-.0331801,.257316,.119978,.92929,-.0374469,.257332,.135491,.929453,-.041939,.257357,.151948,.929586,-.0464612,.257347,.169275,.929858,-.0503426,.257269,.187257,.930125,-.0548409,.257199,.206204,.930403,-.0598063,.257149,.22601,.930726,-.0652437,.257122,.246561,.931098,-.0712376,.257153,.267618,.931396,-.0777506,.257237,.288993,.931947,-.0832374,.257124,.311527,.932579,-.0883955,.25683,.335697,.933194,-.0937037,.256444,.360634,.934013,-.0987292,.255939,.386126,.935307,-.103215,.255282,.412018,.936374,-.108234,.254538,.438292,.93776,-.113234,.253728,.464805,.939599,-.118013,.25275,.491464,.941036,-.122661,.251404,.518751,.94337,-.125477,.249435,.547133,.945318,-.128374,.247113,.575456,.947995,-.130996,.244441,.60372,.950818,-.133438,.241352,.63174,.954378,-.135004,.237849,.659971,.957151,-.135313,.233188,.688478,.960743,-.13521,.228001,.716767,.964352,-.135007,.222249,.744349,.967273,-.133523,.21542,.771786,.969767,-.131155,.208039,.798639,.973195,-.128492,.200076,.824774,.975557,-.125094,.191451,.850222,.977692,-.120578,.18184,.874761,.98026,-.115882,.172102,.898497,.981394,-.110372,.161859,.921636,.982386,-.10415,.15108,.943467,.983783,-.0978128,.140407,.964045,.98422,-.0906171,.129058,.98398,.985447,-.0832921,.117614,1.00276,.986682,-.0754412,.10585,1.02047,.987326,-.0673885,.0940943,1.03678,.988707,-.0592565,.0822093,1.05218,.990185,-.050717,.070192,1.06652,.991866,-.0423486,.0582081,1.07965,.993897,-.0336118,.0460985,1.09188,.995841,-.0252178,.0342737,1.10307,.997605,-.0164893,.0224829,1.11324,.999037,-.00817112,.0110647,1.12262,1.00003,291686e-9,-168673e-9,1.13139,.915304,-552675e-11,.275999,183285e-10,.91668,-139285e-9,.276414,461914e-9,.916664,-55713e-8,.276409,.00184763,.916653,-.00125354,.276406,.00415715,.916651,-.00222851,.276405,.00739053,.916655,-.00348205,.276406,.0115478,.916653,-.00501414,.276405,.0166291,.916667,-.00682478,.276409,.0226346,.91668,-.00891398,.276412,.0295648,.91669,-.0112817,.276413,.0374199,.916727,-.013928,.276422,.0462016,.916759,-.0168528,.276429,.0559101,.916793,-.0200558,.276436,.0665466,.916849,-.0235373,.276448,.0781139,.916964,-.0272973,.276474,.0906156,.917047,-.0313344,.276491,.104051,.917152,-.0356465,.276511,.118424,.917286,-.0402271,.276533,.133736,.917469,-.0450408,.276564,.149978,.917686,-.0497872,.276563,.167057,.917953,-.0540937,.276493,.184846,.918228,-.0590709,.276437,.203614,.918572,-.0644277,.276398,.223212,.918918,-.0702326,.276362,.243584,.919356,-.076484,.276383,.264465,.919842,-.0830808,.276434,.285701,.920451,-.0892972,.276407,.307559,.921113,-.095016,.276128,.331501,.921881,-.100771,.275754,.356207,.923027,-.106029,.275254,.381477,.924364,-.111029,.274595,.40722,.925818,-.116345,.273841,.433385,.92746,-.121424,.272913,.459848,.929167,-.12657,.271837,.486493,.931426,-.131581,.270575,.513432,.934001,-.135038,.268512,.541502,.936296,-.138039,.266135,.569658,.939985,-.140687,.263271,.598375,.943516,-.143247,.260058,.626563,.94782,-.145135,.256138,.654711,.951023,-.145733,.251154,.683285,.955338,-.145554,.245562,.711831,.959629,-.145008,.239265,.739573,.963123,-.144003,.232064,.767027,.966742,-.141289,.224036,.794359,.969991,-.138247,.215305,.820361,.973403,-.134786,.206051,.846548,.975317,-.129966,.195914,.871541,.977647,-.12471,.185184,.895313,.980137,-.119086,.174161,.918398,.981031,-.112297,.162792,.940679,.982037,-.105372,.150952,.961991,.983164,-.097821,.138921,.981913,.983757,-.0897245,.126611,1.00109,.985036,-.0815974,.114228,1.01902,.986289,-.0727725,.101389,1.03604,.987329,-.0639323,.0886476,1.05149,.989193,-.0548109,.0756837,1.06619,.990716,-.045687,.0627581,1.07948,.992769,-.0364315,.0498337,1.09172,.99524,-.0271761,.0370305,1.1033,.997154,-.0179609,.0243959,1.11353,.998845,-.00878063,.0119567,1.12319,1.00002,259038e-9,-108146e-9,1.13177,.903945,-591681e-11,.295126,181226e-10,.903668,-148672e-9,.295037,455367e-9,.903677,-594683e-9,.29504,.00182145,.903673,-.00133805,.295039,.00409831,.903666,-.00237872,.295036,.00728584,.903668,-.00371676,.295037,.0113842,.903679,-.00535212,.29504,.0163936,.903684,-.00728479,.295041,.0223141,.903698,-.00951473,.295044,.0291462,.903718,-.0120419,.295049,.0368904,.903754,-.0148664,.295058,.0455477,.903801,-.017988,.29507,.0551194,.903851,-.0214064,.295082,.0656058,.903921,-.0251219,.295097,.0770109,.904002,-.0291337,.295116,.0893354,.904111,-.033441,.29514,.102583,.904246,-.0380415,.295169,.116755,.904408,-.0429258,.295202,.131853,.904637,-.0480468,.295245,.147869,.904821,-.0529208,.295214,.164658,.905163,-.0577748,.295185,.182274,.905469,-.0631763,.295143,.200828,.905851,-.068917,.295112,.2202,.906322,-.0750861,.295104,.240372,.906761,-.0815855,.295086,.261082,.90735,-.0882138,.295095,.282123,.908087,-.095082,.295139,.303563,.908826,-.101488,.29492,.327028,.909832,-.107577,.294577,.351464,.911393,-.113033,.294115,.376497,.912804,-.118629,.293446,.402115,.914081,-.124232,.292581,.428111,.91637,-.129399,.29166,.454442,.91814,-.134892,.290422,.481024,.921179,-.140069,.289194,.507924,.924544,-.144431,.287421,.535557,.927995,-.147498,.284867,.563984,.931556,-.150197,.281722,.5923,.935777,-.152711,.278207,.620832,.940869,-.154836,.274148,.649069,.945994,-.155912,.269057,.677746,.949634,-.155641,.262799,.706293,.955032,-.154809,.256097,.734278,.95917,-.153678,.248618,.761751,.962931,-.151253,.239794,.789032,.966045,-.147625,.230281,.815422,.96971,-.143964,.220382,.841787,.972747,-.139464,.209846,.867446,.975545,-.133459,.198189,.892004,.978381,-.127424,.186362,.915458,.979935,-.120506,.173964,.937948,.980948,-.11282,.161429,.959732,.982234,-.104941,.148557,.980118,.982767,-.0962905,.135508,.999463,.983544,-.0873625,.122338,1.01756,.984965,-.0783447,.108669,1.03492,.986233,-.0684798,.0949911,1.05087,.987796,-.0590867,.0811386,1.0656,.989885,-.0489145,.0673099,1.0794,.991821,-.0391,.0535665,1.09174,.99448,-.029087,.0397529,1.10341,.996769,-.019114,.0261463,1.11383,.998641,-.00947007,.0128731,1.1237,.999978,446316e-9,-169093e-9,1.13253,.888362,-627064e-11,.312578,178215e-10,.889988,-157791e-9,.313148,448451e-9,.889825,-631076e-9,.313092,.00179356,.88984,-.00141994,.313097,.00403554,.889828,-.0025243,.313092,.00717429,.889831,-.00394421,.313093,.0112099,.889831,-.00567962,.313093,.0161425,.889844,-.00773051,.313096,.0219724,.889858,-.0100968,.3131,.0286999,.889882,-.0127786,.313106,.0363256,.889918,-.0157757,.313116,.0448509,.889967,-.0190878,.313129,.0542758,.89003,-.022715,.313145,.0646032,.890108,-.0266566,.313165,.0758339,.890218,-.0309131,.313193,.0879729,.890351,-.0354819,.313226,.101019,.89051,-.0403613,.313263,.114979,.890672,-.0455385,.313294,.129848,.890882,-.0509444,.313333,.145616,.891189,-.0559657,.313324,.162122,.891457,-.0613123,.313281,.179524,.891856,-.0671488,.313281,.197855,.892312,-.0732732,.313268,.216991,.892819,-.0797865,.313263,.236924,.893369,-.0865269,.313247,.257433,.894045,-.0931592,.313205,.278215,.894884,-.100532,.313276,.299467,.895832,-.107716,.313205,.322276,.897043,-.114099,.312873,.34642,.898515,-.119941,.312331,.371187,.900191,-.126044,.311731,.396656,.90188,-.131808,.310859,.422488,.904359,-.137289,.309857,.448744,.906923,-.142991,.308714,.475239,.910634,-.148253,.307465,.501983,.914502,-.153332,.305774,.529254,.919046,-.156646,.303156,.557709,.923194,-.159612,.299928,.586267,.928858,-.162027,.296245,.614925,.934464,-.164203,.291832,.643187,.939824,-.165602,.286565,.671601,.944582,-.165383,.280073,.700213,.949257,-.164439,.272891,.728432,.954389,-.162953,.264771,.756082,.958595,-.161007,.255927,.78369,.962138,-.157243,.245769,.810769,.966979,-.152872,.235127,.836999,.969566,-.148209,.22347,.862684,.972372,-.142211,.211147,.887847,.975916,-.135458,.198606,.911843,.978026,-.128398,.185498,.934795,.979686,-.120313,.17171,.956787,.980748,-.11166,.158159,.978046,.981622,-.103035,.144399,.997693,.982356,-.0930328,.13001,1.01642,.983308,-.0834627,.115778,1.03366,.985037,-.0732249,.101327,1.05014,.986493,-.0628145,.086554,1.06507,.988484,-.0526556,.0720413,1.07907,.991051,-.0415744,.0571151,1.09189,.993523,-.0314275,.0426643,1.10369,.99628,-.0203603,.0279325,1.11423,.998344,-.0102446,.0138182,1.12421,.999997,42612e-8,-193628e-9,1.1333,.871555,-660007e-11,.329176,174749e-10,.875255,-166579e-9,.330571,441051e-9,.875644,-666394e-9,.330718,.00176441,.875159,-.00149903,.330536,.00396899,.87516,-.00266493,.330536,.007056,.875158,-.00416393,.330535,.0110251,.87516,-.00599598,.330535,.0158764,.875163,-.00816108,.330536,.0216101,.875174,-.0106591,.330538,.0282266,.875199,-.0134899,.330545,.0357266,.875257,-.0166538,.330563,.0441117,.875304,-.0201501,.330575,.0533821,.875373,-.0239785,.330595,.0635395,.875464,-.0281389,.330619,.0745872,.875565,-.0326301,.330645,.0865255,.875691,-.0374516,.330676,.0993599,.875897,-.0425993,.330733,.113093,.876091,-.0480576,.330776,.127722,.876353,-.0537216,.330826,.143227,.876649,-.0589807,.330809,.159462,.877034,-.0647865,.330819,.176642,.877443,-.0709789,.330817,.194702,.877956,-.0774782,.330832,.213577,.878499,-.0843175,.330822,.233246,.879144,-.0912714,.330804,.253512,.879982,-.0980824,.330766,.274137,.88097,-.105823,.330864,.295209,.882051,-.113671,.330896,.317226,.883397,-.120303,.330545,.341068,.884987,-.12667,.330068,.365613,.886789,-.133118,.329418,.390807,.889311,-.139024,.328683,.416494,.891995,-.144971,.327729,.442618,.895106,-.150747,.326521,.469131,.899527,-.156283,.325229,.495921,.90504,-.161707,.32378,.523162,.909875,-.165661,.32122,.55092,.91561,-.168755,.317942,.579928,.921225,-.171193,.313983,.608539,.927308,-.17319,.309636,.636854,.933077,-.174819,.304262,.66523,.938766,-.175002,.297563,.693609,.943667,-.173946,.289613,.722157,.949033,-.172221,.281227,.750021,.953765,-.169869,.271545,.777466,.95804,-.166578,.261034,.804853,.962302,-.161761,.249434,.831569,.966544,-.156636,.237484,.857779,.969372,-.150784,.224395,.883051,.972486,-.143672,.210786,.907864,.975853,-.135772,.196556,.931223,.977975,-.127942,.182307,.954061,.979122,-.118347,.167607,.97531,.980719,-.109112,.152739,.995666,.981223,-.0991789,.137932,1.01475,.98216,-.0883553,.122692,1.03253,.983379,-.0780825,.107493,1.04917,.985434,-.0665646,.0917791,1.06464,.987332,-.0557714,.0764949,1.07896,.990004,-.0442805,.060721,1.09199,.992975,-.0331676,.0452284,1.10393,.995811,-.0219547,.0297934,1.11476,.9982,-.0107613,.0146415,1.12484,1.00002,248678e-9,-14555e-8,1.13413,.859519,-693595e-11,.347264,171673e-10,.859843,-17503e-8,.347394,433219e-9,.859656,-700076e-9,.347319,.00173277,.859671,-.00157517,.347325,.00389875,.859669,-.00280028,.347324,.00693112,.85967,-.0043754,.347324,.01083,.859665,-.00630049,.347321,.0155954,.859685,-.0085755,.347328,.0212278,.859694,-.0112003,.347329,.0277273,.859718,-.0141747,.347336,.0350946,.85976,-.0174988,.347348,.0433314,.85982,-.0211722,.347366,.0524384,.859892,-.0251941,.347387,.0624168,.860006,-.0295649,.347422,.0732708,.860122,-.0342825,.347453,.0849999,.860282,-.0393462,.347499,.0976102,.860482,-.0447513,.347554,.111104,.860719,-.0504775,.347614,.125479,.860998,-.0563577,.347666,.140703,.861322,-.0619473,.347662,.156681,.861724,-.0681277,.347684,.173597,.862198,-.0746567,.347709,.191371,.862733,-.0815234,.347727,.209976,.863371,-.0886643,.347744,.229351,.86414,-.0957908,.347734,.24934,.865138,-.102912,.34772,.269797,.866182,-.110924,.3478,.290654,.867436,-.119223,.347911,.312074,.869087,-.126197,.347649,.335438,.870859,-.133145,.347222,.359732,.872997,-.139869,.346645,.38467,.875939,-.146089,.345935,.41019,.879012,-.152334,.345012,.436218,.883353,-.15821,.343924,.462641,.888362,-.164097,.342636,.489449,.895026,-.169528,.341351,.516629,.900753,-.174408,.339115,.544109,.906814,-.17751,.335809,.572857,.912855,-.180101,.331597,.601554,.919438,-.182116,.32698,.630198,.925962,-.183494,.321449,.658404,.931734,-.184159,.314595,.686625,.93762,-.18304,.306462,.71531,.943858,-.181323,.297514,.744272,.948662,-.178683,.287447,.771462,.953299,-.175379,.276166,.798593,.957346,-.170395,.263758,.8256,.962565,-.165042,.251019,.852575,.966075,-.158655,.237011,.878316,.969048,-.151707,.222518,.90329,.972423,-.143271,.207848,.927745,.975833,-.134824,.192463,.950859,.977629,-.125444,.1768,.972947,.978995,-.114949,.161033,.993263,.980533,-.104936,.145523,1.01337,.980745,-.0935577,.129799,1.03128,.981814,-.0822956,.113486,1.04825,.983943,-.0710082,.0972925,1.06405,.986141,-.0587931,.0808138,1.0785,.988878,-.0472755,.0644915,1.09204,.992132,-.0349128,.0478128,1.10413,.9953,-.0232407,.031621,1.11527,.998117,-.0112713,.0154935,1.12551,1.00003,339743e-9,-195763e-9,1.13504,.845441,-729126e-11,.364305,169208e-10,.843588,-183164e-9,.363506,425067e-9,.843412,-73253e-8,.36343,.00169999,.843401,-.00164818,.363426,.00382495,.843399,-.00293008,.363425,.00679993,.843401,-.00457822,.363425,.010625,.843394,-.00659249,.363421,.0153002,.843398,-.00897282,.363421,.0208258,.843415,-.0117191,.363426,.0272024,.843438,-.0148312,.363432,.0344305,.843483,-.018309,.363447,.0425116,.84356,-.0221521,.363472,.0514471,.843646,-.0263597,.363499,.061238,.843743,-.0309315,.363527,.0718873,.84388,-.0358658,.363569,.0833969,.844079,-.0411624,.363631,.0957742,.844279,-.0468128,.363688,.109015,.844549,-.0527923,.363761,.123124,.844858,-.0588204,.363817,.138044,.84522,-.0647573,.36383,.153755,.845669,-.0713181,.363879,.170394,.846155,-.0781697,.363908,.187861,.846789,-.0853913,.363969,.206176,.847502,-.0928086,.363999,.225244,.8484,-.10005,.363997,.244926,.849461,-.107615,.364008,.265188,.850562,-.115814,.364055,.28587,.851962,-.124334,.364179,.306926,.854326,-.131995,.364233,.329605,.856295,-.139338,.363856,.35359,.858857,-.146346,.363347,.37831,.862428,-.152994,.362807,.403722,.866203,-.159463,.361963,.429537,.871629,-.165623,.36112,.456,.877365,-.171649,.359917,.482773,.883744,-.177151,.35848,.509705,.890693,-.182381,.356523,.537215,.897278,-.186076,.3533,.565493,.903958,-.188602,.349095,.594293,.910908,-.190755,.344215,.623165,.918117,-.192063,.338606,.651573,.924644,-.192758,.331544,.679869,.931054,-.192238,.323163,.708668,.937303,-.190035,.313529,.737201,.943387,-.187162,.303152,.764977,.948494,-.183876,.29146,.792683,.952546,-.178901,.277917,.819228,.958077,-.173173,.264753,.846559,.962462,-.16645,.25002,.872962,.966569,-.159452,.234873,.898729,.969108,-.15074,.218752,.923126,.973072,-.141523,.202673,.947278,.975452,-.132075,.186326,.969938,.977784,-.121257,.169396,.991325,.97899,-.110182,.153044,1.01123,.979777,-.0989634,.136485,1.0299,.980865,-.0865894,.119343,1.04727,.982432,-.0746115,.102452,1.06341,.984935,-.0621822,.0852423,1.07834,.987776,-.0495694,.0678546,1.092,.99103,-.0372386,.0506917,1.1043,.99474,-.0244353,.0333316,1.11576,.997768,-.0121448,.0164348,1.12617,1.00003,31774e-8,-169504e-9,1.13598,.825551,-756799e-11,.378425,165099e-10,.82664,-190922e-9,.378923,416504e-9,.826323,-763495e-9,.378779,.0016656,.826359,-.00171789,.378795,.00374768,.82636,-.00305402,.378795,.00666259,.826368,-.00477185,.378798,.0104104,.826364,-.00687131,.378795,.0149912,.826368,-.00935232,.378795,.0204054,.826376,-.0122146,.378797,.0266532,.826399,-.0154581,.378803,.0337355,.82646,-.0190825,.378824,.0416537,.826525,-.0230873,.378846,.0504091,.826614,-.0274719,.378876,.0600032,.82674,-.0322355,.378917,.0704393,.826888,-.0373766,.378964,.0817195,.827078,-.0428936,.379024,.0938492,.827318,-.0487778,.379099,.106828,.82764,-.0549935,.379199,.120659,.827926,-.0611058,.379227,.13526,.828325,-.0675054,.379275,.150713,.828801,-.0743455,.379332,.167034,.8294,-.0815523,.379415,.184209,.830094,-.0890779,.379495,.202203,.8309,-.096736,.379555,.220945,.831943,-.104135,.379577,.240306,.833037,-.112106,.379604,.260317,.834278,-.120554,.379668,.2808,.836192,-.129128,.3799,.301654,.838671,-.137541,.380109,.323502,.840939,-.14523,.379809,.347176,.844575,-.15248,.379593,.371706,.848379,-.159607,.37909,.39688,.853616,-.166267,.378617,.422702,.858921,-.172698,.377746,.448919,.865324,-.178823,.376749,.475661,.872207,-.184542,.375363,.502599,.880018,-.189836,.373657,.529914,.88694,-.194294,.370673,.557683,.894779,-.197022,.36662,.586848,.902242,-.199108,.36138,.615831,.909914,-.200398,.355434,.644478,.917088,-.20094,.348173,.672905,.923888,-.200671,.339482,.701327,.930495,-.198773,.32956,.730101,.937247,-.195394,.318363,.758383,.943108,-.191956,.306323,.786539,.948296,-.187227,.292576,.813637,.953472,-.181165,.278234,.840793,.958485,-.174119,.263054,.867712,.962714,-.166564,.246756,.893635,.966185,-.158181,.229945,.919028,.970146,-.148275,.212633,.943413,.973491,-.138157,.195229,.966627,.975741,-.127574,.178048,.988817,.977238,-.11554,.160312,1.00924,.978411,-.10364,.142857,1.02845,.979811,-.0913122,.125317,1.04648,.98116,-.0782558,.107627,1.06284,.983543,-.0655957,.0895862,1.07798,.986789,-.0520411,.0713756,1.092,.990292,-.0389727,.053228,1.10484,.994187,-.025808,.0351945,1.11642,.997499,-.0126071,.0173198,1.12703,.999999,275604e-9,-148602e-9,1.13674,.81075,-78735e-10,.394456,161829e-10,.808692,-198293e-9,.393453,407564e-9,.80846,-792877e-9,.39334,.00162965,.808595,-.00178416,.393407,.00366711,.808597,-.00317182,.393408,.00651934,.808598,-.00495589,.393408,.0101866,.808591,-.00713627,.393403,.0146689,.808592,-.00971285,.393402,.0199667,.80861,-.0126855,.393407,.0260803,.808633,-.0160538,.393413,.0330107,.80868,-.0198175,.393429,.0407589,.808748,-.0239758,.393453,.0493264,.808854,-.0285286,.39349,.0587161,.808992,-.0334748,.39354,.0689304,.809141,-.0388116,.393588,.0799707,.809352,-.0445375,.39366,.0918432,.809608,-.0506427,.393742,.104549,.809915,-.0570708,.393834,.118085,.810253,-.0633526,.393885,.132377,.810687,-.0700966,.393953,.147537,.811233,-.0772274,.394047,.163543,.811865,-.0847629,.394148,.180394,.812648,-.0925663,.394265,.198051,.813583,-.100416,.394363,.216443,.814683,-.108119,.394402,.235502,.815948,-.11644,.394489,.255242,.817278,-.125036,.394542,.275441,.819605,-.133655,.39486,.296094,.822256,-.142682,.395248,.317309,.825349,-.150756,.395241,.340516,.829605,-.158392,.395285,.364819,.83391,-.165801,.394922,.389736,.839808,-.172677,.394691,.415409,.845708,-.179448,.394006,.441546,.853025,-.185746,.393279,.46832,.859666,-.191684,.391655,.495302,.86789,-.197146,.390068,.52262,.875845,-.201904,.38727,.550336,.882634,-.205023,.382688,.578825,.891076,-.207098,.377543,.608103,.900589,-.208474,.371752,.63723,.90791,-.209068,.364016,.665769,.915971,-.208655,.355593,.694428,.923455,-.20729,.345439,.723224,.931514,-.203821,.334099,.751925,.937885,-.19986,.321069,.780249,.943136,-.194993,.306571,.8077,.948818,-.189132,.291556,.83497,.954433,-.181617,.275745,.86188,.959078,-.173595,.258695,.888562,.962705,-.164855,.240825,.914008,.966753,-.155129,.22268,.939145,.970704,-.144241,.204542,.963393,.973367,-.133188,.185927,.985983,.975984,-.121146,.167743,1.00704,.976994,-.108366,.149218,1.02715,.978485,-.0956746,.13131,1.0455,.980074,-.0820733,.112513,1.06221,.98225,-.0684061,.0938323,1.07782,.98553,-.0549503,.0749508,1.09199,.989529,-.0407857,.055848,1.10508,.993536,-.0271978,.0368581,1.11684,.997247,-.0132716,.0181845,1.12789,1,431817e-9,-198809e-9,1.13792,.785886,-812608e-11,.405036,157669e-10,.790388,-205278e-9,.407355,398297e-9,.790145,-820824e-9,.407231,.00159263,.790135,-.00184681,.407226,.00358336,.790119,-.00328316,.407218,.00637039,.790126,-.00512988,.40722,.0099539,.79013,-.00738684,.407221,.0143339,.790135,-.0100538,.407221,.0195107,.790134,-.0131306,.407217,.0254848,.79016,-.0166169,.407224,.0322572,.790197,-.020512,.407236,.0398284,.790273,-.0248157,.407263,.0482014,.790381,-.029527,.407304,.0573777,.790521,-.0346446,.407355,.0673602,.790704,-.0401665,.40742,.0781522,.790925,-.0460896,.407499,.0897582,.791195,-.0524017,.407589,.10218,.791522,-.0590121,.407691,.11541,.791878,-.0654876,.407748,.12939,.792361,-.0725207,.407849,.144237,.792942,-.0799844,.407963,.159924,.79362,-.0877896,.408087,.176425,.794529,-.0958451,.408259,.193733,.795521,-.103827,.408362,.211756,.796778,-.111937,.408482,.230524,.798027,-.120521,.408547,.249967,.799813,-.129242,.408721,.269926,.802387,-.138048,.409148,.290338,.805279,-.147301,.409641,.311193,.809251,-.155895,.410154,.333611,.813733,-.163942,.410297,.357615,.819081,-.171666,.410373,.382339,.825427,-.178905,.410348,.407828,.83172,-.185812,.409486,.434034,.83877,-.192318,.408776,.460493,.845817,-.198249,.407176,.487346,.854664,-.204034,.405719,.514832,.863495,-.208908,.403282,.542401,.871883,-.212765,.399293,.570683,.88065,-.214911,.393803,.599947,.89004,-.216214,.387536,.62932,.898476,-.216745,.379846,.658319,.906738,-.216387,.370625,.687138,.914844,-.215053,.360139,.71601,.923877,-.212007,.348849,.745124,.931925,-.207481,.335639,.773366,.938054,-.202418,.320798,.801636,.943895,-.196507,.304772,.829055,.949468,-.189009,.288033,.856097,.955152,-.180539,.270532,.88301,.959403,-.171437,.251639,.909296,.963309,-.161661,.232563,.934868,.967399,-.150425,.213231,.959662,.972009,-.138659,.194247,.98302,.97433,-.126595,.174718,1.00517,.975823,-.113205,.155518,1.02566,.976371,-.0996096,.136709,1.04418,.978705,-.0860754,.117571,1.06146,.981477,-.0714438,.0980046,1.07777,.984263,-.0572304,.0782181,1.09214,.988423,-.0428875,.0584052,1.10553,.993,-.0282442,.038522,1.11758,.99704,-.0140183,.0190148,1.12864,.999913,369494e-9,-145203e-9,1.13901,.777662,-84153e-10,.423844,154403e-10,.770458,-211714e-9,.419915,38845e-8,.770716,-846888e-9,.420055,.00155386,.770982,-.00190567,.420202,.00349653,.770981,-.00338782,.420201,.00621606,.77098,-.00529338,.4202,.00971274,.770983,-.00762223,.4202,.0139867,.770985,-.0103741,.420198,.0190381,.770996,-.0135489,.4202,.0248677,.771029,-.0171461,.420212,.0314764,.771052,-.0211647,.420215,.0388648,.771131,-.0256048,.420245,.047036,.771235,-.0304647,.420284,.0559911,.771383,-.0357436,.420341,.0657346,.771591,-.0414392,.420423,.0762694,.771819,-.0475462,.420506,.0875984,.772123,-.0540506,.420617,.099727,.772464,-.060797,.42072,.112637,.772855,-.0675393,.420799,.126313,.773317,-.0748323,.420893,.140824,.773981,-.0825681,.421058,.15617,.774746,-.0906307,.421226,.172322,.77566,-.0988982,.421397,.189253,.776837,-.106994,.421569,.206912,.778097,-.115528,.421704,.225359,.779588,-.124317,.421849,.24447,.781574,-.133139,.422097,.264156,.784451,-.142179,.422615,.284318,.787682,-.15165,.423269,.304902,.792433,-.160771,.424396,.3265,.797359,-.169166,.424772,.35014,.803986,-.177149,.425475,.374768,.809504,-.184745,.424996,.399928,.815885,-.19173,.424247,.425796,.823513,-.198525,.423515,.452287,.832549,-.204709,.422787,.479321,.841653,-.210447,.421187,.506718,.850401,-.215501,.418519,.53432,.859854,-.219752,.414715,.56242,.869364,-.222305,.409462,.591558,.878837,-.223744,.402926,.621074,.888636,-.224065,.395043,.650538,.898132,-.223742,.38564,.679538,.907181,-.222308,.375378,.708674,.915621,-.219837,.363212,.737714,.9239,-.215233,.349313,.767014,.931644,-.209592,.334162,.795133,.938887,-.203644,.317943,.823228,.945282,-.196349,.300581,.850822,.950758,-.18742,.282195,.877594,.956146,-.177879,.262481,.904564,.960355,-.167643,.242487,.930741,.965256,-.156671,.222668,.955868,.968029,-.144123,.201907,.979869,.97251,-.131305,.18202,1.00291,.974925,-.118335,.161909,1.02392,.975402,-.103714,.142129,1.0433,.976987,-.089415,.122447,1.06089,.979677,-.0748858,.102248,1.07713,.983184,-.0596086,.0814851,1.09218,.987466,-.0447671,.0609484,1.10585,.992348,-.0295217,.0401835,1.11829,.996674,-.0143917,.0198163,1.12966,1.00003,321364e-9,-149983e-9,1.1402,.757901,-869074e-11,.436176,151011e-10,.751195,-217848e-9,.432317,378533e-9,.751178,-871373e-9,.432307,.0015141,.751195,-.00196061,.432317,.0034068,.751198,-.00348552,.432318,.00605659,.751195,-.00544599,.432315,.00946353,.751207,-.00784203,.43232,.013628,.751213,-.0106732,.43232,.0185499,.751221,-.0139393,.432319,.0242302,.751244,-.0176398,.432325,.0306694,.7513,-.0217743,.432348,.0378698,.751358,-.0263412,.432367,.0458321,.751458,-.0313396,.432404,.0545587,.751608,-.0367682,.432464,.0640543,.7518,-.0426246,.43254,.0743222,.752065,-.0489031,.432645,.0853668,.752376,-.0555828,.432762,.0971911,.752715,-.0623861,.432859,.109768,.753137,-.069415,.432958,.123126,.753676,-.0770039,.433099,.137308,.754345,-.084971,.433272,.15229,.755235,-.0932681,.433504,.168075,.756186,-.10171,.433693,.184625,.757363,-.110019,.433857,.201897,.75884,-.11887,.434102,.220014,.760467,-.127881,.434306,.238778,.762969,-.136766,.434751,.258172,.765823,-.14612,.43529,.278062,.769676,-.15566,.436236,.298437,.774909,-.165177,.437754,.319532,.77994,-.17402,.438343,.342505,.785757,-.182201,.438609,.366693,.792487,-.190104,.438762,.391668,.80038,-.197438,.438795,.417494,.808494,-.204365,.438226,.443933,.817695,-.210714,.437283,.470929,.828111,-.216651,.436087,.498569,.837901,-.221804,.433717,.526165,.847813,-.226318,.430133,.554155,.858314,-.229297,.425213,.582822,.868891,-.230999,.418576,.612847,.878941,-.231155,.410405,.642445,.888809,-.230935,.400544,.672024,.898089,-.229343,.389613,.701366,.908081,-.226886,.377197,.730763,.916819,-.222676,.363397,.759642,.924968,-.216835,.347437,.788775,.932906,-.210245,.32995,.817135,.940025,-.202992,.312262,.844912,.946101,-.19436,.293313,.872164,.952835,-.184125,.273638,.899443,.957347,-.173657,.252385,.926389,.961434,-.162204,.231038,.951947,.965522,-.14979,.209834,.976751,.969412,-.136307,.188821,1.00022,.973902,-.122527,.168013,1.02229,.974045,-.108213,.147634,1.04199,.975775,-.0927397,.12705,1.06019,.978383,-.0778212,.106309,1.07711,.98211,-.0621216,.0849279,1.09245,.986517,-.0463847,.0633519,1.10651,.991696,-.0309353,.0419698,1.11903,.996349,-.0150914,.0206272,1.13073,1.00003,442449e-9,-231396e-9,1.14146,.727498,-885074e-11,.441528,145832e-10,.730897,-223525e-9,.443589,368298e-9,.730796,-893996e-9,.443528,.00147303,.730805,-.00201149,.443533,.00331433,.730814,-.00357596,.443538,.00589222,.730815,-.00558734,.443538,.00920678,.730822,-.00804544,.44354,.0132582,.730836,-.0109501,.443545,.0180468,.730848,-.0143008,.443546,.0235732,.730871,-.0180969,.443552,.0298382,.730915,-.022338,.443567,.0368438,.730982,-.0270225,.443591,.044591,.731076,-.0321491,.443627,.0530831,.731245,-.0377166,.443699,.0623243,.73144,-.0437216,.443777,.0723181,.7317,-.0501576,.443881,.0830691,.732034,-.0569942,.444014,.0945809,.732388,-.0638756,.444113,.106825,.732853,-.071203,.444247,.119859,.733473,-.0790076,.444442,.13369,.734195,-.0871937,.444645,.148304,.735069,-.095696,.444877,.163702,.736169,-.10426,.445133,.179861,.73747,-.112853,.44537,.196778,.738991,-.12199,.445651,.214496,.740865,-.131153,.445958,.232913,.743637,-.140245,.446548,.251977,.746797,-.149722,.447246,.271551,.751517,-.159341,.448656,.291774,.756156,-.169106,.449866,.312455,.761519,-.178436,.450919,.334552,.768295,-.186904,.451776,.358491,.776613,-.195117,.452832,.383446,.783966,-.202695,.45249,.408945,.793542,-.20985,.452587,.435364,.803192,-.216403,.451852,.462336,.813892,-.22251,.450708,.48987,.824968,-.227676,.4486,.517697,.835859,-.232443,.445156,.545975,.846825,-.235775,.440351,.574483,.858085,-.237897,.433641,.604246,.868825,-.238074,.425354,.634101,.879638,-.237661,.415383,.664201,.889966,-.236186,.404136,.693918,.899479,-.233599,.390917,.723481,.908769,-.229737,.376352,.75258,.917966,-.223836,.360372,.781764,.926304,-.217067,.342551,.811139,.934626,-.209309,.324238,.839585,.941841,-.20071,.304484,.867044,.94789,-.190602,.283607,.894579,.954196,-.179253,.262205,.921743,.958383,-.167646,.239847,.948026,.963119,-.155073,.218078,.973296,.966941,-.141426,.195899,.998135,.970836,-.126849,.174121,1.02021,.973301,-.112296,.153052,1.04085,.97448,-.0964965,.131733,1.05946,.977045,-.080489,.10997,1.07693,.980751,-.064844,.0881657,1.09254,.985475,-.0481938,.0657987,1.10697,.991089,-.0319185,.0435215,1.12004,.996122,-.0158088,.0214779,1.13173,1.00001,372455e-9,-200295e-9,1.14291,.708622,-907597e-11,.45304,141962e-10,.711162,-228911e-9,.454662,358052e-9,.709812,-914446e-9,.453797,.00143034,.709865,-.00205819,.453834,.00321935,.709864,-.00365894,.453833,.00572331,.709855,-.00571692,.453826,.00894278,.709862,-.00823201,.453828,.012878,.709875,-.011204,.453832,.0175295,.709896,-.0146323,.453839,.0228978,.709925,-.0185163,.453847,.0289839,.709974,-.0228551,.453866,.0357894,.710045,-.0276473,.453892,.0433161,.710133,-.032891,.453924,.0515665,.710292,-.0385851,.453992,.0605458,.710485,-.0447254,.45407,.0702574,.710769,-.0513051,.454192,.0807077,.711106,-.0582733,.454329,.091896,.711516,-.0652866,.45446,.103814,.712071,-.0728426,.454653,.116508,.712676,-.0808307,.45484,.129968,.713476,-.0892216,.455096,.144206,.714377,-.0979047,.455346,.159212,.715579,-.106531,.455647,.174973,.716977,-.115492,.455961,.191504,.71862,-.124821,.456315,.208835,.72084,-.134079,.4568,.226869,.723786,-.143427,.457521,.245582,.727464,-.153061,.458475,.264957,.732771,-.162768,.460239,.284948,.736515,-.172627,.460899,.30522,.743519,-.182487,.463225,.326717,.750041,-.191295,.464027,.350113,.758589,-.199746,.465227,.374782,.767703,-.207584,.465877,.400226,.777484,-.214973,.465996,.426442,.788792,-.221796,.466019,.453688,.800194,-.228038,.465083,.481246,.811234,-.233346,.462506,.509086,.822859,-.238073,.459257,.537338,.835082,-.241764,.454863,.566108,.846332,-.244241,.448163,.595126,.858355,-.244736,.439709,.625574,.87034,-.244278,.429837,.65617,.881027,-.24255,.418002,.686029,.891007,-.239912,.404325,.716039,.900874,-.236133,.389222,.745518,.911072,-.230672,.373269,.775026,.920359,-.22356,.355083,.804521,.928604,-.215591,.335533,.834045,.937175,-.206503,.315278,.861612,.942825,-.196684,.293653,.889131,.949805,-.185116,.271503,.916853,.955535,-.172703,.248821,.943541,.959843,-.159978,.225591,.970132,.964393,-.146375,.202719,.994709,.968008,-.131269,.179928,1.0186,.971013,-.11569,.158007,1.03928,.973334,-.1003,.13624,1.05887,.975775,-.0833352,.1138,1.07652,.979579,-.0668981,.0913141,1.09297,.984323,-.0500902,.0683051,1.10734,.990351,-.0332377,.0451771,1.12084,.995823,-.0161491,.0221705,1.13296,1.0001,234083e-9,-108712e-9,1.14441,.683895,-924677e-11,.46015,137429e-10,.68833,-233383e-9,.463134,346865e-9,.688368,-933547e-9,.463159,.00138748,.688367,-.00210049,.463159,.00312187,.688369,-.00373415,.463159,.00555004,.688377,-.00583449,.463163,.00867216,.688386,-.00840128,.463166,.0124884,.688398,-.0114343,.463169,.0169993,.688418,-.0149329,.463175,.0222054,.688453,-.0188964,.463188,.028108,.688515,-.0233239,.463214,.0347085,.68857,-.0282136,.463231,.0420091,.688679,-.033564,.463276,.0500132,.688854,-.0393733,.463356,.0587255,.689038,-.0456354,.46343,.0681476,.689321,-.0523433,.463553,.0782897,.689662,-.059412,.463693,.0891501,.690188,-.0665736,.4639,.100735,.690755,-.0743106,.464107,.113074,.691405,-.0824722,.464329,.126161,.692198,-.0910484,.464585,.140007,.693196,-.0998778,.464893,.154612,.69454,-.108651,.465285,.169984,.695921,-.117855,.465596,.186106,.697749,-.12734,.466056,.203034,.700375,-.136714,.466771,.220703,.703395,-.146386,.467579,.239062,.707904,-.156096,.469067,.258188,.711673,-.165904,.469851,.277759,.717489,-.175812,.471815,.297935,.724051,-.185931,.47389,.318916,.731965,-.195238,.47587,.341591,.741151,-.204021,.477523,.366062,.751416,-.212113,.478881,.391396,.761848,-.21979,.479226,.417599,.771886,-.2267,.478495,.444401,.783998,-.232991,.477622,.472084,.796523,-.238645,.475833,.500193,.808851,-.243396,.472568,.52865,.821191,-.247226,.467857,.557362,.834261,-.250102,.461871,.586768,.846762,-.251056,.453543,.617085,.859867,-.250604,.443494,.647659,.871948,-.248783,.431711,.678119,.882967,-.245855,.417911,.708399,.892826,-.242168,.401993,.738256,.90332,-.237062,.385371,.767999,.913633,-.22997,.366837,.798191,.922774,-.221687,.346372,.827756,.931371,-.212345,.325682,.856425,.938929,-.20206,.303665,.884299,.944821,-.190981,.280786,.912023,.951792,-.178065,.2573,.939669,.957712,-.164634,.233448,.96655,.961912,-.150863,.209504,.992366,.966382,-.13577,.18597,1.01633,.969588,-.119593,.162905,1.03843,.971777,-.103203,.14053,1.05841,.97433,-.0865888,.117909,1.07632,.978686,-.0690829,.0944101,1.09326,.983281,-.0516568,.0705671,1.10796,.989562,-.034558,.0468592,1.12182,.995465,-.0167808,.0229846,1.1342,.999991,373016e-9,-235606e-9,1.1459,.662251,-939016e-11,.468575,132714e-10,.666634,-237624e-9,.471675,335842e-9,.666411,-950385e-9,.471516,.00134321,.666399,-.00213833,.471509,.00302221,.666386,-.0038014,.471499,.00537283,.666405,-.00593958,.471511,.00839533,.666406,-.00855253,.471508,.0120898,.666428,-.0116401,.471519,.0164569,.666444,-.0152015,.471522,.0214971,.66649,-.0192362,.471543,.027212,.666537,-.0237428,.471558,.033603,.666617,-.0287198,.471591,.0406728,.666718,-.0341647,.471631,.0484238,.666889,-.0400759,.47171,.0568621,.667104,-.0464479,.471805,.0659915,.667374,-.0532677,.471923,.0758178,.667772,-.0603805,.472098,.0863425,.668371,-.0677392,.472363,.0975917,.668971,-.0756028,.472596,.109567,.669696,-.0839293,.472869,.122272,.670481,-.0926683,.473126,.135718,.6715,-.1016,.473442,.149914,.672911,-.110566,.47389,.164882,.674512,-.119984,.474354,.180602,.67651,-.129574,.474922,.19711,.679292,-.139106,.475764,.214371,.682798,-.148993,.476886,.232405,.686955,-.158737,.478179,.251153,.691406,-.168754,.479432,.270436,.697438,-.178703,.481481,.290374,.704761,-.188955,.484143,.311044,.713599,-.198814,.487007,.333003,.723194,-.207869,.488962,.357144,.732601,-.216189,.489815,.382169,.744193,-.22398,.490888,.408227,.754907,-.231156,.490355,.434928,.767403,-.23747,.489548,.462599,.78107,-.243503,.488274,.490908,.793893,-.248114,.484843,.519421,.807296,-.25222,.4803,.548561,.820529,-.255265,.474097,.577772,.833716,-.256741,.466041,.607782,.848403,-.25637,.456547,.638807,.860755,-.254804,.443946,.670058,.874012,-.251834,.430852,.700749,.885619,-.247867,.414903,.731446,.896069,-.242634,.397276,.761191,.906266,-.236093,.378535,.791053,.916759,-.227543,.358038,.821298,.92523,-.21783,.335705,.850747,.93436,-.207534,.313797,.879258,.941631,-.195983,.289671,.907734,.947564,-.183567,.265319,.935206,.953681,-.169345,.240815,.962739,.960008,-.154909,.216119,.989227,.964145,-.140161,.192096,1.01465,.968171,-.123411,.167855,1.03737,.969859,-.106525,.144817,1.05767,.972666,-.0891023,.12149,1.0761,.977055,-.0718094,.0975306,1.09336,.982527,-.0534213,.0730217,1.10878,.989001,-.0355579,.0483366,1.12285,.99512,-.0176383,.023938,1.13548,1.00007,368831e-9,-211581e-9,1.14744,.651047,-960845e-11,.484101,12922e-9,.644145,-241347e-9,.478968,324578e-9,.64396,-965142e-9,.478831,.00129798,.64396,-.00217154,.47883,.00292046,.643968,-.00386049,.478835,.00519202,.643974,-.00603186,.478838,.0081128,.643977,-.0086854,.478836,.011683,.643982,-.0118207,.478834,.0159031,.644024,-.0154374,.478856,.0207743,.644059,-.0195343,.478868,.0262975,.644122,-.0241103,.478896,.0324747,.644207,-.0291638,.478933,.039309,.64432,-.0346919,.478981,.0468029,.644481,-.0406919,.479053,.0549614,.644722,-.047159,.479169,.0637909,.645013,-.0540748,.479302,.0732974,.645503,-.0612001,.479541,.0834898,.646117,-.0687303,.479829,.0943873,.646707,-.0767846,.480061,.105991,.647431,-.0852465,.480343,.11831,.64831,-.0940719,.48066,.131348,.649486,-.103056,.481083,.14514,.650864,-.112261,.481528,.159676,.652604,-.121852,.482102,.174979,.654825,-.131505,.482813,.191079,.657876,-.141189,.483876,.207927,.661339,-.151239,.48499,.225586,.665463,-.161091,.486279,.243947,.670542,-.171235,.487968,.262957,.677361,-.181347,.49053,.282781,.685672,-.191679,.493862,.303311,.694551,-.201781,.49699,.324607,.703753,-.211164,.498884,.347916,.713703,-.219675,.500086,.372628,.725911,-.227836,.501554,.398694,.73862,-.23533,.502193,.425529,.752118,-.241786,.501811,.453209,.76579,-.247865,.500185,.481381,.779568,-.252696,.497159,.51011,.793991,-.256802,.492765,.539322,.808182,-.259942,.486827,.569078,.821698,-.261703,.478386,.598818,.836009,-.262006,.468772,.629762,.849824,-.260333,.456352,.661366,.863888,-.257398,.442533,.69295,.876585,-.253264,.426573,.723608,.888665,-.248026,.408964,.754378,.899537,-.241487,.389677,.784761,.9094,-.233463,.368516,.814688,.920166,-.223397,.346624,.845009,.928899,-.21255,.322717,.874431,.937156,-.200869,.298698,.902922,.943861,-.188387,.273491,.931356,.949557,-.174341,.247866,.958854,.955862,-.158994,.222496,.986098,.961721,-.143664,.197522,1.01229,.965976,-.127412,.17302,1.03571,.968652,-.109798,.148954,1.05699,.971084,-.0916787,.125044,1.07587,.975584,-.0739634,.100577,1.09372,.98122,-.055322,.0753666,1.10948,.988253,-.0366825,.0498899,1.12394,.99482,-.0180389,.024611,1.13694,1.00001,229839e-9,-188283e-9,1.14919,.613867,-964198e-11,.479449,123452e-10,.621485,-244534e-9,.485399,313091e-9,.621429,-978202e-9,.485353,.00125245,.62112,-.00220004,.485114,.00281687,.621119,-.0039111,.485112,.00500783,.621122,-.00611091,.485112,.00782498,.621133,-.00879922,.485117,.0112687,.621152,-.0119756,.485125,.0153394,.621183,-.0156396,.485139,.0200382,.621227,-.0197898,.485158,.0253663,.621298,-.0244253,.485192,.0313261,.621388,-.0295441,.485233,.0379204,.621507,-.0351432,.485286,.0451523,.621693,-.0412198,.485378,.0530277,.621933,-.0477673,.485495,.0615522,.622232,-.0547574,.485635,.0707316,.622809,-.0619417,.485943,.0805883,.623407,-.069625,.486232,.0911267,.62406,-.077796,.486516,.102354,.624835,-.0863731,.486838,.114279,.625758,-.095251,.487188,.126902,.627043,-.104299,.487695,.140285,.628438,-.113724,.488163,.154397,.630325,-.123417,.488858,.169267,.632801,-.133137,.489754,.184941,.635784,-.143052,.490815,.20136,.639406,-.153132,.492048,.218643,.643872,-.163143,.49363,.236615,.6499,-.17333,.496009,.255449,.657201,-.183622,.498994,.275006,.666221,-.194019,.502888,.295354,.674419,-.204192,.505459,.316244,.683729,-.21406,.507771,.33849,.695584,-.222854,.510245,.363166,.708583,-.231315,.512293,.389071,.721233,-.238911,.512747,.415737,.735134,-.245657,.512482,.443331,.750179,-.251879,.511526,.471891,.765073,-.256911,.508935,.500892,.779794,-.261144,.504341,.530294,.794801,-.264316,.498515,.560144,.810339,-.266276,.491015,.590213,.824818,-.266981,.481126,.620865,.839375,-.265778,.468685,.652687,.853043,-.262748,.453925,.684759,.867335,-.258474,.437912,.716209,.88037,-.253187,.419648,.747508,.891711,-.246476,.39982,.77797,.902896,-.238735,.37879,.808586,.913601,-.22885,.355891,.838843,.923019,-.217656,.331773,.869014,.933432,-.205539,.307356,.898512,.939691,-.192595,.281321,.9269,.946938,-.178945,.255441,.955297,.952372,-.163587,.229013,.983231,.95909,-.147214,.203179,1.00971,.963675,-.13064,.17792,1.03438,.968247,-.113121,.152898,1.05625,.97001,-.0945824,.128712,1.07598,.974458,-.0755648,.103349,1.094,.980168,-.0571998,.0776731,1.1104,.987295,-.0377994,.0514445,1.12491,.994432,-.0186417,.025429,1.13851,.999975,542714e-9,-282356e-9,1.15108,.592656,-980249e-11,.486018,119532e-10,.598467,-247275e-9,.490781,301531e-9,.597934,-988317e-9,.490343,.00120517,.597903,-.00222366,.490319,.0027116,.597913,-.00395315,.490327,.00482077,.597919,-.00617653,.490329,.00753264,.597936,-.00889375,.490339,.0108478,.597956,-.0121043,.490347,.0147668,.597992,-.0158073,.490365,.0192905,.598032,-.0200017,.490382,.0244204,.598109,-.0246865,.49042,.0301593,.598215,-.0298594,.490474,.03651,.59833,-.0355167,.490524,.0434757,.598525,-.0416559,.490624,.0510629,.598778,-.0482692,.490753,.0592781,.599135,-.0553114,.49094,.0681304,.599802,-.062542,.491328,.0776467,.600361,-.0703638,.491598,.0878184,.60101,-.0786256,.491882,.0986573,.601811,-.0872962,.492232,.11018,.602861,-.0962284,.492684,.1224,.604167,-.10538,.493213,.135354,.605693,-.114896,.493799,.149034,.607682,-.124654,.494576,.163469,.610672,-.13456,.4959,.178747,.613313,-.144581,.496713,.194723,.617603,-.154703,.498499,.211617,.622174,-.16489,.500188,.229183,.628855,-.175164,.503072,.247786,.636963,-.185565,.506798,.267116,.644866,-.195911,.509719,.28702,.653741,-.206104,.512776,.307763,.664942,-.216447,.516812,.329631,.67633,-.22552,.519181,.353515,.690012,-.234316,.521681,.379226,.704243,-.242032,.523129,.405901,.719396,-.249172,.523768,.433585,.734471,-.255543,.522541,.462085,.750539,-.260697,.520217,.491233,.766365,-.26501,.516293,.521094,.781677,-.268409,.509708,.551014,.797132,-.270399,.501944,.581463,.812655,-.271247,.492025,.612402,.828592,-.270708,.480424,.643798,.844044,-.268085,.465955,.67682,.857305,-.263459,.448425,.708496,.87114,-.258151,.430243,.74046,.884936,-.251171,.410578,.771583,.895772,-.243305,.38862,.802234,.906961,-.234037,.365214,.833179,.917775,-.222714,.34116,.86353,.927883,-.210175,.31572,.893557,.936617,-.196925,.289159,.922976,.943384,-.182788,.261996,.951606,.949713,-.167965,.235324,.979958,.955818,-.151109,.208408,1.00765,.961344,-.133834,.182591,1.03329,.965469,-.115987,.156958,1.0557,.968693,-.09746,.132239,1.07583,.973165,-.0778514,.106195,1.09451,.979387,-.0585067,.0797669,1.11137,.98671,-.0390409,.0530263,1.12643,.994093,-.019408,.0263163,1.14016,1.00002,540029e-9,-194487e-9,1.15299,.574483,-989066e-11,.494533,114896e-10,.574478,-249127e-9,.494528,289403e-9,.574607,-996811e-9,.494637,.00115797,.574396,-.00224241,.494458,.00260498,.574377,-.00398632,.49444,.00463102,.574386,-.00622836,.494445,.00723623,.574401,-.0089683,.494453,.010421,.574419,-.0122056,.49446,.0141859,.574459,-.0159396,.494481,.0185322,.574525,-.0201692,.49452,.0234617,.574587,-.0248924,.494547,.0289762,.574697,-.0301074,.494604,.0350797,.574853,-.0358114,.494688,.0417767,.575027,-.041999,.494772,.0490718,.575294,-.0486618,.494915,.0569728,.575733,-.0557148,.495173,.0654955,.576356,-.0630489,.495537,.0746612,.576944,-.0709285,.495836,.0844615,.57765,-.0792723,.496177,.0949142,.578491,-.0880167,.496563,.10603,.579639,-.0969462,.497096,.117841,.580989,-.10622,.497684,.130367,.582587,-.115861,.498337,.143609,.584951,-.125605,.499414,.157625,.587602,-.135608,.500518,.172413,.59076,-.145742,.501767,.187999,.594992,-.155934,.503542,.20445,.600656,-.166303,.506135,.221764,.607816,-.176681,.509542,.24002,.61522,-.187071,.51263,.258992,.623702,-.197465,.516021,.278773,.634192,-.207816,.520422,.299377,.644936,-.218183,.524073,.320802,.657888,-.2278,.528049,.34384,.670666,-.236747,.52986,.36916,.685626,-.24484,.531892,.395867,.701304,-.252071,.532727,.423488,.717727,-.258714,.532146,.452201,.733914,-.264211,.529883,.481579,.750529,-.26859,.5259,.511558,.76747,-.272046,.51999,.542042,.785189,-.274225,.513083,.572799,.800954,-.275189,.502936,.603816,.816962,-.274946,.490921,.635461,.83336,-.272695,.47684,.6676,.848143,-.268223,.459405,.70051,.861818,-.262768,.440319,.732902,.876828,-.255872,.420123,.765084,.889312,-.247703,.398379,.796391,.900412,-.238381,.374496,.827333,.912251,-.227783,.349874,.858385,.921792,-.214832,.323181,.888652,.931273,-.200949,.296624,.917763,.940295,-.186537,.269211,.947878,.946812,-.171538,.241447,.977016,.953588,-.155254,.213829,1.00501,.958841,-.137156,.186807,1.03179,.963746,-.118699,.160706,1.05502,.966468,-.0998358,.135504,1.07568,.971178,-.0805186,.109131,1.09479,.97831,-.0599348,.0818293,1.1123,.985886,-.0399661,.0545872,1.12771,.994021,-.0198682,.0269405,1.14186,1.00009,271022e-9,-12989e-8,1.15514,.538716,-990918e-11,.486732,109675e-10,.550656,-250642e-9,.497518,277412e-9,.55057,-.00100265,.497441,.00110974,.550903,-.00225672,.497733,.00249779,.550568,-.00401046,.497438,.00443906,.550574,-.00626613,.49744,.00693637,.550591,-.0090226,.497449,.00998921,.550623,-.0122795,.497469,.0135984,.550667,-.0160361,.497495,.0177654,.550724,-.0202908,.497526,.0224915,.550792,-.0250421,.497557,.0277795,.550918,-.0302878,.49763,.0336334,.551058,-.0360241,.497701,.0400573,.551276,-.0422473,.497824,.0470585,.551551,-.0489441,.497977,.0546433,.552074,-.0559596,.498312,.0628367,.552681,-.0633978,.498679,.071646,.553324,-.0713176,.499031,.0810746,.554011,-.0797268,.499365,.091129,.55488,-.0885238,.499779,.101837,.556171,-.0974417,.500444,.113239,.557498,-.106841,.501025,.125316,.559299,-.116533,.501864,.138128,.561647,-.126298,.502967,.151695,.564347,-.136388,.504129,.16604,.567863,-.146576,.505713,.181207,.572569,-.156832,.507953,.197259,.578919,-.167323,.511186,.214258,.585387,-.177712,.514042,.232038,.593134,-.188184,.517484,.250733,.603295,-.198717,.522345,.270454,.613854,-.209177,.526751,.290807,.626092,-.219644,.531595,.312202,.637868,-.229494,.534721,.334435,.652458,-.238718,.538304,.359184,.666985,-.247061,.539875,.385637,.683301,-.254652,.541042,.41328,.69998,-.261376,.540735,.441903,.717824,-.267085,.539139,.471609,.734617,-.271465,.534958,.501446,.753663,-.27528,.53032,.532571,.770512,-.277617,.522134,.563641,.787356,-.278525,.51206,.595067,.806252,-.278512,.50119,.627226,.822061,-.277023,.486791,.659402,.838959,-.273175,.470467,.692874,.85379,-.267238,.450688,.725702,.868268,-.260327,.429741,.75832,.881994,-.251946,.407223,.790189,.893885,-.242432,.383214,.821625,.905118,-.231904,.357297,.853011,.916045,-.219545,.330733,.883773,.927614,-.205378,.303916,.914435,.936005,-.190388,.275941,.944502,.944533,-.1749,.247493,.974439,.950758,-.158588,.218996,1.00286,.957078,-.141027,.191559,1.0304,.962448,-.121507,.164457,1.05466,.964993,-.102068,.138636,1.0761,.970017,-.0822598,.111861,1.09541,.97661,-.062033,.0843438,1.11317,.985073,-.0409832,.0558496,1.12911,.993515,-.020146,.0275331,1.1438,1.00006,27329e-8,-107883e-9,1.15736,.525324,-999341e-11,.498153,105385e-10,.526513,-251605e-9,.499277,265329e-9,.526517,-.00100641,.499282,.0010613,.526588,-.00226466,.499337,.00238823,.526539,-.0040255,.499302,.00424535,.526547,-.00628954,.499306,.00663364,.526561,-.00905628,.499313,.00955337,.526593,-.0123253,.499334,.0130054,.526642,-.0160957,.499365,.0169911,.5267,-.0203661,.499396,.0215122,.526792,-.0251347,.499451,.0265718,.526904,-.0303985,.499511,.0321732,.527079,-.0361554,.499617,.0383231,.527285,-.0423982,.499731,.045026,.527602,-.0491121,.499924,.0522936,.528166,-.0561127,.500306,.0601528,.52879,-.0635988,.5007,.0686059,.529421,-.071581,.501048,.0776518,.530144,-.0799854,.501421,.0873148,.531062,-.0888032,.501884,.0976084,.532374,-.0977643,.50259,.108588,.533828,-.107197,.50329,.120234,.53581,-.116887,.504312,.132602,.538063,-.126755,.505365,.145721,.5409,-.136819,.506668,.159617,.544882,-.147117,.508731,.174369,.550238,-.157446,.511601,.190028,.556038,-.167988,.514431,.206587,.563031,-.178364,.517808,.224046,.571543,-.189007,.521937,.242503,.582255,-.199546,.527415,.261977,.59272,-.210084,.531682,.282162,.605648,-.220448,.537123,.303426,.61785,-.230593,.540664,.325323,.632223,-.240238,.544467,.348993,.648819,-.24887,.547594,.375462,.665825,-.256657,.54912,.403024,.683389,-.263711,.549294,.431773,.701495,-.269666,.547649,.461494,.719197,-.274169,.543786,.491623,.737906,-.278124,.538644,.522994,.756652,-.280632,.531057,.554775,.775279,-.281741,.521972,.586441,.792688,-.281652,.509613,.618596,.811894,-.280345,.496497,.651462,.827938,-.277128,.47968,.684023,.844837,-.271646,.460688,.718024,.859239,-.264397,.438872,.751207,.874088,-.256144,.41577,.784232,.887693,-.246311,.391369,.816191,.899402,-.235497,.365872,.847828,.910973,-.223631,.338618,.87934,.92204,-.209874,.310803,.910325,.930987,-.194265,.281802,.940695,.94,-.178125,.252836,.970958,.948018,-.161479,.224239,1.00078,.955141,-.144038,.195857,1.0288,.960513,-.124915,.168487,1.05371,.963964,-.104284,.141495,1.07596,.968713,-.0838732,.114437,1.09628,.975524,-.0635579,.0863105,1.11448,.98431,-.042291,.0574774,1.13069,.992916,-.0209131,.0284343,1.14568,.999926,743097e-9,-379265e-9,1.15955,.501042,-998428e-11,.498726,100306e-10,.502992,-252112e-9,.500665,253283e-9,.502417,-.00100791,.500092,.00101259,.502965,-.00226919,.500621,.00227978,.502318,-.00403109,.499994,.00405011,.502333,-.00629832,.500005,.00632868,.502362,-.00906907,.500027,.00911446,.502369,-.0123423,.500023,.0124078,.50243,-.0161178,.500066,.016211,.502493,-.0203937,.500103,.0205256,.502592,-.0251684,.500166,.0253548,.502707,-.0304389,.50023,.0307029,.502881,-.0362015,.500335,.0365753,.503124,-.0424507,.500488,.0429798,.503443,-.0491582,.500686,.0499268,.504083,-.0561476,.501155,.0574541,.504668,-.0636846,.501524,.0655408,.505319,-.0716834,.501904,.0742072,.50609,-.0800925,.502321,.0834699,.507122,-.0888425,.502896,.0933603,.508414,-.097855,.503603,.10391,.509955,-.107304,.504416,.115113,.512061,-.116921,.505565,.127054,.514419,-.12689,.506732,.139709,.517529,-.136934,.508338,.153173,.522085,-.147327,.510987,.167528,.526986,-.157612,.513527,.182708,.533122,-.168213,.516717,.198881,.540807,-.178688,.520832,.215986,.550687,-.189511,.52632,.234335,.560567,-.199998,.531009,.253375,.571698,-.210652,.535839,.273499,.584364,-.220917,.541091,.294355,.599066,-.23137,.546875,.316525,.614148,-.241206,.551306,.339671,.631157,-.250379,.555187,.36531,.647919,-.258397,.556595,.392767,.666112,-.265528,.556949,.421397,.686158,-.271827,.556617,.451433,.704838,-.27674,.552975,.482131,.723957,-.280733,.547814,.513458,.74262,-.283359,.53997,.545446,.762009,-.284541,.530422,.57775,.781314,-.284507,.518546,.610434,.799116,-.283309,.504178,.643178,.817604,-.280378,.48843,.676248,.83459,-.275619,.469457,.709698,.850974,-.26856,.447698,.744245,.866747,-.260094,.424791,.777695,.881412,-.249929,.399913,.810392,.8936,-.239137,.37308,.842872,.905943,-.226818,.345705,.874677,.916408,-.213699,.31706,.906257,.927215,-.198428,.288444,.936881,.935625,-.181643,.258329,.96795,.944076,-.164386,.228488,.998216,.951229,-.146339,.199763,1.02689,.958793,-.127709,.172153,1.0535,.963219,-.107244,.144989,1.07646,.967562,-.0857764,.11685,1.09675,.974866,-.0645377,.0880571,1.11576,.983353,-.0431732,.0587352,1.13227,.992503,-.0218356,.0294181,1.1478,1.00003,605203e-9,-231013e-9,1.16207,.482935,-101177e-10,.504695,968142e-11,.477554,-251521e-9,.499071,240676e-9,.477904,-.00100683,.499436,96342e-8,.478368,-.00226636,.499899,.0021687,.477977,-.00402719,.499513,.00385384,.477993,-.00629226,.499525,.0060221,.478011,-.00906011,.499536,.00867289,.478051,-.0123305,.499566,.0118074,.478089,-.016102,.499587,.0154269,.478171,-.0203736,.499645,.0195341,.478254,-.025143,.499692,.0241318,.47839,-.0304071,.499779,.0292247,.478588,-.0361631,.499911,.0348196,.478812,-.0424023,.500046,.0409231,.479208,-.0490724,.500326,.047552,.479841,-.0560722,.500805,.0547377,.480392,-.0636125,.501152,.0624607,.481068,-.0716134,.501561,.0707473,.481898,-.0800062,.502054,.0796118,.483022,-.0886568,.502728,.0890974,.484332,-.0977553,.503479,.0992099,.486126,-.107173,.504546,.10999,.488066,-.11677,.50557,.121476,.490521,-.126725,.506849,.133672,.494232,-.136793,.50911,.146731,.498302,-.147116,.511345,.160577,.503565,-.157446,.514344,.175335,.510902,-.168121,.518824,.191207,.519263,-.178799,.523666,.208058,.528204,-.189407,.528296,.225875,.538854,-.200145,.533724,.244782,.551278,-.210701,.539833,.264753,.565222,-.221303,.546131,.285745,.579403,-.231688,.551496,.307592,.595469,-.241718,.556809,.330582,.610929,-.250992,.559641,.354995,.629433,-.259602,.562379,.382471,.648504,-.267038,.563676,.411126,.66756,-.273388,.562092,.440924,.689143,-.278788,.560807,.472118,.709056,-.282783,.555701,.503774,.729855,-.285836,.548698,.536364,.748954,-.287078,.538544,.56895,.768373,-.287133,.526711,.601991,.78827,-.285839,.512511,.635403,.807465,-.283238,.496323,.668797,.825194,-.27906,.477638,.702584,.842203,-.272286,.456253,.736393,.857749,-.263854,.432412,.77096,.874799,-.253943,.407806,.80489,.887497,-.24237,.38033,.83771,.89966,-.230278,.352446,.870376,.911753,-.21646,.323268,.902256,.923011,-.202071,.294314,.933306,.932375,-.185519,.264104,.965177,.940537,-.167604,.234035,.996303,.948904,-.149068,.20412,1.0261,.955263,-.129539,.175431,1.05304,.960303,-.109932,.148116,1.07617,.965512,-.0880572,.119693,1.09742,.973466,-.0660548,.0901619,1.11721,.98284,-.0439228,.0599875,1.13436,.992216,-.0219588,.0298975,1.15006,.999946,119402e-9,-208547e-10,1.16471,.447827,-100414e-10,.491543,914833e-11,.454778,-251257e-9,.499172,22891e-8,.453519,-.00100342,.497787,914184e-9,.45357,-.00225776,.497847,.00205701,.453578,-.00401371,.497855,.00365705,.45357,-.00627107,.497841,.00571453,.453598,-.00902968,.497864,.00823019,.453627,-.0122888,.497882,.0112049,.453684,-.0160475,.497923,.0146405,.453764,-.0203044,.49798,.0185394,.453866,-.0250576,.498049,.0229054,.453996,-.0303028,.49813,.0277424,.454196,-.0360379,.498267,.0330587,.454457,-.0422521,.498445,.0388613,.454926,-.0488393,.498812,.0451767,.455525,-.0558653,.499272,.0520153,.456074,-.0633772,.499625,.0593754,.456752,-.0713606,.500049,.0672751,.457648,-.07971,.500615,.0757447,.458849,-.0883032,.501399,.0848231,.46029,-.0974095,.502293,.0945135,.462,-.106729,.503301,.104848,.464121,-.116354,.504533,.115884,.466889,-.126214,.506172,.127652,.470744,-.136324,.508667,.14024,.47488,-.146595,.510995,.153673,.480845,-.157027,.514832,.168053,.488262,-.167658,.519506,.183508,.496547,-.178343,.524347,.199948,.506254,-.188916,.52983,.217503,.517961,-.199975,.536357,.236272,.531484,-.210624,.543641,.256096,.545496,-.221227,.550048,.277085,.559497,-.231568,.555076,.298615,.575752,-.241698,.560541,.321547,.591999,-.251172,.564156,.345602,.610654,-.260178,.567607,.371851,.630484,-.268094,.56923,.40076,.651807,-.274661,.569779,.430801,.67239,-.280331,.566791,.461939,.693024,-.284501,.562007,.493854,.715473,-.287852,.555791,.526992,.736323,-.28929,.546345,.560102,.755771,-.289405,.534,.593543,.775424,-.2881,.519114,.627256,.795447,-.285562,.502543,.661464,.815319,-.281416,.484773,.695206,.831769,-.275523,.463445,.729044,.849464,-.267516,.440269,.764069,.866775,-.257584,.415049,.799089,.881252,-.245817,.388049,.831948,.894209,-.233127,.35889,.865526,.906922,-.219579,.329915,.89818,.919686,-.204491,.300441,.930013,.929044,-.188962,.269445,.962061,.938393,-.171079,.238402,.994214,.94661,-.15199,.208204,1.02533,.953095,-.131953,.178653,1.0529,.958644,-.111233,.150684,1.0771,.963925,-.0903098,.122359,1.09855,.971995,-.0680505,.0923342,1.11874,.981658,-.0448512,.0614195,1.13635,.991649,-.0221931,.0303582,1.15238,.999985,393403e-9,-111086e-9,1.16772,.396806,-971563e-11,.457671,842355e-11,.429186,-249421e-9,.495017,21625e-8,.429324,-998052e-9,.495173,865322e-9,.429175,-.00224487,.494999,.00194637,.429129,-.00399041,.494952,.00346004,.429153,-.00623476,.494974,.00540684,.429168,-.0089773,.494983,.00778714,.429207,-.0122175,.495012,.0106022,.429257,-.0159542,.495047,.0138535,.429338,-.0201864,.495106,.0175443,.429431,-.0249104,.495165,.0216774,.429587,-.0301252,.495279,.0262594,.429796,-.0358249,.495432,.0312968,.430065,-.0419972,.495621,.0367985,.430588,-.0485144,.496061,.042798,.43113,-.0555028,.496472,.0492914,.431743,-.0629852,.496904,.0562907,.432448,-.0709256,.497369,.0638056,.433414,-.0791942,.498032,.071885,.434638,-.0877346,.498854,.0805517,.43611,-.0968056,.499812,.0898047,.437859,-.106002,.500891,.0997142,.440017,-.115648,.502198,.110289,.443236,-.125427,.504389,.121644,.44697,-.135492,.506809,.133769,.451689,-.145746,.509858,.146787,.45811,-.156219,.514247,.160793,.465305,-.166834,.518816,.175791,.474085,-.177546,.524331,.191906,.484808,-.188262,.53104,.209199,.49732,-.199346,.538511,.227825,.509693,-.209951,.544554,.247269,.524367,-.220533,.551616,.267978,.539228,-.231082,.557368,.289672,.55644,-.241342,.563782,.31268,.574204,-.250964,.568851,.33651,.593388,-.260306,.57312,.362219,.613358,-.268667,.574916,.390322,.634512,-.275591,.575053,.420478,.65563,-.281328,.572404,.451614,.678265,-.285948,.568893,.484112,.70011,-.289408,.561878,.517348,.723005,-.291328,.55359,.551355,.743744,-.291418,.541099,.585109,.763949,-.290252,.526489,.619487,.784186,-.287648,.509496,.65404,.804304,-.283782,.491484,.688649,.823629,-.278067,.470517,.723133,.84094,-.270588,.44705,.757163,.857852,-.261188,.421252,.792816,.874934,-.249313,.394191,.827248,.888709,-.236492,.365359,.861074,.902589,-.222185,.336016,.894417,.914201,-.207314,.30527,.926825,.925978,-.191146,.274532,.9595,.93512,-.174135,.243393,.991583,.943656,-.155231,.212414,1.02356,.951719,-.134403,.182005,1.05239,.957164,-.113023,.153043,1.07754,.962656,-.0914493,.124186,1.09984,.970695,-.0694179,.0941654,1.12,.980749,-.0466199,.0629671,1.13849,.991205,-.0227032,.0311146,1.15494,.999884,632388e-9,-254483e-9,1.1706,.379821,-957289e-11,.460637,789337e-11,.405188,-247483e-9,.491396,204064e-9,.404796,-989434e-9,.490914,815853e-9,.40483,-.00222607,.490949,.00183559,.40473,-.00395723,.49084,.00326332,.404731,-.00618287,.490836,.00509945,.404768,-.00890258,.490871,.00734463,.404791,-.0121156,.490883,.00999992,.404857,-.0158214,.490938,.0130676,.404943,-.0200178,.491004,.0165503,.405059,-.0247027,.491093,.0204521,.405213,-.0298729,.491205,.0247788,.405399,-.0355226,.491333,.0295373,.405731,-.0416352,.491604,.034741,.406303,-.0480807,.492116,.0404255,.406814,-.0550458,.492506,.0465732,.407404,-.0624652,.492926,.0532058,.408149,-.0702958,.493442,.0603442,.409128,-.0784623,.494136,.0680297,.410408,-.087007,.495054,.0762786,.411813,-.0959639,.495962,.0851046,.413735,-.105075,.497257,.0945878,.416137,-.114646,.498882,.104725,.41934,-.124394,.501132,.11563,.423326,-.134328,.503883,.127325,.428419,-.14458,.50747,.139911,.43484,-.154979,.511964,.153481,.442641,-.165628,.517328,.168114,.452511,-.176365,.524258,.183995,.463473,-.187298,.531248,.200953,.475564,-.198244,.538367,.219176,.488664,-.208938,.545175,.238514,.504073,-.219599,.553227,.259129,.520832,-.230378,.560653,.280997,.538455,-.240703,.567523,.303821,.55709,-.250548,.573287,.327948,.576646,-.259964,.577795,.353362,.596705,-.268721,.580077,.380336,.618053,-.276054,.58018,.4101,.640303,-.282176,.578747,.44161,.662365,-.286931,.574294,.474106,.684542,-.290521,.567035,.507549,.707984,-.292672,.558687,.541853,.730913,-.293189,.547606,.576581,.752948,-.292199,.533471,.61172,.773452,-.289508,.516395,.646339,.794715,-.285716,.497873,.682131,.814251,-.280051,.476845,.716396,.833057,-.272873,.453449,.751503,.84959,-.263982,.427857,.786085,.867022,-.252745,.400335,.821355,.882277,-.239655,.371304,.85646,.895375,-.225386,.340397,.890828,.909347,-.209587,.310005,.923532,.921885,-.193433,.2796,.956419,.932127,-.176135,.247276,.989445,.941869,-.157872,.216186,1.02221,.949735,-.137577,.185602,1.05195,.956617,-.115285,.155767,1.07822,.961974,-.0928418,.126103,1.10149,.96972,-.0700592,.0956758,1.12207,.98012,-.0474671,.0643269,1.1408,.990825,-.0238113,.0320863,1.1577,.999876,381574e-9,-812203e-10,1.17403,.367636,-961342e-11,.469176,753287e-11,.380377,-244772e-9,.485434,191797e-9,.380416,-978857e-9,.485475,767015e-9,.380376,-.00220165,.485435,.00172522,.380419,-.00391408,.485487,.00306734,.380438,-.00611549,.485505,.00479332,.380462,-.00880558,.485525,.00690391,.380496,-.0119837,.485551,.00940039,.38056,-.0156487,.485605,.0122848,.38064,-.0197988,.485666,.0155601,.380767,-.0244324,.48577,.0192313,.380909,-.0295444,.485871,.0233032,.381142,-.0351321,.48606,.0277861,.381472,-.0411535,.486336,.0326939,.382015,-.0475408,.486833,.0380565,.382523,-.0544395,.487231,.0438615,.383129,-.061784,.487683,.0501332,.383952,-.0695085,.488313,.0568996,.38498,-.0775819,.489077,.0641952,.386331,-.0860443,.490113,.0720324,.387788,-.0948406,.491099,.0804379,.389808,-.103899,.492566,.0894899,.39252,-.113313,.494601,.0992098,.395493,-.123007,.496619,.109641,.399826,-.132859,.499912,.120919,.405341,-.143077,.504061,.133107,.411932,-.153465,.508905,.146263,.420591,-.164108,.515482,.160544,.43101,-.174893,.523191,.176123,.441881,-.185839,.53026,.192757,.453919,-.196633,.537295,.210535,.468715,-.207611,.546156,.229886,.485182,-.218517,.555173,.250543,.501926,-.229249,.562728,.27221,.51785,-.239481,.567494,.294892,.536947,-.249395,.573889,.318987,.557115,-.259,.578831,.344348,.577966,-.268075,.582055,.371223,.599489,-.276115,.583307,.399834,.62479,-.282523,.583902,.431415,.647504,-.287663,.57953,.464301,.670601,-.291538,.573103,.498123,.693539,-.293842,.563731,.532662,.717385,-.294681,.553169,.567925,.741533,-.293717,.539908,.603502,.762142,-.291156,.521902,.639074,.783014,-.28719,.502815,.674439,.805158,-.281773,.482598,.710497,.823646,-.274682,.458949,.7456,.841879,-.266184,.433129,.781085,.859515,-.255682,.406064,.816,.875335,-.242849,.376509,.851074,.890147,-.228329,.345502,.886473,.903144,-.212491,.31428,.920751,.916618,-.195695,.282994,.954606,.927953,-.178267,.251091,.988402,.937414,-.159549,.219107,1.02141,.946823,-.140022,.18896,1.05167,.954651,-.118154,.158667,1.07819,.959955,-.0946636,.128808,1.1025,.96858,-.0711792,.0973787,1.12391,.97938,-.0475046,.0650965,1.14322,.990498,-.024059,.0326267,1.16077,.999844,-512408e-10,112444e-9,1.17727,.316912,-934977e-11,.425996,695559e-11,.356423,-241372e-9,.479108,179562e-9,.356272,-965292e-9,.478897,71811e-8,.356262,-.00217182,.478894,.00161574,.356265,-.00386092,.478895,.00287261,.356278,-.0060324,.478905,.00448907,.356293,-.00868565,.478914,.00646572,.356346,-.0118207,.478965,.00880438,.356395,-.0154355,.479001,.0115066,.356484,-.019529,.479075,.0145762,.356609,-.0240991,.47918,.018018,.356766,-.0291413,.479305,.0218379,.357009,-.0346498,.479512,.0260454,.357424,-.0405462,.479909,.0306657,.357899,-.0468825,.480337,.0357054,.358424,-.0536887,.480771,.0411728,.359041,-.0609416,.481242,.0470841,.359903,-.0685239,.481943,.0534831,.360932,-.0764883,.482741,.0603795,.362196,-.0848364,.483688,.0678028,.363847,-.0935002,.484947,.0758086,.365972,-.102471,.486588,.0844173,.368741,-.111751,.488787,.0937199,.372146,-.121334,.491405,.103732,.377114,-.131147,.495604,.114608,.38226,-.141213,.499436,.126345,.389609,-.151632,.505334,.139116,.397925,-.162073,.51168,.152995,.407824,-.172819,.518876,.168071,.420014,-.183929,.527639,.184495,.434266,-.195032,.537588,.20232,.447352,-.205792,.544379,.221189,.463726,-.216704,.553422,.241616,.481406,-.227531,.562074,.263298,.498707,-.238017,.568227,.286116,.518039,-.247936,.574473,.3101,.538277,-.257437,.579191,.335401,.561166,-.266829,.584807,.362246,.583189,-.275329,.586476,.390609,.606024,-.28234,.585578,.420998,.632419,-.287924,.584496,.454357,.656128,-.291972,.577766,.488233,.679953,-.29456,.56875,.523248,.704654,-.295816,.558388,.559168,.729016,-.295157,.544826,.595326,.752062,-.292779,.528273,.631864,.773138,-.288681,.508482,.667793,.794869,-.283358,.487341,.704035,.815101,-.27608,.46354,.739925,.834212,-.26767,.438672,.775539,.852368,-.257397,.411239,.810895,.870207,-.245689,.3829,.846472,.884063,-.231452,.351496,.881788,.898284,-.215561,.31895,.917438,.912964,-.198208,.287367,.952422,.924666,-.180426,.254487,.987551,.934429,-.161525,.222226,1.02142,.943485,-.141197,.191143,1.05218,.9521,-.120085,.161112,1.07937,.957876,-.0975881,.130982,1.10403,.966943,-.0726842,.0990553,1.12616,.978313,-.0483705,.0662818,1.14619,.990048,-.0239072,.0329243,1.16413,.999984,461885e-9,-772859e-10,1.18099,.321287,-935049e-11,.455413,659662e-11,.332595,-237513e-9,.471437,167562e-9,.332729,-949964e-9,.471618,670192e-9,.332305,-.00213618,.471028,.00150712,.332326,-.00379765,.471055,.00267959,.332344,-.00593353,.471072,.00418751,.332356,-.00854349,.471077,.00603172,.332403,-.0116268,.471121,.00821362,.332461,-.0151824,.47117,.0107357,.332552,-.0192088,.471251,.0136014,.332657,-.0237024,.47133,.0168152,.332835,-.0286615,.471487,.0203853,.333083,-.0340765,.471708,.0243212,.333547,-.0398563,.47219,.0286518,.333989,-.0460916,.472587,.0333763,.334532,-.0527897,.473054,.0385084,.335167,-.0599284,.473568,.0440638,.33608,-.0673514,.474362,.0500962,.337146,-.0752237,.475231,.0566022,.338462,-.083418,.476282,.0636272,.34014,-.0919382,.477615,.0712153,.342341,-.100741,.479404,.079417,.345088,-.109905,.481618,.0882631,.349049,-.119369,.485081,.0978851,.353939,-.129033,.489317,.108336,.359893,-.139038,.494309,.119698,.366945,-.149411,.499983,.132024,.375814,-.159843,.507185,.145558,.387112,-.170664,.516392,.160433,.40023,-.181897,.526519,.176648,.412555,-.192785,.53423,.193922,.427023,-.203663,.542741,.212662,.443685,-.214695,.552066,.232944,.461499,-.225561,.560762,.254495,.480975,-.236257,.569421,.277531,.501,-.24639,.576101,.301724,.521691,-.256101,.581493,.327112,.543478,-.265289,.585221,.353917,.566094,-.273938,.587614,.381941,.589578,-.281679,.587991,.41172,.614583,-.287655,.585928,.444148,.641813,-.292228,.582092,.478617,.666189,-.295172,.57398,.51397,.690475,-.29648,.561676,.550118,.715543,-.296203,.548758,.586933,.740405,-.293999,.532792,.62384,.762183,-.28998,.512735,.660723,.786069,-.28478,.492402,.69807,.806812,-.277568,.469058,.734422,.826987,-.268951,.443017,.770946,.844588,-.259049,.415501,.80699,.863725,-.2471,.387328,.842107,.879137,-.234157,.356108,.878078,.894634,-.218719,.324315,.914058,.909162,-.201293,.291813,.949922,.92072,-.18267,.258474,.985337,.93158,-.163212,.225593,1.0205,.941238,-.142771,.193986,1.05273,.949293,-.120956,.163392,1.08075,.956226,-.0985743,.132934,1.10559,.96546,-.075118,.101255,1.12823,.977403,-.0497921,.0675441,1.149,.989648,-.0241574,.0334681,1.16765,1.00001,5762e-7,-184807e-9,1.18519,.303474,-916603e-11,.4542,61243e-10,.308894,-232869e-9,.462306,155592e-9,.309426,-931661e-9,.463093,622499e-9,.308643,-.0020949,.461933,.00139979,.308651,-.0037242,.461941,.00248874,.308662,-.00581873,.46195,.00388933,.308687,-.00837818,.461974,.00560247,.308728,-.0114016,.462011,.00762948,.308789,-.0148884,.462067,.00997326,.308882,-.0188369,.462151,.0126375,.309007,-.0232436,.462263,.0156271,.30918,-.0281054,.462417,.0189498,.309442,-.0334065,.462667,.0226167,.309901,-.0390589,.463162,.0266614,.310331,-.0452042,.463555,.0310715,.310858,-.0517735,.464019,.0358698,.311576,-.0587359,.464669,.0410848,.312436,-.0660383,.465406,.0467453,.313526,-.0737266,.466339,.0528718,.314903,-.0817574,.467504,.0595039,.316814,-.090167,.469226,.0666888,.318965,-.0987555,.470981,.0744658,.322077,-.107792,.473814,.082912,.325947,-.117098,.477241,.0920846,.331008,-.126602,.48184,.102137,.337893,-.136619,.488334,.113135,.345106,-.146838,.494415,.12511,.355111,-.157357,.503275,.138356,.365095,-.167955,.510966,.152686,.378344,-.179157,.521508,.16856,.391599,-.190143,.530455,.18561,.407786,-.20123,.541275,.204308,.425294,-.212456,.551784,.224623,.444021,-.223568,.561493,.246172,.463418,-.234154,.569886,.268979,.484077,-.244546,.577116,.293411,.505513,-.254301,.582914,.318936,.527672,-.263564,.587208,.345856,.550565,-.272332,.589277,.374054,.573656,-.280011,.588426,.403276,.59827,-.286924,.587504,.43474,.624731,-.291994,.583401,.468767,.652396,-.295159,.576997,.504411,.67732,-.296954,.565863,.54114,.703147,-.296877,.552316,.57816,.728715,-.295147,.536773,.616124,.752448,-.291275,.51771,.653885,.775169,-.285905,.496087,.691537,.799307,-.279064,.474232,.729251,.819482,-.270294,.447676,.766267,.837659,-.260032,.419656,.802616,.856903,-.248497,.391328,.838583,.873325,-.235252,.360285,.874711,.889788,-.221126,.329215,.91077,.904486,-.204304,.296392,.94653,.917711,-.185562,.262159,.983828,.928969,-.165635,.229142,1.01955,.939707,-.14442,.19673,1.05317,.948167,-.122147,.165095,1.0823,.955222,-.099098,.13451,1.10791,.964401,-.0755332,.102476,1.1312,.976605,-.0513817,.0689667,1.15218,.989085,-.0258499,.034506,1.17129,.999908,617773e-9,-271268e-9,1.18961,.285803,-905752e-11,.452348,572272e-11,.284689,-22732e-8,.450581,143626e-9,.285263,-910214e-9,.451482,575099e-9,.285302,-.00204784,.451553,.00129395,.285318,-.00364057,.451574,.0023006,.28533,-.00568813,.451585,.00359547,.285361,-.00819001,.451618,.00517934,.285397,-.0111458,.45165,.007054,.285447,-.0145536,.451688,.00922167,.285527,-.0184127,.451758,.0116869,.285688,-.0227207,.451929,.0144555,.28584,-.0274712,.452055,.0175341,.286136,-.0326278,.452369,.0209406,.286574,-.0381792,.452853,.0246965,.287012,-.0441879,.453272,.0287996,.287542,-.0506096,.453752,.033268,.288299,-.0573634,.454488,.0381504,.289186,-.0645458,.455294,.0434447,.290302,-.0720405,.456301,.0491973,.291776,-.0799046,.457648,.0554453,.29372,-.088117,.459483,.0622311,.296052,-.0965328,.461571,.0695992,.299563,-.105409,.465085,.077658,.30335,-.114553,.468506,.0864176,.309167,-.123917,.474423,.0961078,.31529,-.13381,.47995,.106643,.324163,-.144021,.488592,.118322,.333272,-.154382,.496461,.131133,.344224,-.165015,.50562,.145208,.357733,-.176168,.516719,.16073,.373046,-.187468,.528513,.177807,.38788,-.198488,.537713,.196072,.405133,-.209545,.547999,.21605,.423845,-.220724,.55759,.237484,.443777,-.231518,.566246,.26039,.464824,-.242035,.574326,.284835,.486635,-.251898,.58037,.310518,.51012,-.261304,.58568,.337678,.535301,-.270384,.590197,.366242,.559193,-.27841,.590569,.395873,.583544,-.285325,.588161,.426857,.608834,-.291113,.584249,.459477,.635753,-.294882,.57763,.494734,.664367,-.297088,.569479,.532023,.689688,-.297364,.555064,.569629,.715732,-.295949,.539522,.608124,.741307,-.292259,.521613,.646231,.764949,-.287063,.49969,.684938,.788599,-.28012,.476747,.723548,.81048,-.27153,.45116,.761135,.831372,-.261289,.424101,.798916,.850092,-.249559,.39443,.835952,.867777,-.236348,.363849,.871606,.884632,-.221569,.332477,.907843,.90047,-.20618,.300667,.944187,.914524,-.188771,.266552,.981371,.926892,-.168362,.232349,1.01841,.937951,-.146761,.199359,1.05308,.947236,-.123813,.1675,1.0839,.954367,-.099984,.136166,1.11047,.963907,-.0759278,.103808,1.13414,.976218,-.0511367,.0697061,1.15575,.988772,-.0267415,.0352529,1.17531,.999888,-520778e-9,289926e-9,1.19389,.263546,-883274e-11,.441896,526783e-11,.262352,-221849e-9,.439889,132311e-9,.262325,-886683e-9,.439848,528824e-9,.26228,-.00199476,.439765,.00118975,.262372,-.00354671,.439922,.00211568,.26239,-.00554141,.439941,.00330652,.262412,-.00797888,.439961,.00476346,.262453,-.0108584,.440002,.00648818,.262528,-.0141788,.440085,.0084835,.262615,-.017938,.440166,.0107533,.262744,-.0221346,.440291,.0133044,.262939,-.026762,.440493,.0161445,.263277,-.0317573,.440889,.0192974,.26368,-.0371832,.441338,.0227699,.264106,-.0430371,.441753,.0265698,.264624,-.0493035,.442227,.0307178,.265378,-.0558669,.442985,.0352616,.266253,-.0628718,.443795,.0401968,.267478,-.0701569,.445008,.04559,.269062,-.077845,.446599,.0514539,.270926,-.0857941,.448349,.0578382,.273693,-.0940773,.451221,.0648363,.276746,-.102704,.454097,.0724389,.281693,-.111735,.459517,.0808744,.287335,-.121004,.46531,.0901551,.29448,-.130734,.472605,.100371,.30257,-.140777,.480251,.111644,.312465,-.15111,.489444,.124111,.324856,-.16189,.500919,.137979,.33774,-.172946,.511317,.153163,.35255,-.184152,.522684,.169817,.367786,-.19522,.53248,.187886,.385474,-.20632,.543326,.207634,.404976,-.217744,.554109,.229165,.425203,-.228691,.563395,.252068,.446704,-.239299,.571565,.276471,.468951,-.249348,.577935,.302323,.493487,-.258933,.584309,.329882,.517861,-.268009,.58773,.358525,.543309,-.276238,.589612,.388585,.569704,-.28356,.589294,.419787,.594871,-.289497,.585137,.452114,.622555,-.294452,.580356,.486466,.651167,-.296918,.57185,.523079,.677332,-.297647,.558428,.5611,.703718,-.296321,.542232,.599592,.730262,-.293339,.524541,.639138,.754304,-.288036,.502691,.677978,.778051,-.281018,.479212,.716537,.801557,-.272414,.454071,.75586,.822559,-.262419,.425952,.794477,.843051,-.250702,.397313,.832664,.86232,-.237264,.366534,.869876,.879044,-.222716,.334816,.906973,.896362,-.206827,.303143,.943558,.910342,-.189659,.269699,.979759,.924119,-.171108,.236411,1.01718,.935374,-.149579,.202224,1.05289,.944295,-.126295,.16989,1.08496,.952227,-.101511,.138089,1.11256,.962041,-.0766392,.105053,1.1375,.97528,-.0511967,.070329,1.15983,.988476,-.025463,.0351268,1.17987,.999962,286808e-10,145564e-10,1.19901,.227089,-841413e-11,.404216,472707e-11,.239725,-215083e-9,.426708,120833e-9,.239904,-860718e-9,.427028,483555e-9,.239911,-.00193661,.427039,.00108806,.239914,-.00344276,.42704,.00193457,.239933,-.00537907,.427064,.00302363,.239944,-.00774482,.427065,.00435604,.239993,-.01054,.427122,.00593398,.240052,-.0137626,.427179,.00775987,.240148,-.0174115,.427279,.00983854,.240278,-.021484,.42741,.0121763,.240472,-.0259729,.427618,.0147827,.240839,-.0308131,.428086,.0176837,.241201,-.0360893,.428482,.0208775,.241626,-.0417723,.428907,.0243821,.242207,-.0478337,.42952,.0282228,.24298,-.0542199,.430332,.0324333,.243881,-.0610015,.431222,.0370252,.245123,-.0680874,.432512,.0420535,.24667,-.0755482,.434088,.0475414,.248779,-.0832873,.436323,.0535542,.251665,-.0913546,.439509,.0601716,.255305,-.0998489,.443478,.0674282,.260049,-.108576,.448713,.0754673,.266192,-.117754,.455524,.084339,.273158,-.127294,.4627,.0941683,.282131,-.137311,.472068,.10515,.293332,-.147736,.483565,.117402,.304667,-.158357,.493702,.130824,.317785,-.169274,.504708,.145724,.333245,-.180595,.517107,.16215,.349843,-.191892,.528849,.180149,.367944,-.203168,.540301,.199746,.387579,-.214443,.551514,.221047,.408247,-.225624,.560906,.243981,.43014,-.236422,.56959,.268513,.452669,-.24654,.576098,.294409,.476196,-.256157,.580925,.322002,.501157,-.265289,.584839,.351052,.527632,-.273671,.587614,.3812,.555754,-.281254,.589119,.412994,.581682,-.287448,.585204,.445498,.608196,-.292614,.579006,.479505,.635661,-.296068,.571297,.514643,.664999,-.297395,.560855,.552213,.691039,-.296645,.544525,.591365,.7179,-.293785,.526535,.630883,.744059,-.289089,.50545,.670932,.76863,-.282239,.482514,.710904,.793273,-.273688,.457246,.750259,.814731,-.26328,.428872,.78948,.835603,-.251526,.399384,.828597,.85489,-.238339,.368811,.866892,.872828,-.223607,.336617,.90563,.889462,-.207538,.303997,.943538,.904929,-.190297,.270812,.980591,.919101,-.172034,.237453,1.01935,.930536,-.152058,.204431,1.05498,.941223,-.129515,.172495,1.08717,.94982,-.104263,.140175,1.11551,.960592,-.0781944,.106465,1.14098,.974629,-.051688,.0711592,1.16418,.98811,-.0253929,.0354432,1.18465,1.00004,804378e-9,-330876e-9,1.20462,.214668,-821282e-11,.406619,433582e-11,.218053,-208144e-9,.413025,109887e-9,.217987,-832212e-9,.412901,439362e-9,.217971,-.00187246,.412876,988623e-9,.217968,-.00332855,.41286,.00175772,.217985,-.00520055,.412882,.00274729,.218014,-.00748814,.412916,.00395842,.218054,-.0101901,.412957,.00539274,.218106,-.0133057,.413005,.00705348,.218217,-.0168342,.413139,.00894581,.218338,-.0207707,.413258,.0110754,.21855,-.0251001,.413509,.0134551,.218913,-.0297861,.413992,.0161081,.219265,-.0348956,.414383,.0190307,.219696,-.0403909,.414839,.0222458,.220329,-.0462003,.415567,.025792,.220989,-.0524208,.41621,.0296637,.222027,-.058948,.417385,.0339323,.223301,-.0658208,.418779,.0386055,.224988,-.0730347,.420665,.0437355,.227211,-.0805274,.423198,.0493844,.230131,-.088395,.426566,.0556135,.233908,-.0966208,.43091,.0624829,.239092,-.105223,.437148,.0701636,.245315,-.11424,.444302,.0786949,.253166,-.12368,.453262,.0882382,.262374,-.133569,.463211,.0988682,.273145,-.143836,.474271,.110727,.285512,-.154577,.4863,.123945,.299512,-.165501,.498817,.138581,.314287,-.176698,.510341,.154676,.331083,-.188066,.522583,.172459,.349615,-.199597,.534879,.191979,.369318,-.210843,.546083,.21309,.390377,-.222068,.5562,.235998,.412411,-.233059,.564704,.260518,.435715,-.24357,.572314,.286795,.461196,-.253356,.579395,.314559,.485587,-.262362,.581985,.343581,.511908,-.270895,.584347,.374367,.539798,-.278452,.58505,.406015,.567974,-.284877,.583344,.439168,.594303,-.290124,.577348,.473005,.622951,-.294183,.570751,.508534,.652404,-.296389,.561541,.544764,.679291,-.296605,.546426,.582927,.706437,-.294095,.528599,.622681,.734485,-.28978,.508676,.663567,.758841,-.283363,.484768,.704092,.78537,-.275015,.460434,.745101,.807315,-.264689,.432166,.784712,.8271,-.252597,.401807,.824241,.849191,-.239154,.371458,.863803,.867046,-.224451,.338873,.903063,.8852,-.208342,.306175,.942763,.901771,-.190684,.272759,.981559,.915958,-.172105,.239306,1.02048,.928046,-.152214,.206071,1.05765,.939961,-.130247,.17367,1.08999,.948711,-.10672,.142201,1.11829,.959305,-.0808688,.108454,1.14467,.973009,-.0539145,.0728109,1.16839,.987631,-.0262947,.0360625,1.19004,.999978,.00132758,-559424e-9,1.21058,.193925,-793421e-11,.391974,392537e-11,.196746,-200315e-9,.397675,991033e-10,.19667,-801099e-9,.397521,396342e-9,.196633,-.00180246,.397445,891829e-9,.196654,-.00320443,.397482,.00158582,.196659,-.00500647,.39748,.00247867,.196683,-.0072086,.397506,.00357167,.196728,-.00981001,.397562,.00486675,.196792,-.0128096,.397633,.00636707,.19689,-.0162055,.397746,.00807752,.197017,-.0199943,.397884,.0100052,.19729,-.024139,.39827,.0121691,.197583,-.0286671,.398639,.0145755,.197927,-.0335858,.399034,.0172355,.198383,-.0388806,.399554,.0201718,.199002,-.0444736,.400289,.0234194,.199739,-.0504583,.401111,.026984,.200784,-.056729,.402349,.0309217,.202075,-.0633643,.403841,.0352496,.203898,-.0703247,.406076,.0400313,.206199,-.0775565,.408841,.0453282,.209252,-.085184,.41259,.0511794,.213638,-.0931994,.418288,.0577459,.21881,-.101617,.424681,.0650508,.225642,-.11052,.433429,.0732759,.233717,-.119772,.442897,.0824683,.242823,-.129505,.452888,.0927484,.254772,-.139906,.466407,.104417,.266603,-.150402,.477413,.117211,.28073,-.161395,.490519,.131598,.295399,-.172465,.50201,.147407,.312705,-.183982,.515311,.165031,.331335,-.195532,.52786,.184336,.351037,-.206971,.5392,.205361,.372175,-.218117,.54941,.228043,.394548,-.229327,.558642,.25267,.419598,-.240052,.567861,.279071,.443922,-.249937,.573332,.306882,.471495,-.259407,.58013,.33661,.496769,-.267749,.580564,.367328,.524951,-.275524,.581696,.399753,.55318,-.282148,.579885,.433134,.581577,-.287533,.575471,.467534,.609231,-.291612,.567445,.502943,.637478,-.293911,.557657,.53871,.667795,-.295096,.546535,.576568,.694272,-.294073,.529561,.614929,.722937,-.290386,.510561,.655909,.749682,-.284481,.487846,.697663,.774754,-.276188,.462487,.738515,.799301,-.266215,.43481,.779802,.820762,-.254116,.404879,.820045,.843231,-.240393,.374559,.860294,.861857,-.225503,.341582,.900965,.880815,-.209382,.308778,.941727,.89766,-.19155,.275232,.980916,.912926,-.172346,.240938,1.02162,.926391,-.151799,.207223,1.0597,.938429,-.129968,.17484,1.09291,.947834,-.10651,.142984,1.12248,.958432,-.0824098,.109902,1.149,.972402,-.0565242,.0744454,1.1733,.987191,-.028427,.0373794,1.19538,.999975,385685e-10,-4203e-8,1.21676,.178114,-766075e-11,.385418,354027e-11,.176074,-191966e-9,.381002,887135e-10,.17601,-767549e-9,.380861,354715e-9,.17598,-.00172696,.380798,798168e-9,.175994,-.00307012,.380824,.00141928,.176017,-.00479684,.380858,.00221859,.176019,-.00690648,.380839,.00319714,.176072,-.00939888,.380913,.0043572,.176131,-.0122726,.380979,.005702,.176239,-.0155264,.38112,.00723689,.176371,-.0191551,.381272,.00896907,.176638,-.023117,.381669,.0109194,.176912,-.0274633,.382015,.0130903,.177279,-.032173,.382476,.0154949,.17774,-.0372219,.383041,.0181669,.178344,-.0426132,.38378,.0211209,.179153,-.0483309,.384773,.0243899,.180197,-.0543447,.386076,.0280062,.181581,-.0607122,.387809,.032004,.18344,-.0673855,.390205,.036453,.186139,-.0743989,.393944,.0414162,.189432,-.0817731,.39832,.0469394,.193795,-.0895464,.404188,.0531442,.199641,-.0978264,.4121,.0601374,.206679,-.106499,.421425,.0680078,.214865,-.115654,.431504,.076919,.224406,-.125268,.442526,.0868835,.235876,-.135475,.455465,.0981875,.248335,-.146023,.4681,.110759,.262868,-.157016,.482069,.124885,.278962,-.168245,.496182,.140645,.295082,-.17958,.507401,.157838,.313738,-.191227,.520252,.17695,.333573,-.202718,.531708,.197817,.356433,-.214424,.544509,.220785,.378853,-.225492,.55373,.245306,.402717,-.236236,.561348,.271593,.428375,-.246568,.568538,.299776,.454724,-.255941,.573462,.329433,.482291,-.264511,.576356,.360598,.509706,-.272129,.576446,.393204,.538805,-.278979,.575298,.427227,.568919,-.284528,.572154,.462157,.596804,-.288801,.564691,.497997,.625987,-.291334,.555134,.534467,.656414,-.292722,.545051,.571736,.683916,-.292185,.528813,.610158,.711809,-.290043,.51106,.649061,.739547,-.285246,.490103,.690081,.766914,-.277647,.465523,.732554,.791375,-.267603,.437718,.773982,.814772,-.256109,.40882,.81609,.836691,-.242281,.377823,.856849,.856984,-.227155,.34496,.898363,.876332,-.210395,.311335,.939471,.894988,-.192612,.277703,.980799,.911113,-.173236,.243019,1.02215,.924092,-.152258,.209037,1.06139,.936828,-.129575,.175909,1.09635,.946869,-.10594,.143852,1.12707,.958284,-.081318,.110289,1.15419,.972325,-.0556133,.0747232,1.17909,.986878,-.0297899,.0383149,1.20163,.999936,-.00197169,912402e-9,1.22338,.151174,-720365e-11,.351531,309789e-11,.155594,-18279e-8,.361806,78608e-9,.156099,-731569e-9,.362982,314615e-9,.156053,-.00164578,.362869,707845e-9,.156093,-.0029261,.362961,.00125884,.156099,-.00457155,.362959,.00196783,.15612,-.00658224,.362982,.00283622,.156168,-.00895774,.363048,.00386625,.156221,-.0116962,.363101,.00506109,.156324,-.0147973,.363241,.00642675,.156476,-.0182503,.363448,.00797175,.156731,-.0220266,.36384,.00971484,.156994,-.026176,.364179,.0116575,.157341,-.0306701,.36462,.0138207,.157867,-.0354591,.365364,.0162356,.15846,-.0406141,.366111,.0189092,.159308,-.0460519,.367248,.021885,.160426,-.0518096,.368767,.0252004,.161877,-.0578906,.370745,.0288825,.163995,-.0642812,.373831,.0330139,.16655,-.0710067,.377366,.0376283,.170237,-.0781522,.382799,.0428493,.175096,-.0857172,.389915,.0487324,.181069,-.0938025,.398487,.0554214,.188487,-.102363,.408799,.0630189,.197029,-.111343,.419991,.071634,.206684,-.120812,.431455,.0812797,.218698,-.131033,.445746,.0923651,.230726,-.141373,.457471,.104545,.245516,-.152387,.472388,.118449,.261551,-.163628,.486671,.133923,.277437,-.174814,.49762,.150849,.296662,-.186713,.51162,.169924,.31795,-.198513,.525435,.190848,.339422,-.210119,.536267,.213504,.362143,-.221354,.545982,.237947,.387198,-.23224,.555364,.264427,.412349,-.24257,.561489,.292519,.439274,-.252284,.566903,.322561,.466779,-.261023,.569614,.353952,.496011,-.26899,.571589,.387278,.524964,-.275498,.570325,.421356,.556518,-.281449,.568792,.457314,.584363,-.285526,.560268,.493199,.614214,-.28844,.55205,.530276,.645684,-.289777,.541906,.56855,.673446,-.289722,.526464,.606927,.701924,-.287792,.509872,.645945,.73037,-.284315,.490649,.685564,.757405,-.278804,.467964,.726511,.784025,-.269543,.441468,.768601,.808255,-.258117,.41216,.811321,.830739,-.244728,.380606,.853496,.851914,-.229428,.348111,.895374,.872586,-.212508,.314732,.937674,.891581,-.194025,.280338,.979869,.907641,-.174711,.245203,1.02253,.922233,-.153509,.21077,1.06371,.935878,-.130418,.177399,1.09972,.946338,-.105558,.144507,1.13124,.957265,-.080059,.110508,1.15973,.971668,-.0539766,.0742311,1.18515,.9866,-.0277101,.0375224,1.20858,1.00021,-515531e-9,135226e-9,1.23135,.137468,-686011e-11,.345041,273315e-11,.13703,-173378e-9,.343936,690761e-10,.136986,-693048e-9,.34383,276126e-9,.136964,-.00155931,.343761,621337e-9,.137003,-.00277211,.343863,.00110494,.137012,-.00433103,.343868,.00172744,.137043,-.00623606,.343916,.00249022,.13709,-.0084868,.343986,.00339559,.137145,-.0110814,.344045,.00444687,.137242,-.0140187,.344177,.00565007,.137431,-.0172713,.344491,.00701868,.137644,-.0208605,.344805,.00856042,.13791,-.024792,.345172,.0102863,.138295,-.0290461,.345734,.0122185,.138764,-.0335957,.346371,.0143771,.139415,-.038467,.347298,.0167894,.140272,-.0436176,.348527,.0194895,.141457,-.0491016,.350276,.0225043,.14303,-.0548764,.352646,.0258962,.145289,-.0610096,.356206,.0297168,.148502,-.0674777,.361488,.0340562,.152188,-.074345,.367103,.0389534,.157359,-.0817442,.375247,.0445541,.16379,-.0896334,.385064,.0509535,.171376,-.098005,.396082,.0582611,.179901,-.106817,.407418,.06654,.189892,-.116239,.420031,.075994,.201838,-.12627,.434321,.0867239,.214311,-.136701,.447631,.0987517,.228902,-.147616,.462046,.112353,.245107,-.158871,.476942,.127605,.262292,-.170261,.490285,.144469,.281215,-.182017,.503783,.163282,.301058,-.193729,.515505,.183873,.322752,-.205512,.52682,.206466,.347547,-.217214,.539473,.231194,.370969,-.227966,.546625,.257288,.397533,-.238555,.55472,.285789,.42398,-.248278,.559468,.315746,.452928,-.257422,.564095,.347724,.482121,-.265306,.565426,.380922,.510438,-.272043,.563205,.415639,.541188,-.277614,.561087,.451702,.571667,-.281927,.554922,.48845,.602432,-.285015,.546838,.526442,.634126,-.286512,.537415,.564896,.662816,-.286388,.522906,.604037,.692411,-.284734,.507003,.643795,.720946,-.281297,.488398,.68298,.748293,-.276262,.466353,.723466,.776931,-.269978,.443573,.764565,.801065,-.260305,.415279,.805838,.825843,-.247426,.384773,.849985,.84807,-.232437,.352555,.893174,.869122,-.215806,.318642,.936564,.888963,-.197307,.28381,.980253,.905547,-.177203,.247888,1.02463,.918554,-.155542,.212904,1.06714,.931395,-.131948,.1787,1.10451,.941749,-.106723,.145902,1.13694,.954551,-.0804939,.111193,1.1666,.970279,-.0534239,.0744697,1.19249,.986117,-.0257452,.0368788,1.21665,.999938,.00190634,-.0010291,1.23981,.118493,-647439e-11,.32272,23772e-10,.118765,-163023e-9,.323456,598573e-10,.118772,-65212e-8,.323477,239447e-9,.118843,-.00146741,.323657,538881e-9,.118804,-.00260846,.323553,95826e-8,.118826,-.00407576,.323595,.00149845,.118846,-.00586826,.323617,.00216047,.118886,-.00798578,.32367,.00294679,.118947,-.0104273,.323753,.00386124,.119055,-.0131909,.323922,.00490999,.119241,-.0162444,.324251,.00610804,.11944,-.0196339,.324544,.00745805,.119739,-.0233378,.325026,.00897805,.12011,-.0273179,.325586,.0106895,.120571,-.0316143,.326231,.0126073,.12124,-.0361939,.327264,.0147654,.122162,-.0410511,.328733,.0172001,.123378,-.0462233,.330659,.0199375,.125183,-.0517109,.333754,.0230498,.127832,-.0575652,.338507,.026597,.130909,-.0637441,.343666,.0306345,.135221,-.0704302,.351063,.035273,.14082,-.0776364,.360604,.0406137,.146781,-.0852293,.369638,.0466788,.155121,-.0935351,.3827,.0537628,.16398,-.102234,.39522,.0617985,.173926,-.111465,.40793,.07097,.185137,-.121296,.42105,.0813426,.19826,-.13169,.435735,.0931596,.212938,-.142614,.450932,.106547,.229046,-.153884,.465726,.121575,.246246,-.165382,.479461,.138286,.264637,-.176806,.492106,.15666,.284959,-.188793,.504774,.17728,.308157,-.200763,.518805,.19988,.330951,-.21239,.528231,.224293,.3549,-.223521,.536376,.250541,.381502,-.234169,.544846,.278902,.409529,-.244077,.551717,.309227,.437523,-.253363,.55517,.341426,.467624,-.261659,.557772,.37518,.497268,-.268498,.556442,.41007,.528294,-.274018,.553915,.446445,.559053,-.278169,.549153,.483779,.589329,-.281229,.539878,.522249,.622503,-.282902,.53162,.561754,.652382,-.282815,.518119,.601544,.681847,-.281247,.502187,.641574,.712285,-.277986,.484824,.682633,.740094,-.273017,.463483,.723426,.768478,-.266692,.441299,.763747,.794556,-.258358,.415238,.805565,.819408,-.248807,.386912,.847254,.843411,-.236214,.356165,.891091,.862397,-.219794,.320562,.936174,.883113,-.201768,.285322,.982562,.90023,-.181672,.249713,1.02862,.915192,-.159279,.214546,1.07163,.928458,-.134725,.180285,1.10995,.94069,-.10913,.147119,1.14354,.953409,-.0821315,.112492,1.17372,.969537,-.0542677,.0752014,1.20043,.985612,-.0259096,.0370361,1.22528,.999835,.00298198,-.00151801,1.24959,.10097,-602574e-11,.300277,202619e-11,.101577,-152164e-9,.302077,511662e-10,.101572,-608889e-9,.302066,204751e-9,.101566,-.00136997,.302047,460753e-9,.101592,-.00243557,.302114,819497e-9,.101608,-.0038053,.30214,.00128154,.101627,-.00547906,.30216,.0018483,.101669,-.00745647,.302224,.00252223,.101732,-.00973615,.302318,.00330716,.101844,-.0123097,.302513,.00421061,.102025,-.0151681,.30285,.00524481,.102224,-.0183334,.303166,.0064154,.102515,-.0217819,.303654,.00774063,.102886,-.0255067,.304243,.0092398,.103395,-.029514,.305089,.0109339,.104109,-.0337912,.306301,.0128561,.105074,-.0383565,.30798,.0150338,.10654,-.0432132,.310726,.0175228,.108478,-.0484244,.314351,.0203648,.111015,-.0539339,.319032,.0236325,.114682,-.0598885,.32605,.0274188,.11911,-.0663375,.334109,.0317905,.124736,-.0733011,.344013,.0368502,.131479,-.0807744,.355358,.0427104,.139283,-.0888204,.367614,.0494788,.148054,-.0973394,.380072,.0572367,.159037,-.10665,.395678,.0662704,.169794,-.116221,.40795,.0763192,.18314,-.126632,.423546,.087956,.197515,-.137383,.438213,.101042,.213514,-.148641,.453248,.115827,.23065,-.160117,.46688,.132283,.249148,-.171807,.479962,.150644,.270219,-.183695,.494618,.171073,.292338,-.195574,.506937,.193378,.314999,-.207205,.516463,.217585,.340991,-.218955,.528123,.24428,.367982,-.229917,.537025,.272784,.39432,-.239737,.541627,.302742,.423364,-.249048,.546466,.335112,.453751,-.257329,.549466,.369032,.48416,-.264623,.549503,.404577,.515262,-.270411,.547008,.441337,.547036,-.274581,.542249,.479162,.576614,-.277266,.533015,.517904,.611143,-.279144,.525512,.558508,.640989,-.279001,.51154,.598995,.671182,-.277324,.495641,.639935,.700848,-.273908,.477526,.681017,.729862,-.269063,.457955,.722764,.758273,-.262282,.434846,.764349,.784121,-.254281,.409203,.806206,.809798,-.24505,.382694,.848617,.834953,-.233861,.354034,.892445,.856817,-.221308,.321764,.936263,.877609,-.205996,.288118,.982401,.897489,-.186702,.253277,1.02975,.913792,-.164618,.217963,1.07488,.92785,-.140023,.183221,1.11487,.940378,-.11328,.149385,1.14947,.95273,-.0853958,.114152,1.1807,.969059,-.0568698,.0769845,1.20912,.985574,-.0276502,.0381186,1.23498,.999943,.00239052,-.00126861,1.25987,.0852715,-560067e-11,.279021,171162e-11,.0854143,-140871e-9,.279483,430516e-10,.0854191,-563385e-9,.2795,172184e-9,.0854188,-.00126753,.279493,387464e-9,.0854229,-.00225337,.279501,68918e-8,.0854443,-.00352086,.279549,.00107803,.0854697,-.00506962,.279591,.00155536,.0855093,-.00689873,.279652,.00212354,.0855724,-.00900821,.279752,.00278703,.0856991,-.0113799,.280011,.0035551,.085855,-.0140314,.280297,.00443449,.0860682,-.016963,.280682,.00543636,.086344,-.0201438,.281159,.0065788,.0867426,-.0235999,.281886,.00787977,.087239,-.0273069,.282745,.0093606,.0879815,-.031269,.284139,.011056,.0891258,-.035531,.28647,.0130065,.0906909,-.0400947,.289708,.0152495,.0927624,-.0449638,.293904,.0178454,.0958376,-.0502427,.300471,.0208915,.0995827,-.0559514,.30806,.0244247,.104526,-.0622152,.317874,.0285721,.110532,-.0690046,.329332,.0334227,.117385,-.0763068,.341217,.0390466,.12522,-.084184,.353968,.0455786,.134037,-.0925248,.366797,.0530773,.144014,-.101487,.380209,.0617424,.156013,-.111273,.395956,.071777,.168872,-.121431,.41053,.0830905,.183089,-.132105,.425073,.0959341,.198763,-.143286,.439833,.110448,.216159,-.154841,.454507,.126769,.234859,-.166588,.468368,.14495,.255879,-.178626,.482846,.165233,.27677,-.190218,.493489,.187217,.301184,-.202227,.506549,.211659,.325852,-.213764,.5158,.237922,.352824,-.22487,.525442,.26632,.380882,-.235246,.532487,.296691,.410137,-.244847,.537703,.329179,.439787,-.253122,.540361,.363135,.472291,-.260517,.542734,.399222,.501856,-.266519,.538826,.436352,.534816,-.270905,.535152,.474505,.565069,-.273826,.525979,.513988,.597154,-.275333,.516394,.554852,.630473,-.275314,.506206,.596592,.660574,-.273323,.489769,.638117,.692015,-.270008,.472578,.680457,.720647,-.265001,.452134,.723008,.750528,-.258311,.430344,.765954,.777568,-.250046,.405624,.809012,.80387,-.240114,.378339,.852425,.828439,-.228737,.349877,.895346,.851472,-.216632,.318968,.940695,.873906,-.202782,.287489,.987235,.89467,-.187059,.254394,1.03348,.912281,-.168818,.221294,1.07812,.927358,-.146494,.18675,1.11928,.940385,-.120009,.152322,1.15609,.952672,-.0917183,.117514,1.18875,.968496,-.0620321,.0797405,1.21821,.985236,-.0314945,.0402383,1.24523,.99998,-575153e-9,110644e-9,1.27133,.0702429,-512222e-11,.255273,140947e-11,.0702981,-128826e-9,.255469,354488e-10,.0703691,-515562e-9,.255727,141874e-9,.0703805,-.00116,.255754,31929e-8,.0703961,-.00206224,.255813,567999e-9,.0704102,-.00322223,.255839,88871e-8,.0704298,-.00463928,.255863,.00128272,.0704759,-.00631375,.255953,.00175283,.0705434,-.00824317,.256079,.00230342,.0706693,-.010412,.25636,.0029443,.0708189,-.0128439,.256647,.00368031,.0710364,-.0155177,.257084,.00452614,.0713223,-.0184374,.257637,.00549706,.0717182,-.0216002,.258416,.00661246,.072321,-.0249966,.259699,.00790147,.0731446,-.0286566,.261475,.0093884,.0743352,-.0325888,.264132,.0111186,.0760676,-.036843,.26815,.013145,.078454,-.0414292,.273636,.0155251,.0818618,-.0464634,.281653,.0183525,.0857382,-.0519478,.289992,.0216642,.0908131,-.0579836,.30066,.0255956,.0967512,-.0645124,.312204,.0301954,.103717,-.0716505,.325001,.0356017,.111596,-.0793232,.338129,.041896,.120933,-.087645,.352853,.0492447,.130787,-.096492,.366192,.0576749,.142311,-.105973,.380864,.0673969,.155344,-.116182,.396575,.0785899,.169535,-.126815,.411443,.0912377,.185173,-.138015,.426256,.105607,.201755,-.149325,.439607,.121551,.221334,-.161207,.455467,.139608,.241461,-.173162,.469096,.159591,.26294,-.18504,.481014,.18156,.286776,-.196881,.493291,.205781,.311596,-.208311,.503556,.231819,.338667,-.219671,.513268,.260274,.366021,-.230451,.519414,.290862,.395875,-.240131,.526766,.323196,.425564,-.248566,.52905,.357071,.457094,-.256195,.530796,.393262,.488286,-.262331,.528703,.430797,.522291,-.267141,.52727,.470231,.554172,-.270411,.519848,.510477,.586427,-.271986,.510307,.551594,.619638,-.27192,.499158,.593849,.650656,-.269817,.483852,.636314,.68284,-.266267,.467515,.679679,.714356,-.26113,.44931,.723884,.742717,-.254067,.425789,.767245,.770894,-.245652,.401144,.811819,.797358,-.235554,.374224,.856315,.823377,-.223896,.346167,.901077,.847456,-.210865,.316056,.946502,.870697,-.196574,.284503,.993711,.891068,-.180814,.251628,1.04134,.909267,-.163314,.219065,1.08609,.925653,-.143304,.186446,1.12702,.940017,-.121322,.153416,1.16371,.952398,-.0973872,.120334,1.19712,.967568,-.0698785,.08352,1.22791,.984772,-.0390031,.0439209,1.25672,1.00026,-.0070087,.00315668,1.28428,.0556653,-459654e-11,.227325,112556e-11,.0565238,-116382e-9,.230826,284985e-10,.0565717,-465666e-9,.231026,114036e-9,.0565859,-.00104773,.231079,256656e-9,.0565761,-.00186255,.231025,45663e-8,.0565913,-.00291002,.231058,714664e-9,.0566108,-.00418998,.231085,.00103224,.0566532,-.00570206,.231169,.00141202,.0567473,-.00743666,.231417,.00186018,.0568567,-.00940298,.231661,.00238264,.0569859,-.0115991,.231895,.00298699,.0572221,-.0140096,.232456,.00368957,.057519,-.0166508,.233096,.00450303,.0579534,-.01951,.234094,.00544945,.0585922,-.0225991,.235629,.00655564,.0595647,-.0259416,.238106,.00785724,.0609109,-.0295661,.241557,.00939127,.0628751,-.0335126,.246652,.0112198,.0656908,-.0378604,.254091,.0134168,.0691347,-.0426543,.262666,.0160374,.0732165,-.0478967,.272029,.0191514,.0782863,-.0536716,.283007,.0228597,.0843973,-.0600683,.295732,.0272829,.0913598,-.0670095,.308779,.032484,.0994407,-.0745516,.322886,.0385886,.108189,-.082712,.336408,.0457133,.118574,-.0914927,.351692,.0539832,.129989,-.100854,.366502,.0635162,.142722,-.110837,.381675,.0744386,.156654,-.121353,.3963,.0868483,.172151,-.132414,.411477,.100963,.188712,-.143809,.42508,.116795,.208093,-.155765,.441328,.134715,.227936,-.167608,.454328,.154396,.249495,-.179579,.467235,.176179,.27362,-.191488,.480248,.200193,.296371,-.202618,.487886,.225775,.324234,-.214133,.499632,.25441,.353049,-.225212,.509532,.285077,.381785,-.234875,.514265,.317047,.414038,-.244205,.521282,.351874,.445251,-.252145,.522931,.388279,.476819,-.258433,.520947,.425825,.509209,-.263411,.517669,.465104,.542759,-.266732,.512841,.505741,.574822,-.268263,.503317,.547611,.609324,-.268489,.493035,.590953,.641772,-.266941,.478816,.63488,.674049,-.263297,.462863,.679072,.705071,-.257618,.442931,.723487,.734709,-.250625,.421299,.768708,.763704,-.24179,.397085,.814375,.791818,-.231115,.370577,.859907,.817439,-.21922,.34232,.906715,.843202,-.205658,.312627,.953943,.866639,-.190563,.280933,1.00185,.888129,-.173978,.248393,1.05105,.907239,-.155485,.216007,1.09704,.923893,-.134782,.183233,1.13857,.938882,-.11249,.150376,1.17539,.952464,-.0890706,.117177,1.20924,.968529,-.0646523,.0813095,1.24055,.984763,-.038606,.0439378,1.27018,1.00053,-.01238,.00598668,1.29873,.0437928,-409594e-11,.204012,879224e-12,.0440166,-103395e-9,.205049,221946e-10,.0440529,-413633e-9,.205225,887981e-10,.0440493,-930594e-9,.2052,199858e-9,.0439884,-.00165352,.204901,355495e-9,.0440716,-.0025849,.205255,556983e-9,.0440968,-.00372222,.205311,805326e-9,.0441359,-.00506478,.205391,.00110333,.0442231,-.00660384,.205638,.00145768,.0443254,-.00835246,.205877,.00187275,.0444832,-.0102992,.20627,.00235938,.0447001,-.0124449,.206796,.0029299,.0450168,-.0147935,.207593,.0036005,.0454816,-.017336,.208819,.00439246,.0462446,-.0201156,.211036,.00533864,.0473694,-.0231568,.214388,.00646984,.0490191,-.0264941,.219357,.00783856,.0512776,-.030184,.226061,.00950182,.0541279,-.0342661,.234094,.0115156,.0578989,-.0388539,.244297,.0139687,.0620835,-.0438735,.254457,.0169015,.0673497,-.04951,.266706,.0204554,.0731759,-.0556263,.278753,.0246606,.0803937,-.0624585,.29309,.0297126,.0879287,-.0697556,.305856,.0355868,.0970669,-.0778795,.321059,.0425768,.106508,-.0863541,.333873,.05056,.11776,-.0955935,.349008,.0598972,.130081,-.105438,.363776,.0706314,.144454,-.115899,.380112,.0828822,.1596,-.126827,.394843,.0967611,.176097,-.138161,.409033,.112381,.194726,-.149904,.424257,.129952,.213944,-.161675,.436945,.149333,.235516,-.173659,.450176,.170892,.260564,-.185963,.466305,.194984,.285183,-.197582,.477328,.220805,.311095,-.208697,.486566,.248694,.338924,-.219519,.494811,.279015,.369757,-.229766,.504065,.311725,.3996,-.238879,.507909,.345844,.430484,-.246802,.509805,.381749,.46413,-.253924,.511436,.420251,.497077,-.259319,.508787,.459957,.530434,-.263297,.50394,.501356,.565725,-.265619,.49804,.544252,.599254,-.265842,.487346,.587856,.631251,-.263978,.472975,.631969,.663972,-.26043,.457135,.677471,.697724,-.255358,.439844,.723744,.727725,-.248308,.417872,.770653,.756417,-.239181,.39273,.817357,.785419,-.22814,.367839,.864221,.81266,-.215681,.339449,.912701,.839391,-.201623,.309279,.962419,.86366,-.185624,.278029,1.0122,.885028,-.16797,.245294,1.06186,.904639,-.148336,.212689,1.10934,.922048,-.12637,.179616,1.15063,.936952,-.102928,.146749,1.18885,.951895,-.0785268,.112733,1.22352,.967198,-.0530153,.0760056,1.25681,.984405,-.02649,.0383183,1.28762,1.00021,70019e-8,-20039e-8,1.31656,.0325964,-355447e-11,.176706,655682e-12,.0329333,-899174e-10,.178527,165869e-10,.0329181,-359637e-9,.178453,663498e-10,.0329085,-808991e-9,.178383,149332e-9,.0329181,-.00143826,.178394,265873e-9,.0329425,-.00224678,.178517,416597e-9,.0329511,-.00323575,.17849,603299e-9,.033011,-.00439875,.178695,829422e-9,.0330733,-.00574059,.178843,.00109908,.0331857,-.00725896,.179176,.00141933,.0333445,-.00895289,.179618,.0017999,.0335674,-.0108219,.180238,.00225316,.033939,-.0128687,.181417,.00279765,.0345239,-.015114,.183395,.0034564,.0354458,-.017596,.186616,.00425864,.0368313,-.0203524,.191547,.00524936,.0386115,-.0234105,.197508,.00647033,.0410303,-.0268509,.205395,.00798121,.0442245,-.0307481,.215365,.0098557,.0478659,-.0350863,.225595,.0121417,.0522416,-.0399506,.236946,.0149385,.0574513,-.045357,.249442,.0183189,.0631208,-.0512863,.261222,.0223644,.0701124,-.0579273,.275418,.0272418,.0777331,-.0650652,.288989,.0329458,.0862709,-.0728813,.302546,.0396819,.096103,-.081363,.317164,.04757,.106976,-.0904463,.331733,.0567012,.119175,-.100105,.34661,.067202,.132919,-.110375,.362249,.0792588,.147727,-.121115,.376978,.0928672,.163618,-.132299,.390681,.108228,.182234,-.143887,.406571,.125502,.201809,-.155827,.42042,.144836,.225041,-.168357,.438411,.166706,.247621,-.18004,.450368,.189909,.27097,-.191536,.460083,.215251,.296658,-.203024,.469765,.243164,.325892,-.214056,.481837,.273388,.35406,-.224104,.487474,.305344,.384372,-.233489,.492773,.339741,.41749,-.241874,.498451,.376287,.45013,-.248834,.499632,.414195,.481285,-.254658,.495233,.454077,.519183,-.259367,.496401,.496352,.551544,-.261818,.487686,.538798,.587349,-.262964,.479453,.583626,.621679,-.262128,.467709,.629451,.654991,-.258998,.452123,.67566,.686873,-.254119,.433495,.723248,.719801,-.246946,.413657,.771156,.750355,-.237709,.390366,.81989,.780033,-.226549,.364947,.868601,.809254,-.214186,.337256,.920034,.836576,-.199639,.307395,.971706,.861774,-.183169,.275431,1.02479,.885707,-.165111,.243431,1.07837,.904742,-.144363,.210921,1.12783,.915604,-.121305,.17647,1.17254,.930959,-.0962119,.143106,1.21012,.948404,-.069969,.108112,1.24474,.967012,-.0427586,.0708478,1.27718,.984183,-.0147043,.032335,1.3083,.999577,.0142165,-.00726867,1.3382,.0229227,-299799e-11,.148623,462391e-12,.0232194,-758796e-10,.15054,117033e-10,.0232315,-303636e-9,.15063,468397e-10,.0232354,-683189e-9,.150624,105472e-9,.0232092,-.0012136,.150445,187744e-9,.0232523,-.00189765,.150679,294847e-9,.0232828,-.00273247,.150789,428013e-9,.0233371,-.00371287,.150995,591134e-9,.0234015,-.00484794,.15118,787642e-9,.023514,-.00612877,.151562,.00102547,.023679,-.00756125,.152116,.00131351,.0239559,-.00914651,.153162,.00166594,.0244334,-.010904,.155133,.00210182,.025139,-.0128615,.158035,.00264406,.0262598,-.0150628,.162751,.00332923,.0277875,-.0175532,.168944,.00419773,.0298472,-.0203981,.176835,.00530034,.0325444,-.023655,.186686,.00669777,.0355581,-.0272982,.196248,.00842661,.0392841,-.0314457,.207352,.0105854,.0436815,-.0361157,.219279,.0132458,.0485272,-.0412932,.230728,.0164736,.0541574,-.0470337,.242994,.0203715,.0609479,-.0535002,.257042,.0250953,.0685228,-.0605409,.27102,.0306856,.0768042,-.0680553,.28406,.037193,.0864844,-.0765011,.299186,.0449795,.0969415,-.0852674,.3132,.0538316,.108478,-.0947333,.327138,.0641149,.121705,-.10481,.342345,.0759185,.136743,-.115474,.358472,.0894116,.152986,-.126536,.374067,.104562,.170397,-.138061,.388267,.121632,.191392,-.150203,.406467,.140996,.211566,-.161751,.418641,.161696,.233567,-.173407,.430418,.184557,.257769,-.185397,.44277,.210092,.28531,-.197048,.457191,.237827,.311726,-.20784,.464712,.267253,.340537,-.218345,.472539,.299332,.372921,-.228306,.482331,.333988,.402924,-.236665,.484378,.369722,.434475,-.244097,.484717,.407836,.469736,-.250547,.487093,.448465,.505045,-.25511,.485575,.490263,.540262,-.258444,.481225,.534495,.576347,-.259903,.473481,.579451,.608656,-.259572,.4603,.625604,.646679,-.257908,.450341,.674511,.679902,-.253663,.431561,.723269,.714159,-.247419,.412684,.773263,.745345,-.239122,.389388,.824182,.778248,-.228837,.365361,.876634,.807208,-.216197,.337667,.92945,.835019,-.201772,.307197,.985261,.860261,-.185291,.274205,1.04299,.877601,-.165809,.240178,1.09816,.898211,-.143897,.207571,1.14694,.915789,-.119513,.174904,1.19008,.931831,-.0932919,.141423,1.2297,.949244,-.0656528,.105603,1.26553,.967527,-.0370262,.0679551,1.29986,.984139,-.00730117,.0283133,1.33252,.999713,.0234648,-.0121785,1.36397,.0152135,-245447e-11,.122795,304092e-12,.0151652,-615778e-10,.122399,76292e-10,.0151181,-245948e-9,.122023,304802e-10,.0151203,-553394e-9,.12203,686634e-10,.015125,-983841e-9,.122037,122463e-9,.0151427,-.00153774,.12214,192706e-9,.0151708,-.0022103,.122237,281219e-9,.0152115,-.00300741,.12238,390804e-9,.0152877,-.00392494,.1227,526317e-9,.015412,-.00496597,.123244,69443e-8,.0156201,-.00613314,.124228,90547e-8,.0159658,-.00744113,.125945,.0011732,.0165674,-.00892546,.129098,.00151888,.017487,-.010627,.133865,.00197007,.018839,-.0126043,.140682,.0025637,.020554,-.0148814,.148534,.00333637,.0226727,-.0175123,.157381,.00433738,.0251879,-.0205266,.166685,.00561664,.0283635,-.0240319,.177796,.00725563,.0318694,-.0279432,.188251,.00928811,.0361044,-.0324313,.200038,.011835,.0406656,-.0373527,.210685,.0149146,.0463846,-.0430132,.224182,.0187254,.0525696,-.0491013,.23634,.0232283,.0598083,-.0559175,.250013,.0286521,.0679437,-.0633657,.263981,.0350634,.0771181,-.0714602,.278072,.0425882,.0881273,-.0803502,.29511,.0514487,.0996628,-.0896903,.309976,.0615766,.112702,-.099644,.325611,.0732139,.126488,-.109829,.339321,.0862324,.142625,-.120859,.35574,.101275,.15953,-.131956,.369845,.117892,.176991,-.143145,.38146,.136205,.199715,-.155292,.40052,.157252,.220787,-.167066,.412055,.179966,.243697,-.178396,.423133,.204418,.272106,-.190433,.439524,.232141,.297637,-.201265,.447041,.261109,.325273,-.211834,.454488,.292627,.357219,-.221889,.465004,.326669,.387362,-.230729,.468527,.362426,.423131,-.23924,.475836,.401533,.45543,-.246067,.475017,.441902,.493393,-.251557,.478017,.484239,.526253,-.255571,.4709,.528586,.560554,-.257752,.463167,.574346,.599306,-.258076,.456452,.621655,.634541,-.256471,.443725,.670492,.668907,-.253283,.428719,.721943,.705619,-.247562,.411348,.772477,.739034,-.240626,.388939,.8264,.771408,-.231493,.36425,.881702,.803312,-.220125,.337321,.9385,.828457,-.206645,.305364,.997437,.854819,-.190664,.273715,1.05693,.878666,-.171429,.242218,1.11251,.898404,-.149235,.209556,1.16398,.917416,-.12435,.176863,1.21014,.933133,-.0972703,.142775,1.25178,.95066,-.0683607,.106735,1.29028,.968589,-.0378724,.0681609,1.32703,.984776,-.00605712,.0273966,1.36158,.99994,.0263276,-.0138124,1.3943,.00867437,-186005e-11,.0928979,173682e-12,.00864003,-466389e-10,.0925237,435505e-11,.00864593,-186594e-9,.0925806,174322e-10,.00864095,-419639e-9,.0924903,392862e-10,.00863851,-746272e-9,.0924589,702598e-10,.00868531,-.00116456,.0929,111188e-9,.00869667,-.00167711,.0928529,163867e-9,.00874332,-.00228051,.0930914,23104e-8,.00882709,-.00297864,.0935679,31741e-8,.00898874,-.00377557,.0946165,430186e-9,.00929346,-.00469247,.0967406,580383e-9,.00978271,-.00575491,.100084,783529e-9,.0105746,-.00701514,.105447,.00106304,.0116949,-.00851797,.112494,.00144685,.0130419,-.0102757,.119876,.00196439,.0148375,-.012381,.129034,.00266433,.0168725,-.01482,.137812,.00358364,.0193689,-.0176563,.147696,.00478132,.0222691,-.0209211,.157795,.00631721,.0256891,-.0246655,.168431,.00826346,.0294686,-.0288597,.178587,.0106714,.0340412,-.0336441,.190251,.0136629,.0393918,-.039033,.202999,.0173272,.0453947,-.0450087,.215655,.0217448,.0521936,-.0515461,.228686,.0269941,.0600279,-.058817,.242838,.033272,.0692398,-.0667228,.258145,.0406457,.0793832,-.0752401,.273565,.0492239,.0902297,-.0841851,.287735,.0590105,.102014,-.0936479,.301161,.0702021,.116054,-.103967,.317438,.0832001,.13191,-.114622,.334166,.0977951,.148239,-.125452,.348192,.113985,.165809,-.136453,.361094,.131928,.184616,-.147648,.373534,.151811,.207491,-.159607,.39101,.174476,.230106,-.171119,.402504,.198798,.257036,-.182906,.418032,.225796,.281172,-.193605,.425468,.254027,.312034,-.204771,.440379,.285713,.340402,-.214988,.445406,.319196,.370231,-.224711,.44968,.35537,.407105,-.233516,.460747,.393838,.439037,-.240801,.460624,.433747,.47781,-.24762,.465957,.477234,.510655,-.251823,.460054,.52044,.550584,-.255552,.459172,.567853,.585872,-.257036,.450311,.615943,.620466,-.257535,.437763,.667693,.660496,-.255248,.426639,.718988,.695578,-.251141,.409185,.772503,.732176,-.244718,.39015,.827023,.760782,-.236782,.362594,.885651,.79422,-.225923,.33711,.943756,.824521,-.213855,.308272,1.00874,.854964,-.197723,.278529,1.06764,.878065,-.179209,.246208,1.12836,.899834,-.157569,.21329,1.18318,.918815,-.133206,.181038,1.23161,.934934,-.106545,.146993,1.27644,.952115,-.0780574,.111175,1.31842,.96906,-.0478279,.0728553,1.35839,.985178,-.0160014,.032579,1.39697,1.00039,.0173126,-.0095256,1.43312,.00384146,-124311e-11,.0613583,778271e-13,.00390023,-314043e-10,.0622919,196626e-11,.00389971,-125622e-9,.0622632,787379e-11,.00389491,-282352e-9,.0620659,1778e-8,.00391618,-502512e-9,.0624687,320918e-10,.00392662,-784458e-9,.0625113,515573e-10,.00396053,-.00112907,.0628175,778668e-10,.00401911,-.00153821,.0633286,113811e-9,.00414994,-.0020208,.0646443,16445e-8,.00441223,-.00260007,.0673886,237734e-9,.00484427,-.0033097,.0716528,345929e-9,.00549109,-.00418966,.0774998,505987e-9,.00636293,-.00527331,.0844758,739208e-9,.00746566,-.00660428,.0921325,.00107347,.00876625,-.00818826,.0997067,.00153691,.0103125,-.0100811,.107433,.00217153,.0123309,-.0123643,.117088,.00303427,.0146274,-.0150007,.126438,.00416018,.0172295,-.0180531,.135672,.00561513,.0204248,-.0215962,.146244,.007478,.0241597,-.0256234,.157481,.00981046,.0284693,-.0302209,.169125,.0127148,.033445,-.0353333,.181659,.0162453,.0391251,-.0410845,.1944,.0205417,.0454721,-.0473451,.207082,.0256333,.0530983,-.0542858,.221656,.0317036,.0615356,-.0618384,.236036,.0388319,.0703363,-.0697631,.248398,.046974,.0810391,-.0784757,.263611,.0565246,.0920144,-.0873488,.275857,.0671724,.105584,-.0973652,.292555,.0798105,.119506,-.107271,.306333,.0935945,.134434,-.117608,.318888,.109106,.153399,-.128938,.337552,.127074,.171258,-.139944,.349955,.14643,.191059,-.151288,.361545,.168,.215069,-.163018,.378421,.192082,.237838,-.174226,.38879,.217838,.266965,-.186063,.405857,.246931,.292827,-.196909,.414146,.277505,.324352,-.207473,.426955,.310711,.354427,-.217713,.433429,.346794,.389854,-.227183,.443966,.385237,.420749,-.235131,.44471,.424955,.459597,-.242786,.451729,.468446,.495316,-.248767,.45072,.513422,.534903,-.253351,.450924,.560618,.572369,-.256277,.445266,.609677,.612383,-.2576,.438798,.660995,.644037,-.256931,.421693,.713807,.686749,-.254036,.4109,.767616,.719814,-.249785,.390151,.82533,.754719,-.244283,.367847,.888311,.792022,-.235076,.345013,.948177,.822404,-.225061,.316193,1.01661,.853084,-.211113,.287013,1.08075,.879871,-.19449,.255424,1.14501,.901655,-.174023,.222879,1.20203,.919957,-.1509,.18989,1.25698,.938412,-.124923,.15606,1.30588,.953471,-.0968139,.120512,1.3529,.970451,-.066734,.0828515,1.3986,.985522,-.034734,.0424458,1.44148,1.00099,-.00102222,678929e-9,1.48398,965494e-9,-627338e-12,.0306409,197672e-13,99168e-8,-158573e-10,.0314638,499803e-12,991068e-9,-634012e-10,.031363,200682e-11,974567e-9,-14144e-8,.03036,457312e-11,998079e-9,-252812e-9,.031496,860131e-11,.00102243,-396506e-9,.0319955,148288e-10,.00107877,-577593e-9,.0331376,249141e-10,.00121622,-816816e-9,.0359396,423011e-10,.0014455,-.00113761,.0399652,724613e-10,.00178791,-.00156959,.0450556,123929e-9,.00225668,-.00214064,.0508025,208531e-9,.00285627,-.00287655,.0568443,341969e-9,.0035991,-.00380271,.0630892,544158e-9,.00455524,-.00496264,.0702204,842423e-9,.00569143,-.0063793,.0773426,.00126704,.00716928,-.00813531,.0860839,.00186642,.00885307,-.0101946,.0944079,.00267014,.0109316,-.0126386,.103951,.00374033,.0133704,-.0154876,.113786,.0051304,.0161525,-.0187317,.123477,.00688858,.0194267,-.0224652,.133986,.00910557,.0230967,-.0265976,.143979,.0118074,.0273627,-.0312848,.154645,.0151266,.0323898,-.0365949,.166765,.0191791,.0379225,-.0422914,.177932,.0239236,.0447501,-.0487469,.19167,.0296568,.0519391,-.0556398,.203224,.0362924,.0599464,-.0631646,.215652,.0440585,.0702427,-.0714308,.232089,.0531619,.0806902,-.0800605,.245258,.0634564,.0923194,-.0892815,.258609,.0752481,.106938,-.09931,.276654,.0888914,.121238,-.109575,.289847,.104055,.138817,-.120461,.307566,.121266,.15595,-.131209,.320117,.139944,.178418,-.143049,.339677,.161591,.197875,-.154074,.349886,.184303,.224368,-.166307,.369352,.210669,.252213,-.178051,.386242,.238895,.277321,-.189335,.395294,.269182,.310332,-.200683,.412148,.302508,.338809,-.210856,.418266,.337264,.372678,-.220655,.428723,.374881,.405632,-.230053,.433887,.415656,.442293,-.237993,.439911,.457982,.477256,-.244897,.440175,.502831,.515592,-.250657,.441079,.550277,.550969,-.255459,.435219,.601102,.592883,-.257696,.432882,.651785,.629092,-.259894,.421054,.708961,.672033,-.258592,.41177,.763806,.709147,-.256525,.395267,.824249,.745367,-.254677,.375013,.8951,.784715,-.247892,.353906,.959317,.818107,-.240162,.327801,1.03153,.847895,-.229741,.298821,1.10601,.879603,-.213084,.269115,1.164,.902605,-.195242,.236606,1.22854,.922788,-.174505,.203442,1.29017,.944831,-.150169,.169594,1.34157,.959656,-.124099,.135909,1.3956,.972399,-.0960626,.0990563,1.45128,.986549,-.0657097,.0602348,1.50312,1.00013,-.0333558,.0186694,1.55364,619747e-11,-1e-7,.00778326,796756e-16,237499e-13,-999999e-13,282592e-10,114596e-15,100292e-11,-166369e-11,250354e-9,677492e-14,350752e-11,-637769e-11,357289e-9,631655e-13,826445e-11,-174689e-10,516179e-9,31851e-11,242481e-10,-450868e-10,.0010223,130577e-11,455631e-10,-89044e-9,.00144302,374587e-11,971222e-10,-178311e-9,.00241912,102584e-10,171403e-9,-313976e-9,.00354938,236481e-10,292747e-9,-520026e-9,.00513765,496014e-10,789827e-9,-.00118187,.0238621,139056e-9,.00114093,-.00171827,.0286691,244093e-9,.00176119,-.00249667,.0368565,420623e-9,.0022233,-.00333742,.0400469,65673e-8,.00343382,-.00481976,.0535751,.00109323,.00427602,-.00600755,.057099,.00155268,.00461435,-.00737637,.0551084,.00215031,.00695698,-.00971401,.0715767,.00316529,.00867619,-.0120943,.0793314,.00436995,.0106694,-.0148202,.0869391,.0058959,.0140351,-.0183501,.101572,.00798757,.0168939,-.022006,.11018,.0104233,.020197,-.0261568,.119041,.0134167,.0254702,-.0312778,.135404,.0173009,.0298384,-.0362469,.1437,.0215428,.035159,-.042237,.15512,.0268882,.0427685,-.0488711,.17128,.033235,.0494848,-.0557997,.181813,.0404443,.0592394,-.0635578,.198745,.0490043,.0681463,-.071838,.210497,.0588239,.0804753,-.0809297,.228864,.0702835,.0942205,-.0906488,.247008,.0834012,.106777,-.100216,.258812,.0975952,.124471,-.110827,.278617,.114162,.138389,-.121193,.287049,.131983,.159543,-.13253,.307151,.152541,.176432,-.143611,.31564,.174673,.201723,-.15548,.33538,.199842,.229721,-.167166,.355256,.227097,.250206,-.178238,.360047,.256014,.282118,-.189905,.378761,.28855,.312821,-.201033,.39181,.323348,.341482,-.211584,.397716,.360564,.377368,-.221314,.410141,.400004,.418229,-.230474,.423485,.442371,.444881,-.239443,.418874,.488796,.488899,-.245987,.427545,.535012,.520317,-.253948,.422147,.589678,.568566,-.256616,.42719,.637683,.599607,-.26376,.415114,.703363,.64222,-.268687,.408715,.771363,.685698,-.2694,.399722,.83574,.732327,-.266642,.388651,.897764,.769873,-.267712,.369198,.983312,.806733,-.263479,.346802,1.06222,.843466,-.254575,.321368,1.13477,.873008,-.242749,.29211,1.20712,.908438,-.22725,.262143,1.27465,.936321,-.207621,.228876,1.33203,.950353,-.187932,.19484,1.40439,.96442,-.165154,.163178,1.4732,.979856,-.139302,.127531,1.53574,.982561,-.11134,.0903457,1.59982,.996389,-.0808124,.0489007,1.6577],t=[1,0,0,0,1,791421e-36,0,0,1,104392e-29,0,0,1,349405e-26,0,0,1,109923e-23,0,0,1,947414e-22,0,0,1,359627e-20,0,0,1,772053e-19,0,0,1,108799e-17,0,0,1,110655e-16,0,0,1,865818e-16,0,0,.999998,545037e-15,0,0,.999994,285095e-14,0,0,.999989,126931e-13,0,0,.999973,489938e-13,0,0,.999947,166347e-12,0,0,.999894,502694e-12,0,0,.999798,136532e-11,0,0,.999617,335898e-11,0,0,.999234,752126e-11,0,0,.998258,152586e-10,0,0,.99504,266207e-10,0,0,.980816,236802e-10,0,0,.967553,207684e-11,0,0,.966877,403733e-11,0,0,.965752,741174e-11,0,0,.96382,127746e-10,0,0,.960306,202792e-10,0,0,.953619,280232e-10,0,0,.941103,278816e-10,0,0,.926619,160221e-10,0,0,.920983,235164e-10,0,0,.912293,311924e-10,0,.0158731,.899277,348118e-10,0,.0476191,.880884,26041e-9,0,.0793651,.870399,338726e-10,0,.111111,.856138,392906e-10,0,.142857,.837436,372874e-10,0,.174603,.820973,392558e-10,0,.206349,.803583,434658e-10,0,.238095,.782168,40256e-9,0,.269841,.764107,448159e-10,0,.301587,.743092,457627e-10,0,.333333,.721626,455314e-10,0,.365079,.700375,477335e-10,0,.396825,.677334,461072e-10,0,.428571,.655702,484393e-10,0,.460317,.632059,464583e-10,0,.492064,.610125,483923e-10,0,.52381,.58653,464342e-10,0,.555556,.564508,477033e-10,0,.587302,.541405,459263e-10,0,.619048,.519556,46412e-9,0,.650794,.497292,448913e-10,0,.68254,.475898,445789e-10,0,.714286,.454722,433496e-10,0,.746032,.434042,423054e-10,0,.777778,.414126,413737e-10,0,.809524,.394387,397265e-10,0,.84127,.375841,390709e-10,0,.873016,.357219,369938e-10,0,.904762,.340084,365618e-10,0,.936508,.322714,342533e-10,0,.968254,.306974,339596e-10,0,1,1,101524e-23,0,0,1,10292e-22,0,0,1,130908e-23,0,0,1,473331e-23,0,0,1,625319e-22,0,0,1,107932e-20,0,0,1,163779e-19,0,0,1,203198e-18,0,0,1,204717e-17,0,0,.999999,168995e-16,0,0,.999998,115855e-15,0,0,.999996,66947e-14,0,0,.999991,330863e-14,0,0,.999983,141737e-13,0,0,.999968,532626e-13,0,0,.99994,177431e-12,0,0,.999891,528835e-12,0,0,.999797,142169e-11,0,0,.999617,347057e-11,0,0,.999227,77231e-10,0,0,.998239,155753e-10,0,0,.994937,268495e-10,0,0,.980225,213742e-10,0,0,.967549,21631e-10,0,0,.966865,417989e-11,0,0,.965739,763341e-11,0,0,.963794,130892e-10,0,0,.960244,206456e-10,0,0,.953495,282016e-10,0,148105e-9,.940876,271581e-10,0,.002454,.926569,164159e-10,0,.00867491,.920905,239521e-10,0,.01956,.912169,315127e-10,0,.035433,.899095,346626e-10,0,.056294,.882209,290223e-10,0,.0818191,.870272,342992e-10,0,.111259,.855977,394164e-10,0,.142857,.837431,372343e-10,0,.174603,.820826,396691e-10,0,.206349,.803408,435395e-10,0,.238095,.782838,419579e-10,0,.269841,.763941,450953e-10,0,.301587,.742904,455847e-10,0,.333333,.721463,458833e-10,0,.365079,.700197,477159e-10,0,.396825,.677501,470641e-10,0,.428571,.655527,484732e-10,0,.460317,.6324,476834e-10,0,.492064,.609964,484213e-10,0,.52381,.586839,475541e-10,0,.555556,.564353,476951e-10,0,.587302,.541589,467611e-10,0,.619048,.519413,463493e-10,0,.650794,.497337,453994e-10,0,.68254,.475797,445308e-10,0,.714286,.454659,435787e-10,0,.746032,.434065,424839e-10,0,.777778,.414018,41436e-9,0,.809524,.39455,401902e-10,0,.84127,.375742,390813e-10,0,.873016,.357501,377116e-10,0,.904762,.339996,36535e-9,0,.936508,.323069,351265e-10,0,.968254,.306897,339112e-10,0,1,1,10396e-19,0,0,1,104326e-20,0,0,1,110153e-20,0,0,1,144668e-20,0,0,1,34528e-19,0,0,1,175958e-19,0,0,1,12627e-17,0,0,1,936074e-18,0,0,1,645742e-17,0,0,.999998,401228e-16,0,0,.999997,222338e-15,0,0,.999995,10967e-13,0,0,.999991,482132e-14,0,0,.999981,189434e-13,0,0,.999967,667716e-13,0,0,.999938,212066e-12,0,0,.999886,60977e-11,0,0,.999792,159504e-11,0,0,.999608,381191e-11,0,0,.999209,833727e-11,0,0,.998179,165288e-10,0,0,.994605,274387e-10,0,0,.979468,167316e-10,0,0,.967529,242877e-11,0,0,.966836,461696e-11,0,0,.96569,830977e-11,0,0,.963706,140427e-10,0,244659e-11,.960063,217353e-10,0,760774e-9,.953113,286606e-10,0,.00367261,.940192,247691e-10,0,.00940263,.927731,195814e-10,0,.018333,.920669,252531e-10,0,.0306825,.911799,324277e-10,0,.0465556,.89857,340982e-10,0,.0659521,.883283,319622e-10,0,.0887677,.86989,35548e-9,0,.114784,.855483,397143e-10,0,.143618,.837987,391665e-10,0,.174606,.820546,411306e-10,0,.206349,.802878,436753e-10,0,.238095,.783402,444e-7,0,.269841,.763439,458726e-10,0,.301587,.742925,467097e-10,0,.333333,.721633,478887e-10,0,.365079,.69985,481251e-10,0,.396825,.67783,491811e-10,0,.428571,.655126,488199e-10,0,.460318,.632697,496025e-10,0,.492064,.609613,48829e-9,0,.52381,.587098,492754e-10,0,.555556,.564119,482625e-10,0,.587302,.541813,482807e-10,0,.619048,.519342,471552e-10,0,.650794,.497514,466765e-10,0,.68254,.475879,455582e-10,0,.714286,.454789,446007e-10,0,.746032,.434217,435382e-10,0,.777778,.414086,421753e-10,0,.809524,.394744,412093e-10,0,.84127,.375782,396634e-10,0,.873016,.357707,386419e-10,0,.904762,.340038,370345e-10,0,.936508,.323284,359725e-10,0,.968254,.306954,3436e-8,0,1,1,599567e-19,0,0,1,600497e-19,0,0,1,614839e-19,0,0,1,686641e-19,0,0,1,972658e-19,0,0,1,221271e-18,0,0,1,833195e-18,0,0,1,403601e-17,0,0,.999999,206001e-16,0,0,.999998,101739e-15,0,0,.999997,470132e-15,0,0,.999993,200436e-14,0,0,.999988,783682e-14,0,0,.999979,280338e-13,0,0,.999962,917033e-13,0,0,.999933,274514e-12,0,0,.999881,753201e-12,0,0,.999783,189826e-11,0,0,.999594,440279e-11,0,0,.999178,93898e-10,0,0,.998073,181265e-10,0,0,.993993,280487e-10,0,0,.979982,149422e-10,0,0,.968145,378481e-11,0,0,.966786,53771e-10,0,0,.965611,947508e-11,0,388934e-10,.963557,156616e-10,0,9693e-7,.959752,235144e-10,0,.00370329,.952461,291568e-10,0,.00868428,.940193,240102e-10,0,.0161889,.929042,231235e-10,0,.0263948,.920266,273968e-10,0,.0394088,.911178,337915e-10,0,.0552818,.897873,333629e-10,0,.0740138,.884053,351405e-10,0,.0955539,.869455,378034e-10,0,.119795,.854655,399378e-10,0,.14656,.838347,419108e-10,0,.175573,.820693,440831e-10,0,.206388,.802277,445599e-10,0,.238095,.783634,472691e-10,0,.269841,.763159,476984e-10,0,.301587,.742914,491487e-10,0,.333333,.721662,502312e-10,0,.365079,.699668,502817e-10,0,.396825,.677839,51406e-9,0,.428571,.655091,511095e-10,0,.460317,.632665,516067e-10,0,.492064,.609734,512255e-10,0,.52381,.587043,510263e-10,0,.555556,.564298,50565e-9,0,.587302,.541769,497951e-10,0,.619048,.519529,492698e-10,0,.650794,.497574,482066e-10,0,.68254,.476028,473689e-10,0,.714286,.454961,461941e-10,0,.746032,.434341,450618e-10,0,.777778,.414364,438355e-10,0,.809524,.394832,424196e-10,0,.84127,.376109,412563e-10,0,.873016,.35779,396226e-10,0,.904762,.340379,384886e-10,0,.936508,.323385,368214e-10,0,.968254,.307295,356636e-10,0,1,1,106465e-17,0,0,1,106555e-17,0,0,1,107966e-17,0,0,1,114601e-17,0,0,1,137123e-17,0,0,1,21243e-16,0,0,.999999,489653e-17,0,0,.999999,160283e-16,0,0,.999998,62269e-15,0,0,.999997,251859e-15,0,0,.999996,996192e-15,0,0,.999992,374531e-14,0,0,.999986,132022e-13,0,0,.999975,433315e-13,0,0,.999959,131956e-12,0,0,.999927,372249e-12,0,0,.999871,972461e-12,0,0,.999771,235343e-11,0,0,.999572,52768e-10,0,0,.999133,109237e-10,0,0,.997912,203675e-10,0,0,.993008,279396e-10,0,0,.980645,139604e-10,0,0,.970057,646596e-11,0,0,.966717,65089e-10,0,474145e-10,.965497,111863e-10,0,89544e-8,.96334,179857e-10,0,.0032647,.959294,259045e-10,0,.0075144,.951519,292327e-10,0,.0138734,.940517,249769e-10,0,.0224952,.93014,26803e-9,0,.0334828,.91972,303656e-10,0,.0468973,.910294,353323e-10,0,.0627703,.897701,351002e-10,0,.0811019,.884522,388104e-10,0,.10186,.869489,412932e-10,0,.124985,.853983,415781e-10,0,.150372,.838425,454066e-10,0,.177868,.820656,471624e-10,0,.207245,.801875,475243e-10,0,.238143,.783521,505621e-10,0,.269841,.763131,50721e-9,0,.301587,.74261,523293e-10,0,.333333,.72148,528699e-10,0,.365079,.699696,538677e-10,0,.396825,.677592,539255e-10,0,.428571,.65525,546367e-10,0,.460317,.632452,541348e-10,0,.492064,.609903,544976e-10,0,.52381,.586928,536201e-10,0,.555556,.564464,535185e-10,0,.587302,.541801,524949e-10,0,.619048,.519681,51812e-9,0,.650794,.497685,507687e-10,0,.68254,.47622,496243e-10,0,.714286,.455135,485714e-10,0,.746032,.4346,471847e-10,0,.777778,.414564,459294e-10,0,.809524,.395165,444705e-10,0,.84127,.376333,430772e-10,0,.873016,.358197,416229e-10,0,.904762,.34064,401019e-10,0,.936508,.323816,386623e-10,0,.968254,.307581,370933e-10,0,1,1,991541e-17,0,0,1,992077e-17,0,0,1,100041e-16,0,0,1,10385e-15,0,0,1,115777e-16,0,0,1,150215e-16,0,0,.999999,254738e-16,0,0,.999999,598822e-16,0,0,.999998,179597e-15,0,0,.999997,602367e-15,0,0,.999994,206835e-14,0,0,.99999,694952e-14,0,0,.999984,223363e-13,0,0,.999972,678578e-13,0,0,.999952,193571e-12,0,0,.999919,516594e-12,0,0,.99986,128739e-11,0,0,.999753,299298e-11,0,0,.999546,648258e-11,0,0,.999074,129985e-10,0,0,.997671,232176e-10,0,0,.991504,256701e-10,0,0,.981148,131141e-10,0,0,.971965,869048e-11,0,280182e-10,.966624,808301e-11,0,695475e-9,.965344,135235e-10,0,.00265522,.963048,210592e-10,0,.00622975,.958673,287473e-10,0,.0116234,.950262,281379e-10,0,.018976,.940836,271089e-10,0,.0283844,.930996,30926e-9,0,.0399151,.919848,348359e-10,0,.0536063,.909136,366092e-10,0,.0694793,.897554,384162e-10,0,.0875342,.884691,430971e-10,0,.107749,.869414,447803e-10,0,.130087,.853462,452858e-10,0,.154481,.838187,495769e-10,0,.180833,.820381,502709e-10,0,.209005,.801844,522713e-10,0,.238791,.783061,541505e-10,0,.269869,.763205,553712e-10,0,.301587,.742362,564909e-10,0,.333333,.721393,572646e-10,0,.365079,.699676,581012e-10,0,.396825,.677395,58096e-9,0,.428571,.655208,585766e-10,0,.460317,.632451,583602e-10,0,.492064,.609839,580234e-10,0,.52381,.587093,577161e-10,0,.555556,.564467,568447e-10,0,.587302,.542043,563166e-10,0,.619048,.519826,55156e-9,0,.650794,.497952,541682e-10,0,.68254,.476477,528971e-10,0,.714286,.455412,514952e-10,0,.746032,.434926,502222e-10,0,.777778,.4149,485779e-10,0,.809524,.395552,472242e-10,0,.84127,.376712,454891e-10,0,.873016,.358622,440924e-10,0,.904762,.341048,422984e-10,0,.936508,.324262,408582e-10,0,.968254,.308013,390839e-10,0,1,1,613913e-16,0,0,1,614145e-16,0,0,1,617708e-16,0,0,1,633717e-16,0,0,1,681648e-16,0,0,1,808291e-16,0,0,1,114608e-15,0,0,.999998,210507e-15,0,0,.999997,499595e-15,0,0,.999995,139897e-14,0,0,.999994,419818e-14,0,0,.999988,127042e-13,0,0,.999979,375153e-13,0,0,.999965,106206e-12,0,0,.999945,285381e-12,0,0,.999908,723611e-12,0,0,.999846,17255e-10,0,0,.999733,386104e-11,0,0,.999511,808493e-11,0,0,.998993,156884e-10,0,0,.997326,265538e-10,0,0,.989706,206466e-10,0,0,.981713,130756e-10,0,70005e-10,.973636,106473e-10,0,464797e-9,.966509,10194e-9,0,.00201743,.965149,165881e-10,0,.00497549,.962669,249147e-10,0,.00953262,.95786,317449e-10,0,.0158211,.949334,281045e-10,0,.0239343,.941041,303263e-10,0,.0339372,.931575,356754e-10,0,.0458738,.920102,397075e-10,0,.059772,.908002,384886e-10,0,.075645,.897269,43027e-9,0,.0934929,.884559,479925e-10,0,.113302,.869161,48246e-9,0,.135045,.853342,509505e-10,0,.158678,.837633,542846e-10,0,.184136,.820252,554139e-10,0,.211325,.801872,581412e-10,0,.240113,.782418,585535e-10,0,.270306,.7631,610923e-10,0,.301594,.742183,613678e-10,0,.333333,.721098,627275e-10,0,.365079,.699512,629413e-10,0,.396825,.677372,636351e-10,0,.428571,.655059,633555e-10,0,.460317,.632567,636513e-10,0,.492064,.609784,628965e-10,0,.52381,.587237,625546e-10,0,.555556,.564525,615825e-10,0,.587302,.542181,605048e-10,0,.619048,.520017,596329e-10,0,.650794,.498204,581516e-10,0,.68254,.476742,569186e-10,0,.714286,.455803,553833e-10,0,.746032,.435251,537807e-10,0,.777778,.415374,522025e-10,0,.809524,.395921,503421e-10,0,.84127,.377253,488211e-10,0,.873016,.359021,468234e-10,0,.904762,.341637,453269e-10,0,.936508,.3247,433014e-10,0,.968254,.308625,418007e-10,0,1,1,286798e-15,0,0,1,286877e-15,0,0,1,288094e-15,0,0,1,293506e-15,0,0,1,309262e-15,0,0,.999999,348593e-15,0,0,.999999,444582e-15,0,0,.999998,688591e-15,0,0,.999996,134391e-14,0,0,.999993,317438e-14,0,0,.999989,835609e-14,0,0,.999983,228677e-13,0,0,.999974,623361e-13,0,0,.999959,165225e-12,0,0,.999936,419983e-12,0,0,.999896,101546e-11,0,0,.99983,232376e-11,0,0,.999709,50156e-10,0,0,.999469,10167e-9,0,0,.998886,190775e-10,0,0,.996819,300511e-10,0,0,.988837,185092e-10,0,168222e-12,.982178,134622e-10,0,259622e-9,.975017,125961e-10,0,.00142595,.967101,13507e-9,0,.00382273,.964905,205003e-10,0,.00764164,.96218,29546e-9,0,.0130121,.956821,343738e-10,0,.0200253,.948829,305063e-10,0,.0287452,.941092,346487e-10,0,.039218,.931883,412061e-10,0,.0514748,.920211,444651e-10,0,.0655351,.907307,431252e-10,0,.0814082,.89684,490382e-10,0,.0990939,.884119,53334e-9,0,.118583,.869148,54114e-9,0,.139856,.853377,578536e-10,0,.162882,.836753,592285e-10,0,.187615,.820063,622787e-10,0,.213991,.801694,645492e-10,0,.241918,.782116,65353e-9,0,.271267,.762673,674344e-10,0,.301847,.742133,682788e-10,0,.333333,.720779,691959e-10,0,.365079,.699386,696817e-10,0,.396826,.67732,699583e-10,0,.428572,.654888,698447e-10,0,.460318,.632499,694063e-10,0,.492064,.609825,691612e-10,0,.52381,.587287,681576e-10,0,.555556,.564743,674138e-10,0,.587302,.542409,661617e-10,0,.619048,.520282,647785e-10,0,.650794,.498506,633836e-10,0,.68254,.477102,615905e-10,0,.714286,.456167,601013e-10,0,.746032,.435728,581457e-10,0,.777778,.415809,564215e-10,0,.809524,.396517,544997e-10,0,.84127,.377737,525061e-10,0,.873016,.359698,506831e-10,0,.904762,.342164,48568e-9,0,.936508,.325417,467826e-10,0,.968254,.309186,446736e-10,0,1,1,109018e-14,0,0,1,10904e-13,0,0,1,109393e-14,0,0,1,11095e-13,0,0,1,1154e-12,0,0,1,126089e-14,0,0,.999999,15059e-13,0,0,.999997,207899e-14,0,0,.999994,348164e-14,0,0,.999993,705728e-14,0,0,.999987,163692e-13,0,0,.999981,406033e-13,0,0,.999969,10245e-11,0,0,.999953,255023e-12,0,0,.999925,61511e-11,0,0,.999881,142218e-11,0,0,.99981,313086e-11,0,0,.99968,653119e-11,0,0,.999418,12832e-9,0,0,.998748,232497e-10,0,0,.996066,329522e-10,0,0,.988379,179613e-10,0,108799e-9,.982567,143715e-10,0,921302e-9,.976097,148096e-10,0,.00280738,.968475,178905e-10,0,.00596622,.964606,253921e-10,0,.0105284,.961564,348623e-10,0,.0165848,.955517,357612e-10,0,.0242,.948381,343493e-10,0,.03342,.941095,405849e-10,0,.0442777,.931923,475394e-10,0,.0567958,.91996,484328e-10,0,.0709879,.907419,502146e-10,0,.086861,.89618,561654e-10,0,.104415,.88337,587612e-10,0,.123643,.869046,618057e-10,0,.144531,.853278,657392e-10,0,.167057,.836091,66303e-9,0,.191188,.819644,704445e-10,0,.216878,.801246,714071e-10,0,.244062,.782031,740093e-10,0,.272649,.762066,74685e-9,0,.302509,.741964,766647e-10,0,.333442,.720554,766328e-10,0,.365079,.699098,777857e-10,0,.396826,.677189,774633e-10,0,.428572,.65484,776235e-10,0,.460318,.632496,770316e-10,0,.492064,.609908,762669e-10,0,.52381,.587312,753972e-10,0,.555556,.564938,739994e-10,0,.587302,.542577,728382e-10,0,.619048,.52062,71112e-9,0,.650794,.498819,694004e-10,0,.68254,.477555,675575e-10,0,.714286,.456568,653449e-10,0,.746032,.436278,636068e-10,0,.777778,.41637,613466e-10,0,.809524,.397144,594177e-10,0,.84127,.378412,570987e-10,0,.873016,.360376,550419e-10,0,.904762,.342906,527422e-10,0,.936508,.326136,506544e-10,0,.968254,.30997,484307e-10,0,1,1,354014e-14,0,0,1,354073e-14,0,0,1,354972e-14,0,0,1,358929e-14,0,0,1,370093e-14,0,0,.999999,396194e-14,0,0,.999998,453352e-14,0,0,.999997,578828e-14,0,0,.999994,863812e-14,0,0,.999991,153622e-13,0,0,.999985,316356e-13,0,0,.999977,712781e-13,0,0,.999964,166725e-12,0,0,.999945,390501e-12,0,0,.999912,895622e-12,0,0,.999866,198428e-11,0,0,.999786,421038e-11,0,0,.999647,850239e-11,0,0,.999356,162059e-10,0,0,.998563,282652e-10,0,0,.994928,336309e-10,0,244244e-10,.987999,178458e-10,0,523891e-9,.982893,159162e-10,0,.00194729,.977044,178056e-10,0,.00451099,.969972,230624e-10,0,.00835132,.964237,313922e-10,0,.013561,.960791,406145e-10,0,.0202056,.954292,372796e-10,0,.0283321,.948052,403199e-10,0,.0379739,.940938,479537e-10,0,.0491551,.931689,545292e-10,0,.0618918,.91987,54038e-9,0,.0761941,.907665,589909e-10,0,.0920672,.895281,642651e-10,0,.109511,.882621,659707e-10,0,.12852,.86873,709973e-10,0,.149085,.853008,742221e-10,0,.171189,.835944,761754e-10,0,.194809,.818949,797052e-10,0,.21991,.800951,812434e-10,0,.246447,.781847,838075e-10,0,.274352,.761649,84501e-9,0,.303535,.74152,860258e-10,0,.333857,.720495,866233e-10,0,.365104,.698742,868326e-10,0,.396826,.677096,87133e-9,0,.428572,.654782,863497e-10,0,.460318,.632335,860206e-10,0,.492064,.610031,849337e-10,0,.52381,.587457,838279e-10,0,.555556,.56513,82309e-9,0,.587302,.542877,803542e-10,0,.619048,.5209,786928e-10,0,.650794,.499291,765171e-10,0,.68254,.477971,744753e-10,0,.714286,.457221,72209e-9,0,.746032,.436803,697448e-10,0,.777778,.417083,675333e-10,0,.809524,.397749,648058e-10,0,.84127,.379177,625759e-10,0,.873016,.361061,598584e-10,0,.904762,.343713,575797e-10,0,.936508,.326894,549999e-10,0,.968254,.310816,527482e-10,0,1,1,10153e-12,0,0,1,101544e-13,0,0,1,101751e-13,0,0,1,102662e-13,0,0,1,10521e-12,0,0,.999999,111049e-13,0,0,.999999,123408e-13,0,0,.999996,14924e-12,0,0,.999992,204471e-13,0,0,.999989,326539e-13,0,0,.99998,603559e-13,0,0,.999971,123936e-12,0,0,.999955,269058e-12,0,0,.999933,593604e-12,0,0,.999901,129633e-11,0,0,.999847,275621e-11,0,0,.999761,564494e-11,0,0,.999607,110485e-10,0,0,.999282,204388e-10,0,0,.99831,341084e-10,0,22038e-11,.993288,294949e-10,0,242388e-9,.987855,192736e-10,0,.0012503,.983167,182383e-10,0,.0032745,.977908,218633e-10,0,.00646321,.971194,290662e-10,0,.0109133,.963867,386401e-10,0,.0166927,.95982,462827e-10,0,.0238494,.953497,420705e-10,0,.0324178,.947621,477743e-10,0,.0424225,.940611,568258e-10,0,.0538808,.931174,618061e-10,0,.0668047,.919919,627098e-10,0,.0812014,.907856,694714e-10,0,.0970745,.894509,735008e-10,0,.114424,.881954,763369e-10,0,.133246,.868309,821896e-10,0,.153534,.852511,83769e-9,0,.175275,.835821,881615e-10,0,.198453,.817981,896368e-10,0,.223042,.800504,930906e-10,0,.249009,.78141,945056e-10,0,.276304,.761427,963605e-10,0,.304862,.74094,968088e-10,0,.334584,.720233,981481e-10,0,.365322,.698592,979122e-10,0,.396826,.676763,981057e-10,0,.428571,.654808,973956e-10,0,.460318,.632326,962619e-10,0,.492064,.610049,952996e-10,0,.52381,.58763,933334e-10,0,.555556,.565261,917573e-10,0,.587302,.543244,896636e-10,0,.619048,.521273,873304e-10,0,.650794,.499818,852648e-10,0,.68254,.478536,823961e-10,0,.714286,.457826,79939e-9,0,.746032,.437549,77126e-9,0,.777778,.41776,743043e-10,0,.809524,.39863,716426e-10,0,.84127,.379954,686456e-10,0,.873016,.362025,660514e-10,0,.904762,.344581,630755e-10,0,.936508,.327909,605439e-10,0,.968254,.311736,576345e-10,0,1,1,263344e-13,0,0,1,263373e-13,0,0,1,263815e-13,0,0,1,265753e-13,0,0,1,271132e-13,0,0,.999999,283279e-13,0,0,.999997,30833e-12,0,0,.999995,358711e-13,0,0,.999992,461266e-13,0,0,.999985,67574e-12,0,0,.999977,11358e-11,0,0,.999966,213657e-12,0,0,.999948,431151e-12,0,0,.999923,896656e-12,0,0,.999884,186603e-11,0,0,.999826,381115e-11,0,0,.999732,754184e-11,0,0,.999561,143192e-10,0,0,.999191,257061e-10,0,0,.997955,405724e-10,0,744132e-10,.992228,276537e-10,0,716477e-9,.987638,208885e-10,0,.0022524,.983395,215226e-10,0,.00484816,.978614,270795e-10,0,.00860962,.972389,365282e-10,0,.0136083,.964392,474747e-10,0,.0198941,.95861,509141e-10,0,.0275023,.952806,48963e-9,0,.0364584,.94712,571119e-10,0,.04678,.940104,671704e-10,0,.0584799,.930398,687586e-10,0,.0715665,.919866,738161e-10,0,.086045,.907853,813235e-10,0,.101918,.894078,834582e-10,0,.119186,.881177,892093e-10,0,.137845,.867575,944548e-10,0,.157891,.852107,969607e-10,0,.179316,.835502,101456e-9,0,.202106,.81756,103256e-9,0,.226243,.79984,106954e-9,0,.251704,.780998,108066e-9,0,.278451,.761132,110111e-9,0,.306436,.740429,110459e-9,0,.335586,.719836,111219e-9,0,.365796,.698467,11145e-8,0,.3969,.676446,110393e-9,0,.428571,.654635,110035e-9,0,.460318,.632411,108548e-9,0,.492064,.609986,106963e-9,0,.52381,.587872,105238e-9,0,.555556,.565528,102665e-9,0,.587302,.543563,100543e-9,0,.619048,.52176,976182e-10,0,.650794,.500188,947099e-10,0,.68254,.479204,919929e-10,0,.714286,.458413,886139e-10,0,.746032,.438314,857839e-10,0,.777778,.418573,82411e-9,0,.809524,.39947,792211e-10,0,.84127,.380892,759546e-10,0,.873016,.362953,727571e-10,0,.904762,.345601,695738e-10,0,.936508,.328895,664907e-10,0,.968254,.312808,634277e-10,0,1,1,628647e-13,0,0,1,628705e-13,0,0,1,629587e-13,0,0,1,633441e-13,0,0,.999999,644087e-13,0,0,.999998,667856e-13,0,0,.999997,715889e-13,0,0,.999995,809577e-13,0,0,.999989,992764e-13,0,0,.999983,135834e-12,0,0,.999974,210482e-12,0,0,.999959,365215e-12,0,0,.999939,686693e-12,0,0,.999911,13472e-10,0,0,.999868,26731e-10,0,0,.999804,524756e-11,0,0,.9997,100403e-10,0,0,.99951,185019e-10,0,0,.999078,322036e-10,0,620676e-11,.997428,470002e-10,0,341552e-9,.99162,287123e-10,0,.00143727,.987479,234706e-10,0,.00349201,.983582,260083e-10,0,.0066242,.979186,337927e-10,0,.0109113,.97325,454689e-10,0,.0164064,.965221,573759e-10,0,.0231463,.957262,544114e-10,0,.0311571,.952211,587006e-10,0,.0404572,.946631,692256e-10,0,.0510592,.939391,787819e-10,0,.0629723,.929795,792368e-10,0,.0762025,.91965,875075e-10,0,.090753,.907737,950903e-10,0,.106626,.893899,972963e-10,0,.123822,.880239,10459e-8,0,.142337,.866562,107689e-9,0,.16217,.85164,113081e-9,0,.183314,.835021,116636e-9,0,.20576,.817311,120074e-9,0,.229496,.798845,121921e-9,0,.254502,.780479,12475e-8,0,.280753,.760694,125255e-9,0,.308212,.740142,126719e-9,0,.336825,.719248,12636e-8,0,.366517,.698209,126712e-9,0,.397167,.676398,125769e-9,0,.428578,.654378,124432e-9,0,.460318,.632484,123272e-9,0,.492064,.610113,12085e-8,0,.52381,.587931,118411e-9,0,.555556,.565872,11569e-8,0,.587302,.543814,112521e-9,0,.619048,.522265,109737e-9,0,.650794,.500835,106228e-9,0,.68254,.479818,102591e-9,0,.714286,.459258,991288e-10,0,.746032,.439061,952325e-10,0,.777778,.419552,91895e-9,0,.809524,.400399,879051e-10,0,.84127,.381976,844775e-10,0,.873016,.364009,806316e-10,0,.904762,.346761,771848e-10,0,.936508,.330049,735429e-10,0,.968254,.314018,702103e-10,0,1,1,139968e-12,0,0,1,139979e-12,0,0,1,140145e-12,0,0,1,14087e-11,0,0,.999999,142865e-12,0,0,.999998,147279e-12,0,0,.999997,156057e-12,0,0,.999992,17276e-11,0,0,.999989,204352e-12,0,0,.99998,26494e-11,0,0,.999969,383435e-12,0,0,.999953,618641e-12,0,0,.999929,108755e-11,0,0,.999898,201497e-11,0,0,.999849,381346e-11,0,0,.999778,719815e-11,0,0,.999661,133215e-10,0,0,.999451,238313e-10,0,0,.998936,401343e-10,0,113724e-9,.99662,517346e-10,0,820171e-9,.991094,304323e-10,0,.00238143,.987487,281757e-10,0,.00493527,.983731,320048e-10,0,.00856859,.979647,423905e-10,0,.0133393,.973837,562935e-10,0,.0192863,.96584,677442e-10,0,.0264369,.956309,623073e-10,0,.03481,.951523,704131e-10,0,.0444184,.946003,836594e-10,0,.0552713,.938454,911736e-10,0,.0673749,.929279,938264e-10,0,.0807329,.919239,103754e-9,0,.0953479,.907293,109928e-9,0,.111221,.893936,115257e-9,0,.128352,.879674,122265e-9,0,.14674,.865668,125733e-9,0,.166382,.850998,132305e-9,0,.187276,.834498,134844e-9,0,.209413,.816903,139276e-9,0,.232786,.798235,140984e-9,0,.257382,.779724,14378e-8,0,.283181,.760251,144623e-9,0,.310156,.739808,145228e-9,0,.338269,.718762,14539e-8,0,.367461,.697815,144432e-9,0,.397646,.67631,143893e-9,0,.428685,.654278,141846e-9,0,.460318,.632347,13935e-8,0,.492064,.610296,137138e-9,0,.52381,.588039,133806e-9,0,.555556,.566218,130755e-9,0,.587302,.544346,127128e-9,0,.619048,.522701,123002e-9,0,.650794,.501542,119443e-9,0,.68254,.480508,115055e-9,0,.714286,.460092,111032e-9,0,.746032,.440021,106635e-9,0,.777778,.420446,102162e-9,0,.809524,.401512,98184e-9,0,.84127,.38299,936497e-10,0,.873016,.365232,89813e-9,0,.904762,.347865,853073e-10,0,.936508,.331342,817068e-10,0,.968254,.315202,773818e-10,0,1,1,29368e-11,0,0,1,2937e-10,0,0,1,293998e-12,0,0,1,295298e-12,0,0,.999999,298865e-12,0,0,.999998,3067e-10,0,0,.999995,322082e-12,0,0,.999992,350767e-12,0,0,.999986,403538e-12,0,0,.999976,501372e-12,0,0,.999964,68562e-11,0,0,.999945,10374e-10,0,0,.999919,171269e-11,0,0,.999882,300175e-11,0,0,.999829,542144e-11,0,0,.999749,984182e-11,0,0,.99962,176213e-10,0,0,.999382,305995e-10,0,138418e-10,.998751,496686e-10,0,389844e-9,.995344,510733e-10,0,.00150343,.990768,345829e-10,0,.00352451,.987464,342841e-10,0,.00655379,.983846,399072e-10,0,.0106554,.980007,533219e-10,0,.0158723,.974494,696992e-10,0,.0222333,.96622,776754e-10,0,.029758,.956273,747718e-10,0,.0384596,.950952,864611e-10,0,.0483473,.945215,100464e-9,0,.0594266,.937287,103729e-9,0,.0717019,.928649,111665e-9,0,.0851752,.918791,12353e-8,0,.0998479,.906685,127115e-9,0,.115721,.893706,13628e-8,0,.132794,.879248,142427e-9,0,.151067,.864685,148091e-9,0,.170538,.850032,153517e-9,0,.191204,.833853,157322e-9,0,.213063,.816353,161086e-9,0,.236107,.797834,164111e-9,0,.260329,.778831,165446e-9,0,.285714,.759756,167492e-9,0,.312243,.739419,166928e-9,0,.339887,.718491,167e-6,0,.368604,.697392,165674e-9,0,.398329,.676102,163815e-9,0,.428961,.654243,162003e-9,0,.460331,.632176,158831e-9,0,.492064,.610407,155463e-9,0,.52381,.588394,152062e-9,0,.555556,.56645,147665e-9,0,.587302,.5449,14375e-8,0,.619048,.523276,138905e-9,0,.650794,.502179,134189e-9,0,.68254,.481359,129392e-9,0,.714286,.46092,124556e-9,0,.746032,.441084,11957e-8,0,.777778,.421517,114652e-9,0,.809524,.402721,109688e-9,0,.84127,.384222,104667e-9,0,.873016,.366534,999633e-10,0,.904762,.349205,950177e-10,0,.936508,.332702,907301e-10,0,.968254,.316599,859769e-10,0,1,1,585473e-12,0,0,1,585507e-12,0,0,1,58602e-11,0,0,.999999,588259e-12,0,0,.999999,594381e-12,0,0,.999998,607754e-12,0,0,.999995,633729e-12,0,0,.99999,68137e-11,0,0,.999984,767003e-12,0,0,.999973,921212e-12,0,0,.999959,120218e-11,0,0,.999936,172024e-11,0,0,.999907,268088e-11,0,0,.999866,445512e-11,0,0,.999806,768481e-11,0,0,.999716,1342e-8,0,0,.999576,232473e-10,0,0,.9993,391694e-10,0,129917e-9,.998498,608429e-10,0,845035e-9,.994132,489743e-10,0,.00237616,.99031,384644e-10,0,.00484456,.987409,421768e-10,0,.00832472,.983981,504854e-10,0,.0128643,.980268,671028e-10,0,.0184947,.974875,852749e-10,0,.025237,.966063,85531e-9,0,.0331046,.956779,900588e-10,0,.0421067,.950259,10577e-8,0,.0522487,.944239,119458e-9,0,.0635343,.936341,122164e-9,0,.0759654,.928047,134929e-9,0,.0895434,.918065,145544e-9,0,.104269,.906267,150531e-9,0,.120142,.893419,161652e-9,0,.137163,.878758,16593e-8,0,.15533,.863699,174014e-9,0,.174645,.848876,177877e-9,0,.195106,.833032,184049e-9,0,.21671,.815557,186088e-9,0,.239454,.797323,19054e-8,0,.263332,.778124,191765e-9,0,.288336,.758929,192535e-9,0,.314451,.738979,192688e-9,0,.341658,.718213,191522e-9,0,.369924,.696947,190491e-9,0,.399202,.675807,187913e-9,0,.429416,.654147,184451e-9,0,.460447,.63229,181442e-9,0,.492064,.610499,177139e-9,0,.523809,.588747,172596e-9,0,.555555,.566783,167457e-9,0,.587301,.545359,162518e-9,0,.619048,.523984,156818e-9,0,.650794,.502917,151884e-9,0,.68254,.482294,145514e-9,0,.714286,.461945,140199e-9,0,.746032,.442133,134101e-9,0,.777778,.422705,128374e-9,0,.809524,.403916,122996e-9,0,.84127,.38554,116808e-9,0,.873016,.367909,111973e-9,0,.904762,.350651,105938e-9,0,.936508,.334208,101355e-9,0,.968254,.318123,957629e-10,0,1,1,111633e-11,0,0,1,111639e-11,0,0,1,111725e-11,0,0,1,112096e-11,0,0,.999999,11311e-10,0,0,.999997,115315e-11,0,0,.999995,11956e-10,0,0,.999989,127239e-11,0,0,.999981,140772e-11,0,0,.999969,164541e-11,0,0,.999952,206607e-11,0,0,.999928,281783e-11,0,0,.999895,416835e-11,0,0,.999848,658728e-11,0,0,.999781,108648e-10,0,0,.999682,182579e-10,0,0,.999523,306003e-10,0,159122e-10,.999205,499862e-10,0,391184e-9,.998131,73306e-9,0,.00147534,.993334,513229e-10,0,.0034227,.99016,467783e-10,0,.00632232,.987321,523413e-10,0,.0102295,.984099,64267e-9,0,.0151794,.980432,843042e-10,0,.0211947,.974976,102819e-9,0,.0282899,.966429,996234e-10,0,.0364739,.957633,111074e-9,0,.0457522,.949422,128644e-9,0,.0561278,.943045,140076e-9,0,.0676023,.935448,146349e-9,0,.0801762,.927225,161854e-9,0,.0938499,.917033,169135e-9,0,.108623,.905762,179987e-9,0,.124496,.892879,189832e-9,0,.141469,.878435,195881e-9,0,.159541,.863114,20466e-8,0,.178713,.84776,209473e-9,0,.198985,.832084,214861e-9,0,.220355,.814915,217695e-9,0,.242823,.796711,220313e-9,0,.266385,.777603,22313e-8,0,.291036,.757991,222471e-9,0,.316767,.738371,222869e-9,0,.343563,.717872,221243e-9,0,.371402,.696619,218089e-9,0,.400248,.675379,21562e-8,0,.430047,.65411,21169e-8,0,.460709,.63241,206947e-9,0,.492079,.61046,201709e-9,0,.52381,.58903,196753e-9,0,.555556,.567267,189637e-9,0,.587302,.545886,184735e-9,0,.619048,.524714,177257e-9,0,.650794,.503789,171424e-9,0,.68254,.483204,164688e-9,0,.714286,.462976,157172e-9,0,.746032,.443294,151341e-9,0,.777778,.423988,143737e-9,0,.809524,.405325,138098e-9,0,.84127,.386981,130698e-9,0,.873016,.369436,125276e-9,0,.904762,.35219,118349e-9,0,.936508,.335804,11312e-8,0,.968254,.319749,106687e-9,0,1,1,204685e-11,0,0,1,204694e-11,0,0,1,204831e-11,0,0,.999999,205428e-11,0,0,.999999,207056e-11,0,0,.999997,210581e-11,0,0,.999993,21732e-10,0,0,.999987,229365e-11,0,0,.999979,250243e-11,0,0,.999965,286127e-11,0,0,.999947,348028e-11,0,0,.999918,455588e-11,0,0,.999881,643303e-11,0,0,.999828,970064e-11,0,0,.999753,153233e-10,0,0,.999642,24793e-9,0,0,.999464,402032e-10,0,122947e-9,.999089,635852e-10,0,807414e-9,.997567,857026e-10,0,.00227206,.992903,594912e-10,0,.00462812,.990011,578515e-10,0,.00794162,.987192,65399e-9,0,.0122534,.98418,819675e-10,0,.0175888,.980491,105514e-9,0,.0239635,.974779,121532e-9,0,.031387,.96675,119144e-9,0,.0398644,.958248,136125e-9,0,.0493982,.948884,155408e-9,0,.0599896,.941673,162281e-9,0,.0716382,.934521,176754e-9,0,.0843437,.926205,192873e-9,0,.0981056,.916089,200038e-9,0,.112923,.904963,213624e-9,0,.128796,.892089,221834e-9,0,.145725,.878028,232619e-9,0,.163709,.86249,238632e-9,0,.182749,.846587,247002e-9,0,.202847,.830988,250702e-9,0,.224001,.814165,255562e-9,0,.246214,.796135,257505e-9,0,.269482,.777052,258625e-9,0,.293805,.757201,258398e-9,0,.319176,.737655,256714e-9,0,.345587,.717477,255187e-9,0,.373021,.696433,251792e-9,0,.401454,.675084,247223e-9,0,.430844,.653907,242213e-9,0,.461125,.632561,237397e-9,0,.492187,.610658,229313e-9,0,.52381,.589322,224402e-9,0,.555556,.567857,216116e-9,0,.587302,.54652,209124e-9,0,.619048,.525433,201601e-9,0,.650794,.504679,192957e-9,0,.68254,.484203,186052e-9,0,.714286,.464203,177672e-9,0,.746032,.444549,170005e-9,0,.777778,.425346,162401e-9,0,.809524,.406706,1544e-7,0,.84127,.388576,147437e-9,0,.873016,.37094,139493e-9,0,.904762,.353996,133219e-9,0,.936508,.337391,125573e-9,0,.968254,.321648,119867e-9,0,1,1,362511e-11,0,0,1,362525e-11,0,0,1,362739e-11,0,0,.999999,363673e-11,0,0,.999998,366214e-11,0,0,.999996,371698e-11,0,0,.999992,382116e-11,0,0,.999986,400554e-11,0,0,.999976,432058e-11,0,0,.999961,485194e-11,0,0,.999938,574808e-11,0,0,.999908,726643e-11,0,0,.999865,984707e-11,0,0,.999807,142217e-10,0,0,.999723,215581e-10,0,0,.999602,336114e-10,0,119113e-10,.999398,527353e-10,0,355813e-9,.998946,805809e-10,0,.00137768,.996647,942908e-10,0,.00322469,.992298,668733e-10,0,.00597897,.989802,716564e-10,0,.00968903,.987019,821355e-10,0,.0143845,.984219,104555e-9,0,.0200831,.980425,131245e-9,0,.0267948,.974241,139613e-9,0,.034525,.967006,145931e-9,0,.0432757,.95893,167153e-9,0,.0530471,.949157,188146e-9,0,.0638386,.94062,194625e-9,0,.0756487,.933509,213721e-9,0,.0884762,.925088,229616e-9,0,.10232,.915178,239638e-9,0,.117178,.904093,254814e-9,0,.133051,.891337,263685e-9,0,.149939,.877326,274789e-9,0,.167841,.861794,280534e-9,0,.18676,.845758,289534e-9,0,.206696,.829792,294446e-9,0,.22765,.813037,296877e-9,0,.249625,.795285,300217e-9,0,.27262,.776323,299826e-9,0,.296636,.756673,299787e-9,0,.321671,.736856,297867e-9,0,.347718,.716883,294052e-9,0,.374768,.696089,289462e-9,0,.402804,.67505,285212e-9,0,.431796,.653509,27653e-8,0,.461695,.63258,271759e-9,0,.49242,.61104,262811e-9,0,.523822,.589567,255151e-9,0,.555556,.568322,246434e-9,0,.587302,.547235,237061e-9,0,.619048,.52616,228343e-9,0,.650794,.505716,219236e-9,0,.68254,.485274,209595e-9,0,.714286,.465411,201011e-9,0,.746032,.445854,19109e-8,0,.777778,.426911,182897e-9,0,.809524,.408222,173569e-9,0,.84127,.390307,165496e-9,0,.873016,.372624,156799e-9,0,.904762,.355804,14917e-8,0,.936508,.33924,140907e-9,0,.968254,.323534,134062e-9,0,1,1,622487e-11,0,0,1,62251e-10,0,0,1,622837e-11,0,0,.999999,624259e-11,0,0,.999998,628127e-11,0,0,.999996,636451e-11,0,0,.999991,65218e-10,0,0,.999984,679782e-11,0,0,.999973,726361e-11,0,0,.999955,803644e-11,0,0,.999931,931397e-11,0,0,.999896,114299e-10,0,0,.999847,149402e-10,0,0,.999784,207461e-10,0,0,.999692,302493e-10,0,0,.999554,454957e-10,0,997275e-10,.999326,690762e-10,0,724813e-9,.998757,101605e-9,0,.0020972,.995367,958745e-10,0,.00432324,.99209,832808e-10,0,.00746347,.989517,887601e-10,0,.0115534,.987008,10564e-8,0,.0166134,.98421,133179e-9,0,.0226552,.98021,161746e-9,0,.0296838,.973676,161821e-9,0,.0377016,.967052,178635e-9,0,.0467079,.959385,206765e-9,0,.0567013,.949461,22476e-8,0,.0676796,.939578,23574e-8,0,.0796403,.932416,25893e-8,0,.0925812,.923759,271228e-9,0,.106501,.914223,289165e-9,0,.121397,.902942,301156e-9,0,.13727,.890419,313852e-9,0,.15412,.876639,324408e-9,0,.171946,.861316,33249e-8,0,.190751,.84496,338497e-9,0,.210537,.828427,345861e-9,0,.231305,.811871,347863e-9,0,.253057,.794397,350225e-9,0,.275797,.775726,349915e-9,0,.299525,.75617,347297e-9,0,.324242,.736091,344232e-9,0,.349947,.716213,340835e-9,0,.376633,.695736,332369e-9,0,.404289,.674961,327943e-9,0,.432895,.653518,318533e-9,0,.462415,.632574,310391e-9,0,.492788,.61134,300755e-9,0,.523909,.590017,290506e-9,0,.555556,.568752,280446e-9,0,.587302,.548061,269902e-9,0,.619048,.52711,258815e-9,0,.650794,.506682,248481e-9,0,.68254,.486524,237141e-9,0,.714286,.466812,226872e-9,0,.746032,.44732,216037e-9,0,.777778,.428473,205629e-9,0,.809524,.409921,195691e-9,0,.84127,.392028,185457e-9,0,.873016,.374606,176436e-9,0,.904762,.357601,166508e-9,0,.936508,.341348,158385e-9,0,.968254,.32542,149203e-9,0,1,1,103967e-10,0,0,1,10397e-9,0,0,1,104019e-10,0,0,.999999,104231e-10,0,0,.999998,104806e-10,0,0,.999995,106042e-10,0,0,.999991,108366e-10,0,0,.999982,112415e-10,0,0,.999968,119174e-10,0,0,.99995,130227e-10,0,0,.999922,148176e-10,0,0,.999884,177303e-10,0,0,.99983,224564e-10,0,0,.999758,300966e-10,0,0,.999654,423193e-10,0,549083e-11,.999503,614848e-10,0,296087e-9,.999237,903576e-10,0,.00123144,.998491,1271e-7,0,.00295954,.994594,107754e-9,0,.00555829,.99178,103025e-9,0,.00907209,.989265,11154e-8,0,.0135257,.986998,136296e-9,0,.0189327,.984137,169154e-9,0,.0252993,.979798,196671e-9,0,.0326272,.97337,196678e-9,0,.0409157,.967239,223121e-9,0,.0501623,.959543,253809e-9,0,.0603638,.949466,265972e-9,0,.0715171,.939074,288372e-9,0,.0836187,.931118,310983e-9,0,.0966657,.922525,325561e-9,0,.110656,.912983,345725e-9,0,.125588,.901617,3556e-7,0,.141461,.889487,374012e-9,0,.158275,.875787,383445e-9,0,.176031,.860654,393972e-9,0,.19473,.844417,400311e-9,0,.214374,.82741,405004e-9,0,.234967,.810545,407378e-9,0,.256512,.793312,407351e-9,0,.279011,.774847,406563e-9,0,.302468,.755621,404903e-9,0,.326887,.735511,397486e-9,0,.352266,.715435,39357e-8,0,.378605,.695403,384739e-9,0,.405897,.674681,376108e-9,0,.43413,.65359,365997e-9,0,.463277,.632471,354957e-9,0,.493295,.61151,343593e-9,0,.524106,.59064,331841e-9,0,.555561,.569386,318891e-9,0,.587302,.548785,3072e-7,0,.619048,.528146,29361e-8,0,.650794,.507872,281709e-9,0,.68254,.487805,268627e-9,0,.714286,.468196,255887e-9,0,.746032,.448922,243997e-9,0,.777778,.430093,231662e-9,0,.809524,.411845,220339e-9,0,.84127,.393808,208694e-9,0,.873016,.376615,198045e-9,0,.904762,.359655,187375e-9,0,.936508,.343452,177371e-9,0,.968254,.32765,167525e-9,0,1,1,169351e-10,0,0,1,169356e-10,0,0,1,169427e-10,0,0,.999999,169736e-10,0,0,.999998,170575e-10,0,0,.999995,172372e-10,0,0,.99999,175739e-10,0,0,.999979,181568e-10,0,0,.999966,191206e-10,0,0,.999944,20677e-9,0,0,.999912,231644e-10,0,0,.999869,271268e-10,0,0,.999811,334272e-10,0,0,.99973,433979e-10,0,0,.999617,590083e-10,0,680315e-10,.999445,829497e-10,0,612796e-9,.999138,118019e-9,0,.00187408,.998095,156712e-9,0,.00395791,.993919,125054e-9,0,.00692144,.991333,126091e-9,0,.0107962,.989226,144912e-9,0,.0155986,.986954,175737e-9,0,.0213364,.983982,213883e-9,0,.0280114,.979128,234526e-9,0,.0356226,.973327,243725e-9,0,.0441668,.967416,2773e-7,0,.0536399,.959729,308799e-9,0,.0640376,.949758,322447e-9,0,.0753554,.939173,350021e-9,0,.0875893,.9296,370089e-9,0,.100736,.921181,391365e-9,0,.114793,.91164,413636e-9,0,.129759,.900435,427068e-9,0,.145632,.888183,441046e-9,0,.162412,.874772,454968e-9,0,.180101,.859566,461882e-9,0,.1987,.843579,471556e-9,0,.218213,.826453,474335e-9,0,.238641,.809164,477078e-9,0,.259989,.792179,47755e-8,0,.282262,.773866,472573e-9,0,.305464,.754944,469765e-9,0,.329599,.735133,462371e-9,0,.35467,.714858,453674e-9,0,.380678,.694829,443888e-9,0,.407622,.674453,432052e-9,0,.435493,.653685,420315e-9,0,.464275,.632666,406829e-9,0,.493938,.611676,392234e-9,0,.524422,.591193,379208e-9,0,.555624,.570145,36319e-8,0,.587302,.549566,349111e-9,0,.619048,.529278,334166e-9,0,.650794,.509026,318456e-9,0,.68254,.489186,30449e-8,0,.714286,.469662,289051e-9,0,.746032,.450691,275494e-9,0,.777778,.431841,261437e-9,0,.809524,.413752,247846e-9,0,.84127,.395951,235085e-9,0,.873016,.378633,222245e-9,0,.904762,.36194,210533e-9,0,.936508,.345599,198494e-9,0,.968254,.329999,188133e-9,0,1,1,269663e-10,0,0,1,26967e-9,0,0,1,269772e-10,0,0,.999999,270214e-10,0,0,.999998,271415e-10,0,0,.999994,27398e-9,0,0,.999988,278771e-10,0,0,.999977,287019e-10,0,0,.999961,300544e-10,0,0,.999937,322138e-10,0,0,.999904,356163e-10,0,0,.999854,409465e-10,0,0,.99979,492651e-10,0,0,.999699,621722e-10,0,88288e-11,.999572,819715e-10,0,223369e-9,.999381,111689e-9,0,.00105414,.999016,153862e-9,0,.0026493,.997437,187667e-9,0,.00508608,.993545,155672e-9,0,.00840554,.991135,161455e-9,0,.012629,.989157,188241e-9,0,.0177661,.986874,226229e-9,0,.0238198,.983714,268668e-9,0,.0307887,.978301,277109e-9,0,.0386688,.973227,303446e-9,0,.0474554,.967317,341851e-9,0,.0571428,.959477,370885e-9,0,.0677256,.950012,392753e-9,0,.0791988,.939484,42781e-8,0,.0915576,.928135,443866e-9,0,.104798,.919819,472959e-9,0,.118918,.910049,491551e-9,0,.133915,.899181,512616e-9,0,.149788,.886881,523563e-9,0,.166537,.87359,540183e-9,0,.184164,.858613,547386e-9,0,.202669,.842809,554809e-9,0,.222056,.825727,558316e-9,0,.242329,.808086,557824e-9,0,.263492,.790728,556346e-9,0,.285551,.772987,552672e-9,0,.30851,.7541,543738e-9,0,.332376,.734669,536107e-9,0,.357153,.714411,523342e-9,0,.382845,.694196,512238e-9,0,.409454,.674252,497465e-9,0,.436977,.65357,481096e-9,0,.465404,.632999,467054e-9,0,.494713,.611994,448771e-9,0,.524864,.591604,431889e-9,0,.555779,.571134,415238e-9,0,.587302,.550528,396369e-9,0,.619048,.530292,379477e-9,0,.650794,.510364,361488e-9,0,.68254,.490749,343787e-9,0,.714286,.471266,327822e-9,0,.746032,.452462,310626e-9,0,.777778,.433907,295352e-9,0,.809524,.415659,279179e-9,0,.84127,.398138,264685e-9,0,.873016,.380833,249905e-9,0,.904762,.364247,236282e-9,0,.936508,.348041,222905e-9,0,.968254,.332389,210522e-9,0,1,1,420604e-10,0,0,1,420614e-10,0,0,1,420757e-10,0,0,.999999,42138e-9,0,0,.999997,423067e-10,0,0,.999993,426668e-10,0,0,.999986,433372e-10,0,0,.999974,444857e-10,0,0,.999956,463554e-10,0,0,.99993,493105e-10,0,0,.999892,539077e-10,0,0,.999838,610005e-10,0,0,.999767,718822e-10,0,0,.999666,884581e-10,0,365471e-10,.999525,113398e-9,0,485623e-9,.999311,150043e-9,0,.00162096,.998865,200063e-9,0,.00355319,.996278,211014e-9,0,.00633818,.992956,189672e-9,0,.0100043,.991017,210262e-9,0,.0145648,.989055,244292e-9,0,.0200237,.986741,290481e-9,0,.0263798,.983288,334303e-9,0,.033629,.977784,340307e-9,0,.0417652,.973037,377864e-9,0,.0507821,.967181,4239e-7,0,.060673,.958971,443854e-9,0,.0714314,.950093,483039e-9,0,.0830518,.939552,517934e-9,0,.0955288,.927678,539449e-9,0,.108859,.918278,568604e-9,0,.123038,.908449,588505e-9,0,.138065,.897713,612473e-9,0,.153938,.885533,625575e-9,0,.170657,.872131,63854e-8,0,.188224,.857517,647034e-9,0,.20664,.841796,65209e-8,0,.225909,.824726,6544e-7,0,.246035,.807297,655744e-9,0,.267022,.789058,646716e-9,0,.288878,.77189,643898e-9,0,.311607,.753082,629973e-9,0,.335216,.7341,621564e-9,0,.359713,.714094,605171e-9,0,.385103,.693839,588752e-9,0,.41139,.673891,573294e-9,0,.438576,.653565,552682e-9,0,.466656,.633326,533446e-9,0,.495617,.612582,514635e-9,0,.525431,.59205,49303e-8,0,.556041,.571918,471842e-9,0,.587338,.551572,451713e-9,0,.619048,.531553,430049e-9,0,.650794,.51175,410445e-9,0,.68254,.49238,390098e-9,0,.714286,.473143,370033e-9,0,.746032,.45423,351205e-9,0,.777778,.435963,332049e-9,0,.809524,.41787,315021e-9,0,.84127,.400387,297315e-9,0,.873016,.383332,281385e-9,0,.904762,.366665,265397e-9,0,.936508,.350633,250601e-9,0,.968254,.334964,23589e-8,0,1,1,643736e-10,0,0,1,64375e-9,0,0,1,643947e-10,0,0,.999999,64481e-9,0,0,.999997,647143e-10,0,0,.999994,652119e-10,0,0,.999985,661359e-10,0,0,.999972,677116e-10,0,0,.999952,702599e-10,0,0,.999922,742517e-10,0,0,.99988,803906e-10,0,0,.99982,897315e-10,0,0,.999741,103838e-9,0,0,.999629,12496e-8,0,149024e-9,.999474,156161e-9,0,861027e-9,.999229,201034e-9,0,.00231198,.998662,259069e-9,0,.00458147,.995299,245439e-9,0,.00770895,.992732,24498e-8,0,.0117126,.990847,273211e-9,0,.0165989,.988911,316492e-9,0,.0223674,.98654,37161e-8,0,.0290135,.982636,410352e-9,0,.0365309,.977346,421756e-9,0,.0449117,.972909,475578e-9,0,.0541481,.966821,522482e-9,0,.0642326,.958686,545008e-9,0,.075158,.949754,589286e-9,0,.0869181,.939184,619995e-9,0,.0995074,.927505,654266e-9,0,.112922,.916606,682362e-9,0,.127157,.906707,704286e-9,0,.142212,.895937,725909e-9,0,.158085,.883913,743939e-9,0,.174776,.870642,755157e-9,0,.192287,.856241,764387e-9,0,.210619,.84069,771032e-9,0,.229775,.823728,765906e-9,0,.249761,.806481,767604e-9,0,.270582,.787924,754385e-9,0,.292243,.770588,749668e-9,0,.314753,.751991,731613e-9,0,.338118,.733407,717655e-9,0,.362347,.713688,700604e-9,0,.387447,.693595,678765e-9,0,.413424,.673426,657042e-9,0,.440284,.65359,635892e-9,0,.468027,.633576,611569e-9,0,.496645,.613144,586011e-9,0,.526122,.592711,563111e-9,0,.556417,.572722,537699e-9,0,.587451,.552762,512556e-9,0,.619048,.532985,489757e-9,0,.650794,.513219,464139e-9,0,.68254,.493992,442193e-9,0,.714286,.47509,418629e-9,0,.746032,.456287,397045e-9,0,.777778,.438152,375504e-9,0,.809524,.420294,35492e-8,0,.84127,.402749,335327e-9,0,.873016,.385879,316422e-9,0,.904762,.369352,298333e-9,0,.936508,.353301,281417e-9,0,.968254,.337781,265203e-9,0,1,1,968267e-10,0,0,1,968284e-10,0,0,1,968556e-10,0,0,.999999,969733e-10,0,0,.999997,972913e-10,0,0,.999993,979688e-10,0,0,.999984,992239e-10,0,0,.999969,101356e-9,0,0,.999946,104784e-9,0,0,.999913,110111e-9,0,0,.999868,118217e-9,0,0,.999801,130396e-9,0,0,.999712,148523e-9,0,124907e-10,.999589,175233e-9,0,355405e-9,.999416,213999e-9,0,.0013528,.999136,268529e-9,0,.00312557,.998367,333088e-9,0,.00573045,.994701,304757e-9,0,.00919397,.992497,318031e-9,0,.0135261,.990608,353863e-9,0,.0187278,.988715,409044e-9,0,.0247947,.986241,472967e-9,0,.0317196,.981696,495104e-9,0,.039494,.977097,532873e-9,0,.0481087,.972583,594447e-9,0,.0575549,.966142,636867e-9,0,.0678242,.95823,669899e-9,0,.0789089,.949677,719499e-9,0,.0908023,.939226,750584e-9,0,.103499,.927501,793183e-9,0,.116993,.915199,81995e-8,0,.131282,.90498,847654e-9,0,.146364,.894243,868929e-9,0,.162237,.882154,884278e-9,0,.178902,.869161,898108e-9,0,.196358,.854751,901254e-9,0,.21461,.839368,90679e-8,0,.23366,.822874,901541e-9,0,.253512,.805514,897297e-9,0,.274174,.78716,881856e-9,0,.29565,.769061,870032e-9,0,.31795,.751,851719e-9,0,.341081,.732614,830671e-9,0,.365053,.713171,806569e-9,0,.389874,.693472,78338e-8,0,.415553,.673528,756404e-9,0,.442098,.653397,726872e-9,0,.469512,.633781,700494e-9,0,.497794,.613877,67105e-8,0,.526935,.593506,640361e-9,0,.556908,.573667,613502e-9,0,.587657,.553932,583177e-9,0,.61906,.534345,554375e-9,0,.650794,.515042,527811e-9,0,.68254,.495674,499367e-9,0,.714286,.477132,47429e-8,0,.746032,.458609,447726e-9,0,.777778,.440354,424205e-9,0,.809524,.422765,399549e-9,0,.84127,.405472,378315e-9,0,.873016,.388482,355327e-9,0,.904762,.372191,336122e-9,0,.936508,.356099,315247e-9,0,.968254,.340737,29794e-8,0,1,1,143327e-9,0,0,1,14333e-8,0,0,1,143366e-9,0,0,.999999,143524e-9,0,0,.999996,143952e-9,0,0,.999991,144862e-9,0,0,.999981,146544e-9,0,0,.999966,149391e-9,0,0,.999941,153946e-9,0,0,.999905,160971e-9,0,0,.999852,171562e-9,0,0,.99978,18729e-8,0,0,.999681,210386e-9,0,826239e-10,.999546,243906e-9,0,664807e-9,.999352,291739e-9,0,.00196192,.999027,357419e-9,0,.00405941,.997886,422349e-9,0,.00699664,.99419,385008e-9,0,.0107896,.99214,409775e-9,0,.0154415,.990274,456418e-9,0,.0209488,.988455,527008e-9,0,.0273037,.985804,597685e-9,0,.0344969,.98103,613124e-9,0,.0425183,.976674,668321e-9,0,.0513575,.972021,736985e-9,0,.0610046,.965274,773789e-9,0,.0714508,.958046,830852e-9,0,.0826877,.949333,875766e-9,0,.0947085,.939135,917088e-9,0,.107507,.927119,952244e-9,0,.121078,.91469,990626e-9,0,.135419,.903006,.00101304,0,.150526,.892368,.00103834,0,.166399,.880231,.00105002,0,.183038,.867432,.00106331,0,.200443,.853208,.00106783,0,.218618,.837956,.00106458,0,.237566,.821772,.00105945,0,.257291,.804328,.00104685,0,.2778,.786465,.00103178,0,.2991,.768004,.00101077,0,.321199,.74972,985504e-9,0,.344106,.731682,962893e-9,0,.36783,.712813,932146e-9,0,.392383,.693139,89871e-8,0,.417774,.673566,869678e-9,0,.444013,.653483,835525e-9,0,.471107,.633891,799853e-9,0,.49906,.614433,766838e-9,0,.527869,.594586,732227e-9,0,.557517,.574769,696442e-9,0,.587966,.555149,663935e-9,0,.61913,.535898,629826e-9,0,.650794,.516753,596486e-9,0,.68254,.497816,567078e-9,0,.714286,.479034,534399e-9,0,.746032,.460975,507013e-9,0,.777778,.442935,477421e-9,0,.809524,.425263,451101e-9,0,.84127,.408248,424964e-9,0,.873016,.391339,39993e-8,0,.904762,.37513,377619e-9,0,.936508,.359172,354418e-9,0,.968254,.343876,334823e-9,0,1,1,209042e-9,0,0,1,209045e-9,0,0,1,209093e-9,0,0,.999999,209304e-9,0,0,.999996,209871e-9,0,0,.999991,211078e-9,0,0,.999979,213304e-9,0,0,.999963,217061e-9,0,0,.999933,223042e-9,0,0,.999894,232206e-9,0,0,.999837,245901e-9,0,0,.999756,266023e-9,0,102927e-11,.999648,295204e-9,0,233468e-9,.999499,336958e-9,0,.00108237,.999283,395563e-9,0,.00268832,.998896,473785e-9,0,.00511138,.997006,520008e-9,0,.00837705,.993819,497261e-9,0,.0124928,.991632,523722e-9,0,.0174561,.989875,587258e-9,0,.0232596,.988109,676329e-9,0,.0298932,.985155,747701e-9,0,.0373453,.980479,768803e-9,0,.0456045,.976271,841054e-9,0,.0546593,.971347,911469e-9,0,.0644994,.964528,953057e-9,0,.0751152,.957632,.00102221,0,.0864981,.948681,.00106122,0,.0986407,.938716,.00111857,0,.111537,.926629,.00114762,0,.125182,.914025,.00118995,0,.139571,.901026,.00121228,0,.154703,.890358,.00123946,0,.170576,.878283,.0012527,0,.18719,.865459,.00125536,0,.204547,.851407,.00126134,0,.222648,.836276,.00124759,0,.241498,.820436,.00124443,0,.261101,.803253,.00122071,0,.281465,.785562,.00120107,0,.302595,.76718,.00117762,0,.324501,.748551,.00114289,0,.347192,.730564,.00110872,0,.370679,.712253,.00107636,0,.394973,.692867,.00103646,0,.420085,.673695,996793e-9,0,.446027,.653912,95675e-8,0,.47281,.634129,916739e-9,0,.500441,.615004,874401e-9,0,.528921,.595587,833411e-9,0,.558244,.575965,794556e-9,0,.588384,.5566,75196e-8,0,.619281,.537428,716381e-9,0,.650795,.518623,676558e-9,0,.68254,.499964,64074e-8,0,.714286,.481356,605984e-9,0,.746032,.463279,570256e-9,0,.777778,.445673,540138e-9,0,.809524,.428032,507299e-9,0,.84127,.411112,479553e-9,0,.873016,.394444,450737e-9,0,.904762,.378247,424269e-9,0,.936508,.362415,399111e-9,0,.968254,.347103,375274e-9,0,1,1,300729e-9,0,0,1,300733e-9,0,0,1,300797e-9,0,0,.999998,301072e-9,0,0,.999996,301817e-9,0,0,.999989,303398e-9,0,0,.999977,306309e-9,0,0,.999958,311209e-9,0,0,.999927,318975e-9,0,0,.999884,330804e-9,0,0,.99982,34834e-8,0,0,.999733,373854e-9,0,326995e-10,.999613,410424e-9,0,477174e-9,.999447,462047e-9,0,.00161099,.999204,533322e-9,0,.00353153,.998725,624964e-9,0,.00627965,.995871,631786e-9,0,.0098693,.993194,632017e-9,0,.0143011,.991541,68923e-8,0,.019568,.989773,766892e-9,0,.0256593,.987647,863668e-9,0,.0325625,.984193,922089e-9,0,.0402647,.980016,970749e-9,0,.0487532,.975859,.00106027,0,.058016,.970514,.00112239,0,.0680419,.963625,.00117212,0,.0788208,.956959,.00125211,0,.0903439,.947956,.00129411,0,.102604,.93809,.00135879,0,.115594,.92659,.00139309,0,.129309,.913829,.00143253,0,.143745,.90005,.00145809,0,.158901,.888129,.0014748,0,.174774,.87607,.00148756,0,.191365,.863461,.00148714,0,.208674,.849594,.00148892,0,.226705,.834531,.00146496,0,.245461,.81903,.0014579,0,.264947,.802122,.00143039,0,.28517,.78445,.00139717,0,.306137,.766434,.00136312,0,.327857,.747816,.00132597,0,.350341,.729519,.00128323,0,.373598,.711454,.00123803,0,.397642,.692699,.00119097,0,.422485,.673723,.00114565,0,.448139,.654386,.00109552,0,.474619,.634673,.00104553,0,.501933,.615554,99985e-8,0,.530089,.596462,948207e-9,0,.559087,.577385,902299e-9,0,.588913,.558257,856448e-9,0,.619525,.5392,810395e-9,0,.650826,.520543,768558e-9,0,.68254,.502206,7239e-7,0,.714286,.48402,685794e-9,0,.746032,.465779,64471e-8,0,.777778,.448455,609583e-9,0,.809524,.431091,57227e-8,0,.84127,.414147,54042e-8,0,.873016,.39765,506545e-9,0,.904762,.381576,477635e-9,0,.936508,.365881,448446e-9,0,.968254,.350582,421424e-9,0,1,1,427144e-9,0,0,1,427151e-9,0,0,1,427232e-9,0,0,.999998,42759e-8,0,0,.999995,428555e-9,0,0,.999988,430603e-9,0,0,.999976,434368e-9,0,0,.999952,440688e-9,0,0,.999919,450667e-9,0,0,.999871,46578e-8,0,0,.999801,488024e-9,0,0,.999704,520092e-9,0,129791e-9,.999572,565553e-9,0,821056e-9,.999389,628906e-9,0,.00225241,.999114,714911e-9,0,.00449109,.998488,819218e-9,0,.00756249,.995234,80415e-8,0,.0114716,.993021,830181e-9,0,.0162131,.991407,902645e-9,0,.021776,.989625,996934e-9,0,.0281471,.987064,.00109707,0,.0353118,.983265,.00114353,0,.0432562,.979535,.0012272,0,.0519665,.975224,.00132642,0,.0614298,.969574,.00138092,0,.0716348,.963021,.00145896,0,.0825709,.956046,.00152834,0,.094229,.947136,.00158217,0,.106602,.937313,.0016347,0,.119682,.926073,.00168383,0,.133465,.913121,.00171627,0,.147947,.899165,.00174229,0,.163125,.885891,.00176137,0,.178998,.873783,.00176406,0,.195566,.861331,.00176156,0,.21283,.847569,.00175346,0,.230793,.832785,.00172753,0,.249459,.817442,.00170204,0,.268832,.800613,.00166576,0,.28892,.783597,.00162909,0,.30973,.76571,.0015826,0,.331271,.747021,.00153106,0,.353554,.728593,.00148036,0,.37659,.710661,.00142808,0,.400391,.692426,.00136906,0,.424973,.673623,.00131066,0,.450347,.65494,.00125569,0,.476531,.635448,.00119517,0,.503535,.616221,.00113828,0,.531372,.597531,.0010816,0,.560047,.578795,.00102673,0,.589554,.559892,970985e-9,0,.619869,.541307,919773e-9,0,.650923,.522608,868479e-9,0,.68254,.504484,82137e-8,0,.714286,.486603,772916e-9,0,.746032,.468802,730353e-9,0,.777778,.451172,684955e-9,0,.809524,.434348,647565e-9,0,.84127,.417445,605863e-9,0,.873016,.401077,571885e-9,0,.904762,.385039,536034e-9,0,.936508,.369483,504227e-9,0,.968254,.354272,473165e-9,0,1,1,599525e-9,0,0,1,599533e-9,0,0,1,599639e-9,0,0,.999998,600097e-9,0,0,.999994,601336e-9,0,0,.999987,603958e-9,0,0,.999972,608775e-9,0,0,.999949,616842e-9,0,0,.999912,629534e-9,0,0,.999857,648658e-9,0,0,.999781,676615e-9,0,538873e-11,.999674,716574e-9,0,308602e-9,.999528,772641e-9,0,.00127003,.999326,849806e-9,0,.00300783,.999009,952682e-9,0,.00556637,.998112,.00106394,0,.00895889,.994496,.00102228,0,.0131827,.992806,.00108586,0,.0182277,.991211,.0011759,0,.0240795,.989415,.00128955,0,.030723,.986499,.00139038,0,.0381418,.982679,.00144539,0,.046321,.978839,.00153954,0,.0552459,.974295,.00164417,0,.0649034,.968784,.00171517,0,.0752814,.962324,.00180282,0,.0863693,.954956,.00186387,0,.0981578,.94624,.00193817,0,.110639,.936517,.00198156,0,.123806,.925186,.00203042,0,.137655,.91252,.0020664,0,.15218,.898441,.00207822,0,.16738,.884394,.0020992,0,.183253,.871273,.00208748,0,.199799,.859057,.00208686,0,.21702,.845243,.00205519,0,.234918,.830723,.00202868,0,.253496,.815801,.00199501,0,.272761,.79914,.00194193,0,.292719,.782372,.00188824,0,.313377,.76482,.00183695,0,.334745,.746586,.00177418,0,.356833,.7281,.00170628,0,.379654,.709842,.00164063,0,.403221,.692019,.00157355,0,.427548,.67364,.00150262,0,.452651,.655277,.00143473,0,.478545,.636438,.00136371,0,.505246,.617364,.00129911,0,.532768,.598603,.00123014,0,.561122,.580195,.00116587,0,.590309,.561786,.00110398,0,.620318,.543377,.00104148,0,.651102,.525093,983984e-9,0,.682545,.506791,92667e-8,0,.714286,.489291,874326e-9,0,.746032,.471811,821734e-9,0,.777778,.454435,774698e-9,0,.809524,.437493,727302e-9,0,.84127,.420977,684039e-9,0,.873016,.404729,64373e-8,0,.904762,.388756,60285e-8,0,.936508,.373344,56765e-8,0,.968254,.358191,531929e-9,0,1,1,832169e-9,0,0,1,832178e-9,0,0,1,83231e-8,0,0,.999998,832893e-9,0,0,.999995,834465e-9,0,0,.999985,837791e-9,0,0,.999969,843893e-9,0,0,.999944,854086e-9,0,0,.999903,870071e-9,0,0,.999843,894042e-9,0,0,.999759,928865e-9,0,531805e-10,.999643,978242e-9,0,579365e-9,.99948,.00104684,0,.00182774,.999255,.00114012,0,.00387804,.998885,.00126188,0,.00675709,.997405,.00135888,0,.010468,.99424,.00133626,0,.0150018,.992458,.00140905,0,.0203443,.990929,.00152305,0,.0264786,.989116,.00165882,0,.0333875,.985624,.00174128,0,.0410536,.982003,.00182108,0,.0494609,.978336,.00194498,0,.0585941,.973184,.00202708,0,.0684396,.9678,.00212166,0,.0789851,.961348,.00221366,0,.0902199,.953841,.00228219,0,.102134,.94534,.00235662,0,.114721,.935552,.00240572,0,.127972,.924064,.00244405,0,.141884,.911827,.00247557,0,.156451,.897731,.00248374,0,.171672,.883409,.00249863,0,.187545,.868625,.00246688,0,.20407,.856529,.00246523,0,.221249,.842999,.00242368,0,.239083,.828505,.00237354,0,.257578,.813825,.00232588,0,.276738,.797813,.00226731,0,.296569,.781097,.00219704,0,.31708,.764038,.00212394,0,.338281,.746067,.00204786,0,.360181,.727687,.00196728,0,.382794,.709571,.00188779,0,.406133,.691503,.00180532,0,.430213,.673673,.00171849,0,.45505,.655732,.00164147,0,.480662,.637399,.00155858,0,.507065,.618616,.00147641,0,.534278,.60005,.00140125,0,.562313,.581713,.00132441,0,.59118,.563546,.00125014,0,.620875,.545605,.00118249,0,.651373,.527559,.0011116,0,.682593,.509764,.00104979,0,.714286,.49193,985977e-9,0,.746032,.475011,928592e-9,0,.777778,.457878,873466e-9,0,.809524,.440979,819585e-9,0,.84127,.424613,772365e-9,0,.873016,.408549,722195e-9,0,.904762,.392771,680014e-9,0,.936508,.377317,636797e-9,0,.968254,.362352,598318e-9,0,1,1,.00114313,0,0,1,.00114314,0,0,.999999,.00114331,0,0,.999998,.00114404,0,0,.999994,.00114601,0,0,.999984,.00115019,0,0,.999967,.00115784,0,0,.999937,.0011706,0,0,.999894,.00119054,0,0,.999828,.00122031,0,0,.999735,.00126331,0,169263e-9,.999606,.00132382,0,949167e-9,.999426,.0014071,0,.00249668,.999173,.00151895,0,.00486392,.99873,.00166102,0,.00806323,.996243,.0017023,0,.0120895,.993779,.00172782,0,.0169288,.9919,.0018108,0,.0225633,.990524,.00196028,0,.028974,.98868,.00212014,0,.036142,.984663,.00217598,0,.044049,.981457,.00230563,0,.0526781,.977608,.00243966,0,.0620137,.972215,.00251336,0,.0720418,.966798,.0026285,0,.0827499,.960241,.00271409,0,.0941271,.952489,.00278381,0,.106164,.944127,.00285399,0,.118852,.934282,.00290994,0,.132185,.923271,.00294558,0,.146157,.910803,.00296269,0,.160766,.896705,.00296803,0,.176007,.88238,.00296637,0,.19188,.867116,.00293163,0,.208385,.853636,.00289418,0,.225523,.840469,.00284663,0,.243296,.82639,.00278594,0,.261709,.811759,.00271618,0,.280767,.796113,.00263187,0,.300476,.779518,.00254589,0,.320845,.763142,.00246003,0,.341883,.745464,.00236529,0,.363601,.727491,.00226536,0,.386011,.709414,.00216375,0,.409128,.691396,.00207127,0,.432967,.67368,.00197106,0,.457545,.656049,.00187022,0,.482881,.638188,.00177605,0,.508992,.620177,.00168482,0,.535899,.601506,.00158909,0,.563619,.58362,.00150583,0,.592165,.565496,.00141791,0,.621544,.54789,.00133693,0,.651743,.530323,.00126038,0,.682709,.512795,.00118556,0,.714286,.495199,.00111527,0,.746032,.478101,.0010489,0,.777778,.461511,984264e-9,0,.809524,.444879,92591e-8,0,.84127,.428424,866582e-9,0,.873016,.412495,814463e-9,0,.904762,.396975,764498e-9,0,.936508,.381614,715967e-9,0,.968254,.366732,672483e-9,0,1,1,.00155501,0,0,1,.00155503,0,0,1,.00155524,0,0,.999998,.00155615,0,0,.999994,.0015586,0,0,.999983,.00156379,0,0,.999963,.0015733,0,0,.999932,.00158911,0,0,.999882,.00161376,0,0,.99981,.00165041,0,100875e-10,.999708,.00170304,0,367658e-9,.999565,.00177658,0,.0014234,.999368,.00187688,0,.00327939,.999081,.00200989,0,.00596629,.99852,.00217177,0,.0094852,.99549,.0021745,0,.013824,.993252,.00222357,0,.0189642,.991727,.00235022,0,.0248856,.989951,.00250561,0,.0315669,.988029,.00268829,0,.0389882,.984029,.0027496,0,.0471302,.980683,.00289793,0,.0559754,.976554,.00303315,0,.0655081,.97139,.00313257,0,.0757138,.965544,.00323656,0,.08658,.95912,.00333432,0,.0980954,.951183,.0034039,0,.110251,.942974,.00347515,0,.123038,.932642,.00350381,0,.13645,.922158,.00354519,0,.150482,.909404,.00353851,0,.165129,.896071,.0035435,0,.18039,.881206,.00349936,0,.196263,.866077,.00347256,0,.212748,.85093,.003415,0,.229847,.837703,.00333367,0,.247561,.823878,.003249,0,.265895,.809449,.00316347,0,.284854,.794379,.00306351,0,.304445,.778138,.0029499,0,.324675,.761997,.00284099,0,.345555,.744938,.00272104,0,.367095,.727212,.00260715,0,.389309,.709549,.00248855,0,.41221,.691704,.00236783,0,.435814,.673689,.00225178,0,.460138,.656453,.00213765,0,.485203,.639128,.00202178,0,.511028,.621512,.00191443,0,.537634,.603598,.00180977,0,.565041,.58559,.00170456,0,.593268,.567852,.00160927,0,.622327,.5503,.00151395,0,.652217,.533033,.00142499,0,.682907,.515942,.00133955,0,.714296,.498814,.0012602,0,.746032,.481595,.00118188,0,.777778,.465117,.00111171,0,.809524,.448865,.00104091,0,.84127,.432711,976618e-9,0,.873016,.416822,91859e-8,0,.904762,.401272,857704e-9,0,.936508,.386226,807172e-9,0,.968254,.371321,75464e-8,0,1,1,.00209596,0,0,1,.00209598,0,0,1,.00209624,0,0,.999997,.00209736,0,0,.999991,.00210039,0,0,.999979,.00210678,0,0,.999959,.00211847,0,0,.999925,.0021379,0,0,.99987,.00216809,0,0,.999791,.00221281,0,681487e-10,.999677,.00227669,0,658161e-9,.999521,.00236533,0,.00200635,.999301,.00248514,0,.0041779,.998977,.00264185,0,.00718648,.998191,.00281695,0,.0110239,.994801,.00278518,0,.015672,.993091,.00288774,0,.0211091,.991571,.00303931,0,.0273123,.9897,.00321643,0,.034259,.987023,.00337332,0,.0419282,.983289,.00346146,0,.0502998,.979892,.00363704,0,.0593562,.975111,.00373601,0,.069081,.970351,.0038842,0,.0794598,.964131,.00397053,0,.0904798,.957747,.00408078,0,.10213,.949536,.00413533,0,.1144,.941372,.00420305,0,.127284,.931049,.00422815,0,.140772,.920647,.00425048,0,.154862,.908033,.0042281,0,.169548,.895028,.00422026,0,.184828,.879968,.00415042,0,.200701,.864875,.00408821,0,.217167,.84918,.00400909,0,.234227,.834934,.00391178,0,.251884,.821397,.00380066,0,.270141,.807135,.00367974,0,.289004,.792363,.00355172,0,.308479,.776661,.003411,0,.328575,.760705,.00328123,0,.349301,.744408,.00314003,0,.370668,.726994,.0029906,0,.392689,.709598,.00285034,0,.415379,.692112,.00271179,0,.438754,.674435,.00257185,0,.46283,.65676,.00243425,0,.48763,.639982,.00230351,0,.513173,.622983,.0021777,0,.539482,.605471,.00204991,0,.566579,.58796,.00193759,0,.594488,.570463,.00181976,0,.623226,.553058,.00171497,0,.6528,.535894,.00161109,0,.683198,.519089,.00151394,0,.714354,.502454,.00142122,0,.746032,.485681,.00133488,0,.777778,.468935,.00124975,0,.809524,.452951,.00117309,0,.84127,.437139,.00110155,0,.873016,.421446,.00103124,0,.904762,.405951,966387e-9,0,.936508,.391003,908119e-9,0,.968254,.376198,848057e-9,0,1,1,.00280076,0,0,1,.00280078,0,0,.999999,.00280109,0,0,.999997,.00280246,0,0,.999992,.00280616,0,0,.999979,.00281396,0,0,.999956,.00282822,0,0,.999916,.00285186,0,0,.999857,.0028885,0,0,.999768,.00294259,0,196026e-9,.999645,.00301946,0,.00104842,.99947,.00312541,0,.00270199,.999229,.00326733,0,.00519449,.998852,.00344992,0,.00852602,.997558,.00361052,0,.0126804,.994417,.0035898,0,.017635,.992824,.00372393,0,.023365,.991344,.00390695,0,.0298456,.989337,.00410392,0,.0370529,.985811,.00420987,0,.0449651,.982772,.00437488,0,.0535615,.979001,.00455069,0,.0628243,.974102,.00464462,0,.0727368,.969197,.00480577,0,.0832844,.962759,.00487818,0,.0944545,.956207,.00498176,0,.106236,.947909,.00503392,0,.118619,.939596,.00507474,0,.131595,.929642,.00509798,0,.145159,.918807,.00508476,0,.159305,.906921,.00505634,0,.174028,.893312,.00498845,0,.189327,.878933,.0049133,0,.2052,.863986,.0048259,0,.221647,.847936,.00470848,0,.23867,.832253,.00456889,0,.25627,.818619,.00442726,0,.274453,.804788,.00427677,0,.293222,.790241,.00411906,0,.312585,.775162,.00394833,0,.33255,.759463,.00377366,0,.353126,.743598,.00361026,0,.374324,.72697,.00343627,0,.396158,.709646,.00326422,0,.418641,.69277,.00309717,0,.44179,.675371,.0029356,0,.465624,.657863,.00277712,0,.490163,.640772,.00261738,0,.515429,.624441,.0024737,0,.541445,.607497,.00233125,0,.568236,.590438,.00218994,0,.595828,.573224,.0020664,0,.624242,.556168,.00193526,0,.653496,.539232,.00182463,0,.683588,.522352,.00170735,0,.714482,.506172,.00160555,0,.746032,.489842,.00150451,0,.777778,.473463,.00140938,0,.809524,.457266,.00132568,0,.84127,.441609,.0012376,0,.873016,.426348,.00116265,0,.904762,.411002,.00108935,0,.936508,.396045,.00101946,0,.968254,.381448,955665e-9,0,1,1,.0037121,0,0,1,.00371213,0,0,1,.00371251,0,0,.999997,.00371417,0,0,.99999,.00371863,0,0,.999977,.00372807,0,0,.99995,.00374529,0,0,.999908,.0037738,0,0,.999843,.00381789,0,123596e-10,.999745,.00388273,0,407442e-9,.999608,.00397443,0,.0015447,.999415,.00409998,0,.00351385,.999143,.00426662,0,.0063316,.9987,.00447625,0,.00998679,.996363,.00455323,0,.0144569,.994021,.00461052,0,.0197151,.992372,.00476359,0,.0257344,.991007,.00499101,0,.0324882,.988767,.0051972,0,.0399517,.984872,.00528407,0,.0481022,.982004,.00548926,0,.0569191,.977714,.00564385,0,.0663839,.973076,.0057693,0,.0764801,.967565,.0058924,0,.0871928,.961384,.00599629,0,.0985095,.954435,.00605998,0,.110419,.946303,.0061133,0,.122912,.937662,.00612028,0,.13598,.927867,.00612209,0,.149617,.916475,.00604813,0,.163817,.90541,.00603088,0,.178577,.891591,.00592218,0,.193894,.877573,.00578854,0,.209767,.862511,.00566648,0,.226196,.846861,.00551481,0,.243182,.83068,.00533754,0,.260728,.815725,.00515487,0,.278837,.802321,.0049655,0,.297515,.787826,.00475421,0,.316768,.773454,.00456002,0,.336605,.758224,.00434727,0,.357034,.74265,.00414444,0,.378067,.726729,.00393738,0,.399717,.710155,.00373575,0,.421998,.693312,.00353736,0,.444928,.67653,.00334368,0,.468523,.659444,.00315981,0,.492806,.642051,.00297809,0,.517798,.625758,.00280592,0,.543525,.609615,.00264254,0,.570012,.592919,.00248459,0,.597288,.576298,.00233327,0,.625379,.559489,.00219519,0,.654307,.542891,.00205441,0,.684084,.526255,.00193385,0,.714693,.509853,.00180745,0,.746044,.494131,.00169817,0,.777778,.478114,.0015913,0,.809524,.462274,.00148981,0,.84127,.446412,.00139537,0,.873016,.431274,.00130984,0,.904762,.41635,.00122403,0,.936508,.401476,.00114809,0,.968254,.386993,.00107563,0,1,1,.00488216,0,0,1,.0048822,0,0,1,.00488265,0,0,.999997,.00488463,0,0,.999988,.00488999,0,0,.999974,.00490129,0,0,.999946,.00492191,0,0,.999897,.00495598,0,0,.999825,.00500855,0,744791e-10,.999718,.00508559,0,712744e-9,.999565,.005194,0,.00215249,.999352,.00534147,0,.00444576,.999046,.00553523,0,.00759218,.998492,.00577016,0,.0115714,.995564,.00578487,0,.0163557,.993339,.00586414,0,.021915,.991834,.00606002,0,.0282201,.990496,.00633312,0,.0352433,.987826,.00651941,0,.042959,.98383,.00660842,0,.0513439,.98109,.00685523,0,.0603772,.976131,.00695778,0,.0700402,.971922,.00714236,0,.0803163,.965901,.00721437,0,.0911908,.959606,.00732017,0,.102651,.952504,.00735788,0,.114686,.944365,.00738493,0,.127286,.935652,.00737969,0,.140443,.925813,.00733612,0,.154151,.914397,.00723094,0,.168405,.903257,.00714002,0,.183201,.890015,.00700149,0,.198536,.876014,.00682813,0,.214409,.861436,.00665567,0,.23082,.845752,.00644526,0,.24777,.829169,.00621635,0,.265263,.813435,.00597789,0,.283301,.799701,.00575694,0,.301889,.785726,.00549866,0,.321035,.77152,.0052503,0,.340746,.75683,.00499619,0,.361032,.741951,.0047543,0,.381904,.726367,.0045084,0,.403374,.710537,.00426784,0,.425457,.693965,.00403487,0,.448169,.677724,.0038075,0,.47153,.66117,.00359431,0,.495561,.644274,.00338354,0,.520284,.627449,.00318163,0,.545725,.611645,.00299672,0,.571911,.595614,.00281016,0,.598873,.579426,.00264252,0,.62664,.563016,.00247509,0,.655239,.546728,.00232647,0,.684692,.530539,.00217803,0,.714999,.514164,.00204216,0,.746106,.498344,.00191403,0,.777778,.482957,.00179203,0,.809524,.467336,.00167695,0,.84127,.451994,.00157567,0,.873016,.436514,.00147113,0,.904762,.42178,.00138034,0,.936508,.407271,.00129219,0,.968254,.392822,.0012098,0,1,1,.00637427,0,0,1,.00637431,0,0,.999999,.00637485,0,0,.999996,.00637721,0,0,.999987,.00638357,0,0,.999971,.006397,0,0,.999939,.00642142,0,0,.999888,.00646177,0,0,.999807,.00652387,0,207916e-9,.999689,.00661454,0,.00112051,.99952,.00674155,0,.00287719,.999283,.00691313,0,.00550145,.998936,.00713598,0,.00897928,.998165,.00738501,0,.0132829,.994847,.00734388,0,.01838,.993182,.00749991,0,.0242381,.991665,.0077246,0,.030826,.989708,.00797579,0,.0381152,.986663,.00813011,0,.0460794,.983288,.00830365,0,.0546951,.980104,.00853496,0,.0639411,.974855,.00861045,0,.0737988,.97045,.00879133,0,.0842516,.964509,.00886377,0,.0952848,.957594,.00890346,0,.106886,.950546,.00893289,0,.119044,.942225,.00890074,0,.131749,.933365,.00886826,0,.144994,.923202,.0087316,0,.158772,.912605,.00863082,0,.173078,.901099,.00847403,0,.187908,.888177,.00825838,0,.203261,.873955,.00801834,0,.219134,.860091,.00779026,0,.235527,.84434,.00752478,0,.252443,.828517,.00724074,0,.269883,.81239,.00693769,0,.287851,.79721,.00664817,0,.306352,.783489,.00634763,0,.325393,.769514,.00604221,0,.344981,.755419,.00573568,0,.365126,.741083,.00544359,0,.385839,.726059,.00515515,0,.407132,.710809,.00487139,0,.42902,.695052,.00459846,0,.45152,.678886,.00433412,0,.474651,.663042,.00407981,0,.498433,.646634,.00384264,0,.52289,.630117,.00360897,0,.548048,.613804,.00338863,0,.573936,.598338,.00318486,0,.600584,.582687,.00298377,0,.628027,.566809,.00280082,0,.656295,.550817,.00262255,0,.685417,.534937,.00245835,0,.715406,.519151,.00230574,0,.74624,.503118,.0021549,0,.777778,.487723,.00202008,0,.809524,.472725,.00189355,0,.84127,.457599,.00177108,0,.873016,.442558,.00165843,0,.904762,.427624,.00155494,0,.936508,.413171,.00145273,0,.968254,.399122,.00136454,0,1,1,.00826496,0,0,1,.00826499,0,0,1,.00826564,0,0,.999996,.00826842,0,0,.999987,.00827589,0,0,.999967,.00829167,0,0,.999933,.00832037,0,0,.999876,.00836768,0,109338e-10,.999786,.00844031,0,427145e-9,.999655,.00854603,0,.0016384,.999468,.00869337,0,.00372392,.999203,.008891,0,.00668513,.998803,.00914387,0,.0104968,.99748,.00935838,0,.015125,.994446,.00933309,0,.0205338,.99292,.00953084,0,.0266884,.991414,.0097893,0,.0335565,.989049,.0100228,0,.0411086,.98582,.0101664,0,.0493181,.982441,.0103582,0,.0581613,.978595,.0105292,0,.0676169,.973495,.0106274,0,.0776661,.968405,.0107261,0,.0882926,.962717,.0108234,0,.0994817,.955478,.0108102,0,.111221,.948275,.0107914,0,.123499,.940006,.0107161,0,.136308,.930831,.0106309,0,.149639,.920648,.0104083,0,.163485,.910205,.0102312,0,.177843,.898445,.0100051,0,.192707,.885986,.00971928,0,.208077,.872204,.00940747,0,.22395,.858436,.0091085,0,.240326,.843454,.00876595,0,.257208,.827437,.00839794,0,.274596,.811488,.00803692,0,.292496,.796039,.00767352,0,.310911,.781083,.0073097,0,.329849,.767642,.00694032,0,.349316,.753901,.00657476,0,.369323,.740131,.00622699,0,.38988,.725845,.0058838,0,.410999,.710991,.00555586,0,.432696,.696002,.00523089,0,.454987,.680461,.00492494,0,.47789,.664875,.00463464,0,.501426,.649273,.00435422,0,.52562,.63302,.0040875,0,.550498,.61705,.00384075,0,.576089,.601154,.00359557,0,.602427,.586008,.00337636,0,.629544,.570699,.00316019,0,.657479,.555166,.00296033,0,.686264,.539645,.00277552,0,.715924,.524159,.00259499,0,.746459,.508682,.00243257,0,.777789,.493163,.00227851,0,.809524,.478004,.00213083,0,.84127,.46347,.00199502,0,.873016,.448778,.00186967,0,.904762,.434105,.00174732,0,.936508,.419576,.00163861,0,.968254,.405541,.00153341,0,1,1,.0106462,0,0,1,.0106462,0,0,.999999,.010647,0,0,.999995,.0106502,0,0,.999985,.0106589,0,0,.999964,.0106773,0,0,.999925,.0107106,0,0,.999861,.0107655,0,712986e-10,.999763,.0108497,0,743959e-9,.999616,.0109716,0,.00227361,.999408,.0111408,0,.0046983,.999112,.0113659,0,.00800158,.998637,.0116475,0,.0121493,.996223,.0117231,0,.0171023,.994006,.0118064,0,.0228218,.992444,.0120254,0,.0292711,.991028,.0123314,0,.036417,.98803,.0124954,0,.0442295,.984816,.0126538,0,.0526815,.981399,.0128537,0,.0617492,.977085,.0129694,0,.0714114,.972154,.013091,0,.0816495,.966617,.0131166,0,.0924472,.960628,.0131583,0,.10379,.953295,.0131094,0,.115665,.94575,.0129966,0,.128062,.937654,.0128796,0,.140972,.927716,.0126477,0,.154387,.917932,.0123889,0,.168301,.907719,.012131,0,.182709,.89584,.0118013,0,.197608,.883526,.0114145,0,.212994,.870301,.0110075,0,.228867,.856272,.0106019,0,.245227,.842251,.0101938,0,.262074,.826466,.00973254,0,.279412,.810859,.0092846,0,.297244,.795051,.00883304,0,.315575,.780053,.00840272,0,.334412,.76575,.00796438,0,.35376,.752298,.00752526,0,.373631,.739153,.00711486,0,.394034,.725514,.00670361,0,.414983,.711473,.00632656,0,.436491,.696936,.00595206,0,.458575,.682126,.00559191,0,.481253,.667027,.00525362,0,.504547,.651875,.00493805,0,.528481,.636463,.00462848,0,.553081,.620641,.00433936,0,.578377,.604931,.00407,0,.604404,.589549,.00380864,0,.631197,.574712,.00357049,0,.658795,.559775,.00334466,0,.687238,.544514,.00312505,0,.716559,.529555,.00293199,0,.746776,.514402,.00274204,0,.777849,.499302,.00256647,0,.809524,.484114,.00239901,0,.84127,.469308,.00225148,0,.873016,.455133,.00210178,0,.904762,.440939,.0019727,0,.936508,.426627,.00184382,0,.968254,.412509,.00172548,0,1,1,.013628,0,0,1,.0136281,0,0,.999999,.0136289,0,0,.999995,.0136327,0,0,.999983,.0136427,0,0,.99996,.0136638,0,0,.999917,.0137022,0,0,.999846,.0137652,0,204597e-9,.999736,.0138615,0,.00116837,.999573,.0140007,0,.00303325,.99934,.0141927,0,.00580613,.999004,.0144457,0,.00945626,.998407,.0147489,0,.0139421,.995464,.014731,0,.0192202,.993328,.0148283,0,.0252495,.991799,.0150797,0,.0319921,.990397,.0154316,0,.0394138,.986835,.0155005,0,.0474843,.983938,.0157308,0,.0561763,.980154,.0158753,0,.0654661,.975659,.0159581,0,.0753326,.970171,.0159832,0,.0857571,.964803,.0160084,0,.0967236,.958366,.0159484,0,.108218,.950613,.0158001,0,.120227,.942874,.0155845,0,.132741,.935005,.0154292,0,.145751,.924991,.0150742,0,.159249,.914814,.0146757,0,.17323,.904743,.0143097,0,.187687,.893216,.0138695,0,.202619,.880769,.0133706,0,.218021,.868136,.0128606,0,.233894,.85469,.0123403,0,.250238,.840593,.0118091,0,.267052,.825808,.011253,0,.284341,.81009,.0107099,0,.302106,.79504,.0101636,0,.320354,.779757,.00964041,0,.33909,.764697,.00911896,0,.358322,.750913,.00859533,0,.378059,.738175,.00811592,0,.398311,.725242,.00764504,0,.41909,.711864,.00718885,0,.440412,.698009,.00675843,0,.462292,.683841,.00634984,0,.484748,.669391,.00595502,0,.507802,.654731,.00558671,0,.531477,.639805,.00523578,0,.555802,.624789,.00490834,0,.580805,.609325,.00459448,0,.606522,.593975,.00430342,0,.63299,.578983,.00403019,0,.66025,.564442,.0037707,0,.688346,.549835,.0035316,0,.717319,.535039,.00330255,0,.7472,.520403,.00308932,0,.777982,.505687,.00289335,0,.809524,.490939,.00270818,0,.84127,.476233,.0025343,0,.873016,.461624,.00237097,0,.904762,.447833,.00222065,0,.936508,.433992,.00207561,0,.968254,.420147,.00194955,0,1,1,.0173415,0,0,1,.0173416,0,0,.999999,.0173426,0,0,.999995,.0173468,0,0,.999983,.0173582,0,0,.999954,.0173822,0,0,.999908,.0174258,0,669501e-11,.999828,.0174973,0,427399e-9,.999705,.0176063,0,.00171019,.999524,.0177631,0,.0039248,.999263,.0179781,0,.00705382,.998878,.018258,0,.0110552,.998012,.0185551,0,.0158812,.994614,.0184264,0,.0214852,.993132,.0186385,0,.0278239,.991563,.0189067,0,.0348585,.989298,.0191577,0,.0425544,.986036,.0192522,0,.050881,.982558,.0194063,0,.059811,.978531,.019486,0,.0693209,.974198,.0195847,0,.0793895,.968148,.0194749,0,.0899984,.962565,.0194277,0,.101132,.956041,.0192991,0,.112775,.947749,.0189893,0,.124917,.94018,.018704,0,.137547,.93165,.0183458,0,.150655,.921798,.0178775,0,.164236,.911573,.0173618,0,.178281,.901569,.0168482,0,.192788,.890341,.016265,0,.207752,.877835,.0156199,0,.223171,.865472,.0149516,0,.239044,.852905,.0143274,0,.255371,.838906,.0136643,0,.272153,.824888,.0129903,0,.289393,.809977,.0123218,0,.307093,.794697,.0116572,0,.325259,.780028,.0110307,0,.343896,.765124,.0104236,0,.363012,.750411,.0098219,0,.382617,.737264,.00924397,0,.402719,.724799,.00868719,0,.423332,.712253,.00816476,0,.444469,.699267,.00767262,0,.466146,.685618,.00719746,0,.488383,.671736,.00673916,0,.511199,.657777,.00631937,0,.534618,.643497,.00592411,0,.558668,.62889,.00553928,0,.58338,.614299,.0051934,0,.608787,.599197,.00485985,0,.634929,.584175,.00454357,0,.661849,.569541,.00425787,0,.689594,.555193,.00397905,0,.718211,.540947,.00372364,0,.747742,.526593,.00348599,0,.778205,.512335,.00326103,0,.80953,.498017,.00305137,0,.84127,.483609,.00285485,0,.873016,.469368,.00267472,0,.904762,.455037,.00249945,0,.936508,.441493,.00234792,0,.968254,.428147,.00219936,0,1,1,.0219422,0,0,1,.0219423,0,0,.999998,.0219434,0,0,.999993,.0219481,0,0,.999981,.021961,0,0,.999949,.0219879,0,0,.999896,.0220367,0,593194e-10,.999808,.0221167,0,75364e-8,.99967,.0222383,0,.00237884,.999466,.0224125,0,.00495612,.999174,.0226495,0,.00844887,.998725,.0229525,0,.0128058,.996979,.0231123,0,.0179742,.994317,.0230742,0,.0239047,.992781,.0232895,0,.0305526,.991191,.0235734,0,.0378786,.987787,.0236152,0,.0458475,.985092,.0237994,0,.0544287,.981121,.0238553,0,.0635952,.976924,.0238706,0,.0733233,.97218,.0238704,0,.0835922,.965956,.0236598,0,.0943839,.959998,.0234735,0,.105682,.953245,.0232277,0,.117474,.944445,.0226973,0,.129747,.937087,.0223527,0,.142491,.928341,.0218144,0,.155697,.9184,.0211516,0,.169358,.907959,.0204553,0,.183469,.89808,.0197673,0,.198024,.887047,.0189915,0,.21302,.875221,.0182082,0,.228455,.86269,.0173584,0,.244329,.850735,.0165718,0,.260639,.837545,.0157524,0,.277389,.823639,.0149482,0,.29458,.809699,.0141431,0,.312216,.794797,.0133527,0,.3303,.780578,.0126193,0,.34884,.766019,.0118914,0,.367842,.751447,.0111839,0,.387315,.737275,.010514,0,.40727,.724545,.00987277,0,.427717,.712644,.00926569,0,.448671,.700432,.00869029,0,.470149,.687664,.00814691,0,.492167,.674288,.00763012,0,.514746,.660966,.00714437,0,.537911,.647264,.00668457,0,.561688,.633431,.00626581,0,.586108,.619133,.00585593,0,.611206,.604935,.00548188,0,.637022,.590236,.00513288,0,.663599,.575473,.0047906,0,.690989,.561228,.00448895,0,.719242,.547054,.00420233,0,.748411,.533175,.00392869,0,.778531,.519163,.00367445,0,.809583,.505328,.00344097,0,.84127,.491446,.00322003,0,.873016,.477356,.00301283,0,.904762,.46356,.00282592,0,.936508,.449623,.00264956,0,.968254,.436068,.00246956,0,1,1,.0276135,0,0,1,.0276136,0,0,.999998,.0276148,0,0,.999993,.0276201,0,0,.999976,.0276342,0,0,.999945,.027664,0,0,.999884,.0277179,0,18679e-8,.999784,.027806,0,.00119607,.99963,.0279394,0,.00318407,.999401,.0281295,0,.00613601,.999066,.0283858,0,.00999963,.998524,.0287027,0,.0147164,.995702,.0286256,0,.0202295,.993593,.0286733,0,.0264876,.992067,.0288989,0,.0334452,.990548,.0292135,0,.0410621,.986775,.0291296,0,.0493032,.984054,.0293099,0,.0581381,.979481,.0291881,0,.0675397,.975297,.0291598,0,.0774848,.96981,.028954,0,.0879528,.963524,.028628,0,.0989258,.957398,.0283135,0,.110388,.950088,.0278469,0,.122327,.941538,.0271798,0,.134729,.933332,.0265388,0,.147587,.924392,.0257776,0,.160889,.914581,.024916,0,.174631,.904347,.0240242,0,.188806,.894324,.0231229,0,.203409,.883724,.022153,0,.218437,.872207,.0211355,0,.233888,.859927,.0201048,0,.249761,.848373,.0191263,0,.266056,.836023,.0181306,0,.282774,.82289,.0171718,0,.299917,.809324,.0162196,0,.317488,.795361,.0152622,0,.335493,.781253,.01439,0,.353936,.767338,.013533,0,.372825,.753156,.0127244,0,.392168,.739122,.0119454,0,.411976,.725358,.0112054,0,.432259,.712949,.010487,0,.453032,.701621,.00984032,0,.47431,.689703,.00921495,0,.496111,.677216,.00862492,0,.518456,.664217,.00806882,0,.541367,.65137,.00755922,0,.564872,.638,.00705705,0,.589001,.62453,.00661266,0,.613789,.610601,.00618432,0,.639277,.59676,.00578033,0,.66551,.582433,.00540927,0,.692539,.568026,.00506104,0,.720422,.55414,.0047353,0,.749216,.540178,.00442889,0,.778974,.526513,.00414363,0,.809711,.512954,.00388237,0,.84127,.499403,.00362875,0,.873016,.486026,.00340827,0,.904762,.472345,.00318598,0,.936508,.458828,.00297635,0,.968254,.445379,.00279447,0,1,1,.0345716,0,0,1,.0345717,0,0,.999999,.034573,0,0,.999991,.0345787,0,0,.999974,.0345941,0,0,.999937,.0346263,0,188589e-11,.999869,.0346847,0,409238e-9,.999757,.0347798,0,.0017674,.999582,.0349233,0,.00413658,.999322,.0351265,0,.00747408,.998939,.0353967,0,.0117157,.998219,.0357018,0,.0167966,.994974,.0354726,0,.0226572,.993201,.0355621,0,.0292445,.991573,.0357641,0,.0365123,.989301,.0359252,0,.0444203,.985712,.0358017,0,.0529334,.982411,.0358353,0,.0620214,.977827,.035617,0,.0716574,.973278,.0354398,0,.0818186,.967397,.0350483,0,.0924846,.960696,.0344795,0,.103638,.954349,.0339861,0,.115263,.946066,.0331323,0,.127348,.938012,.032359,0,.13988,.929413,.0314413,0,.152849,.920355,.0304103,0,.166248,.910586,.0292785,0,.18007,.900609,.0281391,0,.194308,.890093,.0269103,0,.208958,.880013,.0257269,0,.224018,.869001,.0244671,0,.239485,.85751,.0232252,0,.255359,.84582,.0220117,0,.271638,.834383,.0208274,0,.288324,.822158,.0196628,0,.305419,.809056,.0185306,0,.322927,.795832,.0174174,0,.340851,.782547,.0163758,0,.359199,.7689,.015391,0,.377975,.755526,.0144488,0,.397189,.741681,.0135372,0,.416851,.728178,.0126957,0,.436971,.714642,.0118812,0,.457564,.702756,.0111165,0,.478644,.69175,.0104145,0,.500229,.680159,.00974439,0,.522339,.668073,.00911926,0,.544997,.655405,.00851393,0,.56823,.642921,.00797637,0,.592068,.629993,.00745119,0,.616546,.616828,.00696972,0,.641705,.603305,.00652425,0,.66759,.589833,.00610188,0,.694255,.575945,.00570834,0,.72176,.561745,.00533384,0,.750168,.548277,.00500001,0,.779545,.534467,.00467582,0,.809933,.521032,.00438092,0,.841272,.507877,.00410348,0,.873016,.494654,.00383618,0,.904762,.481592,.00358699,0,.936508,.468509,.00337281,0,.968254,.455293,.00316196,0,1,1,.0430698,0,0,1,.0430699,0,0,.999998,.0430713,0,0,.999991,.0430773,0,0,.99997,.0430936,0,0,.999928,.0431277,0,406396e-10,.999852,.0431893,0,744376e-9,.999724,.0432895,0,.0024806,.999527,.0434397,0,.00524779,.99923,.0436507,0,.00898164,.998783,.0439255,0,.0136083,.997507,.0441104,0,.0190582,.994418,.0438225,0,.0252694,.992864,.0439396,0,.0321879,.991127,.0440962,0,.039767,.987331,.0438408,0,.0479667,.984819,.0438991,0,.056752,.980384,.0435906,0,.0660929,.975846,.0432543,0,.075963,.970748,.0428293,0,.0863398,.964303,.042153,0,.0972035,.95772,.0414111,0,.108537,.950747,.0405893,0,.120325,.942533,.0394887,0,.132554,.934045,.0383544,0,.145215,.924942,.037057,0,.158296,.915811,.0356993,0,.17179,.90612,.0342401,0,.185691,.896434,.0328078,0,.199993,.886021,.031288,0,.214691,.876081,.0297776,0,.229782,.865608,.0282334,0,.245265,.854924,.026749,0,.261138,.843607,.02526,0,.277401,.832456,.0238214,0,.294056,.821342,.0224682,0,.311104,.809303,.0211297,0,.328548,.796468,.0198387,0,.346394,.784046,.0186227,0,.364645,.771262,.0174561,0,.38331,.758118,.0163806,0,.402396,.745075,.0153287,0,.421912,.731926,.0143647,0,.44187,.71863,.0134363,0,.462283,.705414,.0125603,0,.483165,.693792,.0117508,0,.504535,.683108,.0110016,0,.52641,.67183,.0102757,0,.548816,.66015,.00962044,0,.571776,.647907,.00898031,0,.595323,.635734,.00840811,0,.619489,.623208,.00786211,0,.644317,.610438,.00734953,0,.669852,.597345,.00687688,0,.696148,.584138,.00643469,0,.723267,.5707,.00602236,0,.75128,.556966,.0056324,0,.780258,.543607,.00528277,0,.810268,.530213,.00493999,0,.841311,.516912,.00462265,0,.873016,.503916,.0043307,0,.904762,.491146,.00406858,0,.936508,.478439,.00381436,0,.968254,.465834,.00358003,0,1,1,.0534039,0,0,1,.053404,0,0,.999998,.0534055,0,0,.999989,.0534116,0,0,.999968,.0534283,0,0,.999918,.0534633,0,155895e-9,.99983,.0535262,0,.00120914,.999685,.0536281,0,.00334944,.999461,.0537799,0,.00653077,.999119,.0539902,0,.0106718,.998582,.0542524,0,.0156907,.995919,.0540318,0,.0215147,.993735,.0538914,0,.0280801,.992126,.0539557,0,.0353323,.990266,.0540401,0,.0432247,.986317,.0536064,0,.0517172,.983213,.0534425,0,.0607754,.978303,.0528622,0,.0703698,.973665,.0523363,0,.0804742,.968091,.0516165,0,.0910667,.961026,.0505434,0,.102128,.954333,.049523,0,.113641,.946372,.0481698,0,.125591,.938254,.0467674,0,.137965,.929516,.0452341,0,.150754,.920106,.0435083,0,.163947,.910899,.0417399,0,.177537,.901532,.0399389,0,.191516,.891919,.0380901,0,.205881,.882006,.0362341,0,.220626,.871965,.0343444,0,.235749,.862145,.0324832,0,.251248,.852058,.0306681,0,.267121,.84161,.0289097,0,.283368,.830806,.0272079,0,.299992,.820476,.0256089,0,.316992,.809514,.0240394,0,.334374,.797865,.0225379,0,.35214,.785621,.0211235,0,.370296,.773765,.0197908,0,.388849,.761629,.0185235,0,.407807,.748891,.0173358,0,.427178,.736437,.0162305,0,.446974,.723707,.0151778,0,.467207,.710606,.0141791,0,.487892,.698019,.0132592,0,.509046,.686203,.0123887,0,.530687,.675692,.0115976,0,.552839,.664826,.0108325,0,.575527,.65349,.0101348,0,.59878,.641774,.00947756,0,.622634,.629794,.00886058,0,.647128,.617647,.00828526,0,.672308,.60534,.00775312,0,.698231,.592718,.00726033,0,.724958,.579746,.00679731,0,.752563,.566763,.00636111,0,.781127,.553515,.00595228,0,.810733,.540118,.00556876,0,.841426,.527325,.00523051,0,.873016,.514265,.00490712,0,.904762,.501406,.00460297,0,.936508,.488922,.00431247,0,.968254,.476541,.0040472,0,1,1,.0659184,0,0,1,.0659185,0,0,.999998,.06592,0,0,.999988,.0659259,0,0,.999963,.0659423,0,0,.999907,.0659764,0,374198e-9,.999806,.0660376,0,.00182071,.999639,.0661361,0,.0043894,.999378,.0662814,0,.00800055,.998985,.0664779,0,.0125594,.998285,.0666914,0,.0179786,.995071,.0661989,0,.0241822,.993172,.0660454,0,.031106,.991438,.0660105,0,.0386952,.988428,.0656875,0,.0469032,.985218,.0652913,0,.0556905,.981128,.0647107,0,.065023,.976015,.0638491,0,.0748717,.97097,.062993,0,.0852112,.964582,.0617927,0,.0960199,.957383,.0603626,0,.107279,.949969,.0588128,0,.118971,.941843,.0570274,0,.131084,.933624,.0551885,0,.143604,.924543,.053122,0,.156521,.914919,.0508897,0,.169825,.905773,.0486418,0,.18351,.896434,.0463364,0,.197569,.887195,.0440623,0,.211997,.877706,.0417799,0,.226789,.867719,.03945,0,.241944,.858587,.037243,0,.257458,.849317,.0350956,0,.273331,.839585,.0329852,0,.289563,.829856,.0310028,0,.306154,.819589,.0290953,0,.323108,.809714,.0272738,0,.340426,.79934,.0255631,0,.358113,.788224,.0239175,0,.376175,.776619,.0223831,0,.394616,.76521,.0209298,0,.413445,.753716,.0195786,0,.432671,.741564,.0183001,0,.452305,.729413,.0171259,0,.472358,.717146,.0159933,0,.492845,.70436,.0149495,0,.513783,.69219,.0139681,0,.535189,.680289,.0130577,0,.557087,.669611,.0122198,0,.5795,.659113,.0114174,0,.602459,.648148,.0106729,0,.625997,.636905,.00998997,0,.650154,.625154,.00934313,0,.674976,.613481,.00874839,0,.700518,.60154,.00818265,0,.726845,.58943,.00766889,0,.754032,.576828,.00717153,0,.782167,.564194,.00672696,0,.811344,.551501,.00630863,0,.841644,.538635,.00592177,0,.873016,.525724,.00554888,0,.904762,.513209,.00520225,0,.936508,.500457,.00488231,0,.968254,.48799,.00457153,0,1,1,.0810131,0,0,1,.0810133,0,0,.999997,.0810145,0,0,.999985,.08102,0,0,.999956,.0810347,0,195026e-10,.999893,.0810656,0,719316e-9,.999777,.0811205,0,.00259774,.999583,.081208,0,.00561807,.999281,.0813343,0,.00967472,.998813,.0814969,0,.0146627,.997597,.0815217,0,.0204902,.994379,.0808502,0,.0270802,.992744,.0806792,0,.0343674,.990745,.0804589,0,.0422974,.986646,.0796107,0,.0508242,.983611,.0790913,0,.0599087,.978869,.0780746,0,.0695175,.973475,.0768218,0,.0796223,.967845,.0754926,0,.0901983,.960778,.0737063,0,.101224,.953333,.0718052,0,.112682,.945274,.0695946,0,.124555,.936955,.0672492,0,.136831,.928319,.0647732,0,.149496,.919075,.0620947,0,.162542,.909114,.0591816,0,.175958,.900137,.0563917,0,.189739,.891069,.0535392,0,.203877,.882262,.0507642,0,.218368,.873232,.0479793,0,.233208,.864042,.045226,0,.248393,.855002,.0425413,0,.263923,.846569,.0400126,0,.279796,.837714,.0375269,0,.296012,.828918,.0352027,0,.312573,.819783,.0330011,0,.329479,.810129,.0308908,0,.346734,.800866,.0289112,0,.364342,.79093,.0270255,0,.382307,.780593,.0252758,0,.400637,.769511,.0236178,0,.419337,.758558,.0220652,0,.438418,.747632,.0206289,0,.457889,.736146,.0192873,0,.477761,.724093,.0180333,0,.49805,.71234,.0168264,0,.51877,.700201,.015746,0,.53994,.687949,.0147027,0,.561581,.676163,.0137512,0,.583718,.665001,.0128655,0,.60638,.65472,.0120366,0,.629599,.644213,.0112604,0,.653415,.633382,.0105413,0,.677874,.62212,.00986498,0,.70303,.610631,.00923308,0,.728948,.599078,.00864206,0,.755706,.587519,.00811784,0,.783396,.575505,.00761237,0,.812121,.563148,.00713949,0,.841989,.550828,.00668379,0,.873035,.538458,.00627715,0,.904762,.525905,.00588336,0,.936508,.513517,.00552687,0,.968254,.501395,.00519681,0,1,1,.0991506,0,0,1,.0991504,0,0,.999996,.0991515,0,0,.999984,.0991558,0,0,.999947,.0991672,0,114389e-9,.999874,.0991912,0,.00121503,.999739,.0992331,0,.00356108,.999514,.0992983,0,.00705578,.999159,.0993877,0,.011574,.998586,.0994837,0,.017003,.995731,.0988425,0,.0232484,.993384,.098276,0,.0302318,.991615,.0979269,0,.0378884,.989029,.0973432,0,.0461641,.985373,.0963539,0,.0550136,.981278,.0952306,0,.0643988,.975777,.0936233,0,.0742868,.970526,.0920219,0,.0846501,.963755,.0898912,0,.0954644,.956676,.0876064,0,.106709,.948099,.0847751,0,.118367,.939718,.0818638,0,.130423,.931305,.078857,0,.142862,.922342,.0756127,0,.155674,.912842,.0721473,0,.168849,.903304,.0686195,0,.182378,.89411,.0650589,0,.196255,.885512,.0616022,0,.210473,.877193,.0582434,0,.225027,.86877,.0548979,0,.239915,.860267,.0516095,0,.255132,.851915,.048468,0,.270678,.843912,.0454447,0,.286551,.83604,.0425612,0,.302751,.828245,.0398752,0,.31928,.820159,.0373198,0,.336138,.81167,.034916,0,.35333,.802659,.0326402,0,.370858,.793921,.0304901,0,.388728,.784713,.0284857,0,.406944,.774946,.0266186,0,.425515,.76448,.0248593,0,.444449,.753793,.0232114,0,.463756,.743506,.0217039,0,.483447,.732555,.0202841,0,.503535,.720965,.0189648,0,.524036,.709422,.0177189,0,.544968,.697756,.0165626,0,.56635,.685565,.015483,0,.588208,.673987,.0144892,0,.610569,.66244,.0135607,0,.633466,.651675,.0126956,0,.656936,.641598,.0118788,0,.681025,.63121,.0111261,0,.705788,.620514,.010437,0,.731289,.609366,.00978747,0,.757606,.598137,.00917257,0,.784834,.586966,.00859778,0,.813085,.575549,.00806803,0,.842485,.563797,.00757294,0,.87313,.551758,.00710592,0,.904762,.539894,.0066841,0,.936508,.527901,.00627901,0,.968254,.515819,.00590506,0,1,1,.120864,0,0,1,.120864,0,0,.999996,.120864,0,0,.99998,.120867,0,0,.99994,.120872,0,323781e-9,.999852,.120884,0,.00188693,.999693,.120903,0,.00473489,.999426,.120929,0,.00872704,.999002,.120955,0,.0137237,.998235,.120918,0,.0196068,.994608,.119764,0,.0262803,.992997,.119265,0,.0336657,.990968,.11863,0,.0416987,.987002,.117261,0,.0503261,.983524,.116009,0,.0595035,.97875,.114252,0,.0691935,.972652,.11193,0,.0793645,.966613,.109555,0,.0899894,.959275,.106612,0,.101045,.951272,.103375,0,.112512,.942323,.0996594,0,.124372,.933679,.0958841,0,.136611,.924822,.0919265,0,.149216,.915742,.0878061,0,.162176,.906348,.0834894,0,.175482,.896883,.079085,0,.189125,.88774,.0746745,0,.203098,.87986,.0705773,0,.217396,.871998,.0665005,0,.232015,.864325,.0625413,0,.24695,.856685,.0586781,0,.2622,.84925,.0550063,0,.277761,.841719,.0514727,0,.293634,.834755,.0481398,0,.309819,.827853,.0450172,0,.326315,.820888,.0420969,0,.343126,.813616,.0393702,0,.360254,.805767,.0367771,0,.377701,.797338,.0343274,0,.395474,.789122,.0320529,0,.413577,.780601,.0299485,0,.432018,.771424,.0279812,0,.450804,.761502,.0261054,0,.469944,.751166,.0243942,0,.489451,.741276,.0228087,0,.509337,.730898,.0213265,0,.529617,.719878,.0199307,0,.550307,.708379,.0186574,0,.571428,.697165,.0174446,0,.593003,.685554,.0163144,0,.615059,.673631,.015276,0,.637628,.662385,.0143003,0,.660746,.651059,.0134112,0,.68446,.640451,.0125794,0,.70882,.630536,.011793,0,.733893,.620316,.0110547,0,.759756,.609722,.0103668,0,.786505,.598804,.00973009,0,.814259,.587871,.00912812,0,.843157,.577121,.00858916,0,.87334,.566019,.00807333,0,.904762,.554664,.00759687,0,.936508,.543101,.00714759,0,.968254,.531558,.00673418,0,1,1,.146767,0,0,1,.146767,0,0,.999997,.146767,0,0,.999977,.146765,0,320658e-11,.999929,.146762,0,682576e-9,.999823,.146753,0,.00276402,.999633,.146735,0,.00614771,.999314,.146699,0,.0106613,.998796,.14662,0,.0161546,.997124,.146107,0,.0225063,.994062,.144857,0,.0296198,.992154,.144011,0,.037417,.989186,.142712,0,.0458348,.985279,.140926,0,.0548211,.980826,.13885,0,.0643326,.975056,.136168,0,.074333,.969005,.133217,0,.0847917,.961554,.12959,0,.0956828,.954206,.125886,0,.106984,.945046,.121335,0,.118675,.935678,.116492,0,.130741,.926748,.111635,0,.143166,.917764,.106625,0,.155939,.908358,.101325,0,.169049,.899219,.0960249,0,.182487,.890089,.0906527,0,.196245,.881488,.0853905,0,.210317,.874031,.0804177,0,.224697,.866932,.0756005,0,.23938,.859976,.0709019,0,.254364,.853375,.0664391,0,.269646,.846971,.0622012,0,.285223,.840483,.058129,0,.301096,.833969,.0542762,0,.317265,.82806,.0507042,0,.333729,.822128,.047368,0,.350491,.815989,.044272,0,.367554,.809336,.0413444,0,.38492,.802177,.038601,0,.402594,.79441,.0360227,0,.420582,.786573,.0336383,0,.438891,.778619,.0314321,0,.457527,.77,.029362,0,.476499,.760698,.0274102,0,.49582,.750932,.0256146,0,.5155,.740993,.023974,0,.535555,.731159,.0224182,0,.556,.720836,.0209889,0,.576855,.709913,.0196411,0,.598143,.698415,.0183824,0,.619888,.68745,.0172222,0,.642123,.676154,.0161509,0,.664883,.664383,.0151397,0,.688211,.6533,.0141873,0,.71216,.642072,.0133105,0,.736792,.631412,.0124932,0,.762186,.621622,.0117408,0,.788439,.611681,.0110358,0,.815672,.60142,.0103775,0,.844034,.59083,.00975623,0,.873699,.580254,.00918084,0,.904765,.569841,.00864721,0,.936508,.559224,.00815731,0,.968254,.548315,.00767924,0,1,1,.177563,0,0,1,.177563,0,0,.999994,.177562,0,0,.999972,.177555,0,664171e-10,.999914,.177536,0,.0012276,.999787,.177496,0,.00388025,.999556,.17742,0,.00783463,.999165,.177285,0,.0128953,.9985,.177037,0,.0189053,.995388,.175634,0,.025742,.993102,.174375,0,.033309,.990992,.173121,0,.0415298,.986932,.170896,0,.0503425,.982786,.16847,0,.0596964,.977592,.165455,0,.0695498,.971075,.161676,0,.0798676,.963967,.157458,0,.0906201,.956397,.152836,0,.101783,.947489,.147467,0,.113333,.937564,.14145,0,.125254,.928182,.135383,0,.137529,.919027,.129212,0,.150144,.909618,.12276,0,.163088,.900492,.116273,0,.176351,.891671,.1098,0,.189924,.883146,.103362,0,.203799,.875151,.0970799,0,.21797,.868338,.0911732,0,.232433,.862033,.0854966,0,.247182,.856107,.0800691,0,.262216,.850644,.0749618,0,.27753,.845261,.070079,0,.293124,.839885,.0654321,0,.308997,.834609,.0610975,0,.325149,.829083,.0569741,0,.341581,.82404,.0531736,0,.358294,.818968,.049665,0,.37529,.813496,.0463856,0,.392573,.807533,.0433217,0,.410148,.80099,.0404402,0,.428019,.793891,.0377578,0,.446192,.786281,.0352616,0,.464676,.778773,.0329577,0,.483478,.770737,.030808,0,.502608,.762094,.0287964,0,.522079,.752898,.0269254,0,.541905,.743306,.0251926,0,.5621,.733416,.023595,0,.582684,.723742,.0221155,0,.603677,.713542,.0207435,0,.625106,.702755,.019434,0,.646998,.691484,.0182046,0,.66939,.680531,.0170771,0,.692324,.66953,.0160339,0,.715849,.658126,.0150677,0,.740028,.646933,.0141551,0,.764937,.636107,.0133179,0,.790673,.625271,.0125284,0,.817358,.615225,.0117937,0,.84515,.605678,.0111181,0,.874244,.59583,.0104759,0,.904828,.585704,.00986672,0,.936508,.575413,.00929712,0,.968254,.565373,.00876713,0,1,1,.214058,0,0,.999999,.214058,0,0,.999994,.214055,0,0,.999966,.214039,0,259642e-9,.999893,.213998,0,.00200075,.999737,.21391,0,.00527775,.999449,.213745,0,.00983959,.99896,.213458,0,.0154755,.9979,.212855,0,.0220249,.994278,.210779,0,.0293654,.992254,.20926,0,.0374021,.98881,.206908,0,.0460604,.984715,.204009,0,.0552802,.979738,.200471,0,.0650127,.972884,.195813,0,.0752175,.965996,.190856,0,.0858612,.957974,.185077,0,.0969155,.949155,.17868,0,.108356,.939288,.171513,0,.120163,.928996,.163838,0,.132319,.919563,.156246,0,.144808,.910004,.148359,0,.157618,.900791,.140417,0,.170737,.892135,.132569,0,.184155,.883803,.124741,0,.197866,.876034,.117091,0,.211861,.869219,.109835,0,.226134,.863062,.102859,0,.240682,.857795,.0962928,0,.255499,.853009,.0900725,0,.270583,.848603,.0842101,0,.285931,.844335,.0786527,0,.301542,.840208,.0734397,0,.317415,.836035,.0685334,0,.33355,.83172,.0639275,0,.349948,.827135,.0595909,0,.36661,.822797,.0556204,0,.383539,.818387,.0519394,0,.400738,.813565,.0485317,0,.41821,.808142,.0453138,0,.435961,.802212,.0423354,0,.453997,.79573,.0395553,0,.472324,.788741,.036988,0,.490951,.781093,.0345688,0,.509887,.773597,.0323297,0,.529144,.765622,.0302719,0,.548735,.757083,.0283477,0,.568674,.747992,.0265562,0,.588979,.738591,.0248844,0,.609671,.728719,.0233342,0,.630773,.719146,.0219081,0,.652314,.709165,.0205711,0,.674328,.69875,.0193248,0,.696854,.687884,.0181582,0,.719942,.676818,.0170746,0,.743651,.666247,.0160718,0,.768057,.655284,.0151262,0,.793253,.64401,.0142561,0,.819363,.633353,.0134327,0,.846547,.622674,.012653,0,.875017,.612265,.0119354,0,.905021,.602455,.0112533,0,.936508,.593147,.0106234,0,.968254,.583592,.0100213,0,1,1,.25717,0,0,1,.25717,0,0,.999992,.257164,0,0,.999958,.257135,0,641715e-9,.999864,.25706,0,.00305314,.999666,.256897,0,.00700975,.999302,.256596,0,.0122194,.998663,.25607,0,.0184622,.995607,.254123,0,.0255773,.993094,.252081,0,.0334439,.9907,.249867,0,.0419696,.98594,.246118,0,.0510823,.981214,.242049,0,.0607242,.974966,.236869,0,.0708486,.967589,.230724,0,.081417,.95915,.223635,0,.0923974,.950257,.21596,0,.103763,.940165,.207296,0,.115491,.929396,.197901,0,.127562,.919288,.188437,0,.13996,.909428,.178762,0,.15267,.900105,.169072,0,.165679,.891418,.159478,0,.178979,.883347,.15002,0,.192558,.875992,.140813,0,.20641,.869466,.13196,0,.220529,.863699,.123501,0,.234907,.858553,.115436,0,.249542,.854379,.107901,0,.264428,.850894,.10088,0,.279564,.847632,.0942296,0,.294947,.844571,.0879861,0,.310575,.84163,.0821534,0,.326448,.838542,.0766409,0,.342566,.835412,.0715322,0,.358929,.831899,.0666883,0,.37554,.828177,.0622175,0,.392399,.82416,.0580452,0,.409511,.820393,.054267,0,.426878,.816068,.0507172,0,.444506,.811201,.0474041,0,.4624,.805785,.0443174,0,.480566,.799878,.0414562,0,.499013,.793469,.0388147,0,.517749,.786473,.0363453,0,.536785,.778874,.0340225,0,.556134,.771277,.0318599,0,.575809,.763426,.0298859,0,.595827,.755044,.0280357,0,.616207,.746161,.0262979,0,.636973,.737124,.0247295,0,.65815,.72761,.0232514,0,.679772,.717822,.0218755,0,.701876,.708279,.0205942,0,.724509,.698333,.0193947,0,.74773,.68802,.0182717,0,.771609,.677321,.0172044,0,.79624,.666504,.0162122,0,.821743,.656184,.0152924,0,.84828,.64556,.0144326,0,.876069,.634636,.0136157,0,.905404,.624124,.0128612,0,.936508,.613914,.0121435,0,.968254,.603589,.0114887,0,1,1,.307946,0,0,.999999,.307945,0,0,.999988,.307934,0,204479e-10,.999944,.307886,0,.00127833,.999824,.307756,0,.00445047,.999565,.30748,0,.00914673,.999085,.306966,0,.0150498,.998103,.306004,0,.0219367,.994249,.303028,0,.0296485,.991807,.300435,0,.038068,.987773,.296554,0,.0471062,.982673,.2916,0,.0566942,.976623,.285641,0,.0667768,.968757,.27815,0,.0773099,.959849,.269529,0,.088257,.950663,.260248,0,.0995879,.940129,.249704,0,.111277,.92895,.238291,0,.123304,.917996,.226501,0,.13565,.907813,.214669,0,.148299,.898305,.202835,0,.161237,.889626,.191158,0,.174455,.88175,.179695,0,.187941,.874715,.168548,0,.201687,.868746,.15792,0,.215687,.863703,.147807,0,.229933,.859315,.138149,0,.24442,.855538,.128993,0,.259145,.852428,.120414,0,.274103,.850168,.112498,0,.289293,.848132,.105054,0,.304711,.846291,.0981087,0,.320357,.844431,.0915942,0,.33623,.842493,.0855056,0,.35233,.840368,.0798204,0,.368658,.83798,.0745097,0,.385214,.83523,.0695424,0,.402002,.832091,.0649092,0,.419023,.828667,.0606291,0,.436282,.824805,.0566523,0,.453782,.820988,.0530229,0,.471529,.816635,.0496364,0,.489528,.811725,.0464658,0,.507788,.806316,.0435082,0,.526317,.800469,.0407873,0,.545124,.794107,.038255,0,.564221,.787218,.0358825,0,.583621,.779872,.0336785,0,.603341,.772097,.0316379,0,.623397,.764484,.0297379,0,.643812,.756428,.0279581,0,.664611,.748022,.0263153,0,.685824,.739268,.0247799,0,.707488,.73024,.0233385,0,.729646,.720893,.0220035,0,.752354,.71119,.0207555,0,.77568,.701791,.0195843,0,.799715,.692184,.0184891,0,.824574,.682258,.0174541,0,.850417,.67206,.0164873,0,.877466,.661717,.0155959,0,.90604,.651462,.0147519,0,.936528,.641467,.0139727,0,.968254,.631229,.0132363,0,1,1,.367573,0,0,.999999,.367571,0,0,.999984,.367553,0,183382e-9,.999925,.367473,0,.00225254,.999759,.367259,0,.00628165,.99941,.366801,0,.0117858,.998739,.365946,0,.0184359,.995529,.363191,0,.0260114,.992875,.360171,0,.0343581,.989135,.355981,0,.0433637,.984166,.350401,0,.0529438,.977871,.343348,0,.0630334,.96951,.334341,0,.0735805,.959964,.323862,0,.0845437,.950162,.312521,0,.095889,.938882,.299577,0,.107588,.926992,.285573,0,.119617,.915589,.271212,0,.131957,.904791,.256611,0,.144591,.895177,.242224,0,.157503,.886403,.227952,0,.170682,.878957,.214192,0,.184117,.872418,.200795,0,.197799,.867029,.188015,0,.21172,.862835,.175975,0,.225873,.859411,.164526,0,.240253,.856655,.153693,0,.254854,.854519,.14352,0,.269673,.852828,.13397,0,.284707,.851412,.124984,0,.299953,.850609,.116748,0,.315408,.849855,.10905,0,.331073,.849017,.101839,0,.346946,.848079,.0951359,0,.363028,.846911,.0888774,0,.379318,.845445,.0830375,0,.395818,.84362,.0775844,0,.41253,.841411,.0725054,0,.429457,.838768,.0677691,0,.446602,.835801,.0634016,0,.463968,.832341,.0593095,0,.481561,.828424,.0555121,0,.499386,.824312,.052024,0,.51745,.819918,.0487865,0,.535761,.815072,.0457801,0,.554328,.809863,.0430184,0,.573162,.804164,.0404245,0,.592275,.798034,.0380146,0,.611681,.791436,.0357436,0,.631398,.784498,.0336475,0,.651445,.777125,.0316666,0,.671845,.769365,.0298122,0,.692628,.761579,.0281001,0,.713827,.753746,.0265049,0,.735484,.745573,.0250067,0,.75765,.737083,.0236026,0,.78039,.728545,.0223302,0,.803789,.719691,.0211243,0,.82796,.710569,.0199983,0,.853056,.701216,.0189569,0,.879298,.692094,.0179702,0,.907014,.682909,.0170418,0,.936691,.673509,.0161732,0,.968254,.663863,.0153406,0,1,1,.437395,0,0,.999998,.437394,0,0,.99998,.437363,0,616704e-9,.999891,.437232,0,.00367925,.999656,.436877,0,.00867446,.999148,.436121,0,.0150679,.997959,.434564,0,.022531,.993464,.430134,0,.0308507,.990606,.426077,0,.0398805,.985027,.419397,0,.0495148,.978491,.41118,0,.0596749,.969643,.40048,0,.0703001,.959189,.38769,0,.0813427,.948223,.373575,0,.0927641,.935955,.357622,0,.104533,.923237,.34043,0,.116624,.911074,.322735,0,.129015,.899724,.30479,0,.141687,.890189,.287392,0,.154626,.881796,.270248,0,.167818,.874781,.253659,0,.181252,.869166,.237786,0,.194918,.864725,.222618,0,.208807,.861565,.208356,0,.222913,.859284,.194867,0,.237229,.857677,.18212,0,.25175,.856714,.17018,0,.266473,.856155,.158969,0,.281392,.8558,.148413,0,.296505,.855672,.138578,0,.311811,.855538,.129345,0,.327306,.855689,.120861,0,.342991,.855767,.112969,0,.358864,.855618,.105593,0,.374925,.85525,.0987451,0,.391176,.854583,.0923727,0,.407616,.853534,.0864143,0,.424249,.852061,.0808338,0,.441076,.850253,.0756771,0,.4581,.848004,.0708612,0,.475324,.845333,.0663784,0,.492754,.842376,.0622631,0,.510394,.838956,.0584112,0,.528251,.835121,.0548328,0,.546331,.830842,.0514838,0,.564644,.826212,.048355,0,.583198,.821522,.0454714,0,.602005,.816551,.0428263,0,.621078,.811211,.0403612,0,.640434,.805479,.038039,0,.660089,.799409,.0358739,0,.680066,.79306,.0338727,0,.70039,.786395,.0319985,0,.721094,.779416,.030241,0,.742215,.77214,.0285951,0,.7638,.764636,.0270747,0,.785912,.756836,.0256354,0,.808628,.749315,.0243027,0,.832055,.741561,.0230497,0,.856338,.733589,.0218801,0,.88169,.725479,.020784,0,.908441,.717255,.0197702,0,.937125,.708829,.0188168,0,.968254,.700191,.0179113,0,1,1,.518937,0,0,.999998,.518933,0,0,.999967,.518883,0,.00147741,.999832,.51866,0,.00573221,.999466,.518057,0,.011826,.998644,.516752,0,.0192116,.994458,.512347,0,.027573,.991223,.507675,0,.0367099,.985515,.500188,0,.046487,.978308,.490408,0,.0568071,.968359,.477357,0,.0675984,.95682,.461752,0,.0788059,.943929,.443796,0,.090386,.930224,.423893,0,.102304,.916514,.402682,0,.114532,.903653,.380914,0,.127047,.892315,.359212,0,.139828,.882942,.338102,0,.152861,.875438,.31773,0,.16613,.869642,.298186,0,.179624,.865304,.279491,0,.193332,.862382,.261804,0,.207247,.860666,.245146,0,.22136,.859788,.229406,0,.235666,.859608,.214605,0,.250158,.859912,.200691,0,.264832,.86053,.187623,0,.279684,.861368,.17539,0,.294711,.862237,.163901,0,.309911,.863127,.153175,0,.32528,.863923,.143147,0,.340819,.864567,.133781,0,.356524,.865013,.125042,0,.372397,.86539,.116952,0,.388438,.865591,.109476,0,.404645,.865517,.102542,0,.421022,.865084,.0960688,0,.437569,.864309,.0900499,0,.454287,.863151,.0844328,0,.471181,.861649,.0792218,0,.488253,.859742,.0743482,0,.505507,.857446,.0697963,0,.522947,.854757,.0655364,0,.54058,.851783,.061608,0,.558412,.848516,.0579701,0,.576449,.844897,.0545742,0,.594701,.840956,.0514167,0,.613178,.836676,.0484598,0,.631892,.832075,.0456934,0,.650856,.827191,.0431178,0,.670088,.822295,.0407718,0,.689606,.817294,.0386032,0,.709434,.812013,.0365675,0,.7296,.806465,.0346547,0,.750138,.800691,.0328717,0,.771093,.794709,.031211,0,.792519,.788493,.0296504,0,.814488,.782049,.0281782,0,.837097,.775403,.0267965,0,.860481,.76857,.0255002,0,.884842,.761536,.0242759,0,.910494,.754303,.0231142,0,.937985,.74692,.0220305,0,.968254,.739745,.0210192,0,1,1,.613914,0,0,.999996,.613907,0,963597e-10,.999942,.613814,0,.00301247,.999704,.613407,0,.00870385,.999046,.612302,0,.0160714,.995516,.608266,0,.0245899,.991726,.602863,0,.0339681,.985157,.593956,0,.0440254,.97642,.581748,0,.0546409,.964404,.565183,0,.0657284,.950601,.545273,0,.0772246,.935158,.522129,0,.0890812,.919364,.496782,0,.10126,.904754,.470571,0,.113731,.89176,.444037,0,.126469,.881492,.418322,0,.139454,.873656,.393522,0,.15267,.868053,.369795,0,.166101,.864336,.347171,0,.179736,.862259,.325737,0,.193565,.861556,.305532,0,.207578,.861776,.286416,0,.221769,.862661,.268355,0,.23613,.864015,.251334,0,.250656,.865711,.235352,0,.265343,.867519,.220302,0,.280187,.869351,.206161,0,.295183,.871144,.192908,0,.31033,.872839,.180505,0,.325624,.874307,.168848,0,.341065,.875667,.158021,0,.35665,.876758,.147877,0,.37238,.87764,.138441,0,.388253,.878237,.129627,0,.404269,.878563,.121415,0,.42043,.878572,.113741,0,.436735,.87842,.106652,0,.453187,.878057,.100097,0,.469786,.877413,.0940128,0,.486536,.87646,.0883462,0,.503439,.875233,.0830924,0,.520498,.8737,.0781975,0,.537717,.871873,.07364,0,.555102,.86978,.0694103,0,.572657,.867405,.0654696,0,.59039,.864751,.0617914,0,.608307,.861818,.0583491,0,.626419,.858645,.0551443,0,.644733,.855307,.0521894,0,.663264,.851736,.0494334,0,.682025,.847927,.0468504,0,.701032,.843888,.0444261,0,.720308,.839629,.0421497,0,.739875,.835158,.0400082,0,.759764,.830509,.0380076,0,.780014,.825714,.0361488,0,.800673,.820729,.0343956,0,.821803,.815751,.0327781,0,.843492,.810752,.031275,0,.86586,.805587,.0298542,0,.889087,.800317,.0285397,0,.913466,.79489,.0272948,0,.93952,.789314,.0261139,0,.96835,.783593,.0249938,0,1,1,.724258,0,0,.999992,.724243,0,726889e-9,.99987,.724044,0,.00569574,.999336,.72317,0,.0131702,.996271,.719432,0,.0220738,.991159,.712576,0,.0319405,.982465,.700927,0,.0425202,.97049,.684297,0,.0536599,.953973,.661244,0,.065258,.935546,.633804,0,.0772427,.916596,.603071,0,.0895616,.899353,.57105,0,.102175,.885216,.539206,0,.11505,.875076,.508714,0,.128164,.868334,.479571,0,.141495,.864414,.451796,0,.155026,.862678,.425328,0,.168745,.862835,.400352,0,.182639,.864067,.376532,0,.196699,.866086,.35391,0,.210915,.868557,.332424,0,.225282,.871271,.312053,0,.239792,.874058,.292764,0,.25444,.8768,.27453,0,.269223,.87939,.257297,0,.284135,.8819,.24114,0,.299174,.884187,.225934,0,.314337,.886262,.211669,0,.329622,.888119,.198311,0,.345026,.889709,.185783,0,.360549,.891054,.174063,0,.376189,.892196,.163143,0,.391946,.893101,.152952,0,.407819,.893803,.143475,0,.423808,.894277,.134647,0,.439914,.894532,.126434,0,.456137,.894576,.1188,0,.472479,.894393,.111694,0,.48894,.893976,.105069,0,.505523,.893346,.0989077,0,.52223,.892502,.0931724,0,.539064,.891441,.0878276,0,.556028,.890276,.082903,0,.573125,.888972,.0783505,0,.590361,.887469,.0741083,0,.607741,.885785,.0701633,0,.62527,.883914,.0664835,0,.642957,.881872,.0630567,0,.660809,.879651,.0598527,0,.678836,.877267,.0568615,0,.69705,.874717,.05406,0,.715465,.872012,.0514378,0,.734098,.869157,.0489805,0,.752968,.866155,.0466727,0,.772101,.863014,.0445056,0,.791529,.859748,.0424733,0,.81129,.856416,.0405957,0,.831438,.852958,.0388273,0,.852044,.849382,.0371619,0,.87321,.845694,.0355959,0,.89509,.841893,.0341155,0,.917932,.837981,.0327141,0,.942204,.833963,.0313856,0,.968981,.829847,.0301275,0,1,1,.85214,0,0,.999969,.852095,0,.00279627,.999483,.851408,0,.0107635,.994545,.84579,0,.0206454,.986188,.835231,0,.0315756,.969847,.814687,0,.0432021,.945951,.783735,0,.0553396,.91917,.746074,0,.0678766,.895488,.706938,0,.0807395,.878232,.669534,0,.0938767,.868252,.635168,0,.10725,.863873,.603069,0,.120832,.863369,.572514,0,.134598,.86545,.543169,0,.148533,.868803,.514578,0,.16262,.872794,.486762,0,.176849,.87702,.459811,0,.19121,.881054,.433654,0,.205694,.884974,.408574,0,.220294,.888587,.384525,0,.235005,.891877,.36156,0,.24982,.894793,.339661,0,.264737,.89743,.318913,0,.279751,.899796,.299302,0,.294859,.901943,.280843,0,.310058,.903858,.263481,0,.325346,.905574,.247197,0,.340721,.907069,.231915,0,.356181,.908379,.217614,0,.371725,.90952,.20425,0,.387353,.910483,.191758,0,.403063,.91128,.180092,0,.418854,.911936,.169222,0,.434727,.912454,.159098,0,.450682,.912835,.149668,0,.466718,.913078,.140884,0,.482837,.913192,.132709,0,.499038,.913175,.125095,0,.515324,.91304,.118012,0,.531695,.912781,.111417,0,.548153,.91241,.105281,0,.5647,.911924,.0995691,0,.581338,.911331,.0942531,0,.59807,.910637,.0893076,0,.6149,.90984,.0846998,0,.63183,.908941,.0804044,0,.648865,.907944,.0763984,0,.666011,.906857,.0726638,0,.683273,.90568,.0691783,0,.700659,.904416,.0659222,0,.718176,.903067,.0628782,0,.735834,.901637,.0600307,0,.753646,.900128,.0573647,0,.771625,.898544,.0548668,0,.78979,.89689,.052527,0,.808162,.895165,.0503306,0,.826771,.893371,.0482668,0,.845654,.891572,.0463605,0,.864863,.889763,.0445998,0,.884472,.887894,.0429451,0,.904592,.885967,.0413884,0,.925407,.883984,.0399225,0,.947271,.881945,.0385405,0,.97105,.879854,.0372362,0,1,.999804,.995833,0,0,.938155,.933611,0,.0158731,.864755,.854311,0,.0317461,.888594,.865264,0,.0476191,.905575,.863922,0,.0634921,.915125,.850558,0,.0793651,.920665,.829254,0,.0952381,.924073,.802578,0,.111111,.926304,.772211,0,.126984,.927829,.739366,0,.142857,.928924,.705033,0,.15873,.92973,.670019,0,.174603,.930339,.634993,0,.190476,.930811,.600485,0,.206349,.931191,.566897,0,.222222,.93149,.534485,0,.238095,.931737,.503429,0,.253968,.931939,.473811,0,.269841,.932108,.445668,0,.285714,.93225,.418993,0,.301587,.932371,.393762,0,.31746,.932474,.369939,0,.333333,.932562,.347479,0,.349206,.932638,.326336,0,.365079,.932703,.306462,0,.380952,.93276,.287805,0,.396825,.932809,.270313,0,.412698,.932851,.253933,0,.428571,.932887,.23861,0,.444444,.932917,.224289,0,.460317,.932943,.210917,0,.47619,.932965,.19844,0,.492063,.932982,.186807,0,.507937,.932995,.175966,0,.52381,.933005,.165869,0,.539683,.933011,.156468,0,.555556,.933013,.147719,0,.571429,.933013,.139579,0,.587302,.93301,.132007,0,.603175,.933004,.124965,0,.619048,.932994,.118416,0,.634921,.932982,.112326,0,.650794,.932968,.106663,0,.666667,.93295,.101397,0,.68254,.932931,.0964993,0,.698413,.932908,.0919438,0,.714286,.932883,.0877057,0,.730159,.932856,.0837623,0,.746032,.932827,.0800921,0,.761905,.932796,.0766754,0,.777778,.932762,.0734936,0,.793651,.932727,.0705296,0,.809524,.932689,.0677676,0,.825397,.93265,.0651929,0,.84127,.932609,.0627917,0,.857143,.932565,.0605515,0,.873016,.932521,.0584606,0,.888889,.932474,.0565082,0,.904762,.932427,.0546841,0,.920635,.932377,.0529793,0,.936508,.932326,.0513851,0,.952381,.932274,.0498936,0,.968254,.93222,.0484975,0,.984127,.932164,.0471899,0,1],r=new Float32Array(e),o=new Float32Array(t);Te.LTC_FLOAT_1=new Mr(r,64,64,st,Wt,Tn,kt,kt,at,nt,1),Te.LTC_FLOAT_2=new Mr(o,64,64,st,Wt,Tn,kt,kt,at,nt,1),Te.LTC_FLOAT_1.needsUpdate=!0,Te.LTC_FLOAT_2.needsUpdate=!0;let n=new Uint16Array(e.length);e.forEach(function(a,c){n[c]=i3.toHalfFloat(a)});let s=new Uint16Array(t.length);t.forEach(function(a,c){s[c]=i3.toHalfFloat(a)}),Te.LTC_HALF_1=new Mr(n,64,64,st,zr,Tn,kt,kt,at,nt,1),Te.LTC_HALF_2=new Mr(s,64,64,st,zr,Tn,kt,kt,at,nt,1),Te.LTC_HALF_1.needsUpdate=!0,Te.LTC_HALF_2.needsUpdate=!0}};var Af=class extends Qe{static type(){return"areaLight"}cook(e,t){let r=this.createLight();if(this.updateLightParams(r,t),t.showHelper){let o=new ut;return o.add(r),o.add(this._createHelper(r)),this.createCoreGroupFromObjects([o])}else return this.createCoreGroupFromObjects([r])}createLight(){let e=new Ip(16777215,1,1,1);return e.matrixAutoUpdate=!1,Tf.initialized||(Tf.init(),Tf.initialized=!0),e}updateLightParams(e,t){e.color=t.color,e.intensity=t.intensity,e.width=t.width,e.height=t.height}_createHelper(e){let t=new Qc(e);return t.update(),t}};Af.DEFAULT_PARAMS=cg;Af.INPUT_CLONED_STATE=Ge.NEVER;var rB=class extends tB(eo(V)){},dre=new rB,lg=class extends yf{constructor(){super(...arguments);this.paramsConfig=dre}static type(){return"areaLight"}_operation(){return this.__operation__=this.__operation__||new Af(this._scene,this.states)}createLight(){return this._operation().createLight()}updateLightParams(){this._operation().updateLightParams(this.light,this.pv),this.pv.showHelper?(this._helper=this._helper||new Qc(this.light),this.light.add(this._helper),this._helper.update()):this._helper&&this.light.remove(this._helper)}};var E0=(i=>(i.GEO="geo",i.CUBE_CAMERA="cubeCamera",i.AUDIO_LISTENER="audioListener",i.POSITIONAL_AUDIO="positionalAudio",i.SCENE="scene",i))(E0||{});var Cf=class{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=oB(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){let t=oB();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}};function oB(){return(typeof performance>"u"?Date:performance).now()}var m9=class extends je{constructor(){super(...arguments);this.name="Listener",this.positionX=new ft({context:this.context,param:this.context.rawContext.listener.positionX}),this.positionY=new ft({context:this.context,param:this.context.rawContext.listener.positionY}),this.positionZ=new ft({context:this.context,param:this.context.rawContext.listener.positionZ}),this.forwardX=new ft({context:this.context,param:this.context.rawContext.listener.forwardX}),this.forwardY=new ft({context:this.context,param:this.context.rawContext.listener.forwardY}),this.forwardZ=new ft({context:this.context,param:this.context.rawContext.listener.forwardZ}),this.upX=new ft({context:this.context,param:this.context.rawContext.listener.upX}),this.upY=new ft({context:this.context,param:this.context.rawContext.listener.upY}),this.upZ=new ft({context:this.context,param:this.context.rawContext.listener.upZ})}static getDefaults(){return Object.assign(je.getDefaults(),{positionX:0,positionY:0,positionZ:0,forwardX:0,forwardY:0,forwardZ:-1,upX:0,upY:1,upZ:0})}dispose(){return super.dispose(),this.positionX.dispose(),this.positionY.dispose(),this.positionZ.dispose(),this.forwardX.dispose(),this.forwardY.dispose(),this.forwardZ.dispose(),this.upX.dispose(),this.upY.dispose(),this.upZ.dispose(),this}};pp(i=>{i.listener=new m9({context:i})});hp(i=>{i.listener.dispose()});var el=new w,iB=new Nt,fre=new w,tl=new w,ug=class extends vt{constructor(){super();this.timeDelta=0,this._clock=new Cf,this.listenerTransformAutoUpdate=!0;let e=new m9;this.context=e.context.rawContext,this.gain=new Zt,this.gain.connect(this.context.destination)}async addInput(e){e.connect(this.gain)}dispose(){this.setMasterVolume(0),this.gain.disconnect()}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}masterVolume(){return this.gain.gain.value}updateMatrixWorld(e){if(super.updateMatrixWorld(e),!this.listenerTransformAutoUpdate)return;let t=this.context.listener,r=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(el,iB,fre),tl.set(0,0,-1).applyQuaternion(iB),t.positionX){let o=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(el.x,o),t.positionY.linearRampToValueAtTime(el.y,o),t.positionZ.linearRampToValueAtTime(el.z,o),t.forwardX.linearRampToValueAtTime(tl.x,o),t.forwardY.linearRampToValueAtTime(tl.y,o),t.forwardZ.linearRampToValueAtTime(tl.z,o),t.upX.linearRampToValueAtTime(r.x,o),t.upY.linearRampToValueAtTime(r.y,o),t.upZ.linearRampToValueAtTime(r.z,o)}else t.setPosition(el.x,el.y,el.z),t.setOrientation(tl.x,tl.y,tl.z,r.x,r.y,r.z)}};var _9=class{constructor(){this._started=!1}static instance(){return this._instance=this._instance||new _9}async start(){this._started||await rD()}},nB=_9.instance();var sB=class extends eo(V){constructor(){super(...arguments);this.audio=v.FOLDER(),this.soundOn=v.BOOLEAN(1,{cook:!1,callback:e=>{Sf.PARAM_CALLBACK_update(e)}}),this.masterVolume=v.FLOAT(1,{range:[0,1],rangeLocked:[!0,!1]}),this.listenerTransformAutoUpdate=v.BOOLEAN(1)}},mre=new sB,Ef=class extends Co{constructor(){super(...arguments);this.paramsConfig=mre,this.hierarchyController=new to(this),this.transformController=new Vo(this),this.flags=new ho(this),this._boundEvents={pointerdown:this._onpointerdown.bind(this),keypress:this._onkeypress.bind(this)}}static type(){return E0.AUDIO_LISTENER}createObject(){let i=new ug;return i.matrixAutoUpdate=!1,i}initializeNode(){this.hierarchyController.initializeNode(),this.transformController.initializeNode(),this.lifecycle.onAfterAdded(()=>{this._setPositionalAudioNodesDirty(),this.addAudioActivationEvents(),this.root().audioController.update()})}dispose(){super.dispose(),this.object.dispose(),this._setPositionalAudioNodesDirty(),this.root().audioController.update()}toggleSound(){this.p.soundOn.set(!this.pv.soundOn)}_setPositionalAudioNodesDirty(){this.root().nodesByType("positionalAudio").forEach(i=>i.setDirty())}cook(){this.transformController.update(),this._validateUniq(),this._updateListenerAndViewers(),this.cookController.endCook()}_validateUniq(){this.root().audioController.audioListeners().length>1&&this.states.error.set("only 1 audioListener can exist in a scene")}_updateAudioListener(){let i=this.pv.soundOn?this.pv.masterVolume:0;this.object.setMasterVolume(i),this.object.listenerTransformAutoUpdate=this.pv.listenerTransformAutoUpdate}_updateViewers(){this.root().audioController.update()}_updateListenerAndViewers(){this._updateAudioListener(),this._updateViewers()}static PARAM_CALLBACK_update(i){i._updateListenerAndViewers()}async _onpointerdown(i){await this.activateSound()}async _onkeypress(i){await this.activateSound()}static soundActivated(){return this._audioActivated}soundActivated(){return Ef.soundActivated()}async activateSound(){this.soundActivated()||(await nB.start(),Ef._audioActivated=!0),this._removeAudioActivationEvents()}addAudioActivationEvents(){this.soundActivated()||Ef._eventsAdded||(Ef._eventsAdded=!0,document.body.addEventListener("pointerdown",this._boundEvents.pointerdown),document.body.addEventListener("keypress",this._boundEvents.keypress))}_removeAudioActivationEvents(){document.body.removeEventListener("pointerdown",this._boundEvents.pointerdown),document.body.removeEventListener("keypress",this._boundEvents.keypress)}},Sf=Ef;Sf._eventsAdded=!1;Sf._audioActivated=!1;var _re={dependsOnDisplayNode:!0},wf=class{constructor(e,t,r=_re){this.node=e,this.options=r,this._initialized=!1,this._display_node=void 0,this._graph_node=new Yt(e.scene(),"DisplayNodeController"),this._graph_node.node=e,this._on_display_node_remove_callback=t.onDisplayNodeRemove,this._on_display_node_set_callback=t.onDisplayNodeSet,this._on_display_node_update_callback=t.onDisplayNodeUpdate}dispose(){this._graph_node.dispose()}displayNode(){return this._display_node}initializeNode(){if(this._initialized){console.error("display node controller already initialed",this.node);return}this._initialized=!0,this.node.lifecycle.onChildAdd(e=>{var t,r;this._display_node||(r=(t=e.flags)==null?void 0:t.display)==null||r.set(!0)}),this.node.lifecycle.onChildRemove(e=>{var t,r,o;if(e.graphNodeId()==((t=this._display_node)==null?void 0:t.graphNodeId())){let n=this.node.children(),s=n[n.length-1];s?(o=(r=s.flags)==null?void 0:r.display)==null||o.set(!0):this.setDisplayNode(void 0)}}),this._graph_node.dirtyController.addPostDirtyHook("_request_display_node_container",()=>{this._on_display_node_update_callback&&this._on_display_node_update_callback()})}async setDisplayNode(e){if(this._initialized||console.error("display node controller not initialized",this.node),this._display_node!=e){let t=this._display_node;t&&(t.flags.display.set(!1),this.options.dependsOnDisplayNode&&this._graph_node.removeGraphInput(t),this._on_display_node_remove_callback&&this._on_display_node_remove_callback()),this._display_node=e,this._display_node&&(this.options.dependsOnDisplayNode&&this._graph_node.addGraphInput(this._display_node),this._on_display_node_set_callback&&this._on_display_node_set_callback())}}};var aB="display",Mf=class{constructor(e){this.node=e,this._children_uuids_dict=new Map,this._children_length=0,this._sopGroup=this._createSopGroup()}_createSopGroup(){let e=new ut;return e.matrixAutoUpdate=!1,e}sopGroup(){return this._sopGroup}setSopGroupName(){this._sopGroup.name=`${this.node.name()}:sopGroup`}displayNodeControllerCallbacks(){return{onDisplayNodeRemove:()=>{this.remove_children()},onDisplayNodeSet:()=>{setTimeout(()=>{this.request_display_node_container()},0)},onDisplayNodeUpdate:()=>{this.request_display_node_container()}}}initializeNode(){var e;this.node.object.add(this.sopGroup()),this.node.nameController.add_post_set_fullPath_hook(this.setSopGroupName.bind(this)),this._createSopGroup();let t=(e=this.node.flags)==null?void 0:e.display;t&&t.onUpdate(()=>{this._updateSopGroupHierarchy(),t.active()&&this.request_display_node_container()})}_updateSopGroupHierarchy(){var e;if((e=this.node.flags)==null?void 0:e.display){let r=this.sopGroup();this.usedInScene()?(r.visible=!0,this.node.object.add(r),r.updateMatrix()):(r.visible=!1,this.node.object.remove(r))}}usedInScene(){var e,t;let r=this.node.params.has(aB),o=this.node.params.boolean(aB),n=this.node.usedInScene(),s=((t=(e=this.node.flags)==null?void 0:e.display)==null?void 0:t.active())||!1;return n&&s&&(!r||o)}async request_display_node_container(){!this.node.scene().loadingController.loaded()||this.usedInScene()&&await this._setContentUnderSopGroup()}remove_children(){if(this._sopGroup.children.length==0)return;let e;for(;e=this._sopGroup.children[0];)this._sopGroup.remove(e);this._children_uuids_dict.clear(),this._children_length=0}async _setContentUnderSopGroup(){var e;let t=this.node.displayNodeController.displayNode();if(t&&((e=t.parent())==null?void 0:e.graphNodeId())==this.node.graphNodeId()){let o=(await t.compute()).coreContent();if(o){let n=o.objects(),s=n.length!=this._children_length;if(!s)for(let a of n)this._children_uuids_dict.get(a.uuid)||(s=!0);if(s){this.remove_children();for(let a of n)this._sopGroup.add(a),a.updateMatrix(),this._children_uuids_dict.set(a.uuid,!0);this._children_length=n.length}return}}this.remove_children()}};var cB=class extends eo(V){constructor(){super(...arguments);this.display=v.BOOLEAN(1),this.renderOrder=v.INTEGER(0,{range:[0,10],rangeLocked:[!0,!1]})}},gre=new cB,pg=class extends Co{constructor(){super(...arguments);this.paramsConfig=gre,this.hierarchyController=new to(this),this.transformController=new Vo(this),this.flags=new ho(this),this.childrenDisplayController=new Mf(this),this.displayNodeController=new wf(this,this.childrenDisplayController.displayNodeControllerCallbacks()),this._childrenControllerContext=oe.SOP,this._onChildAddBound=this._onChildAdd.bind(this)}static type(){return E0.GEO}createObject(){let e=new ut;return e.matrixAutoUpdate=!1,e}initializeNode(){this.lifecycle.onChildAdd(this._onChildAddBound),this.hierarchyController.initializeNode(),this.transformController.initializeNode(),this.childrenDisplayController.initializeNode()}isDisplayNodeCooking(){if(this.flags.display.active()){let e=this.displayNodeController.displayNode();return e?e.isDirty():!1}else return!1}createNode(e,t){return super.createNode(e,t)}children(){return super.children()}nodesByType(e){return super.nodesByType(e)}_onChildAdd(e){var t,r;this.scene().loadingController.loaded()&&this.children().length==1&&((r=(t=e.flags)==null?void 0:t.display)==null||r.set(!0))}cook(){this.transformController.update(),this.object.visible=this.pv.display,this.object.renderOrder=this.pv.renderOrder,this.cookController.endCook()}};var Nf=(i=>(i.DIRECTIONAL="directionalLight",i.HEMISPHERE="hemisphereLight",i.POINT="pointLight",i.SPOT="spotLight",i))(Nf||{});var Of={skyColor:new he(1,1,1),groundColor:new he(0,0,0),intensity:1,position:new w(0,0,0)},g9=Of;function lB(i){return class extends i{constructor(){super(...arguments);this.skyColor=v.COLOR(g9.skyColor.toArray(),{conversion:Io.SRGB_TO_LINEAR}),this.groundColor=v.COLOR(g9.groundColor.toArray(),{conversion:Io.SRGB_TO_LINEAR}),this.intensity=v.FLOAT(g9.intensity,{range:[0,10],rangeLocked:[!0,!1]}),this.position=v.VECTOR3(g9.position.toArray())}}}var Dp=class extends Eo{constructor(e,t,r){super(e,r);this.type="HemisphereLight",this.position.copy(vt.DefaultUp),this.updateMatrix(),this.groundColor=new he(t)}copy(e){return Eo.prototype.copy.call(this,e),this.groundColor.copy(e.groundColor),this}};Dp.prototype.isHemisphereLight=!0;var Pf=class extends Qe{static type(){return"hemisphereLight"}cook(e,t){let r=this.createLight();return this.updateLightParams(r,t),this.updateLightParams(r,t),this.createCoreGroupFromObjects([r])}createLight(){let e=new Dp;return e.name="Hemisphere",e.matrixAutoUpdate=!1,e.updateMatrix(),e.color.copy(Of.skyColor),e.groundColor.copy(Of.groundColor),e}updateLightParams(e,t){e.color.copy(t.skyColor),e.groundColor.copy(t.groundColor),e.intensity=t.intensity}};Pf.DEFAULT_PARAMS=Of;Pf.INPUT_CLONED_STATE=Ge.NEVER;var uB=class extends lB(V){},vre=new uB,hg=class extends xf{constructor(){super(...arguments);this.paramsConfig=vre}static type(){return Nf.HEMISPHERE}_operation(){return this.__operation__=this.__operation__||new Pf(this._scene,this.states)}createLight(){return this._operation().createLight()}updateLightParams(){this._operation().updateLightParams(this.light,this.pv)}};var Rf=class extends Br{constructor(e=1){let t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],r=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],o=new De;o.setAttribute("position",new Ce(t,3)),o.setAttribute("color",new Ce(r,3));let n=new ur({vertexColors:!0,toneMapped:!1});super(o,n);this.type="AxesHelper"}setColors(e,t,r){let o=new he,n=this.geometry.attributes.color.array;return o.set(e),o.toArray(n,0),o.toArray(n,3),o.set(t),o.toArray(n,6),o.toArray(n,9),o.set(r),o.toArray(n,12),o.toArray(n,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}};var pB=class extends eo(V){},xre=new pB,dg=class extends Co{constructor(){super(...arguments);this.paramsConfig=xre,this.hierarchyController=new to(this),this.transformController=new Vo(this),this.flags=new ho(this),this._helper=new Rf(1)}static type(){return"null"}createObject(){let e=new ut;return e.matrixAutoUpdate=!1,e}initializeNode(){this.hierarchyController.initializeNode(),this.transformController.initializeNode(),this._updateHelperHierarchy(),this._helper.matrixAutoUpdate=!1,this.flags.display.onUpdate(()=>{this._updateHelperHierarchy()})}_updateHelperHierarchy(){this.flags.display.active()?(this.object.add(this._helper),this._helper.updateMatrix()):this.object.remove(this._helper)}cook(){this.transformController.update(),this.cookController.endCook()}};var fg=class{constructor(e,t,r){this._camera_node_id=e,this._controls_node=t,this._controls=r,this._updateRequired=this._controls_node.updateRequired()}updateRequired(){return this._updateRequired}get camera_node_id(){return this._camera_node_id}get controls(){return this._controls}get controls_node(){return this._controls_node}is_equal(e){return e.camera_node_id==this._camera_node_id&&e.controls_node.graphNodeId()==this._controls_node.graphNodeId()}};var hB="controls",mg=class{constructor(e){this.node=e,this._applied_controls_by_element_id=new Map,this._controls_node=null}controls_param(){return this.node.params.has(hB)?this.node.params.get(hB):null}async controls_node(){let e=this.node.p.controls,t=e.rawInput();if(t&&t!=""){e.isDirty()&&await e.compute();let r=e.value.node();if(r){if(Hw.includes(r.type()))return r;this.node.states.error.set("found node is not of a camera control type")}else this.node.states.error.set("no node has been found")}return null}async update_controls(){let e=await this.controls_node();e&&this._controls_node!=e&&this._dispose_control_refs(),this._controls_node=e}async apply_controls(e){let t=e.canvas();if(!t)return;let r=await this.controls_node();if(r){this._controlsEndEventName=r.endEventName();let o=r.controls_id(),n=!1,s=this._applied_controls_by_element_id.get(t.id);if(s&&s.get(o)&&(n=!0),!n){s=new Map,this._applied_controls_by_element_id.set(t.id,s),s.set(o,r);let a=await r.apply_controls(this.node.object,e);if(!a)return;let c=new fg(this.node.graphNodeId(),r,a);return this.set_controls_events(a),c}}}_dispose_control_refs(){this._applied_controls_by_element_id.forEach((e,t)=>{this._dispose_controls_for_element_id(t)}),this._applied_controls_by_element_id.clear(),this._controlsEndEventName=void 0}_dispose_controls_for_element_id(e){let t=this._applied_controls_by_element_id.get(e);t&&t.forEach((r,o)=>{r.disposeControlsForHtmlElementId(e)}),this._applied_controls_by_element_id.delete(e)}async dispose_controls(e){this._dispose_controls_for_element_id(e.id)}set_controls_events(e){let t=v9[this.node.pv.updateFromControlsMode];switch(t){case Lf.ON_END:return this._set_controls_events_to_update_on_end(e);case Lf.ALWAYS:return this._set_controls_events_to_update_always(e);case Lf.NEVER:return this._reset(e)}Be.unreachable(t)}_reset(e){this.controls_change_listener&&(e.removeEventListener("change",this.controls_change_listener),this.controls_change_listener=void 0),this.controls_end_listener&&this._controlsEndEventName&&(e.removeEventListener(this._controlsEndEventName,this.controls_end_listener),this.controls_end_listener=void 0)}_set_controls_events_to_update_on_end(e){this._reset(e),!!this._controlsEndEventName&&(this.controls_end_listener=()=>{this.node.update_transform_params_from_object()},e.addEventListener(this._controlsEndEventName,this.controls_end_listener))}_set_controls_events_to_update_always(e){this._reset(e),this.controls_change_listener=()=>{this.node.update_transform_params_from_object()},e.addEventListener("change",this.controls_change_listener)}};var yre="layer";function x9(i){return class extends i{constructor(){super(...arguments);this.layer=v.INTEGER(0,{range:[0,31],rangeLocked:[!0,!0]})}}}var _g=class{constructor(e){this.node=e}update(){let e=this.node.object;e.layers.set(0),e.layers.enable(this.node.params.integer(yre))}};var bre={callback:i=>{If.PARAM_CALLBACK_reset_effects_composer(i)}};function y9(i){return class extends i{constructor(){super(...arguments);this.doPostProcess=v.BOOLEAN(0),this.postProcessNode=v.NODE_PATH("",{visibleIf:{doPostProcess:1},nodeSelection:{types:[Ro.POST]},...bre})}}}var gg=class{constructor(e){this.node=e,this._composersByCanvasId=new Map,this.node.p.postProcessNode?this._add_param_dirty_hook():this.node.params.onParamsCreated("post process add param dirty hook",()=>{this._add_param_dirty_hook()})}_add_param_dirty_hook(){this.node.p.postProcessNode.addPostDirtyHook("on_post_node_dirty",()=>{this.reset()})}render(e,t){let r=this.composer(e);r&&(t&&r.setSize(t.x,t.y),r.render())}reset(){this._composersByCanvasId.clear()}composer(e){let t=this._composersByCanvasId.get(e.id);if(t)return t;{let r=this._createComposer(e);return r&&this._composersByCanvasId.set(e.id,r),r}}_createComposer(e){let t=this.node.renderController().renderer(e);if(t){let r=this.node.renderController().resolvedScene()||this.node.scene().threejsScene(),o=this.node.object,n=this.node.p.postProcessNode.value.node();if(n)if(n.type()==Ro.POST){let s=n,a=this.node.renderController().canvasResolution(e);return a?s.effectsComposerController.createEffectsComposer({renderer:t,scene:r,camera:o,resolution:a,requester:this.node,camera_node:this.node}):void 0}else this.node.states.error.set("found node is not a post process node");else this.node.states.error.set("no post node found")}}};var dB=class extends O1(Xh(M1(w1(S1(V))))){},Tre=new dB,b9=class extends Co{constructor(){super(...arguments);this.paramsConfig=Tre,this.hierarchyController=new to(this),this.SceneAutoUpdateController=new du(this),this.sceneBackgroundController=new mu(this),this.SceneEnvController=new _u(this),this.sceneFogController=new xu(this),this.sceneMaterialOverrideController=new yu(this)}static type(){return E0.SCENE}createObject(){let e=new Ji;return e.matrixAutoUpdate=!1,e}initializeNode(){this.hierarchyController.initializeNode()}cook(){this.SceneAutoUpdateController.update(),this.sceneBackgroundController.update(),this.SceneEnvController.update(),this.sceneFogController.update(),this.sceneMaterialOverrideController.update(),this.cookController.endCook()}};var vg=class extends dr{constructor(){super(...arguments);this.flags=new G0(this)}static context(){return oe.ROP}initializeBaseNode(){this.dirtyController.addPostDirtyHook("cook_immediately",()=>{this.cookController.cookMainWithoutInputs()})}cook(){this.cookController.endCook()}};var Pa=(i=>(i.CSS2D="CSS2DRenderer",i.CSS3D="CSS3DRenderer",i.WEBGL="WebGLRenderer",i))(Pa||{});var T9=(i=>(i[i.Linear=Hr]="Linear",i[i.sRGB=bt]="sRGB",i))(T9||{}),Are=["Linear","sRGB"],Cre=[T9.Linear,T9.sRGB],bg=T9.sRGB;var rl=(i=>(i[i.No=Oo]="No",i[i.Linear=hm]="Linear",i[i.Reinhard=dm]="Reinhard",i[i.Cineon=fm]="Cineon",i[i.ACESFilmic=mm]="ACESFilmic",i))(rl||{}),Ere=["No","Linear","Reinhard","Cineon","ACESFilmic"],Sre=[rl.No,rl.Linear,rl.Reinhard,rl.Cineon,rl.ACESFilmic],Tg=rl.ACESFilmic,wre=Ere.map((i,e)=>({name:i,value:Sre[e]}));var xg=["highp","mediump","lowp"];var yg=["high-performance","low-power","default"];var kp=(i=>(i[i.Basic=dx]="Basic",i[i.PCF=Pl]="PCF",i[i.PCFSoft=lm]="PCFSoft",i[i.VSM=Gs]="VSM",i))(kp||{}),Mre=["Basic","PCF","PCFSoft","VSM"],Nre=[kp.Basic,kp.PCF,kp.PCFSoft,kp.VSM];var Ag=kp.PCFSoft,fB={alpha:!1,precision:"highp",premultipliedAlpha:!0,antialias:!1,stencil:!0,preserveDrawingBuffer:!1,powerPreference:"default",depth:!0,logarithmicDepthBuffer:!1},mB=class extends V{constructor(){super(...arguments);this.tprecision=v.BOOLEAN(0),this.precision=v.INTEGER(xg.indexOf("highp"),{visibleIf:{tprecision:1},menu:{entries:xg.map((e,t)=>({value:t,name:e}))}}),this.tpowerPreference=v.BOOLEAN(0),this.powerPreference=v.INTEGER(yg.indexOf("default"),{visibleIf:{tpowerPreference:1},menu:{entries:yg.map((e,t)=>({value:t,name:e}))}}),this.alpha=v.BOOLEAN(1),this.premultipliedAlpha=v.BOOLEAN(1),this.antialias=v.BOOLEAN(1),this.stencil=v.BOOLEAN(1),this.depth=v.BOOLEAN(1),this.logarithmicDepthBuffer=v.BOOLEAN(0),this.toneMapping=v.INTEGER(Tg,{menu:{entries:wre}}),this.toneMappingExposure=v.FLOAT(1,{range:[0,2]}),this.outputEncoding=v.INTEGER(bg,{menu:{entries:Are.map((e,t)=>({name:e,value:Cre[t]}))}}),this.physicallyCorrectLights=v.BOOLEAN(1),this.sortObjects=v.BOOLEAN(1),this.tpixelRatio=v.BOOLEAN(0),this.pixelRatio=v.INTEGER(2,{visibleIf:{tpixelRatio:!0},range:[1,4],rangeLocked:[!0,!1]}),this.tshadowMap=v.BOOLEAN(1),this.shadowMapAutoUpdate=v.BOOLEAN(1,{visibleIf:{tshadowMap:1}}),this.shadowMapNeedsUpdate=v.BOOLEAN(0,{visibleIf:{tshadowMap:1}}),this.shadowMapType=v.INTEGER(Ag,{visibleIf:{tshadowMap:1},menu:{entries:Mre.map((e,t)=>({name:e,value:Nre[t]}))}})}},Ore=new mB,A9=class extends vg{constructor(){super(...arguments);this.paramsConfig=Ore,this._renderersbyCameraNode=new Map}static type(){return Pa.WEBGL}createRenderer(e,t,r){let o={},n=Object.keys(fB),s;for(s of n)o[s]=fB[s];if(this.pv.tprecision){let c=xg[this.pv.precision];o.precision=c}if(this.pv.tpowerPreference){let c=yg[this.pv.powerPreference];o.powerPreference=c}o.antialias=this.pv.antialias,o.antialias=this.pv.antialias,o.alpha=this.pv.alpha,o.premultipliedAlpha=this.pv.premultipliedAlpha,o.depth=this.pv.depth,o.stencil=this.pv.stencil,o.logarithmicDepthBuffer=this.pv.logarithmicDepthBuffer,o.canvas=t,o.context=r;let a=Q.renderersController.createWebGLRenderer(o);return Q.renderersController.printDebug()&&(Q.renderersController.printDebugMessage(`create renderer from node '${this.path()}'`),Q.renderersController.printDebugMessage({params:o})),this._update_renderer(a),this._renderersbyCameraNode.set(e,a),a}cook(){this._renderersbyCameraNode.forEach((e,t)=>{this._update_renderer(e)}),this._traverse_scene_and_update_materials(),this.cookController.endCook()}_update_renderer(e){e.physicallyCorrectLights=this.pv.physicallyCorrectLights,e.outputEncoding=this.pv.outputEncoding,e.toneMapping=this.pv.toneMapping,e.toneMappingExposure=this.pv.toneMappingExposure,e.shadowMap.enabled=this.pv.tshadowMap,e.shadowMap.autoUpdate=this.pv.shadowMapAutoUpdate,e.shadowMap.needsUpdate=this.pv.shadowMapNeedsUpdate,e.shadowMap.type=this.pv.shadowMapType,e.sortObjects=this.pv.sortObjects;let t=this.pv.tpixelRatio?this.pv.pixelRatio:ol.defaultPixelRatio();Q.renderersController.printDebug()&&(Q.renderersController.printDebugMessage(`set renderer pixelRatio from '${this.path()}'`),Q.renderersController.printDebugMessage({pixelRatio:t})),e.setPixelRatio(t)}_traverse_scene_and_update_materials(){this.scene().threejsScene().traverse(e=>{let t=e.material;if(t)if(K.isArray(t))for(let r of t)r.needsUpdate=!0;else t.needsUpdate=!0})}};function C9(i){return class extends i{constructor(){super(...arguments);this.render=v.FOLDER(),this.setScene=v.BOOLEAN(0),this.scene=v.NODE_PATH("",{visibleIf:{setScene:1},nodeSelection:{context:oe.OBJ,types:[b9.type()]}}),this.setRenderer=v.BOOLEAN(0),this.renderer=v.NODE_PATH("",{visibleIf:{setRenderer:1},nodeSelection:{context:oe.ROP,types:[A9.type()]}}),this.setCSSRenderer=v.BOOLEAN(0),this.CSSRenderer=v.NODE_PATH("",{visibleIf:{setCSSRenderer:1},nodeSelection:{context:oe.ROP,types:[Pa.CSS2D,Pa.CSS3D]}})}}}var ol=class{constructor(e){this.node=e,this._renderersByCanvasId=new Map,this._resolutionByCanvasId=new Map,this._super_sampling_size=new G}render(e,t,r,o){if(this.node.pv.doPostProcess?this.node.postProcessController().render(e,t):this.renderWithRenderer(e,o),this._resolvedCSSRendererROP&&this._resolvedScene&&this.node.pv.setCSSRenderer){let n=this.cssRenderer(e);n&&n.render(this._resolvedScene,this.node.object)}}renderWithRenderer(e,t){let r=this.renderer(e);if(r){let o=this._resolvedScene;o&&r.render(o,this.node.object)}}preCompile(e){let t=this.renderer(e);if(t){let r=this._resolvedScene;r&&t.compile(r,this.node.object)}}async update(){await this._updateScene(),await this._updateRenderer(),await this._updateCSSRenderer()}resolvedScene(){return this._resolvedScene}async _updateScene(){if(this.node.pv.setScene){let e=this.node.p.scene;e.isDirty()&&await e.compute();let t=e.value.nodeWithContext(oe.OBJ,this.node.states.error);if(t&&t.type()==b9.type()){let r=t;r.isDirty()&&r.cookController.cookMainWithoutInputs(),this._resolvedScene=r.object}}else this._resolvedScene=this.node.scene().threejsScene()}async _updateRenderer(){if(this.node.pv.setRenderer){let e=this.node.p.renderer;e.isDirty()&&await e.compute();let t=e.value.nodeWithContext(oe.ROP,this.node.states.error);if(t&&t.type()==A9.type()){this._resolvedRendererROP=t;return}}this._resolvedRendererROP=void 0}async _updateCSSRenderer(){if(this.node.pv.setCSSRenderer){let e=this.node.p.CSSRenderer;e.isDirty()&&await e.compute();let t=e.value.nodeWithContext(oe.ROP,this.node.states.error),r=[Pa.CSS2D,Pa.CSS3D];if(t&&r.includes(t.type())){this._resolvedCSSRendererROP=t;return}}this._resolvedCSSRendererROP,this._resolvedCSSRendererROP=void 0}renderer(e){return this._renderersByCanvasId.get(e.id)}renderersByCanvasId(){return this._renderersByCanvasId}cssRenderer(e){if(this._resolvedCSSRendererROP&&this.node.pv.setCSSRenderer)return this._resolvedCSSRendererROP.renderer(e)}async createRenderer(e,t){let r=Q.renderersController.getRenderingContext(e);if(!r){console.error("failed to create webgl context");return}let o;return this.node.pv.setRenderer&&(await this._updateRenderer(),this._resolvedRendererROP&&(o=this._resolvedRendererROP.createRenderer(this.node,e,r))),o||(o=ol._createDefaultRenderer(e,r)),Q.renderersController.registerRenderer(o),this._renderersByCanvasId.set(e.id,o),this._super_sampling_size.copy(t),this.setRendererSize(e,this._super_sampling_size),o}static defaultPixelRatio(){return Pi.isMobile()?1:Math.max(2,window.devicePixelRatio)}static _createDefaultRenderer(e,t){let r={canvas:e,antialias:!1,context:t},o=Q.renderersController.createWebGLRenderer(r),n=this.defaultPixelRatio();return o.setPixelRatio(n),o.shadowMap.enabled=!0,o.shadowMap.type=Ag,o.physicallyCorrectLights=!0,o.toneMapping=Tg,o.toneMappingExposure=1,o.outputEncoding=bg,Q.renderersController.printDebug()&&(Q.renderersController.printDebugMessage("create default renderer"),Q.renderersController.printDebugMessage({params:r,pixelRatio:n})),o}deleteRenderer(e){let t=this.renderer(e);t&&Q.renderersController.deregisterRenderer(t)}canvasResolution(e){return this._resolutionByCanvasId.get(e.id)}setRendererSize(e,t){let r=this._resolutionByCanvasId.get(e.id);r||(r=new G,this._resolutionByCanvasId.set(e.id,r)),r.copy(t);let o=this.renderer(e);if(o&&o.setSize(t.x,t.y,!1),this._resolvedCSSRendererROP){let n=this.cssRenderer(e);n&&n.setSize(t.x,t.y)}}};var Cg=class{constructor(e){this.viewer=e,this._active=!1,this._controls=null,this._bound_on_controls_start=this._on_controls_start.bind(this),this._bound_on_controls_end=this._on_controls_end.bind(this),this._update_graph_node()}controls(){return this._controls}async create_controls(){var e;this.dispose_controls(),!!this.viewer.canvas()&&(this._config=await((e=this.viewer.cameraControlsController())==null?void 0:e.apply_controls(this.viewer)),this._config&&(this._controls=this._config.controls,this._controls&&(this.viewer.active()?(this._controls.addEventListener("start",this._bound_on_controls_start),this._controls.addEventListener("end",this._bound_on_controls_end)):this.dispose_controls())))}update(e){this._config&&this._controls&&this._config.updateRequired()&&this._controls.update(e)}dispose(){var e;(e=this._graph_node)==null||e.graphDisconnectPredecessors(),this.dispose_controls()}dispose_controls(){var e;if(this._controls){let t=this.viewer.canvas();t&&((e=this.viewer)==null||e.cameraControlsController().dispose_controls(t)),this._bound_on_controls_start&&this._controls.removeEventListener("start",this._bound_on_controls_start),this._bound_on_controls_end&&this._controls.removeEventListener("end",this._bound_on_controls_end),this._controls.dispose(),this._controls=null}}_on_controls_start(){this._active=!0}_on_controls_end(){this._active=!1}_update_graph_node(){let e=this.viewer.cameraNode().p.controls;this._graph_node=this._graph_node||this._create_graph_node(),!!this._graph_node&&(this._graph_node.graphDisconnectPredecessors(),this._graph_node.addGraphInput(e))}_create_graph_node(){let e=new Yt(this.viewer.cameraNode().scene(),"viewer-controls");return e.addPostDirtyHook("this.viewer.controlsController",async()=>{await this.create_controls()}),e}};var Eg=class{constructor(e){this._viewer=e,this._size=new G(100,100),this._aspect=1}cameraNode(){return this._viewer.cameraNode()}get size(){return this._size}get aspect(){return this._aspect}computeSizeAndAspect(){this._updateSize(),this.cameraNode().scene().uniformsController.updateResolution(this._size),this._aspect=this._getAspect()}_updateSize(){var e,t;this._size.x=((e=this._viewer.domElement())==null?void 0:e.offsetWidth)||0,this._size.y=((t=this._viewer.domElement())==null?void 0:t.offsetHeight)||0}_getAspect(){return this._size.x/this._size.y}updateCameraAspect(){this.cameraNode().setupForAspectRatio(this._aspect)}async prepareCurrentCamera(){await this.cameraNode().compute(),await this._updateFromCameraContainer()}async _updateFromCameraContainer(){var e;this.updateCameraAspect(),await((e=this._viewer.controlsController())==null?void 0:e.create_controls())}};var Sg=class{constructor(e){this.viewer=e}init(){let e=this.viewer.canvas();e&&(e.onwebglcontextlost=this._on_webglcontextlost.bind(this),e.onwebglcontextrestored=this._on_webglcontextrestored.bind(this))}_on_webglcontextlost(){console.warn("context lost at frame",this.viewer.scene().frame()),this.request_animation_frame_id?cancelAnimationFrame(this.request_animation_frame_id):console.warn("request_animation_frame_id not initialized"),console.warn("not canceled",this.request_animation_frame_id)}_on_webglcontextrestored(){console.log("context restored")}};var _B={ON:`<svg xmlns="http://www.w3.org/2000/svg" class="soundOn h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
	<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z" />
  </svg>`,OFF:`<svg xmlns="http://www.w3.org/2000/svg" class="soundOff h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
	<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z" clip-rule="evenodd" />
	<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2" />
  </svg>`},wg=class{constructor(e){this._viewer=e}update(){let e=this._viewer.cameraNode().root();e.pv.displayAudioIcon?(this._showIcon(),this._updateColor(),this._updateIcon()):this._hideIcon()}unmount(){var e;this.__iconContainer&&((e=this.__iconContainer.parentElement)==null||e.removeChild(this.__iconContainer),this.__iconContainer=void 0),this._onIcon=void 0,this._offIcon=void 0}_updateColor(){if(this.__iconContainer){let e=this._viewer.cameraNode().root();this.__iconContainer.style.color=e.pv.audioIconColor.getStyle()}}_showIcon(){let e=this._iconContainer();e&&(e.style.display="block")}_hideIcon(){this.__iconContainer&&(this.__iconContainer.style.display="none")}_iconContainer(){let e=()=>{let t=this._createIconContainer(),r=this._viewer.domElement();if(!!r)return r.append(t),t};return this.__iconContainer=this.__iconContainer||e()}_createIconContainer(){let e=document.createElement("div");return e.style.position="absolute",e.style.top="10px",e.style.right="10px",e.style.width="24px",e.style.height="24px",e.style.cursor="pointer",e.addEventListener("pointerdown",()=>{this._toggleSound()}),e}offIcon(){function e(){let t=document.createElement("div");return t.innerHTML=_B.OFF,t.children[0]}return this._offIcon=this._offIcon||e()}onIcon(){function e(){let t=document.createElement("div");return t.innerHTML=_B.ON,t.children[0]}return this._onIcon=this._onIcon||e()}_toggleSound(){this._viewer.cameraNode().root().audioController.toggleSound(),this._updateIcon()}_updateIcon(){var e,t;let r=this._iconContainer();if(!r)return;let o=this.onIcon(),n=this.offIcon();this._viewer.cameraNode().root().audioController.soundOn()?(r.appendChild(o),(e=n.parentElement)==null||e.removeChild(n)):(r.appendChild(n),(t=o.parentElement)==null||t.removeChild(o))}};var gB="hovered",vB=class{constructor(i){this._cameraNode=i,this._active=!1,this._mounted=!1,this._onBeforeTickCallbacks=[],this._onAfterTickCallbacks=[],this._onBeforeRenderCallbacks=[],this._onAfterRenderCallbacks=[],this._id=vB._nextViewerId++,this._scene=this._cameraNode.scene()}mount(i){this._domElement=i,this._mounted=!0}unmount(){var i;!this._domElement||((i=this._audioController)==null||i.unmount(),this._domElement.removeChild(this.canvas()),this._mounted=!1)}_canvasIdPrefix(){return"TypedViewer"}_createCanvas(){let i=document.createElement("canvas");return i.id=`${this._canvasIdPrefix()}_${this._id}`,i.style.display="block",i.style.outline="none",i}canvas(){return this._canvas=this._canvas||this._createCanvas()}setRenderObjectOverride(i){i?this._renderObjectOverride=i:this._renderObjectOverride=void 0}active(){return this._active}activate(){this._active=!0}deactivate(){this._active=!1}camerasController(){return this._camerasController=this._camerasController||new Eg(this)}controlsController(){return this._controlsController}eventsController(){return this._eventsController=this._eventsController||new Y5(this)}webglController(){return this._webGLController=this._webGLController||new Sg(this)}audioController(){return this._audioController=this._audioController||new wg(this)}domElement(){return this._domElement}scene(){return this._scene}cameraNode(){return this._cameraNode}cameraControlsController(){}id(){return this._id}dispose(){if(this._scene.viewersRegister.unregisterViewer(this),this.eventsController().dispose(),!this._domElement)return;let i;for(;i=this._domElement.children[0];)this._domElement.removeChild(i)}resetContainerClass(){var i;(i=this.domElement())==null||i.classList.remove(gB)}setContainerClassHovered(){var i;(i=this.domElement())==null||i.classList.add(gB)}markAsReady(){}registerOnBeforeTick(i,e){this._registerCallback(i,e,this.registeredBeforeTickCallbacks())}unRegisterOnBeforeTick(i){this._unregisterCallback(i,this._onBeforeTickCallbacksMap)}registeredBeforeTickCallbacks(){return this._onBeforeTickCallbacksMap=this._onBeforeTickCallbacksMap||new Map}registerOnAfterTick(i,e){this._registerCallback(i,e,this.registeredAfterTickCallbacks())}unRegisterOnAfterTick(i){this._unregisterCallback(i,this._onAfterTickCallbacksMap)}registeredAfterTickCallbacks(){return this._onAfterTickCallbacksMap=this._onAfterTickCallbacksMap||new Map}registerOnBeforeRender(i,e){this._registerCallback(i,e,this.registeredBeforeRenderCallbacks())}unRegisterOnBeforeRender(i){this._unregisterCallback(i,this._onBeforeRenderCallbacksMap)}registeredBeforeRenderCallbacks(){return this._onBeforeRenderCallbacksMap=this._onBeforeRenderCallbacksMap||new Map}registerOnAfterRender(i,e){this._registerCallback(i,e,this.registeredAfterRenderCallbacks())}unRegisterOnAfterRender(i){this._unregisterCallback(i,this._onAfterRenderCallbacksMap)}registeredAfterRenderCallbacks(){return this._onAfterRenderCallbacksMap=this._onAfterRenderCallbacksMap||new Map}_registerCallback(i,e,t){if(t.has(i)){console.warn(`callback ${i} already registered`);return}t.set(i,e),this._updateCallbacks()}_unregisterCallback(i,e){!e||(e.delete(i),this._updateCallbacks())}_updateCallbacks(){var i,e,t,r;this._onBeforeTickCallbacks=[],(i=this._onBeforeTickCallbacksMap)==null||i.forEach(o=>{this._onBeforeTickCallbacks.push(o)}),this._onAfterTickCallbacks=[],(e=this._onAfterTickCallbacksMap)==null||e.forEach(o=>{this._onAfterTickCallbacks.push(o)}),this._onBeforeRenderCallbacks=[],(t=this._onBeforeRenderCallbacksMap)==null||t.forEach(o=>{this._onBeforeRenderCallbacks.push(o)}),this._onAfterRenderCallbacks=[],(r=this._onAfterRenderCallbacksMap)==null||r.forEach(o=>{this._onAfterRenderCallbacks.push(o)})}_runCallbacks(i,e){for(let t of i)t(e)}_runOnBeforeTickCallbacks(i){this._runCallbacks(this._onBeforeTickCallbacks,i)}_runOnAfterTickCallbacks(i){this._runCallbacks(this._onAfterTickCallbacks,i)}_runOnBeforeRenderCallbacks(i){this._runCallbacks(this._onBeforeRenderCallbacks,i)}_runOnAfterRenderCallbacks(i){this._runCallbacks(this._onAfterRenderCallbacks,i)}},Mg=vB;Mg._nextViewerId=0;var Pre="CoreThreejsViewer",E9=class extends Mg{constructor(e,t){super(e);this._cameraNode=e,this._properties=t,this._doRender=!0,this._clock=new Cf,this._delta=0,this._animateMethod=this.animate.bind(this),this._onResizeBound=this.onResize.bind(this),this._doRender=!0,this._properties!=null&&this._properties.autoRender!=null&&(this._doRender=this._properties.autoRender)}_canvasIdPrefix(){return"ThreejsViewer"}mount(e){var t,r;super.mount(e),(t=this._domElement)==null||t.appendChild(this.canvas()),(r=this._domElement)==null||r.classList.add(Pre),this._build(),this._setEvents()}controlsController(){return this._controlsController=this._controlsController||new Cg(this)}_build(){this._initDisplay(),this.activate()}dispose(){this.setAutoRender(!1),this.scene().viewersRegister.unregisterViewer(this),this._cancelAnimate(),this.controlsController().dispose(),this._disposeEvents(),super.dispose()}cameraControlsController(){return this._cameraNode.controlsController()}_setEvents(){this.eventsController().init(),this.webglController().init(),window.addEventListener("resize",this._onResizeBound.bind(this),!1)}_disposeEvents(){window.removeEventListener("resize",this._onResizeBound.bind(this),!1)}onResize(){let e=this._canvas;!e||(this.camerasController().computeSizeAndAspect(),this._cameraNode.renderController().setRendererSize(e,this.camerasController().size),this.camerasController().updateCameraAspect())}_initDisplay(){if(!this._canvas){console.warn("no canvas found for viewer");return}this.camerasController().computeSizeAndAspect();let e=this.camerasController().size,t=this._cameraNode.renderController();t.renderer(this._canvas)||t.createRenderer(this._canvas,e),this.audioController().update(),this.camerasController().prepareCurrentCamera(),this.animate()}setAutoRender(e=!0){this._doRender=e,this._doRender&&this.animate()}autoRenderState(){return this._doRender}animate(){var e;if(this._doRender){let t=this._clock.getDelta();this._delta=t,this._requestAnimationFrameId=requestAnimationFrame(this._animateMethod),this._runOnBeforeTickCallbacks(t),this._scene.timeController.incrementTimeIfPlaying(this._delta),this._runOnAfterTickCallbacks(t),this.render(this._delta),(e=this.controlsController())==null||e.update(this._delta)}}_cancelAnimate(){this._doRender=!1,this._requestAnimationFrameId&&cancelAnimationFrame(this._requestAnimationFrameId),this._canvas&&this._cameraNode.renderController().deleteRenderer(this._canvas)}render(e){if(this._canvas){let t=this._delta;this._runOnBeforeRenderCallbacks(t);let r=this.camerasController().size,o=this.camerasController().aspect;this._cameraNode.renderController().render(this._canvas,r,o,this._renderObjectOverride),this._runOnAfterRenderCallbacks(t)}else console.warn("no canvas to render onto")}renderer(){if(this._canvas)return this._cameraNode.renderController().renderer(this._canvas)}preCompile(){this._canvas&&this._cameraNode.renderController().preCompile(this._canvas)}markAsReady(){this.preCompile(),this.setAutoRender(!0)}};var S9=new w,wr=new us,Ng=class extends Br{constructor(e){let t=new De,r=new ur({color:16777215,vertexColors:!0,toneMapped:!1}),o=[],n=[],s={},a=new he(16755200),c=new he(16711680),l=new he(43775),u=new he(16777215),p=new he(3355443);h("n1","n2",a),h("n2","n4",a),h("n4","n3",a),h("n3","n1",a),h("f1","f2",a),h("f2","f4",a),h("f4","f3",a),h("f3","f1",a),h("n1","f1",a),h("n2","f2",a),h("n3","f3",a),h("n4","f4",a),h("p","n1",c),h("p","n2",c),h("p","n3",c),h("p","n4",c),h("u1","u2",l),h("u2","u3",l),h("u3","u1",l),h("c","t",u),h("p","c",p),h("cn1","cn2",p),h("cn3","cn4",p),h("cf1","cf2",p),h("cf3","cf4",p);function h(m,f,x){d(m,x),d(f,x)}function d(m,f){o.push(0,0,0),n.push(f.r,f.g,f.b),s[m]===void 0&&(s[m]=[]),s[m].push(o.length/3-1)}t.setAttribute("position",new Ce(o,3)),t.setAttribute("color",new Ce(n,3));super(t,r);this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrixAutoUpdate=!1,this.pointMap=s,this.update()}update(){let e=this.geometry,t=this.pointMap,r=1,o=1;wr.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),Dr("c",t,e,wr,0,0,-1),Dr("t",t,e,wr,0,0,1),Dr("n1",t,e,wr,-r,-o,-1),Dr("n2",t,e,wr,r,-o,-1),Dr("n3",t,e,wr,-r,o,-1),Dr("n4",t,e,wr,r,o,-1),Dr("f1",t,e,wr,-r,-o,1),Dr("f2",t,e,wr,r,-o,1),Dr("f3",t,e,wr,-r,o,1),Dr("f4",t,e,wr,r,o,1),Dr("u1",t,e,wr,r*.7,o*1.1,-1),Dr("u2",t,e,wr,-r*.7,o*1.1,-1),Dr("u3",t,e,wr,0,o*2,-1),Dr("cf1",t,e,wr,-r,0,1),Dr("cf2",t,e,wr,r,0,1),Dr("cf3",t,e,wr,0,-o,1),Dr("cf4",t,e,wr,0,o,1),Dr("cn1",t,e,wr,-r,0,-1),Dr("cn2",t,e,wr,r,0,-1),Dr("cn3",t,e,wr,0,-o,-1),Dr("cn4",t,e,wr,0,o,-1),e.getAttribute("position").needsUpdate=!0}};function Dr(i,e,t,r,o,n,s){S9.set(o,n,s).unproject(r);let a=e[i];if(a!==void 0){let c=t.getAttribute("position");for(let l=0,u=a.length;l<u;l++)c.setXYZ(a[l],S9.x,S9.y,S9.z)}}var xB={type:"change"},Df={near:.1,far:100},Lf=(i=>(i.ON_END="on move end",i.ALWAYS="always",i.NEVER="never",i))(Lf||{}),v9=["on move end","always","never"];function w9(i){return class extends i{constructor(){super(...arguments);this.setMainCamera=v.BUTTON(null,{callback:(t,r)=>{bB.PARAM_CALLBACK_setMasterCamera(t)}})}}}function Og(i){return class extends i{constructor(){super(...arguments);this.camera=v.FOLDER(),this.controls=v.NODE_PATH("",{nodeSelection:{context:oe.EVENT}}),this.updateFromControlsMode=v.INTEGER(v9.indexOf("on move end"),{menu:{entries:v9.map((t,r)=>({name:t,value:r}))}}),this.near=v.FLOAT(Df.near,{range:[.1,100],cook:!1,computeOnDirty:!0,callback:(t,r)=>{If.PARAM_CALLBACK_update_near_far_from_param(t,r)}}),this.far=v.FLOAT(Df.far,{range:[0,100],cook:!1,computeOnDirty:!0,callback:(t,r)=>{If.PARAM_CALLBACK_update_near_far_from_param(t,r)}}),this.display=v.BOOLEAN(1),this.showHelper=v.BOOLEAN(0)}}}var kf=(i=>(i.DEFAULT="default",i.COVER="cover",i.CONTAIN="contain",i))(kf||{}),Bp=["default","cover","contain"];function yB(i){return class extends i{constructor(){super(...arguments);this.fovAdjustMode=v.INTEGER(Bp.indexOf("default"),{menu:{entries:Bp.map((t,r)=>({name:t,value:r}))}}),this.expectedAspectRatio=v.FLOAT("16/9",{visibleIf:[{fovAdjustMode:Bp.indexOf("cover")},{fovAdjustMode:Bp.indexOf("contain")}],range:[0,2],rangeLocked:[!0,!1]})}}}var Rre=class extends w9(V){},Lre=class extends y9(C9(eo(x9(Og(w9(V)))))){},Pg=class extends Co{constructor(){super(...arguments);this.renderOrder=vf.CAMERA,this._aspect=-1}get object(){return this._object}async cook(){this.updateCamera(),this._object.dispatchEvent(xB),this.cookController.endCook()}on_create(){}on_delete(){}prepareRaycaster(e,t){}camera(){return this._object}updateCamera(){}static PARAM_CALLBACK_setMasterCamera(e){e.set_as_master_camera()}set_as_master_camera(){this.scene().camerasController.setMainCameraNodePath(this.path())}setupForAspectRatio(e){}_updateForAspectRatio(){}update_transform_params_from_object(){Xt.setParamsFromObject(this._object,this)}static PARAM_CALLBACK_update_from_param(e,t){e.object[t.name()]=e.pv[t.name()]}},M9=class extends Pg{constructor(){super(...arguments);this.flags=new ho(this),this.hierarchyController=new to(this),this.transformController=new Vo(this),this.childrenDisplayController=new Mf(this),this.displayNodeController=new wf(this,this.childrenDisplayController.displayNodeControllerCallbacks()),this._childrenControllerContext=oe.SOP}controlsController(){return this._controlsController=this._controlsController||new mg(this)}_layersController(){return this.__layersController__=this.__layersController__||new _g(this)}renderController(){return this._renderController=this._renderController||new ol(this)}postProcessController(){return this._postProcessController=this._postProcessController||new gg(this)}initializeBaseNode(){super.initializeBaseNode(),this.io.outputs.setHasOneOutput(),this.hierarchyController.initializeNode(),this.transformController.initializeNode(),this.childrenDisplayController.initializeNode(),this.initHelperHook()}createNode(e,t){return super.createNode(e,t)}children(){return super.children()}nodesByType(e){return super.nodesByType(e)}prepareRaycaster(e,t){t.setFromCamera(e,this._object)}async cook(){this.transformController.update(),this._layersController().update(),this.updateNearFar(),this.renderController().update(),this.updateCamera(),this._updateHelper(),this.controlsController().update_controls(),this._object.dispatchEvent(xB),this.cookController.endCook()}static PARAM_CALLBACK_update_near_far_from_param(e,t){e.updateNearFar()}updateNearFar(){(this._object.near!=this.pv.near||this._object.far!=this.pv.far)&&(this._object.near=this.pv.near,this._object.far=this.pv.far,this._object.updateProjectionMatrix(),this._updateHelper())}setupForAspectRatio(e){K.isNaN(e)||e&&this._aspect!=e&&(this._aspect=e,this._updateForAspectRatio())}createViewer(e){let t,r;return e&&e instanceof HTMLElement?(t=new E9(this),r=e):(t=new E9(this,(e==null?void 0:e.viewerProperties)||{}),r=e==null?void 0:e.element),r&&t.mount(r),this.scene().viewersRegister.registerViewer(t),t}static PARAM_CALLBACK_reset_effects_composer(e){e.postProcessController().reset()}initHelperHook(){this.flags.display.onUpdate(()=>{this._updateHelper()})}helperVisible(){return this.flags.display.active()&&this.pv.showHelper}_createHelper(){let e=new Ng(this.object);return e.update(),e}_updateHelper(){this.helperVisible()?(this._helper||(this._helper=this._createHelper()),this._helper&&(this.object.add(this._helper),this._helper.update())):this._helper&&this.object.remove(this._helper)}},bB=class extends Pg{},If=class extends M9{PARAM_CALLBACK_update_effects_composer(e){}};var TB={fov:50};function Ire(i){return class extends i{constructor(){super(...arguments);this.fov=v.FLOAT(TB.fov,{range:[0,100]})}}}var AB=class extends y9(C9(x9(w9(yB(Ire(Og(eo(V,{matrixAutoUpdate:!0})))))))){},Dre=new AB,Rg=class extends M9{constructor(){super(...arguments);this.paramsConfig=Dre}static type(){return P4.PERSPECTIVE}createObject(){return new ir(TB.fov,1,Df.near,Df.far)}updateCamera(){this._object.fov!=this.pv.fov&&(this._object.fov=this.pv.fov,this._object.updateProjectionMatrix()),this._updateForAspectRatio()}_updateForAspectRatio(){this._aspect&&(this._object.aspect=this._aspect,this._adjustFOVFromMode(),this._object.updateProjectionMatrix())}_adjustFOVFromMode(){let e=Bp[this.pv.fovAdjustMode];switch(e){case kf.DEFAULT:return this._adjustFOVFromModeDefault();case kf.COVER:return this._adjustFOVFromModeCover();case kf.CONTAIN:return this._adjustFOVFromModeContain()}Be.unreachable(e)}_adjustFOVFromModeDefault(){this._object.fov=this.pv.fov}_adjustFOVFromModeCover(){if(this._object.aspect>this.pv.expectedAspectRatio){let e=Math.tan(yi(this.pv.fov/2)),t=this._object.aspect/this.pv.expectedAspectRatio,r=e/t;this._object.fov=ph(Math.atan(r))*2}else this._object.fov=this.pv.fov}_adjustFOVFromModeContain(){if(this._object.aspect>this.pv.expectedAspectRatio)this._object.fov=this.pv.fov;else{let e=Math.tan(yi(this.pv.fov/2)),t=this._object.aspect/this.pv.expectedAspectRatio,r=e/t;this._object.fov=ph(Math.atan(r))*2}}};var Lg=class extends Br{constructor(e=10,t=16,r=8,o=64,n=4473924,s=8947848){n=new he(n),s=new he(s);let a=[],c=[];for(let p=0;p<=t;p++){let h=p/t*(Math.PI*2),d=Math.sin(h)*e,m=Math.cos(h)*e;a.push(0,0,0),a.push(d,0,m);let f=p&1?n:s;c.push(f.r,f.g,f.b),c.push(f.r,f.g,f.b)}for(let p=0;p<=r;p++){let h=p&1?n:s,d=e-e/r*p;for(let m=0;m<o;m++){let f=m/o*(Math.PI*2),x=Math.sin(f)*d,_=Math.cos(f)*d;a.push(x,0,_),c.push(h.r,h.g,h.b),f=(m+1)/o*(Math.PI*2),x=Math.sin(f)*d,_=Math.cos(f)*d,a.push(x,0,_),c.push(h.r,h.g,h.b)}}let l=new De;l.setAttribute("position",new Ce(a,3)),l.setAttribute("color",new Ce(c,3));let u=new ur({vertexColors:!0,toneMapped:!1});super(l,u);this.type="PolarGridHelper"}};var EB=class extends V{constructor(){super(...arguments);this.center=v.VECTOR3([0,0,0]),this.longitude=v.FLOAT(0,{range:[0,360]}),this.latitude=v.FLOAT(0,{range:[-180,180]}),this.depth=v.FLOAT(1,{range:[0,10]})}},kre=new EB,CB="_cook_main_without_inputs_when_dirty",Bre=new w(0,1,0),Fre=new w(-1,0,0),Ig=class extends Co{constructor(){super(...arguments);this.paramsConfig=kre,this.hierarchyController=new to(this),this.flags=new ho(this),this._helper=this._createHelper(),this._cook_main_without_inputs_when_dirty_bound=this._cook_main_without_inputs_when_dirty.bind(this),this._centerMatrix=new Ve,this._longitudeMatrix=new Ve,this._latitudeMatrix=new Ve,this._depthMatrix=new Ve,this._fullMatrix=new Ve,this._decomposed={t:new w,q:new Nt,s:new w}}static type(){return"polarTransform"}createObject(){let e=new ut;return e.matrixAutoUpdate=!1,e}initializeNode(){this.hierarchyController.initializeNode(),this.dirtyController.hasHook(CB)||this.dirtyController.addPostDirtyHook(CB,this._cook_main_without_inputs_when_dirty_bound),this._updateHelperHierarchy(),this._helper.matrixAutoUpdate=!1,this.flags.display.onUpdate(()=>{this._updateHelperHierarchy()})}_updateHelperHierarchy(){this._displayedHelper()?(this.object.add(this._helper),this._updateHelper()):this.object.remove(this._helper)}_displayedHelper(){return this.flags.display.active()}_axisHelper(){return this.__axisHelper__=this.__axisHelper__||this._createAxisHelper()}_createAxisHelper(){let e=new Rf(1);return e.matrixAutoUpdate=!1,e}_polarGridHelper(){return this.__polarGridHelper__=this.__polarGridHelper__||this._createPolarGridHelper()}_createPolarGridHelper(){let e=this.pv.depth,t=16,r=8,o=64,n=new Lg(e,t,r,o);return n.matrixAutoUpdate=!1,n}_createHelper(){let e=new ut;return e.name="PolarTransformHelper",e.matrixAutoUpdate=!1,e.add(this._axisHelper()),e.add(this._polarGridHelper()),e}async _cook_main_without_inputs_when_dirty(){await this.cookController.cookMainWithoutInputs()}cook(){let e=this.object;this._centerMatrix.identity(),this._longitudeMatrix.identity(),this._latitudeMatrix.identity(),this._depthMatrix.identity(),this._centerMatrix.makeTranslation(this.pv.center.x,this.pv.center.y,this.pv.center.z),this._longitudeMatrix.makeRotationAxis(Bre,yi(this.pv.longitude)),this._latitudeMatrix.makeRotationAxis(Fre,yi(this.pv.latitude)),this._depthMatrix.makeTranslation(0,0,this.pv.depth),this._fullMatrix.copy(this._centerMatrix).multiply(this._longitudeMatrix).multiply(this._latitudeMatrix).multiply(this._depthMatrix),this._fullMatrix.decompose(this._decomposed.t,this._decomposed.q,this._decomposed.s),e.position.copy(this._decomposed.t),e.quaternion.copy(this._decomposed.q),e.scale.copy(this._decomposed.s),e.updateMatrix(),this._updateHelper(),this.cookController.endCook()}_updateHelper(){!this._displayedHelper()||(this._helper.updateMatrix(),this._polarGridHelper().matrix.copy(this.object.matrix),this._polarGridHelper().matrix.invert(),this._polarGridHelper().matrix.multiply(this._centerMatrix))}};var Fp=class extends je{constructor(){super(pe(Fp.getDefaults(),arguments,["positionX","positionY","positionZ"]));this.name="Panner3D";let e=pe(Fp.getDefaults(),arguments,["positionX","positionY","positionZ"]);this._panner=this.input=this.output=this.context.createPanner(),this.panningModel=e.panningModel,this.maxDistance=e.maxDistance,this.distanceModel=e.distanceModel,this.coneOuterGain=e.coneOuterGain,this.coneOuterAngle=e.coneOuterAngle,this.coneInnerAngle=e.coneInnerAngle,this.refDistance=e.refDistance,this.rolloffFactor=e.rolloffFactor,this.positionX=new ft({context:this.context,param:this._panner.positionX,value:e.positionX}),this.positionY=new ft({context:this.context,param:this._panner.positionY,value:e.positionY}),this.positionZ=new ft({context:this.context,param:this._panner.positionZ,value:e.positionZ}),this.orientationX=new ft({context:this.context,param:this._panner.orientationX,value:e.orientationX}),this.orientationY=new ft({context:this.context,param:this._panner.orientationY,value:e.orientationY}),this.orientationZ=new ft({context:this.context,param:this._panner.orientationZ,value:e.orientationZ})}static getDefaults(){return Object.assign(je.getDefaults(),{coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:0,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1})}setPosition(e,t,r){return this.positionX.value=e,this.positionY.value=t,this.positionZ.value=r,this}setOrientation(e,t,r){return this.orientationX.value=e,this.orientationY.value=t,this.orientationZ.value=r,this}get panningModel(){return this._panner.panningModel}set panningModel(e){this._panner.panningModel=e}get refDistance(){return this._panner.refDistance}set refDistance(e){this._panner.refDistance=e}get rolloffFactor(){return this._panner.rolloffFactor}set rolloffFactor(e){this._panner.rolloffFactor=e}get distanceModel(){return this._panner.distanceModel}set distanceModel(e){this._panner.distanceModel=e}get coneInnerAngle(){return this._panner.coneInnerAngle}set coneInnerAngle(e){this._panner.coneInnerAngle=e}get coneOuterAngle(){return this._panner.coneOuterAngle}set coneOuterAngle(e){this._panner.coneOuterAngle=e}get coneOuterGain(){return this._panner.coneOuterGain}set coneOuterGain(e){this._panner.coneOuterGain=e}get maxDistance(){return this._panner.maxDistance}set maxDistance(e){this._panner.maxDistance=e}dispose(){return super.dispose(),this._panner.disconnect(),this.orientationX.dispose(),this.orientationY.dispose(),this.orientationZ.dispose(),this.positionX.dispose(),this.positionY.dispose(),this.positionZ.dispose(),this}};var il=new w,SB=new Nt,Ure=new w,nl=new w,Dg=(i=>(i.LINEAR="linear",i.INVERSE="inverse",i.EXPONENTIAL="exponential",i))(Dg||{}),N9=["linear","inverse","exponential"],kg=class extends vt{constructor(){super();this.listenerTransformAutoUpdate=!0,this.tonePanner=new Fp,this.pannerNode=this.tonePanner.input}disconnect(){this.tonePanner.disconnect()}setInput(e){this._currentAudioNode&&this._currentAudioNode.disconnect(this.tonePanner),e&&e.connect(this.tonePanner),this._currentAudioNode=e}connect(e){this.tonePanner.connect(e)}getRefDistance(){return this.pannerNode.refDistance}setRefDistance(e){return this.pannerNode.refDistance=e,this}getRolloffFactor(){return this.pannerNode.rolloffFactor}setRolloffFactor(e){return this.pannerNode.rolloffFactor=e,this}getDistanceModel(){return this.pannerNode.distanceModel}setDistanceModel(e){return this.pannerNode.distanceModel=e,this}getMaxDistance(){return this.pannerNode.maxDistance}setMaxDistance(e){return this.pannerNode.maxDistance=e,this}setDirectionalCone(e,t,r){return this.pannerNode.coneInnerAngle=e,this.pannerNode.coneOuterAngle=t,this.pannerNode.coneOuterGain=r,this}coneInnerAngle(){return this.pannerNode.coneInnerAngle}coneOuterAngle(){return this.pannerNode.coneOuterAngle}updateMatrixWorld(e){if(super.updateMatrixWorld(e),!this.listenerTransformAutoUpdate)return;this.matrixWorld.decompose(il,SB,Ure),nl.set(0,0,1).applyQuaternion(SB);let t="+1",r=this.tonePanner;r.positionX?(r.positionX.linearRampToValueAtTime(il.x,t),r.positionY.linearRampToValueAtTime(il.y,t),r.positionZ.linearRampToValueAtTime(il.z,t),r.orientationX.linearRampToValueAtTime(nl.x,t),r.orientationY.linearRampToValueAtTime(nl.y,t),r.orientationZ.linearRampToValueAtTime(nl.z,t)):(r.setPosition(il.x,il.y,il.z),r.setOrientation(nl.x,nl.y,nl.z))}};function Vre(i,e){let t=new De,r=i+e*2,o=new Float32Array((r*3+3)*3);return t.setAttribute("position",new Ot(o,3)),t}function Gre(){return new ur({color:65280})}function zre(){return new ur({color:16776960})}var Bg=class extends cs{constructor(e,t=1,r=16,o=2){super(Vre(r,o),[Gre(),zre()]);this.audio=e,this.range=t,this.divisionsInnerAngle=r,this.divisionsOuterAngle=o,this.type="PositionalAudioHelper",this.update()}update(){let e=this.audio,t=this.range,r=this.divisionsInnerAngle,o=this.divisionsOuterAngle,n=yi(e.coneInnerAngle()),s=yi(e.coneOuterAngle()),a=n/2,c=s/2,l=0,u=0,p,h,d=this.geometry,m=d.attributes.position;d.clearGroups();function f(x,_,g,T){let b=(_-x)/g;for(m.setXYZ(l,0,0,0),u++,p=x;p<_;p+=b)h=l+u,m.setXYZ(h,Math.sin(p)*t,0,Math.cos(p)*t),m.setXYZ(h+1,Math.sin(Math.min(p+b,_))*t,0,Math.cos(Math.min(p+b,_))*t),m.setXYZ(h+2,0,0,0),u+=3;d.addGroup(l,u,T),l+=u,u=0}if(f(-c,-a,o,0),f(-a,a,r,1),f(a,c,o,0),m.needsUpdate=!0,n===s){let x=this.material;x[0].visible=!1}}dispose(){this.geometry.dispose();let e=this.material;e[0].dispose(),e[1].dispose()}};var Ra=()=>({cook:!1,callback:i=>{O9.PARAM_CALLBACK_updatePositionalAudio(i)}}),wB=class extends eo(V){constructor(){super(...arguments);this.audio=v.FOLDER(),this.audioNode=v.NODE_PATH("",{nodeSelection:{context:oe.AUDIO}}),this.refDistance=v.FLOAT(10,{range:[0,10],rangeLocked:[!0,!1],...Ra()}),this.rolloffFactor=v.FLOAT(10,{range:[0,10],rangeLocked:[!0,!1],...Ra()}),this.maxDistance=v.FLOAT(100,{range:[.001,100],rangeLocked:[!0,!1],...Ra()}),this.distanceModel=v.INTEGER(N9.indexOf(Dg.LINEAR),{menu:{entries:N9.map((e,t)=>({name:e,value:t}))},...Ra()}),this.coneInnerAngle=v.FLOAT(360,{range:[0,360],rangeLocked:[!0,!0],...Ra()}),this.coneOuterAngle=v.FLOAT(230,{range:[0,360],rangeLocked:[!0,!0],...Ra()}),this.coneOuterGain=v.FLOAT(.1,{range:[0,1],rangeLocked:[!0,!0],...Ra()}),this.listenerTransformAutoUpdate=v.BOOLEAN(1),this.showHelper=v.BOOLEAN(1),this.helperSize=v.FLOAT(1,{range:[0,10],rangeLocked:[!0,!1],visibleIf:{showHelper:!0},...Ra()})}},Hre=new wB;function jre(){let i=new kg;return i.matrixAutoUpdate=!1,i}var O9=class extends Co{constructor(){super(...arguments);this.paramsConfig=Hre,this.hierarchyController=new to(this),this.transformController=new Vo(this),this.flags=new ho(this),this._positionalAudio=jre(),this._childrenControllerContext=oe.AUDIO}static type(){return E0.POSITIONAL_AUDIO}createObject(){let e=new ut;return e.matrixAutoUpdate=!1,e.add(this._positionalAudio),e}initializeNode(){this.hierarchyController.initializeNode(),this.transformController.initializeNode(),this._updateHelperHierarchy(),this.flags.display.onUpdate(async()=>{await this._updateToDestination(),await this._updateHelperHierarchy()})}async _updateToDestination(){if(this.flags.display.active()){let e=this.root().audioController.audioListeners()[0];if(!e){this.states.error.set("a listener is required in the scene");return}e.object.addInput(this._positionalAudio)}else this._positionalAudio.disconnect()}_updateHelperHierarchy(){!this._helper||(this.flags.display.active()?this.object.add(this._helper):this.object.remove(this._helper))}async cook(){this.transformController.update(),await this._updateToDestination(),this._updatePositionalAudio(),this._connectAudioNode(),this.cookController.endCook()}async _updatePositionalAudio(){this._positionalAudio.setRefDistance(this.pv.refDistance),this._positionalAudio.setRolloffFactor(this.pv.rolloffFactor),this._positionalAudio.setMaxDistance(this.pv.maxDistance),this._positionalAudio.setDistanceModel(N9[this.pv.distanceModel]),this._positionalAudio.setDirectionalCone(this.pv.coneInnerAngle,this.pv.coneOuterAngle,this.pv.coneOuterGain),this._positionalAudio.listenerTransformAutoUpdate=this.pv.listenerTransformAutoUpdate,this.pv.showHelper&&(this._helper=this._helper||this._createHelper(this._positionalAudio),this.object.add(this._helper)),this._helper&&(this._helper.visible=this.pv.showHelper,this._helper.range=this.pv.helperSize,this._helper.update())}_createHelper(e){let t=new Bg(e);return t.matrixAutoUpdate=!1,t}_resetAudioNode(){this._positionalAudio.setInput(void 0)}async _connectAudioNode(){this._resetAudioNode();let e=this.pv.audioNode.nodeWithContext(oe.AUDIO);if(!e){this.states.error.set("no audio node found"),this._resetAudioNode();return}let r=(await e.compute()).coreContent();if(!r){this.states.error.set("invalid audio node"),this._resetAudioNode();return}let o=r.audioNode();if(!o){this.states.error.set("no valid audio node given"),this._resetAudioNode();return}this._positionalAudio.setInput(o)}static PARAM_CALLBACK_updatePositionalAudio(e){e._updatePositionalAudio()}createNode(e,t){return super.createNode(e,t)}children(){return super.children()}nodesByType(e){return super.nodesByType(e)}};var MB=new Ve,NB=new w,OB=new w,sl=class{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new G(512,512),this.map=null,this.mapPass=null,this.matrix=new Ve,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new tc,this._frameExtents=new G(1,1),this._viewportCount=1,this._viewports=[new Ie(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){let t=this.camera,r=this.matrix;NB.setFromMatrixPosition(e.matrixWorld),t.position.copy(NB),OB.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(OB),t.updateMatrixWorld(),MB.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(MB),r.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),r.multiply(t.projectionMatrix),r.multiply(t.matrixWorldInverse)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){let e={};return this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}};var P9=class extends sl{constructor(){super(new ir(50,1,.5,500));this.focus=1}updateMatrices(e){let t=this.camera,r=uh*2*e.angle*this.focus,o=this.mapSize.width/this.mapSize.height,n=e.distance||t.far;(r!==t.fov||o!==t.aspect||n!==t.far)&&(t.fov=r,t.aspect=o,t.far=n,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}};P9.prototype.isSpotLightShadow=!0;var La=class extends Eo{constructor(e,t,r=0,o=Math.PI/3,n=0,s=1){super(e,t);this.type="SpotLight",this.position.copy(vt.DefaultUp),this.updateMatrix(),this.target=new vt,this.distance=r,this.angle=o,this.penumbra=n,this.decay=s,this.shadow=new P9}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}};La.prototype.isSpotLight=!0;var Up=class extends De{constructor(e=1,t=1,r=1,o=8,n=1,s=!1,a=0,c=Math.PI*2){super();this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:r,radialSegments:o,heightSegments:n,openEnded:s,thetaStart:a,thetaLength:c};let l=this;o=Math.floor(o),n=Math.floor(n);let u=[],p=[],h=[],d=[],m=0,f=[],x=r/2,_=0;g(),s===!1&&(e>0&&T(!0),t>0&&T(!1)),this.setIndex(u),this.setAttribute("position",new Ce(p,3)),this.setAttribute("normal",new Ce(h,3)),this.setAttribute("uv",new Ce(d,2));function g(){let b=new w,y=new w,A=0,E=(t-e)/r;for(let S=0;S<=n;S++){let M=[],L=S/n,C=L*(t-e)+e;for(let N=0;N<=o;N++){let D=N/o,k=D*c+a,z=Math.sin(k),F=Math.cos(k);y.x=C*z,y.y=-L*r+x,y.z=C*F,p.push(y.x,y.y,y.z),b.set(z,E,F).normalize(),h.push(b.x,b.y,b.z),d.push(D,1-L),M.push(m++)}f.push(M)}for(let S=0;S<o;S++)for(let M=0;M<n;M++){let L=f[M][S],C=f[M+1][S],N=f[M+1][S+1],D=f[M][S+1];u.push(L,C,D),u.push(C,N,D),A+=6}l.addGroup(_,A,0),_+=A}function T(b){let y=m,A=new G,E=new w,S=0,M=b===!0?e:t,L=b===!0?1:-1;for(let N=1;N<=o;N++)p.push(0,x*L,0),h.push(0,L,0),d.push(.5,.5),m++;let C=m;for(let N=0;N<=o;N++){let k=N/o*c+a,z=Math.cos(k),F=Math.sin(k);E.x=M*F,E.y=x*L,E.z=M*z,p.push(E.x,E.y,E.z),h.push(0,L,0),A.x=z*.5+.5,A.y=F*.5*L+.5,d.push(A.x,A.y),m++}for(let N=0;N<o;N++){let D=y+N,k=C+N;b===!0?u.push(k,k+1,D):u.push(k+1,k,D),S+=3}l.addGroup(_,S,b===!0?1:2),_+=S}}static fromJSON(e){return new Up(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}};var Vp=class extends Up{constructor(e=1,t=1,r=8,o=1,n=!1,s=0,a=Math.PI*2){super(0,e,t,r,o,n,s,a);this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:r,heightSegments:o,openEnded:n,thetaStart:s,thetaLength:a}}static fromJSON(e){return new Vp(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}};var DB=bn(RB()),kB=bn(IB());var Fg=class{constructor(e){this.container=e}update(e){let t=this.container.light();if(e.tvolumetric){let r=this.object();R9.transformObject(r,{sizeMult:1,distance:t.distance,angle:t.angle});let o=r.material.uniforms;o.lightColor.value.copy(t.color),o.attenuation.value=e.volAttenuation,o.anglePower.value=e.volAnglePower,t.add(r)}else this._mesh&&t.remove(this._mesh)}object(){return this._mesh=this._mesh||this._createMesh()}_createMesh(){let n=new Vp(1,1,128,32);n.applyMatrix4(new Ve().makeTranslation(0,-.5*1,0)),n.applyMatrix4(new Ve().makeRotationX(-Math.PI/2));let s=this._createMaterial(),a=new lt(n,s);return a.matrixAutoUpdate=!1,a.name="Volumetric",s.uniforms.lightColor.value.set("white"),a}_createMaterial(){return new Ar({uniforms:{attenuation:{value:5},anglePower:{value:1.2},lightColor:{value:new he("cyan")}},vertexShader:DB.default,fragmentShader:kB.default,transparent:!0,depthWrite:!1})}};var Vg={color:new he(1,1,1),intensity:1,angle:45,penumbra:.1,decay:.1,distance:100,showHelper:!1,helperSize:1,castShadow:!1,shadowAutoUpdate:!0,shadowUpdateOnNextRender:!1,shadowRes:new G(1024,1024),shadowBias:1e-4,shadowNear:.1,shadowFar:100,shadowRadius:0,tvolumetric:!1,volAttenuation:5,volAnglePower:10},ro=Vg;function BB(i){return class extends i{constructor(){super(...arguments);this.light=v.FOLDER(),this.color=v.COLOR(ro.color.toArray(),{conversion:Io.SRGB_TO_LINEAR}),this.intensity=v.FLOAT(ro.intensity,{range:[0,10],rangeLocked:[!0,!1]}),this.angle=v.FLOAT(ro.angle,{range:[0,180]}),this.penumbra=v.FLOAT(ro.penumbra),this.decay=v.FLOAT(ro.decay,{range:[0,1]}),this.distance=v.FLOAT(ro.distance,{range:[0,100]}),this.showHelper=v.BOOLEAN(ro.showHelper),this.helperSize=v.FLOAT(ro.helperSize,{visibleIf:{showHelper:1}}),this.shadow=v.FOLDER(),this.castShadow=v.BOOLEAN(ro.castShadow),this.shadowAutoUpdate=v.BOOLEAN(ro.shadowAutoUpdate,{visibleIf:{castShadow:1}}),this.shadowUpdateOnNextRender=v.BOOLEAN(ro.shadowUpdateOnNextRender,{visibleIf:{castShadow:1,shadowAutoUpdate:0}}),this.shadowRes=v.VECTOR2(ro.shadowRes.toArray(),{visibleIf:{castShadow:1}}),this.shadowBias=v.FLOAT(ro.shadowBias,{visibleIf:{castShadow:1},range:[-.01,.01],rangeLocked:[!1,!1]}),this.shadowNear=v.FLOAT(ro.shadowNear,{visibleIf:{castShadow:1},range:[0,100],rangeLocked:[!0,!1]}),this.shadowFar=v.FLOAT(ro.shadowFar,{visibleIf:{castShadow:1},range:[0,100],rangeLocked:[!0,!1]}),this.shadowRadius=v.FLOAT(ro.shadowRadius,{visibleIf:{castShadow:1},range:[0,10],rangeLocked:[!0,!1]}),this.volumetric=v.FOLDER(),this.tvolumetric=v.BOOLEAN(ro.tvolumetric),this.volAttenuation=v.FLOAT(ro.volAttenuation,{range:[0,10],rangeLocked:[!0,!1]}),this.volAnglePower=v.FLOAT(ro.volAnglePower,{range:[0,20],rangeLocked:[!0,!1]})}}}var Bf=class extends ut{constructor(e){super();this._light=new La,this._target=this._light.target,this.matrixAutoUpdate=!1,this.params={showHelper:!1,helperSize:1,tvolumetric:!1,volAnglePower:1,volAttenuation:1},e.showHelper!=null&&(this.params.showHelper=e.showHelper),e.tvolumetric!=null&&(this.params.tvolumetric=e.tvolumetric),e.volAnglePower!=null&&(this.params.volAnglePower=e.volAnglePower),e.volAttenuation!=null&&(this.params.volAttenuation=e.volAttenuation),this._light.position.set(0,0,1),this._light.updateMatrix(),this._target.updateMatrix(),this._light.matrixAutoUpdate=!1,this._target.matrixAutoUpdate=!1,this._target.name="SpotLight Default Target",this.add(this._light),this.add(this._target),this.updateHelper()}updateParams(e){e.showHelper!=null&&(this.params.showHelper=e.showHelper),e.helperSize!=null&&(this.params.helperSize=e.helperSize),e.tvolumetric!=null&&(this.params.tvolumetric=e.tvolumetric),e.volAnglePower!=null&&(this.params.volAnglePower=e.volAnglePower),e.volAttenuation!=null&&(this.params.volAttenuation=e.volAttenuation)}light(){return this._light}copy(e,t){return this._light.copy(e.light()),this.position.copy(e.position),this.rotation.copy(e.rotation),this.scale.copy(e.scale),this.quaternion.copy(e.quaternion),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.updateParams(e.params),this.updateHelper(),this.updateVolumetric(),this.add(this._light.target),this}clone(e){let t=new Bf(this.params);return t.copy(this),t}updateHelper(){this.params.showHelper?(this.__helper__=this.__helper__||new R9(this),this.add(this.__helper__.object),this.__helper__.update({helperSize:this.params.helperSize})):this.__helper__&&this.remove(this.__helper__.object)}updateVolumetric(){this.params.tvolumetric?(this.__volumetric__=this.__volumetric__||new Fg(this),this.__volumetric__.update(this.params)):this.__volumetric__&&this.__volumetric__.update(this.params)}},Ug=class{constructor(i){this.container=i,this.object=new lt,this._cone=new Br,this._lineMaterial=new ur({fog:!1}),this.createAndBuildObject({helperSize:1})}createAndBuildObject(i){this.buildHelper(),this.update(i)}buildHelper(){this._cone.geometry=Ug._buildConeGeometry(),this._cone.material=this._lineMaterial,this._cone.matrixAutoUpdate=!1,this.object.add(this._cone)}update(i){let e=this.container.light();Ug.transformObject(this._cone,{sizeMult:i.helperSize,distance:e.distance,angle:e.angle}),this._lineMaterial.color.copy(e.color)}static transformObject(i,e){let t=(e.distance?e.distance:1e3)*e.sizeMult,r=t*Math.tan(e.angle);this._matrixScale.set(r,r,t),i.matrix.identity(),i.matrix.makeRotationX(Math.PI*1),i.matrix.scale(this._matrixScale)}static _buildConeGeometry(){let i=new De,e=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let t=0,r=1,o=32;t<o;t++,r++){let n=t/o*Math.PI*2,s=r/o*Math.PI*2;e.push(Math.cos(n),Math.sin(n),1,Math.cos(s),Math.sin(s),1)}return i.setAttribute("position",new Ce(e,3)),i}},R9=Ug;R9._matrixScale=new w;var Ff=class extends Qe{static type(){return"spotLight"}cook(e,t){let r=this.createLight(t);return this.updateLightParams(r,t),this.updateShadowParams(r,t),r.updateParams(t),r.updateHelper(),r.updateVolumetric(),this.createCoreGroupFromObjects([r])}createLight(e){let t=new Bf(e),r=t.light();return r.matrixAutoUpdate=!1,r.castShadow=!0,r.shadow.bias=-.001,r.shadow.mapSize.x=1024,r.shadow.mapSize.y=1024,r.shadow.camera.near=.1,t}updateLightParams(e,t){let r=e.light();r.color=t.color,r.intensity=t.intensity,r.angle=t.angle*(Math.PI/180),r.penumbra=t.penumbra,r.decay=t.decay,r.distance=t.distance}updateShadowParams(e,t){let r=e.light();r.castShadow=t.castShadow,r.shadow.autoUpdate=t.shadowAutoUpdate,r.shadow.needsUpdate=t.shadowUpdateOnNextRender,r.shadow.mapSize.copy(t.shadowRes);let o=r.shadow.map;o&&o.setSize(t.shadowRes.x,t.shadowRes.y),r.shadow.bias=t.shadowBias,r.shadow.radius=t.shadowRadius,r.shadow.camera.near=t.shadowNear,r.shadow.camera.far=t.shadowFar,r.shadow.camera.updateProjectionMatrix(),e.updateHelper()}};Ff.DEFAULT_PARAMS=Vg;Ff.INPUT_CLONED_STATE=Ge.NEVER;var FB=class extends BB(eo(V)){},Wre=new FB,Gg=class extends yf{constructor(){super(...arguments);this.paramsConfig=Wre}static type(){return Nf.SPOT}_operation(){return this.__operation__=this.__operation__||new Ff(this._scene,this.states)}createLight(){return this._operation().createLight(this.pv)}updateLightParams(){this._operation().updateLightParams(this.light,this.pv)}updateShadowParams(){this.light.updateParams(this.pv),this.light.updateHelper(),this.light.updateVolumetric(),this._operation().updateShadowParams(this.light,this.pv)}};var UB=class extends dr{static context(){return oe.SOP}cook(){this.cookController.endCook()}},S0=class extends UB{};var zg=class extends S0{constructor(){super(...arguments);this._childrenControllerContext=oe.ANIM}static type(){return Ro.ANIM}createNode(e,t){return super.createNode(e,t)}children(){return super.children()}nodesByType(e){return super.nodesByType(e)}};var VB=class extends Qe{static type(){return"attribCreate"}cook(i,e){var t;let r=i[0],o=e.name;return o&&o.trim()!=""?this._addAttribute(Lo[e.class],r,e):(t=this.states)==null||t.error.set("attribute name is not valid"),r}_addAttribute(i,e,t){let r=At[t.type];switch(i){case jr.VERTEX:this._addPointAttribute(r,e,t);return;case jr.OBJECT:this._addObjectAttribute(r,e,t);return}Be.unreachable(i)}_addPointAttribute(i,e,t){let r=e.coreObjects();switch(i){case Ue.NUMERIC:{for(let o of r)this._addNumericAttributeToPoints(o,t);return}case Ue.STRING:{for(let o of r)this._addStringAttributeToPoints(o,t);return}}Be.unreachable(i)}_addObjectAttribute(i,e,t){let r=e.coreObjectsFromGroup(t.group),o=t.name,n=e.coreObjects(),s=VB.defaultAttribValue(t);if(s!=null)for(let a of n)a.hasAttrib(o)||a.setAttribValue(o,s);switch(i){case Ue.NUMERIC:this._addNumericAttributeToObjects(r,t);return;case Ue.STRING:this._addStringAttributeToObjects(r,t);return}Be.unreachable(i)}_addNumericAttributeToPoints(i,e){let t=i.coreGeometry();if(!t)return;let r=[e.value1,e.value2,e.value3,e.value4][e.size-1],o=wt.remapName(e.name);if(t.hasAttrib(o)?t.markAttribAsNeedsUpdate(o):t.addNumericAttrib(o,e.size,0),e.group){let n=i.pointsFromGroup(e.group);for(let s of n)s.setAttribValue(o,r)}else i.addNumericVertexAttrib(o,e.size,r)}_addNumericAttributeToObjects(i,e){let t=[e.value1,e.value2,e.value3,e.value4][e.size-1],r=e.name;for(let o of i)o.setAttribValue(r,t)}_addStringAttributeToPoints(i,e){let t=i.coreGeometry();if(!t)return;let r=i.pointsFromGroup(e.group),o=e.name,n=e.string,s=new Array(r.length);if(this._hasGroup(e)){let c=i.points();if(s=s.length!=c.length?new Array(c.length):s,!t.hasAttrib(o)){let l=wt.arrayToIndexedArrays([""]);t.setIndexedAttribute(o,l.values,l.indices)}for(let l of c){let u=l.stringAttribValue(o);u==null&&(u=""),s[l.index()]=u}}for(let c of r)s[c.index()]=n;let a=wt.arrayToIndexedArrays(s);t.setIndexedAttribute(o,a.values,a.indices)}_addStringAttributeToObjects(i,e){let t=e.string;for(let r of i)r.setAttribValue(e.name,t)}_hasGroup(i){return i.group.trim()!=""}static _attribType(i){return At[i.type]}static defaultAttribValue(i){let e=this._attribType(i);switch(e){case Ue.NUMERIC:return this._defaultNumericValue(i);case Ue.STRING:return this._defaultStringValue()}Be.unreachable(e)}static _defaultStringValue(){return""}static _defaultNumericValue(i){switch(i.size){case 1:return 0;case 2:return new G(0,0);case 3:return new w(0,0,0);case 4:return new Ie(0,0,0,0)}}},al=VB;al.DEFAULT_PARAMS={group:"",class:Lo.indexOf(jr.VERTEX),type:At.indexOf(Ue.NUMERIC),name:"new_attrib",size:1,value1:0,value2:new G(0,0),value3:new w(0,0,0),value4:new Ie(0,0,0,0),string:""};al.INPUT_CLONED_STATE=Ge.FROM_NODE;var qre=["x","y","z","w"],ks=al.DEFAULT_PARAMS,GB=class extends V{constructor(){super(...arguments);this.group=v.STRING(ks.group),this.class=v.INTEGER(ks.class,{menu:{entries:h1}}),this.type=v.INTEGER(ks.type,{menu:{entries:j0}}),this.name=v.STRING(ks.name),this.size=v.INTEGER(ks.size,{range:[1,4],rangeLocked:[!0,!0],visibleIf:{type:Ue.NUMERIC}}),this.value1=v.FLOAT(ks.value1,{visibleIf:{type:Ue.NUMERIC,size:1},expression:{forEntities:!0}}),this.value2=v.VECTOR2(ks.value2,{visibleIf:{type:Ue.NUMERIC,size:2},expression:{forEntities:!0}}),this.value3=v.VECTOR3(ks.value3,{visibleIf:{type:Ue.NUMERIC,size:3},expression:{forEntities:!0}}),this.value4=v.VECTOR4(ks.value4,{visibleIf:{type:Ue.NUMERIC,size:4},expression:{forEntities:!0}}),this.string=v.STRING(ks.string,{visibleIf:{type:Ue.STRING},expression:{forEntities:!0}})}},Xre=new GB,Hg=class extends et{constructor(){super(...arguments);this.paramsConfig=Xre,this._arraysByGeoUuid={X:new Map,Y:new Map,Z:new Map,W:new Map}}static type(){return"attribCreate"}initializeNode(){this.io.inputs.setCount(1),this.io.inputs.initInputsClonedState(al.INPUT_CLONED_STATE)}cook(e){let t=this.pv.name;if(this._isUsingExpression())t&&t.trim()!=""?this._addAttribute(Lo[this.pv.class],e[0]):this.states.error.set("attribute name is not valid");else{this._operation=this._operation||new al(this.scene(),this.states);let r=this._operation.cook(e,this.pv);this.setCoreGroup(r)}}async _addAttribute(e,t){let r=At[this.pv.type];switch(e){case jr.VERTEX:return await this._addPointAttribute(r,t),this.setCoreGroup(t);case jr.OBJECT:return await this._addObjectAttribute(r,t),this.setCoreGroup(t)}Be.unreachable(e)}async _addPointAttribute(e,t){let r=t.coreObjects();switch(e){case Ue.NUMERIC:{for(let o=0;o<r.length;o++)await this._addNumericAttributeToPoints(r[o]);return}case Ue.STRING:{for(let o=0;o<r.length;o++)await this._addStringAttributeToPoints(r[o]);return}}Be.unreachable(e)}async _addObjectAttribute(e,t){let r=t.coreObjectsFromGroup(this.pv.group),o=this.pv.name,n=t.coreObjects(),s=al.defaultAttribValue(this.pv);if(s!=null)for(let a of n)a.hasAttrib(o)||a.setAttribValue(o,s);switch(e){case Ue.NUMERIC:await this._addNumericAttributeToObject(r);return;case Ue.STRING:await this._addStringAttributeToObject(r);return}Be.unreachable(e)}async _addNumericAttributeToPoints(e){let t=e.coreGeometry();if(!t)return;let r=e.pointsFromGroup(this.pv.group),o=wt.remapName(this.pv.name),n=[this.p.value1,this.p.value2,this.p.value3,this.p.value4][this.pv.size-1];if(n.hasExpression()){t.hasAttrib(o)||t.addNumericAttrib(o,this.pv.size,n.value);let s=t.geometry(),a=s.getAttribute(o);a.needsUpdate=!0;let c=a.array;if(this.pv.size==1)this.p.value1.expressionController&&await this.p.value1.expressionController.computeExpressionForPoints(r,(l,u)=>{c[l.index()*this.pv.size+0]=u});else{let u=[this.p.value2,this.p.value3,this.p.value4][this.pv.size-2].components,p=new Array(u.length),h=[this._arraysByGeoUuid.X,this._arraysByGeoUuid.Y,this._arraysByGeoUuid.Z,this._arraysByGeoUuid.W];for(let d=0;d<u.length;d++){let m=u[d];if(m.hasExpression()&&m.expressionController)p[d]=this._initArrayIfRequired(s,h[d],r.length),await m.expressionController.computeExpressionForPoints(r,(f,x)=>{p[d][f.index()]=x});else{let f=m.value;for(let x of r)c[x.index()*this.pv.size+d]=f}}for(let d=0;d<p.length;d++){let m=p[d];if(m!=null)for(let f=0;f<m.length;f++){let x=m[f];x!=null&&(c[f*this.pv.size+d]=x)}}}}}async _addNumericAttributeToObject(e){let t=[this.p.value1,this.p.value2,this.p.value3,this.p.value4][this.pv.size-1],r=this.pv.name;if(t.hasExpression())if(this.pv.size==1)this.p.value1.expressionController&&await this.p.value1.expressionController.computeExpressionForObjects(e,(o,n)=>{o.setAttribValue(r,n)});else{let n=[this.p.value2,this.p.value3,this.p.value4][this.pv.size-2].components,s=new Map,a=this._vectorByAttribSize(this.pv.size);if(a){for(let c of e)s.set(c.index(),a.clone());for(let c=0;c<n.length;c++){let l=n[c],u=qre[c];if(l.hasExpression()&&l.expressionController)await l.expressionController.computeExpressionForObjects(e,(p,h)=>{let d=s.get(p.index());d[u]=h});else for(let p of e){let h=s.get(p.index());h[u]=l.value}}for(let c=0;c<e.length;c++){let l=e[c],u=s.get(l.index());u!=null&&l.setAttribValue(r,u)}}}}async _addStringAttributeToPoints(e){let t=e.coreGeometry();if(!t)return;let r=e.pointsFromGroup(this.pv.group),o=this.p.string,n=this.pv.name,s=new Array(r.length);if(o.hasExpression()&&o.expressionController){if(this._hasGroup()){if(!t.hasAttrib(n)){let u=wt.arrayToIndexedArrays([""]);t.setIndexedAttribute(n,u.values,u.indices)}let l=e.points();s=s.length!=l.length?new Array(l.length):s;for(let u of l){let p=u.stringAttribValue(n);p==null&&(p=""),s[u.index()]=p}}await o.expressionController.computeExpressionForPoints(r,(l,u)=>{s[l.index()]=u})}let a=wt.arrayToIndexedArrays(s),c=e.coreGeometry();c&&c.setIndexedAttribute(n,a.values,a.indices)}async _addStringAttributeToObject(e){let t=this.p.string,r=this.pv.name;t.hasExpression()&&t.expressionController&&await t.expressionController.computeExpressionForObjects(e,(o,n)=>{o.setAttribValue(r,n)})}_initArrayIfRequired(e,t,r){let o=e.uuid,n=t.get(o);return n?n.length<r&&t.set(o,new Array(r)):t.set(o,new Array(r)),t.get(o)}_isUsingExpression(){switch(At[this.pv.type]){case Ue.NUMERIC:return[this.p.value1,this.p.value2,this.p.value3,this.p.value4][this.pv.size-1].hasExpression();case Ue.STRING:return this.p.string.hasExpression()}}setAttribClass(e){this.p.class.set(Lo.indexOf(e))}attribClass(){return Lo[this.pv.class]}setAttribType(e){this.p.type.set(At.indexOf(e))}attribType(){return At[this.pv.type]}_hasGroup(){return this.pv.group.trim()!=""}_vectorByAttribSize(e){switch(e){case 2:return new G(0,0);case 3:return new w(0,0,0);case 4:return new Ie(0,0,0,0)}}};var cl=class extends Qe{constructor(){super(...arguments);this._core_transform=new Xt}static type(){return"box"}cook(e,t){let r=e[0],o=r?this._cookWithInput(r,t):this._cookWithoutInput(t);return this.createCoreGroupFromGeometry(o)}_cookWithoutInput(e){let t=e.divisions,r=e.size,o=new Ti(r,r,r,t,t,t);return o.translate(e.center.x,e.center.y,e.center.z),o.computeVertexNormals(),o}_cookWithInput(e,t){let r=t.divisions,o=e.boundingBox(),n=o.max.clone().sub(o.min),s=o.max.clone().add(o.min).multiplyScalar(.5),a=new Ti(n.x,n.y,n.z,r,r,r),c=this._core_transform.translationMatrix(s);return a.applyMatrix4(c),a}};cl.DEFAULT_PARAMS={size:1,divisions:1,center:new w(0,0,0)};cl.INPUT_CLONED_STATE=Ge.NEVER;var jg=cl.DEFAULT_PARAMS,zB=class extends V{constructor(){super(...arguments);this.size=v.FLOAT(jg.size),this.divisions=v.INTEGER(jg.divisions,{range:[1,10],rangeLocked:[!0,!1]}),this.center=v.VECTOR3(jg.center)}},Yre=new zB,Wg=class extends et{constructor(){super(...arguments);this.paramsConfig=Yre}static type(){return"box"}static displayedInputNames(){return["geometry to create bounding box from (optional)"]}initializeNode(){this.io.inputs.setCount(0,1),this.io.inputs.initInputsClonedState(cl.INPUT_CLONED_STATE)}cook(e){this._operation=this._operation||new cl(this._scene,this.states);let t=this._operation.cook(e,this.pv);this.setCoreGroup(t)}};var qg=class{static positions(e){let{radius:t,segments:r}=e,o=r,n=e.arcAngle||360,s=Er.degrees_to_radians(n)/o,a=[];for(let c=0;c<o;c++){let l=s*c,u=t*Math.cos(l),p=t*Math.sin(l);a.push(new G(u,p))}return a}static create(e){let{segments:t}=e,r=t,o=this.positions(e),n=[],s=[],a;for(let l=0;l<o.length;l++)a=o[l],n.push(a.x),n.push(a.y),n.push(0),l>0&&(s.push(l-1),s.push(l));e.connectLastPoint&&(s.push(r-1),s.push(0));let c=new De;return c.setAttribute("position",new Ce(n,3)),c.setIndex(s),c}};var Gp=class extends De{constructor(e=1,t=8,r=0,o=Math.PI*2){super();this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:r,thetaLength:o},t=Math.max(3,t);let n=[],s=[],a=[],c=[],l=new w,u=new G;s.push(0,0,0),a.push(0,0,1),c.push(.5,.5);for(let p=0,h=3;p<=t;p++,h+=3){let d=r+p/t*o;l.x=e*Math.cos(d),l.y=e*Math.sin(d),s.push(l.x,l.y,l.z),a.push(0,0,1),u.x=(s[h]/e+1)/2,u.y=(s[h+1]/e+1)/2,c.push(u.x,u.y)}for(let p=1;p<=t;p++)n.push(p,p+1,0);this.setIndex(n),this.setAttribute("position",new Ce(s,3)),this.setAttribute("normal",new Ce(a,3)),this.setAttribute("uv",new Ce(c,2))}static fromJSON(e){return new Gp(e.radius,e.segments,e.thetaStart,e.thetaLength)}};var $re=new w(0,0,1),Uf=class extends Qe{constructor(){super(...arguments);this._core_transform=new Xt}static type(){return"circle"}cook(e,t){return t.open?this._createCircle(t):this._createDisk(t)}_createCircle(e){let t=qg.create(e);return this._setCenterAndDirection(t,e),this.createCoreGroupFromGeometry(t,$t.LINE_SEGMENTS)}_createDisk(e){let t=new Gp(e.radius,e.segments);return this._setCenterAndDirection(t,e),this.createCoreGroupFromGeometry(t)}_setCenterAndDirection(e,t){this._core_transform.rotateGeometry(e,$re,t.direction),e.translate(t.center.x,t.center.y,t.center.z)}};Uf.DEFAULT_PARAMS={radius:1,segments:12,open:!0,arcAngle:360,direction:new w(0,1,0),center:new w(0,0,0),connectLastPoint:!0};var ll=Uf.DEFAULT_PARAMS,HB=class extends V{constructor(){super(...arguments);this.radius=v.FLOAT(ll.radius),this.segments=v.INTEGER(ll.segments,{range:[1,50],rangeLocked:[!0,!1]}),this.open=v.BOOLEAN(ll.open),this.connectLastPoint=v.BOOLEAN(ll.connectLastPoint,{visibleIf:{open:1}}),this.arcAngle=v.FLOAT(ll.arcAngle,{range:[0,360],rangeLocked:[!1,!1],visibleIf:{open:1}}),this.direction=v.VECTOR3(ll.direction),this.center=v.VECTOR3(ll.center)}},Kre=new HB,Xg=class extends et{constructor(){super(...arguments);this.paramsConfig=Kre}static type(){return"circle"}initializeNode(){}cook(){this._operation=this._operation||new Uf(this._scene,this.states);let e=this._operation.cook([],this.pv);this.setCoreGroup(e)}};var Yg=class extends S0{constructor(){super(...arguments);this._childrenControllerContext=oe.COP}static type(){return Ro.COP}createNode(e,t){return super.createNode(e,t)}children(){return super.children()}nodesByType(e){return super.nodesByType(e)}};var $g=class{constructor(e){this.node=e,this.selected_state=new Map,this._entities_count=0,this._selected_entities_count=0}init(e){this.selected_state.clear();for(let t of e)this.selected_state.set(t,!1);this._entities_count=e.length,this._selected_entities_count=0}select(e){let t=this.selected_state.get(e);t!=null&&t==!1&&(this.selected_state.set(e,!0),this._selected_entities_count++)}entities_to_keep(){return this._entities_for_state(this.node.pv.invert)}entities_to_delete(){return this._entities_for_state(!this.node.pv.invert)}_entities_for_state(e){let t=!!e,r=e?this._selected_entities_count:this._entities_count-this._selected_entities_count;if(r==0)return[];{let o=new Array(r),n=0;return this.selected_state.forEach((s,a)=>{s==t&&(o[n]=a,n++)}),o}}};var Kg=(i=>(i.EQUAL="==",i.LESS_THAN="<",i.EQUAL_OR_LESS_THAN="<=",i.EQUAL_OR_GREATER_THAN=">=",i.GREATER_THAN=">",i.DIFFERENT="!=",i))(Kg||{}),L9=["==","<","<=",">=",">","!="],Jre={["=="]:(i,e)=>i==e,["<"]:(i,e)=>i<e,["<="]:(i,e)=>i<=e,[">="]:(i,e)=>i>=e,[">"]:(i,e)=>i>e,["!="]:(i,e)=>i!=e},jB=L9.map((i,e)=>({name:i,value:e})),Jg=class{constructor(e){this.node=e}evalForEntities(e){let t=At[this.node.pv.attribType];switch(t){case Ue.NUMERIC:{this._eval_for_numeric(e);return}case Ue.STRING:{this._eval_for_string(e);return}}Be.unreachable(t)}_eval_for_string(e){let t;for(let r of e)t=r.stringAttribValue(this.node.pv.attribName),t==this.node.pv.attribString&&this.node.entitySelectionHelper.select(r)}_eval_for_numeric(e){let t=Zw[this.node.pv.attribSize-1];switch(t){case Si.FLOAT:return this._eval_for_points_numeric_float(e);case Si.VECTOR2:return this._eval_for_points_numeric_vector2(e);case Si.VECTOR3:return this._eval_for_points_numeric_vector3(e);case Si.VECTOR4:return this._eval_for_points_numeric_vector4(e)}Be.unreachable(t)}_eval_for_points_numeric_float(e){let t=this.node.pv.attribName,r=this.node.pv.attribValue1,o,n=L9[this.node.pv.attribComparisonOperator],s=Jre[n];for(let a of e)o=a.attribValue(t),s(o,r)&&this.node.entitySelectionHelper.select(a)}_eval_for_points_numeric_vector2(e){let t=this.node.pv.attribName,r=this.node.pv.attribValue2,o=new G;for(let n of e){let s=n.attribValue(t,o);r.equals(s)&&this.node.entitySelectionHelper.select(n)}}_eval_for_points_numeric_vector3(e){let t=this.node.pv.attribName,r=this.node.pv.attribValue3,o=new w;for(let n of e){let s=n.attribValue(t,o);r.equals(s)&&this.node.entitySelectionHelper.select(n)}}_eval_for_points_numeric_vector4(e){let t=this.node.pv.attribName,r=this.node.pv.attribValue4,o=new Ie;for(let n of e){let s=n.attribValue(t,o);r.equals(s)&&this.node.entitySelectionHelper.select(n)}}};var Zg=class{constructor(e){this.node=e}async evalForEntities(e){let t=this.node.p.expression;this.node.p.expression.hasExpression()&&t.expressionController?await this.eval_expressions_for_points_with_expression(e):this.eval_expressions_without_expression(e)}async eval_expressions_for_points_with_expression(e){let t=this.node.p.expression;t.expressionController&&await t.expressionController.computeExpressionForEntities(e,(r,o)=>{o&&this.node.entitySelectionHelper.select(r)})}eval_expressions_without_expression(e){if(this.node.pv.expression)for(let r of e)this.node.entitySelectionHelper.select(r)}};var Qg=class{constructor(e){this.node=e,this._point_position=new w}evalForPoints(e){let t=this._createBbox();for(let r of e)t.containsPoint(r.getPosition(this._point_position))&&this.node.entitySelectionHelper.select(r)}_createBbox(){return new Bl(this.node.pv.bboxCenter.clone().sub(this.node.pv.bboxSize.clone().multiplyScalar(.5)),this.node.pv.bboxCenter.clone().add(this.node.pv.bboxSize.clone().multiplyScalar(.5)))}};var ev=class{constructor(e){this.node=e}eval_for_objects(e){let t=H0[this.node.pv.objectType];for(let r of e){let o=r.object();Zi(o.constructor)==t&&this.node.entitySelectionHelper.select(r)}}};var tv=class{constructor(){this._sidePropertyByMaterial=new WeakMap,this._bound_setMat=this._setObjectMaterialDoubleSided.bind(this),this._bound_restoreMat=this._restoreObjectMaterialSide.bind(this)}setCoreGroupMaterialDoubleSided(e){let t=e.objects();for(let r of t)r.traverse(this._bound_setMat)}restoreMaterialSideProperty(e){let t=e.objects();for(let r of t)r.traverse(this._bound_restoreMat)}_setObjectMaterialDoubleSided(e){let t=e.material;if(t)if(K.isArray(t))for(let r of t)this._setMaterialDoubleSided(r);else this._setMaterialDoubleSided(t)}_restoreObjectMaterialSide(e){let t=e.material;if(t)if(K.isArray(t))for(let r of t)this._restoreMaterialDoubleSided(r);else this._restoreMaterialDoubleSided(t)}_setMaterialDoubleSided(e){this._sidePropertyByMaterial.set(e,e.side),e.side=uo}_restoreMaterialDoubleSided(e){e.side=this._sidePropertyByMaterial.get(e)||uo}};var Zre=new w(0,1,0),Qre=new w(0,-1,0),rv=class{constructor(e){this.node=e,this._matDoubleSideTmpSetter=new tv,this._point_position=new w,this._raycaster=new tf,this._intersections=[]}evalForPoints(e,t){if(!t)return;let r=t==null?void 0:t.objectsWithGeo()[0];if(!r)return;let o=r;if(!o.isMesh)return;this._matDoubleSideTmpSetter.setCoreGroupMaterialDoubleSided(t);let n=r.geometry;n.computeBoundingBox();let s=n.boundingBox;for(let a of e)a.getPosition(this._point_position),s.containsPoint(this._point_position)?this._isPositionInObject(this._point_position,o,Zre)&&this._isPositionInObject(this._point_position,o,Qre)&&this.node.entitySelectionHelper.select(a):this.node.entitySelectionHelper.select(a);this._matDoubleSideTmpSetter.restoreMaterialSideProperty(t)}_isPositionInObject(e,t,r){var o;this._raycaster.ray.direction.copy(r),this._raycaster.ray.origin.copy(e),this._intersections.length=0;let n=this._raycaster.intersectObject(t,!1,this._intersections);if(!n||n.length==0)return!1;let a=(o=n[0].face)==null?void 0:o.normal;return a?this._raycaster.ray.direction.dot(a)>=0:!1}};var WB=class extends V{constructor(){super(...arguments);this.class=v.INTEGER(Lo.indexOf(jr.VERTEX),{menu:{entries:h1}}),this.invert=v.BOOLEAN(0),this.byObjectType=v.BOOLEAN(0,{visibleIf:{class:Lo.indexOf(jr.OBJECT)}}),this.objectType=v.INTEGER(H0.indexOf($t.MESH),{menu:{entries:Jw},visibleIf:{class:Lo.indexOf(jr.OBJECT),byObjectType:!0},separatorAfter:!0}),this.byExpression=v.BOOLEAN(0),this.expression=v.BOOLEAN("@ptnum==0",{visibleIf:{byExpression:!0},expression:{forEntities:!0},separatorAfter:!0}),this.byAttrib=v.BOOLEAN(0),this.attribType=v.INTEGER(At.indexOf(Ue.NUMERIC),{menu:{entries:j0},visibleIf:{byAttrib:1}}),this.attribName=v.STRING("",{visibleIf:{byAttrib:1}}),this.attribSize=v.INTEGER(1,{range:Qw,rangeLocked:[!0,!0],visibleIf:{byAttrib:1,attribType:At.indexOf(Ue.NUMERIC)}}),this.attribComparisonOperator=v.INTEGER(L9.indexOf(Kg.EQUAL),{menu:{entries:jB},visibleIf:{byAttrib:!0,attribType:At.indexOf(Ue.NUMERIC),attribSize:Si.FLOAT}}),this.attribValue1=v.FLOAT(0,{visibleIf:{byAttrib:1,attribType:At.indexOf(Ue.NUMERIC),attribSize:1}}),this.attribValue2=v.VECTOR2([0,0],{visibleIf:{byAttrib:1,attribType:At.indexOf(Ue.NUMERIC),attribSize:2}}),this.attribValue3=v.VECTOR3([0,0,0],{visibleIf:{byAttrib:1,attribType:At.indexOf(Ue.NUMERIC),attribSize:3}}),this.attribValue4=v.VECTOR4([0,0,0,0],{visibleIf:{byAttrib:1,attribType:At.indexOf(Ue.NUMERIC),attribSize:4}}),this.attribString=v.STRING("",{visibleIf:{byAttrib:1,attribType:At.indexOf(Ue.STRING)},separatorAfter:!0}),this.byBbox=v.BOOLEAN(0,{visibleIf:{class:Lo.indexOf(jr.VERTEX)}}),this.bboxSize=v.VECTOR3([1,1,1],{visibleIf:{class:Lo.indexOf(jr.VERTEX),byBbox:!0}}),this.bboxCenter=v.VECTOR3([0,0,0],{visibleIf:{class:Lo.indexOf(jr.VERTEX),byBbox:!0},separatorAfter:!0}),this.byBoundingObject=v.BOOLEAN(0,{visibleIf:{class:Lo.indexOf(jr.VERTEX)}}),this.keepPoints=v.BOOLEAN(0,{visibleIf:{class:Lo.indexOf(jr.OBJECT)}})}},eoe=new WB,ov=class extends et{constructor(){super(...arguments);this.paramsConfig=eoe,this._marked_for_deletion_per_object_index=new Map,this.entitySelectionHelper=new $g(this),this.byExpressionHelper=new Zg(this),this.byAttributeHelper=new Jg(this),this.byObjectTypeHelper=new ev(this),this.byBboxHelper=new Qg(this),this.byBoundingObjectHelper=new rv(this)}static type(){return"delete"}static displayedInputNames(){return["geometry to delete from","points inside this geometry will be deleted (optional)"]}initializeNode(){this.io.inputs.setCount(1,2),this.io.inputs.initInputsClonedState(Ge.FROM_NODE)}async cook(e){let t=e[0],r=e[1];switch(this.pv.class){case jr.VERTEX:await this._eval_for_points(t,r);break;case jr.OBJECT:await this._eval_for_objects(t);break}}setAttribClass(e){this.p.class.set(e)}async _eval_for_objects(e){let t=e.coreObjects();this.entitySelectionHelper.init(t),this._marked_for_deletion_per_object_index=new Map;for(let n of t)this._marked_for_deletion_per_object_index.set(n.index(),!1);this.pv.byExpression&&await this.byExpressionHelper.evalForEntities(t),this.pv.byObjectType&&this.byObjectTypeHelper.eval_for_objects(t),this.pv.byAttrib&&this.pv.attribName!=""&&this.byAttributeHelper.evalForEntities(t);let o=this.entitySelectionHelper.entities_to_keep().map(n=>n.object());if(this.pv.keepPoints){let n=this.entitySelectionHelper.entities_to_delete();for(let s of n){let a=this._point_object(s);a&&o.push(a)}}this.setObjects(o)}async _eval_for_points(e,t){let r=e.coreObjects(),o,n=[];for(let s=0;s<r.length;s++){o=r[s];let a=o.coreGeometry();if(a){let c=o.object(),l=a.pointsFromGeometry();this.entitySelectionHelper.init(l);let u=l.length;this.pv.byExpression&&await this.byExpressionHelper.evalForEntities(l),this.pv.byAttrib&&this.pv.attribName!=""&&this.byAttributeHelper.evalForEntities(l),this.pv.byBbox&&this.byBboxHelper.evalForPoints(l),this.pv.byBoundingObject&&this.byBoundingObjectHelper.evalForPoints(l,t);let p=this.entitySelectionHelper.entities_to_keep();if(p.length==u)n.push(c);else if(a.geometry().dispose(),p.length>0){let h=Ut.geometryFromPoints(p,Zi(c.constructor));h&&(c.geometry=h,n.push(c))}}}this.setObjects(n)}_point_object(e){let t=e.points(),r=Ut.geometryFromPoints(t,$t.POINTS);if(r)return this.createObject(r,$t.POINTS)}};var iv=class extends S0{constructor(){super(...arguments);this._childrenControllerContext=oe.EVENT}static type(){return Ro.EVENT}createNode(e,t){return super.createNode(e,t)}children(){return super.children()}nodesByType(e){return super.nodesByType(e)}};var qB=new Ve,XB=new Ve,I9=[],Vf=new lt,D9=class extends lt{constructor(e,t,r){super(e,t);this.instanceMatrix=new Xr(new Float32Array(r*16),16),this.instanceColor=null,this.count=r,this.frustumCulled=!1}copy(e){return super.copy(e),this.instanceMatrix.copy(e.instanceMatrix),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,this}getColorAt(e,t){t.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,e*16)}raycast(e,t){let r=this.matrixWorld,o=this.count;if(Vf.geometry=this.geometry,Vf.material=this.material,Vf.material!==void 0)for(let n=0;n<o;n++){this.getMatrixAt(n,qB),XB.multiplyMatrices(r,qB),Vf.matrixWorld=XB,Vf.raycast(e,I9);for(let s=0,a=I9.length;s<a;s++){let c=I9[s];c.instanceId=n,c.object=this,t.push(c)}I9.length=0}}setColorAt(e,t){this.instanceColor===null&&(this.instanceColor=new Xr(new Float32Array(this.instanceMatrix.count*3),3)),t.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,e*16)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}};D9.prototype.isInstancedMesh=!0;var zp,Gf=new w,Hp=new w,jp=new w,Wp=new G,zf=new G,KB=new Ve,k9=new w,Hf=new w,B9=new w,YB=new G,nv=new G,$B=new G,U9=class extends vt{constructor(e){super();if(this.type="Sprite",zp===void 0){zp=new De;let t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),r=new Zs(t,5);zp.setIndex([0,1,2,0,2,3]),zp.setAttribute("position",new wi(r,3,0,!1)),zp.setAttribute("uv",new wi(r,2,3,!1))}this.geometry=zp,this.material=e!==void 0?e:new Rp,this.center=new G(.5,.5)}raycast(e,t){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Hp.setFromMatrixScale(this.matrixWorld),KB.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),jp.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&Hp.multiplyScalar(-jp.z);let r=this.material.rotation,o,n;r!==0&&(n=Math.cos(r),o=Math.sin(r));let s=this.center;F9(k9.set(-.5,-.5,0),jp,s,Hp,o,n),F9(Hf.set(.5,-.5,0),jp,s,Hp,o,n),F9(B9.set(.5,.5,0),jp,s,Hp,o,n),YB.set(0,0),nv.set(1,0),$B.set(1,1);let a=e.ray.intersectTriangle(k9,Hf,B9,!1,Gf);if(a===null&&(F9(Hf.set(-.5,.5,0),jp,s,Hp,o,n),nv.set(0,1),a=e.ray.intersectTriangle(k9,B9,Hf,!1,Gf),a===null))return;let c=e.ray.origin.distanceTo(Gf);c<e.near||c>e.far||t.push({distance:c,point:Gf.clone(),uv:as.getUV(Gf,k9,Hf,B9,YB,nv,$B,new G),face:null,object:this})}copy(e){return super.copy(e),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}};U9.prototype.isSprite=!0;function F9(i,e,t,r,o,n){Wp.subVectors(i,t).addScalar(.5).multiply(r),o!==void 0?(zf.x=n*Wp.x-o*Wp.y,zf.y=o*Wp.x+n*Wp.y):zf.copy(Wp),i.copy(e),i.x+=zf.x,i.y+=zf.y,i.applyMatrix4(KB)}var qp=class extends cs{constructor(e,t){super(e,t);this.type="LineLoop"}};qp.prototype.isLineLoop=!0;var JB=new Ve,toe=new Ve,ul=class{constructor(e=[],t=[]){this.uuid=qi(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){let e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),t.length===0)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let r=0,o=this.bones.length;r<o;r++)this.boneInverses.push(new Ve)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){let r=new Ve;this.bones[e]&&r.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(r)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){let r=this.bones[e];r&&r.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){let r=this.bones[e];r&&(r.parent&&r.parent.isBone?(r.matrix.copy(r.parent.matrixWorld).invert(),r.matrix.multiply(r.matrixWorld)):r.matrix.copy(r.matrixWorld),r.matrix.decompose(r.position,r.quaternion,r.scale))}}update(){let e=this.bones,t=this.boneInverses,r=this.boneMatrices,o=this.boneTexture;for(let n=0,s=e.length;n<s;n++){let a=e[n]?e[n].matrixWorld:toe;JB.multiplyMatrices(a,t[n]),JB.toArray(r,n*16)}o!==null&&(o.needsUpdate=!0)}clone(){return new ul(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=qx(e),e=Math.max(e,4);let t=new Float32Array(e*e*4);t.set(this.boneMatrices);let r=new Mr(t,e,e,st,Wt);return r.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=r,this.boneTextureSize=e,this}getBoneByName(e){for(let t=0,r=this.bones.length;t<r;t++){let o=this.bones[t];if(o.name===e)return o}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let r=0,o=e.bones.length;r<o;r++){let n=e.bones[r],s=t[n];s===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",n),s=new fs),this.bones.push(s),this.boneInverses.push(new Ve().fromArray(e.boneInverses[r]))}return this.init(),this}toJSON(){let e={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;let t=this.bones,r=this.boneInverses;for(let o=0,n=t.length;o<n;o++){let s=t[o];e.bones.push(s.uuid);let a=r[o];e.boneInverses.push(a.toArray())}return e}};var kr=class{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){let r=this.getUtoTmapping(e);return this.getPoint(r,t)}getPoints(e=5){let t=[];for(let r=0;r<=e;r++)t.push(this.getPoint(r/e));return t}getSpacedPoints(e=5){let t=[];for(let r=0;r<=e;r++)t.push(this.getPointAt(r/e));return t}getLength(){let e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;let t=[],r,o=this.getPoint(0),n=0;t.push(0);for(let s=1;s<=e;s++)r=this.getPoint(s/e),n+=r.distanceTo(o),t.push(n),o=r;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){let r=this.getLengths(),o=0,n=r.length,s;t?s=t:s=e*r[n-1];let a=0,c=n-1,l;for(;a<=c;)if(o=Math.floor(a+(c-a)/2),l=r[o]-s,l<0)a=o+1;else if(l>0)c=o-1;else{c=o;break}if(o=c,r[o]===s)return o/(n-1);let u=r[o],h=r[o+1]-u,d=(s-u)/h;return(o+d)/(n-1)}getTangent(e,t){let o=e-1e-4,n=e+1e-4;o<0&&(o=0),n>1&&(n=1);let s=this.getPoint(o),a=this.getPoint(n),c=t||(s.isVector2?new G:new w);return c.copy(a).sub(s).normalize(),c}getTangentAt(e,t){let r=this.getUtoTmapping(e);return this.getTangent(r,t)}computeFrenetFrames(e,t){let r=new w,o=[],n=[],s=[],a=new w,c=new Ve;for(let d=0;d<=e;d++){let m=d/e;o[d]=this.getTangentAt(m,new w)}n[0]=new w,s[0]=new w;let l=Number.MAX_VALUE,u=Math.abs(o[0].x),p=Math.abs(o[0].y),h=Math.abs(o[0].z);u<=l&&(l=u,r.set(1,0,0)),p<=l&&(l=p,r.set(0,1,0)),h<=l&&r.set(0,0,1),a.crossVectors(o[0],r).normalize(),n[0].crossVectors(o[0],a),s[0].crossVectors(o[0],n[0]);for(let d=1;d<=e;d++){if(n[d]=n[d-1].clone(),s[d]=s[d-1].clone(),a.crossVectors(o[d-1],o[d]),a.length()>Number.EPSILON){a.normalize();let m=Math.acos(qs(o[d-1].dot(o[d]),-1,1));n[d].applyMatrix4(c.makeRotationAxis(a,m))}s[d].crossVectors(o[d],n[d])}if(t===!0){let d=Math.acos(qs(n[0].dot(n[e]),-1,1));d/=e,o[0].dot(a.crossVectors(n[0],n[e]))>0&&(d=-d);for(let m=1;m<=e;m++)n[m].applyMatrix4(c.makeRotationAxis(o[m],d*m)),s[m].crossVectors(o[m],n[m])}return{tangents:o,normals:n,binormals:s}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){let e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}};var dl={};S2(dl,{ArcCurve:()=>V9,CatmullRomCurve3:()=>z9,CubicBezierCurve:()=>Xp,CubicBezierCurve3:()=>H9,EllipseCurve:()=>Ia,LineCurve:()=>Da,LineCurve3:()=>pv,QuadraticBezierCurve:()=>Yp,QuadraticBezierCurve3:()=>$p,SplineCurve:()=>Kp});var Ia=class extends kr{constructor(e=0,t=0,r=1,o=1,n=0,s=Math.PI*2,a=!1,c=0){super();this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=r,this.yRadius=o,this.aStartAngle=n,this.aEndAngle=s,this.aClockwise=a,this.aRotation=c}getPoint(e,t){let r=t||new G,o=Math.PI*2,n=this.aEndAngle-this.aStartAngle,s=Math.abs(n)<Number.EPSILON;for(;n<0;)n+=o;for(;n>o;)n-=o;n<Number.EPSILON&&(s?n=0:n=o),this.aClockwise===!0&&!s&&(n===o?n=-o:n=n-o);let a=this.aStartAngle+e*n,c=this.aX+this.xRadius*Math.cos(a),l=this.aY+this.yRadius*Math.sin(a);if(this.aRotation!==0){let u=Math.cos(this.aRotation),p=Math.sin(this.aRotation),h=c-this.aX,d=l-this.aY;c=h*u-d*p+this.aX,l=h*p+d*u+this.aY}return r.set(c,l)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){let e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}};Ia.prototype.isEllipseCurve=!0;var V9=class extends Ia{constructor(e,t,r,o,n,s){super(e,t,r,r,o,n,s);this.type="ArcCurve"}};V9.prototype.isArcCurve=!0;function lv(){let i=0,e=0,t=0,r=0;function o(n,s,a,c){i=n,e=a,t=-3*n+3*s-2*a-c,r=2*n-2*s+a+c}return{initCatmullRom:function(n,s,a,c,l){o(s,a,l*(a-n),l*(c-s))},initNonuniformCatmullRom:function(n,s,a,c,l,u,p){let h=(s-n)/l-(a-n)/(l+u)+(a-s)/u,d=(a-s)/u-(c-s)/(u+p)+(c-a)/p;h*=u,d*=u,o(s,a,h,d)},calc:function(n){let s=n*n,a=s*n;return i+e*n+t*s+r*a}}}var G9=new w,sv=new lv,av=new lv,cv=new lv,z9=class extends kr{constructor(e=[],t=!1,r="centripetal",o=.5){super();this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=r,this.tension=o}getPoint(e,t=new w){let r=t,o=this.points,n=o.length,s=(n-(this.closed?0:1))*e,a=Math.floor(s),c=s-a;this.closed?a+=a>0?0:(Math.floor(Math.abs(a)/n)+1)*n:c===0&&a===n-1&&(a=n-2,c=1);let l,u;this.closed||a>0?l=o[(a-1)%n]:(G9.subVectors(o[0],o[1]).add(o[0]),l=G9);let p=o[a%n],h=o[(a+1)%n];if(this.closed||a+2<n?u=o[(a+2)%n]:(G9.subVectors(o[n-1],o[n-2]).add(o[n-1]),u=G9),this.curveType==="centripetal"||this.curveType==="chordal"){let d=this.curveType==="chordal"?.5:.25,m=Math.pow(l.distanceToSquared(p),d),f=Math.pow(p.distanceToSquared(h),d),x=Math.pow(h.distanceToSquared(u),d);f<1e-4&&(f=1),m<1e-4&&(m=f),x<1e-4&&(x=f),sv.initNonuniformCatmullRom(l.x,p.x,h.x,u.x,m,f,x),av.initNonuniformCatmullRom(l.y,p.y,h.y,u.y,m,f,x),cv.initNonuniformCatmullRom(l.z,p.z,h.z,u.z,m,f,x)}else this.curveType==="catmullrom"&&(sv.initCatmullRom(l.x,p.x,h.x,u.x,this.tension),av.initCatmullRom(l.y,p.y,h.y,u.y,this.tension),cv.initCatmullRom(l.z,p.z,h.z,u.z,this.tension));return r.set(sv.calc(c),av.calc(c),cv.calc(c)),r}copy(e){super.copy(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){let o=e.points[t];this.points.push(o.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){let e=super.toJSON();e.points=[];for(let t=0,r=this.points.length;t<r;t++){let o=this.points[t];e.points.push(o.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){let o=e.points[t];this.points.push(new w().fromArray(o))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}};z9.prototype.isCatmullRomCurve3=!0;function uv(i,e,t,r,o){let n=(r-e)*.5,s=(o-t)*.5,a=i*i,c=i*a;return(2*t-2*r+n+s)*c+(-3*t+3*r-2*n-s)*a+n*i+t}function roe(i,e){let t=1-i;return t*t*e}function ooe(i,e){return 2*(1-i)*i*e}function ioe(i,e){return i*i*e}function pl(i,e,t,r){return roe(i,e)+ooe(i,t)+ioe(i,r)}function noe(i,e){let t=1-i;return t*t*t*e}function soe(i,e){let t=1-i;return 3*t*t*i*e}function aoe(i,e){return 3*(1-i)*i*i*e}function coe(i,e){return i*i*i*e}function hl(i,e,t,r,o){return noe(i,e)+soe(i,t)+aoe(i,r)+coe(i,o)}var Xp=class extends kr{constructor(e=new G,t=new G,r=new G,o=new G){super();this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=r,this.v3=o}getPoint(e,t=new G){let r=t,o=this.v0,n=this.v1,s=this.v2,a=this.v3;return r.set(hl(e,o.x,n.x,s.x,a.x),hl(e,o.y,n.y,s.y,a.y)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}};Xp.prototype.isCubicBezierCurve=!0;var H9=class extends kr{constructor(e=new w,t=new w,r=new w,o=new w){super();this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=r,this.v3=o}getPoint(e,t=new w){let r=t,o=this.v0,n=this.v1,s=this.v2,a=this.v3;return r.set(hl(e,o.x,n.x,s.x,a.x),hl(e,o.y,n.y,s.y,a.y),hl(e,o.z,n.z,s.z,a.z)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}};H9.prototype.isCubicBezierCurve3=!0;var Da=class extends kr{constructor(e=new G,t=new G){super();this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new G){let r=t;return e===1?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(e).add(this.v1)),r}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t){let r=t||new G;return r.copy(this.v2).sub(this.v1).normalize(),r}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}};Da.prototype.isLineCurve=!0;var pv=class extends kr{constructor(e=new w,t=new w){super();this.type="LineCurve3",this.isLineCurve3=!0,this.v1=e,this.v2=t}getPoint(e,t=new w){let r=t;return e===1?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(e).add(this.v1)),r}getPointAt(e,t){return this.getPoint(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}};var Yp=class extends kr{constructor(e=new G,t=new G,r=new G){super();this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=r}getPoint(e,t=new G){let r=t,o=this.v0,n=this.v1,s=this.v2;return r.set(pl(e,o.x,n.x,s.x),pl(e,o.y,n.y,s.y)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}};Yp.prototype.isQuadraticBezierCurve=!0;var $p=class extends kr{constructor(e=new w,t=new w,r=new w){super();this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=r}getPoint(e,t=new w){let r=t,o=this.v0,n=this.v1,s=this.v2;return r.set(pl(e,o.x,n.x,s.x),pl(e,o.y,n.y,s.y),pl(e,o.z,n.z,s.z)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}};$p.prototype.isQuadraticBezierCurve3=!0;var Kp=class extends kr{constructor(e=[]){super();this.type="SplineCurve",this.points=e}getPoint(e,t=new G){let r=t,o=this.points,n=(o.length-1)*e,s=Math.floor(n),a=n-s,c=o[s===0?s:s-1],l=o[s],u=o[s>o.length-2?o.length-1:s+1],p=o[s>o.length-3?o.length-1:s+2];return r.set(uv(a,c.x,l.x,u.x,p.x),uv(a,c.y,l.y,u.y,p.y)),r}copy(e){super.copy(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){let o=e.points[t];this.points.push(o.clone())}return this}toJSON(){let e=super.toJSON();e.points=[];for(let t=0,r=this.points.length;t<r;t++){let o=this.points[t];e.points.push(o.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){let o=e.points[t];this.points.push(new G().fromArray(o))}return this}};Kp.prototype.isSplineCurve=!0;var hv=class extends kr{constructor(){super();this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){let e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new Da(t,e))}getPoint(e,t){let r=e*this.getLength(),o=this.getCurveLengths(),n=0;for(;n<o.length;){if(o[n]>=r){let s=o[n]-r,a=this.curves[n],c=a.getLength(),l=c===0?0:1-s/c;return a.getPointAt(l,t)}n++}return null}getLength(){let e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;let e=[],t=0;for(let r=0,o=this.curves.length;r<o;r++)t+=this.curves[r].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){let t=[];for(let r=0;r<=e;r++)t.push(this.getPoint(r/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){let t=[],r;for(let o=0,n=this.curves;o<n.length;o++){let s=n[o],a=s&&s.isEllipseCurve?e*2:s&&(s.isLineCurve||s.isLineCurve3)?1:s&&s.isSplineCurve?e*s.points.length:e,c=s.getPoints(a);for(let l=0;l<c.length;l++){let u=c[l];r&&r.equals(u)||(t.push(u),r=u)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,r=e.curves.length;t<r;t++){let o=e.curves[t];this.curves.push(o.clone())}return this.autoClose=e.autoClose,this}toJSON(){let e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,r=this.curves.length;t<r;t++){let o=this.curves[t];e.curves.push(o.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,r=e.curves.length;t<r;t++){let o=e.curves[t];this.curves.push(new dl[o.type]().fromJSON(o))}return this}};var j9=class extends hv{constructor(e){super();this.type="Path",this.currentPoint=new G,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,r=e.length;t<r;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){let r=new Da(this.currentPoint.clone(),new G(e,t));return this.curves.push(r),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,r,o){let n=new Yp(this.currentPoint.clone(),new G(e,t),new G(r,o));return this.curves.push(n),this.currentPoint.set(r,o),this}bezierCurveTo(e,t,r,o,n,s){let a=new Xp(this.currentPoint.clone(),new G(e,t),new G(r,o),new G(n,s));return this.curves.push(a),this.currentPoint.set(n,s),this}splineThru(e){let t=[this.currentPoint.clone()].concat(e),r=new Kp(t);return this.curves.push(r),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,r,o,n,s){let a=this.currentPoint.x,c=this.currentPoint.y;return this.absarc(e+a,t+c,r,o,n,s),this}absarc(e,t,r,o,n,s){return this.absellipse(e,t,r,r,o,n,s),this}ellipse(e,t,r,o,n,s,a,c){let l=this.currentPoint.x,u=this.currentPoint.y;return this.absellipse(e+l,t+u,r,o,n,s,a,c),this}absellipse(e,t,r,o,n,s,a,c){let l=new Ia(e,t,r,o,n,s,a,c);if(this.curves.length>0){let p=l.getPoint(0);p.equals(this.currentPoint)||this.lineTo(p.x,p.y)}this.curves.push(l);let u=l.getPoint(1);return this.currentPoint.copy(u),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){let e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}};var fl=class extends j9{constructor(e){super(e);this.uuid=qi(),this.type="Shape",this.holes=[]}getPointsHoles(e){let t=[];for(let r=0,o=this.holes.length;r<o;r++)t[r]=this.holes[r].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,r=e.holes.length;t<r;t++){let o=e.holes[t];this.holes.push(o.clone())}return this}toJSON(){let e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,r=this.holes.length;t<r;t++){let o=this.holes[t];e.holes.push(o.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,r=e.holes.length;t<r;t++){let o=e.holes[t];this.holes.push(new j9().fromJSON(o))}return this}};var ZB=new Ve,jf=new w,dv=new w,W9=class extends sl{constructor(){super(new ir(90,1,.5,500));this._frameExtents=new G(4,2),this._viewportCount=6,this._viewports=[new Ie(2,1,1,1),new Ie(0,1,1,1),new Ie(3,1,1,1),new Ie(1,1,1,1),new Ie(3,0,1,1),new Ie(1,0,1,1)],this._cubeDirections=[new w(1,0,0),new w(-1,0,0),new w(0,0,1),new w(0,0,-1),new w(0,1,0),new w(0,-1,0)],this._cubeUps=[new w(0,1,0),new w(0,1,0),new w(0,1,0),new w(0,1,0),new w(0,0,1),new w(0,0,-1)]}updateMatrices(e,t=0){let r=this.camera,o=this.matrix,n=e.distance||r.far;n!==r.far&&(r.far=n,r.updateProjectionMatrix()),jf.setFromMatrixPosition(e.matrixWorld),r.position.copy(jf),dv.copy(r.position),dv.add(this._cubeDirections[t]),r.up.copy(this._cubeUps[t]),r.lookAt(dv),r.updateMatrixWorld(),o.makeTranslation(-jf.x,-jf.y,-jf.z),ZB.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),this._frustum.setFromProjectionMatrix(ZB)}};W9.prototype.isPointLightShadow=!0;var Jp=class extends Eo{constructor(e,t,r=0,o=1){super(e,t);this.type="PointLight",this.distance=r,this.decay=o,this.shadow=new W9}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}};Jp.prototype.isPointLight=!0;var q9=class extends sl{constructor(){super(new ps(-5,5,5,-5,.5,500))}};q9.prototype.isDirectionalLightShadow=!0;var Zp=class extends Eo{constructor(e,t){super(e,t);this.type="DirectionalLight",this.position.copy(vt.DefaultUp),this.updateMatrix(),this.target=new vt,this.shadow=new q9}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}};Zp.prototype.isDirectionalLight=!0;var X9=class extends Eo{constructor(e,t){super(e,t);this.type="AmbientLight"}};X9.prototype.isAmbientLight=!0;var Y9=class{constructor(){this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new w)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){let r=e.x,o=e.y,n=e.z,s=this.coefficients;return t.copy(s[0]).multiplyScalar(.282095),t.addScaledVector(s[1],.488603*o),t.addScaledVector(s[2],.488603*n),t.addScaledVector(s[3],.488603*r),t.addScaledVector(s[4],1.092548*(r*o)),t.addScaledVector(s[5],1.092548*(o*n)),t.addScaledVector(s[6],.315392*(3*n*n-1)),t.addScaledVector(s[7],1.092548*(r*n)),t.addScaledVector(s[8],.546274*(r*r-o*o)),t}getIrradianceAt(e,t){let r=e.x,o=e.y,n=e.z,s=this.coefficients;return t.copy(s[0]).multiplyScalar(.886227),t.addScaledVector(s[1],2*.511664*o),t.addScaledVector(s[2],2*.511664*n),t.addScaledVector(s[3],2*.511664*r),t.addScaledVector(s[4],2*.429043*r*o),t.addScaledVector(s[5],2*.429043*o*n),t.addScaledVector(s[6],.743125*n*n-.247708),t.addScaledVector(s[7],2*.429043*r*n),t.addScaledVector(s[8],.429043*(r*r-o*o)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let r=0;r<9;r++)this.coefficients[r].addScaledVector(e.coefficients[r],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let r=0;r<9;r++)this.coefficients[r].lerp(e.coefficients[r],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,t=0){let r=this.coefficients;for(let o=0;o<9;o++)r[o].fromArray(e,t+o*3);return this}toArray(e=[],t=0){let r=this.coefficients;for(let o=0;o<9;o++)r[o].toArray(e,t+o*3);return e}static getBasisAt(e,t){let r=e.x,o=e.y,n=e.z;t[0]=.282095,t[1]=.488603*o,t[2]=.488603*n,t[3]=.488603*r,t[4]=1.092548*r*o,t[5]=1.092548*o*n,t[6]=.315392*(3*n*n-1),t[7]=1.092548*r*n,t[8]=.546274*(r*r-o*o)}};Y9.prototype.isSphericalHarmonics3=!0;var $9=class extends Eo{constructor(e=new Y9,t=1){super(void 0,t);this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){let t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}};$9.prototype.isLightProbe=!0;var lr={arraySlice:function(i,e,t){return lr.isTypedArray(i)?new i.constructor(i.subarray(e,t!==void 0?t:i.length)):i.slice(e,t)},convertArray:function(i,e,t){return!i||!t&&i.constructor===e?i:typeof e.BYTES_PER_ELEMENT=="number"?new e(i):Array.prototype.slice.call(i)},isTypedArray:function(i){return ArrayBuffer.isView(i)&&!(i instanceof DataView)},getKeyframeOrder:function(i){function e(o,n){return i[o]-i[n]}let t=i.length,r=new Array(t);for(let o=0;o!==t;++o)r[o]=o;return r.sort(e),r},sortedArray:function(i,e,t){let r=i.length,o=new i.constructor(r);for(let n=0,s=0;s!==r;++n){let a=t[n]*e;for(let c=0;c!==e;++c)o[s++]=i[a+c]}return o},flattenJSON:function(i,e,t,r){let o=1,n=i[0];for(;n!==void 0&&n[r]===void 0;)n=i[o++];if(n===void 0)return;let s=n[r];if(s!==void 0)if(Array.isArray(s))do s=n[r],s!==void 0&&(e.push(n.time),t.push.apply(t,s)),n=i[o++];while(n!==void 0);else if(s.toArray!==void 0)do s=n[r],s!==void 0&&(e.push(n.time),s.toArray(t,t.length)),n=i[o++];while(n!==void 0);else do s=n[r],s!==void 0&&(e.push(n.time),t.push(s)),n=i[o++];while(n!==void 0)},subclip:function(i,e,t,r,o=30){let n=i.clone();n.name=e;let s=[];for(let c=0;c<n.tracks.length;++c){let l=n.tracks[c],u=l.getValueSize(),p=[],h=[];for(let d=0;d<l.times.length;++d){let m=l.times[d]*o;if(!(m<t||m>=r)){p.push(l.times[d]);for(let f=0;f<u;++f)h.push(l.values[d*u+f])}}p.length!==0&&(l.times=lr.convertArray(p,l.times.constructor),l.values=lr.convertArray(h,l.values.constructor),s.push(l))}n.tracks=s;let a=1/0;for(let c=0;c<n.tracks.length;++c)a>n.tracks[c].times[0]&&(a=n.tracks[c].times[0]);for(let c=0;c<n.tracks.length;++c)n.tracks[c].shift(-1*a);return n.resetDuration(),n},makeClipAdditive:function(i,e=0,t=i,r=30){r<=0&&(r=30);let o=t.tracks.length,n=e/r;for(let s=0;s<o;++s){let a=t.tracks[s],c=a.ValueTypeName;if(c==="bool"||c==="string")continue;let l=i.tracks.find(function(_){return _.name===a.name&&_.ValueTypeName===c});if(l===void 0)continue;let u=0,p=a.getValueSize();a.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(u=p/3);let h=0,d=l.getValueSize();l.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(h=d/3);let m=a.times.length-1,f;if(n<=a.times[0]){let _=u,g=p-u;f=lr.arraySlice(a.values,_,g)}else if(n>=a.times[m]){let _=m*p+u,g=_+p-u;f=lr.arraySlice(a.values,_,g)}else{let _=a.createInterpolant(),g=u,T=p-u;_.evaluate(n),f=lr.arraySlice(_.resultBuffer,g,T)}c==="quaternion"&&new Nt().fromArray(f).normalize().conjugate().toArray(f);let x=l.times.length;for(let _=0;_<x;++_){let g=_*d+h;if(c==="quaternion")Nt.multiplyQuaternionsFlat(l.values,g,f,0,l.values,g);else{let T=d-h*2;for(let b=0;b<T;++b)l.values[g+b]-=f[b]}}}return i.blendMode=Hx,i}};var fv=class extends Wo{constructor(e,t,r,o){super(e,t,r,o)}interpolate_(e,t,r,o){let n=this.resultBuffer,s=this.sampleValues,a=this.valueSize,c=e*a,l=c-a,u=(r-t)/(o-t),p=1-u;for(let h=0;h!==a;++h)n[h]=s[l+h]*p+s[c+h]*u;return n}};var mv=class extends Wo{constructor(e,t,r,o){super(e,t,r,o)}interpolate_(e){return this.copySampleValue_(e-1)}};var lo=class{constructor(e,t,r,o){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=lr.convertArray(t,this.TimeBufferType),this.values=lr.convertArray(r,this.ValueBufferType),this.setInterpolation(o||this.DefaultInterpolation)}static toJSON(e){let t=e.constructor,r;if(t.toJSON!==this.toJSON)r=t.toJSON(e);else{r={name:e.name,times:lr.convertArray(e.times,Array),values:lr.convertArray(e.values,Array)};let o=e.getInterpolation();o!==e.DefaultInterpolation&&(r.interpolation=o)}return r.type=e.ValueTypeName,r}InterpolantFactoryMethodDiscrete(e){return new mv(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new fv(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new jh(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case js:t=this.InterpolantFactoryMethodDiscrete;break;case Ws:t=this.InterpolantFactoryMethodLinear;break;case Rm:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){let r="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(r);return console.warn("THREE.KeyframeTrack:",r),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return js;case this.InterpolantFactoryMethodLinear:return Ws;case this.InterpolantFactoryMethodSmooth:return Rm}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){let t=this.times;for(let r=0,o=t.length;r!==o;++r)t[r]+=e}return this}scale(e){if(e!==1){let t=this.times;for(let r=0,o=t.length;r!==o;++r)t[r]*=e}return this}trim(e,t){let r=this.times,o=r.length,n=0,s=o-1;for(;n!==o&&r[n]<e;)++n;for(;s!==-1&&r[s]>t;)--s;if(++s,n!==0||s!==o){n>=s&&(s=Math.max(s,1),n=s-1);let a=this.getValueSize();this.times=lr.arraySlice(r,n,s),this.values=lr.arraySlice(this.values,n*a,s*a)}return this}validate(){let e=!0,t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);let r=this.times,o=this.values,n=r.length;n===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let s=null;for(let a=0;a!==n;a++){let c=r[a];if(typeof c=="number"&&isNaN(c)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,c),e=!1;break}if(s!==null&&s>c){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,c,s),e=!1;break}s=c}if(o!==void 0&&lr.isTypedArray(o))for(let a=0,c=o.length;a!==c;++a){let l=o[a];if(isNaN(l)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,l),e=!1;break}}return e}optimize(){let e=lr.arraySlice(this.times),t=lr.arraySlice(this.values),r=this.getValueSize(),o=this.getInterpolation()===Rm,n=e.length-1,s=1;for(let a=1;a<n;++a){let c=!1,l=e[a],u=e[a+1];if(l!==u&&(a!==1||l!==e[0]))if(o)c=!0;else{let p=a*r,h=p-r,d=p+r;for(let m=0;m!==r;++m){let f=t[p+m];if(f!==t[h+m]||f!==t[d+m]){c=!0;break}}}if(c){if(a!==s){e[s]=e[a];let p=a*r,h=s*r;for(let d=0;d!==r;++d)t[h+d]=t[p+d]}++s}}if(n>0){e[s]=e[n];for(let a=n*r,c=s*r,l=0;l!==r;++l)t[c+l]=t[a+l];++s}return s!==e.length?(this.times=lr.arraySlice(e,0,s),this.values=lr.arraySlice(t,0,s*r)):(this.times=e,this.values=t),this}clone(){let e=lr.arraySlice(this.times,0),t=lr.arraySlice(this.values,0),r=this.constructor,o=new r(this.name,e,t);return o.createInterpolant=this.createInterpolant,o}};lo.prototype.TimeBufferType=Float32Array;lo.prototype.ValueBufferType=Float32Array;lo.prototype.DefaultInterpolation=Ws;var ka=class extends lo{};ka.prototype.ValueTypeName="bool";ka.prototype.ValueBufferType=Array;ka.prototype.DefaultInterpolation=js;ka.prototype.InterpolantFactoryMethodLinear=void 0;ka.prototype.InterpolantFactoryMethodSmooth=void 0;var K9=class extends lo{};K9.prototype.ValueTypeName="color";var Ba=class extends lo{};Ba.prototype.ValueTypeName="number";var _v=class extends Wo{constructor(e,t,r,o){super(e,t,r,o)}interpolate_(e,t,r,o){let n=this.resultBuffer,s=this.sampleValues,a=this.valueSize,c=(r-t)/(o-t),l=e*a;for(let u=l+a;l!==u;l+=4)Nt.slerpFlat(n,0,s,l-a,s,l,c);return n}};var Bs=class extends lo{InterpolantFactoryMethodLinear(e){return new _v(this.times,this.values,this.getValueSize(),e)}};Bs.prototype.ValueTypeName="quaternion";Bs.prototype.DefaultInterpolation=Ws;Bs.prototype.InterpolantFactoryMethodSmooth=void 0;var Fa=class extends lo{};Fa.prototype.ValueTypeName="string";Fa.prototype.ValueBufferType=Array;Fa.prototype.DefaultInterpolation=js;Fa.prototype.InterpolantFactoryMethodLinear=void 0;Fa.prototype.InterpolantFactoryMethodSmooth=void 0;var Ua=class extends lo{};Ua.prototype.ValueTypeName="vector";var Wf=class{constructor(e,t=-1,r,o=zx){this.name=e,this.tracks=r,this.duration=t,this.blendMode=o,this.uuid=qi(),this.duration<0&&this.resetDuration()}static parse(e){let t=[],r=e.tracks,o=1/(e.fps||1);for(let s=0,a=r.length;s!==a;++s)t.push(uoe(r[s]).scale(o));let n=new this(e.name,e.duration,t,e.blendMode);return n.uuid=e.uuid,n}static toJSON(e){let t=[],r=e.tracks,o={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let n=0,s=r.length;n!==s;++n)t.push(lo.toJSON(r[n]));return o}static CreateFromMorphTargetSequence(e,t,r,o){let n=t.length,s=[];for(let a=0;a<n;a++){let c=[],l=[];c.push((a+n-1)%n,a,(a+1)%n),l.push(0,1,0);let u=lr.getKeyframeOrder(c);c=lr.sortedArray(c,1,u),l=lr.sortedArray(l,1,u),!o&&c[0]===0&&(c.push(n),l.push(l[0])),s.push(new Ba(".morphTargetInfluences["+t[a].name+"]",c,l).scale(1/r))}return new this(e,-1,s)}static findByName(e,t){let r=e;if(!Array.isArray(e)){let o=e;r=o.geometry&&o.geometry.animations||o.animations}for(let o=0;o<r.length;o++)if(r[o].name===t)return r[o];return null}static CreateClipsFromMorphTargetSequences(e,t,r){let o={},n=/^([\w-]*?)([\d]+)$/;for(let a=0,c=e.length;a<c;a++){let l=e[a],u=l.name.match(n);if(u&&u.length>1){let p=u[1],h=o[p];h||(o[p]=h=[]),h.push(l)}}let s=[];for(let a in o)s.push(this.CreateFromMorphTargetSequence(a,o[a],t,r));return s}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;let r=function(p,h,d,m,f){if(d.length!==0){let x=[],_=[];lr.flattenJSON(d,x,_,m),x.length!==0&&f.push(new p(h,x,_))}},o=[],n=e.name||"default",s=e.fps||30,a=e.blendMode,c=e.length||-1,l=e.hierarchy||[];for(let p=0;p<l.length;p++){let h=l[p].keys;if(!(!h||h.length===0))if(h[0].morphTargets){let d={},m;for(m=0;m<h.length;m++)if(h[m].morphTargets)for(let f=0;f<h[m].morphTargets.length;f++)d[h[m].morphTargets[f]]=-1;for(let f in d){let x=[],_=[];for(let g=0;g!==h[m].morphTargets.length;++g){let T=h[m];x.push(T.time),_.push(T.morphTarget===f?1:0)}o.push(new Ba(".morphTargetInfluence["+f+"]",x,_))}c=d.length*(s||1)}else{let d=".bones["+t[p].name+"]";r(Ua,d+".position",h,"pos",o),r(Bs,d+".quaternion",h,"rot",o),r(Ua,d+".scale",h,"scl",o)}}return o.length===0?null:new this(n,c,o,a)}resetDuration(){let e=this.tracks,t=0;for(let r=0,o=e.length;r!==o;++r){let n=this.tracks[r];t=Math.max(t,n.times[n.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){let e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}};function loe(i){switch(i.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Ba;case"vector":case"vector2":case"vector3":case"vector4":return Ua;case"color":return K9;case"quaternion":return Bs;case"bool":case"boolean":return ka;case"string":return Fa}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+i)}function uoe(i){if(i.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");let e=loe(i.type);if(i.times===void 0){let t=[],r=[];lr.flattenJSON(i.keys,t,r,"value"),i.times=t,i.values=r}return e.parse!==void 0?e.parse(i):new e(i.name,i.times,i.values,i.interpolation)}var gn=class{static decodeText(e){if(typeof TextDecoder<"u")return new TextDecoder().decode(e);let t="";for(let r=0,o=e.length;r<o;r++)t+=String.fromCharCode(e[r]);try{return decodeURIComponent(escape(t))}catch{return t}}static extractUrlBase(e){let t=e.lastIndexOf("/");return t===-1?"./":e.substr(0,t+1)}static resolveURL(e,t){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}};var gv=class extends io{constructor(e){super(e)}load(e,t,r,o){let n=this,s=new Ho(n.manager);s.setPath(n.path),s.setRequestHeader(n.requestHeader),s.setWithCredentials(n.withCredentials),s.load(e,function(a){try{t(n.parse(JSON.parse(a)))}catch(c){o?o(c):console.error(c),n.manager.itemError(e)}},r,o)}parse(e){let t={},r={};function o(d,m){if(t[m]!==void 0)return t[m];let x=d.interleavedBuffers[m],_=n(d,x.buffer),g=I0(x.type,_),T=new Zs(g,x.stride);return T.uuid=x.uuid,t[m]=T,T}function n(d,m){if(r[m]!==void 0)return r[m];let x=d.arrayBuffers[m],_=new Uint32Array(x).buffer;return r[m]=_,_}let s=e.isInstancedBufferGeometry?new Au:new De,a=e.data.index;if(a!==void 0){let d=I0(a.type,a.array);s.setIndex(new Ot(d,1))}let c=e.data.attributes;for(let d in c){let m=c[d],f;if(m.isInterleavedBufferAttribute){let x=o(e.data,m.data);f=new wi(x,m.itemSize,m.offset,m.normalized)}else{let x=I0(m.type,m.array),_=m.isInstancedBufferAttribute?Xr:Ot;f=new _(x,m.itemSize,m.normalized)}m.name!==void 0&&(f.name=m.name),m.usage!==void 0&&f.setUsage(m.usage),m.updateRange!==void 0&&(f.updateRange.offset=m.updateRange.offset,f.updateRange.count=m.updateRange.count),s.setAttribute(d,f)}let l=e.data.morphAttributes;if(l)for(let d in l){let m=l[d],f=[];for(let x=0,_=m.length;x<_;x++){let g=m[x],T;if(g.isInterleavedBufferAttribute){let b=o(e.data,g.data);T=new wi(b,g.itemSize,g.offset,g.normalized)}else{let b=I0(g.type,g.array);T=new Ot(b,g.itemSize,g.normalized)}g.name!==void 0&&(T.name=g.name),f.push(T)}s.morphAttributes[d]=f}e.data.morphTargetsRelative&&(s.morphTargetsRelative=!0);let p=e.data.groups||e.data.drawcalls||e.data.offsets;if(p!==void 0)for(let d=0,m=p.length;d!==m;++d){let f=p[d];s.addGroup(f.start,f.count,f.materialIndex)}let h=e.data.boundingSphere;if(h!==void 0){let d=new w;h.center!==void 0&&d.fromArray(h.center),s.boundingSphere=new Fl(d,h.radius)}return e.name&&(s.name=e.name),e.userData&&(s.userData=e.userData),s}};var d2={};S2(d2,{BoxBufferGeometry:()=>Ti,BoxGeometry:()=>Ti,CircleBufferGeometry:()=>Gp,CircleGeometry:()=>Gp,ConeBufferGeometry:()=>Vp,ConeGeometry:()=>Vp,CylinderBufferGeometry:()=>Up,CylinderGeometry:()=>Up,DodecahedronBufferGeometry:()=>J9,DodecahedronGeometry:()=>J9,EdgesGeometry:()=>QB,ExtrudeBufferGeometry:()=>i2,ExtrudeGeometry:()=>i2,IcosahedronBufferGeometry:()=>eh,IcosahedronGeometry:()=>eh,LatheBufferGeometry:()=>n2,LatheGeometry:()=>n2,OctahedronBufferGeometry:()=>s2,OctahedronGeometry:()=>s2,PlaneBufferGeometry:()=>ls,PlaneGeometry:()=>ls,PolyhedronBufferGeometry:()=>vn,PolyhedronGeometry:()=>vn,RingBufferGeometry:()=>a2,RingGeometry:()=>a2,ShapeBufferGeometry:()=>c2,ShapeGeometry:()=>c2,SphereBufferGeometry:()=>ml,SphereGeometry:()=>ml,TetrahedronBufferGeometry:()=>l2,TetrahedronGeometry:()=>l2,TorusBufferGeometry:()=>u2,TorusGeometry:()=>u2,TorusKnotBufferGeometry:()=>p2,TorusKnotGeometry:()=>p2,TubeBufferGeometry:()=>h2,TubeGeometry:()=>h2,WireframeGeometry:()=>cF});var vn=class extends De{constructor(e=[],t=[],r=1,o=0){super();this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:r,detail:o};let n=[],s=[];a(o),l(r),u(),this.setAttribute("position",new Ce(n,3)),this.setAttribute("normal",new Ce(n.slice(),3)),this.setAttribute("uv",new Ce(s,2)),o===0?this.computeVertexNormals():this.normalizeNormals();function a(g){let T=new w,b=new w,y=new w;for(let A=0;A<t.length;A+=3)d(t[A+0],T),d(t[A+1],b),d(t[A+2],y),c(T,b,y,g)}function c(g,T,b,y){let A=y+1,E=[];for(let S=0;S<=A;S++){E[S]=[];let M=g.clone().lerp(b,S/A),L=T.clone().lerp(b,S/A),C=A-S;for(let N=0;N<=C;N++)N===0&&S===A?E[S][N]=M:E[S][N]=M.clone().lerp(L,N/C)}for(let S=0;S<A;S++)for(let M=0;M<2*(A-S)-1;M++){let L=Math.floor(M/2);M%2===0?(h(E[S][L+1]),h(E[S+1][L]),h(E[S][L])):(h(E[S][L+1]),h(E[S+1][L+1]),h(E[S+1][L]))}}function l(g){let T=new w;for(let b=0;b<n.length;b+=3)T.x=n[b+0],T.y=n[b+1],T.z=n[b+2],T.normalize().multiplyScalar(g),n[b+0]=T.x,n[b+1]=T.y,n[b+2]=T.z}function u(){let g=new w;for(let T=0;T<n.length;T+=3){g.x=n[T+0],g.y=n[T+1],g.z=n[T+2];let b=x(g)/2/Math.PI+.5,y=_(g)/Math.PI+.5;s.push(b,1-y)}m(),p()}function p(){for(let g=0;g<s.length;g+=6){let T=s[g+0],b=s[g+2],y=s[g+4],A=Math.max(T,b,y),E=Math.min(T,b,y);A>.9&&E<.1&&(T<.2&&(s[g+0]+=1),b<.2&&(s[g+2]+=1),y<.2&&(s[g+4]+=1))}}function h(g){n.push(g.x,g.y,g.z)}function d(g,T){let b=g*3;T.x=e[b+0],T.y=e[b+1],T.z=e[b+2]}function m(){let g=new w,T=new w,b=new w,y=new w,A=new G,E=new G,S=new G;for(let M=0,L=0;M<n.length;M+=9,L+=6){g.set(n[M+0],n[M+1],n[M+2]),T.set(n[M+3],n[M+4],n[M+5]),b.set(n[M+6],n[M+7],n[M+8]),A.set(s[L+0],s[L+1]),E.set(s[L+2],s[L+3]),S.set(s[L+4],s[L+5]),y.copy(g).add(T).add(b).divideScalar(3);let C=x(y);f(A,L+0,g,C),f(E,L+2,T,C),f(S,L+4,b,C)}}function f(g,T,b,y){y<0&&g.x===1&&(s[T]=g.x-1),b.x===0&&b.z===0&&(s[T]=y/2/Math.PI+.5)}function x(g){return Math.atan2(g.z,-g.x)}function _(g){return Math.atan2(-g.y,Math.sqrt(g.x*g.x+g.z*g.z))}}static fromJSON(e){return new vn(e.vertices,e.indices,e.radius,e.details)}};var J9=class extends vn{constructor(e=1,t=0){let r=(1+Math.sqrt(5))/2,o=1/r,n=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-o,-r,0,-o,r,0,o,-r,0,o,r,-o,-r,0,-o,r,0,o,-r,0,o,r,0,-r,0,-o,r,0,-o,-r,0,o,r,0,o],s=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(n,s,e,t);this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new J9(e.radius,e.detail)}};var Z9=new w,Q9=new w,vv=new w,e2=new as,QB=class extends De{constructor(e=null,t=1){super();if(this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:t},e!==null){let o=Math.pow(10,4),n=Math.cos(L0*t),s=e.getIndex(),a=e.getAttribute("position"),c=s?s.count:a.count,l=[0,0,0],u=["a","b","c"],p=new Array(3),h={},d=[];for(let m=0;m<c;m+=3){s?(l[0]=s.getX(m),l[1]=s.getX(m+1),l[2]=s.getX(m+2)):(l[0]=m,l[1]=m+1,l[2]=m+2);let{a:f,b:x,c:_}=e2;if(f.fromBufferAttribute(a,l[0]),x.fromBufferAttribute(a,l[1]),_.fromBufferAttribute(a,l[2]),e2.getNormal(vv),p[0]=`${Math.round(f.x*o)},${Math.round(f.y*o)},${Math.round(f.z*o)}`,p[1]=`${Math.round(x.x*o)},${Math.round(x.y*o)},${Math.round(x.z*o)}`,p[2]=`${Math.round(_.x*o)},${Math.round(_.y*o)},${Math.round(_.z*o)}`,!(p[0]===p[1]||p[1]===p[2]||p[2]===p[0]))for(let g=0;g<3;g++){let T=(g+1)%3,b=p[g],y=p[T],A=e2[u[g]],E=e2[u[T]],S=`${b}_${y}`,M=`${y}_${b}`;M in h&&h[M]?(vv.dot(h[M].normal)<=n&&(d.push(A.x,A.y,A.z),d.push(E.x,E.y,E.z)),h[M]=null):S in h||(h[S]={index0:l[g],index1:l[T],normal:vv.clone()})}}for(let m in h)if(h[m]){let{index0:f,index1:x}=h[m];Z9.fromBufferAttribute(a,f),Q9.fromBufferAttribute(a,x),d.push(Z9.x,Z9.y,Z9.z),d.push(Q9.x,Q9.y,Q9.z)}this.setAttribute("position",new Ce(d,3))}}};var tF={triangulate:function(i,e,t=2){let r=e&&e.length,o=r?e[0]*t:i.length,n=rF(i,0,o,t,!0),s=[];if(!n||n.next===n.prev)return s;let a,c,l,u,p,h,d;if(r&&(n=moe(i,e,n,t)),i.length>80*t){a=l=i[0],c=u=i[1];for(let m=t;m<o;m+=t)p=i[m],h=i[m+1],p<a&&(a=p),h<c&&(c=h),p>l&&(l=p),h>u&&(u=h);d=Math.max(l-a,u-c),d=d!==0?1/d:0}return qf(n,s,t,a,c,d),s}};function rF(i,e,t,r,o){let n,s;if(o===Soe(i,e,t,r)>0)for(n=e;n<t;n+=r)s=eF(n,i[n],i[n+1],s);else for(n=t-r;n>=e;n-=r)s=eF(n,i[n],i[n+1],s);return s&&o2(s,s.next)&&(Yf(s),s=s.next),s}function Va(i,e){if(!i)return i;e||(e=i);let t=i,r;do if(r=!1,!t.steiner&&(o2(t,t.next)||yr(t.prev,t,t.next)===0)){if(Yf(t),t=e=t.prev,t===t.next)break;r=!0}else t=t.next;while(r||t!==e);return e}function qf(i,e,t,r,o,n,s){if(!i)return;!s&&n&&yoe(i,r,o,n);let a=i,c,l;for(;i.prev!==i.next;){if(c=i.prev,l=i.next,n?hoe(i,r,o,n):poe(i)){e.push(c.i/t),e.push(i.i/t),e.push(l.i/t),Yf(i),i=l.next,a=l.next;continue}if(i=l,i===a){s?s===1?(i=doe(Va(i),e,t),qf(i,e,t,r,o,n,2)):s===2&&foe(i,e,t,r,o,n):qf(Va(i),e,t,r,o,n,1);break}}}function poe(i){let e=i.prev,t=i,r=i.next;if(yr(e,t,r)>=0)return!1;let o=i.next.next;for(;o!==i.prev;){if(Qp(e.x,e.y,t.x,t.y,r.x,r.y,o.x,o.y)&&yr(o.prev,o,o.next)>=0)return!1;o=o.next}return!0}function hoe(i,e,t,r){let o=i.prev,n=i,s=i.next;if(yr(o,n,s)>=0)return!1;let a=o.x<n.x?o.x<s.x?o.x:s.x:n.x<s.x?n.x:s.x,c=o.y<n.y?o.y<s.y?o.y:s.y:n.y<s.y?n.y:s.y,l=o.x>n.x?o.x>s.x?o.x:s.x:n.x>s.x?n.x:s.x,u=o.y>n.y?o.y>s.y?o.y:s.y:n.y>s.y?n.y:s.y,p=xv(a,c,e,t,r),h=xv(l,u,e,t,r),d=i.prevZ,m=i.nextZ;for(;d&&d.z>=p&&m&&m.z<=h;){if(d!==i.prev&&d!==i.next&&Qp(o.x,o.y,n.x,n.y,s.x,s.y,d.x,d.y)&&yr(d.prev,d,d.next)>=0||(d=d.prevZ,m!==i.prev&&m!==i.next&&Qp(o.x,o.y,n.x,n.y,s.x,s.y,m.x,m.y)&&yr(m.prev,m,m.next)>=0))return!1;m=m.nextZ}for(;d&&d.z>=p;){if(d!==i.prev&&d!==i.next&&Qp(o.x,o.y,n.x,n.y,s.x,s.y,d.x,d.y)&&yr(d.prev,d,d.next)>=0)return!1;d=d.prevZ}for(;m&&m.z<=h;){if(m!==i.prev&&m!==i.next&&Qp(o.x,o.y,n.x,n.y,s.x,s.y,m.x,m.y)&&yr(m.prev,m,m.next)>=0)return!1;m=m.nextZ}return!0}function doe(i,e,t){let r=i;do{let o=r.prev,n=r.next.next;!o2(o,n)&&oF(o,r,r.next,n)&&Xf(o,n)&&Xf(n,o)&&(e.push(o.i/t),e.push(r.i/t),e.push(n.i/t),Yf(r),Yf(r.next),r=i=n),r=r.next}while(r!==i);return Va(r)}function foe(i,e,t,r,o,n){let s=i;do{let a=s.next.next;for(;a!==s.prev;){if(s.i!==a.i&&Aoe(s,a)){let c=iF(s,a);s=Va(s,s.next),c=Va(c,c.next),qf(s,e,t,r,o,n),qf(c,e,t,r,o,n);return}a=a.next}s=s.next}while(s!==i)}function moe(i,e,t,r){let o=[],n,s,a,c,l;for(n=0,s=e.length;n<s;n++)a=e[n]*r,c=n<s-1?e[n+1]*r:i.length,l=rF(i,a,c,r,!1),l===l.next&&(l.steiner=!0),o.push(Toe(l));for(o.sort(_oe),n=0;n<o.length;n++)goe(o[n],t),t=Va(t,t.next);return t}function _oe(i,e){return i.x-e.x}function goe(i,e){if(e=voe(i,e),e){let t=iF(e,i);Va(e,e.next),Va(t,t.next)}}function voe(i,e){let t=e,r=i.x,o=i.y,n=-1/0,s;do{if(o<=t.y&&o>=t.next.y&&t.next.y!==t.y){let h=t.x+(o-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(h<=r&&h>n){if(n=h,h===r){if(o===t.y)return t;if(o===t.next.y)return t.next}s=t.x<t.next.x?t:t.next}}t=t.next}while(t!==e);if(!s)return null;if(r===n)return s;let a=s,c=s.x,l=s.y,u=1/0,p;t=s;do r>=t.x&&t.x>=c&&r!==t.x&&Qp(o<l?r:n,o,c,l,o<l?n:r,o,t.x,t.y)&&(p=Math.abs(o-t.y)/(r-t.x),Xf(t,i)&&(p<u||p===u&&(t.x>s.x||t.x===s.x&&xoe(s,t)))&&(s=t,u=p)),t=t.next;while(t!==a);return s}function xoe(i,e){return yr(i.prev,i,e.prev)<0&&yr(e.next,i,i.next)<0}function yoe(i,e,t,r){let o=i;do o.z===null&&(o.z=xv(o.x,o.y,e,t,r)),o.prevZ=o.prev,o.nextZ=o.next,o=o.next;while(o!==i);o.prevZ.nextZ=null,o.prevZ=null,boe(o)}function boe(i){let e,t,r,o,n,s,a,c,l=1;do{for(t=i,i=null,n=null,s=0;t;){for(s++,r=t,a=0,e=0;e<l&&(a++,r=r.nextZ,!!r);e++);for(c=l;a>0||c>0&&r;)a!==0&&(c===0||!r||t.z<=r.z)?(o=t,t=t.nextZ,a--):(o=r,r=r.nextZ,c--),n?n.nextZ=o:i=o,o.prevZ=n,n=o;t=r}n.nextZ=null,l*=2}while(s>1);return i}function xv(i,e,t,r,o){return i=32767*(i-t)*o,e=32767*(e-r)*o,i=(i|i<<8)&16711935,i=(i|i<<4)&252645135,i=(i|i<<2)&858993459,i=(i|i<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,i|e<<1}function Toe(i){let e=i,t=i;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==i);return t}function Qp(i,e,t,r,o,n,s,a){return(o-s)*(e-a)-(i-s)*(n-a)>=0&&(i-s)*(r-a)-(t-s)*(e-a)>=0&&(t-s)*(n-a)-(o-s)*(r-a)>=0}function Aoe(i,e){return i.next.i!==e.i&&i.prev.i!==e.i&&!Coe(i,e)&&(Xf(i,e)&&Xf(e,i)&&Eoe(i,e)&&(yr(i.prev,i,e.prev)||yr(i,e.prev,e))||o2(i,e)&&yr(i.prev,i,i.next)>0&&yr(e.prev,e,e.next)>0)}function yr(i,e,t){return(e.y-i.y)*(t.x-e.x)-(e.x-i.x)*(t.y-e.y)}function o2(i,e){return i.x===e.x&&i.y===e.y}function oF(i,e,t,r){let o=r2(yr(i,e,t)),n=r2(yr(i,e,r)),s=r2(yr(t,r,i)),a=r2(yr(t,r,e));return!!(o!==n&&s!==a||o===0&&t2(i,t,e)||n===0&&t2(i,r,e)||s===0&&t2(t,i,r)||a===0&&t2(t,e,r))}function t2(i,e,t){return e.x<=Math.max(i.x,t.x)&&e.x>=Math.min(i.x,t.x)&&e.y<=Math.max(i.y,t.y)&&e.y>=Math.min(i.y,t.y)}function r2(i){return i>0?1:i<0?-1:0}function Coe(i,e){let t=i;do{if(t.i!==i.i&&t.next.i!==i.i&&t.i!==e.i&&t.next.i!==e.i&&oF(t,t.next,i,e))return!0;t=t.next}while(t!==i);return!1}function Xf(i,e){return yr(i.prev,i,i.next)<0?yr(i,e,i.next)>=0&&yr(i,i.prev,e)>=0:yr(i,e,i.prev)<0||yr(i,i.next,e)<0}function Eoe(i,e){let t=i,r=!1,o=(i.x+e.x)/2,n=(i.y+e.y)/2;do t.y>n!=t.next.y>n&&t.next.y!==t.y&&o<(t.next.x-t.x)*(n-t.y)/(t.next.y-t.y)+t.x&&(r=!r),t=t.next;while(t!==i);return r}function iF(i,e){let t=new yv(i.i,i.x,i.y),r=new yv(e.i,e.x,e.y),o=i.next,n=e.prev;return i.next=e,e.prev=i,t.next=o,o.prev=t,r.next=t,t.prev=r,n.next=r,r.prev=n,r}function eF(i,e,t,r){let o=new yv(i,e,t);return r?(o.next=r.next,o.prev=r,r.next.prev=o,r.next=o):(o.prev=o,o.next=o),o}function Yf(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function yv(i,e,t){this.i=i,this.x=e,this.y=t,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Soe(i,e,t,r){let o=0;for(let n=e,s=t-r;n<t;n+=r)o+=(i[s]-i[n])*(i[n+1]+i[s+1]),s=n;return o}var Qn=class{static area(e){let t=e.length,r=0;for(let o=t-1,n=0;n<t;o=n++)r+=e[o].x*e[n].y-e[n].x*e[o].y;return r*.5}static isClockWise(e){return Qn.area(e)<0}static triangulateShape(e,t){let r=[],o=[],n=[];nF(e),sF(r,e);let s=e.length;t.forEach(nF);for(let c=0;c<t.length;c++)o.push(s),s+=t[c].length,sF(r,t[c]);let a=tF.triangulate(r,o);for(let c=0;c<a.length;c+=3)n.push(a.slice(c,c+3));return n}};function nF(i){let e=i.length;e>2&&i[e-1].equals(i[0])&&i.pop()}function sF(i,e){for(let t=0;t<e.length;t++)i.push(e[t].x),i.push(e[t].y)}var i2=class extends De{constructor(e=new fl([new G(.5,.5),new G(-.5,.5),new G(-.5,-.5),new G(.5,-.5)]),t={}){super();this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];let r=this,o=[],n=[];for(let a=0,c=e.length;a<c;a++){let l=e[a];s(l)}this.setAttribute("position",new Ce(o,3)),this.setAttribute("uv",new Ce(n,2)),this.computeVertexNormals();function s(a){let c=[],l=t.curveSegments!==void 0?t.curveSegments:12,u=t.steps!==void 0?t.steps:1,p=t.depth!==void 0?t.depth:1,h=t.bevelEnabled!==void 0?t.bevelEnabled:!0,d=t.bevelThickness!==void 0?t.bevelThickness:.2,m=t.bevelSize!==void 0?t.bevelSize:d-.1,f=t.bevelOffset!==void 0?t.bevelOffset:0,x=t.bevelSegments!==void 0?t.bevelSegments:3,_=t.extrudePath,g=t.UVGenerator!==void 0?t.UVGenerator:woe;t.amount!==void 0&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),p=t.amount);let T,b=!1,y,A,E,S;_&&(T=_.getSpacedPoints(u),b=!0,h=!1,y=_.computeFrenetFrames(u,!1),A=new w,E=new w,S=new w),h||(x=0,d=0,m=0,f=0);let M=a.extractPoints(l),L=M.shape,C=M.holes;if(!Qn.isClockWise(L)){L=L.reverse();for(let le=0,ye=C.length;le<ye;le++){let be=C[le];Qn.isClockWise(be)&&(C[le]=be.reverse())}}let D=Qn.triangulateShape(L,C),k=L;for(let le=0,ye=C.length;le<ye;le++){let be=C[le];L=L.concat(be)}function z(le,ye,be){return ye||console.error("THREE.ExtrudeGeometry: vec does not exist"),ye.clone().multiplyScalar(be).add(le)}let F=L.length,X=D.length;function $(le,ye,be){let ie,de,we,Ee=le.x-ye.x,Pe=le.y-ye.y,We=be.x-le.x,Ze=be.y-le.y,I=Ee*Ee+Pe*Pe,O=Ee*Ze-Pe*We;if(Math.abs(O)>Number.EPSILON){let fe=Math.sqrt(I),ee=Math.sqrt(We*We+Ze*Ze),me=ye.x-Pe/fe,Z=ye.y+Ee/fe,Se=be.x-Ze/ee,U=be.y+We/ee,se=((Se-me)*Ze-(U-Z)*We)/(Ee*Ze-Pe*We);ie=me+Ee*se-le.x,de=Z+Pe*se-le.y;let ve=ie*ie+de*de;if(ve<=2)return new G(ie,de);we=Math.sqrt(ve/2)}else{let fe=!1;Ee>Number.EPSILON?We>Number.EPSILON&&(fe=!0):Ee<-Number.EPSILON?We<-Number.EPSILON&&(fe=!0):Math.sign(Pe)===Math.sign(Ze)&&(fe=!0),fe?(ie=-Pe,de=Ee,we=Math.sqrt(I)):(ie=Ee,de=Pe,we=Math.sqrt(I/2))}return new G(ie/we,de/we)}let Y=[];for(let le=0,ye=k.length,be=ye-1,ie=le+1;le<ye;le++,be++,ie++)be===ye&&(be=0),ie===ye&&(ie=0),Y[le]=$(k[le],k[be],k[ie]);let H=[],B,te=Y.concat();for(let le=0,ye=C.length;le<ye;le++){let be=C[le];B=[];for(let ie=0,de=be.length,we=de-1,Ee=ie+1;ie<de;ie++,we++,Ee++)we===de&&(we=0),Ee===de&&(Ee=0),B[ie]=$(be[ie],be[we],be[Ee]);H.push(B),te=te.concat(B)}for(let le=0;le<x;le++){let ye=le/x,be=d*Math.cos(ye*Math.PI/2),ie=m*Math.sin(ye*Math.PI/2)+f;for(let de=0,we=k.length;de<we;de++){let Ee=z(k[de],Y[de],ie);xe(Ee.x,Ee.y,-be)}for(let de=0,we=C.length;de<we;de++){let Ee=C[de];B=H[de];for(let Pe=0,We=Ee.length;Pe<We;Pe++){let Ze=z(Ee[Pe],B[Pe],ie);xe(Ze.x,Ze.y,-be)}}}let q=m+f;for(let le=0;le<F;le++){let ye=h?z(L[le],te[le],q):L[le];b?(E.copy(y.normals[0]).multiplyScalar(ye.x),A.copy(y.binormals[0]).multiplyScalar(ye.y),S.copy(T[0]).add(E).add(A),xe(S.x,S.y,S.z)):xe(ye.x,ye.y,0)}for(let le=1;le<=u;le++)for(let ye=0;ye<F;ye++){let be=h?z(L[ye],te[ye],q):L[ye];b?(E.copy(y.normals[le]).multiplyScalar(be.x),A.copy(y.binormals[le]).multiplyScalar(be.y),S.copy(T[le]).add(E).add(A),xe(S.x,S.y,S.z)):xe(be.x,be.y,p/u*le)}for(let le=x-1;le>=0;le--){let ye=le/x,be=d*Math.cos(ye*Math.PI/2),ie=m*Math.sin(ye*Math.PI/2)+f;for(let de=0,we=k.length;de<we;de++){let Ee=z(k[de],Y[de],ie);xe(Ee.x,Ee.y,p+be)}for(let de=0,we=C.length;de<we;de++){let Ee=C[de];B=H[de];for(let Pe=0,We=Ee.length;Pe<We;Pe++){let Ze=z(Ee[Pe],B[Pe],ie);b?xe(Ze.x,Ze.y+T[u-1].y,T[u-1].x+be):xe(Ze.x,Ze.y,p+be)}}}j(),R();function j(){let le=o.length/3;if(h){let ye=0,be=F*ye;for(let ie=0;ie<X;ie++){let de=D[ie];ae(de[2]+be,de[1]+be,de[0]+be)}ye=u+x*2,be=F*ye;for(let ie=0;ie<X;ie++){let de=D[ie];ae(de[0]+be,de[1]+be,de[2]+be)}}else{for(let ye=0;ye<X;ye++){let be=D[ye];ae(be[2],be[1],be[0])}for(let ye=0;ye<X;ye++){let be=D[ye];ae(be[0]+F*u,be[1]+F*u,be[2]+F*u)}}r.addGroup(le,o.length/3-le,0)}function R(){let le=o.length/3,ye=0;Ne(k,ye),ye+=k.length;for(let be=0,ie=C.length;be<ie;be++){let de=C[be];Ne(de,ye),ye+=de.length}r.addGroup(le,o.length/3-le,1)}function Ne(le,ye){let be=le.length;for(;--be>=0;){let ie=be,de=be-1;de<0&&(de=le.length-1);for(let we=0,Ee=u+x*2;we<Ee;we++){let Pe=F*we,We=F*(we+1),Ze=ye+ie+Pe,I=ye+de+Pe,O=ye+de+We,fe=ye+ie+We;Ae(Ze,I,O,fe)}}}function xe(le,ye,be){c.push(le),c.push(ye),c.push(be)}function ae(le,ye,be){Re(le),Re(ye),Re(be);let ie=o.length/3,de=g.generateTopUV(r,o,ie-3,ie-2,ie-1);Oe(de[0]),Oe(de[1]),Oe(de[2])}function Ae(le,ye,be,ie){Re(le),Re(ye),Re(ie),Re(ye),Re(be),Re(ie);let de=o.length/3,we=g.generateSideWallUV(r,o,de-6,de-3,de-2,de-1);Oe(we[0]),Oe(we[1]),Oe(we[3]),Oe(we[1]),Oe(we[2]),Oe(we[3])}function Re(le){o.push(c[le*3+0]),o.push(c[le*3+1]),o.push(c[le*3+2])}function Oe(le){n.push(le.x),n.push(le.y)}}}toJSON(){let e=super.toJSON(),t=this.parameters.shapes,r=this.parameters.options;return Moe(t,r,e)}static fromJSON(e,t){let r=[];for(let n=0,s=e.shapes.length;n<s;n++){let a=t[e.shapes[n]];r.push(a)}let o=e.options.extrudePath;return o!==void 0&&(e.options.extrudePath=new dl[o.type]().fromJSON(o)),new i2(r,e.options)}},woe={generateTopUV:function(i,e,t,r,o){let n=e[t*3],s=e[t*3+1],a=e[r*3],c=e[r*3+1],l=e[o*3],u=e[o*3+1];return[new G(n,s),new G(a,c),new G(l,u)]},generateSideWallUV:function(i,e,t,r,o,n){let s=e[t*3],a=e[t*3+1],c=e[t*3+2],l=e[r*3],u=e[r*3+1],p=e[r*3+2],h=e[o*3],d=e[o*3+1],m=e[o*3+2],f=e[n*3],x=e[n*3+1],_=e[n*3+2];return Math.abs(a-u)<Math.abs(s-l)?[new G(s,1-c),new G(l,1-p),new G(h,1-m),new G(f,1-_)]:[new G(a,1-c),new G(u,1-p),new G(d,1-m),new G(x,1-_)]}};function Moe(i,e,t){if(t.shapes=[],Array.isArray(i))for(let r=0,o=i.length;r<o;r++){let n=i[r];t.shapes.push(n.uuid)}else t.shapes.push(i.uuid);return e.extrudePath!==void 0&&(t.options.extrudePath=e.extrudePath.toJSON()),t}var eh=class extends vn{constructor(e=1,t=0){let r=(1+Math.sqrt(5))/2,o=[-1,r,0,1,r,0,-1,-r,0,1,-r,0,0,-1,r,0,1,r,0,-1,-r,0,1,-r,r,0,-1,r,0,1,-r,0,-1,-r,0,1],n=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(o,n,e,t);this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new eh(e.radius,e.detail)}};var n2=class extends De{constructor(e=[new G(0,.5),new G(.5,0),new G(0,-.5)],t=12,r=0,o=Math.PI*2){super();this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:r,phiLength:o},t=Math.floor(t),o=qs(o,0,Math.PI*2);let n=[],s=[],a=[],c=[],l=[],u=1/t,p=new w,h=new G,d=new w,m=new w,f=new w,x=0,_=0;for(let g=0;g<=e.length-1;g++)switch(g){case 0:x=e[g+1].x-e[g].x,_=e[g+1].y-e[g].y,d.x=_*1,d.y=-x,d.z=_*0,f.copy(d),d.normalize(),c.push(d.x,d.y,d.z);break;case e.length-1:c.push(f.x,f.y,f.z);break;default:x=e[g+1].x-e[g].x,_=e[g+1].y-e[g].y,d.x=_*1,d.y=-x,d.z=_*0,m.copy(d),d.x+=f.x,d.y+=f.y,d.z+=f.z,d.normalize(),c.push(d.x,d.y,d.z),f.copy(m)}for(let g=0;g<=t;g++){let T=r+g*u*o,b=Math.sin(T),y=Math.cos(T);for(let A=0;A<=e.length-1;A++){p.x=e[A].x*b,p.y=e[A].y,p.z=e[A].x*y,s.push(p.x,p.y,p.z),h.x=g/t,h.y=A/(e.length-1),a.push(h.x,h.y);let E=c[3*A+0]*b,S=c[3*A+1],M=c[3*A+0]*y;l.push(E,S,M)}}for(let g=0;g<t;g++)for(let T=0;T<e.length-1;T++){let b=T+g*e.length,y=b,A=b+e.length,E=b+e.length+1,S=b+1;n.push(y,A,S),n.push(E,S,A)}this.setIndex(n),this.setAttribute("position",new Ce(s,3)),this.setAttribute("uv",new Ce(a,2)),this.setAttribute("normal",new Ce(l,3))}static fromJSON(e){return new n2(e.points,e.segments,e.phiStart,e.phiLength)}};var s2=class extends vn{constructor(e=1,t=0){let r=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],o=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(r,o,e,t);this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new s2(e.radius,e.detail)}};var a2=class extends De{constructor(e=.5,t=1,r=8,o=1,n=0,s=Math.PI*2){super();this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:r,phiSegments:o,thetaStart:n,thetaLength:s},r=Math.max(3,r),o=Math.max(1,o);let a=[],c=[],l=[],u=[],p=e,h=(t-e)/o,d=new w,m=new G;for(let f=0;f<=o;f++){for(let x=0;x<=r;x++){let _=n+x/r*s;d.x=p*Math.cos(_),d.y=p*Math.sin(_),c.push(d.x,d.y,d.z),l.push(0,0,1),m.x=(d.x/t+1)/2,m.y=(d.y/t+1)/2,u.push(m.x,m.y)}p+=h}for(let f=0;f<o;f++){let x=f*(r+1);for(let _=0;_<r;_++){let g=_+x,T=g,b=g+r+1,y=g+r+2,A=g+1;a.push(T,b,A),a.push(b,y,A)}}this.setIndex(a),this.setAttribute("position",new Ce(c,3)),this.setAttribute("normal",new Ce(l,3)),this.setAttribute("uv",new Ce(u,2))}static fromJSON(e){return new a2(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}};var c2=class extends De{constructor(e=new fl([new G(0,.5),new G(-.5,-.5),new G(.5,-.5)]),t=12){super();this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};let r=[],o=[],n=[],s=[],a=0,c=0;if(Array.isArray(e)===!1)l(e);else for(let u=0;u<e.length;u++)l(e[u]),this.addGroup(a,c,u),a+=c,c=0;this.setIndex(r),this.setAttribute("position",new Ce(o,3)),this.setAttribute("normal",new Ce(n,3)),this.setAttribute("uv",new Ce(s,2));function l(u){let p=o.length/3,h=u.extractPoints(t),d=h.shape,m=h.holes;Qn.isClockWise(d)===!1&&(d=d.reverse());for(let x=0,_=m.length;x<_;x++){let g=m[x];Qn.isClockWise(g)===!0&&(m[x]=g.reverse())}let f=Qn.triangulateShape(d,m);for(let x=0,_=m.length;x<_;x++){let g=m[x];d=d.concat(g)}for(let x=0,_=d.length;x<_;x++){let g=d[x];o.push(g.x,g.y,0),n.push(0,0,1),s.push(g.x,g.y)}for(let x=0,_=f.length;x<_;x++){let g=f[x],T=g[0]+p,b=g[1]+p,y=g[2]+p;r.push(T,b,y),c+=3}}}toJSON(){let e=super.toJSON(),t=this.parameters.shapes;return Noe(t,e)}static fromJSON(e,t){let r=[];for(let o=0,n=e.shapes.length;o<n;o++){let s=t[e.shapes[o]];r.push(s)}return new c2(r,e.curveSegments)}};function Noe(i,e){if(e.shapes=[],Array.isArray(i))for(let t=0,r=i.length;t<r;t++){let o=i[t];e.shapes.push(o.uuid)}else e.shapes.push(i.uuid);return e}var ml=class extends De{constructor(e=1,t=32,r=16,o=0,n=Math.PI*2,s=0,a=Math.PI){super();this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:r,phiStart:o,phiLength:n,thetaStart:s,thetaLength:a},t=Math.max(3,Math.floor(t)),r=Math.max(2,Math.floor(r));let c=Math.min(s+a,Math.PI),l=0,u=[],p=new w,h=new w,d=[],m=[],f=[],x=[];for(let _=0;_<=r;_++){let g=[],T=_/r,b=0;_==0&&s==0?b=.5/t:_==r&&c==Math.PI&&(b=-.5/t);for(let y=0;y<=t;y++){let A=y/t;p.x=-e*Math.cos(o+A*n)*Math.sin(s+T*a),p.y=e*Math.cos(s+T*a),p.z=e*Math.sin(o+A*n)*Math.sin(s+T*a),m.push(p.x,p.y,p.z),h.copy(p).normalize(),f.push(h.x,h.y,h.z),x.push(A+b,1-T),g.push(l++)}u.push(g)}for(let _=0;_<r;_++)for(let g=0;g<t;g++){let T=u[_][g+1],b=u[_][g],y=u[_+1][g],A=u[_+1][g+1];(_!==0||s>0)&&d.push(T,b,A),(_!==r-1||c<Math.PI)&&d.push(b,y,A)}this.setIndex(d),this.setAttribute("position",new Ce(m,3)),this.setAttribute("normal",new Ce(f,3)),this.setAttribute("uv",new Ce(x,2))}static fromJSON(e){return new ml(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}};var l2=class extends vn{constructor(e=1,t=0){let r=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],o=[2,1,0,0,3,2,1,3,0,2,3,1];super(r,o,e,t);this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new l2(e.radius,e.detail)}};var u2=class extends De{constructor(e=1,t=.4,r=8,o=6,n=Math.PI*2){super();this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:r,tubularSegments:o,arc:n},r=Math.floor(r),o=Math.floor(o);let s=[],a=[],c=[],l=[],u=new w,p=new w,h=new w;for(let d=0;d<=r;d++)for(let m=0;m<=o;m++){let f=m/o*n,x=d/r*Math.PI*2;p.x=(e+t*Math.cos(x))*Math.cos(f),p.y=(e+t*Math.cos(x))*Math.sin(f),p.z=t*Math.sin(x),a.push(p.x,p.y,p.z),u.x=e*Math.cos(f),u.y=e*Math.sin(f),h.subVectors(p,u).normalize(),c.push(h.x,h.y,h.z),l.push(m/o),l.push(d/r)}for(let d=1;d<=r;d++)for(let m=1;m<=o;m++){let f=(o+1)*d+m-1,x=(o+1)*(d-1)+m-1,_=(o+1)*(d-1)+m,g=(o+1)*d+m;s.push(f,x,g),s.push(x,_,g)}this.setIndex(s),this.setAttribute("position",new Ce(a,3)),this.setAttribute("normal",new Ce(c,3)),this.setAttribute("uv",new Ce(l,2))}static fromJSON(e){return new u2(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}};var p2=class extends De{constructor(e=1,t=.4,r=64,o=8,n=2,s=3){super();this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:r,radialSegments:o,p:n,q:s},r=Math.floor(r),o=Math.floor(o);let a=[],c=[],l=[],u=[],p=new w,h=new w,d=new w,m=new w,f=new w,x=new w,_=new w;for(let T=0;T<=r;++T){let b=T/r*n*Math.PI*2;g(b,n,s,e,d),g(b+.01,n,s,e,m),x.subVectors(m,d),_.addVectors(m,d),f.crossVectors(x,_),_.crossVectors(f,x),f.normalize(),_.normalize();for(let y=0;y<=o;++y){let A=y/o*Math.PI*2,E=-t*Math.cos(A),S=t*Math.sin(A);p.x=d.x+(E*_.x+S*f.x),p.y=d.y+(E*_.y+S*f.y),p.z=d.z+(E*_.z+S*f.z),c.push(p.x,p.y,p.z),h.subVectors(p,d).normalize(),l.push(h.x,h.y,h.z),u.push(T/r),u.push(y/o)}}for(let T=1;T<=r;T++)for(let b=1;b<=o;b++){let y=(o+1)*(T-1)+(b-1),A=(o+1)*T+(b-1),E=(o+1)*T+b,S=(o+1)*(T-1)+b;a.push(y,A,S),a.push(A,E,S)}this.setIndex(a),this.setAttribute("position",new Ce(c,3)),this.setAttribute("normal",new Ce(l,3)),this.setAttribute("uv",new Ce(u,2));function g(T,b,y,A,E){let S=Math.cos(T),M=Math.sin(T),L=y/b*T,C=Math.cos(L);E.x=A*(2+C)*.5*S,E.y=A*(2+C)*M*.5,E.z=A*Math.sin(L)*.5}}static fromJSON(e){return new p2(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}};var h2=class extends De{constructor(e=new $p(new w(-1,-1,0),new w(-1,1,0),new w(1,1,0)),t=64,r=1,o=8,n=!1){super();this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:r,radialSegments:o,closed:n};let s=e.computeFrenetFrames(t,n);this.tangents=s.tangents,this.normals=s.normals,this.binormals=s.binormals;let a=new w,c=new w,l=new G,u=new w,p=[],h=[],d=[],m=[];f(),this.setIndex(m),this.setAttribute("position",new Ce(p,3)),this.setAttribute("normal",new Ce(h,3)),this.setAttribute("uv",new Ce(d,2));function f(){for(let T=0;T<t;T++)x(T);x(n===!1?t:0),g(),_()}function x(T){u=e.getPointAt(T/t,u);let b=s.normals[T],y=s.binormals[T];for(let A=0;A<=o;A++){let E=A/o*Math.PI*2,S=Math.sin(E),M=-Math.cos(E);c.x=M*b.x+S*y.x,c.y=M*b.y+S*y.y,c.z=M*b.z+S*y.z,c.normalize(),h.push(c.x,c.y,c.z),a.x=u.x+r*c.x,a.y=u.y+r*c.y,a.z=u.z+r*c.z,p.push(a.x,a.y,a.z)}}function _(){for(let T=1;T<=t;T++)for(let b=1;b<=o;b++){let y=(o+1)*(T-1)+(b-1),A=(o+1)*T+(b-1),E=(o+1)*T+b,S=(o+1)*(T-1)+b;m.push(y,A,S),m.push(A,E,S)}}function g(){for(let T=0;T<=t;T++)for(let b=0;b<=o;b++)l.x=T/t,l.y=b/o,d.push(l.x,l.y)}}toJSON(){let e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new h2(new dl[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}};var cF=class extends De{constructor(e=null){super();if(this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){let t=[],r=new Set,o=new w,n=new w;if(e.index!==null){let s=e.attributes.position,a=e.index,c=e.groups;c.length===0&&(c=[{start:0,count:a.count,materialIndex:0}]);for(let l=0,u=c.length;l<u;++l){let p=c[l],h=p.start,d=p.count;for(let m=h,f=h+d;m<f;m+=3)for(let x=0;x<3;x++){let _=a.getX(m+x),g=a.getX(m+(x+1)%3);o.fromBufferAttribute(s,_),n.fromBufferAttribute(s,g),aF(o,n,r)===!0&&(t.push(o.x,o.y,o.z),t.push(n.x,n.y,n.z))}}}else{let s=e.attributes.position;for(let a=0,c=s.count/3;a<c;a++)for(let l=0;l<3;l++){let u=3*a+l,p=3*a+(l+1)%3;o.fromBufferAttribute(s,u),n.fromBufferAttribute(s,p),aF(o,n,r)===!0&&(t.push(o.x,o.y,o.z),t.push(n.x,n.y,n.z))}}this.setAttribute("position",new Ce(t,3))}}};function aF(i,e,t){let r=`${i.x},${i.y},${i.z}-${e.x},${e.y},${e.z}`,o=`${e.x},${e.y},${e.z}-${i.x},${i.y},${i.z}`;return t.has(r)===!0||t.has(o)===!0?!1:(t.add(r,o),!0)}var bv=class extends io{constructor(e){super(e)}load(e,t,r,o){let n=this,s=this.path===""?gn.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||s;let a=new Ho(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(c){let l=null;try{l=JSON.parse(c)}catch(p){o!==void 0&&o(p),console.error("THREE:ObjectLoader: Can't parse "+e+".",p.message);return}let u=l.metadata;if(u===void 0||u.type===void 0||u.type.toLowerCase()==="geometry"){console.error("THREE.ObjectLoader: Can't load "+e);return}n.parse(l,t)},r,o)}async loadAsync(e,t){let r=this,o=this.path===""?gn.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||o;let n=new Ho(this.manager);n.setPath(this.path),n.setRequestHeader(this.requestHeader),n.setWithCredentials(this.withCredentials);let s=await n.loadAsync(e,t),a=JSON.parse(s),c=a.metadata;if(c===void 0||c.type===void 0||c.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+e);return await r.parseAsync(a)}parse(e,t){let r=this.parseAnimations(e.animations),o=this.parseShapes(e.shapes),n=this.parseGeometries(e.geometries,o),s=this.parseImages(e.images,function(){t!==void 0&&t(l)}),a=this.parseTextures(e.textures,s),c=this.parseMaterials(e.materials,a),l=this.parseObject(e.object,n,c,a,r),u=this.parseSkeletons(e.skeletons,l);if(this.bindSkeletons(l,u),t!==void 0){let p=!1;for(let h in s)if(s[h]instanceof HTMLImageElement){p=!0;break}p===!1&&t(l)}return l}async parseAsync(e){let t=this.parseAnimations(e.animations),r=this.parseShapes(e.shapes),o=this.parseGeometries(e.geometries,r),n=await this.parseImagesAsync(e.images),s=this.parseTextures(e.textures,n),a=this.parseMaterials(e.materials,s),c=this.parseObject(e.object,o,a,s,t),l=this.parseSkeletons(e.skeletons,c);return this.bindSkeletons(c,l),c}parseShapes(e){let t={};if(e!==void 0)for(let r=0,o=e.length;r<o;r++){let n=new fl().fromJSON(e[r]);t[n.uuid]=n}return t}parseSkeletons(e,t){let r={},o={};if(t.traverse(function(n){n.isBone&&(o[n.uuid]=n)}),e!==void 0)for(let n=0,s=e.length;n<s;n++){let a=new ul().fromJSON(e[n],o);r[a.uuid]=a}return r}parseGeometries(e,t){let r={};if(e!==void 0){let o=new gv;for(let n=0,s=e.length;n<s;n++){let a,c=e[n];switch(c.type){case"BufferGeometry":case"InstancedBufferGeometry":a=o.parse(c);break;case"Geometry":console.error("THREE.ObjectLoader: The legacy Geometry type is no longer supported.");break;default:c.type in d2?a=d2[c.type].fromJSON(c,t):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${c.type}"`)}a.uuid=c.uuid,c.name!==void 0&&(a.name=c.name),a.isBufferGeometry===!0&&c.userData!==void 0&&(a.userData=c.userData),r[c.uuid]=a}}return r}parseMaterials(e,t){let r={},o={};if(e!==void 0){let n=new of;n.setTextures(t);for(let s=0,a=e.length;s<a;s++){let c=e[s];if(c.type==="MultiMaterial"){let l=[];for(let u=0;u<c.materials.length;u++){let p=c.materials[u];r[p.uuid]===void 0&&(r[p.uuid]=n.parse(p)),l.push(r[p.uuid])}o[c.uuid]=l}else r[c.uuid]===void 0&&(r[c.uuid]=n.parse(c)),o[c.uuid]=r[c.uuid]}}return o}parseAnimations(e){let t={};if(e!==void 0)for(let r=0;r<e.length;r++){let o=e[r],n=Wf.parse(o);t[n.uuid]=n}return t}parseImages(e,t){let r=this,o={},n;function s(c){return r.manager.itemStart(c),n.load(c,function(){r.manager.itemEnd(c)},void 0,function(){r.manager.itemError(c),r.manager.itemEnd(c)})}function a(c){if(typeof c=="string"){let l=c,u=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(l)?l:r.resourcePath+l;return s(u)}else return c.data?{data:I0(c.type,c.data),width:c.width,height:c.height}:null}if(e!==void 0&&e.length>0){let c=new Bm(t);n=new Np(c),n.setCrossOrigin(this.crossOrigin);for(let l=0,u=e.length;l<u;l++){let p=e[l],h=p.url;if(Array.isArray(h)){o[p.uuid]=[];for(let d=0,m=h.length;d<m;d++){let f=h[d],x=a(f);x!==null&&(x instanceof HTMLImageElement?o[p.uuid].push(x):o[p.uuid].push(new Mr(x.data,x.width,x.height)))}}else{let d=a(p.url);d!==null&&(o[p.uuid]=d)}}}return o}async parseImagesAsync(e){let t=this,r={},o;async function n(s){if(typeof s=="string"){let a=s,c=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(a)?a:t.resourcePath+a;return await o.loadAsync(c)}else return s.data?{data:I0(s.type,s.data),width:s.width,height:s.height}:null}if(e!==void 0&&e.length>0){o=new Np(this.manager),o.setCrossOrigin(this.crossOrigin);for(let s=0,a=e.length;s<a;s++){let c=e[s],l=c.url;if(Array.isArray(l)){r[c.uuid]=[];for(let u=0,p=l.length;u<p;u++){let h=l[u],d=await n(h);d!==null&&(d instanceof HTMLImageElement?r[c.uuid].push(d):r[c.uuid].push(new Mr(d.data,d.width,d.height)))}}else{let u=await n(c.url);u!==null&&(r[c.uuid]=u)}}}return r}parseTextures(e,t){function r(n,s){return typeof n=="number"?n:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",n),s[n])}let o={};if(e!==void 0)for(let n=0,s=e.length;n<s;n++){let a=e[n];a.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',a.uuid),t[a.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",a.image);let c,l=t[a.image];Array.isArray(l)?(c=new D0(l),l.length===6&&(c.needsUpdate=!0)):(l&&l.data?c=new Mr(l.data,l.width,l.height):c=new gr(l),l&&(c.needsUpdate=!0)),c.uuid=a.uuid,a.name!==void 0&&(c.name=a.name),a.mapping!==void 0&&(c.mapping=r(a.mapping,Ooe)),a.offset!==void 0&&c.offset.fromArray(a.offset),a.repeat!==void 0&&c.repeat.fromArray(a.repeat),a.center!==void 0&&c.center.fromArray(a.center),a.rotation!==void 0&&(c.rotation=a.rotation),a.wrap!==void 0&&(c.wrapS=r(a.wrap[0],lF),c.wrapT=r(a.wrap[1],lF)),a.format!==void 0&&(c.format=a.format),a.type!==void 0&&(c.type=a.type),a.encoding!==void 0&&(c.encoding=a.encoding),a.minFilter!==void 0&&(c.minFilter=r(a.minFilter,uF)),a.magFilter!==void 0&&(c.magFilter=r(a.magFilter,uF)),a.anisotropy!==void 0&&(c.anisotropy=a.anisotropy),a.flipY!==void 0&&(c.flipY=a.flipY),a.premultiplyAlpha!==void 0&&(c.premultiplyAlpha=a.premultiplyAlpha),a.unpackAlignment!==void 0&&(c.unpackAlignment=a.unpackAlignment),a.userData!==void 0&&(c.userData=a.userData),o[a.uuid]=c}return o}parseObject(e,t,r,o,n){let s;function a(h){return t[h]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",h),t[h]}function c(h){if(h!==void 0){if(Array.isArray(h)){let d=[];for(let m=0,f=h.length;m<f;m++){let x=h[m];r[x]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",x),d.push(r[x])}return d}return r[h]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",h),r[h]}}function l(h){return o[h]===void 0&&console.warn("THREE.ObjectLoader: Undefined texture",h),o[h]}let u,p;switch(e.type){case"Scene":s=new Ji,e.background!==void 0&&(Number.isInteger(e.background)?s.background=new he(e.background):s.background=l(e.background)),e.environment!==void 0&&(s.environment=l(e.environment)),e.fog!==void 0&&(e.fog.type==="Fog"?s.fog=new Y0(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(s.fog=new $0(e.fog.color,e.fog.density)));break;case"PerspectiveCamera":s=new ir(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(s.focus=e.focus),e.zoom!==void 0&&(s.zoom=e.zoom),e.filmGauge!==void 0&&(s.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(s.filmOffset=e.filmOffset),e.view!==void 0&&(s.view=Object.assign({},e.view));break;case"OrthographicCamera":s=new ps(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(s.zoom=e.zoom),e.view!==void 0&&(s.view=Object.assign({},e.view));break;case"AmbientLight":s=new X9(e.color,e.intensity);break;case"DirectionalLight":s=new Zp(e.color,e.intensity);break;case"PointLight":s=new Jp(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":s=new Ip(e.color,e.intensity,e.width,e.height);break;case"SpotLight":s=new La(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":s=new Dp(e.color,e.groundColor,e.intensity);break;case"LightProbe":s=new $9().fromJSON(e);break;case"SkinnedMesh":u=a(e.geometry),p=c(e.material),s=new z0(u,p),e.bindMode!==void 0&&(s.bindMode=e.bindMode),e.bindMatrix!==void 0&&s.bindMatrix.fromArray(e.bindMatrix),e.skeleton!==void 0&&(s.skeleton=e.skeleton);break;case"Mesh":u=a(e.geometry),p=c(e.material),s=new lt(u,p);break;case"InstancedMesh":u=a(e.geometry),p=c(e.material);let h=e.count,d=e.instanceMatrix,m=e.instanceColor;s=new D9(u,p,h),s.instanceMatrix=new Xr(new Float32Array(d.array),16),m!==void 0&&(s.instanceColor=new Xr(new Float32Array(m.array),m.itemSize));break;case"LOD":s=new lu;break;case"Line":s=new cs(a(e.geometry),c(e.material));break;case"LineLoop":s=new qp(a(e.geometry),c(e.material));break;case"LineSegments":s=new Br(a(e.geometry),c(e.material));break;case"PointCloud":case"Points":s=new Xi(a(e.geometry),c(e.material));break;case"Sprite":s=new U9(c(e.material));break;case"Group":s=new ut;break;case"Bone":s=new fs;break;default:s=new vt}if(s.uuid=e.uuid,e.name!==void 0&&(s.name=e.name),e.matrix!==void 0?(s.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(s.matrixAutoUpdate=e.matrixAutoUpdate),s.matrixAutoUpdate&&s.matrix.decompose(s.position,s.quaternion,s.scale)):(e.position!==void 0&&s.position.fromArray(e.position),e.rotation!==void 0&&s.rotation.fromArray(e.rotation),e.quaternion!==void 0&&s.quaternion.fromArray(e.quaternion),e.scale!==void 0&&s.scale.fromArray(e.scale)),e.castShadow!==void 0&&(s.castShadow=e.castShadow),e.receiveShadow!==void 0&&(s.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.bias!==void 0&&(s.shadow.bias=e.shadow.bias),e.shadow.normalBias!==void 0&&(s.shadow.normalBias=e.shadow.normalBias),e.shadow.radius!==void 0&&(s.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&s.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(s.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(s.visible=e.visible),e.frustumCulled!==void 0&&(s.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(s.renderOrder=e.renderOrder),e.userData!==void 0&&(s.userData=e.userData),e.layers!==void 0&&(s.layers.mask=e.layers),e.children!==void 0){let h=e.children;for(let d=0;d<h.length;d++)s.add(this.parseObject(h[d],t,r,o,n))}if(e.animations!==void 0){let h=e.animations;for(let d=0;d<h.length;d++){let m=h[d];s.animations.push(n[m])}}if(e.type==="LOD"){e.autoUpdate!==void 0&&(s.autoUpdate=e.autoUpdate);let h=e.levels;for(let d=0;d<h.length;d++){let m=h[d],f=s.getObjectByProperty("uuid",m.object);f!==void 0&&s.addLevel(f,m.distance)}}return s}bindSkeletons(e,t){Object.keys(t).length!==0&&e.traverse(function(r){if(r.isSkinnedMesh===!0&&r.skeleton!==void 0){let o=t[r.skeleton];o===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",r.skeleton):r.bind(o,r.bindMatrix)}})}setTexturePath(e){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(e)}},Ooe={UVMapping:Tn,CubeReflectionMapping:oi,CubeRefractionMapping:vi,EquirectangularReflectionMapping:zs,EquirectangularRefractionMapping:Hs,CubeUVReflectionMapping:ii,CubeUVRefractionMapping:An},lF={RepeatWrapping:Hi,ClampToEdgeWrapping:kt,MirroredRepeatWrapping:P0},uF={NearestFilter:nt,NearestMipmapNearestFilter:Qa,NearestMipmapLinearFilter:ec,LinearFilter:at,LinearMipmapNearestFilter:Il,LinearMipmapLinearFilter:Cn};var Tv=new WeakMap,Av=class extends io{constructor(e){super(e);this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,t,r,o){let n=new Ho(this.manager);n.setPath(this.path),n.setResponseType("arraybuffer"),n.setRequestHeader(this.requestHeader),n.setWithCredentials(this.withCredentials),n.load(e,s=>{let a={attributeIDs:this.defaultAttributeIDs,attributeTypes:this.defaultAttributeTypes,useUniqueIDs:!1};this.decodeGeometry(s,a).then(t).catch(o)},r,o)}decodeDracoFile(e,t,r,o){let n={attributeIDs:r||this.defaultAttributeIDs,attributeTypes:o||this.defaultAttributeTypes,useUniqueIDs:!!r};this.decodeGeometry(e,n).then(t)}decodeGeometry(e,t){for(let c in t.attributeTypes){let l=t.attributeTypes[c];l.BYTES_PER_ELEMENT!==void 0&&(t.attributeTypes[c]=l.name)}let r=JSON.stringify(t);if(Tv.has(e)){let c=Tv.get(e);if(c.key===r)return c.promise;if(e.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let o,n=this.workerNextTaskID++,s=e.byteLength,a=this._getWorker(n,s).then(c=>(o=c,new Promise((l,u)=>{o._callbacks[n]={resolve:l,reject:u},o.postMessage({type:"decode",id:n,taskConfig:t,buffer:e},[e])}))).then(c=>this._createGeometry(c.geometry));return a.catch(()=>!0).then(()=>{o&&n&&this._releaseTask(o,n)}),Tv.set(e,{key:r,promise:a}),a}_createGeometry(e){let t=new De;e.index&&t.setIndex(new Ot(e.index.array,1));for(let r=0;r<e.attributes.length;r++){let o=e.attributes[r],n=o.name,s=o.array,a=o.itemSize;t.setAttribute(n,new Ot(s,a))}return t}_loadLibrary(e,t){let r=new Ho(this.manager);return r.setPath(this.decoderPath),r.setResponseType(t),r.setWithCredentials(this.withCredentials),new Promise((o,n)=>{r.load(e,o,void 0,n)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;let e=typeof WebAssembly!="object"||this.decoderConfig.type==="js",t=[];return e?t.push(this._loadLibrary("draco_decoder.js","text")):(t.push(this._loadLibrary("draco_wasm_wrapper.js","text")),t.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(t).then(r=>{let o=r[0];e||(this.decoderConfig.wasmBinary=r[1]);let n=Poe.toString(),s=["/* draco decoder */",o,"","/* worker */",n.substring(n.indexOf("{")+1,n.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([s]))}),this.decoderPending}_getWorker(e,t){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){let o=new Worker(this.workerSourceURL);o._callbacks={},o._taskCosts={},o._taskLoad=0,o.postMessage({type:"init",decoderConfig:this.decoderConfig}),o.onmessage=function(n){let s=n.data;switch(s.type){case"decode":o._callbacks[s.id].resolve(s);break;case"error":o._callbacks[s.id].reject(s);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+s.type+'"')}},this.workerPool.push(o)}else this.workerPool.sort(function(o,n){return o._taskLoad>n._taskLoad?-1:1});let r=this.workerPool[this.workerPool.length-1];return r._taskCosts[e]=t,r._taskLoad+=t,r})}_releaseTask(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]}debug(){console.log("Task load: ",this.workerPool.map(e=>e._taskLoad))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this}};function Poe(){let i,e;onmessage=function(s){let a=s.data;switch(a.type){case"init":i=a.decoderConfig,e=new Promise(function(u){i.onModuleLoaded=function(p){u({draco:p})},DracoDecoderModule(i)});break;case"decode":let c=a.buffer,l=a.taskConfig;e.then(u=>{let p=u.draco,h=new p.Decoder,d=new p.DecoderBuffer;d.Init(new Int8Array(c),c.byteLength);try{let m=t(p,h,d,l),f=m.attributes.map(x=>x.array.buffer);m.index&&f.push(m.index.array.buffer),self.postMessage({type:"decode",id:a.id,geometry:m},f)}catch(m){console.error(m),self.postMessage({type:"error",id:a.id,error:m.message})}finally{p.destroy(d),p.destroy(h)}});break}};function t(s,a,c,l){let u=l.attributeIDs,p=l.attributeTypes,h,d,m=a.GetEncodedGeometryType(c);if(m===s.TRIANGULAR_MESH)h=new s.Mesh,d=a.DecodeBufferToMesh(c,h);else if(m===s.POINT_CLOUD)h=new s.PointCloud,d=a.DecodeBufferToPointCloud(c,h);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!d.ok()||h.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+d.error_msg());let f={index:null,attributes:[]};for(let x in u){let _=self[p[x]],g,T;if(l.useUniqueIDs)T=u[x],g=a.GetAttributeByUniqueId(h,T);else{if(T=a.GetAttributeId(h,s[u[x]]),T===-1)continue;g=a.GetAttribute(h,T)}f.attributes.push(o(s,a,h,x,_,g))}return m===s.TRIANGULAR_MESH&&(f.index=r(s,a,h)),s.destroy(h),f}function r(s,a,c){let u=c.num_faces()*3,p=u*4,h=s._malloc(p);a.GetTrianglesUInt32Array(c,p,h);let d=new Uint32Array(s.HEAPF32.buffer,h,u).slice();return s._free(h),{array:d,itemSize:1}}function o(s,a,c,l,u,p){let h=p.num_components(),m=c.num_points()*h,f=m*u.BYTES_PER_ELEMENT,x=n(s,u),_=s._malloc(f);a.GetAttributeDataArrayForAllPoints(c,p,x,f,_);let g=new u(s.HEAPF32.buffer,_,m).slice();return s._free(_),{name:l,array:g,itemSize:h}}function n(s,a){switch(a){case Float32Array:return s.DT_FLOAT32;case Int8Array:return s.DT_INT8;case Int16Array:return s.DT_INT16;case Int32Array:return s.DT_INT32;case Uint8Array:return s.DT_UINT8;case Uint16Array:return s.DT_UINT16;case Uint32Array:return s.DT_UINT32}}}var f2=class extends io{constructor(e){super(e);typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,r,o){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);let n=this,s=Gl.get(e);if(s!==void 0)return n.manager.itemStart(e),setTimeout(function(){t&&t(s),n.manager.itemEnd(e)},0),s;let a={};a.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",a.headers=this.requestHeader,fetch(e,a).then(function(c){return c.blob()}).then(function(c){return createImageBitmap(c,Object.assign(n.options,{colorSpaceConversion:"none"}))}).then(function(c){Gl.add(e,c),t&&t(c),n.manager.itemEnd(e)}).catch(function(c){o&&o(c),n.manager.itemError(e),n.manager.itemEnd(e)}),n.manager.itemStart(e)}};f2.prototype.isImageBitmapLoader=!0;var Cv="\\[\\]\\.:\\/",Roe=new RegExp("["+Cv+"]","g"),Ev="[^"+Cv+"]",Loe="[^"+Cv.replace("\\.","")+"]",Ioe=/((?:WC+[\/:])*)/.source.replace("WC",Ev),Doe=/(WCOD+)?/.source.replace("WCOD",Loe),koe=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",Ev),Boe=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",Ev),Foe=new RegExp("^"+Ioe+Doe+koe+Boe+"$"),Uoe=["material","materials","bones"],pF=class{constructor(e,t,r){let o=r||Ht.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,o)}getValue(e,t){this.bind();let r=this._targetGroup.nCachedObjects_,o=this._bindings[r];o!==void 0&&o.getValue(e,t)}setValue(e,t){let r=this._bindings;for(let o=this._targetGroup.nCachedObjects_,n=r.length;o!==n;++o)r[o].setValue(e,t)}bind(){let e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].bind()}unbind(){let e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].unbind()}},Ht=class{constructor(e,t,r){this.path=t,this.parsedPath=r||Ht.parseTrackName(t),this.node=Ht.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,r){return e&&e.isAnimationObjectGroup?new Ht.Composite(e,t,r):new Ht(e,t,r)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(Roe,"")}static parseTrackName(e){let t=Foe.exec(e);if(!t)throw new Error("PropertyBinding: Cannot parse trackName: "+e);let r={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},o=r.nodeName&&r.nodeName.lastIndexOf(".");if(o!==void 0&&o!==-1){let n=r.nodeName.substring(o+1);Uoe.indexOf(n)!==-1&&(r.nodeName=r.nodeName.substring(0,o),r.objectName=n)}if(r.propertyName===null||r.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return r}static findNode(e,t){if(!t||t===""||t==="."||t===-1||t===e.name||t===e.uuid)return e;if(e.skeleton){let r=e.skeleton.getBoneByName(t);if(r!==void 0)return r}if(e.children){let r=function(n){for(let s=0;s<n.length;s++){let a=n[s];if(a.name===t||a.uuid===t)return a;let c=r(a.children);if(c)return c}return null},o=r(e.children);if(o)return o}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){let r=this.resolvedProperty;for(let o=0,n=r.length;o!==n;++o)e[t++]=r[o]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){let r=this.resolvedProperty;for(let o=0,n=r.length;o!==n;++o)r[o]=e[t++]}_setValue_array_setNeedsUpdate(e,t){let r=this.resolvedProperty;for(let o=0,n=r.length;o!==n;++o)r[o]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){let r=this.resolvedProperty;for(let o=0,n=r.length;o!==n;++o)r[o]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node,t=this.parsedPath,r=t.objectName,o=t.propertyName,n=t.propertyIndex;if(e||(e=Ht.findNode(this.rootNode,t.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");return}if(r){let l=t.objectIndex;switch(r){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let u=0;u<e.length;u++)if(e[u].name===l){l=u;break}break;default:if(e[r]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[r]}if(l!==void 0){if(e[l]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[l]}}let s=e[o];if(s===void 0){let l=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+l+"."+o+" but it wasn't found.",e);return}let a=this.Versioning.None;this.targetObject=e,e.needsUpdate!==void 0?a=this.Versioning.NeedsUpdate:e.matrixWorldNeedsUpdate!==void 0&&(a=this.Versioning.MatrixWorldNeedsUpdate);let c=this.BindingType.Direct;if(n!==void 0){if(o==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(e.geometry.isBufferGeometry){if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[n]!==void 0&&(n=e.morphTargetDictionary[n])}else{console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);return}}c=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=n}else s.fromArray!==void 0&&s.toArray!==void 0?(c=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(c=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=o;this.getValue=this.GetterByBindingType[c],this.setValue=this.SetterByBindingTypeAndVersioning[c][a]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}};Ht.Composite=pF;Ht.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};Ht.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};Ht.prototype.GetterByBindingType=[Ht.prototype._getValue_direct,Ht.prototype._getValue_array,Ht.prototype._getValue_arrayElement,Ht.prototype._getValue_toArray];Ht.prototype.SetterByBindingTypeAndVersioning=[[Ht.prototype._setValue_direct,Ht.prototype._setValue_direct_setNeedsUpdate,Ht.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Ht.prototype._setValue_array,Ht.prototype._setValue_array_setNeedsUpdate,Ht.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Ht.prototype._setValue_arrayElement,Ht.prototype._setValue_arrayElement_setNeedsUpdate,Ht.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Ht.prototype._setValue_fromArray,Ht.prototype._setValue_fromArray_setNeedsUpdate,Ht.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];var Nv=class extends io{constructor(e){super(e);this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new bF(t)}),this.register(function(t){return new wF(t)}),this.register(function(t){return new MF(t)}),this.register(function(t){return new TF(t)}),this.register(function(t){return new AF(t)}),this.register(function(t){return new CF(t)}),this.register(function(t){return new EF(t)}),this.register(function(t){return new SF(t)}),this.register(function(t){return new xF(t)}),this.register(function(t){return new NF(t)})}load(e,t,r,o){let n=this,s;this.resourcePath!==""?s=this.resourcePath:this.path!==""?s=this.path:s=gn.extractUrlBase(e),this.manager.itemStart(e);let a=function(l){o?o(l):console.error(l),n.manager.itemError(e),n.manager.itemEnd(e)},c=new Ho(this.manager);c.setPath(this.path),c.setResponseType("arraybuffer"),c.setRequestHeader(this.requestHeader),c.setWithCredentials(this.withCredentials),c.load(e,function(l){try{n.parse(l,s,function(u){t(u),n.manager.itemEnd(e)},a)}catch(u){a(u)}},r,a)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e),this}unregister(e){return this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,r,o){let n,s={},a={};if(typeof e=="string")n=e;else if(gn.decodeText(new Uint8Array(e,0,4))===OF){try{s[Tt.KHR_BINARY_GLTF]=new PF(e)}catch(p){o&&o(p);return}n=s[Tt.KHR_BINARY_GLTF].content}else n=gn.decodeText(new Uint8Array(e));let c=JSON.parse(n);if(c.asset===void 0||c.asset.version[0]<2){o&&o(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}let l=new BF(c,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});l.fileLoader.setRequestHeader(this.requestHeader);for(let u=0;u<this.pluginCallbacks.length;u++){let p=this.pluginCallbacks[u](l);a[p.name]=p,s[p.name]=!0}if(c.extensionsUsed)for(let u=0;u<c.extensionsUsed.length;++u){let p=c.extensionsUsed[u],h=c.extensionsRequired||[];switch(p){case Tt.KHR_MATERIALS_UNLIT:s[p]=new yF;break;case Tt.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:s[p]=new IF;break;case Tt.KHR_DRACO_MESH_COMPRESSION:s[p]=new RF(c,this.dracoLoader);break;case Tt.KHR_TEXTURE_TRANSFORM:s[p]=new LF;break;case Tt.KHR_MESH_QUANTIZATION:s[p]=new DF;break;default:h.indexOf(p)>=0&&a[p]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+p+'".')}}l.setExtensions(s),l.setPlugins(a),l.parse(r,o)}parseAsync(e,t){let r=this;return new Promise(function(o,n){r.parse(e,t,o,n)})}};function Voe(){let i={};return{get:function(e){return i[e]},add:function(e,t){i[e]=t},remove:function(e){delete i[e]},removeAll:function(){i={}}}}var Tt={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression"},xF=class{constructor(e){this.parser=e,this.name=Tt.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){let e=this.parser,t=this.parser.json.nodes||[];for(let r=0,o=t.length;r<o;r++){let n=t[r];n.extensions&&n.extensions[this.name]&&n.extensions[this.name].light!==void 0&&e._addNodeRef(this.cache,n.extensions[this.name].light)}}_loadLight(e){let t=this.parser,r="light:"+e,o=t.cache.get(r);if(o)return o;let n=t.json,c=((n.extensions&&n.extensions[this.name]||{}).lights||[])[e],l,u=new he(16777215);c.color!==void 0&&u.fromArray(c.color);let p=c.range!==void 0?c.range:0;switch(c.type){case"directional":l=new Zp(u),l.target.position.set(0,0,-1),l.add(l.target);break;case"point":l=new Jp(u),l.distance=p;break;case"spot":l=new La(u),l.distance=p,c.spot=c.spot||{},c.spot.innerConeAngle=c.spot.innerConeAngle!==void 0?c.spot.innerConeAngle:0,c.spot.outerConeAngle=c.spot.outerConeAngle!==void 0?c.spot.outerConeAngle:Math.PI/4,l.angle=c.spot.outerConeAngle,l.penumbra=1-c.spot.innerConeAngle/c.spot.outerConeAngle,l.target.position.set(0,0,-1),l.add(l.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+c.type)}return l.position.set(0,0,0),l.decay=2,c.intensity!==void 0&&(l.intensity=c.intensity),l.name=t.createUniqueName(c.name||"light_"+e),o=Promise.resolve(l),t.cache.add(r,o),o}createNodeAttachment(e){let t=this,r=this.parser,n=r.json.nodes[e],a=(n.extensions&&n.extensions[this.name]||{}).light;return a===void 0?null:this._loadLight(a).then(function(c){return r._getNodeRef(t.cache,a,c)})}},yF=class{constructor(){this.name=Tt.KHR_MATERIALS_UNLIT}getMaterialType(){return si}extendParams(e,t,r){let o=[];e.color=new he(1,1,1),e.opacity=1;let n=t.pbrMetallicRoughness;if(n){if(Array.isArray(n.baseColorFactor)){let s=n.baseColorFactor;e.color.fromArray(s),e.opacity=s[3]}n.baseColorTexture!==void 0&&o.push(r.assignTexture(e,"map",n.baseColorTexture))}return Promise.all(o)}},bF=class{constructor(e){this.parser=e,this.name=Tt.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){let r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Qo}extendMaterialParams(e,t){let r=this.parser,o=r.json.materials[e];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();let n=[],s=o.extensions[this.name];if(s.clearcoatFactor!==void 0&&(t.clearcoat=s.clearcoatFactor),s.clearcoatTexture!==void 0&&n.push(r.assignTexture(t,"clearcoatMap",s.clearcoatTexture)),s.clearcoatRoughnessFactor!==void 0&&(t.clearcoatRoughness=s.clearcoatRoughnessFactor),s.clearcoatRoughnessTexture!==void 0&&n.push(r.assignTexture(t,"clearcoatRoughnessMap",s.clearcoatRoughnessTexture)),s.clearcoatNormalTexture!==void 0&&(n.push(r.assignTexture(t,"clearcoatNormalMap",s.clearcoatNormalTexture)),s.clearcoatNormalTexture.scale!==void 0)){let a=s.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new G(a,a)}return Promise.all(n)}},TF=class{constructor(e){this.parser=e,this.name=Tt.KHR_MATERIALS_SHEEN}getMaterialType(e){let r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Qo}extendMaterialParams(e,t){let r=this.parser,o=r.json.materials[e];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();let n=[];t.sheenColor=new he(0,0,0),t.sheenRoughness=0,t.sheen=1;let s=o.extensions[this.name];return s.sheenColorFactor!==void 0&&t.sheenColor.fromArray(s.sheenColorFactor),s.sheenRoughnessFactor!==void 0&&(t.sheenRoughness=s.sheenRoughnessFactor),s.sheenColorTexture!==void 0&&n.push(r.assignTexture(t,"sheenColorMap",s.sheenColorTexture)),s.sheenRoughnessTexture!==void 0&&n.push(r.assignTexture(t,"sheenRoughnessMap",s.sheenRoughnessTexture)),Promise.all(n)}},AF=class{constructor(e){this.parser=e,this.name=Tt.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){let r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Qo}extendMaterialParams(e,t){let r=this.parser,o=r.json.materials[e];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();let n=[],s=o.extensions[this.name];return s.transmissionFactor!==void 0&&(t.transmission=s.transmissionFactor),s.transmissionTexture!==void 0&&n.push(r.assignTexture(t,"transmissionMap",s.transmissionTexture)),Promise.all(n)}},CF=class{constructor(e){this.parser=e,this.name=Tt.KHR_MATERIALS_VOLUME}getMaterialType(e){let r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Qo}extendMaterialParams(e,t){let r=this.parser,o=r.json.materials[e];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();let n=[],s=o.extensions[this.name];t.thickness=s.thicknessFactor!==void 0?s.thicknessFactor:0,s.thicknessTexture!==void 0&&n.push(r.assignTexture(t,"thicknessMap",s.thicknessTexture)),t.attenuationDistance=s.attenuationDistance||0;let a=s.attenuationColor||[1,1,1];return t.attenuationColor=new he(a[0],a[1],a[2]),Promise.all(n)}},EF=class{constructor(e){this.parser=e,this.name=Tt.KHR_MATERIALS_IOR}getMaterialType(e){let r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Qo}extendMaterialParams(e,t){let o=this.parser.json.materials[e];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();let n=o.extensions[this.name];return t.ior=n.ior!==void 0?n.ior:1.5,Promise.resolve()}},SF=class{constructor(e){this.parser=e,this.name=Tt.KHR_MATERIALS_SPECULAR}getMaterialType(e){let r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Qo}extendMaterialParams(e,t){let r=this.parser,o=r.json.materials[e];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();let n=[],s=o.extensions[this.name];t.specularIntensity=s.specularFactor!==void 0?s.specularFactor:1,s.specularTexture!==void 0&&n.push(r.assignTexture(t,"specularIntensityMap",s.specularTexture));let a=s.specularColorFactor||[1,1,1];return t.specularColor=new he(a[0],a[1],a[2]),s.specularColorTexture!==void 0&&n.push(r.assignTexture(t,"specularColorMap",s.specularColorTexture).then(function(c){c.encoding=bt})),Promise.all(n)}},wF=class{constructor(e){this.parser=e,this.name=Tt.KHR_TEXTURE_BASISU}loadTexture(e){let t=this.parser,r=t.json,o=r.textures[e];if(!o.extensions||!o.extensions[this.name])return null;let n=o.extensions[this.name],s=r.images[n.source],a=t.options.ktx2Loader;if(!a){if(r.extensionsRequired&&r.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,s,a)}},MF=class{constructor(e){this.parser=e,this.name=Tt.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){let t=this.name,r=this.parser,o=r.json,n=o.textures[e];if(!n.extensions||!n.extensions[t])return null;let s=n.extensions[t],a=o.images[s.source],c=r.textureLoader;if(a.uri){let l=r.options.manager.getHandler(a.uri);l!==null&&(c=l)}return this.detectSupport().then(function(l){if(l)return r.loadTextureImage(e,a,c);if(o.extensionsRequired&&o.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return r.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){let t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}},NF=class{constructor(e){this.name=Tt.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){let t=this.parser.json,r=t.bufferViews[e];if(r.extensions&&r.extensions[this.name]){let o=r.extensions[this.name],n=this.parser.getDependency("buffer",o.buffer),s=this.parser.options.meshoptDecoder;if(!s||!s.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return Promise.all([n,s.ready]).then(function(a){let c=o.byteOffset||0,l=o.byteLength||0,u=o.count,p=o.byteStride,h=new ArrayBuffer(u*p),d=new Uint8Array(a[0],c,l);return s.decodeGltfBuffer(new Uint8Array(h),u,p,d,o.mode,o.filter),h})}else return null}},OF="glTF",$f=12,hF={JSON:1313821514,BIN:5130562},PF=class{constructor(e){this.name=Tt.KHR_BINARY_GLTF,this.content=null,this.body=null;let t=new DataView(e,0,$f);if(this.header={magic:gn.decodeText(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==OF)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");let r=this.header.length-$f,o=new DataView(e,$f),n=0;for(;n<r;){let s=o.getUint32(n,!0);n+=4;let a=o.getUint32(n,!0);if(n+=4,a===hF.JSON){let c=new Uint8Array(e,$f+n,s);this.content=gn.decodeText(c)}else if(a===hF.BIN){let c=$f+n;this.body=e.slice(c,c+s)}n+=s}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}},RF=class{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=Tt.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){let r=this.json,o=this.dracoLoader,n=e.extensions[this.name].bufferView,s=e.extensions[this.name].attributes,a={},c={},l={};for(let u in s){let p=wv[u]||u.toLowerCase();a[p]=s[u]}for(let u in e.attributes){let p=wv[u]||u.toLowerCase();if(s[u]!==void 0){let h=r.accessors[e.attributes[u]],d=Jf[h.componentType];l[p]=d,c[p]=h.normalized===!0}}return t.getDependency("bufferView",n).then(function(u){return new Promise(function(p){o.decodeDracoFile(u,function(h){for(let d in h.attributes){let m=h.attributes[d],f=c[d];f!==void 0&&(m.normalized=f)}p(h)},a,l)})})}},LF=class{constructor(){this.name=Tt.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return t.texCoord!==void 0&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),t.offset===void 0&&t.rotation===void 0&&t.scale===void 0||(e=e.clone(),t.offset!==void 0&&e.offset.fromArray(t.offset),t.rotation!==void 0&&(e.rotation=t.rotation),t.scale!==void 0&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}},m2=class extends Ei{constructor(e){super();this.isGLTFSpecularGlossinessMaterial=!0;let t=["#ifdef USE_SPECULARMAP","	uniform sampler2D specularMap;","#endif"].join(`
`),r=["#ifdef USE_GLOSSINESSMAP","	uniform sampler2D glossinessMap;","#endif"].join(`
`),o=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","	vec4 texelSpecular = texture2D( specularMap, vUv );","	// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","	specularFactor *= texelSpecular.rgb;","#endif"].join(`
`),n=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","	vec4 texelGlossiness = texture2D( glossinessMap, vUv );","	// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","	glossinessFactor *= texelGlossiness.a;","#endif"].join(`
`),s=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb * ( 1. - max( specularFactor.r, max( specularFactor.g, specularFactor.b ) ) );","vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );","material.roughness = max( 1.0 - glossinessFactor, 0.0525 ); // 0.0525 corresponds to the base mip of a 256 cubemap.","material.roughness += geometryRoughness;","material.roughness = min( material.roughness, 1.0 );","material.specularColor = specularFactor;"].join(`
`),a={specular:{value:new he().setHex(16777215)},glossiness:{value:1},specularMap:{value:null},glossinessMap:{value:null}};this._extraUniforms=a,this.onBeforeCompile=function(c){for(let l in a)c.uniforms[l]=a[l];c.fragmentShader=c.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;").replace("uniform float metalness;","uniform float glossiness;").replace("#include <roughnessmap_pars_fragment>",t).replace("#include <metalnessmap_pars_fragment>",r).replace("#include <roughnessmap_fragment>",o).replace("#include <metalnessmap_fragment>",n).replace("#include <lights_physical_fragment>",s)},Object.defineProperties(this,{specular:{get:function(){return a.specular.value},set:function(c){a.specular.value=c}},specularMap:{get:function(){return a.specularMap.value},set:function(c){a.specularMap.value=c,c?this.defines.USE_SPECULARMAP="":delete this.defines.USE_SPECULARMAP}},glossiness:{get:function(){return a.glossiness.value},set:function(c){a.glossiness.value=c}},glossinessMap:{get:function(){return a.glossinessMap.value},set:function(c){a.glossinessMap.value=c,c?(this.defines.USE_GLOSSINESSMAP="",this.defines.USE_UV=""):(delete this.defines.USE_GLOSSINESSMAP,delete this.defines.USE_UV)}}}),delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this.setValues(e)}copy(e){return super.copy(e),this.specularMap=e.specularMap,this.specular.copy(e.specular),this.glossinessMap=e.glossinessMap,this.glossiness=e.glossiness,delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this}},IF=class{constructor(){this.name=Tt.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,this.specularGlossinessParams=["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","normalMapType","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity","refractionRatio"]}getMaterialType(){return m2}extendParams(e,t,r){let o=t.extensions[this.name];e.color=new he(1,1,1),e.opacity=1;let n=[];if(Array.isArray(o.diffuseFactor)){let s=o.diffuseFactor;e.color.fromArray(s),e.opacity=s[3]}if(o.diffuseTexture!==void 0&&n.push(r.assignTexture(e,"map",o.diffuseTexture)),e.emissive=new he(0,0,0),e.glossiness=o.glossinessFactor!==void 0?o.glossinessFactor:1,e.specular=new he(1,1,1),Array.isArray(o.specularFactor)&&e.specular.fromArray(o.specularFactor),o.specularGlossinessTexture!==void 0){let s=o.specularGlossinessTexture;n.push(r.assignTexture(e,"glossinessMap",s)),n.push(r.assignTexture(e,"specularMap",s))}return Promise.all(n)}createMaterial(e){let t=new m2(e);return t.fog=!0,t.color=e.color,t.map=e.map===void 0?null:e.map,t.lightMap=null,t.lightMapIntensity=1,t.aoMap=e.aoMap===void 0?null:e.aoMap,t.aoMapIntensity=1,t.emissive=e.emissive,t.emissiveIntensity=1,t.emissiveMap=e.emissiveMap===void 0?null:e.emissiveMap,t.bumpMap=e.bumpMap===void 0?null:e.bumpMap,t.bumpScale=1,t.normalMap=e.normalMap===void 0?null:e.normalMap,t.normalMapType=ni,e.normalScale&&(t.normalScale=e.normalScale),t.displacementMap=null,t.displacementScale=1,t.displacementBias=0,t.specularMap=e.specularMap===void 0?null:e.specularMap,t.specular=e.specular,t.glossinessMap=e.glossinessMap===void 0?null:e.glossinessMap,t.glossiness=e.glossiness,t.alphaMap=null,t.envMap=e.envMap===void 0?null:e.envMap,t.envMapIntensity=1,t.refractionRatio=.98,t}},DF=class{constructor(){this.name=Tt.KHR_MESH_QUANTIZATION}},za=class extends Wo{constructor(e,t,r,o){super(e,t,r,o)}copySampleValue_(e){let t=this.resultBuffer,r=this.sampleValues,o=this.valueSize,n=e*o*3+o;for(let s=0;s!==o;s++)t[s]=r[n+s];return t}};za.prototype.beforeStart_=za.prototype.copySampleValue_;za.prototype.afterEnd_=za.prototype.copySampleValue_;za.prototype.interpolate_=function(i,e,t,r){let o=this.resultBuffer,n=this.sampleValues,s=this.valueSize,a=s*2,c=s*3,l=r-e,u=(t-e)/l,p=u*u,h=p*u,d=i*c,m=d-c,f=-2*h+3*p,x=h-p,_=1-f,g=x-p+u;for(let T=0;T!==s;T++){let b=n[m+T+s],y=n[m+T+a]*l,A=n[d+T+s],E=n[d+T]*l;o[T]=_*b+g*y+f*A+x*E}return o};var Goe=new Nt,kF=class extends za{interpolate_(e,t,r,o){let n=super.interpolate_(e,t,r,o);return Goe.fromArray(n).normalize().toArray(n),n}},w0={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},Jf={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},dF={9728:nt,9729:at,9984:Qa,9985:Il,9986:ec,9987:Cn},fF={33071:kt,33648:P0,10497:Hi},mF={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},wv={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},Ga={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},zoe={CUBICSPLINE:void 0,LINEAR:Ws,STEP:js},Sv={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function Hoe(i){return i.DefaultMaterial===void 0&&(i.DefaultMaterial=new Ei({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:oo})),i.DefaultMaterial}function Kf(i,e,t){for(let r in t.extensions)i[r]===void 0&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[r]=t.extensions[r])}function _l(i,e){e.extras!==void 0&&(typeof e.extras=="object"?Object.assign(i.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function joe(i,e,t){let r=!1,o=!1;for(let a=0,c=e.length;a<c;a++){let l=e[a];if(l.POSITION!==void 0&&(r=!0),l.NORMAL!==void 0&&(o=!0),r&&o)break}if(!r&&!o)return Promise.resolve(i);let n=[],s=[];for(let a=0,c=e.length;a<c;a++){let l=e[a];if(r){let u=l.POSITION!==void 0?t.getDependency("accessor",l.POSITION):i.attributes.position;n.push(u)}if(o){let u=l.NORMAL!==void 0?t.getDependency("accessor",l.NORMAL):i.attributes.normal;s.push(u)}}return Promise.all([Promise.all(n),Promise.all(s)]).then(function(a){let c=a[0],l=a[1];return r&&(i.morphAttributes.position=c),o&&(i.morphAttributes.normal=l),i.morphTargetsRelative=!0,i})}function Woe(i,e){if(i.updateMorphTargets(),e.weights!==void 0)for(let t=0,r=e.weights.length;t<r;t++)i.morphTargetInfluences[t]=e.weights[t];if(e.extras&&Array.isArray(e.extras.targetNames)){let t=e.extras.targetNames;if(i.morphTargetInfluences.length===t.length){i.morphTargetDictionary={};for(let r=0,o=t.length;r<o;r++)i.morphTargetDictionary[t[r]]=r}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function qoe(i){let e=i.extensions&&i.extensions[Tt.KHR_DRACO_MESH_COMPRESSION],t;return e?t="draco:"+e.bufferView+":"+e.indices+":"+_F(e.attributes):t=i.indices+":"+_F(i.attributes)+":"+i.mode,t}function _F(i){let e="",t=Object.keys(i).sort();for(let r=0,o=t.length;r<o;r++)e+=t[r]+":"+i[t[r]]+";";return e}function Mv(i){switch(i){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}var BF=class{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new Voe,this.associations=new Map,this.primitiveCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.textureCache={},this.nodeNamesUsed={},typeof createImageBitmap<"u"&&/Firefox|^((?!chrome|android).)*safari/i.test(navigator.userAgent)===!1?this.textureLoader=new f2(this.options.manager):this.textureLoader=new Kd(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new Ho(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){let r=this,o=this.json,n=this.extensions;this.cache.removeAll(),this._invokeAll(function(s){return s._markDefs&&s._markDefs()}),Promise.all(this._invokeAll(function(s){return s.beforeRoot&&s.beforeRoot()})).then(function(){return Promise.all([r.getDependencies("scene"),r.getDependencies("animation"),r.getDependencies("camera")])}).then(function(s){let a={scene:s[0][o.scene||0],scenes:s[0],animations:s[1],cameras:s[2],asset:o.asset,parser:r,userData:{}};Kf(n,a,o),_l(a,o),Promise.all(r._invokeAll(function(c){return c.afterRoot&&c.afterRoot(a)})).then(function(){e(a)})}).catch(t)}_markDefs(){let e=this.json.nodes||[],t=this.json.skins||[],r=this.json.meshes||[];for(let o=0,n=t.length;o<n;o++){let s=t[o].joints;for(let a=0,c=s.length;a<c;a++)e[s[a]].isBone=!0}for(let o=0,n=e.length;o<n;o++){let s=e[o];s.mesh!==void 0&&(this._addNodeRef(this.meshCache,s.mesh),s.skin!==void 0&&(r[s.mesh].isSkinnedMesh=!0)),s.camera!==void 0&&this._addNodeRef(this.cameraCache,s.camera)}}_addNodeRef(e,t){t!==void 0&&(e.refs[t]===void 0&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,r){if(e.refs[t]<=1)return r;let o=r.clone(),n=(s,a)=>{let c=this.associations.get(s);c!=null&&this.associations.set(a,c);for(let[l,u]of s.children.entries())n(u,a.children[l])};return n(r,o),o.name+="_instance_"+e.uses[t]++,o}_invokeOne(e){let t=Object.values(this.plugins);t.push(this);for(let r=0;r<t.length;r++){let o=e(t[r]);if(o)return o}return null}_invokeAll(e){let t=Object.values(this.plugins);t.unshift(this);let r=[];for(let o=0;o<t.length;o++){let n=e(t[o]);n&&r.push(n)}return r}getDependency(e,t){let r=e+":"+t,o=this.cache.get(r);if(!o){switch(e){case"scene":o=this.loadScene(t);break;case"node":o=this.loadNode(t);break;case"mesh":o=this._invokeOne(function(n){return n.loadMesh&&n.loadMesh(t)});break;case"accessor":o=this.loadAccessor(t);break;case"bufferView":o=this._invokeOne(function(n){return n.loadBufferView&&n.loadBufferView(t)});break;case"buffer":o=this.loadBuffer(t);break;case"material":o=this._invokeOne(function(n){return n.loadMaterial&&n.loadMaterial(t)});break;case"texture":o=this._invokeOne(function(n){return n.loadTexture&&n.loadTexture(t)});break;case"skin":o=this.loadSkin(t);break;case"animation":o=this.loadAnimation(t);break;case"camera":o=this.loadCamera(t);break;default:throw new Error("Unknown type: "+e)}this.cache.add(r,o)}return o}getDependencies(e){let t=this.cache.get(e);if(!t){let r=this,o=this.json[e+(e==="mesh"?"es":"s")]||[];t=Promise.all(o.map(function(n,s){return r.getDependency(e,s)})),this.cache.add(e,t)}return t}loadBuffer(e){let t=this.json.buffers[e],r=this.fileLoader;if(t.type&&t.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(t.uri===void 0&&e===0)return Promise.resolve(this.extensions[Tt.KHR_BINARY_GLTF].body);let o=this.options;return new Promise(function(n,s){r.load(gn.resolveURL(t.uri,o.path),n,void 0,function(){s(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){let t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(r){let o=t.byteLength||0,n=t.byteOffset||0;return r.slice(n,n+o)})}loadAccessor(e){let t=this,r=this.json,o=this.json.accessors[e];if(o.bufferView===void 0&&o.sparse===void 0)return Promise.resolve(null);let n=[];return o.bufferView!==void 0?n.push(this.getDependency("bufferView",o.bufferView)):n.push(null),o.sparse!==void 0&&(n.push(this.getDependency("bufferView",o.sparse.indices.bufferView)),n.push(this.getDependency("bufferView",o.sparse.values.bufferView))),Promise.all(n).then(function(s){let a=s[0],c=mF[o.type],l=Jf[o.componentType],u=l.BYTES_PER_ELEMENT,p=u*c,h=o.byteOffset||0,d=o.bufferView!==void 0?r.bufferViews[o.bufferView].byteStride:void 0,m=o.normalized===!0,f,x;if(d&&d!==p){let _=Math.floor(h/d),g="InterleavedBuffer:"+o.bufferView+":"+o.componentType+":"+_+":"+o.count,T=t.cache.get(g);T||(f=new l(a,_*d,o.count*d/u),T=new Zs(f,d/u),t.cache.add(g,T)),x=new wi(T,c,h%d/u,m)}else a===null?f=new l(o.count*c):f=new l(a,h,o.count*c),x=new Ot(f,c,m);if(o.sparse!==void 0){let _=mF.SCALAR,g=Jf[o.sparse.indices.componentType],T=o.sparse.indices.byteOffset||0,b=o.sparse.values.byteOffset||0,y=new g(s[1],T,o.sparse.count*_),A=new l(s[2],b,o.sparse.count*c);a!==null&&(x=new Ot(x.array.slice(),x.itemSize,x.normalized));for(let E=0,S=y.length;E<S;E++){let M=y[E];if(x.setX(M,A[E*c]),c>=2&&x.setY(M,A[E*c+1]),c>=3&&x.setZ(M,A[E*c+2]),c>=4&&x.setW(M,A[E*c+3]),c>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return x})}loadTexture(e){let t=this.json,r=this.options,o=t.textures[e],n=t.images[o.source],s=this.textureLoader;if(n.uri){let a=r.manager.getHandler(n.uri);a!==null&&(s=a)}return this.loadTextureImage(e,n,s)}loadTextureImage(e,t,r){let o=this,n=this.json,s=this.options,a=n.textures[e],c=(t.uri||t.bufferView)+":"+a.sampler;if(this.textureCache[c])return this.textureCache[c];let l=self.URL||self.webkitURL,u=t.uri||"",p=!1;if(t.bufferView!==void 0)u=o.getDependency("bufferView",t.bufferView).then(function(d){p=!0;let m=new Blob([d],{type:t.mimeType});return u=l.createObjectURL(m),u});else if(t.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");let h=Promise.resolve(u).then(function(d){return new Promise(function(m,f){let x=m;r.isImageBitmapLoader===!0&&(x=function(_){let g=new gr(_);g.needsUpdate=!0,m(g)}),r.load(gn.resolveURL(d,s.path),x,void 0,f)})}).then(function(d){p===!0&&l.revokeObjectURL(u),d.flipY=!1,a.name&&(d.name=a.name);let f=(n.samplers||{})[a.sampler]||{};return d.magFilter=dF[f.magFilter]||at,d.minFilter=dF[f.minFilter]||Cn,d.wrapS=fF[f.wrapS]||Hi,d.wrapT=fF[f.wrapT]||Hi,o.associations.set(d,{textures:e}),d}).catch(function(){return console.error("THREE.GLTFLoader: Couldn't load texture",u),null});return this.textureCache[c]=h,h}assignTexture(e,t,r){let o=this;return this.getDependency("texture",r.index).then(function(n){if(r.texCoord!==void 0&&r.texCoord!=0&&!(t==="aoMap"&&r.texCoord==1)&&console.warn("THREE.GLTFLoader: Custom UV set "+r.texCoord+" for texture "+t+" not yet supported."),o.extensions[Tt.KHR_TEXTURE_TRANSFORM]){let s=r.extensions!==void 0?r.extensions[Tt.KHR_TEXTURE_TRANSFORM]:void 0;if(s){let a=o.associations.get(n);n=o.extensions[Tt.KHR_TEXTURE_TRANSFORM].extendTexture(n,s),o.associations.set(n,a)}}return e[t]=n,n})}assignFinalMaterial(e){let t=e.geometry,r=e.material,o=t.attributes.tangent===void 0,n=t.attributes.color!==void 0,s=t.attributes.normal===void 0;if(e.isPoints){let a="PointsMaterial:"+r.uuid,c=this.cache.get(a);c||(c=new Xs,Bt.prototype.copy.call(c,r),c.color.copy(r.color),c.map=r.map,c.sizeAttenuation=!1,this.cache.add(a,c)),r=c}else if(e.isLine){let a="LineBasicMaterial:"+r.uuid,c=this.cache.get(a);c||(c=new ur,Bt.prototype.copy.call(c,r),c.color.copy(r.color),this.cache.add(a,c)),r=c}if(o||n||s){let a="ClonedMaterial:"+r.uuid+":";r.isGLTFSpecularGlossinessMaterial&&(a+="specular-glossiness:"),o&&(a+="derivative-tangents:"),n&&(a+="vertex-colors:"),s&&(a+="flat-shading:");let c=this.cache.get(a);c||(c=r.clone(),n&&(c.vertexColors=!0),s&&(c.flatShading=!0),o&&(c.normalScale&&(c.normalScale.y*=-1),c.clearcoatNormalScale&&(c.clearcoatNormalScale.y*=-1)),this.cache.add(a,c),this.associations.set(c,this.associations.get(r))),r=c}r.aoMap&&t.attributes.uv2===void 0&&t.attributes.uv!==void 0&&t.setAttribute("uv2",t.attributes.uv),e.material=r}getMaterialType(){return Ei}loadMaterial(e){let t=this,r=this.json,o=this.extensions,n=r.materials[e],s,a={},c=n.extensions||{},l=[];if(c[Tt.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){let p=o[Tt.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];s=p.getMaterialType(),l.push(p.extendParams(a,n,t))}else if(c[Tt.KHR_MATERIALS_UNLIT]){let p=o[Tt.KHR_MATERIALS_UNLIT];s=p.getMaterialType(),l.push(p.extendParams(a,n,t))}else{let p=n.pbrMetallicRoughness||{};if(a.color=new he(1,1,1),a.opacity=1,Array.isArray(p.baseColorFactor)){let h=p.baseColorFactor;a.color.fromArray(h),a.opacity=h[3]}p.baseColorTexture!==void 0&&l.push(t.assignTexture(a,"map",p.baseColorTexture)),a.metalness=p.metallicFactor!==void 0?p.metallicFactor:1,a.roughness=p.roughnessFactor!==void 0?p.roughnessFactor:1,p.metallicRoughnessTexture!==void 0&&(l.push(t.assignTexture(a,"metalnessMap",p.metallicRoughnessTexture)),l.push(t.assignTexture(a,"roughnessMap",p.metallicRoughnessTexture))),s=this._invokeOne(function(h){return h.getMaterialType&&h.getMaterialType(e)}),l.push(Promise.all(this._invokeAll(function(h){return h.extendMaterialParams&&h.extendMaterialParams(e,a)})))}n.doubleSided===!0&&(a.side=uo);let u=n.alphaMode||Sv.OPAQUE;if(u===Sv.BLEND?(a.transparent=!0,a.depthWrite=!1):(a.transparent=!1,u===Sv.MASK&&(a.alphaTest=n.alphaCutoff!==void 0?n.alphaCutoff:.5)),n.normalTexture!==void 0&&s!==si&&(l.push(t.assignTexture(a,"normalMap",n.normalTexture)),a.normalScale=new G(1,1),n.normalTexture.scale!==void 0)){let p=n.normalTexture.scale;a.normalScale.set(p,p)}return n.occlusionTexture!==void 0&&s!==si&&(l.push(t.assignTexture(a,"aoMap",n.occlusionTexture)),n.occlusionTexture.strength!==void 0&&(a.aoMapIntensity=n.occlusionTexture.strength)),n.emissiveFactor!==void 0&&s!==si&&(a.emissive=new he().fromArray(n.emissiveFactor)),n.emissiveTexture!==void 0&&s!==si&&l.push(t.assignTexture(a,"emissiveMap",n.emissiveTexture)),Promise.all(l).then(function(){let p;return s===m2?p=o[Tt.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(a):p=new s(a),n.name&&(p.name=n.name),p.map&&(p.map.encoding=bt),p.emissiveMap&&(p.emissiveMap.encoding=bt),_l(p,n),t.associations.set(p,{materials:e}),n.extensions&&Kf(o,p,n),p})}createUniqueName(e){let t=Ht.sanitizeNodeName(e||""),r=t;for(let o=1;this.nodeNamesUsed[r];++o)r=t+"_"+o;return this.nodeNamesUsed[r]=!0,r}loadGeometries(e){let t=this,r=this.extensions,o=this.primitiveCache;function n(a){return r[Tt.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(a,t).then(function(c){return gF(c,a,t)})}let s=[];for(let a=0,c=e.length;a<c;a++){let l=e[a],u=qoe(l),p=o[u];if(p)s.push(p.promise);else{let h;l.extensions&&l.extensions[Tt.KHR_DRACO_MESH_COMPRESSION]?h=n(l):h=gF(new De,l,t),o[u]={primitive:l,promise:h},s.push(h)}}return Promise.all(s)}loadMesh(e){let t=this,r=this.json,o=this.extensions,n=r.meshes[e],s=n.primitives,a=[];for(let c=0,l=s.length;c<l;c++){let u=s[c].material===void 0?Hoe(this.cache):this.getDependency("material",s[c].material);a.push(u)}return a.push(t.loadGeometries(s)),Promise.all(a).then(function(c){let l=c.slice(0,c.length-1),u=c[c.length-1],p=[];for(let d=0,m=u.length;d<m;d++){let f=u[d],x=s[d],_,g=l[d];if(x.mode===w0.TRIANGLES||x.mode===w0.TRIANGLE_STRIP||x.mode===w0.TRIANGLE_FAN||x.mode===void 0)_=n.isSkinnedMesh===!0?new z0(f,g):new lt(f,g),_.isSkinnedMesh===!0&&!_.geometry.attributes.skinWeight.normalized&&_.normalizeSkinWeights(),x.mode===w0.TRIANGLE_STRIP?_.geometry=vF(_.geometry,jx):x.mode===w0.TRIANGLE_FAN&&(_.geometry=vF(_.geometry,t3));else if(x.mode===w0.LINES)_=new Br(f,g);else if(x.mode===w0.LINE_STRIP)_=new cs(f,g);else if(x.mode===w0.LINE_LOOP)_=new qp(f,g);else if(x.mode===w0.POINTS)_=new Xi(f,g);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+x.mode);Object.keys(_.geometry.morphAttributes).length>0&&Woe(_,n),_.name=t.createUniqueName(n.name||"mesh_"+e),_l(_,n),x.extensions&&Kf(o,_,x),t.assignFinalMaterial(_),p.push(_)}for(let d=0,m=p.length;d<m;d++)t.associations.set(p[d],{meshes:e,primitives:d});if(p.length===1)return p[0];let h=new ut;t.associations.set(h,{meshes:e});for(let d=0,m=p.length;d<m;d++)h.add(p[d]);return h})}loadCamera(e){let t,r=this.json.cameras[e],o=r[r.type];if(!o){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return r.type==="perspective"?t=new ir(ph(o.yfov),o.aspectRatio||1,o.znear||1,o.zfar||2e6):r.type==="orthographic"&&(t=new ps(-o.xmag,o.xmag,o.ymag,-o.ymag,o.znear,o.zfar)),r.name&&(t.name=this.createUniqueName(r.name)),_l(t,r),Promise.resolve(t)}loadSkin(e){let t=this.json.skins[e],r={joints:t.joints};return t.inverseBindMatrices===void 0?Promise.resolve(r):this.getDependency("accessor",t.inverseBindMatrices).then(function(o){return r.inverseBindMatrices=o,r})}loadAnimation(e){let r=this.json.animations[e],o=[],n=[],s=[],a=[],c=[];for(let l=0,u=r.channels.length;l<u;l++){let p=r.channels[l],h=r.samplers[p.sampler],d=p.target,m=d.node!==void 0?d.node:d.id,f=r.parameters!==void 0?r.parameters[h.input]:h.input,x=r.parameters!==void 0?r.parameters[h.output]:h.output;o.push(this.getDependency("node",m)),n.push(this.getDependency("accessor",f)),s.push(this.getDependency("accessor",x)),a.push(h),c.push(d)}return Promise.all([Promise.all(o),Promise.all(n),Promise.all(s),Promise.all(a),Promise.all(c)]).then(function(l){let u=l[0],p=l[1],h=l[2],d=l[3],m=l[4],f=[];for(let _=0,g=u.length;_<g;_++){let T=u[_],b=p[_],y=h[_],A=d[_],E=m[_];if(T===void 0)continue;T.updateMatrix(),T.matrixAutoUpdate=!0;let S;switch(Ga[E.path]){case Ga.weights:S=Ba;break;case Ga.rotation:S=Bs;break;case Ga.position:case Ga.scale:default:S=Ua;break}let M=T.name?T.name:T.uuid,L=A.interpolation!==void 0?zoe[A.interpolation]:Ws,C=[];Ga[E.path]===Ga.weights?T.traverse(function(D){D.morphTargetInfluences&&C.push(D.name?D.name:D.uuid)}):C.push(M);let N=y.array;if(y.normalized){let D=Mv(N.constructor),k=new Float32Array(N.length);for(let z=0,F=N.length;z<F;z++)k[z]=N[z]*D;N=k}for(let D=0,k=C.length;D<k;D++){let z=new S(C[D]+"."+Ga[E.path],b.array,N,L);A.interpolation==="CUBICSPLINE"&&(z.createInterpolant=function(X){let $=this instanceof Bs?kF:za;return new $(this.times,this.values,this.getValueSize()/3,X)},z.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),f.push(z)}}let x=r.name?r.name:"animation_"+e;return new Wf(x,void 0,f)})}createNodeMesh(e){let t=this.json,r=this,o=t.nodes[e];return o.mesh===void 0?null:r.getDependency("mesh",o.mesh).then(function(n){let s=r._getNodeRef(r.meshCache,o.mesh,n);return o.weights!==void 0&&s.traverse(function(a){if(!!a.isMesh)for(let c=0,l=o.weights.length;c<l;c++)a.morphTargetInfluences[c]=o.weights[c]}),s})}loadNode(e){let t=this.json,r=this.extensions,o=this,n=t.nodes[e],s=n.name?o.createUniqueName(n.name):"";return function(){let a=[],c=o._invokeOne(function(l){return l.createNodeMesh&&l.createNodeMesh(e)});return c&&a.push(c),n.camera!==void 0&&a.push(o.getDependency("camera",n.camera).then(function(l){return o._getNodeRef(o.cameraCache,n.camera,l)})),o._invokeAll(function(l){return l.createNodeAttachment&&l.createNodeAttachment(e)}).forEach(function(l){a.push(l)}),Promise.all(a)}().then(function(a){let c;if(n.isBone===!0?c=new fs:a.length>1?c=new ut:a.length===1?c=a[0]:c=new vt,c!==a[0])for(let l=0,u=a.length;l<u;l++)c.add(a[l]);if(n.name&&(c.userData.name=n.name,c.name=s),_l(c,n),n.extensions&&Kf(r,c,n),n.matrix!==void 0){let l=new Ve;l.fromArray(n.matrix),c.applyMatrix4(l)}else n.translation!==void 0&&c.position.fromArray(n.translation),n.rotation!==void 0&&c.quaternion.fromArray(n.rotation),n.scale!==void 0&&c.scale.fromArray(n.scale);return o.associations.has(c)||o.associations.set(c,{}),o.associations.get(c).nodes=e,c})}loadScene(e){let t=this.json,r=this.extensions,o=this.json.scenes[e],n=this,s=new ut;o.name&&(s.name=n.createUniqueName(o.name)),_l(s,o),o.extensions&&Kf(r,s,o);let a=o.nodes||[],c=[];for(let l=0,u=a.length;l<u;l++)c.push(FF(a[l],s,t,n));return Promise.all(c).then(function(){let l=u=>{let p=new Map;for(let[h,d]of n.associations)(h instanceof Bt||h instanceof gr)&&p.set(h,d);return u.traverse(h=>{let d=n.associations.get(h);d!=null&&p.set(h,d)}),p};return n.associations=l(s),s})}};function FF(i,e,t,r){let o=t.nodes[i];return r.getDependency("node",i).then(function(n){if(o.skin===void 0)return n;let s;return r.getDependency("skin",o.skin).then(function(a){s=a;let c=[];for(let l=0,u=s.joints.length;l<u;l++)c.push(r.getDependency("node",s.joints[l]));return Promise.all(c)}).then(function(a){return n.traverse(function(c){if(!c.isMesh)return;let l=[],u=[];for(let p=0,h=a.length;p<h;p++){let d=a[p];if(d){l.push(d);let m=new Ve;s.inverseBindMatrices!==void 0&&m.fromArray(s.inverseBindMatrices.array,p*16),u.push(m)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',s.joints[p])}c.bind(new ul(l,u),c.matrixWorld)}),n})}).then(function(n){e.add(n);let s=[];if(o.children){let a=o.children;for(let c=0,l=a.length;c<l;c++){let u=a[c];s.push(FF(u,n,t,r))}}return Promise.all(s)})}function Xoe(i,e,t){let r=e.attributes,o=new Bl;if(r.POSITION!==void 0){let a=t.json.accessors[r.POSITION],c=a.min,l=a.max;if(c!==void 0&&l!==void 0){if(o.set(new w(c[0],c[1],c[2]),new w(l[0],l[1],l[2])),a.normalized){let u=Mv(Jf[a.componentType]);o.min.multiplyScalar(u),o.max.multiplyScalar(u)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;let n=e.targets;if(n!==void 0){let a=new w,c=new w;for(let l=0,u=n.length;l<u;l++){let p=n[l];if(p.POSITION!==void 0){let h=t.json.accessors[p.POSITION],d=h.min,m=h.max;if(d!==void 0&&m!==void 0){if(c.setX(Math.max(Math.abs(d[0]),Math.abs(m[0]))),c.setY(Math.max(Math.abs(d[1]),Math.abs(m[1]))),c.setZ(Math.max(Math.abs(d[2]),Math.abs(m[2]))),h.normalized){let f=Mv(Jf[h.componentType]);c.multiplyScalar(f)}a.max(c)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}o.expandByVector(a)}i.boundingBox=o;let s=new Fl;o.getCenter(s.center),s.radius=o.min.distanceTo(o.max)/2,i.boundingSphere=s}function gF(i,e,t){let r=e.attributes,o=[];function n(s,a){return t.getDependency("accessor",s).then(function(c){i.setAttribute(a,c)})}for(let s in r){let a=wv[s]||s.toLowerCase();a in i.attributes||o.push(n(r[s],a))}if(e.indices!==void 0&&!i.index){let s=t.getDependency("accessor",e.indices).then(function(a){i.setIndex(a)});o.push(s)}return _l(i,e),Xoe(i,e,t),Promise.all(o).then(function(){return e.targets!==void 0?joe(i,e.targets,t):i})}function vF(i,e){let t=i.getIndex();if(t===null){let s=[],a=i.getAttribute("position");if(a!==void 0){for(let c=0;c<a.count;c++)s.push(c);i.setIndex(s),t=i.getIndex()}else return console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),i}let r=t.count-2,o=[];if(e===t3)for(let s=1;s<=r;s++)o.push(t.getX(0)),o.push(t.getX(s)),o.push(t.getX(s+1));else for(let s=0;s<r;s++)s%2===0?(o.push(t.getX(s)),o.push(t.getX(s+1)),o.push(t.getX(s+2))):(o.push(t.getX(s+2)),o.push(t.getX(s+1)),o.push(t.getX(s)));o.length/3!==r&&console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");let n=i.clone();return n.setIndex(o),n}var Ha=class extends Uo{static reset(){this.gltfLoader=void 0,this.gltfdracoLoader=void 0,this.dracoLoader=void 0}async load(e){let t=await(e.draco?Ha.GLTFDRACOLoader(e.node):Ha.GLTFLoader(e.node));if(!t)return;let r=await this._urlToLoad();return new Promise(o=>{t.load(r,n=>{let s=Ha.onLoadSuccessGLTF(n);o(s)},n=>{},n=>{var s;(s=e.node)==null||s.states.error.set(n.message)})})}static onLoadSuccessGLTF(e){let t=e.scene||e.scenes[0];return t.animations=e.animations,[t]}static async GLTFLoader(e){let t=Q.modulesRegister.module(pt.GLTFLoader);if(t)return this.gltfLoader=this.gltfLoader||new t(Ep)}static async GLTFDRACOLoader(e){if(Q.modulesRegister.module(pt.GLTFLoader))return this.gltfdracoLoader=this.gltfdracoLoader||await this.createGLTFLoaderWithDRACO({useJS:!1},e)}static async createGLTFLoaderWithDRACO(e,t){let r=new Nv(Ep);return await this.setupDRACO(r,e,t),r}static async setupDRACO(e,t,r){Q.modulesRegister.module(pt.DRACOLoader)&&(this.dracoLoader=this.dracoLoader||await this._createDRACOLoader(t,r),e.setDRACOLoader(this.dracoLoader))}static async _createDRACOLoader(e,t){let r=new Av(Ep),o=Q.libs.root(),n=Q.libs.DRACOGLTFPath();if(o||n){let s=`${o||""}${n||""}/`,a=e.useJS?["draco_decoder.js"]:["draco_decoder.wasm","draco_wasm_wrapper.js"];await this._loadMultipleBlobGlobal({files:a.map(c=>({fullUrl:`${s}${c}`})),node:t,error:"failed to load draco libraries. Make sure to install them to load .glb files"}),r.setDecoderPath(s)}else r.setDecoderPath(void 0);return r.setDecoderConfig({type:e.useJS?"js":"wasm"}),r.preload(),r}};var Ov=(i=>(i.AUTO="auto",i.DRC="drc",i.FBX="fbx",i.JSON="json",i.GLTF="gltf",i.GLTF_WITH_DRACO="gltf_with_draco",i.LDRAW="ldraw",i.OBJ="obj",i.PDB="pdb",i.PLY="ply",i.STL="stl",i))(Ov||{}),UF=["auto","drc","fbx","json","gltf","gltf_with_draco","ldraw","obj","pdb","ply","stl"];var So=class extends Uo{constructor(i,e,t){super(i.url,e,t);this._options=i,this._scene=e,this._node=t}load(i,e){this._load().then(t=>{i(t)}).catch(t=>{e(t)})}_load(){return this._node&&Q.blobs.clearBlobsForNode(this._node),new Promise(async(i,e)=>{let t=await this._urlToLoad(),r=this.extension();if(r=="json"&&this._options.format=="auto")So.incrementInProgressLoadsCount(),await So.waitForMaxConcurrentLoadsQueueFreed(),fetch(t).then(async o=>{let n=await o.json();new bv(this.loadingManager).parse(n,a=>{So.decrementInProgressLoadsCount(),i(this._onLoadSuccess(a.children[0]))})}).catch(o=>{So.decrementInProgressLoadsCount(),e(o)});else{let o=await this._loaderForFormat();if(o)So.incrementInProgressLoadsCount(),await So.waitForMaxConcurrentLoadsQueueFreed(),o.load(t,n=>{this._onLoadSuccess(n).then(s=>{So.decrementInProgressLoadsCount(),i(s)})},void 0,n=>{Q.warn("error loading",t,n),So.decrementInProgressLoadsCount(),e(n)});else{let n=`format not supported (${r})`;e(n)}}})}async _onLoadSuccess(i){let e=this.extension();if(e=="json")return[i];let t=i;if(t.isObject3D)switch(e){case"pdb":return this._onLoadSuccessPDB(i);case"obj":return[t];case"mpd":return t.rotation.x=Math.PI,t.updateMatrix(),[t];default:return[t]}let r=i;if(r.isBufferGeometry)switch(e){case"drc":return this._onLoadSuccessDRC(r);default:return[new lt(r)]}let o=i;if(o.scene!=null||o.scenes!=null)switch(e){case"gltf":case"glb":return Ha.onLoadSuccessGLTF(o);default:return[t]}let n=i;if(n.geometryAtoms||n.geometryBonds)switch(e){case"pdb":return this._onLoadSuccessPDB(n);default:return[]}return[]}_onLoadSuccessDRC(i){return[new lt(i,So._default_mat_mesh)]}_onLoadSuccessPDB(i){let e=new Xi(i.geometryAtoms,So._default_mat_point),t=new Br(i.geometryBonds,So._default_mat_line);return[e,t]}static moduleNamesFromFormat(i,e){switch(i){case"auto":return this.moduleNamesFromExt(e);case"drc":return[pt.DRACOLoader];case"fbx":return[pt.FBXLoader];case"json":return[];case"gltf":return[pt.GLTFLoader];case"gltf_with_draco":return[pt.GLTFLoader,pt.DRACOLoader];case"ldraw":return[pt.LDrawLoader];case"obj":return[pt.OBJLoader];case"pdb":return[pt.PDBLoader];case"ply":return[pt.PLYLoader];case"stl":return[pt.STLLoader]}Be.unreachable(i)}static moduleNamesFromExt(i){switch(i){case"drc":return[pt.DRACOLoader];case"fbx":return[pt.FBXLoader];case"gltf":return[pt.GLTFLoader];case"glb":return[pt.GLTFLoader,pt.DRACOLoader];case"obj":return[pt.OBJLoader];case"pdb":return[pt.PDBLoader];case"ply":return[pt.PLYLoader];case"stl":return[pt.STLLoader]}}async _loaderForFormat(){let i=this._options.format;switch(i){case"auto":return this._loaderForExt();case"drc":return this.loader_for_drc(this._node);case"fbx":return this.loader_for_fbx();case"json":return;case"gltf":return this.loader_for_gltf();case"gltf_with_draco":return this.loader_for_glb(this._node);case"ldraw":return this.loader_for_ldraw();case"obj":return this.loader_for_obj();case"pdb":return this.loader_for_pdb();case"ply":return this.loader_for_ply();case"stl":return this.loader_for_stl()}Be.unreachable(i)}async _loaderForExt(){switch(this.extension().toLowerCase()){case"drc":return this.loader_for_drc(this._node);case"fbx":return this.loader_for_fbx();case"gltf":return this.loader_for_gltf();case"glb":return this.loader_for_glb(this._node);case"mpd":return this.loader_for_ldraw();case"obj":return this.loader_for_obj();case"pdb":return this.loader_for_pdb();case"ply":return this.loader_for_ply();case"stl":return this.loader_for_stl()}}loader_for_fbx(){let i=Q.modulesRegister.module(pt.FBXLoader);if(i)return new i(this.loadingManager)}loader_for_gltf(){let i=Q.modulesRegister.module(pt.GLTFLoader);if(i)return new i(this.loadingManager)}static async loader_for_drc(i){let e=Q.modulesRegister.module(pt.DRACOLoader);if(e){let r=new e(this.loadingManager),o=Q.libs.root(),n=Q.libs.DRACOPath();if(o||n){let s=`${o||""}${n||""}/`;if(i){let a=["draco_decoder.js"];await this._loadMultipleBlobGlobal({files:a.map(c=>({storedUrl:`${s}/${c}`,fullUrl:`${s}${c}`})),node:i,error:"failed to load draco libraries. Make sure to install them to load .glb files"})}r.setDecoderPath(s)}else r.setDecoderPath(void 0);return r.setDecoderConfig({type:"js"}),r}}loader_for_drc(i){return So.loader_for_drc(i)}static loader_for_ldraw(i){let e=Q.modulesRegister.module(pt.LDrawLoader);if(e)return new e(this.loadingManager)}loader_for_ldraw(i){return So.loader_for_ldraw(i)}static async loader_for_glb(i){return await Ha.GLTFDRACOLoader(i)}loader_for_glb(i){return So.loader_for_glb(i)}loader_for_obj(){let i=Q.modulesRegister.module(pt.OBJLoader);if(i)return new i(this.loadingManager)}loader_for_pdb(){let i=Q.modulesRegister.module(pt.PDBLoader);if(i)return new i(this.loadingManager)}loader_for_ply(){let i=Q.modulesRegister.module(pt.PLYLoader);if(i)return new i(this.loadingManager)}loader_for_stl(){let i=Q.modulesRegister.module(pt.STLLoader);if(i)return new i(this.loadingManager)}static setMaxConcurrentLoadsCount(i){this._maxConcurrentLoadsCountMethod=i}static _initMaxConcurrentLoadsCount(){return this._maxConcurrentLoadsCountMethod?this._maxConcurrentLoadsCountMethod():Pi.isChrome()?4:1}static _initConcurrentLoadsDelay(){return Pi.isChrome()?1:10}static incrementInProgressLoadsCount(){this._inProgressLoadsCount++}static decrementInProgressLoadsCount(){this._inProgressLoadsCount--;let i=this._queue.pop();if(i){let e=this.CONCURRENT_LOADS_DELAY;setTimeout(()=>{i()},e)}}static async waitForMaxConcurrentLoadsQueueFreed(){if(!(this._inProgressLoadsCount<=this.MAX_CONCURRENT_LOADS_COUNT))return new Promise(i=>{this._queue.push(i)})}},es=So;es._default_mat_mesh=new Lp;es._default_mat_point=new Xs;es._default_mat_line=new ur;es.MAX_CONCURRENT_LOADS_COUNT=So._initMaxConcurrentLoadsCount();es.CONCURRENT_LOADS_DELAY=So._initConcurrentLoadsDelay();es._inProgressLoadsCount=0;es._queue=[];var VF=class extends Qe{static type(){return"file"}static loader(i,e,t){return new es({url:i.url,format:i.format},e,t)}cook(i,e){if(!this._node)return this.createCoreGroupFromObjects([]);let t=VF.loader(e,this.scene(),this._node);return new Promise(r=>{t.load(o=>{let n=this._onLoad(o,e);r(this.createCoreGroupFromObjects(n))},o=>{this._onError(o,e)})})}_onLoad(i,e){for(let t of i)t.traverse(r=>{this._ensureGeometryHasIndex(r),e.matrixAutoUpdate||r.updateMatrix(),r.matrixAutoUpdate=e.matrixAutoUpdate});return i}_onError(i,e){var t;(t=this.states)==null||t.error.set(`could not load geometry from ${e.url} (${i})`)}_ensureGeometryHasIndex(i){let t=i.geometry;t&&this.createIndexIfNone(t)}},_2=VF;_2.DEFAULT_PARAMS={url:`${Jd}/models/wolf.obj`,format:Ov.AUTO,matrixAutoUpdate:!1};var GF=_2.DEFAULT_PARAMS,zF=class extends V{constructor(){super(...arguments);this.url=v.STRING(GF.url,{fileBrowse:{type:[pc.GEOMETRY]}}),this.format=v.STRING(GF.format,{menuString:{entries:UF.map(e=>({name:e,value:e}))}}),this.matrixAutoUpdate=v.BOOLEAN(0),this.reload=v.BUTTON(null,{callback:e=>{g2.PARAM_CALLBACK_reload(e)}})}},Yoe=new zF,g2=class extends et{constructor(){super(...arguments);this.paramsConfig=Yoe}static type(){return"file"}async requiredModules(){for(let r of[this.p.url,this.p.format])r.isDirty()&&await r.compute();let e=Uo.extension(this.pv.url||""),t=this.pv.format;return es.moduleNamesFromFormat(t,e)}dispose(){super.dispose(),Q.blobs.clearBlobsForNode(this)}operation(){return this._operation=this._operation||new _2(this.scene(),this.states,this)}async cook(e){let t=await this.operation().cook(e,this.pv);this.setCoreGroup(t)}static PARAM_CALLBACK_reload(e){e._paramCallbackReload()}_paramCallbackReload(){this.p.url.setDirty()}};var HF=class extends V{constructor(){super(...arguments);this.dist=v.FLOAT(.1,{range:[0,1],rangeLocked:[!0,!1]})}},$oe=new HF,Pv=class extends et{constructor(){super(...arguments);this.paramsConfig=$oe}static type(){return"fuse"}static displayedInputNames(){return["points to fuse together"]}initializeNode(){this.io.inputs.setCount(1),this.io.inputs.initInputsClonedState(Ge.FROM_NODE)}cook(e){let t=e[0],r=[],o;for(let n of t.coreObjects())o=this._fuse_core_object(n),o&&r.push(o);this.setObjects(r)}_fuse_core_object(e){let t=e.object();if(!t)return;let r=e.points(),o=this.pv.dist,n=new Map;for(let a of r){let c=a.position(),u=new w(Math.round(c.x/o),Math.round(c.y/o),Math.round(c.z/o)).toArray().join("-");Ft.pushOnArrayAtEntry(n,u,a)}let s=[];if(n.forEach((a,c)=>{s.push(a[0])}),t.geometry.dispose(),s.length>0){let a=Ut.geometryFromPoints(s,Zi(t.constructor));return a&&(t.geometry=a),t}}};var ja=(i=>(i.ADD_PARENT="add_parent",i.REMOVE_PARENT="remove_parent",i.ADD_CHILD="add_child",i))(ja||{}),gl=["add_parent","remove_parent","add_child"],vl=class extends Qe{static type(){return"hierarchy"}cook(e,t){let r=e[0],o=gl[t.mode];switch(o){case"add_parent":{let n=this._add_parent_to_core_group(r,t);return this.createCoreGroupFromObjects(n)}case"remove_parent":{let n=this._remove_parent_from_core_group(r,t);return this.createCoreGroupFromObjects(n)}case"add_child":{let n=this._add_child_to_core_group(r,e[1],t);return this.createCoreGroupFromObjects(n)}}Be.unreachable(o)}_add_parent_to_core_group(e,t){return t.levels==0?e.objects():[this._add_parent_to_object(e.objects(),t)]}_add_parent_to_object(e,t){let r=new ut;if(r.matrixAutoUpdate=!1,r.add(...e),t.levels>0)for(let o=0;o<t.levels-1;o++)r=this._add_new_parent(r,t);return r}_add_new_parent(e,t){let r=new ut;return r.matrixAutoUpdate=!1,r.add(e),r}_remove_parent_from_core_group(e,t){if(t.levels==0)return e.objects();{let r=[];for(let o of e.objects()){let n=this._remove_parent_from_object(o,t);for(let s of n)r.push(s)}return r}}_remove_parent_from_object(e,t){let r=e.children;for(let o=0;o<t.levels-1;o++)r=this._get_children_from_objects(r,t);return r}_get_children_from_objects(e,t){let r,o=[];for(;r=e.pop();)if(r.children)for(let n of r.children)o.push(n);return o}_add_child_to_core_group(e,t,r){var o,n;let s=e.objects();if(!t)return(o=this.states)==null||o.error.set("input 1 is invalid"),[];let a=t.objects(),c=r.objectMask.trim(),u=c!=""?this._findObjectsByMaskFromObjects(c,s):s;r.debugObjectMask&&console.log(u);for(let p=0;p<u.length;p++){let h=u[p],d=a[p]||a[0];if(!d)return(n=this.states)==null||n.error.set("no objects found in input 1"),[];h.add(d)}return s}_findObjectsByMaskFromObjects(e,t){let r=[];for(let o of t)this.scene().objectsController.objectsByMaskInObject(e,o,r);return r}};vl.DEFAULT_PARAMS={mode:0,levels:1,objectMask:"",debugObjectMask:!1};vl.INPUT_CLONED_STATE=Ge.FROM_NODE;var Vgt=[ja.ADD_PARENT,ja.REMOVE_PARENT],jF=vl.DEFAULT_PARAMS,WF=class extends V{constructor(){super(...arguments);this.mode=v.INTEGER(jF.mode,{menu:{entries:gl.map((e,t)=>({name:e,value:t}))}}),this.levels=v.INTEGER(jF.levels,{range:[0,5],visibleIf:[{mode:gl.indexOf(ja.ADD_PARENT)},{mode:gl.indexOf(ja.REMOVE_PARENT)}]}),this.objectMask=v.STRING("",{visibleIf:{mode:gl.indexOf(ja.ADD_CHILD)}}),this.debugObjectMask=v.BOOLEAN(0,{visibleIf:{mode:gl.indexOf(ja.ADD_CHILD)}})}},Koe=new WF,Rv=class extends et{constructor(){super(...arguments);this.paramsConfig=Koe}static type(){return"hierarchy"}static displayedInputNames(){return["geometry to add or remove parents to/from","objects to use as parent or children (optional)"]}initializeNode(){this.io.inputs.setCount(1,2),this.io.inputs.initInputsClonedState(vl.INPUT_CLONED_STATE)}cook(e){this._operation=this._operation||new vl(this._scene,this.states);let t=this._operation.cook(e,this.pv);this.setCoreGroup(t)}};function Joe(i){return Math.atan2(i.z,-i.x)}function Zoe(i){return Math.atan2(-i.y,Math.sqrt(i.x*i.x+i.z*i.z))}var Lv=class extends De{constructor(e,t,r,o,n){super();this.type="PolyhedronBufferGeometry",this.parameters={vertices:e,indices:t,radius:r,detail:o},r=r||1,o=o||0;let s=[],a=[],c=new Map;l(o),p(r),h(),this.setAttribute("position",new Ce(s,3)),this.setAttribute("uv",new Ce(a,2)),n||(this.setAttribute("normal",new Ce(s.slice(),3)),o===0?this.computeVertexNormals():this.normalizeNormals());function l(f){let x=new w,_=new w,g=new w;for(let T=0;T<t.length;T+=3)m(t[T+0],x),m(t[T+1],_),m(t[T+2],g),u(x,_,g,f)}function u(f,x,_,g){let T=g+1,b=[];for(let y=0;y<=T;y++){b[y]=[];let A=f.clone().lerp(_,y/T),E=x.clone().lerp(_,y/T),S=T-y;for(let M=0;M<=S;M++)M===0&&y===T?b[y][M]=A:b[y][M]=A.clone().lerp(E,M/S)}for(let y=0;y<T;y++)for(let A=0;A<2*(T-y)-1;A++){let E=Math.floor(A/2);A%2===0?(d(b[y][E+1]),d(b[y+1][E]),d(b[y][E])):(d(b[y][E+1]),d(b[y+1][E+1]),d(b[y+1][E]))}}function p(f){let x=new w;for(let _=0;_<s.length;_+=3)x.x=s[_+0],x.y=s[_+1],x.z=s[_+2],x.normalize().multiplyScalar(f),s[_+0]=x.x,s[_+1]=x.y,s[_+2]=x.z}function h(){let f=new w;for(let x=0;x<s.length;x+=3){f.x=s[x+0],f.y=s[x+1],f.z=s[x+2];let _=Joe(f)/2/Math.PI+.5,g=Zoe(f)/Math.PI+.5;a.push(_,1-g)}}function d(f){if(n){let x=c.get(f.x);if(x){let g=x.get(f.y);if(g&&g.has(f.z))return}x||(x=new Map,c.set(f.x,x));let _=x.get(f.y);_||(_=new Set,x.set(f.y,_)),_.add(f.z)}s.push(f.x,f.y,f.z)}function m(f,x){let _=f*3;x.x=e[_+0],x.y=e[_+1],x.z=e[_+2]}}};var Iv=class extends Lv{constructor(e,t,r){let o=(1+Math.sqrt(5))/2,n=[-1,o,0,1,o,0,-1,-o,0,1,-o,0,0,-1,o,0,1,o,0,-1,-o,0,1,-o,o,0,-1,o,0,1,-o,0,-1,-o,0,1],s=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(n,s,e,t,r);this.type="IcosahedronBufferGeometry",this.parameters={radius:e,detail:t}}};var Zf=class extends Qe{static type(){return"icosahedron"}cook(e,t){let r=t.pointsOnly,o=new Iv(t.radius,t.detail,r);if(o.translate(t.center.x,t.center.y,t.center.z),r){let n=this.createObject(o,$t.POINTS);return this.createCoreGroupFromObjects([n])}else return o.computeVertexNormals(),this.createCoreGroupFromGeometry(o)}};Zf.DEFAULT_PARAMS={radius:1,detail:0,pointsOnly:!1,center:new w(0,0,0)};var v2=Zf.DEFAULT_PARAMS,qF=class extends V{constructor(){super(...arguments);this.radius=v.FLOAT(v2.radius),this.detail=v.INTEGER(v2.detail,{range:[0,10],rangeLocked:[!0,!1]}),this.pointsOnly=v.BOOLEAN(v2.pointsOnly),this.center=v.VECTOR3(v2.center)}},Qoe=new qF,Dv=class extends et{constructor(){super(...arguments);this.paramsConfig=Qoe}static type(){return"icosahedron"}cook(){this._operation=this._operation||new Zf(this._scene,this.states);let e=this._operation.cook([],this.pv);this.setCoreGroup(e)}};var XF=class{constructor(){this._id=XF.__next_id++}id(){return this._id}handle_globals_node(i,e,t){}},Qf=XF;Qf.__next_id=0;var kv=class{constructor(e){this.node=e,this._initialized=!1,this._checkParamsEditableStateBound=this._checkParamsEditableState.bind(this)}initializeNode(){if(this._initialized){console.warn("already initialized",this.node);return}this._initialized=!0,this.node.io.inputs.add_on_set_input_hook("_checkParamsEditableStateBound",this._checkParamsEditableStateBound)}initialized(){return this._initialized}_checkParamsEditableState(){this._paramsMatchEditableState()||this.updateParamsEditableStateIfNeeded()}_paramsMatchEditableState(){let e=0,t=this.node.params;for(let r of this.node.io.inputs.namedInputConnectionPoints()){if(r){let o=this.node.io.inputs.input(e)!=null,n=r==null?void 0:r.name();if(t.has(n)){let a=t.get(n);if(a){let c=!o,l=a.options.editable();if(c!=l)return!1}}}e++}return!0}updateParamsEditableStateIfNeeded(){let e=0,t=this.node.params;for(let r of this.node.io.inputs.namedInputConnectionPoints()){if(r){let o=this.node.io.inputs.input(e)!=null,n=r==null?void 0:r.name();if(t.has(n)){let s=t.get(n);if(s){let a=!o;s.options.setEditableState(a)}}}e++}}};var eie=/\/+/g,M0=class extends dr{constructor(){super(...arguments);this._paramsEditableStatesController=new kv(this)}static context(){return oe.GL}initializeBaseNode(){this.uiData.setLayoutHorizontal(),this.io.connections.initInputs(),this.io.connection_points.spare_params.initializeNode(),this._paramsEditableStatesController.initializeNode()}cook(){console.warn("gl node cooking")}_setMatToRecompile(){var e,t;(t=(e=this.materialNode())==null?void 0:e.assemblerController())==null||t.set_compilation_required_and_dirty(this)}materialNode(){let e=this.parent();if(e)return e.context()==oe.GL?e==null?void 0:e.materialNode():e}glVarName(e){return`v_POLY_${this.path(this.materialNode()).replace(eie,"_")}_${e}`}variableForInputParam(e){return this.variableForInput(e.name())}variableForInput(e){var t;let r=this.io.inputs.getInputIndex(e),o=this.io.connections.inputConnection(r);if(o){let n=o.node_src,s=n.io.outputs.namedOutputConnectionPoints()[o.output_index];if(s){let a=s.name();return n.glVarName(a)}else throw console.warn(`no output called '${e}' for gl node ${n.path()}`),"variable_for_input ERROR"}else{if(this.params.has(e))return Na.any((t=this.params.get(e))==null?void 0:t.value);{let n=this.io.inputs.namedInputConnectionPoints()[r];return Na.any(n.init_value)}}}setLines(e){}reset_code(){var e;(e=this._param_configs_controller)==null||e.reset()}setParamConfigs(){}param_configs(){var e;return(e=this._param_configs_controller)==null?void 0:e.list()}paramsGenerating(){return!1}paramDefaultValue(e){return null}};var YF=class extends V{},pvt=new YF;var x2=[mo.FLOAT,mo.VEC2,mo.VEC3,mo.VEC4],$F=class extends V{constructor(){super(...arguments);this.name=v.STRING("attribute1"),this.type=v.INTEGER(0,{menu:{entries:x2.map((e,t)=>({name:e,value:t}))}}),this.texportWhenConnected=v.BOOLEAN(0,{hidden:!0}),this.exportWhenConnected=v.BOOLEAN(0,{visibleIf:{texportWhenConnected:1}})}},tie=new $F,xl=class extends M0{constructor(){super(...arguments);this.paramsConfig=tie,this._bound_setExportWhenConnectedStatus=this._setExportWhenConnectedStatus.bind(this)}static type(){return Oh.ATTRIBUTE}initializeNode(){this.addPostDirtyHook("_setMatToRecompile",this._setMatToRecompileIfIsExporting.bind(this)),this.io.connection_points.initializeNode(),this.io.connection_points.set_expected_input_types_function(()=>{var i,e;return((e=(i=this.materialNode())==null?void 0:i.assemblerController())==null?void 0:e.allow_attribute_exports())?[x2[this.pv.type]]:[]}),this.io.connection_points.set_input_name_function(i=>xl.INPUT_NAME),this.io.connection_points.set_expected_output_types_function(()=>[x2[this.pv.type]]),this.lifecycle.onAfterAdded(this._bound_setExportWhenConnectedStatus),this.params.addOnSceneLoadHook("prepare params",this._bound_setExportWhenConnectedStatus)}_setExportWhenConnectedStatus(){var i,e;((e=(i=this.materialNode())==null?void 0:i.assemblerController())==null?void 0:e.allow_attribute_exports())&&this.p.texportWhenConnected.set(1)}setAttribSize(i){this.p.type.set(i-1)}inputName(){return xl.INPUT_NAME}outputName(){return xl.OUTPUT_NAME}varyingName(){return`v_POLY_attribute_${this.pv.name}`}setLines(i){i.assembler().setNodeLinesAttribute(this,i)}attributeName(){return this.pv.name.trim()}glType(){return this.io.outputs.namedOutputConnectionPoints()[0].type()}setGlType(i){this.p.type.set(x2.indexOf(i))}connected_input_node(){return this.io.inputs.named_input(xl.INPUT_NAME)}connected_input_connection_point(){return this.io.inputs.named_input_connection_point(xl.INPUT_NAME)}output_connection_point(){return this.io.outputs.namedOutputConnectionPointsByName(this.outputName())}isImporting(){return this.io.outputs.used_output_names().length>0}isExporting(){return this.pv.exportWhenConnected?this.io.inputs.named_input(xl.INPUT_NAME)!=null:!1}_setMatToRecompileIfIsExporting(){this.pv.exportWhenConnected&&this._setMatToRecompile()}},ts=xl;ts.INPUT_NAME="in";ts.OUTPUT_NAME="val";var Bv=class{constructor(e=[]){this._definitions=e,this._errored=!1}get errored(){return this._errored}get error_message(){return this._error_message}uniq(){let e=new Map,t=[];for(let o of this._definitions)if(!this._errored){let n=o.name(),s=e.get(n);s?s.data_type!=o.data_type&&(this._errored=!0,this._error_message=`attempt to create '${o.name()}' with types '${o.data_type}' by node '${o.node.path()}', when there is already an existing with type ${s.data_type} from node '${s.node.path()}'`,console.warn("emitting error message:",this._error_message)):(e.set(n,o),t.push(n))}let r=[];for(let o of t){let n=e.get(o);n&&r.push(n)}return r}};var y2=class{constructor(e,t,r,o){this._definition_type=e,this._data_type=t,this._node=r,this._name=o}get definition_type(){return this._definition_type}get data_type(){return this._data_type}get node(){return this._node}name(){return this._name}collection_instance(){return new Bv}},em=class extends y2{constructor(e,t,r){super("attribute",t,e,r);this._node=e,this._data_type=t,this._name=r}get line(){return`attribute ${this.data_type} ${this.name()}`}};var Fv=class extends y2{constructor(e,t,r){super("uniform",t,e,r);this._node=e,this._data_type=t,this._name=r}get line(){return`uniform ${this.data_type} ${this.name()}`}},Wa=class extends y2{constructor(e,t,r){super("varying",t,e,r);this._node=e,this._data_type=t,this._name=r}get line(){return`varying ${this.data_type} ${this.name()}`}};var ei=(i=>(i.VERTEX="vertex",i.FRAGMENT="fragment",i.LEAVES_FROM_NODES_SHADER="leaves_from_nodes_shader",i))(ei||{});var rie={position:"vec3( position )"},tm=class extends Qf{handle_globals_node(i,e,t){var r,o;let n=i.io.outputs.namedOutputConnectionPointsByName(e);if(!n)return;let s=i.glVarName(e),a=n.type(),c=new Wa(i,a,s);t.addDefinitions(i,[c]);let l=(o=(r=i.materialNode())==null?void 0:r.assemblerController())==null?void 0:o.assembler;if(!l)return;let u=l.shader_config(t.currentShaderName());if(!u)return;let p=u.dependencies(),h=[],d=`${s} = modelMatrix * vec4( position, 1.0 )`,m=`${s} = normalize( mat3( modelMatrix[0].xyz, modelMatrix[1].xyz, modelMatrix[2].xyz ) * normal )`;switch(e){case"worldPosition":{h.push(d);break}case"worldNormal":{h.push(m);break}default:h.push(`${s} = ${a}(${e})`)}for(let f of p)t.addDefinitions(i,[c],f),t.addBodyLines(i,h,f);p.length==0&&t.addBodyLines(i,h)}static variable_config_default(i){return rie[i]}variable_config_default(i){return tm.variable_config_default(i)}readAttribute(i,e,t,r){return tm.readAttribute(i,e,t,r)}static readAttribute(i,e,t,r){var o,n;tm.PRE_DEFINED_ATTRIBUTES.indexOf(t)<0&&r.addDefinitions(i,[new em(i,e,t)],ei.VERTEX);let s=r.currentShaderName();switch(s){case ei.VERTEX:return t;case ei.FRAGMENT:{if(!(i instanceof ts))return;let c=i.varyingName(),l=new Wa(i,e,c),u=new Map;u.set(ei.FRAGMENT,[]);let p=new Map;p.set(ei.FRAGMENT,[]),Ft.pushOnArrayAtEntry(u,s,l);let h=`${c} = ${e}(${t})`,d=(n=(o=i.materialNode())==null?void 0:o.assemblerController())==null?void 0:n.assembler.shader_config(s);if(d){let m=d.dependencies();for(let f of m)Ft.pushOnArrayAtEntry(u,f,l),Ft.pushOnArrayAtEntry(p,f,h);u.forEach((f,x)=>{r.addDefinitions(i,f,x)}),p.forEach((f,x)=>{r.addBodyLines(i,f,x)})}return c}}}handle_attribute_node(i,e,t,r){return tm.readAttribute(i,e,t,r)}},N0=tm;N0.PRE_DEFINED_ATTRIBUTES=["position","color","normal","uv","uv2","morphTarget0","morphTarget1","morphTarget2","morphTarget3","skinIndex","skinWeight"];N0.IF_RULE={uv:"defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )"};var yl=class extends Qe{static type(){return"instance"}async cook(e,t){let r=e[0];this._geometry=void 0;let o=r.objectsWithGeo()[0];if(o){let n=o.geometry;if(n){let s=e[1];this._create_instance(n,s,t)}}if(this._geometry){let n=Kw(o);if(n){let s=this.createObject(this._geometry,n);if(t.applyMaterial){let a=await this._get_material(t);a&&await this._applyMaterial(s,a)}return this.createCoreGroupFromObjects([s])}}return this.createCoreGroupFromObjects([])}async _get_material(e){var t;if(e.applyMaterial){let r=e.material.nodeWithContext(oe.MAT,(t=this.states)==null?void 0:t.error);if(r){this._globalsHandler=this._globalsHandler||new N0;let n=r.assemblerController();return n&&n.setAssemblerGlobalsHandler(this._globalsHandler),(await r.compute()).material()}}}async _applyMaterial(e,t){e.material=t,Qi.applyCustomMaterials(e,t)}_create_instance(e,t,r){this._geometry=Pn.createInstanceBufferGeometry(e,t,r.attributesToCopy)}};yl.DEFAULT_PARAMS={attributesToCopy:"instance*",applyMaterial:!0,material:new Ci("")};yl.INPUT_CLONED_STATE=[Ge.ALWAYS,Ge.NEVER];var KF=yl.DEFAULT_PARAMS,JF=class extends V{constructor(){super(...arguments);this.attributesToCopy=v.STRING(KF.attributesToCopy),this.applyMaterial=v.BOOLEAN(KF.applyMaterial),this.material=v.NODE_PATH("",{visibleIf:{applyMaterial:1},nodeSelection:{context:oe.MAT},dependentOnFoundNode:!1})}},oie=new JF,Uv=class extends et{constructor(){super(...arguments);this.paramsConfig=oie}static type(){return"instance"}static displayedInputNames(){return["geometry to be instanciated","points to instance to"]}initializeNode(){super.initializeNode(),this.io.inputs.setCount(2),this.io.inputs.initInputsClonedState(yl.INPUT_CLONED_STATE)}async cook(e){this._operation=this._operation||new yl(this.scene(),this.states);let t=await this._operation.cook(e,this.pv);this.setCoreGroup(t)}};var bl=class extends Qe{static type(){return"jitter"}cook(e,t){let r=e[0],o=r.points(),n;for(let s=0;s<o.length;s++){n=o[s];let a=new w(2*(Er.randFloat(s*75+764+t.seed)-.5),2*(Er.randFloat(s*5678+3653+t.seed)-.5),2*(Er.randFloat(s*657+48464+t.seed)-.5));a.normalize(),a.multiply(t.mult),a.multiplyScalar(t.amount*Er.randFloat(s*78+54+t.seed));let c=n.position().clone().add(a);n.setPosition(c)}return r}};bl.DEFAULT_PARAMS={amount:1,mult:new w(1,1,1),seed:1};bl.INPUT_CLONED_STATE=Ge.FROM_NODE;var Vv=bl.DEFAULT_PARAMS,ZF=class extends V{constructor(){super(...arguments);this.amount=v.FLOAT(Vv.amount),this.mult=v.VECTOR3(Vv.mult),this.seed=v.INTEGER(Vv.seed,{range:[0,100]})}},iie=new ZF,Gv=class extends et{constructor(){super(...arguments);this.paramsConfig=iie}static type(){return"jitter"}static displayedInputNames(){return["geometry to jitter points of"]}initializeNode(){this.io.inputs.setCount(1),this.io.inputs.initInputsClonedState(bl.INPUT_CLONED_STATE)}cook(e){this._operation=this._operation||new bl(this.scene(),this.states);let t=this._operation.cook(e,this.pv);this.setCoreGroup(t)}};var QF=class extends V{constructor(){super(...arguments);this.length=v.FLOAT(1,{range:[0,10]}),this.pointsCount=v.INTEGER(1,{range:[2,100],rangeLocked:[!0,!1]}),this.origin=v.VECTOR3([0,0,0]),this.direction=v.VECTOR3([0,1,0])}},nie=new QF,zv=class extends et{constructor(){super(...arguments);this.paramsConfig=nie}static type(){return"line"}initializeNode(){}cook(){let e=Math.max(2,this.pv.pointsCount),t=new Array(e*3),r=new Array(e),o=this.pv.direction.clone().normalize().multiplyScalar(this.pv.length);for(let s=0;s<e;s++){let a=s/(e-1),c=o.clone().multiplyScalar(a);c.add(this.pv.origin),c.toArray(t,s*3),s>0&&(r[(s-1)*2]=s-1,r[(s-1)*2+1]=s)}let n=new De;n.setAttribute("position",new Ce(t,3)),n.setIndex(r),this.setGeometry(n,$t.LINE_SEGMENTS)}};var Tl=class extends Qe{constructor(){super(...arguments);this._globalsHandler=new N0,this._old_mat_by_old_new_id=new Map,this._materials_by_uuid=new Map}static type(){return"material"}async cook(e,t){let r=e[0];return this._old_mat_by_old_new_id.clear(),await this._apply_materials(r,t),this._swapTextures(r,t),r}async _apply_materials(e,t){var r,o,n,s;if(!t.assignMat)return;let a=t.material.nodeWithContext(oe.MAT,(r=this.states)==null?void 0:r.error);if(a){let c=a.material,l=a;if(l.assemblerController&&((o=l.assemblerController())==null||o.setAssemblerGlobalsHandler(this._globalsHandler)),await a.compute(),c){if(t.applyToChildren)for(let u of e.objects())u.traverse(p=>{this._apply_material(p,c,t)});else for(let u of e.objectsFromGroup(t.group))this._apply_material(u,c,t);return e}else(n=this.states)==null||n.error.set(`material invalid. (error: '${a.states.error.message()}')`)}else(s=this.states)==null||s.error.set("no material node found")}_swapTextures(e,t){if(!!t.swapCurrentTex){this._materials_by_uuid.clear();for(let r of e.objectsFromGroup(t.group))if(t.applyToChildren)r.traverse(o=>{let n=r.material;this._materials_by_uuid.set(n.uuid,n)});else{let o=r.material;this._materials_by_uuid.set(o.uuid,o)}this._materials_by_uuid.forEach((r,o)=>{this._swap_texture(r,t)})}}_apply_material(e,t,r){if(r.group&&!Or.isInGroup(r.group,e))return;let o=r.cloneMat?Qi.clone(this.scene(),t,{shareCustomUniforms:r.shareCustomUniforms}):t;if(t instanceof Ar&&o instanceof Ar)for(let s in t.uniforms)o.uniforms[s]=t.uniforms[s];let n=e;this._old_mat_by_old_new_id.set(o.uuid,n.material),n.material=o,Qi.apply_render_hook(e,o),Qi.applyCustomMaterials(e,o)}_swap_texture(e,t){if(t.texSrc0==""||t.texDest0=="")return;let r=this._old_mat_by_old_new_id.get(e.uuid);r=r||e;let o=r[t.texSrc0];if(o){e[t.texDest0]=o;let n=e.uniforms;n&&n[t.texDest0]&&(n[t.texDest0]={value:o})}}};Tl.DEFAULT_PARAMS={group:"",assignMat:!0,material:new Ci(""),applyToChildren:!0,cloneMat:!1,shareCustomUniforms:!0,swapCurrentTex:!1,texSrc0:"emissiveMap",texDest0:"map"};Tl.INPUT_CLONED_STATE=Ge.FROM_NODE;var qa=Tl.DEFAULT_PARAMS,eU=class extends V{constructor(){super(...arguments);this.group=v.STRING(qa.group),this.assignMat=v.BOOLEAN(qa.assignMat),this.material=v.NODE_PATH("",{nodeSelection:{context:oe.MAT},dependentOnFoundNode:!1,visibleIf:{assignMat:1}}),this.applyToChildren=v.BOOLEAN(qa.applyToChildren,{visibleIf:{assignMat:1}}),this.cloneMat=v.BOOLEAN(qa.cloneMat,{visibleIf:{assignMat:1}}),this.shareCustomUniforms=v.BOOLEAN(qa.shareCustomUniforms,{visibleIf:{assignMat:1,cloneMat:1}}),this.swapCurrentTex=v.BOOLEAN(qa.swapCurrentTex),this.texSrc0=v.STRING(qa.texSrc0,{visibleIf:{swapCurrentTex:1}}),this.texDest0=v.STRING(qa.texDest0,{visibleIf:{swapCurrentTex:1}})}},sie=new eU,Hv=class extends et{constructor(){super(...arguments);this.paramsConfig=sie}static type(){return"material"}static displayedInputNames(){return["objects to assign material to"]}initializeNode(){this.io.inputs.setCount(1),this.io.inputs.initInputsClonedState(Tl.INPUT_CLONED_STATE)}async cook(e){this._operation=this._operation||new Tl(this._scene,this.states);let t=await this._operation.cook(e,this.pv);this.setCoreGroup(t)}};var jv=class extends S0{constructor(){super(...arguments);this._childrenControllerContext=oe.MAT}static type(){return Ro.MAT}createNode(e,t){return super.createNode(e,t)}children(){return super.children()}nodesByType(e){return super.nodesByType(e)}};var Al=class extends Qe{static type(){return"merge"}cook(e,t){let r=[];for(let o of e)if(o){let n=o.objects();if(t.compact)for(let s of n)s.traverse(a=>{r.push(a)});else for(let s of o.objects())r.push(s)}return t.compact&&(r=this._makeCompact(r)),this.createCoreGroupFromObjects(r)}_makeCompact(e){let t=new Map,r=new Map,o=[];for(let s of e)s.traverse(a=>{if(a instanceof ut)return;let c=a;if(c.geometry){let l=Zi(c.constructor);o.includes(l)||o.push(l),l&&(t.get(l)||t.set(l,c.material),Ft.pushOnArrayAtEntry(r,l,c))}});let n=[];return o.forEach(s=>{var a,c;let l=r.get(s);if(l){let u=[];for(let p of l){let h=p.geometry;h.applyMatrix4(p.matrix),u.push(h)}try{let p=Ut.mergeGeometries(u);if(p){let h=t.get(s),d=this.createObject(p,s,h);d.matrixAutoUpdate=!1,n.push(d)}else(a=this.states)==null||a.error.set("merge failed, check that input geometries have the same attributes")}catch(p){(c=this.states)==null||c.error.set(p.message)}}}),n}};Al.DEFAULT_PARAMS={compact:!1,keepHierarchy:!1};Al.INPUT_CLONED_STATE=Ge.FROM_NODE;var b2="geometry to merge",aie=Al.DEFAULT_PARAMS,tU=4,rU=class extends V{constructor(){super(...arguments);this.compact=v.BOOLEAN(aie.compact),this.inputsCount=v.INTEGER(tU,{range:[1,32],rangeLocked:[!0,!1],callback:e=>{T2.PARAM_CALLBACK_setInputsCount(e)}})}},cie=new rU,T2=class extends et{constructor(){super(...arguments);this.paramsConfig=cie}static type(){return"merge"}static displayedInputNames(){return[b2,b2,b2,b2]}setCompactMode(e){this.p.compact.set(e)}initializeNode(){this.io.inputs.setCount(1,tU),this.io.inputs.initInputsClonedState(Al.INPUT_CLONED_STATE),this.scene().dispatchController.onAddListener(()=>{this.params.addOnSceneLoadHook("update inputs",()=>{this._callbackUpdateInputsCount()})})}cook(e){this._operation=this._operation||new Al(this.scene(),this.states);let t=this._operation.cook(e,this.pv);this.setCoreGroup(t)}_callbackUpdateInputsCount(){this.io.inputs.setCount(1,this.pv.inputsCount),this.emit(St.INPUTS_UPDATED)}static PARAM_CALLBACK_setInputsCount(e){e._callbackUpdateInputsCount()}};var Cl=class extends Qe{static type(){return"objectProperties"}cook(e,t){let r=e[0];for(let o of r.objects())t.applyToChildren?o.traverse(n=>{this._updateObject(n,t)}):this._updateObject(o,t);return r}_updateObject(e,t){t.tname&&(e.name=t.name),t.trenderOrder&&(e.renderOrder=t.renderOrder),t.tfrustumCulled&&(e.frustumCulled=t.frustumCulled),t.tmatrixAutoUpdate&&(e.matrixAutoUpdate=t.matrixAutoUpdate),t.tvisible&&(e.visible=t.visible),t.tcastShadow&&(e.castShadow=t.castShadow),t.treceiveShadow&&(e.receiveShadow=t.receiveShadow)}};Cl.DEFAULT_PARAMS={applyToChildren:!1,tname:!1,name:"",trenderOrder:!1,renderOrder:0,tfrustumCulled:!1,frustumCulled:!0,tmatrixAutoUpdate:!1,matrixAutoUpdate:!1,tvisible:!1,visible:!0,tcastShadow:!1,castShadow:!0,treceiveShadow:!1,receiveShadow:!0};Cl.INPUT_CLONED_STATE=Ge.FROM_NODE;var ti=Cl.DEFAULT_PARAMS,oU=class extends V{constructor(){super(...arguments);this.applyToChildren=v.BOOLEAN(ti.applyToChildren,{separatorAfter:!0}),this.tname=v.BOOLEAN(ti.tname),this.name=v.STRING(ti.name,{visibleIf:{tname:!0},separatorAfter:!0,expression:{forEntities:!0}}),this.trenderOrder=v.BOOLEAN(ti.trenderOrder),this.renderOrder=v.INTEGER(ti.renderOrder,{visibleIf:{trenderOrder:!0},range:[0,10],rangeLocked:[!1,!1],separatorAfter:!0,expression:{forEntities:!0}}),this.tfrustumCulled=v.BOOLEAN(ti.tfrustumCulled),this.frustumCulled=v.BOOLEAN(ti.frustumCulled,{visibleIf:{tfrustumCulled:!0},separatorAfter:!0,expression:{forEntities:!0}}),this.tmatrixAutoUpdate=v.BOOLEAN(ti.tmatrixAutoUpdate),this.matrixAutoUpdate=v.BOOLEAN(ti.matrixAutoUpdate,{visibleIf:{tmatrixAutoUpdate:!0},separatorAfter:!0,expression:{forEntities:!0}}),this.tvisible=v.BOOLEAN(ti.tvisible),this.visible=v.BOOLEAN(ti.visible,{visibleIf:{tvisible:!0},separatorAfter:!0,expression:{forEntities:!0}}),this.tcastShadow=v.BOOLEAN(ti.tcastShadow),this.castShadow=v.BOOLEAN(ti.castShadow,{visibleIf:{tcastShadow:!0},separatorAfter:!0,expression:{forEntities:!0}}),this.treceiveShadow=v.BOOLEAN(ti.treceiveShadow),this.receiveShadow=v.BOOLEAN(ti.receiveShadow,{visibleIf:{treceiveShadow:!0},expression:{forEntities:!0}})}},lie=new oU,Wv=class extends et{constructor(){super(...arguments);this.paramsConfig=lie}static type(){return"objectProperties"}static displayedInputNames(){return["objects to change properties of"]}initializeNode(){this.io.inputs.setCount(1),this.io.inputs.initInputsClonedState(Cl.INPUT_CLONED_STATE)}async cook(e){if(this._operation=this._operation||new Cl(this.scene(),this.states),this.params.all.find(r=>r.hasExpression())){let r=e[0];await this._cookWithExpressions(r),this.setCoreGroup(r)}else{let r=this._operation.cook(e,this.pv);this.setCoreGroup(r)}}async _cookWithExpressions(e){if(await this._cookWithExpressionsForCoreGroup(e),this.pv.applyToChildren){let t=e.objects();for(let r of t){let o=Oi._fromObjects(r.children);await this._cookWithExpressionsForCoreGroup(o)}}}async _cookWithExpressionsForCoreGroup(e){let t=e.coreObjects(),r=this.pv;r.tname&&(this.p.name.expressionController?await this.p.name.expressionController.computeExpressionForObjects(t,(o,n)=>{o.object().name=n}):t.forEach(o=>o.object().name=r.name)),r.trenderOrder&&(this.p.renderOrder.expressionController?await this.p.renderOrder.expressionController.computeExpressionForObjects(t,(o,n)=>{o.object().renderOrder=n}):t.forEach(o=>o.object().renderOrder=r.renderOrder)),r.tfrustumCulled&&(this.p.frustumCulled.expressionController?await this.p.frustumCulled.expressionController.computeExpressionForObjects(t,(o,n)=>{o.object().frustumCulled=n}):t.forEach(o=>o.object().frustumCulled=r.frustumCulled)),r.tmatrixAutoUpdate&&(this.p.matrixAutoUpdate.expressionController?await this.p.matrixAutoUpdate.expressionController.computeExpressionForObjects(t,(o,n)=>{o.object().matrixAutoUpdate=n}):t.forEach(o=>o.object().matrixAutoUpdate=r.matrixAutoUpdate)),r.tvisible&&(this.p.visible.expressionController?await this.p.visible.expressionController.computeExpressionForObjects(t,(o,n)=>{o.object().visible=n}):t.forEach(o=>o.object().visible=r.visible)),r.tcastShadow&&(this.p.castShadow.expressionController?await this.p.castShadow.expressionController.computeExpressionForObjects(t,(o,n)=>{o.object().castShadow=n}):t.forEach(o=>o.object().castShadow=r.castShadow)),r.treceiveShadow&&(this.p.receiveShadow.expressionController?await this.p.receiveShadow.expressionController.computeExpressionForObjects(t,(o,n)=>{o.object().receiveShadow=n}):t.forEach(o=>o.object().receiveShadow=r.receiveShadow))}};var om=(i=>(i.PARTICLES_SHADER="particles_shader",i.MATERIAL="material",i))(om||{}),rm=class extends Qf{constructor(i,e){super();this._uv_name=i,this._purpose=e}set_texture_allocations_controller(i){this._texture_allocations_controller=i}handle_globals_node(i,e,t){if(!this._texture_allocations_controller)return;let r=i.io.outputs.namedOutputConnectionPointsByName(e),o=i.glVarName(e);if(this._texture_allocations_controller.variable(e)&&r){let s=r.type(),a=this.readAttribute(i,s,e,t),c=`${s} ${o} = ${a}`;t.addBodyLines(i,[c])}else this.globals_geometry_handler=this.globals_geometry_handler||new N0,this.globals_geometry_handler.handle_globals_node(i,e,t)}_textureVariableUsable(i){switch(this._purpose){case"particles_shader":return!0;case"material":return!i.readonly()}Be.unreachable(this._purpose)}readAttribute(i,e,t,r){if(!this._texture_allocations_controller){console.warn("no texture allocation controller");return}let o=this._texture_allocations_controller.variable(t);if(o&&this._textureVariableUsable(o)){this.add_particles_sim_uv_attribute(i,r);let n=o.component(),s=o.allocation();if(s){let a=s.textureName(),c=new Fv(i,mo.SAMPLER_2D,a);return r.addDefinitions(i,[c]),`texture2D( ${a}, ${this._uv_name} ).${n}`}}else return N0.readAttribute(i,e,t,r)}add_particles_sim_uv_attribute(i,e){let t=new em(i,mo.VEC2,rm.UV_ATTRIB),r=new Wa(i,mo.VEC2,rm.UV_VARYING);e.addDefinitions(i,[t,r],ei.VERTEX),e.addDefinitions(i,[r],ei.FRAGMENT),e.addBodyLines(i,[`${rm.UV_VARYING} = ${rm.UV_ATTRIB}`],ei.VERTEX)}},rs=rm;rs.UV_ATTRIB="particles_sim_uv_attrib";rs.UV_VARYING="particles_sim_uv_varying";rs.PARTICLE_SIM_UV="particleUV";var qv=class{constructor(e){this.node=e,this._particlesGroupObjects=[],this._allShaderNames=[],this._uniformByShaderName=new Map,this._allUniformNames=[],this._materialGlobalsHandler=new rs(rs.UV_VARYING,om.MATERIAL)}setShadersByName(e){this._allShaderNames=[],this._uniformByShaderName.clear(),this._allUniformNames=[],e.forEach((t,r)=>{this._allShaderNames.push(r),this._allUniformNames.push(`texture_${r}`)}),this.resetRenderMaterial()}assignRenderMaterial(){if(!!this._renderMaterial){for(let e of this._particlesGroupObjects){let t=e;t.geometry&&(t.material=this._renderMaterial,Qi.applyCustomMaterials(t,this._renderMaterial),t.matrixAutoUpdate=!1,t.updateMatrix())}this._renderMaterial.needsUpdate=!0,this.updateRenderMaterialUniforms()}}updateRenderMaterialUniforms(){var e;if(!this._renderMaterial)return;let t,r;for(let o=0;o<this._allShaderNames.length;o++){r=this._allShaderNames[o],t=this._allUniformNames[o];let n=this._uniformByShaderName.get(r);n||(n={value:null},this._uniformByShaderName.set(r,n));let s=(e=this.node.gpuController.getCurrentRenderTarget(r))==null?void 0:e.texture;n.value=s||null,Qi.assignUniforms(this._renderMaterial,t,n,this._matNodeAssembler)}}resetRenderMaterial(){this._renderMaterial=void 0,this._particlesGroupObjects=[]}material(){return this._renderMaterial}initialized(){return this._renderMaterial!=null}initCoreGroup(e){for(let t of e.objectsWithGeo())this._particlesGroupObjects.push(t)}async initRenderMaterial(){var e;let t=(e=this.node.assemblerController())==null?void 0:e.assembler;if(this._renderMaterial)return;this.node.p.material.isDirty()&&(this.node.debugMessage("renderController: this.node.p.material.compute() START"),await this.node.p.material.compute(),this.node.debugMessage("renderController: this.node.p.material.compute() END"));let r=this.node.pv.material.nodeWithContext(oe.MAT,this.node.states.error);if(r){if(t){let n=t.textureAllocationsController().toJSON(this.node.scene()),s=r.assemblerController();s&&(this._materialGlobalsHandler.set_texture_allocations_controller(t.textureAllocationsController()),s.setAssemblerGlobalsHandler(this._materialGlobalsHandler),this._matNodeAssembler=s.assembler),(!this._texture_allocations_json||JSON.stringify(this._texture_allocations_json)!=JSON.stringify(n))&&(this._texture_allocations_json=Cr.cloneDeep(n),s&&s.set_compilation_required_and_dirty())}this.node.debugMessage("renderController: matNode.compute() START");let o=await r.compute();this.node.debugMessage("renderController: matNode.compute() END"),this._renderMaterial=o.material()}else this.node.states.error.set("render material not valid");this.assignRenderMaterial()}};var th=(i=>(i.TIME="time",i.DELTA_TIME="delta_time",i))(th||{});var iU=function(i,e,t){this.variables=[],this.currentTextureIndex=0;var r=Wt,o=new Ji;o.matrixAutoUpdate=!1;var n=new us;n.position.z=1,n.matrixAutoUpdate=!1,n.updateMatrix();var s={passThruTexture:{value:null}},a=p(d(),s);let c=new ls(2,2);var l=new lt(c,a);l.matrixAutoUpdate=!1,l.updateMatrix(),o.add(l),this.dispose=function(){a.dispose(),c.dispose()},this.setDataType=function(m){return r=m,this},this.addVariable=function(m,f,x){var _=this.createShaderMaterial(f),g={name:m,initialValueTexture:x,material:_,dependencies:null,renderTargets:[],wrapS:null,wrapT:null,minFilter:nt,magFilter:nt};return this.variables.push(g),g},this.setVariableDependencies=function(m,f){m.dependencies=f},this.init=function(){if(t.capabilities.isWebGL2===!1&&t.extensions.has("OES_texture_float")===!1)return"No OES_texture_float support for float textures.";if(t.capabilities.maxVertexTextures===0)return"No support for vertex shader textures.";for(var m=0;m<this.variables.length;m++){var f=this.variables[m];f.renderTargets[0]=this.createRenderTarget(i,e,f.wrapS,f.wrapT,f.minFilter,f.magFilter),f.renderTargets[1]=this.createRenderTarget(i,e,f.wrapS,f.wrapT,f.minFilter,f.magFilter),this.renderTexture(f.initialValueTexture,f.renderTargets[0]),this.renderTexture(f.initialValueTexture,f.renderTargets[1]);var x=f.material,_=x.uniforms;if(f.dependencies!==null)for(var g=0;g<f.dependencies.length;g++){var T=f.dependencies[g];if(T.name!==f.name){for(var b=!1,y=0;y<this.variables.length;y++)if(T.name===this.variables[y].name){b=!0;break}if(!b)return"Variable dependency not found. Variable="+f.name+", dependency="+T.name}_[T.name]={value:null}}}return this.currentTextureIndex=0,null},this.compute=function(){for(var m=this.currentTextureIndex,f=this.currentTextureIndex===0?1:0,x=0,_=this.variables.length;x<_;x++){var g=this.variables[x];if(g.dependencies!==null)for(var T=g.material.uniforms,b=0,y=g.dependencies.length;b<y;b++){var A=g.dependencies[b];T[A.name].value=A.renderTargets[m].texture}this.doRenderTarget(g.material,g.renderTargets[f])}this.currentTextureIndex=f},this.getCurrentRenderTarget=function(m){return m.renderTargets[this.currentTextureIndex]},this.getAlternateRenderTarget=function(m){return m.renderTargets[this.currentTextureIndex===0?1:0]};function u(m){m.defines.resolution="vec2( "+i.toFixed(1)+", "+e.toFixed(1)+" )"}this.addResolutionDefine=u;function p(m,f){f=f||{};var x=new Ar({uniforms:f,vertexShader:h(),fragmentShader:m});return u(x),x}this.createShaderMaterial=p,this.createRenderTarget=function(m,f,x,_,g,T){m=m||i,f=f||e,x=x||kt,_=_||kt,g=g||nt,T=T||nt;var b=new vr(m,f,{wrapS:x,wrapT:_,minFilter:g,magFilter:T,format:st,type:r,depthBuffer:!1});return b},this.createTexture=function(){var m=new Float32Array(i*e*4);return new Mr(m,i,e,st,Wt)},this.renderTexture=function(m,f){s.passThruTexture.value=m,this.doRenderTarget(a,f),s.passThruTexture.value=null},this.doRenderTarget=function(m,f){var x=t.getRenderTarget();l.material=m,t.setRenderTarget(f),t.render(o,n),l.material=a,t.setRenderTarget(x)};function h(){return`void main()	{

	gl_Position = vec4( position, 1.0 );

}
`}function d(){return`uniform sampler2D passThruTexture;

void main() {

	vec2 uv = gl_FragCoord.xy / resolution.xy;

	gl_FragColor = texture2D( passThruTexture, uv );

}
`}};var Xv=["float","half"],uie={float:Wt,half:zr},Yv=class{constructor(e){this.node=e,this._simulationRestartRequired=!1,this._points=[],this._variablesByName=new Map,this._allVariables=[],this._createdTexturesByName=new Map,this._usedTexturesSize=new G,this._callbackName=`gpuCompute-${this.node.graphNodeId()}`}dispose(){this._gpuCompute&&(this._gpuCompute.dispose(),this._gpuCompute=void 0),this._renderer&&(this._renderer.dispose(),this._renderer=void 0),this._particlesCoreGroup&&(this._particlesCoreGroup.dispose(),this._particlesCoreGroup=void 0),this._variablesByName.clear(),this._allVariables.splice(0,this._allVariables.length),this._createdTexturesByName.clear(),this._shadersByName&&(this._shadersByName.clear(),this._shadersByName=void 0),this._persistedTextureAllocationsController&&(this._persistedTextureAllocationsController.dispose(),this._persistedTextureAllocationsController=void 0),this.node.scene().unRegisterOnBeforeTick(this._callbackName)}setPersistedTextureAllocationController(e){this._persistedTextureAllocationsController=e}setShadersByName(e){this._shadersByName=e,this.resetGpuCompute()}allVariables(){return this._allVariables}async init(e){this.initParticleGroupPoints(e),this.node.debugMessage("GPUComputeController: this.createGPUCompute() START"),await this.createGPUCompute(),this.node.debugMessage("GPUComputeController: this.createGPUCompute() END")}getCurrentRenderTarget(e){var t;let r=this._variablesByName.get(e);if(r)return(t=this._gpuCompute)==null?void 0:t.getCurrentRenderTarget(r)}initParticleGroupPoints(e){this.resetGpuCompute(),!!e&&(this._particlesCoreGroup=e,this._points=this._getPoints()||[])}computeSimulationIfRequired(e){let t=this.node.scene().frame(),r=this.node.pv.startFrame;if(t>=r&&(this._lastSimulatedFrame==null&&(this._lastSimulatedFrame=r-1),t>this._lastSimulatedFrame)){let o=t-this._lastSimulatedFrame;if(this._lastSimulatedFrame=t,!this.node.pv.active)return;this._computeSimulation(e,o)}}_computeSimulation(e,t=1){if(!!this._gpuCompute){this._updateSimulationMaterialUniforms(e);for(let r=0;r<t;r++)this._gpuCompute.compute();this.node.renderController.updateRenderMaterialUniforms()}}_dataType(){let e=Xv[this.node.pv.dataType];return uie[e]}_textureNameForShaderName(e){return`texture_${e}`}async createGPUCompute(){var e,t;if(this.node.pv.autoTexturesSize){let s=Er.nearestPower2(Math.sqrt(this._points.length));this._usedTexturesSize.x=Math.min(s,this.node.pv.maxTexturesSize.x),this._usedTexturesSize.y=Math.min(s,this.node.pv.maxTexturesSize.y)}else{if(!(kl(this.node.pv.texturesSize.x)&&kl(this.node.pv.texturesSize.y))){this.node.states.error.set("texture size must be a power of 2");return}let s=this.node.pv.texturesSize.x*this.node.pv.texturesSize.y;if(this._points.length>s){this.node.states.error.set(`max particles is set to (${this.node.pv.texturesSize.x}x${this.node.pv.texturesSize.y}=) ${s}`);return}this._usedTexturesSize.copy(this.node.pv.texturesSize)}this._forceTimeDependent(),this._initParticlesUVs(),this.node.renderController.resetRenderMaterial(),this.node.debugMessage("GPUComputeController: Poly.renderersController.waitForRenderer() START");let r=await Q.renderersController.waitForRenderer();if(this.node.debugMessage("GPUComputeController: Poly.renderersController.waitForRenderer() END"),r?this._renderer=r:this.node.states.error.set("no renderer found"),!this._renderer)return;let o=new iU(this._usedTexturesSize.x,this._usedTexturesSize.y,this._renderer);if(o.setDataType(this._dataType()),this._gpuCompute=o,!this._gpuCompute){this.node.states.error.set("failed to create the GPUComputationRenderer");return}this._lastSimulatedFrame=void 0,this._variablesByName.forEach((s,a)=>{s.renderTargets[0].dispose(),s.renderTargets[1].dispose(),this._variablesByName.delete(a)}),this._allVariables=[],(e=this._shadersByName)==null||e.forEach((s,a)=>{if(this._gpuCompute){let c=this._gpuCompute.addVariable(this._textureNameForShaderName(a),s,this._createdTexturesByName.get(a));this._variablesByName.set(a,c),this._allVariables.push(c)}}),(t=this._variablesByName)==null||t.forEach((s,a)=>{this._gpuCompute&&this._gpuCompute.setVariableDependencies(s,this._allVariables)}),this._createTextureRenderTargets(),this._fillTextures(),this._createSimulationMaterialUniforms();var n=this._gpuCompute.init();n!==null&&(console.error(n),this.node.states.error.set(n))}_forceTimeDependent(){let e=this._onTimeUpdate.bind(this);this.node.scene().registeredBeforeTickCallbacks().has(this._callbackName)||this.node.scene().registerOnBeforeTick(this._callbackName,e)}_onTimeUpdate(e){if(this.node.isOnStartFrame()){this.node.setDirty();return}else this.computeSimulationIfRequired(e)}materials(){let e=[];return this._variablesByName.forEach((t,r)=>{e.push(t.material)}),e}_createSimulationMaterialUniforms(){let e=this.node.assemblerController(),t=e==null?void 0:e.assembler;if(!t&&!this._persistedTextureAllocationsController)return;let r=[];this._variablesByName.forEach((n,s)=>{r.push(n.material)});let o=this._readonlyAllocations();for(let n of r)n.uniforms[th.TIME]={value:this.node.scene().time()},n.uniforms[th.DELTA_TIME]={value:this.node.scene().time()},o&&this._assignReadonlyTextures(n,o);if(t)for(let n of r)for(let s of t.param_configs())n.uniforms[s.uniformName()]=s.uniform();else{let n=this.node.persisted_config.loaded_data();if(n){let s=this.node.persisted_config.uniforms();if(s){let a=n.param_uniform_pairs;for(let c of a){let l=c[0],u=c[1],p=this.node.params.get(l),h=s[u];for(let d of r)d.uniforms[u]=h,o&&this._assignReadonlyTextures(d,o);if(p&&h){let d=()=>{for(let m of r)ms.callback(p,m.uniforms[u])};p.options.setOption("callback",d),d()}}}}}}_assignReadonlyTextures(e,t){for(let r of t){let o=r.shaderName(),n=this._createdTexturesByName.get(o);if(n){let s=this._textureNameForShaderName(o);e.uniforms[s]={value:n}}}}_updateSimulationMaterialUniforms(e){for(let t of this._allVariables)t.material.uniforms[th.TIME].value+=e,t.material.uniforms[th.DELTA_TIME].value=e}_initParticlesUVs(){var e=new Float32Array(this._points.length*2);let t=0;for(var r=0,o=0;o<this._usedTexturesSize.x;o++)for(var n=0;n<this._usedTexturesSize.y&&(e[t++]=n/(this._usedTexturesSize.x-1),e[t++]=o/(this._usedTexturesSize.y-1),r+=2,!(r>=e.length));n++);let s=rs.UV_ATTRIB;if(this._particlesCoreGroup)for(let a of this._particlesCoreGroup.coreGeometries()){let c=a.geometry(),l=a.markedAsInstance()?Xr:Ot;c.setAttribute(s,new l(e,2))}}createdTexturesByName(){return this._createdTexturesByName}_fillTextures(){let e=this._textureAllocationsController();!e||this._createdTexturesByName.forEach((t,r)=>{let o=e.allocationForShaderName(r);if(!o){console.warn(`no allocation found for shader ${r}`);return}let n=o.variables();if(!n){console.warn("allocation has no variables");return}let s=t.image.data;for(let a of n){let c=a.position(),l=a.name(),u=this._points[0];if(u&&u.hasAttrib(l)){let h=u.attribSize(l),d=c;for(let m of this._points){if(h==1){let f=m.attribValue(l);s[d]=f}else m.attribValue(l).toArray(s,d);d+=4}}}t.needsUpdate=!0})}resetGpuCompute(){this._gpuCompute=void 0,this._simulationRestartRequired=!0}setRestartNotRequired(){this._simulationRestartRequired=!1}resetGpuComputeAndSetDirty(){this.resetGpuCompute(),this.node.setDirty()}resetParticleGroups(){this._particlesCoreGroup=void 0}initialized(){return this._particlesCoreGroup!=null&&this._gpuCompute!=null}_createTextureRenderTargets(){this._createdTexturesByName.forEach((t,r)=>{t.dispose()}),this._createdTexturesByName.clear(),this._variablesByName.forEach((t,r)=>{this._gpuCompute&&this._createdTexturesByName.set(r,this._gpuCompute.createTexture())});let e=this._readonlyAllocations();if(e&&this._gpuCompute)for(let t of e)this._createdTexturesByName.set(t.shaderName(),this._gpuCompute.createTexture())}_textureAllocationsController(){var e;return((e=this.node.assemblerController())==null?void 0:e.assembler.textureAllocationsController())||this._persistedTextureAllocationsController}_readonlyAllocations(){var e;return(e=this._textureAllocationsController())==null?void 0:e.readonlyAllocations()}restartSimulationIfRequired(){this._simulationRestartRequired&&this._restartSimulation()}_restartSimulation(){this._createTextureRenderTargets(),!!this._getPoints()&&(this._fillTextures(),this._variablesByName.forEach((t,r)=>{let o=this._createdTexturesByName.get(r);this._gpuCompute&&o&&(this._gpuCompute.renderTexture(o,t.renderTargets[0]),this._gpuCompute.renderTexture(o,t.renderTargets[1]))}))}_getPoints(){if(!this._particlesCoreGroup)return;let e=this._particlesCoreGroup.coreGeometries(),t=e[0];if(t){let r=t.markedAsInstance(),o=[];for(let s of e)s.markedAsInstance()==r&&o.push(s);let n=[];for(let s of o)for(let a of s.points())n.push(a);return n}else return[]}};var $v=[mo.FLOAT,mo.VEC2,mo.VEC3,mo.VEC4],nU=class extends V{constructor(){super(...arguments);this.name=v.STRING(""),this.type=v.INTEGER(0,{menu:{entries:$v.map((e,t)=>({name:e,value:t}))}})}},pie=new nU,Kv=class extends M0{constructor(){super(...arguments);this.paramsConfig=pie}static type(){return"varyingWrite"}initializeNode(){this.addPostDirtyHook("_setMatToRecompile",this._setMatToRecompile.bind(this)),this.io.connection_points.initializeNode(),this.io.connection_points.set_input_name_function(()=>this.inputName()),this.io.connection_points.set_expected_input_types_function(()=>[$v[this.pv.type]]),this.io.connection_points.set_expected_output_types_function(()=>[])}inputName(){return Kv.INPUT_NAME}setLines(i){if(i.currentShaderName()==ei.VERTEX){let e=this.glType();if(!e)return;let t=this.pv.name,r=new Wa(this,e,t),o=Na.any(this.variableForInput(Kv.INPUT_NAME)),n=`${t} = ${o}`;i.addDefinitions(this,[r],ei.VERTEX),i.addBodyLines(this,[n],ei.VERTEX)}}attributeName(){return this.pv.name.trim()}glType(){let i=this.io.inputs.namedInputConnectionPoints()[0];if(i)return i.type()}setGlType(i){this.p.type.set($v.indexOf(i))}},Jv=Kv;Jv.INPUT_NAME="vertex";var A2=class{static findOutputNodes(e){return e.nodesByType("output")}static findParamGeneratingNodes(e){var t;let r=[];return(t=e.childrenController)==null||t.traverseChildren(o=>{let n=o;n.paramsGenerating()&&r.push(n)}),r}static findVaryingNodes(e){return e.nodesByType(Jv.type())}static findAttributeExportNodes(e){return e.nodesByType(ts.type()).filter(r=>r.isExporting())}};var Fs=class{constructor(e,t){if(this._name=e,this._size=t,this._position=-1,this._readonly=!1,!e)throw"TextureVariable requires a name"}merge(e){var t;e.readonly()||this.setReadonly(!1),(t=e.graphNodeIds())==null||t.forEach(r=>{this.addGraphNodeId(r)})}setReadonly(e){this._readonly=e}readonly(){return this._readonly}setAllocation(e){this._allocation=e}allocation(){return this._allocation}graphNodeIds(){return this._graphNodeIds}addGraphNodeId(e){this._graphNodeIds=this._graphNodeIds||new Set,this._graphNodeIds.add(e)}name(){return this._name}size(){return this._size}setPosition(e){this._position=e}position(){return this._position}component(){return"xyzw".split("").splice(this._position,this._size).join("")}static fromJSON(e){return new Fs(e.name,e.size)}toJSON(e){let t=[];return this._graphNodeIds&&this._graphNodeIds.forEach(r=>{let o=e.graph.nodeFromId(r);if(o){let n=o.path();n&&t.push(n)}}),{name:this.name(),size:this.size(),nodes:t}}};var hie="texture_",El=class{constructor(){this._size=0}addVariable(e){this._variables=this._variables||[],this._variables.push(e),e.setPosition(this._size),e.setAllocation(this),this._size+=e.size()}hasSpaceForVariable(e){return this._size+e.size()<=4}shaderName(){var e;return(((e=this.variables())==null?void 0:e.map(r=>r.name()))||["no_variables_allocated"]).join("_SEPARATOR_")}textureName(){return`${hie}${this.shaderName()}`}variables(){return this._variables}variablesForInputNode(e){var t;return(t=this._variables)==null?void 0:t.filter(r=>{var o;return((o=r.graphNodeIds())==null?void 0:o.has(e.graphNodeId()))||!1})}inputNamesForNode(e){let t=this.variablesForInputNode(e);if(t)return e.type()==Oh.ATTRIBUTE?[ts.INPUT_NAME]:t.map(r=>r.name())}variable(e){if(this._variables){for(let t of this._variables)if(t.name()==e)return t}}static fromJSON(e){let t=new El;for(let r of e){let o=Fs.fromJSON(r);t.addVariable(o)}return t}toJSON(e){return this._variables?this._variables.map(t=>t.toJSON(e)):[]}};var sU=class extends V{},die=new sU,Zv=class extends M0{constructor(){super(...arguments);this.paramsConfig=die}static type(){return"globals"}initializeNode(){super.initializeNode(),this.lifecycle.onAfterAdded(()=>{var e,t;(t=(e=this.materialNode())==null?void 0:e.assemblerController())==null||t.add_globals_outputs(this)})}setLines(e){e.assembler().set_node_lines_globals(this,e)}};var aU=class extends V{},fie=new aU,im=class extends M0{constructor(){super(...arguments);this.paramsConfig=fie}static type(){return"output"}initializeNode(){super.initializeNode(),this.addPostDirtyHook("_setMatToRecompile",this._setMatToRecompile.bind(this)),this.lifecycle.onAfterAdded(()=>{var e,t;(t=(e=this.materialNode())==null?void 0:e.assemblerController())==null||t.add_output_inputs(this),this._setMatToRecompile()})}setLines(e){e.assembler().set_node_lines_output(this,e)}};var mie=["position","normal","color","uv"],Sl=class{constructor(){this._writableAllocations=[],this._readonlyAllocations=[]}dispose(){this._writableAllocations.splice(0,this._writableAllocations.length),this._readonlyAllocations.splice(0,this._readonlyAllocations.length)}static _sortNodes(e){let r=e.filter(a=>a.type()==im.type()),o=e.filter(a=>a.type()!=im.type()),n=o.map(a=>a.path()).sort(),s=new Map;for(let a of o)s.set(a.path(),a);for(let a of n){let c=s.get(a);c&&r.push(c)}return r}allocateConnectionsFromRootNodes(e,t){let r=[];e=Sl._sortNodes(e),t=Sl._sortNodes(t);for(let o of e){let n=o.graphNodeId();switch(o.type()){case im.type():{for(let s of o.io.inputs.namedInputConnectionPoints())if(o.io.inputs.named_input(s.name())){let c=new Fs(s.name(),qh[s.type()]);c.addGraphNodeId(n),r.push(c)}break}case ts.type():{let s=o,a=s.connected_input_node(),c=s.connected_input_connection_point();if(a&&c){let l=new Fs(s.attributeName(),qh[c.type()]);l.addGraphNodeId(n),r.push(l)}break}}}for(let o of t){let n=o.graphNodeId();switch(o.type()){case Zv.type():{let s=o;for(let a of s.io.outputs.used_output_names())if(mie.includes(a)){let l=s.io.outputs.namedOutputConnectionPointsByName(a);if(l){let u=l.type(),p=new Fs(a,qh[u]);p.addGraphNodeId(n),r.push(p)}}break}case ts.type():{let s=o,a=s.output_connection_point();if(a){let c=new Fs(s.attributeName(),qh[a.type()]);s.isExporting()||c.setReadonly(!0),c.addGraphNodeId(n),r.push(c)}break}}}this._allocateVariables(r)}_allocateVariables(e){let r=this._ensureVariablesAreUnique(e).sort((o,n)=>o.size()<n.size()?1:-1);for(let o of r)o.readonly()?this._allocateVariable(o,this._readonlyAllocations):this._allocateVariable(o,this._writableAllocations)}_ensureVariablesAreUnique(e){let t=new Map;for(let o of e)Ft.pushOnArrayAtEntry(t,o.name(),o);let r=[];return t.forEach((o,n)=>{let s=o[0];r.push(s);for(let a=1;a<o.length;a++){let c=o[a];s.merge(c)}}),r}_allocateVariable(e,t){let r=this.hasVariable(e.name());if(r)throw"no variable should be allocated since they have been made unique before";for(let o of t)!r&&o.hasSpaceForVariable(e)&&(o.addVariable(e),r=!0);if(!r){let o=new El;t.push(o),o.addVariable(e)}}_addWritableAllocation(e){this._writableAllocations.push(e)}_addReadonlyAllocation(e){this._readonlyAllocations.push(e)}readonlyAllocations(){return this._readonlyAllocations}shaderNames(){let e=this._writableAllocations.map(t=>t.shaderName());return $e.uniq(e)}createShaderConfigs(){return[]}allocationForShaderName(e){let t=this._writableAllocations.filter(r=>r.shaderName()==e)[0];return t||this._readonlyAllocations.filter(r=>r.shaderName()==e)[0]}inputNamesForShaderName(e,t){let r=this.allocationForShaderName(t);if(r)return r.inputNamesForNode(e)}variable(e){for(let t of this._writableAllocations){let r=t.variable(e);if(r)return r}for(let t of this._readonlyAllocations){let r=t.variable(e);if(r)return r}}variables(){let e=this._writableAllocations.map(r=>r.variables()||[]).flat(),t=this._writableAllocations.map(r=>r.variables()||[]).flat();return e.concat(t)}hasVariable(e){return this.variables().map(r=>r.name()).includes(e)}static fromJSON(e){let t=new Sl;for(let r of e.writable){let o=Object.keys(r)[0],n=r[o],s=El.fromJSON(n);t._addWritableAllocation(s)}for(let r of e.readonly){let o=Object.keys(r)[0],n=r[o],s=El.fromJSON(n);t._addReadonlyAllocation(s)}return t}toJSON(e){let t=this._writableAllocations.map(o=>({[o.shaderName()]:o.toJSON(e)})),r=this._readonlyAllocations.map(o=>({[o.shaderName()]:o.toJSON(e)}));return{writable:t,readonly:r}}print(e){console.warn(JSON.stringify(this.toJSON(e),[""],2))}};var Qv=class extends nf{constructor(e){super(e);this.node=e}toJSON(){let e=this.node.assemblerController();if(!e)return;let t={};this.node.shaders_by_name().forEach((u,p)=>{t[p]=u});let o=e.assembler.textureAllocationsController().toJSON(this.node.scene()),n=[],s=new Ar,a=e.assembler.param_configs();for(let u of a)n.push([u.name(),u.uniformName()]),s.uniforms[u.uniformName()]=u.uniform();let c=this._materialToJson(s,{node:this.node,suffix:"main"});return{shaders_by_name:t,texture_allocations:o,param_uniform_pairs:n,uniforms_owner:c||{}}}load(e){this.node.assemblerController()||(this._loaded_data=e,this.node.init_with_persisted_config())}loaded_data(){return this._loaded_data}shaders_by_name(){if(this._loaded_data){let e=new Map,t=Object.keys(this._loaded_data.shaders_by_name);for(let r of t)e.set(r,this._loaded_data.shaders_by_name[r]);return e}}texture_allocations_controller(){if(this._loaded_data)return Sl.fromJSON(this._loaded_data.texture_allocations)}uniforms(){if(this._loaded_data){let e=this._loadMaterial(this._loaded_data.uniforms_owner);return(e==null?void 0:e.uniforms)||{}}}};var cU=class extends V{constructor(){super(...arguments);this.startFrame=v.FLOAT($s.START_FRAME,{range:[0,1e3],rangeLocked:[!0,!1]}),this.active=v.BOOLEAN(1,{cook:!1}),this.autoTexturesSize=v.BOOLEAN(1),this.maxTexturesSize=v.VECTOR2([1024,1024],{visibleIf:{autoTexturesSize:1}}),this.texturesSize=v.VECTOR2([64,64],{visibleIf:{autoTexturesSize:0}}),this.dataType=v.INTEGER(0,{menu:{entries:Xv.map((e,t)=>({value:t,name:e}))}}),this.reset=v.BUTTON(null,{callback:(e,t)=>{C2.PARAM_CALLBACK_reset(e)}}),this.material=v.NODE_PATH("",{nodeSelection:{context:oe.MAT},dependentOnFoundNode:!1})}},_ie=new cU,C2=class extends et{constructor(){super(...arguments);this.paramsConfig=_ie,this._debugCook=!1,this._assemblerController=this._createAssemblerController(),this.persisted_config=new Qv(this),this._particlesGlobalsHandler=new rs(rs.PARTICLE_SIM_UV,om.PARTICLES_SHADER),this._shaders_by_name=new Map,this.gpuController=new Yv(this),this.renderController=new qv(this),this._resetMaterialIfDirtyBound=this._resetMaterialIfDirty.bind(this),this._childrenControllerContext=oe.GL}static type(){return"particlesSystemGpu"}dispose(){super.dispose(),this.gpuController.dispose()}debugMessage(e){!this._debugCook||console.log(e)}assemblerController(){return this._assemblerController}usedAssembler(){return Ai.GL_PARTICLES}_createAssemblerController(){return Q.assemblersRegister.assembler(this,this.usedAssembler())}shaders_by_name(){return this._shaders_by_name}static require_webgl2(){return!0}static PARAM_CALLBACK_reset(e){e.PARAM_CALLBACK_reset()}PARAM_CALLBACK_reset(){this.gpuController.resetGpuComputeAndSetDirty()}static displayedInputNames(){return["points to emit particles from"]}initializeNode(){this.io.inputs.setCount(1),this.io.inputs.initInputsClonedState(Ge.NEVER),this.addPostDirtyHook("_resetMaterialIfDirty",this._resetMaterialIfDirtyBound)}createNode(e,t){return super.createNode(e,t)}children(){return super.children()}nodesByType(e){return super.nodesByType(e)}childrenAllowed(){return this.assemblerController()?super.childrenAllowed():(this.scene().markAsReadOnly(this),!1)}async _resetMaterialIfDirty(){this.p.material.isDirty()&&(this.renderController.resetRenderMaterial(),this.isOnStartFrame()||(this.debugMessage("particles:this.renderController.initRenderMaterial START"),await this.renderController.initRenderMaterial(),this.debugMessage("particles:this.renderController.initRenderMaterial END")))}isOnStartFrame(){return this.scene().frame()==this.pv.startFrame}async cook(e){this.gpuController.setRestartNotRequired();let t=e[0];this.compileIfRequired();let r=this.isOnStartFrame();r&&this.gpuController.resetParticleGroups(),this.gpuController.initialized()||(this.debugMessage("particles:this.gpuController.init(coreGroup) START"),await this.gpuController.init(t),this.debugMessage("particles:this.gpuController.init(coreGroup) END")),this.renderController.initialized()||(this.renderController.initCoreGroup(t),this.debugMessage("particles:this.renderController.initRenderMaterial() START"),await this.renderController.initRenderMaterial(),this.debugMessage("particles:this.renderController.initRenderMaterial() END")),this.gpuController.restartSimulationIfRequired(),this.gpuController.computeSimulationIfRequired(0),r?this.setCoreGroup(t):this.cookController.endCook()}async compileIfRequired(){var e;if((e=this.assemblerController())==null?void 0:e.compileRequired()){this.debugMessage("particles:this.run_assembler() START");try{await this.run_assembler()}catch(t){let r=t.message||"failed to compile";this.states.error.set(r)}this.debugMessage("particles:this.run_assembler() END")}}async run_assembler(){let e=this.assemblerController();if(!e)return;let t=this._findExportNodes();if(t.length>0){let o=t;e.setAssemblerGlobalsHandler(this._particlesGlobalsHandler),e.assembler.set_root_nodes(o),e.assembler.compile(),e.post_compile()}let r=e.assembler.shaders_by_name();this._setShaderNames(r)}_setShaderNames(e){this._shaders_by_name=e,this.gpuController.setShadersByName(this._shaders_by_name),this.renderController.setShadersByName(this._shaders_by_name),this.gpuController.resetGpuCompute(),this.gpuController.resetParticleGroups()}init_with_persisted_config(){let e=this.persisted_config.shaders_by_name(),t=this.persisted_config.texture_allocations_controller();e&&t&&(this._setShaderNames(e),this.gpuController.setPersistedTextureAllocationController(t))}_findExportNodes(){let e=A2.findAttributeExportNodes(this),t=A2.findOutputNodes(this);if(t.length==0&&this.states.error.set("one output node is required"),t.length>1)return this.states.error.set("only one output node is allowed"),[];let r=t[0];return r&&e.push(r),e}};var gie=new w(0,0,1),vie=new w(0,0,1),xie=new w(0,1,0),wl=class extends Qe{constructor(){super(...arguments);this._coreTransform=new Xt,this._size=new w,this._center=new w,this._segmentsCount=new G(1,1)}static type(){return"plane"}cook(e,t){let r=e[0];return r?this._cook_with_input(r,t):this._cook_without_input(t)}_cook_without_input(e){let t=this._create_plane(e.size,e);this._coreTransform.rotateGeometry(t,gie,e.direction);let r=this._coreTransform.translationMatrix(e.center);return t.applyMatrix4(r),this.createCoreGroupFromGeometry(t)}_cook_with_input(e,t){let r=e.boundingBox();r.getSize(this._size),r.getCenter(this._center);let o=new G(this._size.x,this._size.z),n=this._create_plane(o,t);this._coreTransform.rotateGeometry(n,vie,xie);let s=this._coreTransform.translationMatrix(this._center);return n.applyMatrix4(s),this.createCoreGroupFromGeometry(n)}_create_plane(e,t){return e=e.clone(),t.useSegmentsCount?(this._segmentsCount.x=Math.floor(t.segments.x),this._segmentsCount.y=Math.floor(t.segments.y)):t.stepSize>0&&(this._segmentsCount.x=Math.floor(e.x/t.stepSize),this._segmentsCount.y=Math.floor(e.y/t.stepSize),e.x=this._segmentsCount.x*t.stepSize,e.y=this._segmentsCount.y*t.stepSize),new ls(e.x,e.y,this._segmentsCount.x,this._segmentsCount.y)}};wl.DEFAULT_PARAMS={size:new G(1,1),useSegmentsCount:!1,stepSize:1,segments:new G(1,1),direction:new w(0,1,0),center:new w(0,0,0)};wl.INPUT_CLONED_STATE=Ge.NEVER;var rh=wl.DEFAULT_PARAMS,lU=class extends V{constructor(){super(...arguments);this.size=v.VECTOR2(rh.size),this.useSegmentsCount=v.BOOLEAN(rh.useSegmentsCount),this.stepSize=v.FLOAT(rh.stepSize,{range:[.001,1],rangeLocked:[!1,!1],visibleIf:{useSegmentsCount:0}}),this.segments=v.VECTOR2(rh.segments,{visibleIf:{useSegmentsCount:1}}),this.direction=v.VECTOR3(rh.direction),this.center=v.VECTOR3(rh.center)}},yie=new lU,ex=class extends et{constructor(){super(...arguments);this.paramsConfig=yie}static type(){return"plane"}static displayedInputNames(){return["geometry to create plane from (optional)"]}initializeNode(){this.io.inputs.setCount(0,1),this.io.inputs.initInputsClonedState(wl.INPUT_CLONED_STATE)}cook(e){this._operation=this._operation||new wl(this.scene(),this.states);let t=this._operation.cook(e,this.pv);this.setCoreGroup(t)}};var nm=class extends Qe{static type(){return"restAttributes"}cook(e,t){let o=e[0].objectsWithGeo();return t.tposition&&this._create_rest_attribute(o,t.position,t.restP),t.tnormal&&this._create_rest_attribute(o,t.normal,t.restN),this.createCoreGroupFromObjects(o)}_create_rest_attribute(e,t,r){for(let o of e){let n=o.geometry;if(n){let s=n.getAttribute(t);s&&n.setAttribute(r,s.clone())}}}};nm.DEFAULT_PARAMS={tposition:!0,position:"position",restP:"restP",tnormal:!0,normal:"normal",restN:"restN"};var oh=nm.DEFAULT_PARAMS,uU=class extends V{constructor(){super(...arguments);this.tposition=v.BOOLEAN(oh.tposition),this.position=v.STRING(oh.position,{visibleIf:{tposition:!0}}),this.restP=v.STRING(oh.restP,{visibleIf:{tposition:!0}}),this.tnormal=v.BOOLEAN(oh.tnormal),this.normal=v.STRING(oh.normal,{visibleIf:{tnormal:!0}}),this.restN=v.STRING(oh.restN,{visibleIf:{tnormal:!0}})}},bie=new uU,tx=class extends et{constructor(){super(...arguments);this.paramsConfig=bie}static type(){return"restAttributes"}initializeNode(){this.io.inputs.setCount(1),this.io.inputs.initInputsClonedState([Ge.FROM_NODE])}cook(e){this._operation=this._operation||new nm(this.scene(),this.states);let t=this._operation.cook(e,this.pv);this.setCoreGroup(t)}};var wo=new as,rx=class{constructor(e,t){this.additionalAttributeNames=t,this.randomFunction=Math.random,this.additionalAttributes=new Map,this.weightAttribute=null,this.distribution=null;let r=e.geometry;if(!r.isBufferGeometry||r.attributes.position.itemSize!==3)throw new Error("THREE.MeshSurfaceSampler: Requires BufferGeometry triangle mesh.");r.index&&(console.warn("THREE.MeshSurfaceSampler: Converting geometry to non-indexed BufferGeometry."),r=r.toNonIndexed()),this.geometry=r,this.positionAttribute=this.geometry.getAttribute("position");for(let o of t){let n=this.geometry.getAttribute(o);n&&this.additionalAttributes.set(o,n)}}setWeightAttribute(e){return this.weightAttribute=e?this.geometry.getAttribute(e):null,this}build(){let e=this.positionAttribute,t=this.weightAttribute,r=new Float32Array(e.count/3);for(let n=0;n<e.count;n+=3){let s=1;t&&(s=t.getX(n)+t.getX(n+1)+t.getX(n+2)),wo.a.fromBufferAttribute(e,n),wo.b.fromBufferAttribute(e,n+1),wo.c.fromBufferAttribute(e,n+2),s*=wo.getArea(),r[n/3]=s}this.distribution=new Float32Array(e.count/3);let o=0;for(let n=0;n<r.length;n++)o+=r[n],this.distribution[n]=o;return this}setRandomGenerator(e){return this.randomFunction=e,this}sample(e,t,r,o){let n=this.distribution[this.distribution.length-1],s=this.binarySearch(this.randomFunction(e)*n);return this.sampleFace(e,s,t,r,o)}binarySearch(e){let t=this.distribution,r=0,o=t.length-1,n=-1;for(;r<=o;){let s=Math.ceil((r+o)/2);if(s===0||t[s-1]<=e&&t[s]>e){n=s;break}else e<t[s]?o=s-1:r=s+1}return n}sampleFace(e,t,r,o,n){let s=this.randomFunction(e*(t+1456)),a=this.randomFunction((e+9851)*(t+7646));if(s+a>1&&(s=1-s,a=1-a),wo.a.fromBufferAttribute(this.positionAttribute,t*3),wo.b.fromBufferAttribute(this.positionAttribute,t*3+1),wo.c.fromBufferAttribute(this.positionAttribute,t*3+2),r.set(0,0,0).addScaledVector(wo.a,s).addScaledVector(wo.b,a).addScaledVector(wo.c,1-(s+a)),o!==void 0&&wo.getNormal(o),n){let c=0;for(let l of this.additionalAttributeNames){let u=this.additionalAttributes.get(l);u&&(wo.a.fromBufferAttribute(u,t*3),wo.b.fromBufferAttribute(u,t*3+1),wo.c.fromBufferAttribute(u,t*3+2),n[c].set(0,0,0).addScaledVector(wo.a,s).addScaledVector(wo.b,a).addScaledVector(wo.c,1-(s+a))),c++}}return this}};var ih=class extends Qe{constructor(){super(...arguments);this._position=new w,this._normal=new w}static type(){return"scatter"}async cook(e,t){let r=e[0],o=r.objectsWithGeo()[0],n=o,s=o.geometry;s.index&&(s=s.toNonIndexed(),o=new lt(s));let a=t.transferAttributes,c=[];a&&(c=r.attribNamesMatchingMask(t.attributesToTransfer));let l=new rx(o,c);if(t.useWeightAttribute){let M=t.weightAttribute.trim();M!=""&&l.setWeightAttribute(M)}let u=2454*t.seed%Number.MAX_SAFE_INTEGER;l.setRandomGenerator(M=>Er.randFloat(u,M)),l.build();let p=t.pointsCount,h=new Array(p*3),d=new Array(p*3),m=new Array(c.length),f=new Array(c.length),x=new Map,_=new Array(c.length),g=new Map;for(let M=0;M<c.length;M++){let L=c[M];m[M]=new w;let C=o.geometry.getAttribute(c[M]).itemSize;x.set(L,C),f[M]=C,_[M]=new Array(p*C),g.set(L,_[M])}let T=c.length>0,b=this._position,y=this._normal,A=0;for(let M=0;M<p;M++)if(l.sample(M,b,y,m),A=M*3,b.toArray(h,A),y.toArray(d,A),T){let L=0;for(let C of m)C.toArray(_[L],M*f[L]),L++}let E=new De;E.setAttribute(mr.POSITION,new Ot(new Float32Array(h),3)),E.setAttribute(mr.NORMAL,new Ot(new Float32Array(d),3));for(let M of c){let L=x.get(M),C=g.get(M);L!=null&&C!=null&&E.setAttribute(M,new Ot(new Float32Array(C),L))}if(t.addIdAttribute||t.addIdnAttribute){let M=t.pointsCount,L=$e.range(M);t.addIdAttribute&&E.setAttribute("id",new Ot(new Float32Array(L),1));let C=L.map(N=>N/(M-1));t.addIdnAttribute&&E.setAttribute("idn",new Ot(new Float32Array(C),1))}let S=this.createObject(E,$t.POINTS);return S.position.copy(n.position),S.rotation.copy(n.rotation),S.scale.copy(n.scale),S.matrix.copy(n.matrix),this.createCoreGroupFromObjects([S])}};ih.DEFAULT_PARAMS={pointsCount:100,seed:0,useWeightAttribute:!1,weightAttribute:"",transferAttributes:!1,attributesToTransfer:"",addIdAttribute:!0,addIdnAttribute:!0};ih.INPUT_CLONED_STATE=Ge.FROM_NODE;var Xa=ih.DEFAULT_PARAMS,pU=class extends V{constructor(){super(...arguments);this.pointsCount=v.INTEGER(Xa.pointsCount,{range:[0,1e3],rangeLocked:[!0,!1]}),this.seed=v.INTEGER(Xa.seed,{range:[0,100],rangeLocked:[!0,!1]}),this.useWeightAttribute=v.BOOLEAN(Xa.useWeightAttribute),this.weightAttribute=v.STRING(Xa.weightAttribute,{visibleIf:{useWeightAttribute:1}}),this.transferAttributes=v.BOOLEAN(Xa.transferAttributes),this.attributesToTransfer=v.STRING(Xa.attributesToTransfer,{visibleIf:{transferAttributes:1}}),this.addIdAttribute=v.BOOLEAN(Xa.addIdAttribute),this.addIdnAttribute=v.BOOLEAN(Xa.addIdnAttribute)}},Tie=new pU,ox=class extends et{constructor(){super(...arguments);this.paramsConfig=Tie}static type(){return"scatter"}static displayedInputNames(){return["geometry to scatter points onto"]}initializeNode(){this.io.inputs.setCount(1),this.io.inputs.initInputsClonedState(Ge.NEVER)}async cook(e){this._operation=this._operation||new ih(this.scene(),this.states);let t=await this._operation.cook(e,this.pv);this.setCoreGroup(t)}};var xn={default:0,isocahedron:1},hU=["default","isocahedron"],Ml=class extends Qe{static type(){return"sphere"}cook(e,t){let r=e[0];return r?this._cook_with_input(r,t):this._cook_without_input(t)}_cook_without_input(e){let t=this._create_required_geometry(e);return t.translate(e.center.x,e.center.y,e.center.z),this.createCoreGroupFromGeometry(t)}_cook_with_input(e,t){let r=e.boundingBox(),o=r.max.clone().sub(r.min),n=r.max.clone().add(r.min).multiplyScalar(.5),s=this._create_required_geometry(t);return s.translate(t.center.x,t.center.y,t.center.z),s.translate(n.x,n.y,n.z),s.scale(o.x,o.y,o.z),this.createCoreGroupFromGeometry(s)}_create_required_geometry(e){return e.type==xn.default?this._create_default_sphere(e):this._create_default_isocahedron(e)}_create_default_sphere(e){return e.open?new ml(e.radius,e.resolution.x,e.resolution.y,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength):new ml(e.radius,e.resolution.x,e.resolution.y)}_create_default_isocahedron(e){return new eh(e.radius,e.detail)}};Ml.DEFAULT_PARAMS={type:xn.default,radius:1,resolution:new G(30,30),open:!1,phiStart:0,phiLength:Math.PI*2,thetaStart:0,thetaLength:Math.PI,detail:1,center:new w(0,0,0)};Ml.INPUT_CLONED_STATE=Ge.FROM_NODE;var Ya=Ml.DEFAULT_PARAMS,dU=class extends V{constructor(){super(...arguments);this.type=v.INTEGER(Ya.type,{menu:{entries:hU.map(e=>({name:e,value:xn[e]}))}}),this.radius=v.FLOAT(Ya.radius,{visibleIf:{type:xn.default}}),this.resolution=v.VECTOR2(Ya.resolution,{visibleIf:{type:xn.default}}),this.open=v.BOOLEAN(Ya.open,{visibleIf:{type:xn.default}}),this.phiStart=v.FLOAT(Ya.phiStart,{range:[0,Math.PI*2],visibleIf:{type:xn.default,open:!0}}),this.phiLength=v.FLOAT("$PI*2",{range:[0,Math.PI*2],visibleIf:{type:xn.default,open:!0}}),this.thetaStart=v.FLOAT(Ya.thetaStart,{range:[0,Math.PI],visibleIf:{type:xn.default,open:!0}}),this.thetaLength=v.FLOAT("$PI",{range:[0,Math.PI],visibleIf:{type:xn.default,open:!0}}),this.detail=v.INTEGER(Ya.detail,{range:[0,5],rangeLocked:[!0,!1],visibleIf:{type:xn.isocahedron}}),this.center=v.VECTOR3(Ya.center)}},Aie=new dU,ix=class extends et{constructor(){super(...arguments);this.paramsConfig=Aie}static type(){return"sphere"}initializeNode(){this.io.inputs.setCount(0,1),this.io.inputs.initInputsClonedState(Ml.INPUT_CLONED_STATE)}cook(e){this._operation=this._operation||new Ml(this.scene(),this.states);let t=this._operation.cook(e,this.pv);this.setCoreGroup(t)}};var sm=["set params","update matrix"],Nl=class extends Qe{constructor(){super(...arguments);this._coreTransform=new Xt,this._point_pos=new w,this._object_scale=new w,this._r=new w,this._object_position=new w}static type(){return"transform"}cook(e,t){let r=e[0].objects();return this._applyTransform(r,t),e[0]}_applyTransform(e,t){let r=t0[t.applyOn];switch(r){case e0.GEOMETRIES:return this._updateGeometries(e,t);case e0.OBJECTS:return this._updateObjects(e,t)}Be.unreachable(r)}_updateGeometries(e,t){let r=this._matrix(t);if(t.group.trim()==="")for(let o of e){let n=o.geometry;n&&(n.translate(-t.pivot.x,-t.pivot.y,-t.pivot.z),n.applyMatrix4(r),n.translate(t.pivot.x,t.pivot.y,t.pivot.z))}else{let n=Oi._fromObjects(e).pointsFromGroup(t.group);for(let s of n){let a=s.getPosition(this._point_pos).sub(t.pivot);a.applyMatrix4(r),s.setPosition(a.add(t.pivot))}}}_updateObjects(e,t){let r=sm[t.objectMode];switch(r){case"set params":return this._update_objects_params(e,t);case"update matrix":return this._update_objects_matrix(e,t)}Be.unreachable(r)}_update_objects_params(e,t){for(let r of e){r.position.copy(t.t);let o=xs[t.rotationOrder];this._r.copy(t.r).multiplyScalar(L0),r.rotation.set(this._r.x,this._r.y,this._r.z,o),this._object_scale.copy(t.s).multiplyScalar(t.scale),r.scale.copy(this._object_scale),r.updateMatrix()}}_update_objects_matrix(e,t){let r=this._matrix(t);for(let o of e)this._object_position.copy(o.position),o.position.multiplyScalar(0),o.updateMatrix(),o.applyMatrix4(r),o.position.add(this._object_position),o.updateMatrix()}_matrix(e){return this._coreTransform.matrix(e.t,e.r,e.s,e.scale,xs[e.rotationOrder])}};Nl.DEFAULT_PARAMS={applyOn:t0.indexOf(e0.GEOMETRIES),objectMode:sm.indexOf("set params"),group:"",rotationOrder:xs.indexOf(vc.XYZ),t:new w(0,0,0),r:new w(0,0,0),s:new w(1,1,1),scale:1,pivot:new w(0,0,0)};Nl.INPUT_CLONED_STATE=Ge.FROM_NODE;var nx=(i=>(i.SHEAR="shear",i.TRANSFORM="transform",i.UV_LAYOUT="uvLayout",i.UV_TRANSFORM="uvTransform",i.UV_UNWRAP="uvUnwrap",i))(nx||{});var O0=Nl.DEFAULT_PARAMS,fU=class extends V{constructor(){super(...arguments);this.applyOn=v.INTEGER(O0.applyOn,{menu:{entries:t0.map((e,t)=>({name:e,value:t}))}}),this.objectMode=v.INTEGER(O0.objectMode,{visibleIf:{applyOn:t0.indexOf(e0.OBJECTS)},menu:{entries:sm.map((e,t)=>({name:e,value:t}))}}),this.group=v.STRING(O0.group,{visibleIf:{applyOn:t0.indexOf(e0.GEOMETRIES)}}),this.rotationOrder=v.INTEGER(O0.rotationOrder,{menu:{entries:xs.map((e,t)=>({name:e,value:t}))}}),this.t=v.VECTOR3(O0.t),this.r=v.VECTOR3(O0.r),this.s=v.VECTOR3(O0.s),this.scale=v.FLOAT(O0.scale,{range:[0,10]}),this.pivot=v.VECTOR3(O0.pivot,{visibleIf:{applyOn:t0.indexOf(e0.GEOMETRIES)}})}},Cie=new fU,sx=class extends et{constructor(){super(...arguments);this.paramsConfig=Cie}static type(){return nx.TRANSFORM}static displayedInputNames(){return["geometries or objects to transform"]}initializeNode(){this.io.inputs.setCount(1),this.io.inputs.initInputsClonedState(Nl.INPUT_CLONED_STATE)}setApplyOn(e){this.p.applyOn.set(t0.indexOf(e))}setObjectMode(e){this.p.objectMode.set(sm.indexOf(e))}cook(e){this._operation=this._operation||new Nl(this.scene(),this.states);let t=this._operation.cook(e,this.pv);this.setCoreGroup(t)}};var ax={nodes:[S6,hd,u_,dd,Sc,w6,h_,d_,f7,Cp,m7,d7,_7,dn,wp,g7,v7,y7,Xd,q_,Yd,A7,w7,r9,ef,i9,Tu,Ma,Wc,a9,c9,Y7,J7,Q7,eg,tg,og,ig,ag,lg,Sf,pg,hg,dg,Rg,Ig,O9,Gg,zg,Hg,Wg,Xg,Yg,ov,iv,g2,Pv,Rv,Dv,Uv,Gv,zv,Hv,jv,T2,Wv,C2,ex,tx,ox,ix,sx],operations:[]};var YAt=async function(i){let{domElement:e,sceneData:t,onProgress:r}=i;if(i.runRegister!=null?i.runRegister:!0){for(let c of ax.nodes)Q.registerNode(c);for(let c of ax.operations)Q.registerOperation(c);U8.run(Q),Q}Q.libs.setRoot("./three/js/libs");let n="scene_01",{scene:s,viewer:a}=await Jh.loadSceneData({domElement:e,sceneName:n,configureScene:HM,sceneData:t,onProgress:r,assetsRoot:""});return{scene:s,viewer:a}};export{Q as Poly,YAt as loadSceneFromSceneData_scene_01};
/*!
 * CSSPlugin 3.8.0
 * https://greensock.com
 *
 * Copyright 2008-2021, GreenSock. All rights reserved.
 * Subject to the terms at https://greensock.com/standard-license or for
 * Club GreenSock members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/
/*!
 * GSAP 3.8.0
 * https://greensock.com
 *
 * @license Copyright 2008-2021, GreenSock. All rights reserved.
 * Subject to the terms at https://greensock.com/standard-license or for
 * Club GreenSock members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
/**
 * Tone.js
 * @author Yotam Mann
 * @license http://opensource.org/licenses/MIT MIT License
 * @copyright 2014-2019 Yotam Mann
 */
