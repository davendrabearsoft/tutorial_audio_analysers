import{a as w}from"./chunk-4EIDCPOJ.js";import"./chunk-KBNISIIW.js";var O=(e=>(e.EXPORT_MANIFEST="scene/export_manifest.json",e.CODE_PREFIX="scene/code",e.PROPERTIES="scene/code/properties.json",e.EDITOR="scene/editor.json",e.ASSETS="scene/assets.json",e.POLYGONJS="js/all.js",e.SCENE_DATA_LOADER="js/sceneDataLoader.js",e.POLY_CONFIG="js/polyConfig.js",e.JS_FILES="scene/js_files.json",e.POSTER="images/poster.png",e))(O||{});var g=class{static async importSceneData(s){s.editorMode==null&&(s.editorMode=!1);let o=s.manifest,r=s.urlPrefix||O.CODE_PREFIX,n=Object.keys(o.nodes),a=[];for(let t of n){let p=o.nodes[t],P=`${r}/root/${t}.json?t=${p}`;a.push(P)}let u=`${r}/root.json?t=${o.root}`,i=`${r}/properties.json?t=${o.properties}`,d=[u,i];if(s.editorMode){let t=Date.now();d.push(`${r}/ui.json?t=${t}`)}for(let t of a)d.push(t);let A=0,_=d.length,h=t=>{let p=w.sceneData;s.onProgress&&s.onProgress(p.start+p.mult*t)},S=d.map(async t=>{let p=await fetch(t);return A++,h(A/_),p}),M=await Promise.all(S),l=[];for(let t of M)l.push(await t.json());let m={root:l[0],properties:l[1]},E=2;s.editorMode&&(m.ui=l[2],E+=1);let c={},f=Object.keys(o.nodes);for(let t=0;t<f.length;t++){let p=f[t],P=l[t+E];c[p]=P}return this.assemble(m,f,c)}static async assemble(s,o,r){let n={root:s.root,properties:s.properties,ui:s.ui};for(let a=0;a<o.length;a++){let u=o[a],i=r[u];this.insert_child_data(n.root,u,i)}return n}static insert_child_data(s,o,r){let n=o.split("/");if(n.length==1)s.nodes||(s.nodes={}),s.nodes[o]=r;else{let a=n.shift(),u=n.join("/"),i=s.nodes[a];this.insert_child_data(i,u,r)}}};var v="1645057900913",I="1645057900913",y={positionalAudio1:"1645057900913","positionalAudio1/COP":"1645057900913","positionalAudio1/eventsNetwork1":"1645057900913",geo1:"1645057900913","geo1/COP":"1645057900913","geo1/MAT":"1645057900913",crowd:"1645057900913","crowd/MAT":"1645057900913","crowd/MAT/meshLambertBuilder_INSTANCES":"1645057900913","crowd/MAT/meshStandardBuilder1":"1645057900913",planeWithTexture:"1645057900913","planeWithTexture/COP":"1645057900913","planeWithTexture/MAT":"1645057900913",waveform:"1645057900913","waveform/MAT":"1645057900913","waveform/MAT/lineBasicBuilder_FFT_asOctaves_SPEED":"1645057900913","waveform/MAT/lineBasicBuilder_FFT_asOctaves_VALUE":"1645057900913","waveform/MAT/lineBasicBuilder_FFT_raw_VALUE":"1645057900913",particles:"1645057900913","particles/particlesSystemGpu1":"1645057900913","particles/particlesSystemGpu1/subnet_FORCE_FROM_MUSIC":"1645057900913","particles/particlesSystemGpu1/subnet_CURSOR_FORCE":"1645057900913","particles/particlesSystemGpu1/subnet_RANDOMISE_MASS":"1645057900913","particles/MAT":"1645057900913","particles/MAT/pointsParticles":"1645057900913","particles/MAT/meshLambertBuilder_INSTANCES":"1645057900913","particles/MAT/meshBasicBuilder_PARTICLES":"1645057900913","particles/MAT/meshBasicBuilder_PARTICLES/ifThen1":"1645057900913","particles/eventsNetwork1":"1645057900913",blackSphere:"1645057900913","blackSphere/materialsNetwork1":"1645057900913",raycastTarget:"1645057900913",perspectiveCamera_DEBUG:"1645057900913","perspectiveCamera_DEBUG/events1":"1645057900913",perspectiveCamera_MAIN:"1645057900913","perspectiveCamera_MAIN/eventsNetwork1":"1645057900913","perspectiveCamera_MAIN/animationsNetwork1":"1645057900913",env:"1645057900913","env/MAT":"1645057900913","env/MAT/meshBasicBuilder1":"1645057900913","env/COP":"1645057900913",eventsNetwork_light_shadow:"1645057900913"},j={properties:v,root:I,nodes:y};var R=async e=>await g.importSceneData({urlPrefix:"./polygonjs/scenes/scene_01",manifest:j,onProgress:e.onProgress});var $=async function(e){let{onProgress:s,domElement:o,configureSceneData:r,autoPlay:n}=e,a=e.runRegister!=null?e.runRegister:!0,i=(e.loadModules!=null?e.loadModules:!0)?["EXRLoader","OBJLoader"]:[],d=i.map(c=>import("./modules/"+c+(e.moduleImportSuffix||""))),A=[import("./loadSceneFromSceneData-BRYU4H5P.js"),R({onProgress:s}),...d],_=await Promise.all(A),{Poly:h,loadSceneFromSceneData_scene_01:S}=_[0],M=_[1];r&&r(M);let l=[];for(let c=2;c<_.length;c++)l.push(_[c]);let m=0;for(let c of i){let f=c+"Module";h.registerModule(l[m][f]),m++}return await S({onProgress:s,sceneData:M,domElement:o,runRegister:a,autoPlay:n})};export{$ as loadSceneAndMountAsync_scene_01};
