import{a as w}from"./chunk-4EIDCPOJ.js";import"./chunk-KBNISIIW.js";var O=(e=>(e.EXPORT_MANIFEST="scene/export_manifest.json",e.CODE_PREFIX="scene/code",e.PROPERTIES="scene/code/properties.json",e.EDITOR="scene/editor.json",e.ASSETS="scene/assets.json",e.POLYGONJS="js/all.js",e.SCENE_DATA_LOADER="js/sceneDataLoader.js",e.POLY_CONFIG="js/polyConfig.js",e.JS_FILES="scene/js_files.json",e.POSTER="images/poster.png",e))(O||{});var g=class{static async importSceneData(s){s.editorMode==null&&(s.editorMode=!1);let o=s.manifest,r=s.urlPrefix||O.CODE_PREFIX,n=Object.keys(o.nodes),c=[];for(let t of n){let p=o.nodes[t],P=`${r}/root/${t}.json?t=${p}`;c.push(P)}let i=`${r}/root.json?t=${o.root}`,u=`${r}/properties.json?t=${o.properties}`,_=[i,u];if(s.editorMode){let t=Date.now();_.push(`${r}/ui.json?t=${t}`)}for(let t of c)_.push(t);let d=0,T=_.length,S=t=>{let p=w.sceneData;s.onProgress&&s.onProgress(p.start+p.mult*t)},m=_.map(async t=>{let p=await fetch(t);return d++,S(d/T),p}),f=await Promise.all(m),l=[];for(let t of f)l.push(await t.json());let h={root:l[0],properties:l[1]},a=2;s.editorMode&&(h.ui=l[2],a+=1);let A={},E=Object.keys(o.nodes);for(let t=0;t<E.length;t++){let p=E[t],P=l[t+a];A[p]=P}return this.assemble(h,E,A)}static async assemble(s,o,r){let n={root:s.root,properties:s.properties,ui:s.ui};for(let c=0;c<o.length;c++){let i=o[c],u=r[i];this.insert_child_data(n.root,i,u)}return n}static insert_child_data(s,o,r){let n=o.split("/");if(n.length==1)s.nodes||(s.nodes={}),s.nodes[o]=r;else{let c=n.shift(),i=n.join("/"),u=s.nodes[c];this.insert_child_data(u,i,r)}}};var v="1644887998439",I="1644887998439",y={positionalAudio1:"1644887998439","positionalAudio1/COP":"1644887998439","positionalAudio1/eventsNetwork1":"1644887998439",geo1:"1644887998439","geo1/COP":"1644887998439","geo1/MAT":"1644887998439",crowd:"1644887998439","crowd/MAT":"1644887998439","crowd/MAT/meshLambertBuilder_INSTANCES":"1644887998439","crowd/MAT/meshStandardBuilder1":"1644887998439",planeWithTexture:"1644887998439","planeWithTexture/COP":"1644887998439","planeWithTexture/MAT":"1644887998439",waveform:"1644887998439","waveform/MAT":"1644887998439","waveform/MAT/lineBasicBuilder_FFT_asOctaves_SPEED":"1644887998439","waveform/MAT/lineBasicBuilder_FFT_asOctaves_VALUE":"1644887998439","waveform/MAT/lineBasicBuilder_FFT_raw_VALUE":"1644887998439",particles:"1644887998439","particles/particlesSystemGpu1":"1644887998439","particles/particlesSystemGpu1/subnet_FORCE_FROM_MUSIC":"1644887998439","particles/particlesSystemGpu1/subnet_CURSOR_FORCE":"1644887998439","particles/particlesSystemGpu1/subnet_RANDOMISE_MASS":"1644887998439","particles/MAT":"1644887998439","particles/MAT/pointsParticles":"1644887998439","particles/MAT/meshLambertBuilder_INSTANCES":"1644887998439","particles/MAT/meshBasicBuilder_PARTICLES":"1644887998439","particles/eventsNetwork1":"1644887998439",blackSphere:"1644887998439","blackSphere/materialsNetwork1":"1644887998439",raycastTarget:"1644887998439",perspectiveCamera_DEBUG:"1644887998439","perspectiveCamera_DEBUG/events1":"1644887998439",perspectiveCamera_MAIN:"1644887998439","perspectiveCamera_MAIN/eventsNetwork1":"1644887998439","perspectiveCamera_MAIN/animationsNetwork1":"1644887998439",env:"1644887998439","env/MAT":"1644887998439","env/MAT/meshBasicBuilder1":"1644887998439","env/COP":"1644887998439",eventsNetwork1:"1644887998439"},j={properties:v,root:I,nodes:y};var R=async e=>await g.importSceneData({urlPrefix:"./polygonjs/scenes/scene_01",manifest:j,onProgress:e.onProgress});var $=async function(e){let{onProgress:s,domElement:o,configureSceneData:r}=e,n=e.runRegister!=null?e.runRegister:!0,i=(e.loadModules!=null?e.loadModules:!0)?["EXRLoader","OBJLoader"]:[],u=i.map(a=>import("./modules/"+a+(e.moduleImportSuffix||""))),_=[import("./loadSceneFromSceneData-KVMCGU54.js"),R({onProgress:s}),...u],d=await Promise.all(_),{Poly:T,loadSceneFromSceneData_scene_01:S}=d[0],m=d[1];r&&r(m);let f=[];for(let a=2;a<d.length;a++)f.push(d[a]);let l=0;for(let a of i){let A=a+"Module";T.registerModule(f[l][A]),l++}return await S({onProgress:s,sceneData:m,domElement:o,runRegister:n})};export{$ as loadSceneAndMountAsync_scene_01};
